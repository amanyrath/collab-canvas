(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var N4=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Om(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var b5={exports:{}},bm={},M5={exports:{}},Be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gd=Symbol.for("react.element"),ZA=Symbol.for("react.portal"),e8=Symbol.for("react.fragment"),t8=Symbol.for("react.strict_mode"),n8=Symbol.for("react.profiler"),r8=Symbol.for("react.provider"),i8=Symbol.for("react.context"),s8=Symbol.for("react.forward_ref"),o8=Symbol.for("react.suspense"),a8=Symbol.for("react.memo"),l8=Symbol.for("react.lazy"),D4=Symbol.iterator;function u8(n){return n===null||typeof n!="object"?null:(n=D4&&n[D4]||n["@@iterator"],typeof n=="function"?n:null)}var L5={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},F5=Object.assign,V5={};function ic(n,e,t){this.props=n,this.context=e,this.refs=V5,this.updater=t||L5}ic.prototype.isReactComponent={};ic.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};ic.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function U5(){}U5.prototype=ic.prototype;function w2(n,e,t){this.props=n,this.context=e,this.refs=V5,this.updater=t||L5}var E2=w2.prototype=new U5;E2.constructor=w2;F5(E2,ic.prototype);E2.isPureReactComponent=!0;var O4=Array.isArray,z5=Object.prototype.hasOwnProperty,S2={current:null},B5={key:!0,ref:!0,__self:!0,__source:!0};function j5(n,e,t){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)z5.call(e,r)&&!B5.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=t;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];i.children=c}if(n&&n.defaultProps)for(r in l=n.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:Gd,type:n,key:s,ref:o,props:i,_owner:S2.current}}function c8(n,e){return{$$typeof:Gd,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function T2(n){return typeof n=="object"&&n!==null&&n.$$typeof===Gd}function h8(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var b4=/\/+/g;function Py(n,e){return typeof n=="object"&&n!==null&&n.key!=null?h8(""+n.key):e.toString(36)}function eg(n,e,t,r,i){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case Gd:case ZA:o=!0}}if(o)return o=n,i=i(o),n=r===""?"."+Py(o,0):r,O4(i)?(t="",n!=null&&(t=n.replace(b4,"$&/")+"/"),eg(i,e,t,"",function(d){return d})):i!=null&&(T2(i)&&(i=c8(i,t+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(b4,"$&/")+"/")+n)),e.push(i)),1;if(o=0,r=r===""?".":r+":",O4(n))for(var l=0;l<n.length;l++){s=n[l];var c=r+Py(s,l);o+=eg(s,e,t,c,i)}else if(c=u8(n),typeof c=="function")for(n=c.call(n),l=0;!(s=n.next()).done;)s=s.value,c=r+Py(s,l++),o+=eg(s,e,t,c,i);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Cp(n,e,t){if(n==null)return n;var r=[],i=0;return eg(n,r,"","",function(s){return e.call(t,s,i++)}),r}function d8(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var pr={current:null},tg={transition:null},f8={ReactCurrentDispatcher:pr,ReactCurrentBatchConfig:tg,ReactCurrentOwner:S2};function G5(){throw Error("act(...) is not supported in production builds of React.")}Be.Children={map:Cp,forEach:function(n,e,t){Cp(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Cp(n,function(){e++}),e},toArray:function(n){return Cp(n,function(e){return e})||[]},only:function(n){if(!T2(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};Be.Component=ic;Be.Fragment=e8;Be.Profiler=n8;Be.PureComponent=w2;Be.StrictMode=t8;Be.Suspense=o8;Be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=f8;Be.act=G5;Be.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=F5({},n.props),i=n.key,s=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=S2.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var l=n.type.defaultProps;for(c in e)z5.call(e,c)&&!B5.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=t;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:Gd,type:n.type,key:i,ref:s,props:r,_owner:o}};Be.createContext=function(n){return n={$$typeof:i8,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:r8,_context:n},n.Consumer=n};Be.createElement=j5;Be.createFactory=function(n){var e=j5.bind(null,n);return e.type=n,e};Be.createRef=function(){return{current:null}};Be.forwardRef=function(n){return{$$typeof:s8,render:n}};Be.isValidElement=T2;Be.lazy=function(n){return{$$typeof:l8,_payload:{_status:-1,_result:n},_init:d8}};Be.memo=function(n,e){return{$$typeof:a8,type:n,compare:e===void 0?null:e}};Be.startTransition=function(n){var e=tg.transition;tg.transition={};try{n()}finally{tg.transition=e}};Be.unstable_act=G5;Be.useCallback=function(n,e){return pr.current.useCallback(n,e)};Be.useContext=function(n){return pr.current.useContext(n)};Be.useDebugValue=function(){};Be.useDeferredValue=function(n){return pr.current.useDeferredValue(n)};Be.useEffect=function(n,e){return pr.current.useEffect(n,e)};Be.useId=function(){return pr.current.useId()};Be.useImperativeHandle=function(n,e,t){return pr.current.useImperativeHandle(n,e,t)};Be.useInsertionEffect=function(n,e){return pr.current.useInsertionEffect(n,e)};Be.useLayoutEffect=function(n,e){return pr.current.useLayoutEffect(n,e)};Be.useMemo=function(n,e){return pr.current.useMemo(n,e)};Be.useReducer=function(n,e,t){return pr.current.useReducer(n,e,t)};Be.useRef=function(n){return pr.current.useRef(n)};Be.useState=function(n){return pr.current.useState(n)};Be.useSyncExternalStore=function(n,e,t){return pr.current.useSyncExternalStore(n,e,t)};Be.useTransition=function(){return pr.current.useTransition()};Be.version="18.3.1";M5.exports=Be;var Ee=M5.exports;const wn=Om(Ee);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var p8=Ee,g8=Symbol.for("react.element"),m8=Symbol.for("react.fragment"),_8=Object.prototype.hasOwnProperty,y8=p8.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,v8={key:!0,ref:!0,__self:!0,__source:!0};function W5(n,e,t){var r,i={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)_8.call(e,r)&&!v8.hasOwnProperty(r)&&(i[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:g8,type:n,key:s,ref:o,props:i,_owner:y8.current}}bm.Fragment=m8;bm.jsx=W5;bm.jsxs=W5;b5.exports=bm;var Q=b5.exports,xv={},H5={exports:{}},jr={},$5={exports:{}},q5={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(Y,oe){var ne=Y.length;Y.push(oe);e:for(;0<ne;){var ae=ne-1>>>1,pe=Y[ae];if(0<i(pe,oe))Y[ae]=oe,Y[ne]=pe,ne=ae;else break e}}function t(Y){return Y.length===0?null:Y[0]}function r(Y){if(Y.length===0)return null;var oe=Y[0],ne=Y.pop();if(ne!==oe){Y[0]=ne;e:for(var ae=0,pe=Y.length,Se=pe>>>1;ae<Se;){var en=2*(ae+1)-1,At=Y[en],pt=en+1,B=Y[pt];if(0>i(At,ne))pt<pe&&0>i(B,At)?(Y[ae]=B,Y[pt]=ne,ae=pt):(Y[ae]=At,Y[en]=ne,ae=en);else if(pt<pe&&0>i(B,ne))Y[ae]=B,Y[pt]=ne,ae=pt;else break e}}return oe}function i(Y,oe){var ne=Y.sortIndex-oe.sortIndex;return ne!==0?ne:Y.id-oe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var c=[],d=[],p=1,_=null,m=3,S=!1,E=!1,A=!1,D=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(Y){for(var oe=t(d);oe!==null;){if(oe.callback===null)r(d);else if(oe.startTime<=Y)r(d),oe.sortIndex=oe.expirationTime,e(c,oe);else break;oe=t(d)}}function P(Y){if(A=!1,w(Y),!E)if(t(c)!==null)E=!0,ze(V);else{var oe=t(d);oe!==null&&De(P,oe.startTime-Y)}}function V(Y,oe){E=!1,A&&(A=!1,k(C),C=-1),S=!0;var ne=m;try{for(w(oe),_=t(c);_!==null&&(!(_.expirationTime>oe)||Y&&!L());){var ae=_.callback;if(typeof ae=="function"){_.callback=null,m=_.priorityLevel;var pe=ae(_.expirationTime<=oe);oe=n.unstable_now(),typeof pe=="function"?_.callback=pe:_===t(c)&&r(c),w(oe)}else r(c);_=t(c)}if(_!==null)var Se=!0;else{var en=t(d);en!==null&&De(P,en.startTime-oe),Se=!1}return Se}finally{_=null,m=ne,S=!1}}var U=!1,N=null,C=-1,O=5,x=-1;function L(){return!(n.unstable_now()-x<O)}function z(){if(N!==null){var Y=n.unstable_now();x=Y;var oe=!0;try{oe=N(!0,Y)}finally{oe?F():(U=!1,N=null)}}else U=!1}var F;if(typeof R=="function")F=function(){R(z)};else if(typeof MessageChannel<"u"){var fe=new MessageChannel,se=fe.port2;fe.port1.onmessage=z,F=function(){se.postMessage(null)}}else F=function(){D(z,0)};function ze(Y){N=Y,U||(U=!0,F())}function De(Y,oe){C=D(function(){Y(n.unstable_now())},oe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Y){Y.callback=null},n.unstable_continueExecution=function(){E||S||(E=!0,ze(V))},n.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<Y?Math.floor(1e3/Y):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(Y){switch(m){case 1:case 2:case 3:var oe=3;break;default:oe=m}var ne=m;m=oe;try{return Y()}finally{m=ne}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(Y,oe){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var ne=m;m=Y;try{return oe()}finally{m=ne}},n.unstable_scheduleCallback=function(Y,oe,ne){var ae=n.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?ae+ne:ae):ne=ae,Y){case 1:var pe=-1;break;case 2:pe=250;break;case 5:pe=1073741823;break;case 4:pe=1e4;break;default:pe=5e3}return pe=ne+pe,Y={id:p++,callback:oe,priorityLevel:Y,startTime:ne,expirationTime:pe,sortIndex:-1},ne>ae?(Y.sortIndex=ne,e(d,Y),t(c)===null&&Y===t(d)&&(A?(k(C),C=-1):A=!0,De(P,ne-ae))):(Y.sortIndex=pe,e(c,Y),E||S||(E=!0,ze(V))),Y},n.unstable_shouldYield=L,n.unstable_wrapCallback=function(Y){var oe=m;return function(){var ne=m;m=oe;try{return Y.apply(this,arguments)}finally{m=ne}}}})(q5);$5.exports=q5;var Oh=$5.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var w8=Ee,Br=Oh;function ee(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var K5=new Set,ed={};function fl(n,e){bu(n,e),bu(n+"Capture",e)}function bu(n,e){for(ed[n]=e,n=0;n<e.length;n++)K5.add(e[n])}var js=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Nv=Object.prototype.hasOwnProperty,E8=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,M4={},L4={};function S8(n){return Nv.call(L4,n)?!0:Nv.call(M4,n)?!1:E8.test(n)?L4[n]=!0:(M4[n]=!0,!1)}function T8(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function C8(n,e,t,r){if(e===null||typeof e>"u"||T8(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function gr(n,e,t,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Un={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Un[n]=new gr(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Un[e]=new gr(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Un[n]=new gr(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Un[n]=new gr(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Un[n]=new gr(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Un[n]=new gr(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Un[n]=new gr(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Un[n]=new gr(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Un[n]=new gr(n,5,!1,n.toLowerCase(),null,!1,!1)});var C2=/[\-:]([a-z])/g;function I2(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(C2,I2);Un[e]=new gr(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(C2,I2);Un[e]=new gr(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(C2,I2);Un[e]=new gr(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Un[n]=new gr(n,1,!1,n.toLowerCase(),null,!1,!1)});Un.xlinkHref=new gr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Un[n]=new gr(n,1,!1,n.toLowerCase(),null,!0,!0)});function P2(n,e,t,r){var i=Un.hasOwnProperty(e)?Un[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(C8(e,t,i,r)&&(t=null),r||i===null?S8(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,r=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var Js=w8.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ip=Symbol.for("react.element"),au=Symbol.for("react.portal"),lu=Symbol.for("react.fragment"),R2=Symbol.for("react.strict_mode"),Dv=Symbol.for("react.profiler"),Q5=Symbol.for("react.provider"),Y5=Symbol.for("react.context"),k2=Symbol.for("react.forward_ref"),Ov=Symbol.for("react.suspense"),bv=Symbol.for("react.suspense_list"),A2=Symbol.for("react.memo"),To=Symbol.for("react.lazy"),X5=Symbol.for("react.offscreen"),F4=Symbol.iterator;function sh(n){return n===null||typeof n!="object"?null:(n=F4&&n[F4]||n["@@iterator"],typeof n=="function"?n:null)}var Mt=Object.assign,Ry;function Sh(n){if(Ry===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Ry=e&&e[1]||""}return`
`+Ry+n}var ky=!1;function Ay(n,e){if(!n||ky)return"";ky=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(n,[],e)}else{try{e.call()}catch(d){r=d}n.call(e.prototype)}else{try{throw Error()}catch(d){r=d}n()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var c=`
`+i[o].replace(" at new "," at ");return n.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",n.displayName)),c}while(1<=o&&0<=l);break}}}finally{ky=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Sh(n):""}function I8(n){switch(n.tag){case 5:return Sh(n.type);case 16:return Sh("Lazy");case 13:return Sh("Suspense");case 19:return Sh("SuspenseList");case 0:case 2:case 15:return n=Ay(n.type,!1),n;case 11:return n=Ay(n.type.render,!1),n;case 1:return n=Ay(n.type,!0),n;default:return""}}function Mv(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case lu:return"Fragment";case au:return"Portal";case Dv:return"Profiler";case R2:return"StrictMode";case Ov:return"Suspense";case bv:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case Y5:return(n.displayName||"Context")+".Consumer";case Q5:return(n._context.displayName||"Context")+".Provider";case k2:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case A2:return e=n.displayName||null,e!==null?e:Mv(n.type)||"Memo";case To:e=n._payload,n=n._init;try{return Mv(n(e))}catch{}}return null}function P8(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Mv(e);case 8:return e===R2?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function $o(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function J5(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function R8(n){var e=J5(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Pp(n){n._valueTracker||(n._valueTracker=R8(n))}function Z5(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=J5(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function Cg(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Lv(n,e){var t=e.checked;return Mt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function V4(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=$o(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function eI(n,e){e=e.checked,e!=null&&P2(n,"checked",e,!1)}function Fv(n,e){eI(n,e);var t=$o(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?Vv(n,e.type,t):e.hasOwnProperty("defaultValue")&&Vv(n,e.type,$o(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function U4(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function Vv(n,e,t){(e!=="number"||Cg(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Th=Array.isArray;function Eu(n,e,t,r){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&r&&(n[t].defaultSelected=!0)}else{for(t=""+$o(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,r&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function Uv(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ee(91));return Mt({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function z4(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(ee(92));if(Th(t)){if(1<t.length)throw Error(ee(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:$o(t)}}function tI(n,e){var t=$o(e.value),r=$o(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function B4(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function nI(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function zv(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?nI(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Rp,rI=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Rp=Rp||document.createElement("div"),Rp.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Rp.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function td(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var bh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},k8=["Webkit","ms","Moz","O"];Object.keys(bh).forEach(function(n){k8.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),bh[e]=bh[n]})});function iI(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||bh.hasOwnProperty(n)&&bh[n]?(""+e).trim():e+"px"}function sI(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,i=iI(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,i):n[t]=i}}var A8=Mt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Bv(n,e){if(e){if(A8[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ee(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ee(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ee(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ee(62))}}function jv(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Gv=null;function x2(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Wv=null,Su=null,Tu=null;function j4(n){if(n=$d(n)){if(typeof Wv!="function")throw Error(ee(280));var e=n.stateNode;e&&(e=Um(e),Wv(n.stateNode,n.type,e))}}function oI(n){Su?Tu?Tu.push(n):Tu=[n]:Su=n}function aI(){if(Su){var n=Su,e=Tu;if(Tu=Su=null,j4(n),e)for(n=0;n<e.length;n++)j4(e[n])}}function lI(n,e){return n(e)}function uI(){}var xy=!1;function cI(n,e,t){if(xy)return n(e,t);xy=!0;try{return lI(n,e,t)}finally{xy=!1,(Su!==null||Tu!==null)&&(uI(),aI())}}function nd(n,e){var t=n.stateNode;if(t===null)return null;var r=Um(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(ee(231,e,typeof t));return t}var Hv=!1;if(js)try{var oh={};Object.defineProperty(oh,"passive",{get:function(){Hv=!0}}),window.addEventListener("test",oh,oh),window.removeEventListener("test",oh,oh)}catch{Hv=!1}function x8(n,e,t,r,i,s,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(t,d)}catch(p){this.onError(p)}}var Mh=!1,Ig=null,Pg=!1,$v=null,N8={onError:function(n){Mh=!0,Ig=n}};function D8(n,e,t,r,i,s,o,l,c){Mh=!1,Ig=null,x8.apply(N8,arguments)}function O8(n,e,t,r,i,s,o,l,c){if(D8.apply(this,arguments),Mh){if(Mh){var d=Ig;Mh=!1,Ig=null}else throw Error(ee(198));Pg||(Pg=!0,$v=d)}}function pl(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function hI(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function G4(n){if(pl(n)!==n)throw Error(ee(188))}function b8(n){var e=n.alternate;if(!e){if(e=pl(n),e===null)throw Error(ee(188));return e!==n?null:n}for(var t=n,r=e;;){var i=t.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){t=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===t)return G4(i),n;if(s===r)return G4(i),e;s=s.sibling}throw Error(ee(188))}if(t.return!==r.return)t=i,r=s;else{for(var o=!1,l=i.child;l;){if(l===t){o=!0,t=i,r=s;break}if(l===r){o=!0,r=i,t=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===t){o=!0,t=s,r=i;break}if(l===r){o=!0,r=s,t=i;break}l=l.sibling}if(!o)throw Error(ee(189))}}if(t.alternate!==r)throw Error(ee(190))}if(t.tag!==3)throw Error(ee(188));return t.stateNode.current===t?n:e}function dI(n){return n=b8(n),n!==null?fI(n):null}function fI(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=fI(n);if(e!==null)return e;n=n.sibling}return null}var pI=Br.unstable_scheduleCallback,W4=Br.unstable_cancelCallback,M8=Br.unstable_shouldYield,L8=Br.unstable_requestPaint,Gt=Br.unstable_now,F8=Br.unstable_getCurrentPriorityLevel,N2=Br.unstable_ImmediatePriority,gI=Br.unstable_UserBlockingPriority,Rg=Br.unstable_NormalPriority,V8=Br.unstable_LowPriority,mI=Br.unstable_IdlePriority,Mm=null,Zi=null;function U8(n){if(Zi&&typeof Zi.onCommitFiberRoot=="function")try{Zi.onCommitFiberRoot(Mm,n,void 0,(n.current.flags&128)===128)}catch{}}var Pi=Math.clz32?Math.clz32:j8,z8=Math.log,B8=Math.LN2;function j8(n){return n>>>=0,n===0?32:31-(z8(n)/B8|0)|0}var kp=64,Ap=4194304;function Ch(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function kg(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,i=n.suspendedLanes,s=n.pingedLanes,o=t&268435455;if(o!==0){var l=o&~i;l!==0?r=Ch(l):(s&=o,s!==0&&(r=Ch(s)))}else o=t&~i,o!==0?r=Ch(o):s!==0&&(r=Ch(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-Pi(e),i=1<<t,r|=n[t],e&=~i;return r}function G8(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function W8(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,i=n.expirationTimes,s=n.pendingLanes;0<s;){var o=31-Pi(s),l=1<<o,c=i[o];c===-1?(!(l&t)||l&r)&&(i[o]=G8(l,e)):c<=e&&(n.expiredLanes|=l),s&=~l}}function qv(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function _I(){var n=kp;return kp<<=1,!(kp&4194240)&&(kp=64),n}function Ny(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Wd(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Pi(e),n[e]=t}function H8(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-Pi(t),s=1<<i;e[i]=0,r[i]=-1,n[i]=-1,t&=~s}}function D2(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-Pi(t),i=1<<r;i&e|n[r]&e&&(n[r]|=e),t&=~i}}var ut=0;function yI(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var vI,O2,wI,EI,SI,Kv=!1,xp=[],Oo=null,bo=null,Mo=null,rd=new Map,id=new Map,Io=[],$8="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function H4(n,e){switch(n){case"focusin":case"focusout":Oo=null;break;case"dragenter":case"dragleave":bo=null;break;case"mouseover":case"mouseout":Mo=null;break;case"pointerover":case"pointerout":rd.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":id.delete(e.pointerId)}}function ah(n,e,t,r,i,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=$d(e),e!==null&&O2(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function q8(n,e,t,r,i){switch(e){case"focusin":return Oo=ah(Oo,n,e,t,r,i),!0;case"dragenter":return bo=ah(bo,n,e,t,r,i),!0;case"mouseover":return Mo=ah(Mo,n,e,t,r,i),!0;case"pointerover":var s=i.pointerId;return rd.set(s,ah(rd.get(s)||null,n,e,t,r,i)),!0;case"gotpointercapture":return s=i.pointerId,id.set(s,ah(id.get(s)||null,n,e,t,r,i)),!0}return!1}function TI(n){var e=Ba(n.target);if(e!==null){var t=pl(e);if(t!==null){if(e=t.tag,e===13){if(e=hI(t),e!==null){n.blockedOn=e,SI(n.priority,function(){wI(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function ng(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=Qv(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);Gv=r,t.target.dispatchEvent(r),Gv=null}else return e=$d(t),e!==null&&O2(e),n.blockedOn=t,!1;e.shift()}return!0}function $4(n,e,t){ng(n)&&t.delete(e)}function K8(){Kv=!1,Oo!==null&&ng(Oo)&&(Oo=null),bo!==null&&ng(bo)&&(bo=null),Mo!==null&&ng(Mo)&&(Mo=null),rd.forEach($4),id.forEach($4)}function lh(n,e){n.blockedOn===e&&(n.blockedOn=null,Kv||(Kv=!0,Br.unstable_scheduleCallback(Br.unstable_NormalPriority,K8)))}function sd(n){function e(i){return lh(i,n)}if(0<xp.length){lh(xp[0],n);for(var t=1;t<xp.length;t++){var r=xp[t];r.blockedOn===n&&(r.blockedOn=null)}}for(Oo!==null&&lh(Oo,n),bo!==null&&lh(bo,n),Mo!==null&&lh(Mo,n),rd.forEach(e),id.forEach(e),t=0;t<Io.length;t++)r=Io[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<Io.length&&(t=Io[0],t.blockedOn===null);)TI(t),t.blockedOn===null&&Io.shift()}var Cu=Js.ReactCurrentBatchConfig,Ag=!0;function Q8(n,e,t,r){var i=ut,s=Cu.transition;Cu.transition=null;try{ut=1,b2(n,e,t,r)}finally{ut=i,Cu.transition=s}}function Y8(n,e,t,r){var i=ut,s=Cu.transition;Cu.transition=null;try{ut=4,b2(n,e,t,r)}finally{ut=i,Cu.transition=s}}function b2(n,e,t,r){if(Ag){var i=Qv(n,e,t,r);if(i===null)By(n,e,r,xg,t),H4(n,r);else if(q8(i,n,e,t,r))r.stopPropagation();else if(H4(n,r),e&4&&-1<$8.indexOf(n)){for(;i!==null;){var s=$d(i);if(s!==null&&vI(s),s=Qv(n,e,t,r),s===null&&By(n,e,r,xg,t),s===i)break;i=s}i!==null&&r.stopPropagation()}else By(n,e,r,null,t)}}var xg=null;function Qv(n,e,t,r){if(xg=null,n=x2(r),n=Ba(n),n!==null)if(e=pl(n),e===null)n=null;else if(t=e.tag,t===13){if(n=hI(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return xg=n,null}function CI(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(F8()){case N2:return 1;case gI:return 4;case Rg:case V8:return 16;case mI:return 536870912;default:return 16}default:return 16}}var xo=null,M2=null,rg=null;function II(){if(rg)return rg;var n,e=M2,t=e.length,r,i="value"in xo?xo.value:xo.textContent,s=i.length;for(n=0;n<t&&e[n]===i[n];n++);var o=t-n;for(r=1;r<=o&&e[t-r]===i[s-r];r++);return rg=i.slice(n,1<r?1-r:void 0)}function ig(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Np(){return!0}function q4(){return!1}function Gr(n){function e(t,r,i,s,o){this._reactName=t,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in n)n.hasOwnProperty(l)&&(t=n[l],this[l]=t?t(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Np:q4,this.isPropagationStopped=q4,this}return Mt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Np)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Np)},persist:function(){},isPersistent:Np}),e}var sc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},L2=Gr(sc),Hd=Mt({},sc,{view:0,detail:0}),X8=Gr(Hd),Dy,Oy,uh,Lm=Mt({},Hd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:F2,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==uh&&(uh&&n.type==="mousemove"?(Dy=n.screenX-uh.screenX,Oy=n.screenY-uh.screenY):Oy=Dy=0,uh=n),Dy)},movementY:function(n){return"movementY"in n?n.movementY:Oy}}),K4=Gr(Lm),J8=Mt({},Lm,{dataTransfer:0}),Z8=Gr(J8),ex=Mt({},Hd,{relatedTarget:0}),by=Gr(ex),tx=Mt({},sc,{animationName:0,elapsedTime:0,pseudoElement:0}),nx=Gr(tx),rx=Mt({},sc,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),ix=Gr(rx),sx=Mt({},sc,{data:0}),Q4=Gr(sx),ox={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ax={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ux(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=lx[n])?!!e[n]:!1}function F2(){return ux}var cx=Mt({},Hd,{key:function(n){if(n.key){var e=ox[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=ig(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?ax[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:F2,charCode:function(n){return n.type==="keypress"?ig(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?ig(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),hx=Gr(cx),dx=Mt({},Lm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Y4=Gr(dx),fx=Mt({},Hd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:F2}),px=Gr(fx),gx=Mt({},sc,{propertyName:0,elapsedTime:0,pseudoElement:0}),mx=Gr(gx),_x=Mt({},Lm,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),yx=Gr(_x),vx=[9,13,27,32],V2=js&&"CompositionEvent"in window,Lh=null;js&&"documentMode"in document&&(Lh=document.documentMode);var wx=js&&"TextEvent"in window&&!Lh,PI=js&&(!V2||Lh&&8<Lh&&11>=Lh),X4=" ",J4=!1;function RI(n,e){switch(n){case"keyup":return vx.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function kI(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var uu=!1;function Ex(n,e){switch(n){case"compositionend":return kI(e);case"keypress":return e.which!==32?null:(J4=!0,X4);case"textInput":return n=e.data,n===X4&&J4?null:n;default:return null}}function Sx(n,e){if(uu)return n==="compositionend"||!V2&&RI(n,e)?(n=II(),rg=M2=xo=null,uu=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return PI&&e.locale!=="ko"?null:e.data;default:return null}}var Tx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Z4(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!Tx[n.type]:e==="textarea"}function AI(n,e,t,r){oI(r),e=Ng(e,"onChange"),0<e.length&&(t=new L2("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var Fh=null,od=null;function Cx(n){zI(n,0)}function Fm(n){var e=du(n);if(Z5(e))return n}function Ix(n,e){if(n==="change")return e}var xI=!1;if(js){var My;if(js){var Ly="oninput"in document;if(!Ly){var eT=document.createElement("div");eT.setAttribute("oninput","return;"),Ly=typeof eT.oninput=="function"}My=Ly}else My=!1;xI=My&&(!document.documentMode||9<document.documentMode)}function tT(){Fh&&(Fh.detachEvent("onpropertychange",NI),od=Fh=null)}function NI(n){if(n.propertyName==="value"&&Fm(od)){var e=[];AI(e,od,n,x2(n)),cI(Cx,e)}}function Px(n,e,t){n==="focusin"?(tT(),Fh=e,od=t,Fh.attachEvent("onpropertychange",NI)):n==="focusout"&&tT()}function Rx(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Fm(od)}function kx(n,e){if(n==="click")return Fm(e)}function Ax(n,e){if(n==="input"||n==="change")return Fm(e)}function xx(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Ni=typeof Object.is=="function"?Object.is:xx;function ad(n,e){if(Ni(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var i=t[r];if(!Nv.call(e,i)||!Ni(n[i],e[i]))return!1}return!0}function nT(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function rT(n,e){var t=nT(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=nT(t)}}function DI(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?DI(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function OI(){for(var n=window,e=Cg();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=Cg(n.document)}return e}function U2(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function Nx(n){var e=OI(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&DI(t.ownerDocument.documentElement,t)){if(r!==null&&U2(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!n.extend&&s>r&&(i=r,r=s,s=i),i=rT(t,s);var o=rT(t,r);i&&o&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),s>r?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var Dx=js&&"documentMode"in document&&11>=document.documentMode,cu=null,Yv=null,Vh=null,Xv=!1;function iT(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Xv||cu==null||cu!==Cg(r)||(r=cu,"selectionStart"in r&&U2(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Vh&&ad(Vh,r)||(Vh=r,r=Ng(Yv,"onSelect"),0<r.length&&(e=new L2("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=cu)))}function Dp(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var hu={animationend:Dp("Animation","AnimationEnd"),animationiteration:Dp("Animation","AnimationIteration"),animationstart:Dp("Animation","AnimationStart"),transitionend:Dp("Transition","TransitionEnd")},Fy={},bI={};js&&(bI=document.createElement("div").style,"AnimationEvent"in window||(delete hu.animationend.animation,delete hu.animationiteration.animation,delete hu.animationstart.animation),"TransitionEvent"in window||delete hu.transitionend.transition);function Vm(n){if(Fy[n])return Fy[n];if(!hu[n])return n;var e=hu[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in bI)return Fy[n]=e[t];return n}var MI=Vm("animationend"),LI=Vm("animationiteration"),FI=Vm("animationstart"),VI=Vm("transitionend"),UI=new Map,sT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function na(n,e){UI.set(n,e),fl(e,[n])}for(var Vy=0;Vy<sT.length;Vy++){var Uy=sT[Vy],Ox=Uy.toLowerCase(),bx=Uy[0].toUpperCase()+Uy.slice(1);na(Ox,"on"+bx)}na(MI,"onAnimationEnd");na(LI,"onAnimationIteration");na(FI,"onAnimationStart");na("dblclick","onDoubleClick");na("focusin","onFocus");na("focusout","onBlur");na(VI,"onTransitionEnd");bu("onMouseEnter",["mouseout","mouseover"]);bu("onMouseLeave",["mouseout","mouseover"]);bu("onPointerEnter",["pointerout","pointerover"]);bu("onPointerLeave",["pointerout","pointerover"]);fl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fl("onBeforeInput",["compositionend","keypress","textInput","paste"]);fl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ih="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mx=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ih));function oT(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,O8(r,e,void 0,n),n.currentTarget=null}function zI(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==s&&i.isPropagationStopped())break e;oT(i,l,d),s=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==s&&i.isPropagationStopped())break e;oT(i,l,d),s=c}}}if(Pg)throw n=$v,Pg=!1,$v=null,n}function Tt(n,e){var t=e[n1];t===void 0&&(t=e[n1]=new Set);var r=n+"__bubble";t.has(r)||(BI(e,n,2,!1),t.add(r))}function zy(n,e,t){var r=0;e&&(r|=4),BI(t,n,r,e)}var Op="_reactListening"+Math.random().toString(36).slice(2);function ld(n){if(!n[Op]){n[Op]=!0,K5.forEach(function(t){t!=="selectionchange"&&(Mx.has(t)||zy(t,!1,n),zy(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Op]||(e[Op]=!0,zy("selectionchange",!1,e))}}function BI(n,e,t,r){switch(CI(e)){case 1:var i=Q8;break;case 4:i=Y8;break;default:i=b2}t=i.bind(null,e,t,n),i=void 0,!Hv||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function By(n,e,t,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=Ba(l),o===null)return;if(c=o.tag,c===5||c===6){r=s=o;continue e}l=l.parentNode}}r=r.return}cI(function(){var d=s,p=x2(t),_=[];e:{var m=UI.get(n);if(m!==void 0){var S=L2,E=n;switch(n){case"keypress":if(ig(t)===0)break e;case"keydown":case"keyup":S=hx;break;case"focusin":E="focus",S=by;break;case"focusout":E="blur",S=by;break;case"beforeblur":case"afterblur":S=by;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":S=K4;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":S=Z8;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":S=px;break;case MI:case LI:case FI:S=nx;break;case VI:S=mx;break;case"scroll":S=X8;break;case"wheel":S=yx;break;case"copy":case"cut":case"paste":S=ix;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":S=Y4}var A=(e&4)!==0,D=!A&&n==="scroll",k=A?m!==null?m+"Capture":null:m;A=[];for(var R=d,w;R!==null;){w=R;var P=w.stateNode;if(w.tag===5&&P!==null&&(w=P,k!==null&&(P=nd(R,k),P!=null&&A.push(ud(R,P,w)))),D)break;R=R.return}0<A.length&&(m=new S(m,E,null,t,p),_.push({event:m,listeners:A}))}}if(!(e&7)){e:{if(m=n==="mouseover"||n==="pointerover",S=n==="mouseout"||n==="pointerout",m&&t!==Gv&&(E=t.relatedTarget||t.fromElement)&&(Ba(E)||E[Gs]))break e;if((S||m)&&(m=p.window===p?p:(m=p.ownerDocument)?m.defaultView||m.parentWindow:window,S?(E=t.relatedTarget||t.toElement,S=d,E=E?Ba(E):null,E!==null&&(D=pl(E),E!==D||E.tag!==5&&E.tag!==6)&&(E=null)):(S=null,E=d),S!==E)){if(A=K4,P="onMouseLeave",k="onMouseEnter",R="mouse",(n==="pointerout"||n==="pointerover")&&(A=Y4,P="onPointerLeave",k="onPointerEnter",R="pointer"),D=S==null?m:du(S),w=E==null?m:du(E),m=new A(P,R+"leave",S,t,p),m.target=D,m.relatedTarget=w,P=null,Ba(p)===d&&(A=new A(k,R+"enter",E,t,p),A.target=w,A.relatedTarget=D,P=A),D=P,S&&E)t:{for(A=S,k=E,R=0,w=A;w;w=Jl(w))R++;for(w=0,P=k;P;P=Jl(P))w++;for(;0<R-w;)A=Jl(A),R--;for(;0<w-R;)k=Jl(k),w--;for(;R--;){if(A===k||k!==null&&A===k.alternate)break t;A=Jl(A),k=Jl(k)}A=null}else A=null;S!==null&&aT(_,m,S,A,!1),E!==null&&D!==null&&aT(_,D,E,A,!0)}}e:{if(m=d?du(d):window,S=m.nodeName&&m.nodeName.toLowerCase(),S==="select"||S==="input"&&m.type==="file")var V=Ix;else if(Z4(m))if(xI)V=Ax;else{V=Rx;var U=Px}else(S=m.nodeName)&&S.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(V=kx);if(V&&(V=V(n,d))){AI(_,V,t,p);break e}U&&U(n,m,d),n==="focusout"&&(U=m._wrapperState)&&U.controlled&&m.type==="number"&&Vv(m,"number",m.value)}switch(U=d?du(d):window,n){case"focusin":(Z4(U)||U.contentEditable==="true")&&(cu=U,Yv=d,Vh=null);break;case"focusout":Vh=Yv=cu=null;break;case"mousedown":Xv=!0;break;case"contextmenu":case"mouseup":case"dragend":Xv=!1,iT(_,t,p);break;case"selectionchange":if(Dx)break;case"keydown":case"keyup":iT(_,t,p)}var N;if(V2)e:{switch(n){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else uu?RI(n,t)&&(C="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(C="onCompositionStart");C&&(PI&&t.locale!=="ko"&&(uu||C!=="onCompositionStart"?C==="onCompositionEnd"&&uu&&(N=II()):(xo=p,M2="value"in xo?xo.value:xo.textContent,uu=!0)),U=Ng(d,C),0<U.length&&(C=new Q4(C,n,null,t,p),_.push({event:C,listeners:U}),N?C.data=N:(N=kI(t),N!==null&&(C.data=N)))),(N=wx?Ex(n,t):Sx(n,t))&&(d=Ng(d,"onBeforeInput"),0<d.length&&(p=new Q4("onBeforeInput","beforeinput",null,t,p),_.push({event:p,listeners:d}),p.data=N))}zI(_,e)})}function ud(n,e,t){return{instance:n,listener:e,currentTarget:t}}function Ng(n,e){for(var t=e+"Capture",r=[];n!==null;){var i=n,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=nd(n,t),s!=null&&r.unshift(ud(n,s,i)),s=nd(n,e),s!=null&&r.push(ud(n,s,i))),n=n.return}return r}function Jl(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function aT(n,e,t,r,i){for(var s=e._reactName,o=[];t!==null&&t!==r;){var l=t,c=l.alternate,d=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&d!==null&&(l=d,i?(c=nd(t,s),c!=null&&o.unshift(ud(t,c,l))):i||(c=nd(t,s),c!=null&&o.push(ud(t,c,l)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var Lx=/\r\n?/g,Fx=/\u0000|\uFFFD/g;function lT(n){return(typeof n=="string"?n:""+n).replace(Lx,`
`).replace(Fx,"")}function bp(n,e,t){if(e=lT(e),lT(n)!==e&&t)throw Error(ee(425))}function Dg(){}var Jv=null,Zv=null;function e1(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var t1=typeof setTimeout=="function"?setTimeout:void 0,Vx=typeof clearTimeout=="function"?clearTimeout:void 0,uT=typeof Promise=="function"?Promise:void 0,Ux=typeof queueMicrotask=="function"?queueMicrotask:typeof uT<"u"?function(n){return uT.resolve(null).then(n).catch(zx)}:t1;function zx(n){setTimeout(function(){throw n})}function jy(n,e){var t=e,r=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(r===0){n.removeChild(i),sd(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=i}while(t);sd(e)}function Lo(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function cT(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var oc=Math.random().toString(36).slice(2),Xi="__reactFiber$"+oc,cd="__reactProps$"+oc,Gs="__reactContainer$"+oc,n1="__reactEvents$"+oc,Bx="__reactListeners$"+oc,jx="__reactHandles$"+oc;function Ba(n){var e=n[Xi];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Gs]||t[Xi]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=cT(n);n!==null;){if(t=n[Xi])return t;n=cT(n)}return e}n=t,t=n.parentNode}return null}function $d(n){return n=n[Xi]||n[Gs],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function du(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(ee(33))}function Um(n){return n[cd]||null}var r1=[],fu=-1;function ra(n){return{current:n}}function It(n){0>fu||(n.current=r1[fu],r1[fu]=null,fu--)}function Et(n,e){fu++,r1[fu]=n.current,n.current=e}var qo={},nr=ra(qo),Ar=ra(!1),Xa=qo;function Mu(n,e){var t=n.type.contextTypes;if(!t)return qo;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in t)i[s]=e[s];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function xr(n){return n=n.childContextTypes,n!=null}function Og(){It(Ar),It(nr)}function hT(n,e,t){if(nr.current!==qo)throw Error(ee(168));Et(nr,e),Et(Ar,t)}function jI(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ee(108,P8(n)||"Unknown",i));return Mt({},t,r)}function bg(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||qo,Xa=nr.current,Et(nr,n),Et(Ar,Ar.current),!0}function dT(n,e,t){var r=n.stateNode;if(!r)throw Error(ee(169));t?(n=jI(n,e,Xa),r.__reactInternalMemoizedMergedChildContext=n,It(Ar),It(nr),Et(nr,n)):It(Ar),Et(Ar,t)}var ks=null,zm=!1,Gy=!1;function GI(n){ks===null?ks=[n]:ks.push(n)}function Gx(n){zm=!0,GI(n)}function ia(){if(!Gy&&ks!==null){Gy=!0;var n=0,e=ut;try{var t=ks;for(ut=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}ks=null,zm=!1}catch(i){throw ks!==null&&(ks=ks.slice(n+1)),pI(N2,ia),i}finally{ut=e,Gy=!1}}return null}var pu=[],gu=0,Mg=null,Lg=0,Zr=[],ei=0,Ja=null,Ns=1,Ds="";function La(n,e){pu[gu++]=Lg,pu[gu++]=Mg,Mg=n,Lg=e}function WI(n,e,t){Zr[ei++]=Ns,Zr[ei++]=Ds,Zr[ei++]=Ja,Ja=n;var r=Ns;n=Ds;var i=32-Pi(r)-1;r&=~(1<<i),t+=1;var s=32-Pi(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Ns=1<<32-Pi(e)+i|t<<i|r,Ds=s+n}else Ns=1<<s|t<<i|r,Ds=n}function z2(n){n.return!==null&&(La(n,1),WI(n,1,0))}function B2(n){for(;n===Mg;)Mg=pu[--gu],pu[gu]=null,Lg=pu[--gu],pu[gu]=null;for(;n===Ja;)Ja=Zr[--ei],Zr[ei]=null,Ds=Zr[--ei],Zr[ei]=null,Ns=Zr[--ei],Zr[ei]=null}var Ur=null,Fr=null,Rt=!1,Si=null;function HI(n,e){var t=ti(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function fT(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Ur=n,Fr=Lo(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Ur=n,Fr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Ja!==null?{id:Ns,overflow:Ds}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=ti(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Ur=n,Fr=null,!0):!1;default:return!1}}function i1(n){return(n.mode&1)!==0&&(n.flags&128)===0}function s1(n){if(Rt){var e=Fr;if(e){var t=e;if(!fT(n,e)){if(i1(n))throw Error(ee(418));e=Lo(t.nextSibling);var r=Ur;e&&fT(n,e)?HI(r,t):(n.flags=n.flags&-4097|2,Rt=!1,Ur=n)}}else{if(i1(n))throw Error(ee(418));n.flags=n.flags&-4097|2,Rt=!1,Ur=n}}}function pT(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Ur=n}function Mp(n){if(n!==Ur)return!1;if(!Rt)return pT(n),Rt=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!e1(n.type,n.memoizedProps)),e&&(e=Fr)){if(i1(n))throw $I(),Error(ee(418));for(;e;)HI(n,e),e=Lo(e.nextSibling)}if(pT(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(ee(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Fr=Lo(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Fr=null}}else Fr=Ur?Lo(n.stateNode.nextSibling):null;return!0}function $I(){for(var n=Fr;n;)n=Lo(n.nextSibling)}function Lu(){Fr=Ur=null,Rt=!1}function j2(n){Si===null?Si=[n]:Si.push(n)}var Wx=Js.ReactCurrentBatchConfig;function ch(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(ee(309));var r=t.stateNode}if(!r)throw Error(ee(147,n));var i=r,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},e._stringRef=s,e)}if(typeof n!="string")throw Error(ee(284));if(!t._owner)throw Error(ee(290,n))}return n}function Lp(n,e){throw n=Object.prototype.toString.call(e),Error(ee(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function gT(n){var e=n._init;return e(n._payload)}function qI(n){function e(k,R){if(n){var w=k.deletions;w===null?(k.deletions=[R],k.flags|=16):w.push(R)}}function t(k,R){if(!n)return null;for(;R!==null;)e(k,R),R=R.sibling;return null}function r(k,R){for(k=new Map;R!==null;)R.key!==null?k.set(R.key,R):k.set(R.index,R),R=R.sibling;return k}function i(k,R){return k=zo(k,R),k.index=0,k.sibling=null,k}function s(k,R,w){return k.index=w,n?(w=k.alternate,w!==null?(w=w.index,w<R?(k.flags|=2,R):w):(k.flags|=2,R)):(k.flags|=1048576,R)}function o(k){return n&&k.alternate===null&&(k.flags|=2),k}function l(k,R,w,P){return R===null||R.tag!==6?(R=Yy(w,k.mode,P),R.return=k,R):(R=i(R,w),R.return=k,R)}function c(k,R,w,P){var V=w.type;return V===lu?p(k,R,w.props.children,P,w.key):R!==null&&(R.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===To&&gT(V)===R.type)?(P=i(R,w.props),P.ref=ch(k,R,w),P.return=k,P):(P=hg(w.type,w.key,w.props,null,k.mode,P),P.ref=ch(k,R,w),P.return=k,P)}function d(k,R,w,P){return R===null||R.tag!==4||R.stateNode.containerInfo!==w.containerInfo||R.stateNode.implementation!==w.implementation?(R=Xy(w,k.mode,P),R.return=k,R):(R=i(R,w.children||[]),R.return=k,R)}function p(k,R,w,P,V){return R===null||R.tag!==7?(R=Qa(w,k.mode,P,V),R.return=k,R):(R=i(R,w),R.return=k,R)}function _(k,R,w){if(typeof R=="string"&&R!==""||typeof R=="number")return R=Yy(""+R,k.mode,w),R.return=k,R;if(typeof R=="object"&&R!==null){switch(R.$$typeof){case Ip:return w=hg(R.type,R.key,R.props,null,k.mode,w),w.ref=ch(k,null,R),w.return=k,w;case au:return R=Xy(R,k.mode,w),R.return=k,R;case To:var P=R._init;return _(k,P(R._payload),w)}if(Th(R)||sh(R))return R=Qa(R,k.mode,w,null),R.return=k,R;Lp(k,R)}return null}function m(k,R,w,P){var V=R!==null?R.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return V!==null?null:l(k,R,""+w,P);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Ip:return w.key===V?c(k,R,w,P):null;case au:return w.key===V?d(k,R,w,P):null;case To:return V=w._init,m(k,R,V(w._payload),P)}if(Th(w)||sh(w))return V!==null?null:p(k,R,w,P,null);Lp(k,w)}return null}function S(k,R,w,P,V){if(typeof P=="string"&&P!==""||typeof P=="number")return k=k.get(w)||null,l(R,k,""+P,V);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case Ip:return k=k.get(P.key===null?w:P.key)||null,c(R,k,P,V);case au:return k=k.get(P.key===null?w:P.key)||null,d(R,k,P,V);case To:var U=P._init;return S(k,R,w,U(P._payload),V)}if(Th(P)||sh(P))return k=k.get(w)||null,p(R,k,P,V,null);Lp(R,P)}return null}function E(k,R,w,P){for(var V=null,U=null,N=R,C=R=0,O=null;N!==null&&C<w.length;C++){N.index>C?(O=N,N=null):O=N.sibling;var x=m(k,N,w[C],P);if(x===null){N===null&&(N=O);break}n&&N&&x.alternate===null&&e(k,N),R=s(x,R,C),U===null?V=x:U.sibling=x,U=x,N=O}if(C===w.length)return t(k,N),Rt&&La(k,C),V;if(N===null){for(;C<w.length;C++)N=_(k,w[C],P),N!==null&&(R=s(N,R,C),U===null?V=N:U.sibling=N,U=N);return Rt&&La(k,C),V}for(N=r(k,N);C<w.length;C++)O=S(N,k,C,w[C],P),O!==null&&(n&&O.alternate!==null&&N.delete(O.key===null?C:O.key),R=s(O,R,C),U===null?V=O:U.sibling=O,U=O);return n&&N.forEach(function(L){return e(k,L)}),Rt&&La(k,C),V}function A(k,R,w,P){var V=sh(w);if(typeof V!="function")throw Error(ee(150));if(w=V.call(w),w==null)throw Error(ee(151));for(var U=V=null,N=R,C=R=0,O=null,x=w.next();N!==null&&!x.done;C++,x=w.next()){N.index>C?(O=N,N=null):O=N.sibling;var L=m(k,N,x.value,P);if(L===null){N===null&&(N=O);break}n&&N&&L.alternate===null&&e(k,N),R=s(L,R,C),U===null?V=L:U.sibling=L,U=L,N=O}if(x.done)return t(k,N),Rt&&La(k,C),V;if(N===null){for(;!x.done;C++,x=w.next())x=_(k,x.value,P),x!==null&&(R=s(x,R,C),U===null?V=x:U.sibling=x,U=x);return Rt&&La(k,C),V}for(N=r(k,N);!x.done;C++,x=w.next())x=S(N,k,C,x.value,P),x!==null&&(n&&x.alternate!==null&&N.delete(x.key===null?C:x.key),R=s(x,R,C),U===null?V=x:U.sibling=x,U=x);return n&&N.forEach(function(z){return e(k,z)}),Rt&&La(k,C),V}function D(k,R,w,P){if(typeof w=="object"&&w!==null&&w.type===lu&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Ip:e:{for(var V=w.key,U=R;U!==null;){if(U.key===V){if(V=w.type,V===lu){if(U.tag===7){t(k,U.sibling),R=i(U,w.props.children),R.return=k,k=R;break e}}else if(U.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===To&&gT(V)===U.type){t(k,U.sibling),R=i(U,w.props),R.ref=ch(k,U,w),R.return=k,k=R;break e}t(k,U);break}else e(k,U);U=U.sibling}w.type===lu?(R=Qa(w.props.children,k.mode,P,w.key),R.return=k,k=R):(P=hg(w.type,w.key,w.props,null,k.mode,P),P.ref=ch(k,R,w),P.return=k,k=P)}return o(k);case au:e:{for(U=w.key;R!==null;){if(R.key===U)if(R.tag===4&&R.stateNode.containerInfo===w.containerInfo&&R.stateNode.implementation===w.implementation){t(k,R.sibling),R=i(R,w.children||[]),R.return=k,k=R;break e}else{t(k,R);break}else e(k,R);R=R.sibling}R=Xy(w,k.mode,P),R.return=k,k=R}return o(k);case To:return U=w._init,D(k,R,U(w._payload),P)}if(Th(w))return E(k,R,w,P);if(sh(w))return A(k,R,w,P);Lp(k,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,R!==null&&R.tag===6?(t(k,R.sibling),R=i(R,w),R.return=k,k=R):(t(k,R),R=Yy(w,k.mode,P),R.return=k,k=R),o(k)):t(k,R)}return D}var Fu=qI(!0),KI=qI(!1),Fg=ra(null),Vg=null,mu=null,G2=null;function W2(){G2=mu=Vg=null}function H2(n){var e=Fg.current;It(Fg),n._currentValue=e}function o1(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function Iu(n,e){Vg=n,G2=mu=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Pr=!0),n.firstContext=null)}function si(n){var e=n._currentValue;if(G2!==n)if(n={context:n,memoizedValue:e,next:null},mu===null){if(Vg===null)throw Error(ee(308));mu=n,Vg.dependencies={lanes:0,firstContext:n}}else mu=mu.next=n;return e}var ja=null;function $2(n){ja===null?ja=[n]:ja.push(n)}function QI(n,e,t,r){var i=e.interleaved;return i===null?(t.next=t,$2(e)):(t.next=i.next,i.next=t),e.interleaved=t,Ws(n,r)}function Ws(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Co=!1;function q2(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function YI(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Fs(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Fo(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,Je&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Ws(n,t)}return i=r.interleaved,i===null?(e.next=e,$2(r)):(e.next=i.next,i.next=e),r.interleaved=e,Ws(n,t)}function sg(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,D2(n,t)}}function mT(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var i=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?i=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?i=s=e:s=s.next=e}else i=s=e;t={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Ug(n,e,t,r){var i=n.updateQueue;Co=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?s=d:o.next=d,o=c;var p=n.alternate;p!==null&&(p=p.updateQueue,l=p.lastBaseUpdate,l!==o&&(l===null?p.firstBaseUpdate=d:l.next=d,p.lastBaseUpdate=c))}if(s!==null){var _=i.baseState;o=0,p=d=c=null,l=s;do{var m=l.lane,S=l.eventTime;if((r&m)===m){p!==null&&(p=p.next={eventTime:S,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var E=n,A=l;switch(m=e,S=t,A.tag){case 1:if(E=A.payload,typeof E=="function"){_=E.call(S,_,m);break e}_=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=A.payload,m=typeof E=="function"?E.call(S,_,m):E,m==null)break e;_=Mt({},_,m);break e;case 2:Co=!0}}l.callback!==null&&l.lane!==0&&(n.flags|=64,m=i.effects,m===null?i.effects=[l]:m.push(l))}else S={eventTime:S,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},p===null?(d=p=S,c=_):p=p.next=S,o|=m;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;m=l,l=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);if(p===null&&(c=_),i.baseState=c,i.firstBaseUpdate=d,i.lastBaseUpdate=p,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);el|=o,n.lanes=o,n.memoizedState=_}}function _T(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],i=r.callback;if(i!==null){if(r.callback=null,r=t,typeof i!="function")throw Error(ee(191,i));i.call(r)}}}var qd={},es=ra(qd),hd=ra(qd),dd=ra(qd);function Ga(n){if(n===qd)throw Error(ee(174));return n}function K2(n,e){switch(Et(dd,e),Et(hd,n),Et(es,qd),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:zv(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=zv(e,n)}It(es),Et(es,e)}function Vu(){It(es),It(hd),It(dd)}function XI(n){Ga(dd.current);var e=Ga(es.current),t=zv(e,n.type);e!==t&&(Et(hd,n),Et(es,t))}function Q2(n){hd.current===n&&(It(es),It(hd))}var Dt=ra(0);function zg(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Wy=[];function Y2(){for(var n=0;n<Wy.length;n++)Wy[n]._workInProgressVersionPrimary=null;Wy.length=0}var og=Js.ReactCurrentDispatcher,Hy=Js.ReactCurrentBatchConfig,Za=0,bt=null,an=null,En=null,Bg=!1,Uh=!1,fd=0,Hx=0;function Qn(){throw Error(ee(321))}function X2(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Ni(n[t],e[t]))return!1;return!0}function J2(n,e,t,r,i,s){if(Za=s,bt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,og.current=n===null||n.memoizedState===null?Qx:Yx,n=t(r,i),Uh){s=0;do{if(Uh=!1,fd=0,25<=s)throw Error(ee(301));s+=1,En=an=null,e.updateQueue=null,og.current=Xx,n=t(r,i)}while(Uh)}if(og.current=jg,e=an!==null&&an.next!==null,Za=0,En=an=bt=null,Bg=!1,e)throw Error(ee(300));return n}function Z2(){var n=fd!==0;return fd=0,n}function Yi(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return En===null?bt.memoizedState=En=n:En=En.next=n,En}function oi(){if(an===null){var n=bt.alternate;n=n!==null?n.memoizedState:null}else n=an.next;var e=En===null?bt.memoizedState:En.next;if(e!==null)En=e,an=n;else{if(n===null)throw Error(ee(310));an=n,n={memoizedState:an.memoizedState,baseState:an.baseState,baseQueue:an.baseQueue,queue:an.queue,next:null},En===null?bt.memoizedState=En=n:En=En.next=n}return En}function pd(n,e){return typeof e=="function"?e(n):e}function $y(n){var e=oi(),t=e.queue;if(t===null)throw Error(ee(311));t.lastRenderedReducer=n;var r=an,i=r.baseQueue,s=t.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,t.pending=null}if(i!==null){s=i.next,r=r.baseState;var l=o=null,c=null,d=s;do{var p=d.lane;if((Za&p)===p)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:n(r,d.action);else{var _={lane:p,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=_,o=r):c=c.next=_,bt.lanes|=p,el|=p}d=d.next}while(d!==null&&d!==s);c===null?o=r:c.next=l,Ni(r,e.memoizedState)||(Pr=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,t.lastRenderedState=r}if(n=t.interleaved,n!==null){i=n;do s=i.lane,bt.lanes|=s,el|=s,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function qy(n){var e=oi(),t=e.queue;if(t===null)throw Error(ee(311));t.lastRenderedReducer=n;var r=t.dispatch,i=t.pending,s=e.memoizedState;if(i!==null){t.pending=null;var o=i=i.next;do s=n(s,o.action),o=o.next;while(o!==i);Ni(s,e.memoizedState)||(Pr=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,r]}function JI(){}function ZI(n,e){var t=bt,r=oi(),i=e(),s=!Ni(r.memoizedState,i);if(s&&(r.memoizedState=i,Pr=!0),r=r.queue,ew(n6.bind(null,t,r,n),[n]),r.getSnapshot!==e||s||En!==null&&En.memoizedState.tag&1){if(t.flags|=2048,gd(9,t6.bind(null,t,r,i,e),void 0,null),In===null)throw Error(ee(349));Za&30||e6(t,e,i)}return i}function e6(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=bt.updateQueue,e===null?(e={lastEffect:null,stores:null},bt.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function t6(n,e,t,r){e.value=t,e.getSnapshot=r,r6(e)&&i6(n)}function n6(n,e,t){return t(function(){r6(e)&&i6(n)})}function r6(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Ni(n,t)}catch{return!0}}function i6(n){var e=Ws(n,1);e!==null&&Ri(e,n,1,-1)}function yT(n){var e=Yi();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:pd,lastRenderedState:n},e.queue=n,n=n.dispatch=Kx.bind(null,bt,n),[e.memoizedState,n]}function gd(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=bt.updateQueue,e===null?(e={lastEffect:null,stores:null},bt.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function s6(){return oi().memoizedState}function ag(n,e,t,r){var i=Yi();bt.flags|=n,i.memoizedState=gd(1|e,t,void 0,r===void 0?null:r)}function Bm(n,e,t,r){var i=oi();r=r===void 0?null:r;var s=void 0;if(an!==null){var o=an.memoizedState;if(s=o.destroy,r!==null&&X2(r,o.deps)){i.memoizedState=gd(e,t,s,r);return}}bt.flags|=n,i.memoizedState=gd(1|e,t,s,r)}function vT(n,e){return ag(8390656,8,n,e)}function ew(n,e){return Bm(2048,8,n,e)}function o6(n,e){return Bm(4,2,n,e)}function a6(n,e){return Bm(4,4,n,e)}function l6(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function u6(n,e,t){return t=t!=null?t.concat([n]):null,Bm(4,4,l6.bind(null,e,n),t)}function tw(){}function c6(n,e){var t=oi();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&X2(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function h6(n,e){var t=oi();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&X2(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function d6(n,e,t){return Za&21?(Ni(t,e)||(t=_I(),bt.lanes|=t,el|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Pr=!0),n.memoizedState=t)}function $x(n,e){var t=ut;ut=t!==0&&4>t?t:4,n(!0);var r=Hy.transition;Hy.transition={};try{n(!1),e()}finally{ut=t,Hy.transition=r}}function f6(){return oi().memoizedState}function qx(n,e,t){var r=Uo(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},p6(n))g6(e,t);else if(t=QI(n,e,t,r),t!==null){var i=fr();Ri(t,n,r,i),m6(t,e,r)}}function Kx(n,e,t){var r=Uo(n),i={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(p6(n))g6(e,i);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,l=s(o,t);if(i.hasEagerState=!0,i.eagerState=l,Ni(l,o)){var c=e.interleaved;c===null?(i.next=i,$2(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}t=QI(n,e,i,r),t!==null&&(i=fr(),Ri(t,n,r,i),m6(t,e,r))}}function p6(n){var e=n.alternate;return n===bt||e!==null&&e===bt}function g6(n,e){Uh=Bg=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function m6(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,D2(n,t)}}var jg={readContext:si,useCallback:Qn,useContext:Qn,useEffect:Qn,useImperativeHandle:Qn,useInsertionEffect:Qn,useLayoutEffect:Qn,useMemo:Qn,useReducer:Qn,useRef:Qn,useState:Qn,useDebugValue:Qn,useDeferredValue:Qn,useTransition:Qn,useMutableSource:Qn,useSyncExternalStore:Qn,useId:Qn,unstable_isNewReconciler:!1},Qx={readContext:si,useCallback:function(n,e){return Yi().memoizedState=[n,e===void 0?null:e],n},useContext:si,useEffect:vT,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,ag(4194308,4,l6.bind(null,e,n),t)},useLayoutEffect:function(n,e){return ag(4194308,4,n,e)},useInsertionEffect:function(n,e){return ag(4,2,n,e)},useMemo:function(n,e){var t=Yi();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=Yi();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=qx.bind(null,bt,n),[r.memoizedState,n]},useRef:function(n){var e=Yi();return n={current:n},e.memoizedState=n},useState:yT,useDebugValue:tw,useDeferredValue:function(n){return Yi().memoizedState=n},useTransition:function(){var n=yT(!1),e=n[0];return n=$x.bind(null,n[1]),Yi().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=bt,i=Yi();if(Rt){if(t===void 0)throw Error(ee(407));t=t()}else{if(t=e(),In===null)throw Error(ee(349));Za&30||e6(r,e,t)}i.memoizedState=t;var s={value:t,getSnapshot:e};return i.queue=s,vT(n6.bind(null,r,s,n),[n]),r.flags|=2048,gd(9,t6.bind(null,r,s,t,e),void 0,null),t},useId:function(){var n=Yi(),e=In.identifierPrefix;if(Rt){var t=Ds,r=Ns;t=(r&~(1<<32-Pi(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=fd++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=Hx++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},Yx={readContext:si,useCallback:c6,useContext:si,useEffect:ew,useImperativeHandle:u6,useInsertionEffect:o6,useLayoutEffect:a6,useMemo:h6,useReducer:$y,useRef:s6,useState:function(){return $y(pd)},useDebugValue:tw,useDeferredValue:function(n){var e=oi();return d6(e,an.memoizedState,n)},useTransition:function(){var n=$y(pd)[0],e=oi().memoizedState;return[n,e]},useMutableSource:JI,useSyncExternalStore:ZI,useId:f6,unstable_isNewReconciler:!1},Xx={readContext:si,useCallback:c6,useContext:si,useEffect:ew,useImperativeHandle:u6,useInsertionEffect:o6,useLayoutEffect:a6,useMemo:h6,useReducer:qy,useRef:s6,useState:function(){return qy(pd)},useDebugValue:tw,useDeferredValue:function(n){var e=oi();return an===null?e.memoizedState=n:d6(e,an.memoizedState,n)},useTransition:function(){var n=qy(pd)[0],e=oi().memoizedState;return[n,e]},useMutableSource:JI,useSyncExternalStore:ZI,useId:f6,unstable_isNewReconciler:!1};function wi(n,e){if(n&&n.defaultProps){e=Mt({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function a1(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:Mt({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var jm={isMounted:function(n){return(n=n._reactInternals)?pl(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=fr(),i=Uo(n),s=Fs(r,i);s.payload=e,t!=null&&(s.callback=t),e=Fo(n,s,i),e!==null&&(Ri(e,n,i,r),sg(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=fr(),i=Uo(n),s=Fs(r,i);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=Fo(n,s,i),e!==null&&(Ri(e,n,i,r),sg(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=fr(),r=Uo(n),i=Fs(t,r);i.tag=2,e!=null&&(i.callback=e),e=Fo(n,i,r),e!==null&&(Ri(e,n,r,t),sg(e,n,r))}};function wT(n,e,t,r,i,s,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!ad(t,r)||!ad(i,s):!0}function _6(n,e,t){var r=!1,i=qo,s=e.contextType;return typeof s=="object"&&s!==null?s=si(s):(i=xr(e)?Xa:nr.current,r=e.contextTypes,s=(r=r!=null)?Mu(n,i):qo),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=jm,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=s),e}function ET(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&jm.enqueueReplaceState(e,e.state,null)}function l1(n,e,t,r){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},q2(n);var s=e.contextType;typeof s=="object"&&s!==null?i.context=si(s):(s=xr(e)?Xa:nr.current,i.context=Mu(n,s)),i.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(a1(n,e,s,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&jm.enqueueReplaceState(i,i.state,null),Ug(n,t,i,r),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function Uu(n,e){try{var t="",r=e;do t+=I8(r),r=r.return;while(r);var i=t}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:i,digest:null}}function Ky(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function u1(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var Jx=typeof WeakMap=="function"?WeakMap:Map;function y6(n,e,t){t=Fs(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){Wg||(Wg=!0,v1=r),u1(n,e)},t}function v6(n,e,t){t=Fs(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;t.payload=function(){return r(i)},t.callback=function(){u1(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){u1(n,e),typeof r!="function"&&(Vo===null?Vo=new Set([this]):Vo.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function ST(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new Jx;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(t)||(i.add(t),n=dN.bind(null,n,e,t),e.then(n,n))}function TT(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function CT(n,e,t,r,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Fs(-1,1),e.tag=2,Fo(t,e,1))),t.lanes|=1),n)}var Zx=Js.ReactCurrentOwner,Pr=!1;function hr(n,e,t,r){e.child=n===null?KI(e,null,t,r):Fu(e,n.child,t,r)}function IT(n,e,t,r,i){t=t.render;var s=e.ref;return Iu(e,i),r=J2(n,e,t,r,s,i),t=Z2(),n!==null&&!Pr?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Hs(n,e,i)):(Rt&&t&&z2(e),e.flags|=1,hr(n,e,r,i),e.child)}function PT(n,e,t,r,i){if(n===null){var s=t.type;return typeof s=="function"&&!uw(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,w6(n,e,s,r,i)):(n=hg(t.type,null,r,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&i)){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:ad,t(o,r)&&n.ref===e.ref)return Hs(n,e,i)}return e.flags|=1,n=zo(s,r),n.ref=e.ref,n.return=e,e.child=n}function w6(n,e,t,r,i){if(n!==null){var s=n.memoizedProps;if(ad(s,r)&&n.ref===e.ref)if(Pr=!1,e.pendingProps=r=s,(n.lanes&i)!==0)n.flags&131072&&(Pr=!0);else return e.lanes=n.lanes,Hs(n,e,i)}return c1(n,e,t,r,i)}function E6(n,e,t){var r=e.pendingProps,i=r.children,s=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Et(yu,Lr),Lr|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Et(yu,Lr),Lr|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:t,Et(yu,Lr),Lr|=r}else s!==null?(r=s.baseLanes|t,e.memoizedState=null):r=t,Et(yu,Lr),Lr|=r;return hr(n,e,i,t),e.child}function S6(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function c1(n,e,t,r,i){var s=xr(t)?Xa:nr.current;return s=Mu(e,s),Iu(e,i),t=J2(n,e,t,r,s,i),r=Z2(),n!==null&&!Pr?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Hs(n,e,i)):(Rt&&r&&z2(e),e.flags|=1,hr(n,e,t,i),e.child)}function RT(n,e,t,r,i){if(xr(t)){var s=!0;bg(e)}else s=!1;if(Iu(e,i),e.stateNode===null)lg(n,e),_6(e,t,r),l1(e,t,r,i),r=!0;else if(n===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,d=t.contextType;typeof d=="object"&&d!==null?d=si(d):(d=xr(t)?Xa:nr.current,d=Mu(e,d));var p=t.getDerivedStateFromProps,_=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function";_||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==d)&&ET(e,o,r,d),Co=!1;var m=e.memoizedState;o.state=m,Ug(e,r,o,i),c=e.memoizedState,l!==r||m!==c||Ar.current||Co?(typeof p=="function"&&(a1(e,t,p,r),c=e.memoizedState),(l=Co||wT(e,t,l,r,m,c,d))?(_||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,YI(n,e),l=e.memoizedProps,d=e.type===e.elementType?l:wi(e.type,l),o.props=d,_=e.pendingProps,m=o.context,c=t.contextType,typeof c=="object"&&c!==null?c=si(c):(c=xr(t)?Xa:nr.current,c=Mu(e,c));var S=t.getDerivedStateFromProps;(p=typeof S=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==_||m!==c)&&ET(e,o,r,c),Co=!1,m=e.memoizedState,o.state=m,Ug(e,r,o,i);var E=e.memoizedState;l!==_||m!==E||Ar.current||Co?(typeof S=="function"&&(a1(e,t,S,r),E=e.memoizedState),(d=Co||wT(e,t,d,r,m,E,c)||!1)?(p||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,E,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,E,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===n.memoizedProps&&m===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&m===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=E),o.props=r,o.state=E,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||l===n.memoizedProps&&m===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&m===n.memoizedState||(e.flags|=1024),r=!1)}return h1(n,e,t,r,s,i)}function h1(n,e,t,r,i,s){S6(n,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&dT(e,t,!1),Hs(n,e,s);r=e.stateNode,Zx.current=e;var l=o&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&o?(e.child=Fu(e,n.child,null,s),e.child=Fu(e,null,l,s)):hr(n,e,l,s),e.memoizedState=r.state,i&&dT(e,t,!0),e.child}function T6(n){var e=n.stateNode;e.pendingContext?hT(n,e.pendingContext,e.pendingContext!==e.context):e.context&&hT(n,e.context,!1),K2(n,e.containerInfo)}function kT(n,e,t,r,i){return Lu(),j2(i),e.flags|=256,hr(n,e,t,r),e.child}var d1={dehydrated:null,treeContext:null,retryLane:0};function f1(n){return{baseLanes:n,cachePool:null,transitions:null}}function C6(n,e,t){var r=e.pendingProps,i=Dt.current,s=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=n!==null&&n.memoizedState===null?!1:(i&2)!==0),l?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),Et(Dt,i&1),n===null)return s1(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,n=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Hm(o,r,0,null),n=Qa(n,r,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=f1(t),e.memoizedState=d1,n):nw(e,o));if(i=n.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return eN(n,e,o,r,l,i,t);if(s){s=r.fallback,o=e.mode,i=n.child,l=i.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=zo(i,c),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=zo(l,s):(s=Qa(s,o,t,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=n.child.memoizedState,o=o===null?f1(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=n.childLanes&~t,e.memoizedState=d1,r}return s=n.child,n=s.sibling,r=zo(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function nw(n,e){return e=Hm({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function Fp(n,e,t,r){return r!==null&&j2(r),Fu(e,n.child,null,t),n=nw(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function eN(n,e,t,r,i,s,o){if(t)return e.flags&256?(e.flags&=-257,r=Ky(Error(ee(422))),Fp(n,e,o,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Hm({mode:"visible",children:r.children},i,0,null),s=Qa(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Fu(e,n.child,null,o),e.child.memoizedState=f1(o),e.memoizedState=d1,s);if(!(e.mode&1))return Fp(n,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error(ee(419)),r=Ky(s,r,void 0),Fp(n,e,o,r)}if(l=(o&n.childLanes)!==0,Pr||l){if(r=In,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Ws(n,i),Ri(r,n,i,-1))}return lw(),r=Ky(Error(ee(421))),Fp(n,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=fN.bind(null,n),i._reactRetry=e,null):(n=s.treeContext,Fr=Lo(i.nextSibling),Ur=e,Rt=!0,Si=null,n!==null&&(Zr[ei++]=Ns,Zr[ei++]=Ds,Zr[ei++]=Ja,Ns=n.id,Ds=n.overflow,Ja=e),e=nw(e,r.children),e.flags|=4096,e)}function AT(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),o1(n.return,e,t)}function Qy(n,e,t,r,i){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=t,s.tailMode=i)}function I6(n,e,t){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(hr(n,e,r.children,t),r=Dt.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&AT(n,t,e);else if(n.tag===19)AT(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(Et(Dt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&zg(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),Qy(e,!1,i,t,s);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&zg(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}Qy(e,!0,t,null,s);break;case"together":Qy(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function lg(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Hs(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),el|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(ee(153));if(e.child!==null){for(n=e.child,t=zo(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=zo(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function tN(n,e,t){switch(e.tag){case 3:T6(e),Lu();break;case 5:XI(e);break;case 1:xr(e.type)&&bg(e);break;case 4:K2(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Et(Fg,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Et(Dt,Dt.current&1),e.flags|=128,null):t&e.child.childLanes?C6(n,e,t):(Et(Dt,Dt.current&1),n=Hs(n,e,t),n!==null?n.sibling:null);Et(Dt,Dt.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return I6(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Et(Dt,Dt.current),r)break;return null;case 22:case 23:return e.lanes=0,E6(n,e,t)}return Hs(n,e,t)}var P6,p1,R6,k6;P6=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};p1=function(){};R6=function(n,e,t,r){var i=n.memoizedProps;if(i!==r){n=e.stateNode,Ga(es.current);var s=null;switch(t){case"input":i=Lv(n,i),r=Lv(n,r),s=[];break;case"select":i=Mt({},i,{value:void 0}),r=Mt({},r,{value:void 0}),s=[];break;case"textarea":i=Uv(n,i),r=Uv(n,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=Dg)}Bv(t,r);var o;t=null;for(d in i)if(!r.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var l=i[d];for(o in l)l.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ed.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in r){var c=r[d];if(l=i!=null?i[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(t||(t={}),t[o]=c[o])}else t||(s||(s=[]),s.push(d,t)),t=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(ed.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Tt("scroll",n),s||l===c||(s=[])):(s=s||[]).push(d,c))}t&&(s=s||[]).push("style",t);var d=s;(e.updateQueue=d)&&(e.flags|=4)}};k6=function(n,e,t,r){t!==r&&(e.flags|=4)};function hh(n,e){if(!Rt)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function Yn(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function nN(n,e,t){var r=e.pendingProps;switch(B2(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yn(e),null;case 1:return xr(e.type)&&Og(),Yn(e),null;case 3:return r=e.stateNode,Vu(),It(Ar),It(nr),Y2(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(Mp(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Si!==null&&(S1(Si),Si=null))),p1(n,e),Yn(e),null;case 5:Q2(e);var i=Ga(dd.current);if(t=e.type,n!==null&&e.stateNode!=null)R6(n,e,t,r,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ee(166));return Yn(e),null}if(n=Ga(es.current),Mp(e)){r=e.stateNode,t=e.type;var s=e.memoizedProps;switch(r[Xi]=e,r[cd]=s,n=(e.mode&1)!==0,t){case"dialog":Tt("cancel",r),Tt("close",r);break;case"iframe":case"object":case"embed":Tt("load",r);break;case"video":case"audio":for(i=0;i<Ih.length;i++)Tt(Ih[i],r);break;case"source":Tt("error",r);break;case"img":case"image":case"link":Tt("error",r),Tt("load",r);break;case"details":Tt("toggle",r);break;case"input":V4(r,s),Tt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Tt("invalid",r);break;case"textarea":z4(r,s),Tt("invalid",r)}Bv(t,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&bp(r.textContent,l,n),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&bp(r.textContent,l,n),i=["children",""+l]):ed.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Tt("scroll",r)}switch(t){case"input":Pp(r),U4(r,s,!0);break;case"textarea":Pp(r),B4(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Dg)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=nI(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=o.createElement(t,{is:r.is}):(n=o.createElement(t),t==="select"&&(o=n,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):n=o.createElementNS(n,t),n[Xi]=e,n[cd]=r,P6(n,e,!1,!1),e.stateNode=n;e:{switch(o=jv(t,r),t){case"dialog":Tt("cancel",n),Tt("close",n),i=r;break;case"iframe":case"object":case"embed":Tt("load",n),i=r;break;case"video":case"audio":for(i=0;i<Ih.length;i++)Tt(Ih[i],n);i=r;break;case"source":Tt("error",n),i=r;break;case"img":case"image":case"link":Tt("error",n),Tt("load",n),i=r;break;case"details":Tt("toggle",n),i=r;break;case"input":V4(n,r),i=Lv(n,r),Tt("invalid",n);break;case"option":i=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},i=Mt({},r,{value:void 0}),Tt("invalid",n);break;case"textarea":z4(n,r),i=Uv(n,r),Tt("invalid",n);break;default:i=r}Bv(t,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?sI(n,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&rI(n,c)):s==="children"?typeof c=="string"?(t!=="textarea"||c!=="")&&td(n,c):typeof c=="number"&&td(n,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(ed.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Tt("scroll",n):c!=null&&P2(n,s,c,o))}switch(t){case"input":Pp(n),U4(n,r,!1);break;case"textarea":Pp(n),B4(n);break;case"option":r.value!=null&&n.setAttribute("value",""+$o(r.value));break;case"select":n.multiple=!!r.multiple,s=r.value,s!=null?Eu(n,!!r.multiple,s,!1):r.defaultValue!=null&&Eu(n,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=Dg)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Yn(e),null;case 6:if(n&&e.stateNode!=null)k6(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ee(166));if(t=Ga(dd.current),Ga(es.current),Mp(e)){if(r=e.stateNode,t=e.memoizedProps,r[Xi]=e,(s=r.nodeValue!==t)&&(n=Ur,n!==null))switch(n.tag){case 3:bp(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&bp(r.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[Xi]=e,e.stateNode=r}return Yn(e),null;case 13:if(It(Dt),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Rt&&Fr!==null&&e.mode&1&&!(e.flags&128))$I(),Lu(),e.flags|=98560,s=!1;else if(s=Mp(e),r!==null&&r.dehydrated!==null){if(n===null){if(!s)throw Error(ee(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ee(317));s[Xi]=e}else Lu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Yn(e),s=!1}else Si!==null&&(S1(Si),Si=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||Dt.current&1?ln===0&&(ln=3):lw())),e.updateQueue!==null&&(e.flags|=4),Yn(e),null);case 4:return Vu(),p1(n,e),n===null&&ld(e.stateNode.containerInfo),Yn(e),null;case 10:return H2(e.type._context),Yn(e),null;case 17:return xr(e.type)&&Og(),Yn(e),null;case 19:if(It(Dt),s=e.memoizedState,s===null)return Yn(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)hh(s,!1);else{if(ln!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=zg(n),o!==null){for(e.flags|=128,hh(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)s=t,n=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,n=o.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Et(Dt,Dt.current&1|2),e.child}n=n.sibling}s.tail!==null&&Gt()>zu&&(e.flags|=128,r=!0,hh(s,!1),e.lanes=4194304)}else{if(!r)if(n=zg(o),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),hh(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Rt)return Yn(e),null}else 2*Gt()-s.renderingStartTime>zu&&t!==1073741824&&(e.flags|=128,r=!0,hh(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(t=s.last,t!==null?t.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Gt(),e.sibling=null,t=Dt.current,Et(Dt,r?t&1|2:t&1),e):(Yn(e),null);case 22:case 23:return aw(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Lr&1073741824&&(Yn(e),e.subtreeFlags&6&&(e.flags|=8192)):Yn(e),null;case 24:return null;case 25:return null}throw Error(ee(156,e.tag))}function rN(n,e){switch(B2(e),e.tag){case 1:return xr(e.type)&&Og(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Vu(),It(Ar),It(nr),Y2(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Q2(e),null;case 13:if(It(Dt),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(ee(340));Lu()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return It(Dt),null;case 4:return Vu(),null;case 10:return H2(e.type._context),null;case 22:case 23:return aw(),null;case 24:return null;default:return null}}var Vp=!1,Zn=!1,iN=typeof WeakSet=="function"?WeakSet:Set,de=null;function _u(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){Ft(n,e,r)}else t.current=null}function g1(n,e,t){try{t()}catch(r){Ft(n,e,r)}}var xT=!1;function sN(n,e){if(Jv=Ag,n=OI(),U2(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,l=-1,c=-1,d=0,p=0,_=n,m=null;t:for(;;){for(var S;_!==t||i!==0&&_.nodeType!==3||(l=o+i),_!==s||r!==0&&_.nodeType!==3||(c=o+r),_.nodeType===3&&(o+=_.nodeValue.length),(S=_.firstChild)!==null;)m=_,_=S;for(;;){if(_===n)break t;if(m===t&&++d===i&&(l=o),m===s&&++p===r&&(c=o),(S=_.nextSibling)!==null)break;_=m,m=_.parentNode}_=S}t=l===-1||c===-1?null:{start:l,end:c}}else t=null}t=t||{start:0,end:0}}else t=null;for(Zv={focusedElem:n,selectionRange:t},Ag=!1,de=e;de!==null;)if(e=de,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,de=n;else for(;de!==null;){e=de;try{var E=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var A=E.memoizedProps,D=E.memoizedState,k=e.stateNode,R=k.getSnapshotBeforeUpdate(e.elementType===e.type?A:wi(e.type,A),D);k.__reactInternalSnapshotBeforeUpdate=R}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ee(163))}}catch(P){Ft(e,e.return,P)}if(n=e.sibling,n!==null){n.return=e.return,de=n;break}de=e.return}return E=xT,xT=!1,E}function zh(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&n)===n){var s=i.destroy;i.destroy=void 0,s!==void 0&&g1(e,t,s)}i=i.next}while(i!==r)}}function Gm(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function m1(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function A6(n){var e=n.alternate;e!==null&&(n.alternate=null,A6(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Xi],delete e[cd],delete e[n1],delete e[Bx],delete e[jx])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function x6(n){return n.tag===5||n.tag===3||n.tag===4}function NT(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||x6(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function _1(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Dg));else if(r!==4&&(n=n.child,n!==null))for(_1(n,e,t),n=n.sibling;n!==null;)_1(n,e,t),n=n.sibling}function y1(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(y1(n,e,t),n=n.sibling;n!==null;)y1(n,e,t),n=n.sibling}var bn=null,Ei=!1;function vo(n,e,t){for(t=t.child;t!==null;)N6(n,e,t),t=t.sibling}function N6(n,e,t){if(Zi&&typeof Zi.onCommitFiberUnmount=="function")try{Zi.onCommitFiberUnmount(Mm,t)}catch{}switch(t.tag){case 5:Zn||_u(t,e);case 6:var r=bn,i=Ei;bn=null,vo(n,e,t),bn=r,Ei=i,bn!==null&&(Ei?(n=bn,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):bn.removeChild(t.stateNode));break;case 18:bn!==null&&(Ei?(n=bn,t=t.stateNode,n.nodeType===8?jy(n.parentNode,t):n.nodeType===1&&jy(n,t),sd(n)):jy(bn,t.stateNode));break;case 4:r=bn,i=Ei,bn=t.stateNode.containerInfo,Ei=!0,vo(n,e,t),bn=r,Ei=i;break;case 0:case 11:case 14:case 15:if(!Zn&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&g1(t,e,o),i=i.next}while(i!==r)}vo(n,e,t);break;case 1:if(!Zn&&(_u(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(l){Ft(t,e,l)}vo(n,e,t);break;case 21:vo(n,e,t);break;case 22:t.mode&1?(Zn=(r=Zn)||t.memoizedState!==null,vo(n,e,t),Zn=r):vo(n,e,t);break;default:vo(n,e,t)}}function DT(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new iN),e.forEach(function(r){var i=pN.bind(null,n,r);t.has(r)||(t.add(r),r.then(i,i))})}}function yi(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];try{var s=n,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:bn=l.stateNode,Ei=!1;break e;case 3:bn=l.stateNode.containerInfo,Ei=!0;break e;case 4:bn=l.stateNode.containerInfo,Ei=!0;break e}l=l.return}if(bn===null)throw Error(ee(160));N6(s,o,i),bn=null,Ei=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(d){Ft(i,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)D6(e,n),e=e.sibling}function D6(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(yi(e,n),Qi(n),r&4){try{zh(3,n,n.return),Gm(3,n)}catch(A){Ft(n,n.return,A)}try{zh(5,n,n.return)}catch(A){Ft(n,n.return,A)}}break;case 1:yi(e,n),Qi(n),r&512&&t!==null&&_u(t,t.return);break;case 5:if(yi(e,n),Qi(n),r&512&&t!==null&&_u(t,t.return),n.flags&32){var i=n.stateNode;try{td(i,"")}catch(A){Ft(n,n.return,A)}}if(r&4&&(i=n.stateNode,i!=null)){var s=n.memoizedProps,o=t!==null?t.memoizedProps:s,l=n.type,c=n.updateQueue;if(n.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&eI(i,s),jv(l,o);var d=jv(l,s);for(o=0;o<c.length;o+=2){var p=c[o],_=c[o+1];p==="style"?sI(i,_):p==="dangerouslySetInnerHTML"?rI(i,_):p==="children"?td(i,_):P2(i,p,_,d)}switch(l){case"input":Fv(i,s);break;case"textarea":tI(i,s);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var S=s.value;S!=null?Eu(i,!!s.multiple,S,!1):m!==!!s.multiple&&(s.defaultValue!=null?Eu(i,!!s.multiple,s.defaultValue,!0):Eu(i,!!s.multiple,s.multiple?[]:"",!1))}i[cd]=s}catch(A){Ft(n,n.return,A)}}break;case 6:if(yi(e,n),Qi(n),r&4){if(n.stateNode===null)throw Error(ee(162));i=n.stateNode,s=n.memoizedProps;try{i.nodeValue=s}catch(A){Ft(n,n.return,A)}}break;case 3:if(yi(e,n),Qi(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{sd(e.containerInfo)}catch(A){Ft(n,n.return,A)}break;case 4:yi(e,n),Qi(n);break;case 13:yi(e,n),Qi(n),i=n.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(sw=Gt())),r&4&&DT(n);break;case 22:if(p=t!==null&&t.memoizedState!==null,n.mode&1?(Zn=(d=Zn)||p,yi(e,n),Zn=d):yi(e,n),Qi(n),r&8192){if(d=n.memoizedState!==null,(n.stateNode.isHidden=d)&&!p&&n.mode&1)for(de=n,p=n.child;p!==null;){for(_=de=p;de!==null;){switch(m=de,S=m.child,m.tag){case 0:case 11:case 14:case 15:zh(4,m,m.return);break;case 1:_u(m,m.return);var E=m.stateNode;if(typeof E.componentWillUnmount=="function"){r=m,t=m.return;try{e=r,E.props=e.memoizedProps,E.state=e.memoizedState,E.componentWillUnmount()}catch(A){Ft(r,t,A)}}break;case 5:_u(m,m.return);break;case 22:if(m.memoizedState!==null){bT(_);continue}}S!==null?(S.return=m,de=S):bT(_)}p=p.sibling}e:for(p=null,_=n;;){if(_.tag===5){if(p===null){p=_;try{i=_.stateNode,d?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=_.stateNode,c=_.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=iI("display",o))}catch(A){Ft(n,n.return,A)}}}else if(_.tag===6){if(p===null)try{_.stateNode.nodeValue=d?"":_.memoizedProps}catch(A){Ft(n,n.return,A)}}else if((_.tag!==22&&_.tag!==23||_.memoizedState===null||_===n)&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===n)break e;for(;_.sibling===null;){if(_.return===null||_.return===n)break e;p===_&&(p=null),_=_.return}p===_&&(p=null),_.sibling.return=_.return,_=_.sibling}}break;case 19:yi(e,n),Qi(n),r&4&&DT(n);break;case 21:break;default:yi(e,n),Qi(n)}}function Qi(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(x6(t)){var r=t;break e}t=t.return}throw Error(ee(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(td(i,""),r.flags&=-33);var s=NT(n);y1(n,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,l=NT(n);_1(n,l,o);break;default:throw Error(ee(161))}}catch(c){Ft(n,n.return,c)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function oN(n,e,t){de=n,O6(n)}function O6(n,e,t){for(var r=(n.mode&1)!==0;de!==null;){var i=de,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Vp;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||Zn;l=Vp;var d=Zn;if(Vp=o,(Zn=c)&&!d)for(de=i;de!==null;)o=de,c=o.child,o.tag===22&&o.memoizedState!==null?MT(i):c!==null?(c.return=o,de=c):MT(i);for(;s!==null;)de=s,O6(s),s=s.sibling;de=i,Vp=l,Zn=d}OT(n)}else i.subtreeFlags&8772&&s!==null?(s.return=i,de=s):OT(n)}}function OT(n){for(;de!==null;){var e=de;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Zn||Gm(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Zn)if(t===null)r.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:wi(e.type,t.memoizedProps);r.componentDidUpdate(i,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&_T(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}_T(e,o,t)}break;case 5:var l=e.stateNode;if(t===null&&e.flags&4){t=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&t.focus();break;case"img":c.src&&(t.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var p=d.memoizedState;if(p!==null){var _=p.dehydrated;_!==null&&sd(_)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ee(163))}Zn||e.flags&512&&m1(e)}catch(m){Ft(e,e.return,m)}}if(e===n){de=null;break}if(t=e.sibling,t!==null){t.return=e.return,de=t;break}de=e.return}}function bT(n){for(;de!==null;){var e=de;if(e===n){de=null;break}var t=e.sibling;if(t!==null){t.return=e.return,de=t;break}de=e.return}}function MT(n){for(;de!==null;){var e=de;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Gm(4,e)}catch(c){Ft(e,t,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(c){Ft(e,i,c)}}var s=e.return;try{m1(e)}catch(c){Ft(e,s,c)}break;case 5:var o=e.return;try{m1(e)}catch(c){Ft(e,o,c)}}}catch(c){Ft(e,e.return,c)}if(e===n){de=null;break}var l=e.sibling;if(l!==null){l.return=e.return,de=l;break}de=e.return}}var aN=Math.ceil,Gg=Js.ReactCurrentDispatcher,rw=Js.ReactCurrentOwner,ri=Js.ReactCurrentBatchConfig,Je=0,In=null,Xt=null,Fn=0,Lr=0,yu=ra(0),ln=0,md=null,el=0,Wm=0,iw=0,Bh=null,Ir=null,sw=0,zu=1/0,Rs=null,Wg=!1,v1=null,Vo=null,Up=!1,No=null,Hg=0,jh=0,w1=null,ug=-1,cg=0;function fr(){return Je&6?Gt():ug!==-1?ug:ug=Gt()}function Uo(n){return n.mode&1?Je&2&&Fn!==0?Fn&-Fn:Wx.transition!==null?(cg===0&&(cg=_I()),cg):(n=ut,n!==0||(n=window.event,n=n===void 0?16:CI(n.type)),n):1}function Ri(n,e,t,r){if(50<jh)throw jh=0,w1=null,Error(ee(185));Wd(n,t,r),(!(Je&2)||n!==In)&&(n===In&&(!(Je&2)&&(Wm|=t),ln===4&&Po(n,Fn)),Nr(n,r),t===1&&Je===0&&!(e.mode&1)&&(zu=Gt()+500,zm&&ia()))}function Nr(n,e){var t=n.callbackNode;W8(n,e);var r=kg(n,n===In?Fn:0);if(r===0)t!==null&&W4(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&W4(t),e===1)n.tag===0?Gx(LT.bind(null,n)):GI(LT.bind(null,n)),Ux(function(){!(Je&6)&&ia()}),t=null;else{switch(yI(r)){case 1:t=N2;break;case 4:t=gI;break;case 16:t=Rg;break;case 536870912:t=mI;break;default:t=Rg}t=B6(t,b6.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function b6(n,e){if(ug=-1,cg=0,Je&6)throw Error(ee(327));var t=n.callbackNode;if(Pu()&&n.callbackNode!==t)return null;var r=kg(n,n===In?Fn:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=$g(n,r);else{e=r;var i=Je;Je|=2;var s=L6();(In!==n||Fn!==e)&&(Rs=null,zu=Gt()+500,Ka(n,e));do try{cN();break}catch(l){M6(n,l)}while(!0);W2(),Gg.current=s,Je=i,Xt!==null?e=0:(In=null,Fn=0,e=ln)}if(e!==0){if(e===2&&(i=qv(n),i!==0&&(r=i,e=E1(n,i))),e===1)throw t=md,Ka(n,0),Po(n,r),Nr(n,Gt()),t;if(e===6)Po(n,r);else{if(i=n.current.alternate,!(r&30)&&!lN(i)&&(e=$g(n,r),e===2&&(s=qv(n),s!==0&&(r=s,e=E1(n,s))),e===1))throw t=md,Ka(n,0),Po(n,r),Nr(n,Gt()),t;switch(n.finishedWork=i,n.finishedLanes=r,e){case 0:case 1:throw Error(ee(345));case 2:Fa(n,Ir,Rs);break;case 3:if(Po(n,r),(r&130023424)===r&&(e=sw+500-Gt(),10<e)){if(kg(n,0)!==0)break;if(i=n.suspendedLanes,(i&r)!==r){fr(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=t1(Fa.bind(null,n,Ir,Rs),e);break}Fa(n,Ir,Rs);break;case 4:if(Po(n,r),(r&4194240)===r)break;for(e=n.eventTimes,i=-1;0<r;){var o=31-Pi(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Gt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*aN(r/1960))-r,10<r){n.timeoutHandle=t1(Fa.bind(null,n,Ir,Rs),r);break}Fa(n,Ir,Rs);break;case 5:Fa(n,Ir,Rs);break;default:throw Error(ee(329))}}}return Nr(n,Gt()),n.callbackNode===t?b6.bind(null,n):null}function E1(n,e){var t=Bh;return n.current.memoizedState.isDehydrated&&(Ka(n,e).flags|=256),n=$g(n,e),n!==2&&(e=Ir,Ir=t,e!==null&&S1(e)),n}function S1(n){Ir===null?Ir=n:Ir.push.apply(Ir,n)}function lN(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var i=t[r],s=i.getSnapshot;i=i.value;try{if(!Ni(s(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Po(n,e){for(e&=~iw,e&=~Wm,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Pi(e),r=1<<t;n[t]=-1,e&=~r}}function LT(n){if(Je&6)throw Error(ee(327));Pu();var e=kg(n,0);if(!(e&1))return Nr(n,Gt()),null;var t=$g(n,e);if(n.tag!==0&&t===2){var r=qv(n);r!==0&&(e=r,t=E1(n,r))}if(t===1)throw t=md,Ka(n,0),Po(n,e),Nr(n,Gt()),t;if(t===6)throw Error(ee(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Fa(n,Ir,Rs),Nr(n,Gt()),null}function ow(n,e){var t=Je;Je|=1;try{return n(e)}finally{Je=t,Je===0&&(zu=Gt()+500,zm&&ia())}}function tl(n){No!==null&&No.tag===0&&!(Je&6)&&Pu();var e=Je;Je|=1;var t=ri.transition,r=ut;try{if(ri.transition=null,ut=1,n)return n()}finally{ut=r,ri.transition=t,Je=e,!(Je&6)&&ia()}}function aw(){Lr=yu.current,It(yu)}function Ka(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,Vx(t)),Xt!==null)for(t=Xt.return;t!==null;){var r=t;switch(B2(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Og();break;case 3:Vu(),It(Ar),It(nr),Y2();break;case 5:Q2(r);break;case 4:Vu();break;case 13:It(Dt);break;case 19:It(Dt);break;case 10:H2(r.type._context);break;case 22:case 23:aw()}t=t.return}if(In=n,Xt=n=zo(n.current,null),Fn=Lr=e,ln=0,md=null,iw=Wm=el=0,Ir=Bh=null,ja!==null){for(e=0;e<ja.length;e++)if(t=ja[e],r=t.interleaved,r!==null){t.interleaved=null;var i=r.next,s=t.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}t.pending=r}ja=null}return n}function M6(n,e){do{var t=Xt;try{if(W2(),og.current=jg,Bg){for(var r=bt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Bg=!1}if(Za=0,En=an=bt=null,Uh=!1,fd=0,rw.current=null,t===null||t.return===null){ln=1,md=e,Xt=null;break}e:{var s=n,o=t.return,l=t,c=e;if(e=Fn,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,p=l,_=p.tag;if(!(p.mode&1)&&(_===0||_===11||_===15)){var m=p.alternate;m?(p.updateQueue=m.updateQueue,p.memoizedState=m.memoizedState,p.lanes=m.lanes):(p.updateQueue=null,p.memoizedState=null)}var S=TT(o);if(S!==null){S.flags&=-257,CT(S,o,l,s,e),S.mode&1&&ST(s,d,e),e=S,c=d;var E=e.updateQueue;if(E===null){var A=new Set;A.add(c),e.updateQueue=A}else E.add(c);break e}else{if(!(e&1)){ST(s,d,e),lw();break e}c=Error(ee(426))}}else if(Rt&&l.mode&1){var D=TT(o);if(D!==null){!(D.flags&65536)&&(D.flags|=256),CT(D,o,l,s,e),j2(Uu(c,l));break e}}s=c=Uu(c,l),ln!==4&&(ln=2),Bh===null?Bh=[s]:Bh.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var k=y6(s,c,e);mT(s,k);break e;case 1:l=c;var R=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof R.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Vo===null||!Vo.has(w)))){s.flags|=65536,e&=-e,s.lanes|=e;var P=v6(s,l,e);mT(s,P);break e}}s=s.return}while(s!==null)}V6(t)}catch(V){e=V,Xt===t&&t!==null&&(Xt=t=t.return);continue}break}while(!0)}function L6(){var n=Gg.current;return Gg.current=jg,n===null?jg:n}function lw(){(ln===0||ln===3||ln===2)&&(ln=4),In===null||!(el&268435455)&&!(Wm&268435455)||Po(In,Fn)}function $g(n,e){var t=Je;Je|=2;var r=L6();(In!==n||Fn!==e)&&(Rs=null,Ka(n,e));do try{uN();break}catch(i){M6(n,i)}while(!0);if(W2(),Je=t,Gg.current=r,Xt!==null)throw Error(ee(261));return In=null,Fn=0,ln}function uN(){for(;Xt!==null;)F6(Xt)}function cN(){for(;Xt!==null&&!M8();)F6(Xt)}function F6(n){var e=z6(n.alternate,n,Lr);n.memoizedProps=n.pendingProps,e===null?V6(n):Xt=e,rw.current=null}function V6(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=rN(t,e),t!==null){t.flags&=32767,Xt=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{ln=6,Xt=null;return}}else if(t=nN(t,e,Lr),t!==null){Xt=t;return}if(e=e.sibling,e!==null){Xt=e;return}Xt=e=n}while(e!==null);ln===0&&(ln=5)}function Fa(n,e,t){var r=ut,i=ri.transition;try{ri.transition=null,ut=1,hN(n,e,t,r)}finally{ri.transition=i,ut=r}return null}function hN(n,e,t,r){do Pu();while(No!==null);if(Je&6)throw Error(ee(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(ee(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(H8(n,s),n===In&&(Xt=In=null,Fn=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Up||(Up=!0,B6(Rg,function(){return Pu(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=ri.transition,ri.transition=null;var o=ut;ut=1;var l=Je;Je|=4,rw.current=null,sN(n,t),D6(t,n),Nx(Zv),Ag=!!Jv,Zv=Jv=null,n.current=t,oN(t),L8(),Je=l,ut=o,ri.transition=s}else n.current=t;if(Up&&(Up=!1,No=n,Hg=i),s=n.pendingLanes,s===0&&(Vo=null),U8(t.stateNode),Nr(n,Gt()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],r(i.value,{componentStack:i.stack,digest:i.digest});if(Wg)throw Wg=!1,n=v1,v1=null,n;return Hg&1&&n.tag!==0&&Pu(),s=n.pendingLanes,s&1?n===w1?jh++:(jh=0,w1=n):jh=0,ia(),null}function Pu(){if(No!==null){var n=yI(Hg),e=ri.transition,t=ut;try{if(ri.transition=null,ut=16>n?16:n,No===null)var r=!1;else{if(n=No,No=null,Hg=0,Je&6)throw Error(ee(331));var i=Je;for(Je|=4,de=n.current;de!==null;){var s=de,o=s.child;if(de.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(de=d;de!==null;){var p=de;switch(p.tag){case 0:case 11:case 15:zh(8,p,s)}var _=p.child;if(_!==null)_.return=p,de=_;else for(;de!==null;){p=de;var m=p.sibling,S=p.return;if(A6(p),p===d){de=null;break}if(m!==null){m.return=S,de=m;break}de=S}}}var E=s.alternate;if(E!==null){var A=E.child;if(A!==null){E.child=null;do{var D=A.sibling;A.sibling=null,A=D}while(A!==null)}}de=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,de=o;else e:for(;de!==null;){if(s=de,s.flags&2048)switch(s.tag){case 0:case 11:case 15:zh(9,s,s.return)}var k=s.sibling;if(k!==null){k.return=s.return,de=k;break e}de=s.return}}var R=n.current;for(de=R;de!==null;){o=de;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,de=w;else e:for(o=R;de!==null;){if(l=de,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Gm(9,l)}}catch(V){Ft(l,l.return,V)}if(l===o){de=null;break e}var P=l.sibling;if(P!==null){P.return=l.return,de=P;break e}de=l.return}}if(Je=i,ia(),Zi&&typeof Zi.onPostCommitFiberRoot=="function")try{Zi.onPostCommitFiberRoot(Mm,n)}catch{}r=!0}return r}finally{ut=t,ri.transition=e}}return!1}function FT(n,e,t){e=Uu(t,e),e=y6(n,e,1),n=Fo(n,e,1),e=fr(),n!==null&&(Wd(n,1,e),Nr(n,e))}function Ft(n,e,t){if(n.tag===3)FT(n,n,t);else for(;e!==null;){if(e.tag===3){FT(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Vo===null||!Vo.has(r))){n=Uu(t,n),n=v6(e,n,1),e=Fo(e,n,1),n=fr(),e!==null&&(Wd(e,1,n),Nr(e,n));break}}e=e.return}}function dN(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=fr(),n.pingedLanes|=n.suspendedLanes&t,In===n&&(Fn&t)===t&&(ln===4||ln===3&&(Fn&130023424)===Fn&&500>Gt()-sw?Ka(n,0):iw|=t),Nr(n,e)}function U6(n,e){e===0&&(n.mode&1?(e=Ap,Ap<<=1,!(Ap&130023424)&&(Ap=4194304)):e=1);var t=fr();n=Ws(n,e),n!==null&&(Wd(n,e,t),Nr(n,t))}function fN(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),U6(n,t)}function pN(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(ee(314))}r!==null&&r.delete(e),U6(n,t)}var z6;z6=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Ar.current)Pr=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Pr=!1,tN(n,e,t);Pr=!!(n.flags&131072)}else Pr=!1,Rt&&e.flags&1048576&&WI(e,Lg,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;lg(n,e),n=e.pendingProps;var i=Mu(e,nr.current);Iu(e,t),i=J2(null,e,r,n,i,t);var s=Z2();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,xr(r)?(s=!0,bg(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,q2(e),i.updater=jm,e.stateNode=i,i._reactInternals=e,l1(e,r,n,t),e=h1(null,e,r,!0,s,t)):(e.tag=0,Rt&&s&&z2(e),hr(null,e,i,t),e=e.child),e;case 16:r=e.elementType;e:{switch(lg(n,e),n=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=mN(r),n=wi(r,n),i){case 0:e=c1(null,e,r,n,t);break e;case 1:e=RT(null,e,r,n,t);break e;case 11:e=IT(null,e,r,n,t);break e;case 14:e=PT(null,e,r,wi(r.type,n),t);break e}throw Error(ee(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:wi(r,i),c1(n,e,r,i,t);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:wi(r,i),RT(n,e,r,i,t);case 3:e:{if(T6(e),n===null)throw Error(ee(387));r=e.pendingProps,s=e.memoizedState,i=s.element,YI(n,e),Ug(e,r,null,t);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Uu(Error(ee(423)),e),e=kT(n,e,r,t,i);break e}else if(r!==i){i=Uu(Error(ee(424)),e),e=kT(n,e,r,t,i);break e}else for(Fr=Lo(e.stateNode.containerInfo.firstChild),Ur=e,Rt=!0,Si=null,t=KI(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Lu(),r===i){e=Hs(n,e,t);break e}hr(n,e,r,t)}e=e.child}return e;case 5:return XI(e),n===null&&s1(e),r=e.type,i=e.pendingProps,s=n!==null?n.memoizedProps:null,o=i.children,e1(r,i)?o=null:s!==null&&e1(r,s)&&(e.flags|=32),S6(n,e),hr(n,e,o,t),e.child;case 6:return n===null&&s1(e),null;case 13:return C6(n,e,t);case 4:return K2(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=Fu(e,null,r,t):hr(n,e,r,t),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:wi(r,i),IT(n,e,r,i,t);case 7:return hr(n,e,e.pendingProps,t),e.child;case 8:return hr(n,e,e.pendingProps.children,t),e.child;case 12:return hr(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Et(Fg,r._currentValue),r._currentValue=o,s!==null)if(Ni(s.value,o)){if(s.children===i.children&&!Ar.current){e=Hs(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(s.tag===1){c=Fs(-1,t&-t),c.tag=2;var d=s.updateQueue;if(d!==null){d=d.shared;var p=d.pending;p===null?c.next=c:(c.next=p.next,p.next=c),d.pending=c}}s.lanes|=t,c=s.alternate,c!==null&&(c.lanes|=t),o1(s.return,t,e),l.lanes|=t;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(ee(341));o.lanes|=t,l=o.alternate,l!==null&&(l.lanes|=t),o1(o,t,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}hr(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Iu(e,t),i=si(i),r=r(i),e.flags|=1,hr(n,e,r,t),e.child;case 14:return r=e.type,i=wi(r,e.pendingProps),i=wi(r.type,i),PT(n,e,r,i,t);case 15:return w6(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:wi(r,i),lg(n,e),e.tag=1,xr(r)?(n=!0,bg(e)):n=!1,Iu(e,t),_6(e,r,i),l1(e,r,i,t),h1(null,e,r,!0,n,t);case 19:return I6(n,e,t);case 22:return E6(n,e,t)}throw Error(ee(156,e.tag))};function B6(n,e){return pI(n,e)}function gN(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ti(n,e,t,r){return new gN(n,e,t,r)}function uw(n){return n=n.prototype,!(!n||!n.isReactComponent)}function mN(n){if(typeof n=="function")return uw(n)?1:0;if(n!=null){if(n=n.$$typeof,n===k2)return 11;if(n===A2)return 14}return 2}function zo(n,e){var t=n.alternate;return t===null?(t=ti(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function hg(n,e,t,r,i,s){var o=2;if(r=n,typeof n=="function")uw(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case lu:return Qa(t.children,i,s,e);case R2:o=8,i|=8;break;case Dv:return n=ti(12,t,e,i|2),n.elementType=Dv,n.lanes=s,n;case Ov:return n=ti(13,t,e,i),n.elementType=Ov,n.lanes=s,n;case bv:return n=ti(19,t,e,i),n.elementType=bv,n.lanes=s,n;case X5:return Hm(t,i,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Q5:o=10;break e;case Y5:o=9;break e;case k2:o=11;break e;case A2:o=14;break e;case To:o=16,r=null;break e}throw Error(ee(130,n==null?n:typeof n,""))}return e=ti(o,t,e,i),e.elementType=n,e.type=r,e.lanes=s,e}function Qa(n,e,t,r){return n=ti(7,n,r,e),n.lanes=t,n}function Hm(n,e,t,r){return n=ti(22,n,r,e),n.elementType=X5,n.lanes=t,n.stateNode={isHidden:!1},n}function Yy(n,e,t){return n=ti(6,n,null,e),n.lanes=t,n}function Xy(n,e,t){return e=ti(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function _N(n,e,t,r,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ny(0),this.expirationTimes=Ny(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ny(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function cw(n,e,t,r,i,s,o,l,c){return n=new _N(n,e,t,l,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=ti(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},q2(s),n}function yN(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:au,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function j6(n){if(!n)return qo;n=n._reactInternals;e:{if(pl(n)!==n||n.tag!==1)throw Error(ee(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(xr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ee(171))}if(n.tag===1){var t=n.type;if(xr(t))return jI(n,t,e)}return e}function G6(n,e,t,r,i,s,o,l,c){return n=cw(t,r,!0,n,i,s,o,l,c),n.context=j6(null),t=n.current,r=fr(),i=Uo(t),s=Fs(r,i),s.callback=e??null,Fo(t,s,i),n.current.lanes=i,Wd(n,i,r),Nr(n,r),n}function $m(n,e,t,r){var i=e.current,s=fr(),o=Uo(i);return t=j6(t),e.context===null?e.context=t:e.pendingContext=t,e=Fs(s,o),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=Fo(i,e,o),n!==null&&(Ri(n,i,o,s),sg(n,i,o)),o}function qg(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function VT(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function hw(n,e){VT(n,e),(n=n.alternate)&&VT(n,e)}function vN(){return null}var W6=typeof reportError=="function"?reportError:function(n){console.error(n)};function dw(n){this._internalRoot=n}qm.prototype.render=dw.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(ee(409));$m(n,e,null,null)};qm.prototype.unmount=dw.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;tl(function(){$m(null,n,null,null)}),e[Gs]=null}};function qm(n){this._internalRoot=n}qm.prototype.unstable_scheduleHydration=function(n){if(n){var e=EI();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Io.length&&e!==0&&e<Io[t].priority;t++);Io.splice(t,0,n),t===0&&TI(n)}};function fw(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Km(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function UT(){}function wN(n,e,t,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var d=qg(o);s.call(d)}}var o=G6(e,r,n,0,null,!1,!1,"",UT);return n._reactRootContainer=o,n[Gs]=o.current,ld(n.nodeType===8?n.parentNode:n),tl(),o}for(;i=n.lastChild;)n.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var d=qg(c);l.call(d)}}var c=cw(n,0,!1,null,null,!1,!1,"",UT);return n._reactRootContainer=c,n[Gs]=c.current,ld(n.nodeType===8?n.parentNode:n),tl(function(){$m(e,c,t,r)}),c}function Qm(n,e,t,r,i){var s=t._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var c=qg(o);l.call(c)}}$m(e,o,n,i)}else o=wN(t,e,n,i,r);return qg(o)}vI=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Ch(e.pendingLanes);t!==0&&(D2(e,t|1),Nr(e,Gt()),!(Je&6)&&(zu=Gt()+500,ia()))}break;case 13:tl(function(){var r=Ws(n,1);if(r!==null){var i=fr();Ri(r,n,1,i)}}),hw(n,1)}};O2=function(n){if(n.tag===13){var e=Ws(n,134217728);if(e!==null){var t=fr();Ri(e,n,134217728,t)}hw(n,134217728)}};wI=function(n){if(n.tag===13){var e=Uo(n),t=Ws(n,e);if(t!==null){var r=fr();Ri(t,n,e,r)}hw(n,e)}};EI=function(){return ut};SI=function(n,e){var t=ut;try{return ut=n,e()}finally{ut=t}};Wv=function(n,e,t){switch(e){case"input":if(Fv(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var i=Um(r);if(!i)throw Error(ee(90));Z5(r),Fv(r,i)}}}break;case"textarea":tI(n,t);break;case"select":e=t.value,e!=null&&Eu(n,!!t.multiple,e,!1)}};lI=ow;uI=tl;var EN={usingClientEntryPoint:!1,Events:[$d,du,Um,oI,aI,ow]},dh={findFiberByHostInstance:Ba,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},SN={bundleType:dh.bundleType,version:dh.version,rendererPackageName:dh.rendererPackageName,rendererConfig:dh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Js.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=dI(n),n===null?null:n.stateNode},findFiberByHostInstance:dh.findFiberByHostInstance||vN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zp.isDisabled&&zp.supportsFiber)try{Mm=zp.inject(SN),Zi=zp}catch{}}jr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=EN;jr.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!fw(e))throw Error(ee(200));return yN(n,e,null,t)};jr.createRoot=function(n,e){if(!fw(n))throw Error(ee(299));var t=!1,r="",i=W6;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=cw(n,1,!1,null,null,t,!1,r,i),n[Gs]=e.current,ld(n.nodeType===8?n.parentNode:n),new dw(e)};jr.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(ee(188)):(n=Object.keys(n).join(","),Error(ee(268,n)));return n=dI(e),n=n===null?null:n.stateNode,n};jr.flushSync=function(n){return tl(n)};jr.hydrate=function(n,e,t){if(!Km(e))throw Error(ee(200));return Qm(null,n,e,!0,t)};jr.hydrateRoot=function(n,e,t){if(!fw(n))throw Error(ee(405));var r=t!=null&&t.hydratedSources||null,i=!1,s="",o=W6;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=G6(e,null,n,1,t??null,i,!1,s,o),n[Gs]=e.current,ld(n),r)for(n=0;n<r.length;n++)t=r[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new qm(e)};jr.render=function(n,e,t){if(!Km(e))throw Error(ee(200));return Qm(null,n,e,!1,t)};jr.unmountComponentAtNode=function(n){if(!Km(n))throw Error(ee(40));return n._reactRootContainer?(tl(function(){Qm(null,null,n,!1,function(){n._reactRootContainer=null,n[Gs]=null})}),!0):!1};jr.unstable_batchedUpdates=ow;jr.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!Km(t))throw Error(ee(200));if(n==null||n._reactInternals===void 0)throw Error(ee(38));return Qm(n,e,t,!1,r)};jr.version="18.3.1-next-f1338f8080-20240426";function H6(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(H6)}catch(n){console.error(n)}}H6(),H5.exports=jr;var TN=H5.exports,zT=TN;xv.createRoot=zT.createRoot,xv.hydrateRoot=zT.hydrateRoot;var BT={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $6={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ie=function(n,e){if(!n)throw ac(e)},ac=function(n){return new Error("Firebase Database ("+$6.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q6=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},CN=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],o=n[t++],l=n[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},pw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],o=i+1<n.length,l=o?n[i+1]:0,c=i+2<n.length,d=c?n[i+2]:0,p=s>>2,_=(s&3)<<4|l>>4;let m=(l&15)<<2|d>>6,S=d&63;c||(S=64,o||(m=64)),r.push(t[p],t[_],t[m],t[S])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(q6(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):CN(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],l=i<n.length?t[n.charAt(i)]:0;++i;const d=i<n.length?t[n.charAt(i)]:64;++i;const _=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||l==null||d==null||_==null)throw new IN;const m=s<<2|l>>4;if(r.push(m),d!==64){const S=l<<4&240|d>>2;if(r.push(S),_!==64){const E=d<<6&192|_;r.push(E)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class IN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const K6=function(n){const e=q6(n);return pw.encodeByteArray(e,!0)},Kg=function(n){return K6(n).replace(/\./g,"")},Qg=function(n){try{return pw.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PN(n){return Q6(void 0,n)}function Q6(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!RN(t)||(n[t]=Q6(n[t],e[t]));return n}function RN(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AN=()=>kN().__FIREBASE_DEFAULTS__,xN=()=>{if(typeof process>"u"||typeof BT>"u")return;const n=BT.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},NN=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Qg(n[1]);return e&&JSON.parse(e)},Ym=()=>{try{return AN()||xN()||NN()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Y6=n=>{var e,t;return(t=(e=Ym())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},X6=n=>{const e=Y6(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},J6=()=>{var n;return(n=Ym())===null||n===void 0?void 0:n.config},Z6=n=>{var e;return(e=Ym())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eP(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Kg(JSON.stringify(t)),Kg(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function gw(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(rr())}function DN(){var n;const e=(n=Ym())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ON(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function bN(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function tP(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function MN(){const n=rr();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function LN(){return $6.NODE_ADMIN===!0}function FN(){return!DN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function VN(){try{return typeof indexedDB=="object"}catch{return!1}}function UN(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zN="FirebaseError";class Zs extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=zN,Object.setPrototypeOf(this,Zs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Kd.prototype.create)}}class Kd{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?BN(s,r):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new Zs(i,l,r)}}function BN(n,e){return n.replace(jN,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const jN=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _d(n){return JSON.parse(n)}function Cn(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nP=function(n){let e={},t={},r={},i="";try{const s=n.split(".");e=_d(Qg(s[0])||""),t=_d(Qg(s[1])||""),i=s[2],r=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:r,signature:i}},GN=function(n){const e=nP(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},WN=function(n){const e=nP(n).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ss(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Bu(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function Yg(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Xg(n,e,t){const r={};for(const i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=e.call(t,n[i],i,n));return r}function Jg(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],o=e[i];if(jT(s)&&jT(o)){if(!Jg(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function jT(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lc(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Ph(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Rh(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HN{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const r=this.W_;if(typeof e=="string")for(let _=0;_<16;_++)r[_]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let _=0;_<16;_++)r[_]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let _=16;_<80;_++){const m=r[_-3]^r[_-8]^r[_-14]^r[_-16];r[_]=(m<<1|m>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],l=this.chain_[3],c=this.chain_[4],d,p;for(let _=0;_<80;_++){_<40?_<20?(d=l^s&(o^l),p=1518500249):(d=s^o^l,p=1859775393):_<60?(d=s&o|l&(s|o),p=2400959708):(d=s^o^l,p=3395469782);const m=(i<<5|i>>>27)+d+c+p+r[_]&4294967295;c=l,l=o,o=(s<<30|s>>>2)&4294967295,s=i,i=m}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const r=t-this.blockSize;let i=0;const s=this.buf_;let o=this.inbuf_;for(;i<t;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<t;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<t;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=t&255,t/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}}function $N(n,e){const t=new qN(n,e);return t.subscribe.bind(t)}class qN{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");KN(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Jy),i.error===void 0&&(i.error=Jy),i.complete===void 0&&(i.complete=Jy);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function KN(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Jy(){}function ju(n,e){return`${n} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QN=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);if(i>=55296&&i<=56319){const s=i-55296;r++,ie(r<n.length,"Surrogate pair missing trail surrogate.");const o=n.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):i<65536?(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Xm=function(n){let e=0;for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vt(n){return n&&n._delegate?n._delegate:n}class Ko{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Va="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YN{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new As;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(JN(e))try{this.getOrInitializeService({instanceIdentifier:Va})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Va){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Va){return this.instances.has(e)}getOptions(e=Va){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);r===l&&o.resolve(i)}return i}onInit(e,t){var r;const i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:XN(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Va){return this.component?this.component.multipleInstances?e:Va:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function XN(n){return n===Va?void 0:n}function JN(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new YN(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var We;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(We||(We={}));const e7={debug:We.DEBUG,verbose:We.VERBOSE,info:We.INFO,warn:We.WARN,error:We.ERROR,silent:We.SILENT},t7=We.INFO,n7={[We.DEBUG]:"log",[We.VERBOSE]:"log",[We.INFO]:"info",[We.WARN]:"warn",[We.ERROR]:"error"},r7=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=n7[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Jm{constructor(e){this.name=e,this._logLevel=t7,this._logHandler=r7,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in We))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?e7[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,We.DEBUG,...e),this._logHandler(this,We.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,We.VERBOSE,...e),this._logHandler(this,We.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,We.INFO,...e),this._logHandler(this,We.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,We.WARN,...e),this._logHandler(this,We.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,We.ERROR,...e),this._logHandler(this,We.ERROR,...e)}}const i7=(n,e)=>e.some(t=>n instanceof t);let GT,WT;function s7(){return GT||(GT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function o7(){return WT||(WT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const rP=new WeakMap,T1=new WeakMap,iP=new WeakMap,Zy=new WeakMap,mw=new WeakMap;function a7(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Bo(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&rP.set(t,n)}).catch(()=>{}),mw.set(e,n),e}function l7(n){if(T1.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});T1.set(n,e)}let C1={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return T1.get(n);if(e==="objectStoreNames")return n.objectStoreNames||iP.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Bo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function u7(n){C1=n(C1)}function c7(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(ev(this),e,...t);return iP.set(r,e.sort?e.sort():[e]),Bo(r)}:o7().includes(n)?function(...e){return n.apply(ev(this),e),Bo(rP.get(this))}:function(...e){return Bo(n.apply(ev(this),e))}}function h7(n){return typeof n=="function"?c7(n):(n instanceof IDBTransaction&&l7(n),i7(n,s7())?new Proxy(n,C1):n)}function Bo(n){if(n instanceof IDBRequest)return a7(n);if(Zy.has(n))return Zy.get(n);const e=h7(n);return e!==n&&(Zy.set(n,e),mw.set(e,n)),e}const ev=n=>mw.get(n);function d7(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(n,e),l=Bo(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Bo(o.result),c.oldVersion,c.newVersion,Bo(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),l.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const f7=["get","getKey","getAll","getAllKeys","count"],p7=["put","add","delete","clear"],tv=new Map;function HT(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(tv.get(e))return tv.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=p7.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||f7.includes(t)))return;const s=async function(o,...l){const c=this.transaction(o,i?"readwrite":"readonly");let d=c.store;return r&&(d=d.index(l.shift())),(await Promise.all([d[t](...l),i&&c.done]))[0]};return tv.set(e,s),s}u7(n=>({...n,get:(e,t,r)=>HT(e,t)||n.get(e,t,r),has:(e,t)=>!!HT(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g7{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(m7(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function m7(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const I1="@firebase/app",$T="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $s=new Jm("@firebase/app"),_7="@firebase/app-compat",y7="@firebase/analytics-compat",v7="@firebase/analytics",w7="@firebase/app-check-compat",E7="@firebase/app-check",S7="@firebase/auth",T7="@firebase/auth-compat",C7="@firebase/database",I7="@firebase/data-connect",P7="@firebase/database-compat",R7="@firebase/functions",k7="@firebase/functions-compat",A7="@firebase/installations",x7="@firebase/installations-compat",N7="@firebase/messaging",D7="@firebase/messaging-compat",O7="@firebase/performance",b7="@firebase/performance-compat",M7="@firebase/remote-config",L7="@firebase/remote-config-compat",F7="@firebase/storage",V7="@firebase/storage-compat",U7="@firebase/firestore",z7="@firebase/vertexai-preview",B7="@firebase/firestore-compat",j7="firebase",G7="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P1="[DEFAULT]",W7={[I1]:"fire-core",[_7]:"fire-core-compat",[v7]:"fire-analytics",[y7]:"fire-analytics-compat",[E7]:"fire-app-check",[w7]:"fire-app-check-compat",[S7]:"fire-auth",[T7]:"fire-auth-compat",[C7]:"fire-rtdb",[I7]:"fire-data-connect",[P7]:"fire-rtdb-compat",[R7]:"fire-fn",[k7]:"fire-fn-compat",[A7]:"fire-iid",[x7]:"fire-iid-compat",[N7]:"fire-fcm",[D7]:"fire-fcm-compat",[O7]:"fire-perf",[b7]:"fire-perf-compat",[M7]:"fire-rc",[L7]:"fire-rc-compat",[F7]:"fire-gcs",[V7]:"fire-gcs-compat",[U7]:"fire-fst",[B7]:"fire-fst-compat",[z7]:"fire-vertex","fire-js":"fire-js",[j7]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zg=new Map,H7=new Map,R1=new Map;function qT(n,e){try{n.container.addComponent(e)}catch(t){$s.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function nl(n){const e=n.name;if(R1.has(e))return $s.debug(`There were multiple attempts to register component ${e}.`),!1;R1.set(e,n);for(const t of Zg.values())qT(t,n);for(const t of H7.values())qT(t,n);return!0}function Zm(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ci(n){return n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $7={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},jo=new Kd("app","Firebase",$7);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q7{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ko("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw jo.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gl=G7;function sP(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:P1,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw jo.create("bad-app-name",{appName:String(i)});if(t||(t=J6()),!t)throw jo.create("no-options");const s=Zg.get(i);if(s){if(Jg(t,s.options)&&Jg(r,s.config))return s;throw jo.create("duplicate-app",{appName:i})}const o=new ZN(i);for(const c of R1.values())o.addComponent(c);const l=new q7(t,r,o);return Zg.set(i,l),l}function _w(n=P1){const e=Zg.get(n);if(!e&&n===P1&&J6())return sP();if(!e)throw jo.create("no-app",{appName:n});return e}function ts(n,e,t){var r;let i=(r=W7[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),$s.warn(l.join(" "));return}nl(new Ko(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K7="firebase-heartbeat-database",Q7=1,yd="firebase-heartbeat-store";let nv=null;function oP(){return nv||(nv=d7(K7,Q7,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(yd)}catch(t){console.warn(t)}}}}).catch(n=>{throw jo.create("idb-open",{originalErrorMessage:n.message})})),nv}async function Y7(n){try{const t=(await oP()).transaction(yd),r=await t.objectStore(yd).get(aP(n));return await t.done,r}catch(e){if(e instanceof Zs)$s.warn(e.message);else{const t=jo.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});$s.warn(t.message)}}}async function KT(n,e){try{const r=(await oP()).transaction(yd,"readwrite");await r.objectStore(yd).put(e,aP(n)),await r.done}catch(t){if(t instanceof Zs)$s.warn(t.message);else{const r=jo.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});$s.warn(r.message)}}}function aP(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X7=1024,J7=30*24*60*60*1e3;class Z7{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new tD(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=QT();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=J7}),this._storage.overwrite(this._heartbeatsCache))}catch(r){$s.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=QT(),{heartbeatsToSend:r,unsentEntries:i}=eD(this._heartbeatsCache.heartbeats),s=Kg(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return $s.warn(t),""}}}function QT(){return new Date().toISOString().substring(0,10)}function eD(n,e=X7){const t=[];let r=n.slice();for(const i of n){const s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),YT(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),YT(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class tD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return VN()?UN().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Y7(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return KT(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return KT(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function YT(n){return Kg(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nD(n){nl(new Ko("platform-logger",e=>new g7(e),"PRIVATE")),nl(new Ko("heartbeat",e=>new Z7(e),"PRIVATE")),ts(I1,$T,n),ts(I1,$T,"esm2017"),ts("fire-js","")}nD("");function yw(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function lP(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const rD=lP,uP=new Kd("auth","Firebase",lP());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const em=new Jm("@firebase/auth");function iD(n,...e){em.logLevel<=We.WARN&&em.warn(`Auth (${gl}): ${n}`,...e)}function dg(n,...e){em.logLevel<=We.ERROR&&em.error(`Auth (${gl}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ai(n,...e){throw ww(n,...e)}function ki(n,...e){return ww(n,...e)}function vw(n,e,t){const r=Object.assign(Object.assign({},rD()),{[e]:t});return new Kd("auth","Firebase",r).create(e,{appName:n.name})}function Vs(n){return vw(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function sD(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&ai(n,"argument-error"),vw(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function ww(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return uP.create(n,...e)}function Ce(n,e,...t){if(!n)throw ww(e,...t)}function Os(n){const e="INTERNAL ASSERTION FAILED: "+n;throw dg(e),new Error(e)}function qs(n,e){n||Os(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k1(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function oD(){return XT()==="http:"||XT()==="https:"}function XT(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(oD()||bN()||"connection"in navigator)?navigator.onLine:!0}function lD(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qd{constructor(e,t){this.shortDelay=e,this.longDelay=t,qs(t>e,"Short delay should be less than long delay!"),this.isMobile=gw()||tP()}get(){return aD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ew(n,e){qs(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cP{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Os("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Os("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Os("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cD=new Qd(3e4,6e4);function sa(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function oa(n,e,t,r,i={}){return hP(n,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const l=lc(Object.assign({key:n.config.apiKey},o)).slice(1),c=await n._getAdditionalHeaders();c["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode);const d=Object.assign({method:e,headers:c},s);return ON()||(d.referrerPolicy="no-referrer"),cP.fetch()(dP(n,n.config.apiHost,t,l),d)})}async function hP(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},uD),e);try{const i=new dD(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Bp(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[c,d]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Bp(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Bp(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw Bp(n,"user-disabled",o);const p=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw vw(n,p,d);ai(n,p)}}catch(i){if(i instanceof Zs)throw i;ai(n,"network-request-failed",{message:String(i)})}}async function Yd(n,e,t,r,i={}){const s=await oa(n,e,t,r,i);return"mfaPendingCredential"in s&&ai(n,"multi-factor-auth-required",{_serverResponse:s}),s}function dP(n,e,t,r){const i=`${e}${t}?${r}`;return n.config.emulator?Ew(n.config,i):`${n.config.apiScheme}://${i}`}function hD(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class dD{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(ki(this.auth,"network-request-failed")),cD.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Bp(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=ki(n,e,r);return i.customData._tokenResponse=t,i}function JT(n){return n!==void 0&&n.enterprise!==void 0}class fD{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return hD(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function pD(n,e){return oa(n,"GET","/v2/recaptchaConfig",sa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gD(n,e){return oa(n,"POST","/v1/accounts:delete",e)}async function fP(n,e){return oa(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gh(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function mD(n,e=!1){const t=vt(n),r=await t.getIdToken(e),i=Sw(r);Ce(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Gh(rv(i.auth_time)),issuedAtTime:Gh(rv(i.iat)),expirationTime:Gh(rv(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function rv(n){return Number(n)*1e3}function Sw(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return dg("JWT malformed, contained fewer than 3 sections"),null;try{const i=Qg(t);return i?JSON.parse(i):(dg("Failed to decode base64 JWT payload"),null)}catch(i){return dg("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function ZT(n){const e=Sw(n);return Ce(e,"internal-error"),Ce(typeof e.exp<"u","internal-error"),Ce(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vd(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Zs&&_D(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function _D({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yD{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A1{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Gh(this.lastLoginAt),this.creationTime=Gh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tm(n){var e;const t=n.auth,r=await n.getIdToken(),i=await vd(n,fP(t,{idToken:r}));Ce(i==null?void 0:i.users.length,t,"internal-error");const s=i.users[0];n._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?pP(s.providerUserInfo):[],l=wD(n.providerData,o),c=n.isAnonymous,d=!(n.email&&s.passwordHash)&&!(l!=null&&l.length),p=c?d:!1,_={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new A1(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,_)}async function vD(n){const e=vt(n);await tm(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function wD(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function pP(n){return n.map(e=>{var{providerId:t}=e,r=yw(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ED(n,e){const t=await hP(n,{},async()=>{const r=lc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=dP(n,i,"/v1/token",`key=${s}`),l=await n._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",cP.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function SD(n,e){return oa(n,"POST","/v2/accounts:revokeToken",sa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ru{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ce(e.idToken,"internal-error"),Ce(typeof e.idToken<"u","internal-error"),Ce(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ZT(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ce(e.length!==0,"internal-error");const t=ZT(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ce(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await ED(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new Ru;return r&&(Ce(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(Ce(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(Ce(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ru,this.toJSON())}_performRefresh(){return Os("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wo(n,e){Ce(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class bs{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=yw(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new yD(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new A1(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await vd(this,this.stsTokenManager.getToken(this.auth,e));return Ce(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return mD(this,e)}reload(){return vD(this)}_assign(e){this!==e&&(Ce(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new bs(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Ce(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await tm(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ci(this.auth.app))return Promise.reject(Vs(this.auth));const e=await this.getIdToken();return await vd(this,gD(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,l,c,d,p;const _=(r=t.displayName)!==null&&r!==void 0?r:void 0,m=(i=t.email)!==null&&i!==void 0?i:void 0,S=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,E=(o=t.photoURL)!==null&&o!==void 0?o:void 0,A=(l=t.tenantId)!==null&&l!==void 0?l:void 0,D=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,k=(d=t.createdAt)!==null&&d!==void 0?d:void 0,R=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:w,emailVerified:P,isAnonymous:V,providerData:U,stsTokenManager:N}=t;Ce(w&&N,e,"internal-error");const C=Ru.fromJSON(this.name,N);Ce(typeof w=="string",e,"internal-error"),wo(_,e.name),wo(m,e.name),Ce(typeof P=="boolean",e,"internal-error"),Ce(typeof V=="boolean",e,"internal-error"),wo(S,e.name),wo(E,e.name),wo(A,e.name),wo(D,e.name),wo(k,e.name),wo(R,e.name);const O=new bs({uid:w,auth:e,email:m,emailVerified:P,displayName:_,isAnonymous:V,photoURL:E,phoneNumber:S,tenantId:A,stsTokenManager:C,createdAt:k,lastLoginAt:R});return U&&Array.isArray(U)&&(O.providerData=U.map(x=>Object.assign({},x))),D&&(O._redirectEventId=D),O}static async _fromIdTokenResponse(e,t,r=!1){const i=new Ru;i.updateFromServerResponse(t);const s=new bs({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await tm(s),s}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];Ce(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?pP(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),l=new Ru;l.updateFromIdToken(r);const c=new bs({uid:i.localId,auth:e,stsTokenManager:l,isAnonymous:o}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new A1(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(c,d),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eC=new Map;function Ms(n){qs(n instanceof Function,"Expected a class definition");let e=eC.get(n);return e?(qs(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,eC.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gP{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}gP.type="NONE";const tC=gP;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fg(n,e,t){return`firebase:${n}:${e}:${t}`}class ku{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=fg(this.userKey,i.apiKey,s),this.fullPersistenceKey=fg("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?bs._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new ku(Ms(tC),e,r);const i=(await Promise.all(t.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let s=i[0]||Ms(tC);const o=fg(r,e.config.apiKey,e.name);let l=null;for(const d of t)try{const p=await d._get(o);if(p){const _=bs._fromJSON(e,p);d!==s&&(l=_),s=d;break}}catch{}const c=i.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new ku(s,e,r):(s=c[0],l&&await s._set(o,l.toJSON()),await Promise.all(t.map(async d=>{if(d!==s)try{await d._remove(o)}catch{}})),new ku(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nC(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(vP(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(mP(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(EP(e))return"Blackberry";if(SP(e))return"Webos";if(_P(e))return"Safari";if((e.includes("chrome/")||yP(e))&&!e.includes("edge/"))return"Chrome";if(wP(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function mP(n=rr()){return/firefox\//i.test(n)}function _P(n=rr()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function yP(n=rr()){return/crios\//i.test(n)}function vP(n=rr()){return/iemobile/i.test(n)}function wP(n=rr()){return/android/i.test(n)}function EP(n=rr()){return/blackberry/i.test(n)}function SP(n=rr()){return/webos/i.test(n)}function Tw(n=rr()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function TD(n=rr()){var e;return Tw(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function CD(){return MN()&&document.documentMode===10}function TP(n=rr()){return Tw(n)||wP(n)||SP(n)||EP(n)||/windows phone/i.test(n)||vP(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CP(n,e=[]){let t;switch(n){case"Browser":t=nC(rr());break;case"Worker":t=`${nC(rr())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${gl}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ID{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((o,l)=>{try{const c=e(s);o(c)}catch(c){l(c)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PD(n,e={}){return oa(n,"GET","/v2/passwordPolicy",sa(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RD=6;class kD{constructor(e){var t,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:RD,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AD{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new rC(this),this.idTokenSubscription=new rC(this),this.beforeStateQueue=new ID(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=uP,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ms(t)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await ku.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await fP(this,{idToken:e}),r=await bs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Ci(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,l=i==null?void 0:i._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ce(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await tm(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=lD()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ci(this.app))return Promise.reject(Vs(this));const t=e?vt(e):null;return t&&Ce(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ce(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ci(this.app)?Promise.reject(Vs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ci(this.app)?Promise.reject(Vs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ms(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await PD(this),t=new kD(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Kd("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await SD(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ms(e)||this._popupRedirectResolver;Ce(t,this,"argument-error"),this.redirectPersistenceManager=await ku.create(this,[Ms(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ce(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const c=e.addObserver(t,r,i);return()=>{o=!0,c()}}else{const c=e.addObserver(t);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ce(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=CP(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&iD(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function aa(n){return vt(n)}class rC{constructor(e){this.auth=e,this.observer=null,this.addObserver=$N(t=>this.observer=t)}get next(){return Ce(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let e0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function xD(n){e0=n}function IP(n){return e0.loadJS(n)}function ND(){return e0.recaptchaEnterpriseScript}function DD(){return e0.gapiScript}function OD(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const bD="recaptcha-enterprise",MD="NO_RECAPTCHA";class LD{constructor(e){this.type=bD,this.auth=aa(e)}async verify(e="verify",t=!1){async function r(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,l)=>{pD(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const d=new fD(c);return s.tenantId==null?s._agentRecaptchaConfig=d:s._tenantRecaptchaConfigs[s.tenantId]=d,o(d.siteKey)}}).catch(c=>{l(c)})})}function i(s,o,l){const c=window.grecaptcha;JT(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(d=>{o(d)}).catch(()=>{o(MD)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(l=>{if(!t&&JT(window.grecaptcha))i(l,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=ND();c.length!==0&&(c+=l),IP(c).then(()=>{i(l,s,o)}).catch(d=>{o(d)})}}).catch(l=>{o(l)})})}}async function iC(n,e,t,r=!1){const i=new LD(n);let s;try{s=await i.verify(t)}catch{s=await i.verify(t,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function x1(n,e,t,r){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await iC(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await iC(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FD(n,e){const t=Zm(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(Jg(s,e??{}))return i;ai(i,"already-initialized")}return t.initialize({options:e})}function VD(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Ms);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function UD(n,e,t){const r=aa(n);Ce(r._canInitEmulator,r,"emulator-config-failed"),Ce(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=PP(e),{host:o,port:l}=zD(e),c=l===null?"":`:${l}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),BD()}function PP(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function zD(n){const e=PP(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:sC(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:sC(o)}}}function sC(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function BD(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cw{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Os("not implemented")}_getIdTokenResponse(e){return Os("not implemented")}_linkToIdToken(e,t){return Os("not implemented")}_getReauthenticationResolver(e){return Os("not implemented")}}async function jD(n,e){return oa(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GD(n,e){return Yd(n,"POST","/v1/accounts:signInWithPassword",sa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WD(n,e){return Yd(n,"POST","/v1/accounts:signInWithEmailLink",sa(n,e))}async function HD(n,e){return Yd(n,"POST","/v1/accounts:signInWithEmailLink",sa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd extends Cw{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new wd(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new wd(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return x1(e,t,"signInWithPassword",GD);case"emailLink":return WD(e,{email:this._email,oobCode:this._password});default:ai(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return x1(e,r,"signUpPassword",jD);case"emailLink":return HD(e,{idToken:t,email:this._email,oobCode:this._password});default:ai(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Au(n,e){return Yd(n,"POST","/v1/accounts:signInWithIdp",sa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $D="http://localhost";class rl extends Cw{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new rl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ai("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=yw(t,["providerId","signInMethod"]);if(!r||!i)return null;const o=new rl(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Au(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Au(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Au(e,t)}buildRequest(){const e={requestUri:$D,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=lc(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qD(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function KD(n){const e=Ph(Rh(n)).link,t=e?Ph(Rh(e)).deep_link_id:null,r=Ph(Rh(n)).deep_link_id;return(r?Ph(Rh(r)).link:null)||r||t||e||n}class Iw{constructor(e){var t,r,i,s,o,l;const c=Ph(Rh(e)),d=(t=c.apiKey)!==null&&t!==void 0?t:null,p=(r=c.oobCode)!==null&&r!==void 0?r:null,_=qD((i=c.mode)!==null&&i!==void 0?i:null);Ce(d&&p&&_,"argument-error"),this.apiKey=d,this.operation=_,this.code=p,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const t=KD(e);try{return new Iw(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc{constructor(){this.providerId=uc.PROVIDER_ID}static credential(e,t){return wd._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Iw.parseLink(t);return Ce(r,"argument-error"),wd._fromEmailAndCode(e,r.code,r.tenantId)}}uc.PROVIDER_ID="password";uc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";uc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xd extends Pw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro extends Xd{constructor(){super("facebook.com")}static credential(e){return rl._fromParams({providerId:Ro.PROVIDER_ID,signInMethod:Ro.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ro.credentialFromTaggedObject(e)}static credentialFromError(e){return Ro.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ro.credential(e.oauthAccessToken)}catch{return null}}}Ro.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ro.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs extends Xd{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return rl._fromParams({providerId:xs.PROVIDER_ID,signInMethod:xs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return xs.credentialFromTaggedObject(e)}static credentialFromError(e){return xs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return xs.credential(t,r)}catch{return null}}}xs.GOOGLE_SIGN_IN_METHOD="google.com";xs.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko extends Xd{constructor(){super("github.com")}static credential(e){return rl._fromParams({providerId:ko.PROVIDER_ID,signInMethod:ko.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ko.credentialFromTaggedObject(e)}static credentialFromError(e){return ko.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ko.credential(e.oauthAccessToken)}catch{return null}}}ko.GITHUB_SIGN_IN_METHOD="github.com";ko.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao extends Xd{constructor(){super("twitter.com")}static credential(e,t){return rl._fromParams({providerId:Ao.PROVIDER_ID,signInMethod:Ao.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ao.credentialFromTaggedObject(e)}static credentialFromError(e){return Ao.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Ao.credential(t,r)}catch{return null}}}Ao.TWITTER_SIGN_IN_METHOD="twitter.com";Ao.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QD(n,e){return Yd(n,"POST","/v1/accounts:signUp",sa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await bs._fromIdTokenResponse(e,r,i),o=oC(r);return new il({user:s,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=oC(r);return new il({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function oC(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nm extends Zs{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,nm.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new nm(e,t,r,i)}}function RP(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?nm._fromErrorAndOperation(n,s,e,r):s})}async function YD(n,e,t=!1){const r=await vd(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return il._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XD(n,e,t=!1){const{auth:r}=n;if(Ci(r.app))return Promise.reject(Vs(r));const i="reauthenticate";try{const s=await vd(n,RP(r,i,e,n),t);Ce(s.idToken,r,"internal-error");const o=Sw(s.idToken);Ce(o,r,"internal-error");const{sub:l}=o;return Ce(n.uid===l,r,"user-mismatch"),il._forOperation(n,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&ai(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kP(n,e,t=!1){if(Ci(n.app))return Promise.reject(Vs(n));const r="signIn",i=await RP(n,r,e),s=await il._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}async function JD(n,e){return kP(aa(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AP(n){const e=aa(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function ZD(n,e,t){if(Ci(n.app))return Promise.reject(Vs(n));const r=aa(n),o=await x1(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",QD).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&AP(n),c}),l=await il._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(l.user),l}function eO(n,e,t){return Ci(n.app)?Promise.reject(Vs(n)):JD(vt(n),uc.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&AP(n),r})}function tO(n,e,t,r){return vt(n).onIdTokenChanged(e,t,r)}function nO(n,e,t){return vt(n).beforeAuthStateChanged(e,t)}function rO(n,e,t,r){return vt(n).onAuthStateChanged(e,t,r)}function iO(n){return vt(n).signOut()}const rm="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xP{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(rm,"1"),this.storage.removeItem(rm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sO=1e3,oO=10;class NP extends xP{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=TP(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);CD()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,oO):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},sO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}NP.type="LOCAL";const aO=NP;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DP extends xP{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}DP.type="SESSION";const OP=DP;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lO(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t0{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new t0(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const l=Array.from(o).map(async d=>d(t.origin,s)),c=await lO(l);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:c})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}t0.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rw(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uO{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((l,c)=>{const d=Rw("",20);i.port1.start();const p=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(_){const m=_;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(p),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(m.data.response);break;default:clearTimeout(p),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ns(){return window}function cO(n){ns().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bP(){return typeof ns().WorkerGlobalScope<"u"&&typeof ns().importScripts=="function"}async function hO(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function dO(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function fO(){return bP()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MP="firebaseLocalStorageDb",pO=1,im="firebaseLocalStorage",LP="fbase_key";class Jd{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function n0(n,e){return n.transaction([im],e?"readwrite":"readonly").objectStore(im)}function gO(){const n=indexedDB.deleteDatabase(MP);return new Jd(n).toPromise()}function N1(){const n=indexedDB.open(MP,pO);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(im,{keyPath:LP})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(im)?e(r):(r.close(),await gO(),e(await N1()))})})}async function aC(n,e,t){const r=n0(n,!0).put({[LP]:e,value:t});return new Jd(r).toPromise()}async function mO(n,e){const t=n0(n,!1).get(e),r=await new Jd(t).toPromise();return r===void 0?null:r.value}function lC(n,e){const t=n0(n,!0).delete(e);return new Jd(t).toPromise()}const _O=800,yO=3;class FP{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await N1(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>yO)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return bP()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=t0._getInstance(fO()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await hO(),!this.activeServiceWorker)return;this.sender=new uO(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||dO()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await N1();return await aC(e,rm,"1"),await lC(e,rm),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>aC(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>mO(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>lC(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=n0(i,!1).getAll();return new Jd(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),_O)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}FP.type="LOCAL";const vO=FP;new Qd(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VP(n,e){return e?Ms(e):(Ce(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kw extends Cw{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Au(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Au(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Au(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function wO(n){return kP(n.auth,new kw(n),n.bypassAuthState)}function EO(n){const{auth:e,user:t}=n;return Ce(t,e,"internal-error"),XD(t,new kw(n),n.bypassAuthState)}async function SO(n){const{auth:e,user:t}=n;return Ce(t,e,"internal-error"),YD(t,new kw(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UP{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return wO;case"linkViaPopup":case"linkViaRedirect":return SO;case"reauthViaPopup":case"reauthViaRedirect":return EO;default:ai(this.auth,"internal-error")}}resolve(e){qs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){qs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TO=new Qd(2e3,1e4);async function CO(n,e,t){if(Ci(n.app))return Promise.reject(ki(n,"operation-not-supported-in-this-environment"));const r=aa(n);sD(n,e,Pw);const i=VP(r,t);return new Wa(r,"signInViaPopup",e,i).executeNotNull()}class Wa extends UP{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Wa.currentPopupAction&&Wa.currentPopupAction.cancel(),Wa.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ce(e,this.auth,"internal-error"),e}async onExecution(){qs(this.filter.length===1,"Popup operations only handle one event");const e=Rw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ki(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ki(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Wa.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ki(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,TO.get())};e()}}Wa.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IO="pendingRedirect",pg=new Map;class PO extends UP{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=pg.get(this.auth._key());if(!e){try{const r=await RO(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}pg.set(this.auth._key(),e)}return this.bypassAuthState||pg.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function RO(n,e){const t=xO(e),r=AO(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function kO(n,e){pg.set(n._key(),e)}function AO(n){return Ms(n._redirectPersistence)}function xO(n){return fg(IO,n.config.apiKey,n.name)}async function NO(n,e,t=!1){if(Ci(n.app))return Promise.reject(Vs(n));const r=aa(n),i=VP(r,e),o=await new PO(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DO=10*60*1e3;class OO{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!bO(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!zP(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(ki(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=DO&&this.cachedEventUids.clear(),this.cachedEventUids.has(uC(e))}saveEventToCache(e){this.cachedEventUids.add(uC(e)),this.lastProcessedEventTime=Date.now()}}function uC(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function zP({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function bO(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return zP(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MO(n,e={}){return oa(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LO=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,FO=/^https?/;async function VO(n){if(n.config.emulator)return;const{authorizedDomains:e}=await MO(n);for(const t of e)try{if(UO(t))return}catch{}ai(n,"unauthorized-domain")}function UO(n){const e=k1(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!FO.test(t))return!1;if(LO.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zO=new Qd(3e4,6e4);function cC(){const n=ns().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function BO(n){return new Promise((e,t)=>{var r,i,s;function o(){cC(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{cC(),t(ki(n,"network-request-failed"))},timeout:zO.get()})}if(!((i=(r=ns().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=ns().gapi)===null||s===void 0)&&s.load)o();else{const l=OD("iframefcb");return ns()[l]=()=>{gapi.load?o():t(ki(n,"network-request-failed"))},IP(`${DD()}?onload=${l}`).catch(c=>t(c))}}).catch(e=>{throw gg=null,e})}let gg=null;function jO(n){return gg=gg||BO(n),gg}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GO=new Qd(5e3,15e3),WO="__/auth/iframe",HO="emulator/auth/iframe",$O={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},qO=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function KO(n){const e=n.config;Ce(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Ew(e,HO):`https://${n.config.authDomain}/${WO}`,r={apiKey:e.apiKey,appName:n.name,v:gl},i=qO.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${lc(r).slice(1)}`}async function QO(n){const e=await jO(n),t=ns().gapi;return Ce(t,n,"internal-error"),e.open({where:document.body,url:KO(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:$O,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=ki(n,"network-request-failed"),l=ns().setTimeout(()=>{s(o)},GO.get());function c(){ns().clearTimeout(l),i(r)}r.ping(c).then(c,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YO={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},XO=500,JO=600,ZO="_blank",eb="http://localhost";class hC{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function tb(n,e,t,r=XO,i=JO){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},YO),{width:r.toString(),height:i.toString(),top:s,left:o}),d=rr().toLowerCase();t&&(l=yP(d)?ZO:t),mP(d)&&(e=e||eb,c.scrollbars="yes");const p=Object.entries(c).reduce((m,[S,E])=>`${m}${S}=${E},`,"");if(TD(d)&&l!=="_self")return nb(e||"",l),new hC(null);const _=window.open(e||"",l,p);Ce(_,n,"popup-blocked");try{_.focus()}catch{}return new hC(_)}function nb(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rb="__/auth/handler",ib="emulator/auth/handler",sb=encodeURIComponent("fac");async function dC(n,e,t,r,i,s){Ce(n.config.authDomain,n,"auth-domain-config-required"),Ce(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:gl,eventId:i};if(e instanceof Pw){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",Yg(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,_]of Object.entries({}))o[p]=_}if(e instanceof Xd){const p=e.getScopes().filter(_=>_!=="");p.length>0&&(o.scopes=p.join(","))}n.tenantId&&(o.tid=n.tenantId);const l=o;for(const p of Object.keys(l))l[p]===void 0&&delete l[p];const c=await n._getAppCheckToken(),d=c?`#${sb}=${encodeURIComponent(c)}`:"";return`${ob(n)}?${lc(l).slice(1)}${d}`}function ob({config:n}){return n.emulator?Ew(n,ib):`https://${n.authDomain}/${rb}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iv="webStorageSupport";class ab{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=OP,this._completeRedirectFn=NO,this._overrideRedirectResult=kO}async _openPopup(e,t,r,i){var s;qs((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await dC(e,t,r,k1(),i);return tb(e,o,Rw())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await dC(e,t,r,k1(),i);return cO(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(qs(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await QO(e),r=new OO(e);return t.register("authEvent",i=>(Ce(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(iv,{type:iv},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[iv];o!==void 0&&t(!!o),ai(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=VO(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return TP()||_P()||Tw()}}const lb=ab;var fC="@firebase/auth",pC="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ub{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ce(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cb(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function hb(n){nl(new Ko("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;Ce(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:CP(n)},d=new AD(r,i,s,c);return VD(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),nl(new Ko("auth-internal",e=>{const t=aa(e.getProvider("auth").getImmediate());return(r=>new ub(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ts(fC,pC,cb(n)),ts(fC,pC,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const db=5*60,fb=Z6("authIdTokenMaxAge")||db;let gC=null;const pb=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>fb)return;const i=t==null?void 0:t.token;gC!==i&&(gC=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function gb(n=_w()){const e=Zm(n,"auth");if(e.isInitialized())return e.getImmediate();const t=FD(n,{popupRedirectResolver:lb,persistence:[vO,aO,OP]}),r=Z6("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=pb(s.toString());nO(t,o,()=>o(t.currentUser)),tO(t,l=>o(l))}}const i=Y6("auth");return i&&UD(t,`http://${i}`),t}function mb(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}xD({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=ki("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",mb().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});hb("Browser");var _b="firebase",yb="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ts(_b,yb,"app");var mC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ya,BP;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(N,C){function O(){}O.prototype=C.prototype,N.D=C.prototype,N.prototype=new O,N.prototype.constructor=N,N.C=function(x,L,z){for(var F=Array(arguments.length-2),fe=2;fe<arguments.length;fe++)F[fe-2]=arguments[fe];return C.prototype[L].apply(x,F)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(N,C,O){O||(O=0);var x=Array(16);if(typeof C=="string")for(var L=0;16>L;++L)x[L]=C.charCodeAt(O++)|C.charCodeAt(O++)<<8|C.charCodeAt(O++)<<16|C.charCodeAt(O++)<<24;else for(L=0;16>L;++L)x[L]=C[O++]|C[O++]<<8|C[O++]<<16|C[O++]<<24;C=N.g[0],O=N.g[1],L=N.g[2];var z=N.g[3],F=C+(z^O&(L^z))+x[0]+3614090360&4294967295;C=O+(F<<7&4294967295|F>>>25),F=z+(L^C&(O^L))+x[1]+3905402710&4294967295,z=C+(F<<12&4294967295|F>>>20),F=L+(O^z&(C^O))+x[2]+606105819&4294967295,L=z+(F<<17&4294967295|F>>>15),F=O+(C^L&(z^C))+x[3]+3250441966&4294967295,O=L+(F<<22&4294967295|F>>>10),F=C+(z^O&(L^z))+x[4]+4118548399&4294967295,C=O+(F<<7&4294967295|F>>>25),F=z+(L^C&(O^L))+x[5]+1200080426&4294967295,z=C+(F<<12&4294967295|F>>>20),F=L+(O^z&(C^O))+x[6]+2821735955&4294967295,L=z+(F<<17&4294967295|F>>>15),F=O+(C^L&(z^C))+x[7]+4249261313&4294967295,O=L+(F<<22&4294967295|F>>>10),F=C+(z^O&(L^z))+x[8]+1770035416&4294967295,C=O+(F<<7&4294967295|F>>>25),F=z+(L^C&(O^L))+x[9]+2336552879&4294967295,z=C+(F<<12&4294967295|F>>>20),F=L+(O^z&(C^O))+x[10]+4294925233&4294967295,L=z+(F<<17&4294967295|F>>>15),F=O+(C^L&(z^C))+x[11]+2304563134&4294967295,O=L+(F<<22&4294967295|F>>>10),F=C+(z^O&(L^z))+x[12]+1804603682&4294967295,C=O+(F<<7&4294967295|F>>>25),F=z+(L^C&(O^L))+x[13]+4254626195&4294967295,z=C+(F<<12&4294967295|F>>>20),F=L+(O^z&(C^O))+x[14]+2792965006&4294967295,L=z+(F<<17&4294967295|F>>>15),F=O+(C^L&(z^C))+x[15]+1236535329&4294967295,O=L+(F<<22&4294967295|F>>>10),F=C+(L^z&(O^L))+x[1]+4129170786&4294967295,C=O+(F<<5&4294967295|F>>>27),F=z+(O^L&(C^O))+x[6]+3225465664&4294967295,z=C+(F<<9&4294967295|F>>>23),F=L+(C^O&(z^C))+x[11]+643717713&4294967295,L=z+(F<<14&4294967295|F>>>18),F=O+(z^C&(L^z))+x[0]+3921069994&4294967295,O=L+(F<<20&4294967295|F>>>12),F=C+(L^z&(O^L))+x[5]+3593408605&4294967295,C=O+(F<<5&4294967295|F>>>27),F=z+(O^L&(C^O))+x[10]+38016083&4294967295,z=C+(F<<9&4294967295|F>>>23),F=L+(C^O&(z^C))+x[15]+3634488961&4294967295,L=z+(F<<14&4294967295|F>>>18),F=O+(z^C&(L^z))+x[4]+3889429448&4294967295,O=L+(F<<20&4294967295|F>>>12),F=C+(L^z&(O^L))+x[9]+568446438&4294967295,C=O+(F<<5&4294967295|F>>>27),F=z+(O^L&(C^O))+x[14]+3275163606&4294967295,z=C+(F<<9&4294967295|F>>>23),F=L+(C^O&(z^C))+x[3]+4107603335&4294967295,L=z+(F<<14&4294967295|F>>>18),F=O+(z^C&(L^z))+x[8]+1163531501&4294967295,O=L+(F<<20&4294967295|F>>>12),F=C+(L^z&(O^L))+x[13]+2850285829&4294967295,C=O+(F<<5&4294967295|F>>>27),F=z+(O^L&(C^O))+x[2]+4243563512&4294967295,z=C+(F<<9&4294967295|F>>>23),F=L+(C^O&(z^C))+x[7]+1735328473&4294967295,L=z+(F<<14&4294967295|F>>>18),F=O+(z^C&(L^z))+x[12]+2368359562&4294967295,O=L+(F<<20&4294967295|F>>>12),F=C+(O^L^z)+x[5]+4294588738&4294967295,C=O+(F<<4&4294967295|F>>>28),F=z+(C^O^L)+x[8]+2272392833&4294967295,z=C+(F<<11&4294967295|F>>>21),F=L+(z^C^O)+x[11]+1839030562&4294967295,L=z+(F<<16&4294967295|F>>>16),F=O+(L^z^C)+x[14]+4259657740&4294967295,O=L+(F<<23&4294967295|F>>>9),F=C+(O^L^z)+x[1]+2763975236&4294967295,C=O+(F<<4&4294967295|F>>>28),F=z+(C^O^L)+x[4]+1272893353&4294967295,z=C+(F<<11&4294967295|F>>>21),F=L+(z^C^O)+x[7]+4139469664&4294967295,L=z+(F<<16&4294967295|F>>>16),F=O+(L^z^C)+x[10]+3200236656&4294967295,O=L+(F<<23&4294967295|F>>>9),F=C+(O^L^z)+x[13]+681279174&4294967295,C=O+(F<<4&4294967295|F>>>28),F=z+(C^O^L)+x[0]+3936430074&4294967295,z=C+(F<<11&4294967295|F>>>21),F=L+(z^C^O)+x[3]+3572445317&4294967295,L=z+(F<<16&4294967295|F>>>16),F=O+(L^z^C)+x[6]+76029189&4294967295,O=L+(F<<23&4294967295|F>>>9),F=C+(O^L^z)+x[9]+3654602809&4294967295,C=O+(F<<4&4294967295|F>>>28),F=z+(C^O^L)+x[12]+3873151461&4294967295,z=C+(F<<11&4294967295|F>>>21),F=L+(z^C^O)+x[15]+530742520&4294967295,L=z+(F<<16&4294967295|F>>>16),F=O+(L^z^C)+x[2]+3299628645&4294967295,O=L+(F<<23&4294967295|F>>>9),F=C+(L^(O|~z))+x[0]+4096336452&4294967295,C=O+(F<<6&4294967295|F>>>26),F=z+(O^(C|~L))+x[7]+1126891415&4294967295,z=C+(F<<10&4294967295|F>>>22),F=L+(C^(z|~O))+x[14]+2878612391&4294967295,L=z+(F<<15&4294967295|F>>>17),F=O+(z^(L|~C))+x[5]+4237533241&4294967295,O=L+(F<<21&4294967295|F>>>11),F=C+(L^(O|~z))+x[12]+1700485571&4294967295,C=O+(F<<6&4294967295|F>>>26),F=z+(O^(C|~L))+x[3]+2399980690&4294967295,z=C+(F<<10&4294967295|F>>>22),F=L+(C^(z|~O))+x[10]+4293915773&4294967295,L=z+(F<<15&4294967295|F>>>17),F=O+(z^(L|~C))+x[1]+2240044497&4294967295,O=L+(F<<21&4294967295|F>>>11),F=C+(L^(O|~z))+x[8]+1873313359&4294967295,C=O+(F<<6&4294967295|F>>>26),F=z+(O^(C|~L))+x[15]+4264355552&4294967295,z=C+(F<<10&4294967295|F>>>22),F=L+(C^(z|~O))+x[6]+2734768916&4294967295,L=z+(F<<15&4294967295|F>>>17),F=O+(z^(L|~C))+x[13]+1309151649&4294967295,O=L+(F<<21&4294967295|F>>>11),F=C+(L^(O|~z))+x[4]+4149444226&4294967295,C=O+(F<<6&4294967295|F>>>26),F=z+(O^(C|~L))+x[11]+3174756917&4294967295,z=C+(F<<10&4294967295|F>>>22),F=L+(C^(z|~O))+x[2]+718787259&4294967295,L=z+(F<<15&4294967295|F>>>17),F=O+(z^(L|~C))+x[9]+3951481745&4294967295,N.g[0]=N.g[0]+C&4294967295,N.g[1]=N.g[1]+(L+(F<<21&4294967295|F>>>11))&4294967295,N.g[2]=N.g[2]+L&4294967295,N.g[3]=N.g[3]+z&4294967295}r.prototype.u=function(N,C){C===void 0&&(C=N.length);for(var O=C-this.blockSize,x=this.B,L=this.h,z=0;z<C;){if(L==0)for(;z<=O;)i(this,N,z),z+=this.blockSize;if(typeof N=="string"){for(;z<C;)if(x[L++]=N.charCodeAt(z++),L==this.blockSize){i(this,x),L=0;break}}else for(;z<C;)if(x[L++]=N[z++],L==this.blockSize){i(this,x),L=0;break}}this.h=L,this.o+=C},r.prototype.v=function(){var N=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);N[0]=128;for(var C=1;C<N.length-8;++C)N[C]=0;var O=8*this.o;for(C=N.length-8;C<N.length;++C)N[C]=O&255,O/=256;for(this.u(N),N=Array(16),C=O=0;4>C;++C)for(var x=0;32>x;x+=8)N[O++]=this.g[C]>>>x&255;return N};function s(N,C){var O=l;return Object.prototype.hasOwnProperty.call(O,N)?O[N]:O[N]=C(N)}function o(N,C){this.h=C;for(var O=[],x=!0,L=N.length-1;0<=L;L--){var z=N[L]|0;x&&z==C||(O[L]=z,x=!1)}this.g=O}var l={};function c(N){return-128<=N&&128>N?s(N,function(C){return new o([C|0],0>C?-1:0)}):new o([N|0],0>N?-1:0)}function d(N){if(isNaN(N)||!isFinite(N))return _;if(0>N)return D(d(-N));for(var C=[],O=1,x=0;N>=O;x++)C[x]=N/O|0,O*=4294967296;return new o(C,0)}function p(N,C){if(N.length==0)throw Error("number format error: empty string");if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(N.charAt(0)=="-")return D(p(N.substring(1),C));if(0<=N.indexOf("-"))throw Error('number format error: interior "-" character');for(var O=d(Math.pow(C,8)),x=_,L=0;L<N.length;L+=8){var z=Math.min(8,N.length-L),F=parseInt(N.substring(L,L+z),C);8>z?(z=d(Math.pow(C,z)),x=x.j(z).add(d(F))):(x=x.j(O),x=x.add(d(F)))}return x}var _=c(0),m=c(1),S=c(16777216);n=o.prototype,n.m=function(){if(A(this))return-D(this).m();for(var N=0,C=1,O=0;O<this.g.length;O++){var x=this.i(O);N+=(0<=x?x:4294967296+x)*C,C*=4294967296}return N},n.toString=function(N){if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(E(this))return"0";if(A(this))return"-"+D(this).toString(N);for(var C=d(Math.pow(N,6)),O=this,x="";;){var L=P(O,C).g;O=k(O,L.j(C));var z=((0<O.g.length?O.g[0]:O.h)>>>0).toString(N);if(O=L,E(O))return z+x;for(;6>z.length;)z="0"+z;x=z+x}},n.i=function(N){return 0>N?0:N<this.g.length?this.g[N]:this.h};function E(N){if(N.h!=0)return!1;for(var C=0;C<N.g.length;C++)if(N.g[C]!=0)return!1;return!0}function A(N){return N.h==-1}n.l=function(N){return N=k(this,N),A(N)?-1:E(N)?0:1};function D(N){for(var C=N.g.length,O=[],x=0;x<C;x++)O[x]=~N.g[x];return new o(O,~N.h).add(m)}n.abs=function(){return A(this)?D(this):this},n.add=function(N){for(var C=Math.max(this.g.length,N.g.length),O=[],x=0,L=0;L<=C;L++){var z=x+(this.i(L)&65535)+(N.i(L)&65535),F=(z>>>16)+(this.i(L)>>>16)+(N.i(L)>>>16);x=F>>>16,z&=65535,F&=65535,O[L]=F<<16|z}return new o(O,O[O.length-1]&-2147483648?-1:0)};function k(N,C){return N.add(D(C))}n.j=function(N){if(E(this)||E(N))return _;if(A(this))return A(N)?D(this).j(D(N)):D(D(this).j(N));if(A(N))return D(this.j(D(N)));if(0>this.l(S)&&0>N.l(S))return d(this.m()*N.m());for(var C=this.g.length+N.g.length,O=[],x=0;x<2*C;x++)O[x]=0;for(x=0;x<this.g.length;x++)for(var L=0;L<N.g.length;L++){var z=this.i(x)>>>16,F=this.i(x)&65535,fe=N.i(L)>>>16,se=N.i(L)&65535;O[2*x+2*L]+=F*se,R(O,2*x+2*L),O[2*x+2*L+1]+=z*se,R(O,2*x+2*L+1),O[2*x+2*L+1]+=F*fe,R(O,2*x+2*L+1),O[2*x+2*L+2]+=z*fe,R(O,2*x+2*L+2)}for(x=0;x<C;x++)O[x]=O[2*x+1]<<16|O[2*x];for(x=C;x<2*C;x++)O[x]=0;return new o(O,0)};function R(N,C){for(;(N[C]&65535)!=N[C];)N[C+1]+=N[C]>>>16,N[C]&=65535,C++}function w(N,C){this.g=N,this.h=C}function P(N,C){if(E(C))throw Error("division by zero");if(E(N))return new w(_,_);if(A(N))return C=P(D(N),C),new w(D(C.g),D(C.h));if(A(C))return C=P(N,D(C)),new w(D(C.g),C.h);if(30<N.g.length){if(A(N)||A(C))throw Error("slowDivide_ only works with positive integers.");for(var O=m,x=C;0>=x.l(N);)O=V(O),x=V(x);var L=U(O,1),z=U(x,1);for(x=U(x,2),O=U(O,2);!E(x);){var F=z.add(x);0>=F.l(N)&&(L=L.add(O),z=F),x=U(x,1),O=U(O,1)}return C=k(N,L.j(C)),new w(L,C)}for(L=_;0<=N.l(C);){for(O=Math.max(1,Math.floor(N.m()/C.m())),x=Math.ceil(Math.log(O)/Math.LN2),x=48>=x?1:Math.pow(2,x-48),z=d(O),F=z.j(C);A(F)||0<F.l(N);)O-=x,z=d(O),F=z.j(C);E(z)&&(z=m),L=L.add(z),N=k(N,F)}return new w(L,N)}n.A=function(N){return P(this,N).h},n.and=function(N){for(var C=Math.max(this.g.length,N.g.length),O=[],x=0;x<C;x++)O[x]=this.i(x)&N.i(x);return new o(O,this.h&N.h)},n.or=function(N){for(var C=Math.max(this.g.length,N.g.length),O=[],x=0;x<C;x++)O[x]=this.i(x)|N.i(x);return new o(O,this.h|N.h)},n.xor=function(N){for(var C=Math.max(this.g.length,N.g.length),O=[],x=0;x<C;x++)O[x]=this.i(x)^N.i(x);return new o(O,this.h^N.h)};function V(N){for(var C=N.g.length+1,O=[],x=0;x<C;x++)O[x]=N.i(x)<<1|N.i(x-1)>>>31;return new o(O,N.h)}function U(N,C){var O=C>>5;C%=32;for(var x=N.g.length-O,L=[],z=0;z<x;z++)L[z]=0<C?N.i(z+O)>>>C|N.i(z+O+1)<<32-C:N.i(z+O);return new o(L,N.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,BP=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=p,Ya=o}).apply(typeof mC<"u"?mC:typeof self<"u"?self:typeof window<"u"?window:{});var jp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var jP,kh,GP,mg,D1,WP,HP,$P;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,v,I){return h==Array.prototype||h==Object.prototype||(h[v]=I.value),h};function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof jp=="object"&&jp];for(var v=0;v<h.length;++v){var I=h[v];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var r=t(this);function i(h,v){if(v)e:{var I=r;h=h.split(".");for(var b=0;b<h.length-1;b++){var W=h[b];if(!(W in I))break e;I=I[W]}h=h[h.length-1],b=I[h],v=v(b),v!=b&&v!=null&&e(I,h,{configurable:!0,writable:!0,value:v})}}function s(h,v){h instanceof String&&(h+="");var I=0,b=!1,W={next:function(){if(!b&&I<h.length){var q=I++;return{value:v(q,h[q]),done:!1}}return b=!0,{done:!0,value:void 0}}};return W[Symbol.iterator]=function(){return W},W}i("Array.prototype.values",function(h){return h||function(){return s(this,function(v,I){return I})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(h){var v=typeof h;return v=v!="object"?v:h?Array.isArray(h)?"array":v:"null",v=="array"||v=="object"&&typeof h.length=="number"}function d(h){var v=typeof h;return v=="object"&&h!=null||v=="function"}function p(h,v,I){return h.call.apply(h.bind,arguments)}function _(h,v,I){if(!h)throw Error();if(2<arguments.length){var b=Array.prototype.slice.call(arguments,2);return function(){var W=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(W,b),h.apply(v,W)}}return function(){return h.apply(v,arguments)}}function m(h,v,I){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:_,m.apply(null,arguments)}function S(h,v){var I=Array.prototype.slice.call(arguments,1);return function(){var b=I.slice();return b.push.apply(b,arguments),h.apply(this,b)}}function E(h,v){function I(){}I.prototype=v.prototype,h.aa=v.prototype,h.prototype=new I,h.prototype.constructor=h,h.Qb=function(b,W,q){for(var re=Array(arguments.length-2),Ye=2;Ye<arguments.length;Ye++)re[Ye-2]=arguments[Ye];return v.prototype[W].apply(b,re)}}function A(h){const v=h.length;if(0<v){const I=Array(v);for(let b=0;b<v;b++)I[b]=h[b];return I}return[]}function D(h,v){for(let I=1;I<arguments.length;I++){const b=arguments[I];if(c(b)){const W=h.length||0,q=b.length||0;h.length=W+q;for(let re=0;re<q;re++)h[W+re]=b[re]}else h.push(b)}}class k{constructor(v,I){this.i=v,this.j=I,this.h=0,this.g=null}get(){let v;return 0<this.h?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function R(h){return/^[\s\xa0]*$/.test(h)}function w(){var h=l.navigator;return h&&(h=h.userAgent)?h:""}function P(h){return P[" "](h),h}P[" "]=function(){};var V=w().indexOf("Gecko")!=-1&&!(w().toLowerCase().indexOf("webkit")!=-1&&w().indexOf("Edge")==-1)&&!(w().indexOf("Trident")!=-1||w().indexOf("MSIE")!=-1)&&w().indexOf("Edge")==-1;function U(h,v,I){for(const b in h)v.call(I,h[b],b,h)}function N(h,v){for(const I in h)v.call(void 0,h[I],I,h)}function C(h){const v={};for(const I in h)v[I]=h[I];return v}const O="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function x(h,v){let I,b;for(let W=1;W<arguments.length;W++){b=arguments[W];for(I in b)h[I]=b[I];for(let q=0;q<O.length;q++)I=O[q],Object.prototype.hasOwnProperty.call(b,I)&&(h[I]=b[I])}}function L(h){var v=1;h=h.split(":");const I=[];for(;0<v&&h.length;)I.push(h.shift()),v--;return h.length&&I.push(h.join(":")),I}function z(h){l.setTimeout(()=>{throw h},0)}function F(){var h=oe;let v=null;return h.g&&(v=h.g,h.g=h.g.next,h.g||(h.h=null),v.next=null),v}class fe{constructor(){this.h=this.g=null}add(v,I){const b=se.get();b.set(v,I),this.h?this.h.next=b:this.g=b,this.h=b}}var se=new k(()=>new ze,h=>h.reset());class ze{constructor(){this.next=this.g=this.h=null}set(v,I){this.h=v,this.g=I,this.next=null}reset(){this.next=this.g=this.h=null}}let De,Y=!1,oe=new fe,ne=()=>{const h=l.Promise.resolve(void 0);De=()=>{h.then(ae)}};var ae=()=>{for(var h;h=F();){try{h.h.call(h.g)}catch(I){z(I)}var v=se;v.j(h),100>v.h&&(v.h++,h.next=v.g,v.g=h)}Y=!1};function pe(){this.s=this.s,this.C=this.C}pe.prototype.s=!1,pe.prototype.ma=function(){this.s||(this.s=!0,this.N())},pe.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Se(h,v){this.type=h,this.g=this.target=v,this.defaultPrevented=!1}Se.prototype.h=function(){this.defaultPrevented=!0};var en=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var h=!1,v=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const I=()=>{};l.addEventListener("test",I,v),l.removeEventListener("test",I,v)}catch{}return h}();function At(h,v){if(Se.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var I=this.type=h.type,b=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=v,v=h.relatedTarget){if(V){e:{try{P(v.nodeName);var W=!0;break e}catch{}W=!1}W||(v=null)}}else I=="mouseover"?v=h.fromElement:I=="mouseout"&&(v=h.toElement);this.relatedTarget=v,b?(this.clientX=b.clientX!==void 0?b.clientX:b.pageX,this.clientY=b.clientY!==void 0?b.clientY:b.pageY,this.screenX=b.screenX||0,this.screenY=b.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:pt[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&At.aa.h.call(this)}}E(At,Se);var pt={2:"touch",3:"pen",4:"mouse"};At.prototype.h=function(){At.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var B="closure_listenable_"+(1e6*Math.random()|0),Z=0;function _e(h,v,I,b,W){this.listener=h,this.proxy=null,this.src=v,this.type=I,this.capture=!!b,this.ha=W,this.key=++Z,this.da=this.fa=!1}function Ke(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Re(h){this.src=h,this.g={},this.h=0}Re.prototype.add=function(h,v,I,b,W){var q=h.toString();h=this.g[q],h||(h=this.g[q]=[],this.h++);var re=lt(h,v,b,W);return-1<re?(v=h[re],I||(v.fa=!1)):(v=new _e(v,this.src,q,!!b,W),v.fa=I,h.push(v)),v};function ot(h,v){var I=v.type;if(I in h.g){var b=h.g[I],W=Array.prototype.indexOf.call(b,v,void 0),q;(q=0<=W)&&Array.prototype.splice.call(b,W,1),q&&(Ke(v),h.g[I].length==0&&(delete h.g[I],h.h--))}}function lt(h,v,I,b){for(var W=0;W<h.length;++W){var q=h[W];if(!q.da&&q.listener==v&&q.capture==!!I&&q.ha==b)return W}return-1}var mr="closure_lm_"+(1e6*Math.random()|0),rt={};function li(h,v,I,b,W){if(Array.isArray(v)){for(var q=0;q<v.length;q++)li(h,v[q],I,b,W);return null}return I=Tf(I),h&&h[B]?h.K(v,I,d(b)?!!b.capture:!1,W):br(h,v,I,!1,b,W)}function br(h,v,I,b,W,q){if(!v)throw Error("Invalid event type");var re=d(W)?!!W.capture:!!W,Ye=Cc(h);if(Ye||(h[mr]=Ye=new Re(h)),I=Ye.add(v,I,b,re,q),I.proxy)return I;if(b=bi(),I.proxy=b,b.src=h,b.listener=I,h.addEventListener)en||(W=re),W===void 0&&(W=!1),h.addEventListener(v.toString(),b,W);else if(h.attachEvent)h.attachEvent(Sf(v.toString()),b);else if(h.addListener&&h.removeListener)h.addListener(b);else throw Error("addEventListener and attachEvent are unavailable.");return I}function bi(){function h(I){return v.call(h.src,h.listener,I)}const v=I_;return h}function Ef(h,v,I,b,W){if(Array.isArray(v))for(var q=0;q<v.length;q++)Ef(h,v[q],I,b,W);else b=d(b)?!!b.capture:!!b,I=Tf(I),h&&h[B]?(h=h.i,v=String(v).toString(),v in h.g&&(q=h.g[v],I=lt(q,I,b,W),-1<I&&(Ke(q[I]),Array.prototype.splice.call(q,I,1),q.length==0&&(delete h.g[v],h.h--)))):h&&(h=Cc(h))&&(v=h.g[v.toString()],h=-1,v&&(h=lt(v,I,b,W)),(I=-1<h?v[h]:null)&&ls(I))}function ls(h){if(typeof h!="number"&&h&&!h.da){var v=h.src;if(v&&v[B])ot(v.i,h);else{var I=h.type,b=h.proxy;v.removeEventListener?v.removeEventListener(I,b,h.capture):v.detachEvent?v.detachEvent(Sf(I),b):v.addListener&&v.removeListener&&v.removeListener(b),(I=Cc(v))?(ot(I,h),I.h==0&&(I.src=null,v[mr]=null)):Ke(h)}}}function Sf(h){return h in rt?rt[h]:rt[h]="on"+h}function I_(h,v){if(h.da)h=!0;else{v=new At(v,this);var I=h.listener,b=h.ha||h.src;h.fa&&ls(h),h=I.call(b,v)}return h}function Cc(h){return h=h[mr],h instanceof Re?h:null}var us="__closure_events_fn_"+(1e9*Math.random()>>>0);function Tf(h){return typeof h=="function"?h:(h[us]||(h[us]=function(v){return h.handleEvent(v)}),h[us])}function dn(){pe.call(this),this.i=new Re(this),this.M=this,this.F=null}E(dn,pe),dn.prototype[B]=!0,dn.prototype.removeEventListener=function(h,v,I,b){Ef(this,h,v,I,b)};function Pn(h,v){var I,b=h.F;if(b)for(I=[];b;b=b.F)I.push(b);if(h=h.M,b=v.type||v,typeof v=="string")v=new Se(v,h);else if(v instanceof Se)v.target=v.target||h;else{var W=v;v=new Se(b,h),x(v,W)}if(W=!0,I)for(var q=I.length-1;0<=q;q--){var re=v.g=I[q];W=xl(re,b,!0,v)&&W}if(re=v.g=h,W=xl(re,b,!0,v)&&W,W=xl(re,b,!1,v)&&W,I)for(q=0;q<I.length;q++)re=v.g=I[q],W=xl(re,b,!1,v)&&W}dn.prototype.N=function(){if(dn.aa.N.call(this),this.i){var h=this.i,v;for(v in h.g){for(var I=h.g[v],b=0;b<I.length;b++)Ke(I[b]);delete h.g[v],h.h--}}this.F=null},dn.prototype.K=function(h,v,I,b){return this.i.add(String(h),v,!1,I,b)},dn.prototype.L=function(h,v,I,b){return this.i.add(String(h),v,!0,I,b)};function xl(h,v,I,b){if(v=h.i.g[String(v)],!v)return!0;v=v.concat();for(var W=!0,q=0;q<v.length;++q){var re=v[q];if(re&&!re.da&&re.capture==I){var Ye=re.listener,zt=re.ha||re.src;re.fa&&ot(h.i,re),W=Ye.call(zt,b)!==!1&&W}}return W&&!b.defaultPrevented}function Cf(h,v,I){if(typeof h=="function")I&&(h=m(h,I));else if(h&&typeof h.handleEvent=="function")h=m(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(v)?-1:l.setTimeout(h,v||0)}function If(h){h.g=Cf(()=>{h.g=null,h.i&&(h.i=!1,If(h))},h.l);const v=h.h;h.h=null,h.m.apply(null,v)}class P_ extends pe{constructor(v,I){super(),this.m=v,this.l=I,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:If(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ya(h){pe.call(this),this.h=h,this.g={}}E(ya,pe);var Pf=[];function Rf(h){U(h.g,function(v,I){this.g.hasOwnProperty(I)&&ls(v)},h),h.g={}}ya.prototype.N=function(){ya.aa.N.call(this),Rf(this)},ya.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ic=l.JSON.stringify,R_=l.JSON.parse,kf=class{stringify(h){return l.JSON.stringify(h,void 0)}parse(h){return l.JSON.parse(h,void 0)}};function Pc(){}Pc.prototype.h=null;function Af(h){return h.h||(h.h=h.i())}function xf(){}var va={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Rc(){Se.call(this,"d")}E(Rc,Se);function kc(){Se.call(this,"c")}E(kc,Se);var Mi={},Ac=null;function Nl(){return Ac=Ac||new dn}Mi.La="serverreachability";function Dl(h){Se.call(this,Mi.La,h)}E(Dl,Se);function io(h){const v=Nl();Pn(v,new Dl(v))}Mi.STAT_EVENT="statevent";function xc(h,v){Se.call(this,Mi.STAT_EVENT,h),this.stat=v}E(xc,Se);function Rn(h){const v=Nl();Pn(v,new xc(v,h))}Mi.Ma="timingevent";function Nf(h,v){Se.call(this,Mi.Ma,h),this.size=v}E(Nf,Se);function wa(h,v){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){h()},v)}function so(){this.g=!0}so.prototype.xa=function(){this.g=!1};function Nc(h,v,I,b,W,q){h.info(function(){if(h.g)if(q)for(var re="",Ye=q.split("&"),zt=0;zt<Ye.length;zt++){var je=Ye[zt].split("=");if(1<je.length){var nn=je[0];je=je[1];var qt=nn.split("_");re=2<=qt.length&&qt[1]=="type"?re+(nn+"="+je+"&"):re+(nn+"=redacted&")}}else re=null;else re=q;return"XMLHTTP REQ ("+b+") [attempt "+W+"]: "+v+`
`+I+`
`+re})}function k_(h,v,I,b,W,q,re){h.info(function(){return"XMLHTTP RESP ("+b+") [ attempt "+W+"]: "+v+`
`+I+`
`+q+" "+re})}function oo(h,v,I,b){h.info(function(){return"XMLHTTP TEXT ("+v+"): "+A_(h,I)+(b?" "+b:"")})}function Ol(h,v){h.info(function(){return"TIMEOUT: "+v})}so.prototype.info=function(){};function A_(h,v){if(!h.g)return v;if(!v)return null;try{var I=JSON.parse(v);if(I){for(h=0;h<I.length;h++)if(Array.isArray(I[h])){var b=I[h];if(!(2>b.length)){var W=b[1];if(Array.isArray(W)&&!(1>W.length)){var q=W[0];if(q!="noop"&&q!="stop"&&q!="close")for(var re=1;re<W.length;re++)W[re]=""}}}}return Ic(I)}catch{return v}}var bl={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Df={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Dc;function Ml(){}E(Ml,Pc),Ml.prototype.g=function(){return new XMLHttpRequest},Ml.prototype.i=function(){return{}},Dc=new Ml;function Li(h,v,I,b){this.j=h,this.i=v,this.l=I,this.R=b||1,this.U=new ya(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Of}function Of(){this.i=null,this.g="",this.h=!1}var bf={},Oc={};function bc(h,v,I){h.L=1,h.v=Vl(_r(v)),h.m=I,h.P=!0,Mf(h,null)}function Mf(h,v){h.F=Date.now(),Ll(h),h.A=_r(h.v);var I=h.A,b=h.R;Array.isArray(b)||(b=[String(b)]),$e(I.i,"t",b),h.C=0,I=h.j.J,h.h=new Of,h.g=Wc(h.j,I?v:null,!h.m),0<h.O&&(h.M=new P_(m(h.Y,h,h.g),h.O)),v=h.U,I=h.g,b=h.ca;var W="readystatechange";Array.isArray(W)||(W&&(Pf[0]=W.toString()),W=Pf);for(var q=0;q<W.length;q++){var re=li(I,W[q],b||v.handleEvent,!1,v.h||v);if(!re)break;v.g[re.key]=re}v=h.H?C(h.H):{},h.m?(h.u||(h.u="POST"),v["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,v)):(h.u="GET",h.g.ea(h.A,h.u,null,v)),io(),Nc(h.i,h.u,h.A,h.l,h.R,h.m)}Li.prototype.ca=function(h){h=h.target;const v=this.M;v&&Gn(h)==3?v.j():this.Y(h)},Li.prototype.Y=function(h){try{if(h==this.g)e:{const qt=Gn(this.g);var v=this.g.Ba();const ji=this.g.Z();if(!(3>qt)&&(qt!=3||this.g&&(this.h.h||this.g.oa()||Ia(this.g)))){this.J||qt!=4||v==7||(v==8||0>=ji?io(3):io(2)),cs(this);var I=this.g.Z();this.X=I;t:if(Lf(this)){var b=Ia(this.g);h="";var W=b.length,q=Gn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ui(this),hs(this);var re="";break t}this.h.i=new l.TextDecoder}for(v=0;v<W;v++)this.h.h=!0,h+=this.h.i.decode(b[v],{stream:!(q&&v==W-1)});b.length=0,this.h.g+=h,this.C=0,re=this.h.g}else re=this.g.oa();if(this.o=I==200,k_(this.i,this.u,this.A,this.l,this.R,qt,I),this.o){if(this.T&&!this.K){t:{if(this.g){var Ye,zt=this.g;if((Ye=zt.g?zt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!R(Ye)){var je=Ye;break t}}je=null}if(I=je)oo(this.i,this.l,I,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Mc(this,I);else{this.o=!1,this.s=3,Rn(12),ui(this),hs(this);break e}}if(this.P){I=!0;let pn;for(;!this.J&&this.C<re.length;)if(pn=x_(this,re),pn==Oc){qt==4&&(this.s=4,Rn(14),I=!1),oo(this.i,this.l,null,"[Incomplete Response]");break}else if(pn==bf){this.s=4,Rn(15),oo(this.i,this.l,re,"[Invalid Chunk]"),I=!1;break}else oo(this.i,this.l,pn,null),Mc(this,pn);if(Lf(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),qt!=4||re.length!=0||this.h.h||(this.s=1,Rn(16),I=!1),this.o=this.o&&I,!I)oo(this.i,this.l,re,"[Invalid Chunked Response]"),ui(this),hs(this);else if(0<re.length&&!this.W){this.W=!0;var nn=this.j;nn.g==this&&nn.ba&&!nn.M&&(nn.j.info("Great, no buffering proxy detected. Bytes received: "+re.length),ys(nn),nn.M=!0,Rn(11))}}else oo(this.i,this.l,re,null),Mc(this,re);qt==4&&ui(this),this.o&&!this.J&&(qt==4?jc(this.j,this):(this.o=!1,Ll(this)))}else Gl(this.g),I==400&&0<re.indexOf("Unknown SID")?(this.s=3,Rn(12)):(this.s=0,Rn(13)),ui(this),hs(this)}}}catch{}finally{}};function Lf(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function x_(h,v){var I=h.C,b=v.indexOf(`
`,I);return b==-1?Oc:(I=Number(v.substring(I,b)),isNaN(I)?bf:(b+=1,b+I>v.length?Oc:(v=v.slice(b,b+I),h.C=b+I,v)))}Li.prototype.cancel=function(){this.J=!0,ui(this)};function Ll(h){h.S=Date.now()+h.I,Fl(h,h.I)}function Fl(h,v){if(h.B!=null)throw Error("WatchDog timer not null");h.B=wa(m(h.ba,h),v)}function cs(h){h.B&&(l.clearTimeout(h.B),h.B=null)}Li.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(Ol(this.i,this.A),this.L!=2&&(io(),Rn(17)),ui(this),this.s=2,hs(this)):Fl(this,this.S-h)};function hs(h){h.j.G==0||h.J||jc(h.j,h)}function ui(h){cs(h);var v=h.M;v&&typeof v.ma=="function"&&v.ma(),h.M=null,Rf(h.U),h.g&&(v=h.g,h.g=null,v.abort(),v.ma())}function Mc(h,v){try{var I=h.j;if(I.G!=0&&(I.g==h||at(I.h,h))){if(!h.K&&at(I.h,h)&&I.G==3){try{var b=I.Da.g.parse(v)}catch{b=null}if(Array.isArray(b)&&b.length==3){var W=b;if(W[0]==0){e:if(!I.u){if(I.g)if(I.g.F+3e3<h.F)Pa(I),vr(I);else break e;dt(I),Rn(18)}}else I.za=W[1],0<I.za-I.T&&37500>W[2]&&I.F&&I.v==0&&!I.C&&(I.C=wa(m(I.Za,I),6e3));if(1>=ht(I.h)&&I.ca){try{I.ca()}catch{}I.ca=void 0}}else fi(I,11)}else if((h.K||I.g==h)&&Pa(I),!R(v))for(W=I.Da.g.parse(v),v=0;v<W.length;v++){let je=W[v];if(I.T=je[0],je=je[1],I.G==2)if(je[0]=="c"){I.K=je[1],I.ia=je[2];const nn=je[3];nn!=null&&(I.la=nn,I.j.info("VER="+I.la));const qt=je[4];qt!=null&&(I.Aa=qt,I.j.info("SVER="+I.Aa));const ji=je[5];ji!=null&&typeof ji=="number"&&0<ji&&(b=1.5*ji,I.L=b,I.j.info("backChannelRequestTimeoutMs_="+b)),b=I;const pn=h.g;if(pn){const xn=pn.g?pn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(xn){var q=b.h;q.g||xn.indexOf("spdy")==-1&&xn.indexOf("quic")==-1&&xn.indexOf("h2")==-1||(q.j=q.l,q.g=new Set,q.h&&(Wr(q,q.h),q.h=null))}if(b.D){const pi=pn.g?pn.g.getResponseHeader("X-HTTP-Session-Id"):null;pi&&(b.ya=pi,gt(b.I,b.D,pi))}}I.G=3,I.l&&I.l.ua(),I.ba&&(I.R=Date.now()-h.F,I.j.info("Handshake RTT: "+I.R+"ms")),b=I;var re=h;if(b.qa=Ra(b,b.J?b.ia:null,b.W),re.K){tn(b.h,re);var Ye=re,zt=b.L;zt&&(Ye.I=zt),Ye.B&&(cs(Ye),Ll(Ye)),b.g=re}else lr(b);0<I.i.length&&$r(I)}else je[0]!="stop"&&je[0]!="close"||fi(I,7);else I.G==3&&(je[0]=="stop"||je[0]=="close"?je[0]=="stop"?fi(I,7):di(I):je[0]!="noop"&&I.l&&I.l.ta(je),I.v=0)}}io(4)}catch{}}var Lc=class{constructor(h,v){this.g=h,this.map=v}};function ds(h){this.l=h||10,l.PerformanceNavigationTiming?(h=l.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ci(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function ht(h){return h.h?1:h.g?h.g.size:0}function at(h,v){return h.h?h.h==v:h.g?h.g.has(v):!1}function Wr(h,v){h.g?h.g.add(v):h.h=v}function tn(h,v){h.h&&h.h==v?h.h=null:h.g&&h.g.has(v)&&h.g.delete(v)}ds.prototype.cancel=function(){if(this.i=kn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function kn(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let v=h.i;for(const I of h.g.values())v=v.concat(I.D);return v}return A(h.i)}function fs(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(c(h)){for(var v=[],I=h.length,b=0;b<I;b++)v.push(h[b]);return v}v=[],I=0;for(b in h)v[I++]=h[b];return v}function ao(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(c(h)||typeof h=="string"){var v=[];h=h.length;for(var I=0;I<h;I++)v.push(I);return v}v=[],I=0;for(const b in h)v[I++]=b;return v}}}function An(h,v){if(h.forEach&&typeof h.forEach=="function")h.forEach(v,void 0);else if(c(h)||typeof h=="string")Array.prototype.forEach.call(h,v,void 0);else for(var I=ao(h),b=fs(h),W=b.length,q=0;q<W;q++)v.call(void 0,b[q],I&&I[q],h)}var Ea=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ff(h,v){if(h){h=h.split("&");for(var I=0;I<h.length;I++){var b=h[I].indexOf("="),W=null;if(0<=b){var q=h[I].substring(0,b);W=h[I].substring(b+1)}else q=h[I];v(q,W?decodeURIComponent(W.replace(/\+/g," ")):"")}}}function Fi(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof Fi){this.h=h.h,Sa(this,h.j),this.o=h.o,this.g=h.g,Bn(this,h.s),this.l=h.l;var v=h.i,I=new ps;I.i=v.i,v.g&&(I.g=new Map(v.g),I.h=v.h),Vf(this,I),this.m=h.m}else h&&(v=String(h).match(Ea))?(this.h=!1,Sa(this,v[1]||"",!0),this.o=Vi(v[2]||""),this.g=Vi(v[3]||"",!0),Bn(this,v[4]),this.l=Vi(v[5]||"",!0),Vf(this,v[6]||"",!0),this.m=Vi(v[7]||"")):(this.h=!1,this.i=new ps(null,this.h))}Fi.prototype.toString=function(){var h=[],v=this.j;v&&h.push(Ui(v,Ca,!0),":");var I=this.g;return(I||v=="file")&&(h.push("//"),(v=this.o)&&h.push(Ui(v,Ca,!0),"@"),h.push(encodeURIComponent(String(I)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),I=this.s,I!=null&&h.push(":",String(I))),(I=this.l)&&(this.g&&I.charAt(0)!="/"&&h.push("/"),h.push(Ui(I,I.charAt(0)=="/"?D_:N_,!0))),(I=this.i.toString())&&h.push("?",I),(I=this.m)&&h.push("#",Ui(I,Uf)),h.join("")};function _r(h){return new Fi(h)}function Sa(h,v,I){h.j=I?Vi(v,!0):v,h.j&&(h.j=h.j.replace(/:$/,""))}function Bn(h,v){if(v){if(v=Number(v),isNaN(v)||0>v)throw Error("Bad port number "+v);h.s=v}else h.s=null}function Vf(h,v,I){v instanceof ps?(h.i=v,Vc(h.i,h.h)):(I||(v=Ui(v,Fc)),h.i=new ps(v,h.h))}function gt(h,v,I){h.i.set(v,I)}function Vl(h){return gt(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function Vi(h,v){return h?v?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Ui(h,v,I){return typeof h=="string"?(h=encodeURI(h).replace(v,Ta),I&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Ta(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Ca=/[#\/\?@]/g,N_=/[#\?:]/g,D_=/[#\?]/g,Fc=/[#\?@]/g,Uf=/#/g;function ps(h,v){this.h=this.g=null,this.i=h||null,this.j=!!v}function yr(h){h.g||(h.g=new Map,h.h=0,h.i&&Ff(h.i,function(v,I){h.add(decodeURIComponent(v.replace(/\+/g," ")),I)}))}n=ps.prototype,n.add=function(h,v){yr(this),this.i=null,h=gs(this,h);var I=this.g.get(h);return I||this.g.set(h,I=[]),I.push(v),this.h+=1,this};function zf(h,v){yr(h),v=gs(h,v),h.g.has(v)&&(h.i=null,h.h-=h.g.get(v).length,h.g.delete(v))}function Ul(h,v){return yr(h),v=gs(h,v),h.g.has(v)}n.forEach=function(h,v){yr(this),this.g.forEach(function(I,b){I.forEach(function(W){h.call(v,W,b,this)},this)},this)},n.na=function(){yr(this);const h=Array.from(this.g.values()),v=Array.from(this.g.keys()),I=[];for(let b=0;b<v.length;b++){const W=h[b];for(let q=0;q<W.length;q++)I.push(v[b])}return I},n.V=function(h){yr(this);let v=[];if(typeof h=="string")Ul(this,h)&&(v=v.concat(this.g.get(gs(this,h))));else{h=Array.from(this.g.values());for(let I=0;I<h.length;I++)v=v.concat(h[I])}return v},n.set=function(h,v){return yr(this),this.i=null,h=gs(this,h),Ul(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[v]),this.h+=1,this},n.get=function(h,v){return h?(h=this.V(h),0<h.length?String(h[0]):v):v};function $e(h,v,I){zf(h,v),0<I.length&&(h.i=null,h.g.set(gs(h,v),A(I)),h.h+=I.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],v=Array.from(this.g.keys());for(var I=0;I<v.length;I++){var b=v[I];const q=encodeURIComponent(String(b)),re=this.V(b);for(b=0;b<re.length;b++){var W=q;re[b]!==""&&(W+="="+encodeURIComponent(String(re[b]))),h.push(W)}}return this.i=h.join("&")};function gs(h,v){return v=String(v),h.j&&(v=v.toLowerCase()),v}function Vc(h,v){v&&!h.j&&(yr(h),h.i=null,h.g.forEach(function(I,b){var W=b.toLowerCase();b!=W&&(zf(this,b),$e(this,W,I))},h)),h.j=v}function Bf(h,v){const I=new so;if(l.Image){const b=new Image;b.onload=S(zi,I,"TestLoadImage: loaded",!0,v,b),b.onerror=S(zi,I,"TestLoadImage: error",!1,v,b),b.onabort=S(zi,I,"TestLoadImage: abort",!1,v,b),b.ontimeout=S(zi,I,"TestLoadImage: timeout",!1,v,b),l.setTimeout(function(){b.ontimeout&&b.ontimeout()},1e4),b.src=h}else v(!1)}function O_(h,v){const I=new so,b=new AbortController,W=setTimeout(()=>{b.abort(),zi(I,"TestPingServer: timeout",!1,v)},1e4);fetch(h,{signal:b.signal}).then(q=>{clearTimeout(W),q.ok?zi(I,"TestPingServer: ok",!0,v):zi(I,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(W),zi(I,"TestPingServer: error",!1,v)})}function zi(h,v,I,b,W){try{W&&(W.onload=null,W.onerror=null,W.onabort=null,W.ontimeout=null),b(I)}catch{}}function $t(){this.g=new kf}function Uc(h,v,I){const b=I||"";try{An(h,function(W,q){let re=W;d(W)&&(re=Ic(W)),v.push(b+q+"="+encodeURIComponent(re))})}catch(W){throw v.push(b+"type="+encodeURIComponent("_badmap")),W}}function zl(h){this.l=h.Ub||null,this.j=h.eb||!1}E(zl,Pc),zl.prototype.g=function(){return new lo(this.l,this.j)},zl.prototype.i=function(h){return function(){return h}}({});function lo(h,v){dn.call(this),this.D=h,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}E(lo,dn),n=lo.prototype,n.open=function(h,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=v,this.readyState=1,jn(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const v={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(v.body=h),(this.D||l).fetch(new Request(this.A,v)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Bi(this)),this.readyState=0},n.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,jn(this)),this.g&&(this.readyState=3,jn(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;jf(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function jf(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}n.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var v=h.value?h.value:new Uint8Array(0);(v=this.v.decode(v,{stream:!h.done}))&&(this.response=this.responseText+=v)}h.done?Bi(this):jn(this),this.readyState==3&&jf(this)}},n.Ra=function(h){this.g&&(this.response=this.responseText=h,Bi(this))},n.Qa=function(h){this.g&&(this.response=h,Bi(this))},n.ga=function(){this.g&&Bi(this)};function Bi(h){h.readyState=4,h.l=null,h.j=null,h.v=null,jn(h)}n.setRequestHeader=function(h,v){this.u.append(h,v)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],v=this.h.entries();for(var I=v.next();!I.done;)I=I.value,h.push(I[0]+": "+I[1]),I=v.next();return h.join(`\r
`)};function jn(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(lo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Gf(h){let v="";return U(h,function(I,b){v+=b,v+=":",v+=I,v+=`\r
`}),v}function zc(h,v,I){e:{for(b in I){var b=!1;break e}b=!0}b||(I=Gf(I),typeof h=="string"?I!=null&&encodeURIComponent(String(I)):gt(h,v,I))}function Qe(h){dn.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}E(Qe,dn);var hi=/^https?$/i,Bl=["POST","PUT"];n=Qe.prototype,n.Ha=function(h){this.J=h},n.ea=function(h,v,I,b){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);v=v?v.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Dc.g(),this.v=this.o?Af(this.o):Af(Dc),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(v,String(h),!0),this.B=!1}catch(q){jl(this,q);return}if(h=I||"",I=new Map(this.headers),b)if(Object.getPrototypeOf(b)===Object.prototype)for(var W in b)I.set(W,b[W]);else if(typeof b.keys=="function"&&typeof b.get=="function")for(const q of b.keys())I.set(q,b.get(q));else throw Error("Unknown input type for opt_headers: "+String(b));b=Array.from(I.keys()).find(q=>q.toLowerCase()=="content-type"),W=l.FormData&&h instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Bl,v,void 0))||b||W||I.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[q,re]of I)this.g.setRequestHeader(q,re);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ms(this),this.u=!0,this.g.send(h),this.u=!1}catch(q){jl(this,q)}};function jl(h,v){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=v,h.m=5,Bc(h),or(h)}function Bc(h){h.A||(h.A=!0,Pn(h,"complete"),Pn(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,Pn(this,"complete"),Pn(this,"abort"),or(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),or(this,!0)),Qe.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Wf(this):this.bb())},n.bb=function(){Wf(this)};function Wf(h){if(h.h&&typeof o<"u"&&(!h.v[1]||Gn(h)!=4||h.Z()!=2)){if(h.u&&Gn(h)==4)Cf(h.Ea,0,h);else if(Pn(h,"readystatechange"),Gn(h)==4){h.h=!1;try{const re=h.Z();e:switch(re){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var I;if(!(I=v)){var b;if(b=re===0){var W=String(h.D).match(Ea)[1]||null;!W&&l.self&&l.self.location&&(W=l.self.location.protocol.slice(0,-1)),b=!hi.test(W?W.toLowerCase():"")}I=b}if(I)Pn(h,"complete"),Pn(h,"success");else{h.m=6;try{var q=2<Gn(h)?h.g.statusText:""}catch{q=""}h.l=q+" ["+h.Z()+"]",Bc(h)}}finally{or(h)}}}}function or(h,v){if(h.g){ms(h);const I=h.g,b=h.v[0]?()=>{}:null;h.g=null,h.v=null,v||Pn(h,"ready");try{I.onreadystatechange=b}catch{}}}function ms(h){h.I&&(l.clearTimeout(h.I),h.I=null)}n.isActive=function(){return!!this.g};function Gn(h){return h.g?h.g.readyState:0}n.Z=function(){try{return 2<Gn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(h){if(this.g){var v=this.g.responseText;return h&&v.indexOf(h)==0&&(v=v.substring(h.length)),R_(v)}};function Ia(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function Gl(h){const v={};h=(h.g&&2<=Gn(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let b=0;b<h.length;b++){if(R(h[b]))continue;var I=L(h[b]);const W=I[0];if(I=I[1],typeof I!="string")continue;I=I.trim();const q=v[W]||[];v[W]=q,q.push(I)}N(v,function(b){return b.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function fn(h,v,I){return I&&I.internalChannelParams&&I.internalChannelParams[h]||v}function ar(h){this.Aa=0,this.i=[],this.j=new so,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=fn("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=fn("baseRetryDelayMs",5e3,h),this.cb=fn("retryDelaySeedMs",1e4,h),this.Wa=fn("forwardChannelMaxRetries",2,h),this.wa=fn("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new ds(h&&h.concurrentRequestLimit),this.Da=new $t,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=ar.prototype,n.la=8,n.G=1,n.connect=function(h,v,I,b){Rn(0),this.W=h,this.H=v||{},I&&b!==void 0&&(this.H.OSID=I,this.H.OAID=b),this.F=this.X,this.I=Ra(this,null,this.W),$r(this)};function di(h){if(Hr(h),h.G==3){var v=h.U++,I=_r(h.I);if(gt(I,"SID",h.K),gt(I,"RID",v),gt(I,"TYPE","terminate"),_s(h,I),v=new Li(h,h.j,v),v.L=2,v.v=Vl(_r(I)),I=!1,l.navigator&&l.navigator.sendBeacon)try{I=l.navigator.sendBeacon(v.v.toString(),"")}catch{}!I&&l.Image&&(new Image().src=v.v,I=!0),I||(v.g=Wc(v.j,null),v.g.ea(v.v)),v.F=Date.now(),Ll(v)}Gc(h)}function vr(h){h.g&&(ys(h),h.g.cancel(),h.g=null)}function Hr(h){vr(h),h.u&&(l.clearTimeout(h.u),h.u=null),Pa(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&l.clearTimeout(h.s),h.s=null)}function $r(h){if(!ci(h.h)&&!h.s){h.s=!0;var v=h.Ga;De||ne(),Y||(De(),Y=!0),oe.add(v,h),h.B=0}}function Hf(h,v){return ht(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=v.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=wa(m(h.Ga,h,v),Hl(h,h.B)),h.B++,!0)}n.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const W=new Li(this,this.j,h);let q=this.o;if(this.S&&(q?(q=C(q),x(q,this.S)):q=this.S),this.m!==null||this.O||(W.H=q,q=null),this.P)e:{for(var v=0,I=0;I<this.i.length;I++){t:{var b=this.i[I];if("__data__"in b.map&&(b=b.map.__data__,typeof b=="string")){b=b.length;break t}b=void 0}if(b===void 0)break;if(v+=b,4096<v){v=I;break e}if(v===4096||I===this.i.length-1){v=I+1;break e}}v=1e3}else v=1e3;v=Wn(this,W,v),I=_r(this.I),gt(I,"RID",h),gt(I,"CVER",22),this.D&&gt(I,"X-HTTP-Session-Id",this.D),_s(this,I),q&&(this.O?v="headers="+encodeURIComponent(String(Gf(q)))+"&"+v:this.m&&zc(I,this.m,q)),Wr(this.h,W),this.Ua&&gt(I,"TYPE","init"),this.P?(gt(I,"$req",v),gt(I,"SID","null"),W.T=!0,bc(W,I,null)):bc(W,I,v),this.G=2}}else this.G==3&&(h?Wl(this,h):this.i.length==0||ci(this.h)||Wl(this))};function Wl(h,v){var I;v?I=v.l:I=h.U++;const b=_r(h.I);gt(b,"SID",h.K),gt(b,"RID",I),gt(b,"AID",h.T),_s(h,b),h.m&&h.o&&zc(b,h.m,h.o),I=new Li(h,h.j,I,h.B+1),h.m===null&&(I.H=h.o),v&&(h.i=v.D.concat(h.i)),v=Wn(h,I,1e3),I.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),Wr(h.h,I),bc(I,b,v)}function _s(h,v){h.H&&U(h.H,function(I,b){gt(v,b,I)}),h.l&&An({},function(I,b){gt(v,b,I)})}function Wn(h,v,I){I=Math.min(h.i.length,I);var b=h.l?m(h.l.Na,h.l,h):null;e:{var W=h.i;let q=-1;for(;;){const re=["count="+I];q==-1?0<I?(q=W[0].g,re.push("ofs="+q)):q=0:re.push("ofs="+q);let Ye=!0;for(let zt=0;zt<I;zt++){let je=W[zt].g;const nn=W[zt].map;if(je-=q,0>je)q=Math.max(0,W[zt].g-100),Ye=!1;else try{Uc(nn,re,"req"+je+"_")}catch{b&&b(nn)}}if(Ye){b=re.join("&");break e}}}return h=h.i.splice(0,I),v.D=h,b}function lr(h){if(!h.g&&!h.u){h.Y=1;var v=h.Fa;De||ne(),Y||(De(),Y=!0),oe.add(v,h),h.v=0}}function dt(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=wa(m(h.Fa,h),Hl(h,h.v)),h.v++,!0)}n.Fa=function(){if(this.u=null,wr(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=wa(m(this.ab,this),h)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Rn(10),vr(this),wr(this))};function ys(h){h.A!=null&&(l.clearTimeout(h.A),h.A=null)}function wr(h){h.g=new Li(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var v=_r(h.qa);gt(v,"RID","rpc"),gt(v,"SID",h.K),gt(v,"AID",h.T),gt(v,"CI",h.F?"0":"1"),!h.F&&h.ja&&gt(v,"TO",h.ja),gt(v,"TYPE","xmlhttp"),_s(h,v),h.m&&h.o&&zc(v,h.m,h.o),h.L&&(h.g.I=h.L);var I=h.g;h=h.ia,I.L=1,I.v=Vl(_r(v)),I.m=null,I.P=!0,Mf(I,h)}n.Za=function(){this.C!=null&&(this.C=null,vr(this),dt(this),Rn(19))};function Pa(h){h.C!=null&&(l.clearTimeout(h.C),h.C=null)}function jc(h,v){var I=null;if(h.g==v){Pa(h),ys(h),h.g=null;var b=2}else if(at(h.h,v))I=v.D,tn(h.h,v),b=1;else return;if(h.G!=0){if(v.o)if(b==1){I=v.m?v.m.length:0,v=Date.now()-v.F;var W=h.B;b=Nl(),Pn(b,new Nf(b,I)),$r(h)}else lr(h);else if(W=v.s,W==3||W==0&&0<v.X||!(b==1&&Hf(h,v)||b==2&&dt(h)))switch(I&&0<I.length&&(v=h.h,v.i=v.i.concat(I)),W){case 1:fi(h,5);break;case 4:fi(h,10);break;case 3:fi(h,6);break;default:fi(h,2)}}}function Hl(h,v){let I=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(I*=2),I*v}function fi(h,v){if(h.j.info("Error code "+v),v==2){var I=m(h.fb,h),b=h.Xa;const W=!b;b=new Fi(b||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Sa(b,"https"),Vl(b),W?Bf(b.toString(),I):O_(b.toString(),I)}else Rn(2);h.G=0,h.l&&h.l.sa(v),Gc(h),Hr(h)}n.fb=function(h){h?(this.j.info("Successfully pinged google.com"),Rn(2)):(this.j.info("Failed to ping google.com"),Rn(1))};function Gc(h){if(h.G=0,h.ka=[],h.l){const v=kn(h.h);(v.length!=0||h.i.length!=0)&&(D(h.ka,v),D(h.ka,h.i),h.h.i.length=0,A(h.i),h.i.length=0),h.l.ra()}}function Ra(h,v,I){var b=I instanceof Fi?_r(I):new Fi(I);if(b.g!="")v&&(b.g=v+"."+b.g),Bn(b,b.s);else{var W=l.location;b=W.protocol,v=v?v+"."+W.hostname:W.hostname,W=+W.port;var q=new Fi(null);b&&Sa(q,b),v&&(q.g=v),W&&Bn(q,W),I&&(q.l=I),b=q}return I=h.D,v=h.ya,I&&v&&gt(b,I,v),gt(b,"VER",h.la),_s(h,b),b}function Wc(h,v,I){if(v&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return v=h.Ca&&!h.pa?new Qe(new zl({eb:I})):new Qe(h.pa),v.Ha(h.J),v}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function vs(){}n=vs.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function uo(){}uo.prototype.g=function(h,v){return new ur(h,v)};function ur(h,v){dn.call(this),this.g=new ar(v),this.l=h,this.h=v&&v.messageUrlParams||null,h=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(h?h["X-WebChannel-Content-Type"]=v.messageContentType:h={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.va&&(h?h["X-WebChannel-Client-Profile"]=v.va:h={"X-WebChannel-Client-Profile":v.va}),this.g.S=h,(h=v&&v.Sb)&&!R(h)&&(this.g.m=h),this.v=v&&v.supportsCrossDomainXhr||!1,this.u=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!R(v)&&(this.g.D=v,h=this.h,h!==null&&v in h&&(h=this.h,v in h&&delete h[v])),this.j=new qr(this)}E(ur,dn),ur.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ur.prototype.close=function(){di(this.g)},ur.prototype.o=function(h){var v=this.g;if(typeof h=="string"){var I={};I.__data__=h,h=I}else this.u&&(I={},I.__data__=Ic(h),h=I);v.i.push(new Lc(v.Ya++,h)),v.G==3&&$r(v)},ur.prototype.N=function(){this.g.l=null,delete this.j,di(this.g),delete this.g,ur.aa.N.call(this)};function ka(h){Rc.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var v=h.__sm__;if(v){e:{for(const I in v){h=I;break e}h=void 0}(this.i=h)&&(h=this.i,v=v!==null&&h in v?v[h]:void 0),this.data=v}else this.data=h}E(ka,Rc);function $f(){kc.call(this),this.status=1}E($f,kc);function qr(h){this.g=h}E(qr,vs),qr.prototype.ua=function(){Pn(this.g,"a")},qr.prototype.ta=function(h){Pn(this.g,new ka(h))},qr.prototype.sa=function(h){Pn(this.g,new $f)},qr.prototype.ra=function(){Pn(this.g,"b")},uo.prototype.createWebChannel=uo.prototype.g,ur.prototype.send=ur.prototype.o,ur.prototype.open=ur.prototype.m,ur.prototype.close=ur.prototype.close,$P=function(){return new uo},HP=function(){return Nl()},WP=Mi,D1={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},bl.NO_ERROR=0,bl.TIMEOUT=8,bl.HTTP_ERROR=6,mg=bl,Df.COMPLETE="complete",GP=Df,xf.EventType=va,va.OPEN="a",va.CLOSE="b",va.ERROR="c",va.MESSAGE="d",dn.prototype.listen=dn.prototype.K,kh=xf,Qe.prototype.listenOnce=Qe.prototype.L,Qe.prototype.getLastError=Qe.prototype.Ka,Qe.prototype.getLastErrorCode=Qe.prototype.Ba,Qe.prototype.getStatus=Qe.prototype.Z,Qe.prototype.getResponseJson=Qe.prototype.Oa,Qe.prototype.getResponseText=Qe.prototype.oa,Qe.prototype.send=Qe.prototype.ea,Qe.prototype.setWithCredentials=Qe.prototype.Ha,jP=Qe}).apply(typeof jp<"u"?jp:typeof self<"u"?self:typeof window<"u"?window:{});const _C="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Jn.UNAUTHENTICATED=new Jn(null),Jn.GOOGLE_CREDENTIALS=new Jn("google-credentials-uid"),Jn.FIRST_PARTY=new Jn("first-party-uid"),Jn.MOCK_USER=new Jn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cc="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sl=new Jm("@firebase/firestore");function fh(){return sl.logLevel}function me(n,...e){if(sl.logLevel<=We.DEBUG){const t=e.map(Aw);sl.debug(`Firestore (${cc}): ${n}`,...t)}}function Ks(n,...e){if(sl.logLevel<=We.ERROR){const t=e.map(Aw);sl.error(`Firestore (${cc}): ${n}`,...t)}}function Gu(n,...e){if(sl.logLevel<=We.WARN){const t=e.map(Aw);sl.warn(`Firestore (${cc}): ${n}`,...t)}}function Aw(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function we(n="Unexpected state"){const e=`FIRESTORE (${cc}) INTERNAL ASSERTION FAILED: `+n;throw Ks(e),new Error(e)}function Ze(n,e){n||we()}function ke(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ue extends Zs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Us{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qP{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class vb{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Jn.UNAUTHENTICATED))}shutdown(){}}class wb{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Eb{constructor(e){this.t=e,this.currentUser=Jn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ze(this.o===void 0);let r=this.i;const i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve();let s=new Us;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Us,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},l=c=>{me("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(me("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Us)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(me("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ze(typeof r.accessToken=="string"),new qP(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ze(e===null||typeof e=="string"),new Jn(e)}}class Sb{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Jn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Tb{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new Sb(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Jn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Cb{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Ib{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Ze(this.o===void 0);const r=s=>{s.error!=null&&me("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,me("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{me("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):me("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ze(typeof t.token=="string"),this.R=t.token,new Cb(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pb(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KP{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=Pb(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}}function nt(n,e){return n<e?-1:n>e?1:0}function Wu(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ue(X.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ue(X.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new ue(X.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ue(X.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return un.fromMillis(Date.now())}static fromDate(e){return un.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new un(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?nt(this.nanoseconds,e.nanoseconds):nt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Te(e)}static min(){return new Te(new un(0,0))}static max(){return new Te(new un(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ed{constructor(e,t,r){t===void 0?t=0:t>e.length&&we(),r===void 0?r=e.length-t:r>e.length-t&&we(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Ed.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ed?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class yt extends Ed{construct(e,t,r){return new yt(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new ue(X.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new yt(t)}static emptyPath(){return new yt([])}}const Rb=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ln extends Ed{construct(e,t,r){return new Ln(e,t,r)}static isValidIdentifier(e){return Rb.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ln.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Ln(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new ue(X.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new ue(X.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new ue(X.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else l==="`"?(o=!o,i++):l!=="."||o?(r+=l,i++):(s(),i++)}if(s(),o)throw new ue(X.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ln(t)}static emptyPath(){return new Ln([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ye{constructor(e){this.path=e}static fromPath(e){return new ye(yt.fromString(e))}static fromName(e){return new ye(yt.fromString(e).popFirst(5))}static empty(){return new ye(yt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&yt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return yt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ye(new yt(e.slice()))}}function kb(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Te.fromTimestamp(r===1e9?new un(t+1,0):new un(t,r));return new Qo(i,ye.empty(),e)}function Ab(n){return new Qo(n.readTime,n.key,-1)}class Qo{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Qo(Te.min(),ye.empty(),-1)}static max(){return new Qo(Te.max(),ye.empty(),-1)}}function xb(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ye.comparator(n.documentKey,e.documentKey),t!==0?t:nt(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nb="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Db{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zd(n){if(n.code!==X.FAILED_PRECONDITION||n.message!==Nb)throw n;me("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&we(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new J((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof J?t:J.resolve(t)}catch(t){return J.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):J.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):J.reject(t)}static resolve(e){return new J((t,r)=>{t(e)})}static reject(e){return new J((t,r)=>{r(e)})}static waitFor(e){return new J((t,r)=>{let i=0,s=0,o=!1;e.forEach(l=>{++i,l.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=J.resolve(!1);for(const r of e)t=t.next(i=>i?J.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new J((r,i)=>{const s=e.length,o=new Array(s);let l=0;for(let c=0;c<s;c++){const d=c;t(e[d]).next(p=>{o[d]=p,++l,l===s&&r(o)},p=>i(p))}})}static doWhile(e,t){return new J((r,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}}function Ob(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function ef(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xw{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ie(r),this.se=r=>t.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}xw.oe=-1;function tf(n){return n==null}function sm(n){return n===0&&1/n==-1/0}function bb(n){return typeof n=="number"&&Number.isInteger(n)&&!sm(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yC(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ml(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function QP(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zt=class O1{constructor(e,t){this.comparator=e,this.root=t||Go.EMPTY}insert(e,t){return new O1(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Go.BLACK,null,null))}remove(e){return new O1(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Go.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Gp(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Gp(this.root,e,this.comparator,!1)}getReverseIterator(){return new Gp(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Gp(this.root,e,this.comparator,!0)}},Gp=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Go=class Is{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??Is.RED,this.left=i??Is.EMPTY,this.right=s??Is.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new Is(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Is.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Is.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Is.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Is.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw we();const e=this.left.check();if(e!==this.right.check())throw we();return e+(this.isRed()?0:1)}};Go.EMPTY=null,Go.RED=!0,Go.BLACK=!1;Go.EMPTY=new class{constructor(){this.size=0}get key(){throw we()}get value(){throw we()}get color(){throw we()}get left(){throw we()}get right(){throw we()}copy(e,t,r,i,s){return this}insert(e,t,r){return new Go(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(e){this.comparator=e,this.data=new Zt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new vC(this.data.getIterator())}getIteratorFrom(e){return new vC(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Vn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Vn(this.comparator);return t.data=e,t}}class vC{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vr{constructor(e){this.fields=e,e.sort(Ln.comparator)}static empty(){return new Vr([])}unionWith(e){let t=new Vn(Ln.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Vr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Wu(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YP extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new YP("Invalid base64 string: "+s):s}}(e);return new zn(t)}static fromUint8Array(e){const t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new zn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return nt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}zn.EMPTY_BYTE_STRING=new zn("");const Mb=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Yo(n){if(Ze(!!n),typeof n=="string"){let e=0;const t=Mb.exec(n);if(Ze(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:jt(n.seconds),nanos:jt(n.nanos)}}function jt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ol(n){return typeof n=="string"?zn.fromBase64String(n):zn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nw(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Dw(n){const e=n.mapValue.fields.__previous_value__;return Nw(e)?Dw(e):e}function Sd(n){const e=Yo(n.mapValue.fields.__local_write_time__.timestampValue);return new un(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lb{constructor(e,t,r,i,s,o,l,c,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=d}}class Td{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Td("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Td&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wp={mapValue:{}};function al(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Nw(n)?4:Vb(n)?9007199254740991:Fb(n)?10:11:we()}function is(n,e){if(n===e)return!0;const t=al(n);if(t!==al(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Sd(n).isEqual(Sd(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Yo(i.timestampValue),l=Yo(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return ol(i.bytesValue).isEqual(ol(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return jt(i.geoPointValue.latitude)===jt(s.geoPointValue.latitude)&&jt(i.geoPointValue.longitude)===jt(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return jt(i.integerValue)===jt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=jt(i.doubleValue),l=jt(s.doubleValue);return o===l?sm(o)===sm(l):isNaN(o)&&isNaN(l)}return!1}(n,e);case 9:return Wu(n.arrayValue.values||[],e.arrayValue.values||[],is);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},l=s.mapValue.fields||{};if(yC(o)!==yC(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!is(o[c],l[c])))return!1;return!0}(n,e);default:return we()}}function Cd(n,e){return(n.values||[]).find(t=>is(t,e))!==void 0}function Hu(n,e){if(n===e)return 0;const t=al(n),r=al(e);if(t!==r)return nt(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return nt(n.booleanValue,e.booleanValue);case 2:return function(s,o){const l=jt(s.integerValue||s.doubleValue),c=jt(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(n,e);case 3:return wC(n.timestampValue,e.timestampValue);case 4:return wC(Sd(n),Sd(e));case 5:return nt(n.stringValue,e.stringValue);case 6:return function(s,o){const l=ol(s),c=ol(o);return l.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){const l=s.split("/"),c=o.split("/");for(let d=0;d<l.length&&d<c.length;d++){const p=nt(l[d],c[d]);if(p!==0)return p}return nt(l.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){const l=nt(jt(s.latitude),jt(o.latitude));return l!==0?l:nt(jt(s.longitude),jt(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return EC(n.arrayValue,e.arrayValue);case 10:return function(s,o){var l,c,d,p;const _=s.fields||{},m=o.fields||{},S=(l=_.value)===null||l===void 0?void 0:l.arrayValue,E=(c=m.value)===null||c===void 0?void 0:c.arrayValue,A=nt(((d=S==null?void 0:S.values)===null||d===void 0?void 0:d.length)||0,((p=E==null?void 0:E.values)===null||p===void 0?void 0:p.length)||0);return A!==0?A:EC(S,E)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===Wp.mapValue&&o===Wp.mapValue)return 0;if(s===Wp.mapValue)return 1;if(o===Wp.mapValue)return-1;const l=s.fields||{},c=Object.keys(l),d=o.fields||{},p=Object.keys(d);c.sort(),p.sort();for(let _=0;_<c.length&&_<p.length;++_){const m=nt(c[_],p[_]);if(m!==0)return m;const S=Hu(l[c[_]],d[p[_]]);if(S!==0)return S}return nt(c.length,p.length)}(n.mapValue,e.mapValue);default:throw we()}}function wC(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return nt(n,e);const t=Yo(n),r=Yo(e),i=nt(t.seconds,r.seconds);return i!==0?i:nt(t.nanos,r.nanos)}function EC(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=Hu(t[i],r[i]);if(s)return s}return nt(t.length,r.length)}function $u(n){return b1(n)}function b1(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=Yo(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return ol(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return ye.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=b1(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${b1(t.fields[o])}`;return i+"}"}(n.mapValue):we()}function SC(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function M1(n){return!!n&&"integerValue"in n}function Ow(n){return!!n&&"arrayValue"in n}function TC(n){return!!n&&"nullValue"in n}function CC(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function _g(n){return!!n&&"mapValue"in n}function Fb(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Wh(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return ml(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Wh(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Wh(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Vb(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr{constructor(e){this.value=e}static empty(){return new dr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!_g(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Wh(t)}setAll(e){let t=Ln.emptyPath(),r={},i=[];e.forEach((o,l)=>{if(!t.isImmediateParentOf(l)){const c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=l.popLast()}o?r[l.lastSegment()]=Wh(o):i.push(l.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());_g(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return is(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];_g(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){ml(t,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new dr(Wh(this.value))}}function XP(n){const e=[];return ml(n.fields,(t,r)=>{const i=new Ln([t]);if(_g(r)){const s=XP(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Vr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn{constructor(e,t,r,i,s,o,l){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Tn(e,0,Te.min(),Te.min(),Te.min(),dr.empty(),0)}static newFoundDocument(e,t,r,i){return new Tn(e,1,t,Te.min(),r,i,0)}static newNoDocument(e,t){return new Tn(e,2,t,Te.min(),Te.min(),dr.empty(),0)}static newUnknownDocument(e,t){return new Tn(e,3,t,Te.min(),Te.min(),dr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Te.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=dr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=dr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Te.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Tn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Tn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class om{constructor(e,t){this.position=e,this.inclusive=t}}function IC(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],o=n.position[i];if(s.field.isKeyField()?r=ye.comparator(ye.fromName(o.referenceValue),t.key):r=Hu(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function PC(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!is(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Id{constructor(e,t="asc"){this.field=e,this.dir=t}}function Ub(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JP{}class Jt extends JP{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Bb(e,t,r):t==="array-contains"?new Wb(e,r):t==="in"?new Hb(e,r):t==="not-in"?new $b(e,r):t==="array-contains-any"?new qb(e,r):new Jt(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new jb(e,r):new Gb(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Hu(t,this.value)):t!==null&&al(this.value)===al(t)&&this.matchesComparison(Hu(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return we()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Di extends JP{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new Di(e,t)}matches(e){return ZP(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function ZP(n){return n.op==="and"}function e9(n){return zb(n)&&ZP(n)}function zb(n){for(const e of n.filters)if(e instanceof Di)return!1;return!0}function L1(n){if(n instanceof Jt)return n.field.canonicalString()+n.op.toString()+$u(n.value);if(e9(n))return n.filters.map(e=>L1(e)).join(",");{const e=n.filters.map(t=>L1(t)).join(",");return`${n.op}(${e})`}}function t9(n,e){return n instanceof Jt?function(r,i){return i instanceof Jt&&r.op===i.op&&r.field.isEqual(i.field)&&is(r.value,i.value)}(n,e):n instanceof Di?function(r,i){return i instanceof Di&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,l)=>s&&t9(o,i.filters[l]),!0):!1}(n,e):void we()}function n9(n){return n instanceof Jt?function(t){return`${t.field.canonicalString()} ${t.op} ${$u(t.value)}`}(n):n instanceof Di?function(t){return t.op.toString()+" {"+t.getFilters().map(n9).join(" ,")+"}"}(n):"Filter"}class Bb extends Jt{constructor(e,t,r){super(e,t,r),this.key=ye.fromName(r.referenceValue)}matches(e){const t=ye.comparator(e.key,this.key);return this.matchesComparison(t)}}class jb extends Jt{constructor(e,t){super(e,"in",t),this.keys=r9("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Gb extends Jt{constructor(e,t){super(e,"not-in",t),this.keys=r9("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function r9(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>ye.fromName(r.referenceValue))}class Wb extends Jt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ow(t)&&Cd(t.arrayValue,this.value)}}class Hb extends Jt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Cd(this.value.arrayValue,t)}}class $b extends Jt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Cd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Cd(this.value.arrayValue,t)}}class qb extends Jt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ow(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Cd(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kb{constructor(e,t=null,r=[],i=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=l,this.ue=null}}function RC(n,e=null,t=[],r=[],i=null,s=null,o=null){return new Kb(n,e,t,r,i,s,o)}function bw(n){const e=ke(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>L1(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),tf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>$u(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>$u(r)).join(",")),e.ue=t}return e.ue}function Mw(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Ub(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!t9(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!PC(n.startAt,e.startAt)&&PC(n.endAt,e.endAt)}function F1(n){return ye.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hc{constructor(e,t=null,r=[],i=[],s=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Qb(n,e,t,r,i,s,o,l){return new hc(n,e,t,r,i,s,o,l)}function Lw(n){return new hc(n)}function kC(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function i9(n){return n.collectionGroup!==null}function Hh(n){const e=ke(n);if(e.ce===null){e.ce=[];const t=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Vn(Ln.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(l=l.add(d.field))})}),l})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Id(s,r))}),t.has(Ln.keyField().canonicalString())||e.ce.push(new Id(Ln.keyField(),r))}return e.ce}function rs(n){const e=ke(n);return e.le||(e.le=Yb(e,Hh(n))),e.le}function Yb(n,e){if(n.limitType==="F")return RC(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Id(i.field,s)});const t=n.endAt?new om(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new om(n.startAt.position,n.startAt.inclusive):null;return RC(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function V1(n,e){const t=n.filters.concat([e]);return new hc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function U1(n,e,t){return new hc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function r0(n,e){return Mw(rs(n),rs(e))&&n.limitType===e.limitType}function s9(n){return`${bw(rs(n))}|lt:${n.limitType}`}function iu(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>n9(i)).join(", ")}]`),tf(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>$u(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>$u(i)).join(",")),`Target(${r})`}(rs(n))}; limitType=${n.limitType})`}function i0(n,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):ye.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(const s of Hh(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,l,c){const d=IC(o,l,c);return o.inclusive?d<=0:d<0}(r.startAt,Hh(r),i)||r.endAt&&!function(o,l,c){const d=IC(o,l,c);return o.inclusive?d>=0:d>0}(r.endAt,Hh(r),i))}(n,e)}function Xb(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function o9(n){return(e,t)=>{let r=!1;for(const i of Hh(n)){const s=Jb(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function Jb(n,e,t){const r=n.field.isKeyField()?ye.comparator(e.key,t.key):function(s,o,l){const c=o.data.field(s),d=l.data.field(s);return c!==null&&d!==null?Hu(c,d):we()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return we()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dc{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ml(this.inner,(t,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return QP(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zb=new Zt(ye.comparator);function Qs(){return Zb}const a9=new Zt(ye.comparator);function Ah(...n){let e=a9;for(const t of n)e=e.insert(t.key,t);return e}function l9(n){let e=a9;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Ha(){return $h()}function u9(){return $h()}function $h(){return new dc(n=>n.toString(),(n,e)=>n.isEqual(e))}const eM=new Zt(ye.comparator),tM=new Vn(ye.comparator);function He(...n){let e=tM;for(const t of n)e=e.add(t);return e}const nM=new Vn(nt);function rM(){return nM}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fw(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:sm(e)?"-0":e}}function c9(n){return{integerValue:""+n}}function iM(n,e){return bb(e)?c9(e):Fw(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s0{constructor(){this._=void 0}}function sM(n,e,t){return n instanceof Pd?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Nw(s)&&(s=Dw(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof Rd?d9(n,e):n instanceof kd?f9(n,e):function(i,s){const o=h9(i,s),l=AC(o)+AC(i.Pe);return M1(o)&&M1(i.Pe)?c9(l):Fw(i.serializer,l)}(n,e)}function oM(n,e,t){return n instanceof Rd?d9(n,e):n instanceof kd?f9(n,e):t}function h9(n,e){return n instanceof am?function(r){return M1(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Pd extends s0{}class Rd extends s0{constructor(e){super(),this.elements=e}}function d9(n,e){const t=p9(e);for(const r of n.elements)t.some(i=>is(i,r))||t.push(r);return{arrayValue:{values:t}}}class kd extends s0{constructor(e){super(),this.elements=e}}function f9(n,e){let t=p9(e);for(const r of n.elements)t=t.filter(i=>!is(i,r));return{arrayValue:{values:t}}}class am extends s0{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function AC(n){return jt(n.integerValue||n.doubleValue)}function p9(n){return Ow(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aM{constructor(e,t){this.field=e,this.transform=t}}function lM(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Rd&&i instanceof Rd||r instanceof kd&&i instanceof kd?Wu(r.elements,i.elements,is):r instanceof am&&i instanceof am?is(r.Pe,i.Pe):r instanceof Pd&&i instanceof Pd}(n.transform,e.transform)}class uM{constructor(e,t){this.version=e,this.transformResults=t}}class er{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new er}static exists(e){return new er(void 0,e)}static updateTime(e){return new er(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function yg(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class o0{}function g9(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new a0(n.key,er.none()):new nf(n.key,n.data,er.none());{const t=n.data,r=dr.empty();let i=new Vn(Ln.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new la(n.key,r,new Vr(i.toArray()),er.none())}}function cM(n,e,t){n instanceof nf?function(i,s,o){const l=i.value.clone(),c=NC(i.fieldTransforms,s,o.transformResults);l.setAll(c),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):n instanceof la?function(i,s,o){if(!yg(i.precondition,s))return void s.convertToUnknownDocument(o.version);const l=NC(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(m9(i)),c.setAll(l),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function qh(n,e,t,r){return n instanceof nf?function(s,o,l,c){if(!yg(s.precondition,o))return l;const d=s.value.clone(),p=DC(s.fieldTransforms,c,o);return d.setAll(p),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(n,e,t,r):n instanceof la?function(s,o,l,c){if(!yg(s.precondition,o))return l;const d=DC(s.fieldTransforms,c,o),p=o.data;return p.setAll(m9(s)),p.setAll(d),o.convertToFoundDocument(o.version,p).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(_=>_.field))}(n,e,t,r):function(s,o,l){return yg(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(n,e,t)}function hM(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=h9(r.transform,i||null);s!=null&&(t===null&&(t=dr.empty()),t.set(r.field,s))}return t||null}function xC(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Wu(r,i,(s,o)=>lM(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class nf extends o0{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class la extends o0{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function m9(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function NC(n,e,t){const r=new Map;Ze(n.length===t.length);for(let i=0;i<t.length;i++){const s=n[i],o=s.transform,l=e.data.field(s.field);r.set(s.field,oM(o,l,t[i]))}return r}function DC(n,e,t){const r=new Map;for(const i of n){const s=i.transform,o=t.data.field(i.field);r.set(i.field,sM(s,o,e))}return r}class a0 extends o0{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class _9 extends o0{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dM{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&cM(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=qh(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=qh(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=u9();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=t.has(i.key)?null:l;const c=g9(o,l);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(Te.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),He())}isEqual(e){return this.batchId===e.batchId&&Wu(this.mutations,e.mutations,(t,r)=>xC(t,r))&&Wu(this.baseMutations,e.baseMutations,(t,r)=>xC(t,r))}}class Vw{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Ze(e.mutations.length===r.length);let i=function(){return eM}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new Vw(e,t,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fM{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pM{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qt,Xe;function y9(n){switch(n){default:return we();case X.CANCELLED:case X.UNKNOWN:case X.DEADLINE_EXCEEDED:case X.RESOURCE_EXHAUSTED:case X.INTERNAL:case X.UNAVAILABLE:case X.UNAUTHENTICATED:return!1;case X.INVALID_ARGUMENT:case X.NOT_FOUND:case X.ALREADY_EXISTS:case X.PERMISSION_DENIED:case X.FAILED_PRECONDITION:case X.ABORTED:case X.OUT_OF_RANGE:case X.UNIMPLEMENTED:case X.DATA_LOSS:return!0}}function v9(n){if(n===void 0)return Ks("GRPC error has no .code"),X.UNKNOWN;switch(n){case Qt.OK:return X.OK;case Qt.CANCELLED:return X.CANCELLED;case Qt.UNKNOWN:return X.UNKNOWN;case Qt.DEADLINE_EXCEEDED:return X.DEADLINE_EXCEEDED;case Qt.RESOURCE_EXHAUSTED:return X.RESOURCE_EXHAUSTED;case Qt.INTERNAL:return X.INTERNAL;case Qt.UNAVAILABLE:return X.UNAVAILABLE;case Qt.UNAUTHENTICATED:return X.UNAUTHENTICATED;case Qt.INVALID_ARGUMENT:return X.INVALID_ARGUMENT;case Qt.NOT_FOUND:return X.NOT_FOUND;case Qt.ALREADY_EXISTS:return X.ALREADY_EXISTS;case Qt.PERMISSION_DENIED:return X.PERMISSION_DENIED;case Qt.FAILED_PRECONDITION:return X.FAILED_PRECONDITION;case Qt.ABORTED:return X.ABORTED;case Qt.OUT_OF_RANGE:return X.OUT_OF_RANGE;case Qt.UNIMPLEMENTED:return X.UNIMPLEMENTED;case Qt.DATA_LOSS:return X.DATA_LOSS;default:return we()}}(Xe=Qt||(Qt={}))[Xe.OK=0]="OK",Xe[Xe.CANCELLED=1]="CANCELLED",Xe[Xe.UNKNOWN=2]="UNKNOWN",Xe[Xe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Xe[Xe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Xe[Xe.NOT_FOUND=5]="NOT_FOUND",Xe[Xe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Xe[Xe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Xe[Xe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Xe[Xe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Xe[Xe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Xe[Xe.ABORTED=10]="ABORTED",Xe[Xe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Xe[Xe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Xe[Xe.INTERNAL=13]="INTERNAL",Xe[Xe.UNAVAILABLE=14]="UNAVAILABLE",Xe[Xe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gM(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mM=new Ya([4294967295,4294967295],0);function OC(n){const e=gM().encode(n),t=new BP;return t.update(e),new Uint8Array(t.digest())}function bC(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ya([t,r],0),new Ya([i,s],0)]}class Uw{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new xh(`Invalid padding: ${t}`);if(r<0)throw new xh(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new xh(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new xh(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Ya.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(Ya.fromNumber(r)));return i.compare(mM)===1&&(i=new Ya([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=OC(e),[r,i]=bC(t);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Uw(s,i,t);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const t=OC(e),[r,i]=bC(t);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class xh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l0{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,rf.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new l0(Te.min(),i,new Zt(nt),Qs(),He())}}class rf{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new rf(r,t,He(),He(),He())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vg{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}}class w9{constructor(e,t){this.targetId=e,this.me=t}}class E9{constructor(e,t,r=zn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class MC{constructor(){this.fe=0,this.ge=FC(),this.pe=zn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=He(),t=He(),r=He();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:we()}}),new rf(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=FC()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Ze(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class _M{constructor(e){this.Le=e,this.Be=new Map,this.ke=Qs(),this.qe=LC(),this.Qe=new Zt(nt)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:we()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){const t=e.targetId,r=e.me.count,i=this.Je(t);if(i){const s=i.target;if(F1(s))if(r===0){const o=new ye(s.path);this.Ue(t,o,Tn.newNoDocument(o,Te.min()))}else Ze(r===1);else{const o=this.Ye(t);if(o!==r){const l=this.Ze(e),c=l?this.Xe(l,e,o):1;if(c!==0){this.je(t);const d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,d)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let o,l;try{o=ol(r).toUint8Array()}catch(c){if(c instanceof YP)return Gu("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new Uw(o,i,s)}catch(c){return Gu(c instanceof xh?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let i=0;return r.forEach(s=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.Ue(t,s,null),i++)}),i}rt(e){const t=new Map;this.Be.forEach((s,o)=>{const l=this.Je(o);if(l){if(s.current&&F1(l.target)){const c=new ye(l.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,Tn.newNoDocument(c,e))}s.be&&(t.set(o,s.ve()),s.Ce())}});let r=He();this.qe.forEach((s,o)=>{let l=!0;o.forEachWhile(c=>{const d=this.Je(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new l0(e,t,this.Qe,this.ke,r);return this.ke=Qs(),this.qe=LC(),this.Qe=new Zt(nt),i}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new MC,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Vn(nt),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||me("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new MC),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function LC(){return new Zt(ye.comparator)}function FC(){return new Zt(ye.comparator)}const yM={asc:"ASCENDING",desc:"DESCENDING"},vM={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},wM={and:"AND",or:"OR"};class EM{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function z1(n,e){return n.useProto3Json||tf(e)?e:{value:e}}function lm(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function S9(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function SM(n,e){return lm(n,e.toTimestamp())}function zr(n){return Ze(!!n),Te.fromTimestamp(function(t){const r=Yo(t);return new un(r.seconds,r.nanos)}(n))}function zw(n,e){return B1(n,e).canonicalString()}function B1(n,e){const t=function(i){return new yt(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function T9(n){const e=yt.fromString(n);return Ze(A9(e)),e}function um(n,e){return zw(n.databaseId,e.path)}function Kh(n,e){const t=T9(e);if(t.get(1)!==n.databaseId.projectId)throw new ue(X.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ue(X.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ye(I9(t))}function C9(n,e){return zw(n.databaseId,e)}function TM(n){const e=T9(n);return e.length===4?yt.emptyPath():I9(e)}function j1(n){return new yt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function I9(n){return Ze(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function VC(n,e,t){return{name:um(n,e),fields:t.value.mapValue.fields}}function CM(n,e){return"found"in e?function(r,i){Ze(!!i.found),i.found.name,i.found.updateTime;const s=Kh(r,i.found.name),o=zr(i.found.updateTime),l=i.found.createTime?zr(i.found.createTime):Te.min(),c=new dr({mapValue:{fields:i.found.fields}});return Tn.newFoundDocument(s,o,l,c)}(n,e):"missing"in e?function(r,i){Ze(!!i.missing),Ze(!!i.readTime);const s=Kh(r,i.missing),o=zr(i.readTime);return Tn.newNoDocument(s,o)}(n,e):we()}function IM(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:we()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(d,p){return d.useProto3Json?(Ze(p===void 0||typeof p=="string"),zn.fromBase64String(p||"")):(Ze(p===void 0||p instanceof Buffer||p instanceof Uint8Array),zn.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(d){const p=d.code===void 0?X.UNKNOWN:v9(d.code);return new ue(p,d.message||"")}(o);t=new E9(r,i,s,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Kh(n,r.document.name),s=zr(r.document.updateTime),o=r.document.createTime?zr(r.document.createTime):Te.min(),l=new dr({mapValue:{fields:r.document.fields}}),c=Tn.newFoundDocument(i,s,o,l),d=r.targetIds||[],p=r.removedTargetIds||[];t=new vg(d,p,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Kh(n,r.document),s=r.readTime?zr(r.readTime):Te.min(),o=Tn.newNoDocument(i,s),l=r.removedTargetIds||[];t=new vg([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Kh(n,r.document),s=r.removedTargetIds||[];t=new vg([],s,i,null)}else{if(!("filter"in e))return we();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new pM(i,s),l=r.targetId;t=new w9(l,o)}}return t}function P9(n,e){let t;if(e instanceof nf)t={update:VC(n,e.key,e.value)};else if(e instanceof a0)t={delete:um(n,e.key)};else if(e instanceof la)t={update:VC(n,e.key,e.data),updateMask:bM(e.fieldMask)};else{if(!(e instanceof _9))return we();t={verify:um(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const l=o.transform;if(l instanceof Pd)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Rd)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof kd)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof am)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw we()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:SM(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:we()}(n,e.precondition)),t}function PM(n,e){return n&&n.length>0?(Ze(e!==void 0),n.map(t=>function(i,s){let o=i.updateTime?zr(i.updateTime):zr(s);return o.isEqual(Te.min())&&(o=zr(s)),new uM(o,i.transformResults||[])}(t,e))):[]}function RM(n,e){return{documents:[C9(n,e.path)]}}function kM(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=C9(n,i);const s=function(d){if(d.length!==0)return k9(Di.create(d,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const o=function(d){if(d.length!==0)return d.map(p=>function(m){return{field:su(m.field),direction:NM(m.dir)}}(p))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=z1(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:t,parent:i}}function AM(n){let e=TM(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Ze(r===1);const p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];t.where&&(s=function(_){const m=R9(_);return m instanceof Di&&e9(m)?m.getFilters():[m]}(t.where));let o=[];t.orderBy&&(o=function(_){return _.map(m=>function(E){return new Id(ou(E.field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(m))}(t.orderBy));let l=null;t.limit&&(l=function(_){let m;return m=typeof _=="object"?_.value:_,tf(m)?null:m}(t.limit));let c=null;t.startAt&&(c=function(_){const m=!!_.before,S=_.values||[];return new om(S,m)}(t.startAt));let d=null;return t.endAt&&(d=function(_){const m=!_.before,S=_.values||[];return new om(S,m)}(t.endAt)),Qb(e,i,o,s,l,"F",c,d)}function xM(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return we()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function R9(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=ou(t.unaryFilter.field);return Jt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=ou(t.unaryFilter.field);return Jt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=ou(t.unaryFilter.field);return Jt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=ou(t.unaryFilter.field);return Jt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return we()}}(n):n.fieldFilter!==void 0?function(t){return Jt.create(ou(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return we()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Di.create(t.compositeFilter.filters.map(r=>R9(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return we()}}(t.compositeFilter.op))}(n):we()}function NM(n){return yM[n]}function DM(n){return vM[n]}function OM(n){return wM[n]}function su(n){return{fieldPath:n.canonicalString()}}function ou(n){return Ln.fromServerFormat(n.fieldPath)}function k9(n){return n instanceof Jt?function(t){if(t.op==="=="){if(CC(t.value))return{unaryFilter:{field:su(t.field),op:"IS_NAN"}};if(TC(t.value))return{unaryFilter:{field:su(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(CC(t.value))return{unaryFilter:{field:su(t.field),op:"IS_NOT_NAN"}};if(TC(t.value))return{unaryFilter:{field:su(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:su(t.field),op:DM(t.op),value:t.value}}}(n):n instanceof Di?function(t){const r=t.getFilters().map(i=>k9(i));return r.length===1?r[0]:{compositeFilter:{op:OM(t.op),filters:r}}}(n):we()}function bM(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function A9(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(e,t,r,i,s=Te.min(),o=Te.min(),l=zn.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Do(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Do(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Do(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Do(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MM{constructor(e){this.ct=e}}function LM(n){const e=AM({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?U1(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FM{constructor(){this.un=new VM}addToCollectionParentIndex(e,t){return this.un.add(t),J.resolve()}getCollectionParents(e,t){return J.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return J.resolve()}deleteFieldIndex(e,t){return J.resolve()}deleteAllFieldIndexes(e){return J.resolve()}createTargetIndexes(e,t){return J.resolve()}getDocumentsMatchingTarget(e,t){return J.resolve(null)}getIndexType(e,t){return J.resolve(0)}getFieldIndexes(e,t){return J.resolve([])}getNextCollectionGroupToUpdate(e){return J.resolve(null)}getMinOffset(e,t){return J.resolve(Qo.min())}getMinOffsetFromCollectionGroup(e,t){return J.resolve(Qo.min())}updateCollectionGroup(e,t,r){return J.resolve()}updateIndexEntries(e,t){return J.resolve()}}class VM{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Vn(yt.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Vn(yt.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qu{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new qu(0)}static kn(){return new qu(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UM{constructor(){this.changes=new dc(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Tn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?J.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zM{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BM{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&qh(r.mutation,i,Vr.empty(),un.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,He()).next(()=>r))}getLocalViewOfDocuments(e,t,r=He()){const i=Ha();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=Ah();return s.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=Ha();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,He()))}populateOverlays(e,t,r){const i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,l)=>{t.set(o,l)})})}computeViews(e,t,r,i){let s=Qs();const o=$h(),l=function(){return $h()}();return t.forEach((c,d)=>{const p=r.get(d.key);i.has(d.key)&&(p===void 0||p.mutation instanceof la)?s=s.insert(d.key,d):p!==void 0?(o.set(d.key,p.mutation.getFieldMask()),qh(p.mutation,d,p.mutation.getFieldMask(),un.now())):o.set(d.key,Vr.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((d,p)=>o.set(d,p)),t.forEach((d,p)=>{var _;return l.set(d,new zM(p,(_=o.get(d))!==null&&_!==void 0?_:null))}),l))}recalculateAndSaveOverlays(e,t){const r=$h();let i=new Zt((o,l)=>o-l),s=He();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const l of o)l.keys().forEach(c=>{const d=t.get(c);if(d===null)return;let p=r.get(c)||Vr.empty();p=l.applyToLocalView(d,p),r.set(c,p);const _=(i.get(l.batchId)||He()).add(c);i=i.insert(l.batchId,_)})}).next(()=>{const o=[],l=i.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),d=c.key,p=c.value,_=u9();p.forEach(m=>{if(!s.has(m)){const S=g9(t.get(m),r.get(m));S!==null&&_.set(m,S),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,_))}return J.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return ye.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):i9(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):J.resolve(Ha());let l=-1,c=s;return o.next(d=>J.forEach(d,(p,_)=>(l<_.largestBatchId&&(l=_.largestBatchId),s.get(p)?J.resolve():this.remoteDocumentCache.getEntry(e,p).next(m=>{c=c.insert(p,m)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,c,d,He())).next(p=>({batchId:l,changes:l9(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ye(t)).next(r=>{let i=Ah();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let o=Ah();return this.indexManager.getCollectionParents(e,s).next(l=>J.forEach(l,c=>{const d=function(_,m){return new hc(m,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)}(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(p=>{p.forEach((_,m)=>{o=o.insert(_,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((c,d)=>{const p=d.getKey();o.get(p)===null&&(o=o.insert(p,Tn.newInvalidDocument(p)))});let l=Ah();return o.forEach((c,d)=>{const p=s.get(c);p!==void 0&&qh(p.mutation,d,Vr.empty(),un.now()),i0(t,d)&&(l=l.insert(c,d))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jM{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return J.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:zr(i.createTime)}}(t)),J.resolve()}getNamedQuery(e,t){return J.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:LM(i.bundledQuery),readTime:zr(i.readTime)}}(t)),J.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GM{constructor(){this.overlays=new Zt(ye.comparator),this.Ir=new Map}getOverlay(e,t){return J.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Ha();return J.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),J.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),J.resolve()}getOverlaysForCollection(e,t,r){const i=Ha(),s=t.length+1,o=new ye(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,d=c.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return J.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Zt((d,p)=>d-p);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let p=s.get(d.largestBatchId);p===null&&(p=Ha(),s=s.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}const l=Ha(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,p)=>l.set(d,p)),!(l.size()>=i)););return J.resolve(l)}ht(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new fM(t,r));let s=this.Ir.get(t);s===void 0&&(s=He(),this.Ir.set(t,s)),this.Ir.set(t,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WM{constructor(){this.sessionToken=zn.EMPTY_BYTE_STRING}getSessionToken(e){return J.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,J.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bw{constructor(){this.Tr=new Vn(vn.Er),this.dr=new Vn(vn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const r=new vn(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new vn(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){const t=new ye(new yt([])),r=new vn(t,e),i=new vn(t,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new ye(new yt([])),r=new vn(t,e),i=new vn(t,e+1);let s=He();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new vn(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class vn{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return ye.comparator(e.key,t.key)||nt(e.wr,t.wr)}static Ar(e,t){return nt(e.wr,t.wr)||ye.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HM{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Vn(vn.Er)}checkEmpty(e){return J.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new dM(s,t,r,i);this.mutationQueue.push(o);for(const l of i)this.br=this.br.add(new vn(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return J.resolve(o)}lookupMutationBatch(e,t){return J.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.vr(r),s=i<0?0:i;return J.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return J.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return J.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new vn(t,0),i=new vn(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{const l=this.Dr(o.wr);s.push(l)}),J.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Vn(nt);return t.forEach(i=>{const s=new vn(i,0),o=new vn(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],l=>{r=r.add(l.wr)})}),J.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;ye.isDocumentKey(s)||(s=s.child(""));const o=new vn(new ye(s),0);let l=new Vn(nt);return this.br.forEachWhile(c=>{const d=c.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(l=l.add(c.wr)),!0)},o),J.resolve(this.Cr(l))}Cr(e){const t=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){Ze(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return J.forEach(t.mutations,i=>{const s=new vn(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){const r=new vn(t,0),i=this.br.firstAfterOrEqual(r);return J.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,J.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $M{constructor(e){this.Mr=e,this.docs=function(){return new Zt(ye.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return J.resolve(r?r.document.mutableCopy():Tn.newInvalidDocument(t))}getEntries(e,t){let r=Qs();return t.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Tn.newInvalidDocument(i))}),J.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Qs();const o=t.path,l=new ye(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:d,value:{document:p}}=c.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||xb(Ab(p),r)<=0||(i.has(p.key)||i0(t,p))&&(s=s.insert(p.key,p.mutableCopy()))}return J.resolve(s)}getAllFromCollectionGroup(e,t,r,i){we()}Or(e,t){return J.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new qM(this)}getSize(e){return J.resolve(this.size)}}class qM extends UM{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),J.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KM{constructor(e){this.persistence=e,this.Nr=new dc(t=>bw(t),Mw),this.lastRemoteSnapshotVersion=Te.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Bw,this.targetCount=0,this.kr=qu.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),J.resolve()}getLastRemoteSnapshotVersion(e){return J.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return J.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),J.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),J.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new qu(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,J.resolve()}updateTargetData(e,t){return this.Kn(t),J.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,J.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=t&&r.get(l.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),J.waitFor(s).next(()=>i)}getTargetCount(e){return J.resolve(this.targetCount)}getTargetData(e,t){const r=this.Nr.get(t)||null;return J.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),J.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),J.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),J.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Br.yr(t);return J.resolve(r)}containsKey(e,t){return J.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QM{constructor(e,t){this.qr={},this.overlays={},this.Qr=new xw(0),this.Kr=!1,this.Kr=!0,this.$r=new WM,this.referenceDelegate=e(this),this.Ur=new KM(this),this.indexManager=new FM,this.remoteDocumentCache=function(i){return new $M(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new MM(t),this.Gr=new jM(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new GM,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new HM(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){me("MemoryPersistence","Starting transaction:",e);const i=new YM(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,t){return J.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}}class YM extends Db{constructor(e){super(),this.currentSequenceNumber=e}}class jw{constructor(e){this.persistence=e,this.Jr=new Bw,this.Yr=null}static Zr(e){return new jw(e)}get Xr(){if(this.Yr)return this.Yr;throw we()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),J.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),J.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),J.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return J.forEach(this.Xr,r=>{const i=ye.fromPath(r);return this.ei(e,i).next(s=>{s||t.removeEntry(i,Te.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return J.or([()=>J.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gw{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=He(),i=He();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Gw(e,t.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JM{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return FN()?8:Ob(rr())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.Yi(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new XM;return this.Xi(e,t,o).next(l=>{if(s.result=l,this.zi)return this.es(e,t,o,l.size)})}).next(()=>s.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(fh()<=We.DEBUG&&me("QueryEngine","SDK will not create cache indexes for query:",iu(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),J.resolve()):(fh()<=We.DEBUG&&me("QueryEngine","Query:",iu(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(fh()<=We.DEBUG&&me("QueryEngine","The SDK decides to create cache indexes for query:",iu(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,rs(t))):J.resolve())}Yi(e,t){if(kC(t))return J.resolve(null);let r=rs(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=U1(t,null,"F"),r=rs(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=He(...s);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const d=this.ts(t,l);return this.ns(t,d,o,c.readTime)?this.Yi(e,U1(t,null,"F")):this.rs(e,d,t,c)}))})))}Zi(e,t,r,i){return kC(t)||i.isEqual(Te.min())?J.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const o=this.ts(t,s);return this.ns(t,o,r,i)?J.resolve(null):(fh()<=We.DEBUG&&me("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),iu(t)),this.rs(e,o,t,kb(i,-1)).next(l=>l))})}ts(e,t){let r=new Vn(o9(e));return t.forEach((i,s)=>{i0(e,s)&&(r=r.add(s))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,t,r){return fh()<=We.DEBUG&&me("QueryEngine","Using full collection scan to execute query:",iu(t)),this.Ji.getDocumentsMatchingQuery(e,t,Qo.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZM{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new Zt(nt),this._s=new dc(s=>bw(s),Mw),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new BM(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function eL(n,e,t,r){return new ZM(n,e,t,r)}async function x9(n,e){const t=ke(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],l=[];let c=He();for(const d of i){o.push(d.batchId);for(const p of d.mutations)c=c.add(p.key)}for(const d of s){l.push(d.batchId);for(const p of d.mutations)c=c.add(p.key)}return t.localDocuments.getDocuments(r,c).next(d=>({hs:d,removedBatchIds:o,addedBatchIds:l}))})})}function tL(n,e){const t=ke(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,d,p){const _=d.batch,m=_.keys();let S=J.resolve();return m.forEach(E=>{S=S.next(()=>p.getEntry(c,E)).next(A=>{const D=d.docVersions.get(E);Ze(D!==null),A.version.compareTo(D)<0&&(_.applyToRemoteDocument(A,d),A.isValidDocument()&&(A.setReadTime(d.commitVersion),p.addEntry(A)))})}),S.next(()=>l.mutationQueue.removeMutationBatch(c,_))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=He();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(c=c.add(l.batch.mutations[d].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function N9(n){const e=ke(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function nL(n,e){const t=ke(n),r=e.snapshotVersion;let i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;const l=[];e.targetChanges.forEach((p,_)=>{const m=i.get(_);if(!m)return;l.push(t.Ur.removeMatchingKeys(s,p.removedDocuments,_).next(()=>t.Ur.addMatchingKeys(s,p.addedDocuments,_)));let S=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(_)!==null?S=S.withResumeToken(zn.EMPTY_BYTE_STRING,Te.min()).withLastLimboFreeSnapshotVersion(Te.min()):p.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(p.resumeToken,r)),i=i.insert(_,S),function(A,D,k){return A.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=3e8?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(m,S,p)&&l.push(t.Ur.updateTargetData(s,S))});let c=Qs(),d=He();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(s,p))}),l.push(rL(s,o,e.documentUpdates).next(p=>{c=p.Ps,d=p.Is})),!r.isEqual(Te.min())){const p=t.Ur.getLastRemoteSnapshotVersion(s).next(_=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));l.push(p)}return J.waitFor(l).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,d)).next(()=>c)}).then(s=>(t.os=i,s))}function rL(n,e,t){let r=He(),i=He();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=Qs();return t.forEach((l,c)=>{const d=s.get(l);c.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(l)),c.isNoDocument()&&c.version.isEqual(Te.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):me("LocalStore","Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",c.version)}),{Ps:o,Is:i}})}function iL(n,e){const t=ke(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function sL(n,e){const t=ke(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(s=>s?(i=s,J.resolve(i)):t.Ur.allocateTargetId(r).next(o=>(i=new Do(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}async function G1(n,e,t){const r=ke(n),i=r.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!ef(o))throw o;me("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function UC(n,e,t){const r=ke(n);let i=Te.min(),s=He();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,d,p){const _=ke(c),m=_._s.get(p);return m!==void 0?J.resolve(_.os.get(m)):_.Ur.getTargetData(d,p)}(r,o,rs(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,l.targetId).next(c=>{s=c})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?i:Te.min(),t?s:He())).next(l=>(oL(r,Xb(e),l),{documents:l,Ts:s})))}function oL(n,e,t){let r=n.us.get(e)||Te.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.us.set(e,r)}class zC{constructor(){this.activeTargetIds=rM()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class aL{constructor(){this.so=new zC,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new zC,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lL{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BC{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){me("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){me("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hp=null;function sv(){return Hp===null?Hp=function(){return 268435456+Math.round(2147483648*Math.random())}():Hp++,"0x"+Hp.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cL{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xn="WebChannelConnection";class hL extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(t,r,i,s,o){const l=sv(),c=this.xo(t,r.toUriEncodedString());me("RestConnection",`Sending RPC '${t}' ${l}:`,c,i);const d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,s,o),this.No(t,c,d,i).then(p=>(me("RestConnection",`Received RPC '${t}' ${l}: `,p),p),p=>{throw Gu("RestConnection",`RPC '${t}' ${l} failed with error: `,p,"url: ",c,"request:",i),p})}Lo(t,r,i,s,o,l){return this.Mo(t,r,i,s,o)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+cc}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}xo(t,r){const i=uL[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){const s=sv();return new Promise((o,l)=>{const c=new jP;c.setWithCredentials(!0),c.listenOnce(GP.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case mg.NO_ERROR:const p=c.getResponseJson();me(Xn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(p)),o(p);break;case mg.TIMEOUT:me(Xn,`RPC '${e}' ${s} timed out`),l(new ue(X.DEADLINE_EXCEEDED,"Request time out"));break;case mg.HTTP_ERROR:const _=c.getStatus();if(me(Xn,`RPC '${e}' ${s} failed with status:`,_,"response text:",c.getResponseText()),_>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);const S=m==null?void 0:m.error;if(S&&S.status&&S.message){const E=function(D){const k=D.toLowerCase().replace(/_/g,"-");return Object.values(X).indexOf(k)>=0?k:X.UNKNOWN}(S.status);l(new ue(E,S.message))}else l(new ue(X.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new ue(X.UNAVAILABLE,"Connection failed."));break;default:we()}}finally{me(Xn,`RPC '${e}' ${s} completed.`)}});const d=JSON.stringify(i);me(Xn,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",d,r,15)})}Bo(e,t,r){const i=sv(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=$P(),l=HP(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;const p=s.join("");me(Xn,`Creating RPC '${e}' stream ${i}: ${p}`,c);const _=o.createWebChannel(p,c);let m=!1,S=!1;const E=new cL({Io:D=>{S?me(Xn,`Not sending because RPC '${e}' stream ${i} is closed:`,D):(m||(me(Xn,`Opening RPC '${e}' stream ${i} transport.`),_.open(),m=!0),me(Xn,`RPC '${e}' stream ${i} sending:`,D),_.send(D))},To:()=>_.close()}),A=(D,k,R)=>{D.listen(k,w=>{try{R(w)}catch(P){setTimeout(()=>{throw P},0)}})};return A(_,kh.EventType.OPEN,()=>{S||(me(Xn,`RPC '${e}' stream ${i} transport opened.`),E.yo())}),A(_,kh.EventType.CLOSE,()=>{S||(S=!0,me(Xn,`RPC '${e}' stream ${i} transport closed`),E.So())}),A(_,kh.EventType.ERROR,D=>{S||(S=!0,Gu(Xn,`RPC '${e}' stream ${i} transport errored:`,D),E.So(new ue(X.UNAVAILABLE,"The operation could not be completed")))}),A(_,kh.EventType.MESSAGE,D=>{var k;if(!S){const R=D.data[0];Ze(!!R);const w=R,P=w.error||((k=w[0])===null||k===void 0?void 0:k.error);if(P){me(Xn,`RPC '${e}' stream ${i} received error:`,P);const V=P.status;let U=function(O){const x=Qt[O];if(x!==void 0)return v9(x)}(V),N=P.message;U===void 0&&(U=X.INTERNAL,N="Unknown error status: "+V+" with message "+P.message),S=!0,E.So(new ue(U,N)),_.close()}else me(Xn,`RPC '${e}' stream ${i} received:`,R),E.bo(R)}}),A(l,WP.STAT_EVENT,D=>{D.stat===D1.PROXY?me(Xn,`RPC '${e}' stream ${i} detected buffering proxy`):D.stat===D1.NOPROXY&&me(Xn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{E.wo()},0),E}}function ov(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u0(n){return new EM(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ww{constructor(e,t,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&me("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D9{constructor(e,t,r,i,s,o,l,c){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Ww(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===X.RESOURCE_EXHAUSTED?(Ks(t.toString()),Ks("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===X.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{const i=new ue(X.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){const r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return me("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(me("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class dL extends D9{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=IM(this.serializer,e),r=function(s){if(!("targetChange"in s))return Te.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Te.min():o.readTime?zr(o.readTime):Te.min()}(e);return this.listener.d_(t,r)}A_(e){const t={};t.database=j1(this.serializer),t.addTarget=function(s,o){let l;const c=o.target;if(l=F1(c)?{documents:RM(s,c)}:{query:kM(s,c)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=S9(s,o.resumeToken);const d=z1(s,o.expectedCount);d!==null&&(l.expectedCount=d)}else if(o.snapshotVersion.compareTo(Te.min())>0){l.readTime=lm(s,o.snapshotVersion.toTimestamp());const d=z1(s,o.expectedCount);d!==null&&(l.expectedCount=d)}return l}(this.serializer,e);const r=xM(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){const t={};t.database=j1(this.serializer),t.removeTarget=e,this.a_(t)}}class fL extends D9{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Ze(!!e.streamToken),this.lastStreamToken=e.streamToken,Ze(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Ze(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=PM(e.writeResults,e.commitTime),r=zr(e.commitTime);return this.listener.g_(r,t)}p_(){const e={};e.database=j1(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>P9(this.serializer,r))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pL extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new ue(X.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,B1(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===X.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ue(X.UNKNOWN,s.toString())})}Lo(e,t,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,B1(t,r),i,o,l,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===X.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ue(X.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class gL{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Ks(t),this.D_=!1):me("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mL{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(async()=>{_l(this)&&(me("RemoteStore","Restarting streams for network reachability change."),await async function(c){const d=ke(c);d.L_.add(4),await sf(d),d.q_.set("Unknown"),d.L_.delete(4),await c0(d)}(this))})}),this.q_=new gL(r,i)}}async function c0(n){if(_l(n))for(const e of n.B_)await e(!0)}async function sf(n){for(const e of n.B_)await e(!1)}function O9(n,e){const t=ke(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Kw(t)?qw(t):fc(t).r_()&&$w(t,e))}function Hw(n,e){const t=ke(n),r=fc(t);t.N_.delete(e),r.r_()&&b9(t,e),t.N_.size===0&&(r.r_()?r.o_():_l(t)&&t.q_.set("Unknown"))}function $w(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Te.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}fc(n).A_(e)}function b9(n,e){n.Q_.xe(e),fc(n).R_(e)}function qw(n){n.Q_=new _M({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),fc(n).start(),n.q_.v_()}function Kw(n){return _l(n)&&!fc(n).n_()&&n.N_.size>0}function _l(n){return ke(n).L_.size===0}function M9(n){n.Q_=void 0}async function _L(n){n.q_.set("Online")}async function yL(n){n.N_.forEach((e,t)=>{$w(n,e)})}async function vL(n,e){M9(n),Kw(n)?(n.q_.M_(e),qw(n)):n.q_.set("Unknown")}async function wL(n,e,t){if(n.q_.set("Online"),e instanceof E9&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const l of s.targetIds)i.N_.has(l)&&(await i.remoteSyncer.rejectListen(l,o),i.N_.delete(l),i.Q_.removeTarget(l))}(n,e)}catch(r){me("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await cm(n,r)}else if(e instanceof vg?n.Q_.Ke(e):e instanceof w9?n.Q_.He(e):n.Q_.We(e),!t.isEqual(Te.min()))try{const r=await N9(n.localStore);t.compareTo(r)>=0&&await function(s,o){const l=s.Q_.rt(o);return l.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){const p=s.N_.get(d);p&&s.N_.set(d,p.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,d)=>{const p=s.N_.get(c);if(!p)return;s.N_.set(c,p.withResumeToken(zn.EMPTY_BYTE_STRING,p.snapshotVersion)),b9(s,c);const _=new Do(p.target,c,d,p.sequenceNumber);$w(s,_)}),s.remoteSyncer.applyRemoteEvent(l)}(n,t)}catch(r){me("RemoteStore","Failed to raise snapshot:",r),await cm(n,r)}}async function cm(n,e,t){if(!ef(e))throw e;n.L_.add(1),await sf(n),n.q_.set("Offline"),t||(t=()=>N9(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{me("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await c0(n)})}function L9(n,e){return e().catch(t=>cm(n,t,e))}async function h0(n){const e=ke(n),t=Xo(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;EL(e);)try{const i=await iL(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,SL(e,i)}catch(i){await cm(e,i)}F9(e)&&V9(e)}function EL(n){return _l(n)&&n.O_.length<10}function SL(n,e){n.O_.push(e);const t=Xo(n);t.r_()&&t.V_&&t.m_(e.mutations)}function F9(n){return _l(n)&&!Xo(n).n_()&&n.O_.length>0}function V9(n){Xo(n).start()}async function TL(n){Xo(n).p_()}async function CL(n){const e=Xo(n);for(const t of n.O_)e.m_(t.mutations)}async function IL(n,e,t){const r=n.O_.shift(),i=Vw.from(r,e,t);await L9(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await h0(n)}async function PL(n,e){e&&Xo(n).V_&&await async function(r,i){if(function(o){return y9(o)&&o!==X.ABORTED}(i.code)){const s=r.O_.shift();Xo(r).s_(),await L9(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await h0(r)}}(n,e),F9(n)&&V9(n)}async function jC(n,e){const t=ke(n);t.asyncQueue.verifyOperationInProgress(),me("RemoteStore","RemoteStore received new credentials");const r=_l(t);t.L_.add(3),await sf(t),r&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await c0(t)}async function RL(n,e){const t=ke(n);e?(t.L_.delete(2),await c0(t)):e||(t.L_.add(2),await sf(t),t.q_.set("Unknown"))}function fc(n){return n.K_||(n.K_=function(t,r,i){const s=ke(t);return s.w_(),new dL(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:_L.bind(null,n),Ro:yL.bind(null,n),mo:vL.bind(null,n),d_:wL.bind(null,n)}),n.B_.push(async e=>{e?(n.K_.s_(),Kw(n)?qw(n):n.q_.set("Unknown")):(await n.K_.stop(),M9(n))})),n.K_}function Xo(n){return n.U_||(n.U_=function(t,r,i){const s=ke(t);return s.w_(),new fL(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:TL.bind(null,n),mo:PL.bind(null,n),f_:CL.bind(null,n),g_:IL.bind(null,n)}),n.B_.push(async e=>{e?(n.U_.s_(),await h0(n)):(await n.U_.stop(),n.O_.length>0&&(me("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))})),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qw{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Us,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const o=Date.now()+r,l=new Qw(e,t,o,i,s);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ue(X.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Yw(n,e){if(Ks("AsyncQueue",`${e}: ${n}`),ef(n))return new ue(X.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xu{constructor(e){this.comparator=e?(t,r)=>e(t,r)||ye.comparator(t.key,r.key):(t,r)=>ye.comparator(t.key,r.key),this.keyedMap=Ah(),this.sortedSet=new Zt(this.comparator)}static emptySet(e){return new xu(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof xu)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new xu;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GC{constructor(){this.W_=new Zt(ye.comparator)}track(e){const t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):we():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}}class Ku{constructor(e,t,r,i,s,o,l,c,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,s){const o=[];return t.forEach(l=>{o.push({type:0,doc:l})}),new Ku(e,t,xu.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&r0(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kL{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class AL{constructor(){this.queries=WC(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){const i=ke(t),s=i.queries;i.queries=WC(),s.forEach((o,l)=>{for(const c of l.j_)c.onError(r)})})(this,new ue(X.ABORTED,"Firestore shutting down"))}}function WC(){return new dc(n=>s9(n),r0)}async function U9(n,e){const t=ke(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new kL,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await t.onListen(i,!0);break;case 1:s.z_=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const l=Yw(o,`Initialization of query '${iu(e.query)}' failed`);return void e.onError(l)}t.queries.set(i,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&Xw(t)}async function z9(n,e){const t=ke(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function xL(n,e){const t=ke(n);let r=!1;for(const i of e){const s=i.query,o=t.queries.get(s);if(o){for(const l of o.j_)l.X_(i)&&(r=!0);o.z_=i}}r&&Xw(t)}function NL(n,e,t){const r=ke(n),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(t);r.queries.delete(e)}function Xw(n){n.Y_.forEach(e=>{e.next()})}var W1,HC;(HC=W1||(W1={})).ea="default",HC.Cache="cache";class B9{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Ku(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Ku.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==W1.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j9{constructor(e){this.key=e}}class G9{constructor(e){this.key=e}}class DL{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=He(),this.mutatedKeys=He(),this.Aa=o9(e),this.Ra=new xu(this.Aa)}get Va(){return this.Ta}ma(e,t){const r=t?t.fa:new GC,i=t?t.Ra:this.Ra;let s=t?t.mutatedKeys:this.mutatedKeys,o=i,l=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,_)=>{const m=i.get(p),S=i0(this.query,_)?_:null,E=!!m&&this.mutatedKeys.has(m.key),A=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let D=!1;m&&S?m.data.isEqual(S.data)?E!==A&&(r.track({type:3,doc:S}),D=!0):this.ga(m,S)||(r.track({type:2,doc:S}),D=!0,(c&&this.Aa(S,c)>0||d&&this.Aa(S,d)<0)&&(l=!0)):!m&&S?(r.track({type:0,doc:S}),D=!0):m&&!S&&(r.track({type:1,doc:m}),D=!0,(c||d)&&(l=!0)),D&&(S?(o=o.add(S),s=A?s.add(p):s.delete(p)):(o=o.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const p=this.query.limitType==="F"?o.last():o.first();o=o.delete(p.key),s=s.delete(p.key),r.track({type:1,doc:p})}return{Ra:o,fa:r,ns:l,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((p,_)=>function(S,E){const A=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return we()}};return A(S)-A(E)}(p.type,_.type)||this.Aa(p.doc,_.doc)),this.pa(r),i=i!=null&&i;const l=t&&!i?this.ya():[],c=this.da.size===0&&this.current&&!i?1:0,d=c!==this.Ea;return this.Ea=c,o.length!==0||d?{snapshot:new Ku(this.query,e.Ra,s,o,e.mutatedKeys,c===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new GC,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=He(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const t=[];return e.forEach(r=>{this.da.has(r)||t.push(new G9(r))}),this.da.forEach(r=>{e.has(r)||t.push(new j9(r))}),t}ba(e){this.Ta=e.Ts,this.da=He();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Ku.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class OL{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class bL{constructor(e){this.key=e,this.va=!1}}class ML{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new dc(l=>s9(l),r0),this.Ma=new Map,this.xa=new Set,this.Oa=new Zt(ye.comparator),this.Na=new Map,this.La=new Bw,this.Ba={},this.ka=new Map,this.qa=qu.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function LL(n,e,t=!0){const r=Q9(n);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await W9(r,e,t,!0),i}async function FL(n,e){const t=Q9(n);await W9(t,e,!0,!1)}async function W9(n,e,t,r){const i=await sL(n.localStore,rs(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t);let l;return r&&(l=await VL(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&O9(n.remoteStore,i),l}async function VL(n,e,t,r,i){n.Ka=(_,m,S)=>async function(A,D,k,R){let w=D.view.ma(k);w.ns&&(w=await UC(A.localStore,D.query,!1).then(({documents:N})=>D.view.ma(N,w)));const P=R&&R.targetChanges.get(D.targetId),V=R&&R.targetMismatches.get(D.targetId)!=null,U=D.view.applyChanges(w,A.isPrimaryClient,P,V);return qC(A,D.targetId,U.wa),U.snapshot}(n,_,m,S);const s=await UC(n.localStore,e,!0),o=new DL(e,s.Ts),l=o.ma(s.documents),c=rf.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=o.applyChanges(l,n.isPrimaryClient,c);qC(n,t,d.wa);const p=new OL(e,t,o);return n.Fa.set(e,p),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),d.snapshot}async function UL(n,e,t){const r=ke(n),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!r0(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await G1(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Hw(r.remoteStore,i.targetId),H1(r,i.targetId)}).catch(Zd)):(H1(r,i.targetId),await G1(r.localStore,i.targetId,!0))}async function zL(n,e){const t=ke(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Hw(t.remoteStore,r.targetId))}async function BL(n,e,t){const r=KL(n);try{const i=await function(o,l){const c=ke(o),d=un.now(),p=l.reduce((S,E)=>S.add(E.key),He());let _,m;return c.persistence.runTransaction("Locally write mutations","readwrite",S=>{let E=Qs(),A=He();return c.cs.getEntries(S,p).next(D=>{E=D,E.forEach((k,R)=>{R.isValidDocument()||(A=A.add(k))})}).next(()=>c.localDocuments.getOverlayedDocuments(S,E)).next(D=>{_=D;const k=[];for(const R of l){const w=hM(R,_.get(R.key).overlayedDocument);w!=null&&k.push(new la(R.key,w,XP(w.value.mapValue),er.exists(!0)))}return c.mutationQueue.addMutationBatch(S,d,k,l)}).next(D=>{m=D;const k=D.applyToLocalDocumentSet(_,A);return c.documentOverlayCache.saveOverlays(S,D.batchId,k)})}).then(()=>({batchId:m.batchId,changes:l9(_)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,l,c){let d=o.Ba[o.currentUser.toKey()];d||(d=new Zt(nt)),d=d.insert(l,c),o.Ba[o.currentUser.toKey()]=d}(r,i.batchId,t),await of(r,i.changes),await h0(r.remoteStore)}catch(i){const s=Yw(i,"Failed to persist write");t.reject(s)}}async function H9(n,e){const t=ke(n);try{const r=await nL(t.localStore,e);e.targetChanges.forEach((i,s)=>{const o=t.Na.get(s);o&&(Ze(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?Ze(o.va):i.removedDocuments.size>0&&(Ze(o.va),o.va=!1))}),await of(t,r,e)}catch(r){await Zd(r)}}function $C(n,e,t){const r=ke(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Fa.forEach((s,o)=>{const l=o.view.Z_(e);l.snapshot&&i.push(l.snapshot)}),function(o,l){const c=ke(o);c.onlineState=l;let d=!1;c.queries.forEach((p,_)=>{for(const m of _.j_)m.Z_(l)&&(d=!0)}),d&&Xw(c)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function jL(n,e,t){const r=ke(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Na.get(e),s=i&&i.key;if(s){let o=new Zt(ye.comparator);o=o.insert(s,Tn.newNoDocument(s,Te.min()));const l=He().add(s),c=new l0(Te.min(),new Map,new Zt(nt),o,l);await H9(r,c),r.Oa=r.Oa.remove(s),r.Na.delete(e),Jw(r)}else await G1(r.localStore,e,!1).then(()=>H1(r,e,t)).catch(Zd)}async function GL(n,e){const t=ke(n),r=e.batch.batchId;try{const i=await tL(t.localStore,e);q9(t,r,null),$9(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await of(t,i)}catch(i){await Zd(i)}}async function WL(n,e,t){const r=ke(n);try{const i=await function(o,l){const c=ke(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let p;return c.mutationQueue.lookupMutationBatch(d,l).next(_=>(Ze(_!==null),p=_.keys(),c.mutationQueue.removeMutationBatch(d,_))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,p,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p)).next(()=>c.localDocuments.getDocuments(d,p))})}(r.localStore,e);q9(r,e,t),$9(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await of(r,i)}catch(i){await Zd(i)}}function $9(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function q9(n,e,t){const r=ke(n);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function H1(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||K9(n,r)})}function K9(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(Hw(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),Jw(n))}function qC(n,e,t){for(const r of t)r instanceof j9?(n.La.addReference(r.key,e),HL(n,r)):r instanceof G9?(me("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||K9(n,r.key)):we()}function HL(n,e){const t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(me("SyncEngine","New document in limbo: "+t),n.xa.add(r),Jw(n))}function Jw(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new ye(yt.fromString(e)),r=n.qa.next();n.Na.set(r,new bL(t)),n.Oa=n.Oa.insert(t,r),O9(n.remoteStore,new Do(rs(Lw(t.path)),r,"TargetPurposeLimboResolution",xw.oe))}}async function of(n,e,t){const r=ke(n),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((l,c)=>{o.push(r.Ka(c,e,t).then(d=>{var p;if((d||t)&&r.isPrimaryClient){const _=d?!d.fromCache:(p=t==null?void 0:t.targetChanges.get(c.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(c.targetId,_?"current":"not-current")}if(d){i.push(d);const _=Gw.Wi(c.targetId,d);s.push(_)}}))}),await Promise.all(o),r.Ca.d_(i),await async function(c,d){const p=ke(c);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",_=>J.forEach(d,m=>J.forEach(m.$i,S=>p.persistence.referenceDelegate.addReference(_,m.targetId,S)).next(()=>J.forEach(m.Ui,S=>p.persistence.referenceDelegate.removeReference(_,m.targetId,S)))))}catch(_){if(!ef(_))throw _;me("LocalStore","Failed to update sequence numbers: "+_)}for(const _ of d){const m=_.targetId;if(!_.fromCache){const S=p.os.get(m),E=S.snapshotVersion,A=S.withLastLimboFreeSnapshotVersion(E);p.os=p.os.insert(m,A)}}}(r.localStore,s))}async function $L(n,e){const t=ke(n);if(!t.currentUser.isEqual(e)){me("SyncEngine","User change. New user:",e.toKey());const r=await x9(t.localStore,e);t.currentUser=e,function(s,o){s.ka.forEach(l=>{l.forEach(c=>{c.reject(new ue(X.CANCELLED,o))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await of(t,r.hs)}}function qL(n,e){const t=ke(n),r=t.Na.get(e);if(r&&r.va)return He().add(r.key);{let i=He();const s=t.Ma.get(e);if(!s)return i;for(const o of s){const l=t.Fa.get(o);i=i.unionWith(l.view.Va)}return i}}function Q9(n){const e=ke(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=H9.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=qL.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=jL.bind(null,e),e.Ca.d_=xL.bind(null,e.eventManager),e.Ca.$a=NL.bind(null,e.eventManager),e}function KL(n){const e=ke(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=GL.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=WL.bind(null,e),e}class hm{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=u0(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return eL(this.persistence,new JM,e.initialUser,this.serializer)}Ga(e){return new QM(jw.Zr,this.serializer)}Wa(e){return new aL}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}hm.provider={build:()=>new hm};class $1{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>$C(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=$L.bind(null,this.syncEngine),await RL(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new AL}()}createDatastore(e){const t=u0(e.databaseInfo.databaseId),r=function(s){return new hL(s)}(e.databaseInfo);return function(s,o,l,c){return new pL(s,o,l,c)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,o,l){return new mL(r,i,s,o,l)}(this.localStore,this.datastore,e.asyncQueue,t=>$C(this.syncEngine,t,0),function(){return BC.D()?new BC:new lL}())}createSyncEngine(e,t){return function(i,s,o,l,c,d,p){const _=new ML(i,s,o,l,c,d);return p&&(_.Qa=!0),_}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const s=ke(i);me("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await sf(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}$1.provider={build:()=>new $1};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y9{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Ks("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QL{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new ue(X.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(i,s){const o=ke(i),l={documents:s.map(_=>um(o.serializer,_))},c=await o.Lo("BatchGetDocuments",o.serializer.databaseId,yt.emptyPath(),l,s.length),d=new Map;c.forEach(_=>{const m=CM(o.serializer,_);d.set(m.key.toString(),m)});const p=[];return s.forEach(_=>{const m=d.get(_.toString());Ze(!!m),p.push(m)}),p}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new a0(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{const i=ye.fromPath(r);this.mutations.push(new _9(i,this.precondition(i)))}),await async function(r,i){const s=ke(r),o={writes:i.map(l=>P9(s.serializer,l))};await s.Mo("Commit",s.serializer.databaseId,yt.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw we();t=Te.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new ue(X.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Te.min())?er.exists(!1):er.updateTime(t):er.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Te.min()))throw new ue(X.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return er.updateTime(t)}return er.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YL{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this._u=r.maxAttempts,this.t_=new Ww(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new QL(this.datastore),t=this.cu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.lu(i)}))}).catch(r=>{this.lu(r)})})}cu(e){try{const t=this.updateFunction(e);return!tf(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!y9(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XL{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Jn.UNAUTHENTICATED,this.clientId=KP.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{me("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(me("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Us;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Yw(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function av(n,e){n.asyncQueue.verifyOperationInProgress(),me("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await x9(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function KC(n,e){n.asyncQueue.verifyOperationInProgress();const t=await JL(n);me("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>jC(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>jC(e.remoteStore,i)),n._onlineComponents=e}async function JL(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){me("FirestoreClient","Using user provided OfflineComponentProvider");try{await av(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===X.FAILED_PRECONDITION||i.code===X.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Gu("Error using user provided cache. Falling back to memory cache: "+t),await av(n,new hm)}}else me("FirestoreClient","Using default OfflineComponentProvider"),await av(n,new hm);return n._offlineComponents}async function Zw(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(me("FirestoreClient","Using user provided OnlineComponentProvider"),await KC(n,n._uninitializedComponentsProvider._online)):(me("FirestoreClient","Using default OnlineComponentProvider"),await KC(n,new $1))),n._onlineComponents}function ZL(n){return Zw(n).then(e=>e.syncEngine)}function eF(n){return Zw(n).then(e=>e.datastore)}async function q1(n){const e=await Zw(n),t=e.eventManager;return t.onListen=LL.bind(null,e.syncEngine),t.onUnlisten=UL.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=FL.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=zL.bind(null,e.syncEngine),t}function tF(n,e,t={}){const r=new Us;return n.asyncQueue.enqueueAndForget(async()=>function(s,o,l,c,d){const p=new Y9({next:m=>{p.Za(),o.enqueueAndForget(()=>z9(s,_)),m.fromCache&&c.source==="server"?d.reject(new ue(X.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),_=new B9(l,p,{includeMetadataChanges:!0,_a:!0});return U9(s,_)}(await q1(n),n.asyncQueue,e,t,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X9(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QC=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J9(n,e,t){if(!t)throw new ue(X.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function nF(n,e,t,r){if(e===!0&&r===!0)throw new ue(X.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function YC(n){if(!ye.isDocumentKey(n))throw new ue(X.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function XC(n){if(ye.isDocumentKey(n))throw new ue(X.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function d0(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":we()}function ii(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ue(X.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=d0(n);throw new ue(X.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JC{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ue(X.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ue(X.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}nF("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=X9((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new ue(X.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ue(X.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ue(X.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class f0{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new JC({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ue(X.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ue(X.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new JC(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new vb;switch(r.type){case"firstParty":return new Tb(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ue(X.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=QC.get(t);r&&(me("ComponentProvider","Removing Datastore"),QC.delete(t),r.terminate())}(this),Promise.resolve()}}function rF(n,e,t,r={}){var i;const s=(n=ii(n,f0))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Gu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let l,c;if(typeof r.mockUserToken=="string")l=r.mockUserToken,c=Jn.MOCK_USER;else{l=eP(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);const d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new ue(X.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Jn(d)}n._authCredentials=new wb(new qP(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ua{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new ua(this.firestore,e,this._query)}}class tr{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Wo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new tr(this.firestore,e,this._key)}}class Wo extends ua{constructor(e,t,r){super(e,t,Lw(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new tr(this.firestore,null,new ye(e))}withConverter(e){return new Wo(this.firestore,e,this._path)}}function af(n,e,...t){if(n=vt(n),J9("collection","path",e),n instanceof f0){const r=yt.fromString(e,...t);return XC(r),new Wo(n,null,r)}{if(!(n instanceof tr||n instanceof Wo))throw new ue(X.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(yt.fromString(e,...t));return XC(r),new Wo(n.firestore,null,r)}}function yl(n,e,...t){if(n=vt(n),arguments.length===1&&(e=KP.newId()),J9("doc","path",e),n instanceof f0){const r=yt.fromString(e,...t);return YC(r),new tr(n,null,new ye(r))}{if(!(n instanceof tr||n instanceof Wo))throw new ue(X.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(yt.fromString(e,...t));return YC(r),new tr(n.firestore,n instanceof Wo?n.converter:null,new ye(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZC{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Ww(this,"async_queue_retry"),this.Vu=()=>{const r=ov();r&&me("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const t=ov();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=ov();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new Us;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!ef(e))throw e;me("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(r);throw Ks("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const i=Qw.createAndSchedule(this,e,t,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&we()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function e3(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}class Jo extends f0{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new ZC,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new ZC(e),this._firestoreClient=void 0,await e}}}function iF(n,e){const t=typeof n=="object"?n:_w(),r=typeof n=="string"?n:"(default)",i=Zm(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=X6("firestore");s&&rF(i,...s)}return i}function p0(n){if(n._terminated)throw new ue(X.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||sF(n),n._firestoreClient}function sF(n){var e,t,r;const i=n._freezeSettings(),s=function(l,c,d,p){return new Lb(l,c,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,X9(p.experimentalLongPollingOptions),p.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new XL(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ll(zn.fromBase64String(e))}catch(t){throw new ue(X.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ll(zn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lf{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ue(X.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ln(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g0{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eE{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ue(X.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ue(X.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return nt(this._lat,e._lat)||nt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tE{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oF=/^__.*__$/;class aF{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new la(e,this.data,this.fieldMask,t,this.fieldTransforms):new nf(e,this.data,t,this.fieldTransforms)}}class Z9{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new la(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function eR(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw we()}}class nE{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new nE(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return dm(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(eR(this.Cu)&&oF.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class lF{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||u0(e)}Qu(e,t,r,i=!1){return new nE({Cu:e,methodName:t,qu:r,path:Ln.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function m0(n){const e=n._freezeSettings(),t=u0(n._databaseId);return new lF(n._databaseId,!!e.ignoreUndefinedProperties,t)}function tR(n,e,t,r,i,s={}){const o=n.Qu(s.merge||s.mergeFields?2:0,e,t,i);iE("Data must be an object, but it was:",o,r);const l=iR(r,o);let c,d;if(s.merge)c=new Vr(o.fieldMask),d=o.fieldTransforms;else if(s.mergeFields){const p=[];for(const _ of s.mergeFields){const m=K1(e,_,t);if(!o.contains(m))throw new ue(X.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);oR(p,m)||p.push(m)}c=new Vr(p),d=o.fieldTransforms.filter(_=>c.covers(_.field))}else c=null,d=o.fieldTransforms;return new aF(new dr(l),c,d)}class _0 extends g0{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof _0}}class rE extends g0{_toFieldTransform(e){return new aM(e.path,new Pd)}isEqual(e){return e instanceof rE}}function nR(n,e,t,r){const i=n.Qu(1,e,t);iE("Data must be an object, but it was:",i,r);const s=[],o=dr.empty();ml(r,(c,d)=>{const p=sE(e,c,t);d=vt(d);const _=i.Nu(p);if(d instanceof _0)s.push(p);else{const m=uf(d,_);m!=null&&(s.push(p),o.set(p,m))}});const l=new Vr(s);return new Z9(o,l,i.fieldTransforms)}function rR(n,e,t,r,i,s){const o=n.Qu(1,e,t),l=[K1(e,r,t)],c=[i];if(s.length%2!=0)throw new ue(X.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)l.push(K1(e,s[m])),c.push(s[m+1]);const d=[],p=dr.empty();for(let m=l.length-1;m>=0;--m)if(!oR(d,l[m])){const S=l[m];let E=c[m];E=vt(E);const A=o.Nu(S);if(E instanceof _0)d.push(S);else{const D=uf(E,A);D!=null&&(d.push(S),p.set(S,D))}}const _=new Vr(d);return new Z9(p,_,o.fieldTransforms)}function uF(n,e,t,r=!1){return uf(t,n.Qu(r?4:3,e))}function uf(n,e){if(sR(n=vt(n)))return iE("Unsupported field value:",e,n),iR(n,e);if(n instanceof g0)return function(r,i){if(!eR(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const l of r){let c=uf(l,i.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=vt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return iM(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=un.fromDate(r);return{timestampValue:lm(i.serializer,s)}}if(r instanceof un){const s=new un(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:lm(i.serializer,s)}}if(r instanceof eE)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ll)return{bytesValue:S9(i.serializer,r._byteString)};if(r instanceof tr){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:zw(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof tE)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return Fw(l.serializer,c)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${d0(r)}`)}(n,e)}function iR(n,e){const t={};return QP(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ml(n,(r,i)=>{const s=uf(i,e.Mu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function sR(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof un||n instanceof eE||n instanceof ll||n instanceof tr||n instanceof g0||n instanceof tE)}function iE(n,e,t){if(!sR(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const r=d0(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function K1(n,e,t){if((e=vt(e))instanceof lf)return e._internalPath;if(typeof e=="string")return sE(n,e);throw dm("Field path arguments must be of type string or ",n,!1,void 0,t)}const cF=new RegExp("[~\\*/\\[\\]]");function sE(n,e,t){if(e.search(cF)>=0)throw dm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new lf(...e.split("."))._internalPath}catch{throw dm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function dm(n,e,t,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new ue(X.INVALID_ARGUMENT,l+n+c)}function oR(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fm{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new tr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new hF(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(y0("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class hF extends fm{data(){return super.data()}}function y0(n,e){return typeof e=="string"?sE(n,e):e instanceof lf?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aR(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ue(X.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class oE{}class lR extends oE{}function uR(n,e,...t){let r=[];e instanceof oE&&r.push(e),r=r.concat(t),function(s){const o=s.filter(c=>c instanceof aE).length,l=s.filter(c=>c instanceof v0).length;if(o>1||o>0&&l>0)throw new ue(X.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class v0 extends lR{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new v0(e,t,r)}_apply(e){const t=this._parse(e);return cR(e._query,t),new ua(e.firestore,e.converter,V1(e._query,t))}_parse(e){const t=m0(e.firestore);return function(s,o,l,c,d,p,_){let m;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new ue(X.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){n3(_,p);const S=[];for(const E of _)S.push(t3(c,s,E));m={arrayValue:{values:S}}}else m=t3(c,s,_)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||n3(_,p),m=uF(l,o,_,p==="in"||p==="not-in");return Jt.create(d,p,m)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function dF(n,e,t){const r=e,i=y0("where",n);return v0._create(i,r,t)}class aE extends oE{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new aE(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Di.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i;const l=s.getFlattenedFilters();for(const c of l)cR(o,c),o=V1(o,c)}(e._query,t),new ua(e.firestore,e.converter,V1(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class lE extends lR{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new lE(e,t)}_apply(e){const t=function(i,s,o){if(i.startAt!==null)throw new ue(X.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new ue(X.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Id(s,o)}(e._query,this._field,this._direction);return new ua(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new hc(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}function fF(n,e="asc"){const t=e,r=y0("orderBy",n);return lE._create(r,t)}function t3(n,e,t){if(typeof(t=vt(t))=="string"){if(t==="")throw new ue(X.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!i9(e)&&t.indexOf("/")!==-1)throw new ue(X.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(yt.fromString(t));if(!ye.isDocumentKey(r))throw new ue(X.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return SC(n,new ye(r))}if(t instanceof tr)return SC(n,t._key);throw new ue(X.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${d0(t)}.`)}function n3(n,e){if(!Array.isArray(n)||n.length===0)throw new ue(X.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function cR(n,e){const t=function(i,s){for(const o of i)for(const l of o.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new ue(X.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ue(X.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class hR{convertValue(e,t="none"){switch(al(e)){case 0:return null;case 1:return e.booleanValue;case 2:return jt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ol(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw we()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return ml(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;const s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>jt(o.doubleValue));return new tE(s)}convertGeoPoint(e){return new eE(jt(e.latitude),jt(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Dw(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Sd(e));default:return null}}convertTimestamp(e){const t=Yo(e);return new un(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=yt.fromString(e);Ze(A9(r));const i=new Td(r.get(1),r.get(3)),s=new ye(r.popFirst(5));return i.isEqual(t)||Ks(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dR(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class pF extends hR{constructor(e){super(),this.firestore=e}convertBytes(e){return new ll(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new tr(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class uE extends fm{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new wg(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(y0("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class wg extends uE{data(e={}){return super.data(e)}}class fR{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new vu(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new wg(this._firestore,this._userDataWriter,r.key,r,new vu(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ue(X.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(l=>{const c=new wg(i._firestore,i._userDataWriter,l.doc.key,l.doc,new vu(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const c=new wg(i._firestore,i._userDataWriter,l.doc.key,l.doc,new vu(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,p=-1;return l.type!==0&&(d=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),p=o.indexOf(l.doc.key)),{type:gF(l.type),doc:c,oldIndex:d,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function gF(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return we()}}class w0 extends hR{constructor(e){super(),this.firestore=e}convertBytes(e){return new ll(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new tr(this.firestore,null,t)}}function cE(n){n=ii(n,ua);const e=ii(n.firestore,Jo),t=p0(e),r=new w0(e);return aR(n._query),tF(t,n._query).then(i=>new fR(e,r,n,i))}function mF(n,e,t){n=ii(n,tr);const r=ii(n.firestore,Jo),i=dR(n.converter,e,t);return hE(r,[tR(m0(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,er.none())])}function pR(n,e,t,...r){n=ii(n,tr);const i=ii(n.firestore,Jo),s=m0(i);let o;return o=typeof(e=vt(e))=="string"||e instanceof lf?rR(s,"updateDoc",n._key,e,t,r):nR(s,"updateDoc",n._key,e),hE(i,[o.toMutation(n._key,er.exists(!0))])}function _F(n){return hE(ii(n.firestore,Jo),[new a0(n._key,er.none())])}function yF(n,...e){var t,r,i;n=vt(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||e3(e[o])||(s=e[o],o++);const l={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(e3(e[o])){const _=e[o];e[o]=(t=_.next)===null||t===void 0?void 0:t.bind(_),e[o+1]=(r=_.error)===null||r===void 0?void 0:r.bind(_),e[o+2]=(i=_.complete)===null||i===void 0?void 0:i.bind(_)}let c,d,p;if(n instanceof tr)d=ii(n.firestore,Jo),p=Lw(n._key.path),c={next:_=>{e[o]&&e[o](vF(d,n,_))},error:e[o+1],complete:e[o+2]};else{const _=ii(n,ua);d=ii(_.firestore,Jo),p=_._query;const m=new w0(d);c={next:S=>{e[o]&&e[o](new fR(d,m,_,S))},error:e[o+1],complete:e[o+2]},aR(n._query)}return function(m,S,E,A){const D=new Y9(A),k=new B9(S,D,E);return m.asyncQueue.enqueueAndForget(async()=>U9(await q1(m),k)),()=>{D.Za(),m.asyncQueue.enqueueAndForget(async()=>z9(await q1(m),k))}}(p0(d),p,l,c)}function hE(n,e){return function(r,i){const s=new Us;return r.asyncQueue.enqueueAndForget(async()=>BL(await ZL(r),i,s)),s.promise}(p0(n),e)}function vF(n,e,t){const r=t.docs.get(e._key),i=new w0(n);return new uE(n,i,e._key,r,new vu(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wF={maxAttempts:5};function ph(n,e){if((n=vt(n)).firestore!==e)throw new ue(X.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EF extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=m0(t)}get(t){const r=ph(t,this._firestore),i=new pF(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return we();const o=s[0];if(o.isFoundDocument())return new fm(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new fm(this._firestore,i,r._key,null,r.converter);throw we()})}set(t,r,i){const s=ph(t,this._firestore),o=dR(s.converter,r,i),l=tR(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,l),this}update(t,r,i,...s){const o=ph(t,this._firestore);let l;return l=typeof(r=vt(r))=="string"||r instanceof lf?rR(this._dataReader,"Transaction.update",o._key,r,i,s):nR(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,l),this}delete(t){const r=ph(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=ph(e,this._firestore),r=new w0(this._firestore);return super.get(e).then(i=>new uE(this._firestore,r,t._key,i._document,new vu(!1,!1),t.converter))}}function dE(n,e,t){n=ii(n,Jo);const r=Object.assign(Object.assign({},wF),t);return function(s){if(s.maxAttempts<1)throw new ue(X.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,l){const c=new Us;return s.asyncQueue.enqueueAndForget(async()=>{const d=await eF(s);new YL(s.asyncQueue,d,l,o,c).au()}),c.promise}(p0(n),i=>e(new EF(n,i)),r)}function Qu(){return new rE("serverTimestamp")}(function(e,t=!0){(function(i){cc=i})(gl),nl(new Ko("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),l=new Jo(new Eb(r.getProvider("auth-internal")),new Ib(r.getProvider("app-check-internal")),function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new ue(X.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Td(d.options.projectId,p)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),ts(_C,"4.7.3",e),ts(_C,"4.7.3","esm2017")})();var r3={};const i3="@firebase/database",s3="1.0.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gR="";function SF(n){gR=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TF{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Cn(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:_d(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CF{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return ss(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mR=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new TF(e)}}catch{}return new CF},$a=mR("localStorage"),IF=mR("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nu=new Jm("@firebase/database"),PF=function(){let n=1;return function(){return n++}}(),_R=function(n){const e=QN(n),t=new HN;t.update(e);const r=t.digest();return pw.encodeByteArray(r)},cf=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=cf.apply(null,r):typeof r=="object"?e+=Cn(r):e+=r,e+=" "}return e};let Qh=null,o3=!0;const RF=function(n,e){ie(!0,"Can't turn on custom loggers persistently."),Nu.logLevel=We.VERBOSE,Qh=Nu.log.bind(Nu)},Mn=function(...n){if(o3===!0&&(o3=!1,Qh===null&&IF.get("logging_enabled")===!0&&RF()),Qh){const e=cf.apply(null,n);Qh(e)}},hf=function(n){return function(...e){Mn(n,...e)}},Q1=function(...n){const e="FIREBASE INTERNAL ERROR: "+cf(...n);Nu.error(e)},Ys=function(...n){const e=`FIREBASE FATAL ERROR: ${cf(...n)}`;throw Nu.error(e),new Error(e)},Dr=function(...n){const e="FIREBASE WARNING: "+cf(...n);Nu.warn(e)},kF=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Dr("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},E0=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},AF=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Yu="[MIN_NAME]",ul="[MAX_NAME]",vl=function(n,e){if(n===e)return 0;if(n===Yu||e===ul)return-1;if(e===Yu||n===ul)return 1;{const t=a3(n),r=a3(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},xF=function(n,e){return n===e?0:n<e?-1:1},gh=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+Cn(e))},fE=function(n){if(typeof n!="object"||n===null)return Cn(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=Cn(e[r]),t+=":",t+=fE(n[e[r]]);return t+="}",t},yR=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function ir(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const vR=function(n){ie(!E0(n),"Invalid JSON number");const e=11,t=52,r=(1<<e-1)-1;let i,s,o,l,c;n===0?(s=0,o=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(l=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=l+r,o=Math.round(n*Math.pow(2,t-l)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-r-t))));const d=[];for(c=t;c;c-=1)d.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)d.push(s%2?1:0),s=Math.floor(s/2);d.push(i?1:0),d.reverse();const p=d.join("");let _="";for(c=0;c<64;c+=8){let m=parseInt(p.substr(c,8),2).toString(16);m.length===1&&(m="0"+m),_=_+m}return _.toLowerCase()},NF=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},DF=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function OF(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");const r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}const bF=new RegExp("^-?(0*)\\d{1,10}$"),MF=-2147483648,LF=2147483647,a3=function(n){if(bF.test(n)){const e=Number(n);if(e>=MF&&e<=LF)return e}return null},pc=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw Dr("Exception was thrown by user callback.",t),e},Math.floor(0))}},FF=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Yh=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VF{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Dr(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UF{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(Mn("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Dr(e)}}class Eg{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Eg.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pE="5",wR="v",ER="s",SR="r",TR="f",CR=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,IR="ls",PR="p",Y1="ac",RR="websocket",kR="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AR{constructor(e,t,r,i,s=!1,o="",l=!1,c=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=l,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=$a.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&$a.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function zF(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function xR(n,e,t){ie(typeof e=="string","typeof type must == string"),ie(typeof t=="object","typeof params must == object");let r;if(e===RR)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===kR)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);zF(n)&&(t.ns=n.namespace);const i=[];return ir(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BF{constructor(){this.counters_={}}incrementCounter(e,t=1){ss(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return PN(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lv={},uv={};function gE(n){const e=n.toString();return lv[e]||(lv[e]=new BF),lv[e]}function jF(n,e){const t=n.toString();return uv[t]||(uv[t]=e()),uv[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GF{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&pc(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l3="start",WF="close",HF="pLPCommand",$F="pRTLPCB",NR="id",DR="pw",OR="ser",qF="cb",KF="seg",QF="ts",YF="d",XF="dframe",bR=1870,MR=30,JF=bR-MR,ZF=25e3,eV=3e4;class wu{constructor(e,t,r,i,s,o,l){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=l,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=hf(e),this.stats_=gE(t),this.urlFn=c=>(this.appCheckToken&&(c[Y1]=this.appCheckToken),xR(t,kR,c))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new GF(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(eV)),AF(()=>{if(this.isClosed_)return;this.scriptTagHolder=new mE((...s)=>{const[o,l,c,d,p]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===l3)this.id=l,this.password=c;else if(o===WF)l?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(l,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{const[o,l]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,l)},()=>{this.onClosed_()},this.urlFn);const r={};r[l3]="t",r[OR]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[qF]=this.scriptTagHolder.uniqueCallbackIdentifier),r[wR]=pE,this.transportSessionId&&(r[ER]=this.transportSessionId),this.lastSessionId&&(r[IR]=this.lastSessionId),this.applicationId&&(r[PR]=this.applicationId),this.appCheckToken&&(r[Y1]=this.appCheckToken),typeof location<"u"&&location.hostname&&CR.test(location.hostname)&&(r[SR]=TR);const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){wu.forceAllow_=!0}static forceDisallow(){wu.forceDisallow_=!0}static isAvailable(){return wu.forceAllow_?!0:!wu.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!NF()&&!DF()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=Cn(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=K6(t),i=yR(r,JF);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const r={};r[XF]="t",r[NR]=e,r[DR]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=Cn(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class mE{constructor(e,t,r,i){this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=PF(),window[HF+this.uniqueCallbackIdentifier]=e,window[$F+this.uniqueCallbackIdentifier]=t,this.myIFrame=mE.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(l){Mn("frame writing exception"),l.stack&&Mn(l.stack),Mn(l)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Mn("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[NR]=this.myID,e[DR]=this.myPW,e[OR]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+MR+r.length<=bR;){const o=this.pendingSegs.shift();r=r+"&"+KF+i+"="+o.seg+"&"+QF+i+"="+o.ts+"&"+YF+i+"="+o.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(ZF)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{Mn("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tV=16384,nV=45e3;let pm=null;typeof MozWebSocket<"u"?pm=MozWebSocket:typeof WebSocket<"u"&&(pm=WebSocket);class Ti{constructor(e,t,r,i,s,o,l){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=hf(this.connId),this.stats_=gE(t),this.connURL=Ti.connectionURL_(t,o,l,i,r),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,r,i,s){const o={};return o[wR]=pE,typeof location<"u"&&location.hostname&&CR.test(location.hostname)&&(o[SR]=TR),t&&(o[ER]=t),r&&(o[IR]=r),i&&(o[Y1]=i),s&&(o[PR]=s),xR(e,RR,o)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,$a.set("previous_websocket_failure",!0);try{let r;LN(),this.mySock=new pm(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){Ti.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(t);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&pm!==null&&!Ti.forceDisallow_}static previouslyFailed(){return $a.isInMemoryStorage||$a.get("previous_websocket_failure")===!0}markConnectionHealthy(){$a.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const r=_d(t);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(ie(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const r=this.extractFrameCount_(t);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const t=Cn(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=yR(t,tV);r.length>1&&this.sendString_(String(r.length));for(let i=0;i<r.length;i++)this.sendString_(r[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(nV))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Ti.responsesRequiredToBeHealthy=2;Ti.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ad{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[wu,Ti]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=Ti&&Ti.isAvailable();let r=t&&!Ti.previouslyFailed();if(e.webSocketOnly&&(t||Dr("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[Ti];else{const i=this.transports_=[];for(const s of Ad.ALL_TRANSPORTS)s&&s.isAvailable()&&i.push(s);Ad.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Ad.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rV=6e4,iV=5e3,sV=10*1024,oV=100*1024,cv="t",u3="d",aV="s",c3="r",lV="e",h3="o",d3="a",f3="n",p3="p",uV="h";class cV{constructor(e,t,r,i,s,o,l,c,d,p){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=l,this.onDisconnect_=c,this.onKill_=d,this.lastSessionId=p,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=hf("c:"+this.id+":"),this.transportManager_=new Ad(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Yh(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>oV?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>sV?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(cv in e){const t=e[cv];t===d3?this.upgradeIfSecondaryHealthy_():t===c3?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===h3&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=gh("t",e),r=gh("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:p3,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:d3,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:f3,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=gh("t",e),r=gh("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=gh(cv,e);if(u3 in e){const r=e[u3];if(t===uV){const i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===f3){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===aV?this.onConnectionShutdown_(r):t===c3?this.onReset_(r):t===lV?Q1("Server Error: "+r):t===h3?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Q1("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),pE!==r&&Dr("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),Yh(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(rV))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Yh(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(iV))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:p3,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&($a.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LR{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FR{constructor(e){this.allowedEvents_=e,this.listeners_={},ie(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){ie(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gm extends FR{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!gw()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new gm}getInitialEvent(e){return ie(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g3=32,m3=768;let ct=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function it(){return new ct("")}function Me(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Zo(n){return n.pieces_.length-n.pieceNum_}function _t(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new ct(n.pieces_,e)}function _E(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function hV(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function xd(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function VR(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new ct(e,0)}function Wt(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof ct)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new ct(t,0)}function Fe(n){return n.pieceNum_>=n.pieces_.length}function Rr(n,e){const t=Me(n),r=Me(e);if(t===null)return e;if(t===r)return Rr(_t(n),_t(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function dV(n,e){const t=xd(n,0),r=xd(e,0);for(let i=0;i<t.length&&i<r.length;i++){const s=vl(t[i],r[i]);if(s!==0)return s}return t.length===r.length?0:t.length<r.length?-1:1}function yE(n,e){if(Zo(n)!==Zo(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function ni(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(Zo(n)>Zo(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class fV{constructor(e,t){this.errorPrefix_=t,this.parts_=xd(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Xm(this.parts_[r]);UR(this)}}function pV(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Xm(e),UR(n)}function gV(n){const e=n.parts_.pop();n.byteLength_-=Xm(e),n.parts_.length>0&&(n.byteLength_-=1)}function UR(n){if(n.byteLength_>m3)throw new Error(n.errorPrefix_+"has a key path longer than "+m3+" bytes ("+n.byteLength_+").");if(n.parts_.length>g3)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+g3+") or object contains a cycle "+Ua(n))}function Ua(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vE extends FR{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new vE}getInitialEvent(e){return ie(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mh=1e3,mV=60*5*1e3,_3=30*1e3,_V=1.3,yV=3e4,vV="server_kill",y3=3;class zs extends LR{constructor(e,t,r,i,s,o,l,c){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=r,this.onConnectStatus_=i,this.onServerInfoUpdate_=s,this.authTokenProvider_=o,this.appCheckTokenProvider_=l,this.authOverride_=c,this.id=zs.nextPersistentConnectionId_++,this.log_=hf("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=mh,this.maxReconnectDelay_=mV,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");vE.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&gm.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,r){const i=++this.requestNumber_,s={r:i,a:e,b:t};this.log_(Cn(s)),ie(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),r&&(this.requestCBHash_[i]=r)}get(e){this.initConnection_();const t=new As,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const l=o.d;o.s==="ok"?t.resolve(l):t.reject(l)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),t.promise}listen(e,t,r,i){this.initConnection_();const s=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+s),this.listens.has(o)||this.listens.set(o,new Map),ie(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),ie(!this.listens.get(o).has(s),"listen() called twice for same path/queryId.");const l={onComplete:i,hashFn:t,query:e,tag:r};this.listens.get(o).set(s,l),this.connected_&&this.sendListen_(l)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(r)})}sendListen_(e){const t=e.query,r=t._path.toString(),i=t._queryIdentifier;this.log_("Listen on "+r+" for "+i);const s={p:r},o="q";e.tag&&(s.q=t._queryObject,s.t=e.tag),s.h=e.hashFn(),this.sendRequest(o,s,l=>{const c=l.d,d=l.s;zs.warnOnListenWarnings_(c,t),(this.listens.get(r)&&this.listens.get(r).get(i))===e&&(this.log_("listen response",l),d!=="ok"&&this.removeListen_(r,i),e.onComplete&&e.onComplete(d,c))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&ss(e,"w")){const r=Bu(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const i='".indexOn": "'+t._queryParams.getIndex().toString()+'"',s=t._path.toString();Dr(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||WN(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=_3)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=GN(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(t,r,i=>{const s=i.s,o=i.d||"error";this.authToken_===e&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,r=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,r)})}unlisten(e,t){const r=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+i),ie(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,i)&&this.connected_&&this.sendUnlisten_(r,i,e._queryObject,t)}sendUnlisten_(e,t,r,i){this.log_("Unlisten on "+e+" for "+t);const s={p:e},o="n";i&&(s.q=r,s.t=i),this.sendRequest(o,s)}onDisconnectPut(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:r})}onDisconnectMerge(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:r})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,r,i){const s={p:t,d:r};this.log_("onDisconnect "+e,s),this.sendRequest(e,s,o=>{i&&setTimeout(()=>{i(o.s,o.d)},Math.floor(0))})}put(e,t,r,i){this.putInternal("p",e,t,r,i)}merge(e,t,r,i){this.putInternal("m",e,t,r,i)}putInternal(e,t,r,i,s){this.initConnection_();const o={p:t,d:r};s!==void 0&&(o.h=s),this.outstandingPuts_.push({action:e,request:o,onComplete:i}),this.outstandingPutCount_++;const l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,r,s=>{this.log_(t+" response",s),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(s.s,s.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,r=>{if(r.s!=="ok"){const s=r.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Cn(e));const t=e.r,r=this.requestCBHash_[t];r&&(delete this.requestCBHash_[t],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):Q1("Unrecognized action received from server: "+Cn(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){ie(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=mh,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=mh,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>yV&&(this.reconnectDelay_=mh),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*_V)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+zs.nextConnectionId_++,s=this.lastSessionId;let o=!1,l=null;const c=function(){l?l.close():(o=!0,r())},d=function(_){ie(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(_)};this.realtime_={close:c,sendRequest:d};const p=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[_,m]=await Promise.all([this.authTokenProvider_.getToken(p),this.appCheckTokenProvider_.getToken(p)]);o?Mn("getToken() completed but was canceled"):(Mn("getToken() completed. Creating connection."),this.authToken_=_&&_.accessToken,this.appCheckToken_=m&&m.token,l=new cV(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,r,S=>{Dr(S+" ("+this.repoInfo_.toString()+")"),this.interrupt(vV)},s))}catch(_){this.log_("Failed to get token: "+_),o||(this.repoInfo_.nodeAdmin&&Dr(_),c())}}}interrupt(e){Mn("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Mn("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Yg(this.interruptReasons_)&&(this.reconnectDelay_=mh,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let r;t?r=t.map(s=>fE(s)).join("$"):r="default";const i=this.removeListen_(e,r);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,t){const r=new ct(e).toString();let i;if(this.listens.has(r)){const s=this.listens.get(r);i=s.get(t),s.delete(t),s.size===0&&this.listens.delete(r)}else i=void 0;return i}onAuthRevoked_(e,t){Mn("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=y3&&(this.reconnectDelay_=_3,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Mn("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=y3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+gR.replace(/\./g,"-")]=1,gw()?e["framework.cordova"]=1:tP()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=gm.getInstance().currentlyOnline();return Yg(this.interruptReasons_)&&e}}zs.nextPersistentConnectionId_=0;zs.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Ve(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S0{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new Ve(Yu,e),i=new Ve(Yu,t);return this.compare(r,i)!==0}minPost(){return Ve.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $p;class zR extends S0{static get __EMPTY_NODE(){return $p}static set __EMPTY_NODE(e){$p=e}compare(e,t){return vl(e.name,t.name)}isDefinedOn(e){throw ac("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Ve.MIN}maxPost(){return new Ve(ul,$p)}makePost(e,t){return ie(typeof e=="string","KeyIndex indexValue must always be a string."),new Ve(e,$p)}toString(){return".key"}}const Du=new zR;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qp{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Sn{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??Sn.RED,this.left=i??kr.EMPTY_NODE,this.right=s??kr.EMPTY_NODE}copy(e,t,r,i,s){return new Sn(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return s<0?i=i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i=i.copy(null,t,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return kr.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let r,i;if(r=this,t(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),t(e,r.key)===0){if(r.right.isEmpty())return kr.EMPTY_NODE;i=r.right.min_(),r=r.copy(i.key,i.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Sn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Sn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Sn.RED=!0;Sn.BLACK=!1;class wV{copy(e,t,r,i,s){return this}insert(e,t,r){return new Sn(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class kr{constructor(e,t=kr.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new kr(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Sn.BLACK,null,null))}remove(e){return new kr(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Sn.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new qp(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new qp(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new qp(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new qp(this.root_,null,this.comparator_,!0,e)}}kr.EMPTY_NODE=new wV;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EV(n,e){return vl(n.name,e.name)}function wE(n,e){return vl(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let X1;function SV(n){X1=n}const BR=function(n){return typeof n=="number"?"number:"+vR(n):"string:"+n},jR=function(n){if(n.isLeafNode()){const e=n.val();ie(typeof e=="string"||typeof e=="number"||typeof e=="object"&&ss(e,".sv"),"Priority must be a string or number.")}else ie(n===X1||n.isEmpty(),"priority of unexpected type.");ie(n===X1||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let v3;class yn{constructor(e,t=yn.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,ie(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),jR(this.priorityNode_)}static set __childrenNodeConstructor(e){v3=e}static get __childrenNodeConstructor(){return v3}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new yn(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:yn.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Fe(e)?this:Me(e)===".priority"?this.priorityNode_:yn.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:yn.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const r=Me(e);return r===null?t:t.isEmpty()&&r!==".priority"?this:(ie(r!==".priority"||Zo(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,yn.__childrenNodeConstructor.EMPTY_NODE.updateChild(_t(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+BR(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=vR(this.value_):e+=this.value_,this.lazyHash_=_R(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===yn.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof yn.__childrenNodeConstructor?-1:(ie(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,r=typeof this.value_,i=yn.VALUE_TYPE_ORDER.indexOf(t),s=yn.VALUE_TYPE_ORDER.indexOf(r);return ie(i>=0,"Unknown leaf type: "+t),ie(s>=0,"Unknown leaf type: "+r),i===s?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}yn.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let GR,WR;function TV(n){GR=n}function CV(n){WR=n}class IV extends S0{compare(e,t){const r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return s===0?vl(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Ve.MIN}maxPost(){return new Ve(ul,new yn("[PRIORITY-POST]",WR))}makePost(e,t){const r=GR(e);return new Ve(t,new yn("[PRIORITY-POST]",r))}toString(){return".priority"}}const Ot=new IV;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PV=Math.log(2);class RV{constructor(e){const t=s=>parseInt(Math.log(s)/PV,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const mm=function(n,e,t,r){n.sort(e);const i=function(c,d){const p=d-c;let _,m;if(p===0)return null;if(p===1)return _=n[c],m=t?t(_):_,new Sn(m,_.node,Sn.BLACK,null,null);{const S=parseInt(p/2,10)+c,E=i(c,S),A=i(S+1,d);return _=n[S],m=t?t(_):_,new Sn(m,_.node,Sn.BLACK,E,A)}},s=function(c){let d=null,p=null,_=n.length;const m=function(E,A){const D=_-E,k=_;_-=E;const R=i(D+1,k),w=n[D],P=t?t(w):w;S(new Sn(P,w.node,A,null,R))},S=function(E){d?(d.left=E,d=E):(p=E,d=E)};for(let E=0;E<c.count;++E){const A=c.nextBitIsOne(),D=Math.pow(2,c.count-(E+1));A?m(D,Sn.BLACK):(m(D,Sn.BLACK),m(D,Sn.RED))}return p},o=new RV(n.length),l=s(o);return new kr(r||e,l)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hv;const Zl={};class Ls{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return ie(Zl&&Ot,"ChildrenNode.ts has not been loaded"),hv=hv||new Ls({".priority":Zl},{".priority":Ot}),hv}get(e){const t=Bu(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof kr?t:null}hasIndex(e){return ss(this.indexSet_,e.toString())}addIndex(e,t){ie(e!==Du,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const s=t.getIterator(Ve.Wrap);let o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let l;i?l=mm(r,e.getCompare()):l=Zl;const c=e.toString(),d=Object.assign({},this.indexSet_);d[c]=e;const p=Object.assign({},this.indexes_);return p[c]=l,new Ls(p,d)}addToIndexes(e,t){const r=Xg(this.indexes_,(i,s)=>{const o=Bu(this.indexSet_,s);if(ie(o,"Missing index implementation for "+s),i===Zl)if(o.isDefinedOn(e.node)){const l=[],c=t.getIterator(Ve.Wrap);let d=c.getNext();for(;d;)d.name!==e.name&&l.push(d),d=c.getNext();return l.push(e),mm(l,o.getCompare())}else return Zl;else{const l=t.get(e.name);let c=i;return l&&(c=c.remove(new Ve(e.name,l))),c.insert(e,e.node)}});return new Ls(r,this.indexSet_)}removeFromIndexes(e,t){const r=Xg(this.indexes_,i=>{if(i===Zl)return i;{const s=t.get(e.name);return s?i.remove(new Ve(e.name,s)):i}});return new Ls(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _h;class Ie{constructor(e,t,r){this.children_=e,this.priorityNode_=t,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&jR(this.priorityNode_),this.children_.isEmpty()&&ie(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return _h||(_h=new Ie(new kr(wE),null,Ls.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||_h}updatePriority(e){return this.children_.isEmpty()?this:new Ie(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?_h:t}}getChild(e){const t=Me(e);return t===null?this:this.getImmediateChild(t).getChild(_t(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(ie(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const r=new Ve(e,t);let i,s;t.isEmpty()?(i=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,t),s=this.indexMap_.addToIndexes(r,this.children_));const o=i.isEmpty()?_h:this.priorityNode_;return new Ie(i,o,s)}}updateChild(e,t){const r=Me(e);if(r===null)return t;{ie(Me(e)!==".priority"||Zo(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(r).updateChild(_t(e),t);return this.updateImmediateChild(r,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let r=0,i=0,s=!0;if(this.forEachChild(Ot,(o,l)=>{t[o]=l.val(e),r++,s&&Ie.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):s=!1}),!e&&s&&i<2*r){const o=[];for(const l in t)o[l]=t[l];return o}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+BR(this.getPriority().val())+":"),this.forEachChild(Ot,(t,r)=>{const i=r.hash();i!==""&&(e+=":"+t+":"+i)}),this.lazyHash_=e===""?"":_R(e)}return this.lazyHash_}getPredecessorChildName(e,t,r){const i=this.resolveIndex_(r);if(i){const s=i.getPredecessorKey(new Ve(e,t));return s?s.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const r=t.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Ve(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const r=t.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Ve(t,this.children_.get(t)):null}forEachChild(e,t){const r=this.resolveIndex_(e);return r?r.inorderTraversal(i=>t(i.name,i.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const r=this.resolveIndex_(t);if(r)return r.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,Ve.Wrap);let s=i.peek();for(;s!=null&&t.compare(s,e)<0;)i.getNext(),s=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const r=this.resolveIndex_(t);if(r)return r.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,Ve.Wrap);let s=i.peek();for(;s!=null&&t.compare(s,e)>0;)i.getNext(),s=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===df?-1:0}withIndex(e){if(e===Du||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new Ie(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Du||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const r=this.getIterator(Ot),i=t.getIterator(Ot);let s=r.getNext(),o=i.getNext();for(;s&&o;){if(s.name!==o.name||!s.node.equals(o.node))return!1;s=r.getNext(),o=i.getNext()}return s===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===Du?null:this.indexMap_.get(e.toString())}}Ie.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class kV extends Ie{constructor(){super(new kr(wE),Ie.EMPTY_NODE,Ls.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Ie.EMPTY_NODE}isEmpty(){return!1}}const df=new kV;Object.defineProperties(Ve,{MIN:{value:new Ve(Yu,Ie.EMPTY_NODE)},MAX:{value:new Ve(ul,df)}});zR.__EMPTY_NODE=Ie.EMPTY_NODE;yn.__childrenNodeConstructor=Ie;SV(df);CV(df);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AV=!0;function Yt(n,e=null){if(n===null)return Ie.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),ie(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new yn(t,Yt(e))}if(!(n instanceof Array)&&AV){const t=[];let r=!1;if(ir(n,(o,l)=>{if(o.substring(0,1)!=="."){const c=Yt(l);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),t.push(new Ve(o,c)))}}),t.length===0)return Ie.EMPTY_NODE;const s=mm(t,EV,o=>o.name,wE);if(r){const o=mm(t,Ot.getCompare());return new Ie(s,Yt(e),new Ls({".priority":o},{".priority":Ot}))}else return new Ie(s,Yt(e),Ls.Default)}else{let t=Ie.EMPTY_NODE;return ir(n,(r,i)=>{if(ss(n,r)&&r.substring(0,1)!=="."){const s=Yt(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(Yt(e))}}TV(Yt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xV extends S0{constructor(e){super(),this.indexPath_=e,ie(!Fe(e)&&Me(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return s===0?vl(e.name,t.name):s}makePost(e,t){const r=Yt(e),i=Ie.EMPTY_NODE.updateChild(this.indexPath_,r);return new Ve(t,i)}maxPost(){const e=Ie.EMPTY_NODE.updateChild(this.indexPath_,df);return new Ve(ul,e)}toString(){return xd(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NV extends S0{compare(e,t){const r=e.node.compareTo(t.node);return r===0?vl(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Ve.MIN}maxPost(){return Ve.MAX}makePost(e,t){const r=Yt(e);return new Ve(t,r)}toString(){return".value"}}const DV=new NV;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HR(n){return{type:"value",snapshotNode:n}}function Xu(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Nd(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function Dd(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function OV(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EE{constructor(e){this.index_=e}updateChild(e,t,r,i,s,o){ie(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const l=e.getImmediateChild(t);return l.getChild(i).equals(r.getChild(i))&&l.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(t)?o.trackChildChange(Nd(t,l)):ie(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):l.isEmpty()?o.trackChildChange(Xu(t,r)):o.trackChildChange(Dd(t,r,l))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Ot,(i,s)=>{t.hasChild(i)||r.trackChildChange(Nd(i,s))}),t.isLeafNode()||t.forEachChild(Ot,(i,s)=>{if(e.hasChild(i)){const o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(Dd(i,s,o))}else r.trackChildChange(Xu(i,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?Ie.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od{constructor(e){this.indexedFilter_=new EE(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Od.getStartPost_(e),this.endPost_=Od.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,s,o){return this.matches(new Ve(t,r))||(r=Ie.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,s,o)}updateFullNode(e,t,r){t.isLeafNode()&&(t=Ie.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(Ie.EMPTY_NODE);const s=this;return t.forEachChild(Ot,(o,l)=>{s.matches(new Ve(o,l))||(i=i.updateImmediateChild(o,Ie.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bV{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{const r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Od(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,s,o){return this.rangedFilter_.matches(new Ve(t,r))||(r=Ie.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,s,o):this.fullLimitUpdateChild_(e,t,r,s,o)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=Ie.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){i=Ie.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){const l=s.getNext();if(this.withinDirectionalStart(l))if(this.withinDirectionalEnd(l))i=i.updateImmediateChild(l.name,l.node),o++;else break;else continue}}else{i=t.withIndex(this.index_),i=i.updatePriority(Ie.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){const l=s.getNext();o<this.limit_&&this.withinDirectionalStart(l)&&this.withinDirectionalEnd(l)?o++:i=i.updateImmediateChild(l.name,Ie.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,s){let o;if(this.reverse_){const _=this.index_.getCompare();o=(m,S)=>_(S,m)}else o=this.index_.getCompare();const l=e;ie(l.numChildren()===this.limit_,"");const c=new Ve(t,r),d=this.reverse_?l.getFirstChild(this.index_):l.getLastChild(this.index_),p=this.rangedFilter_.matches(c);if(l.hasChild(t)){const _=l.getImmediateChild(t);let m=i.getChildAfterChild(this.index_,d,this.reverse_);for(;m!=null&&(m.name===t||l.hasChild(m.name));)m=i.getChildAfterChild(this.index_,m,this.reverse_);const S=m==null?1:o(m,c);if(p&&!r.isEmpty()&&S>=0)return s!=null&&s.trackChildChange(Dd(t,r,_)),l.updateImmediateChild(t,r);{s!=null&&s.trackChildChange(Nd(t,_));const A=l.updateImmediateChild(t,Ie.EMPTY_NODE);return m!=null&&this.rangedFilter_.matches(m)?(s!=null&&s.trackChildChange(Xu(m.name,m.node)),A.updateImmediateChild(m.name,m.node)):A}}else return r.isEmpty()?e:p&&o(d,c)>=0?(s!=null&&(s.trackChildChange(Nd(d.name,d.node)),s.trackChildChange(Xu(t,r))),l.updateImmediateChild(t,r).updateImmediateChild(d.name,Ie.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SE{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ot}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return ie(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return ie(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Yu}hasEnd(){return this.endSet_}getIndexEndValue(){return ie(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return ie(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:ul}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return ie(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ot}copy(){const e=new SE;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function MV(n){return n.loadsAllData()?new EE(n.getIndex()):n.hasLimit()?new bV(n):new Od(n)}function w3(n){const e={};if(n.isDefault())return e;let t;if(n.index_===Ot?t="$priority":n.index_===DV?t="$value":n.index_===Du?t="$key":(ie(n.index_ instanceof xV,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=Cn(t),n.startSet_){const r=n.startAfterSet_?"startAfter":"startAt";e[r]=Cn(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+Cn(n.indexStartName_))}if(n.endSet_){const r=n.endBeforeSet_?"endBefore":"endAt";e[r]=Cn(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+Cn(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function E3(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==Ot&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _m extends LR{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=hf("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(ie(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const o=_m.getListenId_(e,r),l={};this.listens_[o]=l;const c=w3(e._queryParams);this.restRequest_(s+".json",c,(d,p)=>{let _=p;if(d===404&&(_=null,d=null),d===null&&this.onDataUpdate_(s,_,!1,r),Bu(this.listens_,o)===l){let m;d?d===401?m="permission_denied":m="rest_error:"+d:m="ok",i(m,null)}})}unlisten(e,t){const r=_m.getListenId_(e,t);delete this.listens_[r]}get(e){const t=w3(e._queryParams),r=e._path.toString(),i=new As;return this.restRequest_(r+".json",t,(s,o)=>{let l=o;s===404&&(l=null,s=null),s===null?(this.onDataUpdate_(r,l,!1,null),i.resolve(l)):i.reject(new Error(l))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+lc(t);this.log_("Sending REST request for "+o);const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(r&&l.readyState===4){this.log_("REST Response for "+o+" received. status:",l.status,"response:",l.responseText);let c=null;if(l.status>=200&&l.status<300){try{c=_d(l.responseText)}catch{Dr("Failed to parse JSON response for "+o+": "+l.responseText)}r(null,c)}else l.status!==401&&l.status!==404&&Dr("Got unsuccessful REST response for "+o+" Status: "+l.status),r(l.status);r=null}},l.open("GET",o,!0),l.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LV{constructor(){this.rootNode_=Ie.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ym(){return{value:null,children:new Map}}function gc(n,e,t){if(Fe(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const r=Me(e);n.children.has(r)||n.children.set(r,ym());const i=n.children.get(r);e=_t(e),gc(i,e,t)}}function J1(n,e){if(Fe(e))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{const t=n.value;return n.value=null,t.forEachChild(Ot,(r,i)=>{gc(n,new ct(r),i)}),J1(n,e)}}else if(n.children.size>0){const t=Me(e);return e=_t(e),n.children.has(t)&&J1(n.children.get(t),e)&&n.children.delete(t),n.children.size===0}else return!0}function Z1(n,e,t){n.value!==null?t(e,n.value):FV(n,(r,i)=>{const s=new ct(e.toString()+"/"+r);Z1(i,s,t)})}function FV(n,e){n.children.forEach((t,r)=>{e(r,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VV{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&ir(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S3=10*1e3,UV=30*1e3,zV=5*60*1e3;class BV{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new VV(e);const r=S3+(UV-S3)*Math.random();Yh(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;ir(e,(i,s)=>{s>0&&ss(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),Yh(this.reportStats_.bind(this),Math.floor(Math.random()*2*zV))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ii;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Ii||(Ii={}));function $R(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function TE(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function CE(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vm{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Ii.ACK_USER_WRITE,this.source=$R()}operationForChild(e){if(Fe(this.path)){if(this.affectedTree.value!=null)return ie(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new ct(e));return new vm(it(),t,this.revert)}}else return ie(Me(this.path)===e,"operationForChild called for unrelated child."),new vm(_t(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bd{constructor(e,t){this.source=e,this.path=t,this.type=Ii.LISTEN_COMPLETE}operationForChild(e){return Fe(this.path)?new bd(this.source,it()):new bd(this.source,_t(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Ii.OVERWRITE}operationForChild(e){return Fe(this.path)?new cl(this.source,it(),this.snap.getImmediateChild(e)):new cl(this.source,_t(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Md{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Ii.MERGE}operationForChild(e){if(Fe(this.path)){const t=this.children.subtree(new ct(e));return t.isEmpty()?null:t.value?new cl(this.source,it(),t.value):new Md(this.source,it(),t)}else return ie(Me(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Md(this.source,_t(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hl{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Fe(e))return this.isFullyInitialized()&&!this.filtered_;const t=Me(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jV{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function GV(n,e,t,r){const i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(OV(o.childName,o.snapshotNode))}),yh(n,i,"child_removed",e,r,t),yh(n,i,"child_added",e,r,t),yh(n,i,"child_moved",s,r,t),yh(n,i,"child_changed",e,r,t),yh(n,i,"value",e,r,t),i}function yh(n,e,t,r,i,s){const o=r.filter(l=>l.type===t);o.sort((l,c)=>HV(n,l,c)),o.forEach(l=>{const c=WV(n,l,s);i.forEach(d=>{d.respondsTo(l.type)&&e.push(d.createEvent(c,n.query_))})})}function WV(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function HV(n,e,t){if(e.childName==null||t.childName==null)throw ac("Should only compare child_ events.");const r=new Ve(e.childName,e.snapshotNode),i=new Ve(t.childName,t.snapshotNode);return n.index_.compare(r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T0(n,e){return{eventCache:n,serverCache:e}}function Xh(n,e,t,r){return T0(new hl(e,t,r),n.serverCache)}function qR(n,e,t,r){return T0(n.eventCache,new hl(e,t,r))}function e2(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function dl(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dv;const $V=()=>(dv||(dv=new kr(xF)),dv);class Ct{constructor(e,t=$V()){this.value=e,this.children=t}static fromObject(e){let t=new Ct(null);return ir(e,(r,i)=>{t=t.set(new ct(r),i)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:it(),value:this.value};if(Fe(e))return null;{const r=Me(e),i=this.children.get(r);if(i!==null){const s=i.findRootMostMatchingPathAndValue(_t(e),t);return s!=null?{path:Wt(new ct(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Fe(e))return this;{const t=Me(e),r=this.children.get(t);return r!==null?r.subtree(_t(e)):new Ct(null)}}set(e,t){if(Fe(e))return new Ct(t,this.children);{const r=Me(e),s=(this.children.get(r)||new Ct(null)).set(_t(e),t),o=this.children.insert(r,s);return new Ct(this.value,o)}}remove(e){if(Fe(e))return this.children.isEmpty()?new Ct(null):new Ct(null,this.children);{const t=Me(e),r=this.children.get(t);if(r){const i=r.remove(_t(e));let s;return i.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,i),this.value===null&&s.isEmpty()?new Ct(null):new Ct(this.value,s)}else return this}}get(e){if(Fe(e))return this.value;{const t=Me(e),r=this.children.get(t);return r?r.get(_t(e)):null}}setTree(e,t){if(Fe(e))return t;{const r=Me(e),s=(this.children.get(r)||new Ct(null)).setTree(_t(e),t);let o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new Ct(this.value,o)}}fold(e){return this.fold_(it(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Wt(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,it(),t)}findOnPath_(e,t,r){const i=this.value?r(t,this.value):!1;if(i)return i;if(Fe(e))return null;{const s=Me(e),o=this.children.get(s);return o?o.findOnPath_(_t(e),Wt(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,it(),t)}foreachOnPath_(e,t,r){if(Fe(e))return this;{this.value&&r(t,this.value);const i=Me(e),s=this.children.get(i);return s?s.foreachOnPath_(_t(e),Wt(t,i),r):new Ct(null)}}foreach(e){this.foreach_(it(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(Wt(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(e){this.writeTree_=e}static empty(){return new Ai(new Ct(null))}}function Jh(n,e,t){if(Fe(e))return new Ai(new Ct(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){const i=r.path;let s=r.value;const o=Rr(i,e);return s=s.updateChild(o,t),new Ai(n.writeTree_.set(i,s))}else{const i=new Ct(t),s=n.writeTree_.setTree(e,i);return new Ai(s)}}}function T3(n,e,t){let r=n;return ir(t,(i,s)=>{r=Jh(r,Wt(e,i),s)}),r}function C3(n,e){if(Fe(e))return Ai.empty();{const t=n.writeTree_.setTree(e,new Ct(null));return new Ai(t)}}function t2(n,e){return wl(n,e)!=null}function wl(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(Rr(t.path,e)):null}function I3(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(Ot,(r,i)=>{e.push(new Ve(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new Ve(r,i.value))}),e}function Ho(n,e){if(Fe(e))return n;{const t=wl(n,e);return t!=null?new Ai(new Ct(t)):new Ai(n.writeTree_.subtree(e))}}function n2(n){return n.writeTree_.isEmpty()}function Ju(n,e){return KR(it(),n.writeTree_,e)}function KR(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(ie(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):t=KR(Wt(n,i),s,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(Wt(n,".priority"),r)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IE(n,e){return JR(e,n)}function qV(n,e,t,r,i){ie(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=Jh(n.visibleWrites,e,t)),n.lastWriteId=r}function KV(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}function QV(n,e){const t=n.allWrites.findIndex(l=>l.writeId===e);ie(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){const l=n.allWrites[o];l.visible&&(o>=t&&YV(l,r.path)?i=!1:ni(r.path,l.path)&&(s=!0)),o--}if(i){if(s)return XV(n),!0;if(r.snap)n.visibleWrites=C3(n.visibleWrites,r.path);else{const l=r.children;ir(l,c=>{n.visibleWrites=C3(n.visibleWrites,Wt(r.path,c))})}return!0}else return!1}function YV(n,e){if(n.snap)return ni(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&ni(Wt(n.path,t),e))return!0;return!1}function XV(n){n.visibleWrites=QR(n.allWrites,JV,it()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function JV(n){return n.visible}function QR(n,e,t){let r=Ai.empty();for(let i=0;i<n.length;++i){const s=n[i];if(e(s)){const o=s.path;let l;if(s.snap)ni(t,o)?(l=Rr(t,o),r=Jh(r,l,s.snap)):ni(o,t)&&(l=Rr(o,t),r=Jh(r,it(),s.snap.getChild(l)));else if(s.children){if(ni(t,o))l=Rr(t,o),r=T3(r,l,s.children);else if(ni(o,t))if(l=Rr(o,t),Fe(l))r=T3(r,it(),s.children);else{const c=Bu(s.children,Me(l));if(c){const d=c.getChild(_t(l));r=Jh(r,it(),d)}}}else throw ac("WriteRecord should have .snap or .children")}}return r}function YR(n,e,t,r,i){if(!r&&!i){const s=wl(n.visibleWrites,e);if(s!=null)return s;{const o=Ho(n.visibleWrites,e);if(n2(o))return t;if(t==null&&!t2(o,it()))return null;{const l=t||Ie.EMPTY_NODE;return Ju(o,l)}}}else{const s=Ho(n.visibleWrites,e);if(!i&&n2(s))return t;if(!i&&t==null&&!t2(s,it()))return null;{const o=function(d){return(d.visible||i)&&(!r||!~r.indexOf(d.writeId))&&(ni(d.path,e)||ni(e,d.path))},l=QR(n.allWrites,o,e),c=t||Ie.EMPTY_NODE;return Ju(l,c)}}}function ZV(n,e,t){let r=Ie.EMPTY_NODE;const i=wl(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Ot,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){const s=Ho(n.visibleWrites,e);return t.forEachChild(Ot,(o,l)=>{const c=Ju(Ho(s,new ct(o)),l);r=r.updateImmediateChild(o,c)}),I3(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{const s=Ho(n.visibleWrites,e);return I3(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function eU(n,e,t,r,i){ie(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=Wt(e,t);if(t2(n.visibleWrites,s))return null;{const o=Ho(n.visibleWrites,s);return n2(o)?i.getChild(t):Ju(o,i.getChild(t))}}function tU(n,e,t,r){const i=Wt(e,t),s=wl(n.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(t)){const o=Ho(n.visibleWrites,i);return Ju(o,r.getNode().getImmediateChild(t))}else return null}function nU(n,e){return wl(n.visibleWrites,e)}function rU(n,e,t,r,i,s,o){let l;const c=Ho(n.visibleWrites,e),d=wl(c,it());if(d!=null)l=d;else if(t!=null)l=Ju(c,t);else return[];if(l=l.withIndex(o),!l.isEmpty()&&!l.isLeafNode()){const p=[],_=o.getCompare(),m=s?l.getReverseIteratorFrom(r,o):l.getIteratorFrom(r,o);let S=m.getNext();for(;S&&p.length<i;)_(S,r)!==0&&p.push(S),S=m.getNext();return p}else return[]}function iU(){return{visibleWrites:Ai.empty(),allWrites:[],lastWriteId:-1}}function wm(n,e,t,r){return YR(n.writeTree,n.treePath,e,t,r)}function PE(n,e){return ZV(n.writeTree,n.treePath,e)}function P3(n,e,t,r){return eU(n.writeTree,n.treePath,e,t,r)}function Em(n,e){return nU(n.writeTree,Wt(n.treePath,e))}function sU(n,e,t,r,i,s){return rU(n.writeTree,n.treePath,e,t,r,i,s)}function RE(n,e,t){return tU(n.writeTree,n.treePath,e,t)}function XR(n,e){return JR(Wt(n.treePath,e),n.writeTree)}function JR(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oU{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;ie(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),ie(r!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const s=i.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(r,Dd(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(r,Nd(r,i.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(r,Xu(r,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(r,Dd(r,e.snapshotNode,i.oldSnap));else throw ac("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aU{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}}const ZR=new aU;class kE{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new hl(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return RE(this.writes_,e,r)}}getChildAfterChild(e,t,r){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:dl(this.viewCache_),s=sU(this.writes_,i,t,1,r,e);return s.length===0?null:s[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lU(n){return{filter:n}}function uU(n,e){ie(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),ie(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function cU(n,e,t,r,i){const s=new oU;let o,l;if(t.type===Ii.OVERWRITE){const d=t;d.source.fromUser?o=r2(n,e,d.path,d.snap,r,i,s):(ie(d.source.fromServer,"Unknown source."),l=d.source.tagged||e.serverCache.isFiltered()&&!Fe(d.path),o=Sm(n,e,d.path,d.snap,r,i,l,s))}else if(t.type===Ii.MERGE){const d=t;d.source.fromUser?o=dU(n,e,d.path,d.children,r,i,s):(ie(d.source.fromServer,"Unknown source."),l=d.source.tagged||e.serverCache.isFiltered(),o=i2(n,e,d.path,d.children,r,i,l,s))}else if(t.type===Ii.ACK_USER_WRITE){const d=t;d.revert?o=gU(n,e,d.path,r,i,s):o=fU(n,e,d.path,d.affectedTree,r,i,s)}else if(t.type===Ii.LISTEN_COMPLETE)o=pU(n,e,t.path,r,s);else throw ac("Unknown operation type: "+t.type);const c=s.getChanges();return hU(e,o,c),{viewCache:o,changes:c}}function hU(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=e2(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(HR(e2(e)))}}function ek(n,e,t,r,i,s){const o=e.eventCache;if(Em(r,t)!=null)return e;{let l,c;if(Fe(t))if(ie(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const d=dl(e),p=d instanceof Ie?d:Ie.EMPTY_NODE,_=PE(r,p);l=n.filter.updateFullNode(e.eventCache.getNode(),_,s)}else{const d=wm(r,dl(e));l=n.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{const d=Me(t);if(d===".priority"){ie(Zo(t)===1,"Can't have a priority with additional path components");const p=o.getNode();c=e.serverCache.getNode();const _=P3(r,t,p,c);_!=null?l=n.filter.updatePriority(p,_):l=o.getNode()}else{const p=_t(t);let _;if(o.isCompleteForChild(d)){c=e.serverCache.getNode();const m=P3(r,t,o.getNode(),c);m!=null?_=o.getNode().getImmediateChild(d).updateChild(p,m):_=o.getNode().getImmediateChild(d)}else _=RE(r,d,e.serverCache);_!=null?l=n.filter.updateChild(o.getNode(),d,_,p,i,s):l=o.getNode()}}return Xh(e,l,o.isFullyInitialized()||Fe(t),n.filter.filtersNodes())}}function Sm(n,e,t,r,i,s,o,l){const c=e.serverCache;let d;const p=o?n.filter:n.filter.getIndexedFilter();if(Fe(t))d=p.updateFullNode(c.getNode(),r,null);else if(p.filtersNodes()&&!c.isFiltered()){const S=c.getNode().updateChild(t,r);d=p.updateFullNode(c.getNode(),S,null)}else{const S=Me(t);if(!c.isCompleteForPath(t)&&Zo(t)>1)return e;const E=_t(t),D=c.getNode().getImmediateChild(S).updateChild(E,r);S===".priority"?d=p.updatePriority(c.getNode(),D):d=p.updateChild(c.getNode(),S,D,E,ZR,null)}const _=qR(e,d,c.isFullyInitialized()||Fe(t),p.filtersNodes()),m=new kE(i,_,s);return ek(n,_,t,i,m,l)}function r2(n,e,t,r,i,s,o){const l=e.eventCache;let c,d;const p=new kE(i,e,s);if(Fe(t))d=n.filter.updateFullNode(e.eventCache.getNode(),r,o),c=Xh(e,d,!0,n.filter.filtersNodes());else{const _=Me(t);if(_===".priority")d=n.filter.updatePriority(e.eventCache.getNode(),r),c=Xh(e,d,l.isFullyInitialized(),l.isFiltered());else{const m=_t(t),S=l.getNode().getImmediateChild(_);let E;if(Fe(m))E=r;else{const A=p.getCompleteChild(_);A!=null?_E(m)===".priority"&&A.getChild(VR(m)).isEmpty()?E=A:E=A.updateChild(m,r):E=Ie.EMPTY_NODE}if(S.equals(E))c=e;else{const A=n.filter.updateChild(l.getNode(),_,E,m,p,o);c=Xh(e,A,l.isFullyInitialized(),n.filter.filtersNodes())}}}return c}function R3(n,e){return n.eventCache.isCompleteForChild(e)}function dU(n,e,t,r,i,s,o){let l=e;return r.foreach((c,d)=>{const p=Wt(t,c);R3(e,Me(p))&&(l=r2(n,l,p,d,i,s,o))}),r.foreach((c,d)=>{const p=Wt(t,c);R3(e,Me(p))||(l=r2(n,l,p,d,i,s,o))}),l}function k3(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function i2(n,e,t,r,i,s,o,l){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,d;Fe(t)?d=r:d=new Ct(null).setTree(t,r);const p=e.serverCache.getNode();return d.children.inorderTraversal((_,m)=>{if(p.hasChild(_)){const S=e.serverCache.getNode().getImmediateChild(_),E=k3(n,S,m);c=Sm(n,c,new ct(_),E,i,s,o,l)}}),d.children.inorderTraversal((_,m)=>{const S=!e.serverCache.isCompleteForChild(_)&&m.value===null;if(!p.hasChild(_)&&!S){const E=e.serverCache.getNode().getImmediateChild(_),A=k3(n,E,m);c=Sm(n,c,new ct(_),A,i,s,o,l)}}),c}function fU(n,e,t,r,i,s,o){if(Em(i,t)!=null)return e;const l=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(Fe(t)&&c.isFullyInitialized()||c.isCompleteForPath(t))return Sm(n,e,t,c.getNode().getChild(t),i,s,l,o);if(Fe(t)){let d=new Ct(null);return c.getNode().forEachChild(Du,(p,_)=>{d=d.set(new ct(p),_)}),i2(n,e,t,d,i,s,l,o)}else return e}else{let d=new Ct(null);return r.foreach((p,_)=>{const m=Wt(t,p);c.isCompleteForPath(m)&&(d=d.set(p,c.getNode().getChild(m)))}),i2(n,e,t,d,i,s,l,o)}}function pU(n,e,t,r,i){const s=e.serverCache,o=qR(e,s.getNode(),s.isFullyInitialized()||Fe(t),s.isFiltered());return ek(n,o,t,r,ZR,i)}function gU(n,e,t,r,i,s){let o;if(Em(r,t)!=null)return e;{const l=new kE(r,e,i),c=e.eventCache.getNode();let d;if(Fe(t)||Me(t)===".priority"){let p;if(e.serverCache.isFullyInitialized())p=wm(r,dl(e));else{const _=e.serverCache.getNode();ie(_ instanceof Ie,"serverChildren would be complete if leaf node"),p=PE(r,_)}p=p,d=n.filter.updateFullNode(c,p,s)}else{const p=Me(t);let _=RE(r,p,e.serverCache);_==null&&e.serverCache.isCompleteForChild(p)&&(_=c.getImmediateChild(p)),_!=null?d=n.filter.updateChild(c,p,_,_t(t),l,s):e.eventCache.getNode().hasChild(p)?d=n.filter.updateChild(c,p,Ie.EMPTY_NODE,_t(t),l,s):d=c,d.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=wm(r,dl(e)),o.isLeafNode()&&(d=n.filter.updateFullNode(d,o,s)))}return o=e.serverCache.isFullyInitialized()||Em(r,it())!=null,Xh(e,d,o,n.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mU{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new EE(r.getIndex()),s=MV(r);this.processor_=lU(s);const o=t.serverCache,l=t.eventCache,c=i.updateFullNode(Ie.EMPTY_NODE,o.getNode(),null),d=s.updateFullNode(Ie.EMPTY_NODE,l.getNode(),null),p=new hl(c,o.isFullyInitialized(),i.filtersNodes()),_=new hl(d,l.isFullyInitialized(),s.filtersNodes());this.viewCache_=T0(_,p),this.eventGenerator_=new jV(this.query_)}get query(){return this.query_}}function _U(n){return n.viewCache_.serverCache.getNode()}function yU(n,e){const t=dl(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!Fe(e)&&!t.getImmediateChild(Me(e)).isEmpty())?t.getChild(e):null}function A3(n){return n.eventRegistrations_.length===0}function vU(n,e){n.eventRegistrations_.push(e)}function x3(n,e,t){const r=[];if(t){ie(e==null,"A cancel should cancel all event registrations.");const i=n.query._path;n.eventRegistrations_.forEach(s=>{const o=s.createCancelEvent(t,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<n.eventRegistrations_.length;++s){const o=n.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(s+1));break}}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function N3(n,e,t,r){e.type===Ii.MERGE&&e.source.queryId!==null&&(ie(dl(n.viewCache_),"We should always have a full cache before handling merges"),ie(e2(n.viewCache_),"Missing event cache, even though we have a server cache"));const i=n.viewCache_,s=cU(n.processor_,i,e,t,r);return uU(n.processor_,s.viewCache),ie(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,tk(n,s.changes,s.viewCache.eventCache.getNode(),null)}function wU(n,e){const t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(Ot,(s,o)=>{r.push(Xu(s,o))}),t.isFullyInitialized()&&r.push(HR(t.getNode())),tk(n,r,t.getNode(),e)}function tk(n,e,t,r){const i=r?[r]:n.eventRegistrations_;return GV(n.eventGenerator_,e,t,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tm;class EU{constructor(){this.views=new Map}}function SU(n){ie(!Tm,"__referenceConstructor has already been defined"),Tm=n}function TU(){return ie(Tm,"Reference.ts has not been loaded"),Tm}function CU(n){return n.views.size===0}function AE(n,e,t,r){const i=e.source.queryId;if(i!==null){const s=n.views.get(i);return ie(s!=null,"SyncTree gave us an op for an invalid query."),N3(s,e,t,r)}else{let s=[];for(const o of n.views.values())s=s.concat(N3(o,e,t,r));return s}}function IU(n,e,t,r,i){const s=e._queryIdentifier,o=n.views.get(s);if(!o){let l=wm(t,i?r:null),c=!1;l?c=!0:r instanceof Ie?(l=PE(t,r),c=!1):(l=Ie.EMPTY_NODE,c=!1);const d=T0(new hl(l,c,!1),new hl(r,i,!1));return new mU(e,d)}return o}function PU(n,e,t,r,i,s){const o=IU(n,e,r,i,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),vU(o,t),wU(o,t)}function RU(n,e,t,r){const i=e._queryIdentifier,s=[];let o=[];const l=ea(n);if(i==="default")for(const[c,d]of n.views.entries())o=o.concat(x3(d,t,r)),A3(d)&&(n.views.delete(c),d.query._queryParams.loadsAllData()||s.push(d.query));else{const c=n.views.get(i);c&&(o=o.concat(x3(c,t,r)),A3(c)&&(n.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return l&&!ea(n)&&s.push(new(TU())(e._repo,e._path)),{removed:s,events:o}}function nk(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Ou(n,e){let t=null;for(const r of n.views.values())t=t||yU(r,e);return t}function rk(n,e){if(e._queryParams.loadsAllData())return C0(n);{const r=e._queryIdentifier;return n.views.get(r)}}function ik(n,e){return rk(n,e)!=null}function ea(n){return C0(n)!=null}function C0(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Cm;function kU(n){ie(!Cm,"__referenceConstructor has already been defined"),Cm=n}function AU(){return ie(Cm,"Reference.ts has not been loaded"),Cm}let xU=1;class D3{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Ct(null),this.pendingWriteTree_=iU(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function sk(n,e,t,r,i){return qV(n.pendingWriteTree_,e,t,r,i),i?ff(n,new cl($R(),e,t)):[]}function qa(n,e,t=!1){const r=KV(n.pendingWriteTree_,e);if(QV(n.pendingWriteTree_,e)){let s=new Ct(null);return r.snap!=null?s=s.set(it(),!0):ir(r.children,o=>{s=s.set(new ct(o),!0)}),ff(n,new vm(r.path,s,t))}else return[]}function I0(n,e,t){return ff(n,new cl(TE(),e,t))}function NU(n,e,t){const r=Ct.fromObject(t);return ff(n,new Md(TE(),e,r))}function DU(n,e){return ff(n,new bd(TE(),e))}function OU(n,e,t){const r=NE(n,t);if(r){const i=DE(r),s=i.path,o=i.queryId,l=Rr(s,e),c=new bd(CE(o),l);return OE(n,s,c)}else return[]}function s2(n,e,t,r,i=!1){const s=e._path,o=n.syncPointTree_.get(s);let l=[];if(o&&(e._queryIdentifier==="default"||ik(o,e))){const c=RU(o,e,t,r);CU(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));const d=c.removed;if(l=c.events,!i){const p=d.findIndex(m=>m._queryParams.loadsAllData())!==-1,_=n.syncPointTree_.findOnPath(s,(m,S)=>ea(S));if(p&&!_){const m=n.syncPointTree_.subtree(s);if(!m.isEmpty()){const S=LU(m);for(let E=0;E<S.length;++E){const A=S[E],D=A.query,k=lk(n,A);n.listenProvider_.startListening(Zh(D),Im(n,D),k.hashFn,k.onComplete)}}}!_&&d.length>0&&!r&&(p?n.listenProvider_.stopListening(Zh(e),null):d.forEach(m=>{const S=n.queryToTagMap.get(P0(m));n.listenProvider_.stopListening(Zh(m),S)}))}FU(n,d)}return l}function bU(n,e,t,r){const i=NE(n,r);if(i!=null){const s=DE(i),o=s.path,l=s.queryId,c=Rr(o,e),d=new cl(CE(l),c,t);return OE(n,o,d)}else return[]}function MU(n,e,t,r){const i=NE(n,r);if(i){const s=DE(i),o=s.path,l=s.queryId,c=Rr(o,e),d=Ct.fromObject(t),p=new Md(CE(l),c,d);return OE(n,o,p)}else return[]}function O3(n,e,t,r=!1){const i=e._path;let s=null,o=!1;n.syncPointTree_.foreachOnPath(i,(m,S)=>{const E=Rr(m,i);s=s||Ou(S,E),o=o||ea(S)});let l=n.syncPointTree_.get(i);l?(o=o||ea(l),s=s||Ou(l,it())):(l=new EU,n.syncPointTree_=n.syncPointTree_.set(i,l));let c;s!=null?c=!0:(c=!1,s=Ie.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((S,E)=>{const A=Ou(E,it());A&&(s=s.updateImmediateChild(S,A))}));const d=ik(l,e);if(!d&&!e._queryParams.loadsAllData()){const m=P0(e);ie(!n.queryToTagMap.has(m),"View does not exist, but we have a tag");const S=VU();n.queryToTagMap.set(m,S),n.tagToQueryMap.set(S,m)}const p=IE(n.pendingWriteTree_,i);let _=PU(l,e,t,p,s,c);if(!d&&!o&&!r){const m=rk(l,e);_=_.concat(UU(n,e,m))}return _}function xE(n,e,t){const i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,l)=>{const c=Rr(o,e),d=Ou(l,c);if(d)return d});return YR(i,e,s,t,!0)}function ff(n,e){return ok(e,n.syncPointTree_,null,IE(n.pendingWriteTree_,it()))}function ok(n,e,t,r){if(Fe(n.path))return ak(n,e,t,r);{const i=e.get(it());t==null&&i!=null&&(t=Ou(i,it()));let s=[];const o=Me(n.path),l=n.operationForChild(o),c=e.children.get(o);if(c&&l){const d=t?t.getImmediateChild(o):null,p=XR(r,o);s=s.concat(ok(l,c,d,p))}return i&&(s=s.concat(AE(i,n,r,t))),s}}function ak(n,e,t,r){const i=e.get(it());t==null&&i!=null&&(t=Ou(i,it()));let s=[];return e.children.inorderTraversal((o,l)=>{const c=t?t.getImmediateChild(o):null,d=XR(r,o),p=n.operationForChild(o);p&&(s=s.concat(ak(p,l,c,d)))}),i&&(s=s.concat(AE(i,n,r,t))),s}function lk(n,e){const t=e.query,r=Im(n,t);return{hashFn:()=>(_U(e)||Ie.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?OU(n,t._path,r):DU(n,t._path);{const s=OF(i,t);return s2(n,t,null,s)}}}}function Im(n,e){const t=P0(e);return n.queryToTagMap.get(t)}function P0(n){return n._path.toString()+"$"+n._queryIdentifier}function NE(n,e){return n.tagToQueryMap.get(e)}function DE(n){const e=n.indexOf("$");return ie(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new ct(n.substr(0,e))}}function OE(n,e,t){const r=n.syncPointTree_.get(e);ie(r,"Missing sync point for query tag that we're tracking");const i=IE(n.pendingWriteTree_,e);return AE(r,t,i,null)}function LU(n){return n.fold((e,t,r)=>{if(t&&ea(t))return[C0(t)];{let i=[];return t&&(i=nk(t)),ir(r,(s,o)=>{i=i.concat(o)}),i}})}function Zh(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(AU())(n._repo,n._path):n}function FU(n,e){for(let t=0;t<e.length;++t){const r=e[t];if(!r._queryParams.loadsAllData()){const i=P0(r),s=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(s)}}}function VU(){return xU++}function UU(n,e,t){const r=e._path,i=Im(n,e),s=lk(n,t),o=n.listenProvider_.startListening(Zh(e),i,s.hashFn,s.onComplete),l=n.syncPointTree_.subtree(r);if(i)ie(!ea(l.value),"If we're adding a query, it shouldn't be shadowed");else{const c=l.fold((d,p,_)=>{if(!Fe(d)&&p&&ea(p))return[C0(p).query];{let m=[];return p&&(m=m.concat(nk(p).map(S=>S.query))),ir(_,(S,E)=>{m=m.concat(E)}),m}});for(let d=0;d<c.length;++d){const p=c[d];n.listenProvider_.stopListening(Zh(p),Im(n,p))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bE{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new bE(t)}node(){return this.node_}}class ME{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Wt(this.path_,e);return new ME(this.syncTree_,t)}node(){return xE(this.syncTree_,this.path_)}}const zU=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},b3=function(n,e,t){if(!n||typeof n!="object")return n;if(ie(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return BU(n[".sv"],e,t);if(typeof n[".sv"]=="object")return jU(n[".sv"],e);ie(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},BU=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:ie(!1,"Unexpected server value: "+n)}},jU=function(n,e,t){n.hasOwnProperty("increment")||ie(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;typeof r!="number"&&ie(!1,"Unexpected increment value: "+r);const i=e.node();if(ie(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return typeof o!="number"?r:o+r},GU=function(n,e,t,r){return LE(e,new ME(t,n),r)},uk=function(n,e,t){return LE(n,new bE(e),t)};function LE(n,e,t){const r=n.getPriority().val(),i=b3(r,e.getImmediateChild(".priority"),t);let s;if(n.isLeafNode()){const o=n,l=b3(o.getValue(),e,t);return l!==o.getValue()||i!==o.getPriority().val()?new yn(l,Yt(i)):n}else{const o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new yn(i))),o.forEachChild(Ot,(l,c)=>{const d=LE(c,e.getImmediateChild(l),t);d!==c&&(s=s.updateImmediateChild(l,d))}),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FE{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function VE(n,e){let t=e instanceof ct?e:new ct(e),r=n,i=Me(t);for(;i!==null;){const s=Bu(r.node.children,i)||{children:{},childCount:0};r=new FE(i,r,s),t=_t(t),i=Me(t)}return r}function mc(n){return n.node.value}function ck(n,e){n.node.value=e,o2(n)}function hk(n){return n.node.childCount>0}function WU(n){return mc(n)===void 0&&!hk(n)}function R0(n,e){ir(n.node.children,(t,r)=>{e(new FE(t,n,r))})}function dk(n,e,t,r){t&&e(n),R0(n,i=>{dk(i,e,!0)})}function HU(n,e,t){let r=n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function pf(n){return new ct(n.parent===null?n.name:pf(n.parent)+"/"+n.name)}function o2(n){n.parent!==null&&$U(n.parent,n.name,n)}function $U(n,e,t){const r=WU(t),i=ss(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,o2(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,o2(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qU=/[\[\].#$\/\u0000-\u001F\u007F]/,KU=/[\[\].#$\u0000-\u001F\u007F]/,fv=10*1024*1024,UE=function(n){return typeof n=="string"&&n.length!==0&&!qU.test(n)},fk=function(n){return typeof n=="string"&&n.length!==0&&!KU.test(n)},QU=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),fk(n)},pk=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!E0(n)||n&&typeof n=="object"&&ss(n,".sv")},a2=function(n,e,t,r){k0(ju(n,"value"),e,t)},k0=function(n,e,t){const r=t instanceof ct?new fV(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Ua(r));if(typeof e=="function")throw new Error(n+"contains a function "+Ua(r)+" with contents = "+e.toString());if(E0(e))throw new Error(n+"contains "+e.toString()+" "+Ua(r));if(typeof e=="string"&&e.length>fv/3&&Xm(e)>fv)throw new Error(n+"contains a string greater than "+fv+" utf8 bytes "+Ua(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(ir(e,(o,l)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!UE(o)))throw new Error(n+" contains an invalid key ("+o+") "+Ua(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);pV(r,o),k0(n,l,r),gV(r)}),i&&s)throw new Error(n+' contains ".value" child '+Ua(r)+" in addition to actual children.")}},YU=function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];const s=xd(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!UE(s[o]))throw new Error(n+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(dV);let i=null;for(t=0;t<e.length;t++){if(r=e[t],i!==null&&ni(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},XU=function(n,e,t,r){const i=ju(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const s=[];ir(e,(o,l)=>{const c=new ct(o);if(k0(i,l,Wt(t,c)),_E(c)===".priority"&&!pk(l))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(c)}),YU(i,s)},JU=function(n,e,t){if(E0(e))throw new Error(ju(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!pk(e))throw new Error(ju(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},gk=function(n,e,t,r){if(!fk(t))throw new Error(ju(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},ZU=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),gk(n,e,t)},Nh=function(n,e){if(Me(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},ez=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!UE(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!QU(t))throw new Error(ju(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tz{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function zE(n,e){let t=null;for(let r=0;r<e.length;r++){const i=e[r],s=i.getPath();t!==null&&!yE(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)}function mk(n,e,t){zE(n,t),_k(n,r=>yE(r,e))}function Xs(n,e,t){zE(n,t),_k(n,r=>ni(r,e)||ni(e,r))}function _k(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const i=n.eventLists_[r];if(i){const s=i.path;e(s)?(nz(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function nz(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const r=t.getEventRunner();Qh&&Mn("event: "+t.toString()),pc(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rz="repo_interrupt",iz=25;class sz{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new tz,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=ym(),this.transactionQueueTree_=new FE,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function oz(n,e,t){if(n.stats_=gE(n.repoInfo_),n.forceRestClient_||FF())n.server_=new _m(n.repoInfo_,(r,i,s,o)=>{M3(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>L3(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Cn(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new zs(n.repoInfo_,e,(r,i,s,o)=>{M3(n,r,i,s,o)},r=>{L3(n,r)},r=>{lz(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=jF(n.repoInfo_,()=>new BV(n.stats_,n.server_)),n.infoData_=new LV,n.infoSyncTree_=new D3({startListening:(r,i,s,o)=>{let l=[];const c=n.infoData_.getNode(r._path);return c.isEmpty()||(l=I0(n.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),l},stopListening:()=>{}}),jE(n,"connected",!1),n.serverSyncTree_=new D3({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(l,c)=>{const d=o(l,c);Xs(n.eventQueue_,r._path,d)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function az(n){const t=n.infoData_.getNode(new ct(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function BE(n){return zU({timestamp:az(n)})}function M3(n,e,t,r,i){n.dataUpdateCount++;const s=new ct(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){const c=Xg(t,d=>Yt(d));o=MU(n.serverSyncTree_,s,c,i)}else{const c=Yt(t);o=bU(n.serverSyncTree_,s,c,i)}else if(r){const c=Xg(t,d=>Yt(d));o=NU(n.serverSyncTree_,s,c)}else{const c=Yt(t);o=I0(n.serverSyncTree_,s,c)}let l=s;o.length>0&&(l=A0(n,s)),Xs(n.eventQueue_,l,o)}function L3(n,e){jE(n,"connected",e),e===!1&&cz(n)}function lz(n,e){ir(e,(t,r)=>{jE(n,t,r)})}function jE(n,e,t){const r=new ct("/.info/"+e),i=Yt(t);n.infoData_.updateSnapshot(r,i);const s=I0(n.infoSyncTree_,r,i);Xs(n.eventQueue_,r,s)}function yk(n){return n.nextWriteId_++}function uz(n,e,t,r,i){GE(n,"set",{path:e.toString(),value:t,priority:r});const s=BE(n),o=Yt(t,r),l=xE(n.serverSyncTree_,e),c=uk(o,l,s),d=yk(n),p=sk(n.serverSyncTree_,e,c,d,!0);zE(n.eventQueue_,p),n.server_.put(e.toString(),o.val(!0),(m,S)=>{const E=m==="ok";E||Dr("set at "+e+" failed: "+m);const A=qa(n.serverSyncTree_,d,!E);Xs(n.eventQueue_,e,A),Zu(n,i,m,S)});const _=Ck(n,e);A0(n,_),Xs(n.eventQueue_,_,[])}function cz(n){GE(n,"onDisconnectEvents");const e=BE(n),t=ym();Z1(n.onDisconnect_,it(),(i,s)=>{const o=GU(i,s,n.serverSyncTree_,e);gc(t,i,o)});let r=[];Z1(t,it(),(i,s)=>{r=r.concat(I0(n.serverSyncTree_,i,s));const o=Ck(n,i);A0(n,o)}),n.onDisconnect_=ym(),Xs(n.eventQueue_,it(),r)}function hz(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&J1(n.onDisconnect_,e),Zu(n,t,r,i)})}function F3(n,e,t,r){const i=Yt(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&gc(n.onDisconnect_,e,i),Zu(n,r,s,o)})}function dz(n,e,t,r,i){const s=Yt(t,r);n.server_.onDisconnectPut(e.toString(),s.val(!0),(o,l)=>{o==="ok"&&gc(n.onDisconnect_,e,s),Zu(n,i,o,l)})}function fz(n,e,t,r){if(Yg(t)){Mn("onDisconnect().update() called with empty data.  Don't do anything."),Zu(n,r,"ok",void 0);return}n.server_.onDisconnectMerge(e.toString(),t,(i,s)=>{i==="ok"&&ir(t,(o,l)=>{const c=Yt(l);gc(n.onDisconnect_,Wt(e,o),c)}),Zu(n,r,i,s)})}function pz(n,e,t){let r;Me(e._path)===".info"?r=O3(n.infoSyncTree_,e,t):r=O3(n.serverSyncTree_,e,t),mk(n.eventQueue_,e._path,r)}function vk(n,e,t){let r;Me(e._path)===".info"?r=s2(n.infoSyncTree_,e,t):r=s2(n.serverSyncTree_,e,t),mk(n.eventQueue_,e._path,r)}function gz(n){n.persistentConnection_&&n.persistentConnection_.interrupt(rz)}function GE(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Mn(t,...e)}function Zu(n,e,t,r){e&&pc(()=>{if(t==="ok")e(null);else{const i=(t||"error").toUpperCase();let s=i;r&&(s+=": "+r);const o=new Error(s);o.code=i,e(o)}})}function wk(n,e,t){return xE(n.serverSyncTree_,e,t)||Ie.EMPTY_NODE}function WE(n,e=n.transactionQueueTree_){if(e||x0(n,e),mc(e)){const t=Sk(n,e);ie(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&mz(n,pf(e),t)}else hk(e)&&R0(e,t=>{WE(n,t)})}function mz(n,e,t){const r=t.map(d=>d.currentWriteId),i=wk(n,e,r);let s=i;const o=i.hash();for(let d=0;d<t.length;d++){const p=t[d];ie(p.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),p.status=1,p.retryCount++;const _=Rr(e,p.path);s=s.updateChild(_,p.currentOutputSnapshotRaw)}const l=s.val(!0),c=e;n.server_.put(c.toString(),l,d=>{GE(n,"transaction put response",{path:c.toString(),status:d});let p=[];if(d==="ok"){const _=[];for(let m=0;m<t.length;m++)t[m].status=2,p=p.concat(qa(n.serverSyncTree_,t[m].currentWriteId)),t[m].onComplete&&_.push(()=>t[m].onComplete(null,!0,t[m].currentOutputSnapshotResolved)),t[m].unwatcher();x0(n,VE(n.transactionQueueTree_,e)),WE(n,n.transactionQueueTree_),Xs(n.eventQueue_,e,p);for(let m=0;m<_.length;m++)pc(_[m])}else{if(d==="datastale")for(let _=0;_<t.length;_++)t[_].status===3?t[_].status=4:t[_].status=0;else{Dr("transaction at "+c.toString()+" failed: "+d);for(let _=0;_<t.length;_++)t[_].status=4,t[_].abortReason=d}A0(n,e)}},o)}function A0(n,e){const t=Ek(n,e),r=pf(t),i=Sk(n,t);return _z(n,i,r),r}function _z(n,e,t){if(e.length===0)return;const r=[];let i=[];const o=e.filter(l=>l.status===0).map(l=>l.currentWriteId);for(let l=0;l<e.length;l++){const c=e[l],d=Rr(t,c.path);let p=!1,_;if(ie(d!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)p=!0,_=c.abortReason,i=i.concat(qa(n.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=iz)p=!0,_="maxretry",i=i.concat(qa(n.serverSyncTree_,c.currentWriteId,!0));else{const m=wk(n,c.path,o);c.currentInputSnapshot=m;const S=e[l].update(m.val());if(S!==void 0){k0("transaction failed: Data returned ",S,c.path);let E=Yt(S);typeof S=="object"&&S!=null&&ss(S,".priority")||(E=E.updatePriority(m.getPriority()));const D=c.currentWriteId,k=BE(n),R=uk(E,m,k);c.currentOutputSnapshotRaw=E,c.currentOutputSnapshotResolved=R,c.currentWriteId=yk(n),o.splice(o.indexOf(D),1),i=i.concat(sk(n.serverSyncTree_,c.path,R,c.currentWriteId,c.applyLocally)),i=i.concat(qa(n.serverSyncTree_,D,!0))}else p=!0,_="nodata",i=i.concat(qa(n.serverSyncTree_,c.currentWriteId,!0))}Xs(n.eventQueue_,t,i),i=[],p&&(e[l].status=2,function(m){setTimeout(m,Math.floor(0))}(e[l].unwatcher),e[l].onComplete&&(_==="nodata"?r.push(()=>e[l].onComplete(null,!1,e[l].currentInputSnapshot)):r.push(()=>e[l].onComplete(new Error(_),!1,null))))}x0(n,n.transactionQueueTree_);for(let l=0;l<r.length;l++)pc(r[l]);WE(n,n.transactionQueueTree_)}function Ek(n,e){let t,r=n.transactionQueueTree_;for(t=Me(e);t!==null&&mc(r)===void 0;)r=VE(r,t),e=_t(e),t=Me(e);return r}function Sk(n,e){const t=[];return Tk(n,e,t),t.sort((r,i)=>r.order-i.order),t}function Tk(n,e,t){const r=mc(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);R0(e,i=>{Tk(n,i,t)})}function x0(n,e){const t=mc(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,ck(e,t.length>0?t:void 0)}R0(e,r=>{x0(n,r)})}function Ck(n,e){const t=pf(Ek(n,e)),r=VE(n.transactionQueueTree_,e);return HU(r,i=>{pv(n,i)}),pv(n,r),dk(r,i=>{pv(n,i)}),t}function pv(n,e){const t=mc(e);if(t){const r=[];let i=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(ie(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(ie(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(qa(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?ck(e,void 0):t.length=s+1,Xs(n.eventQueue_,pf(e),i);for(let o=0;o<r.length;o++)pc(r[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yz(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function vz(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Dr(`Invalid query segment '${t}' in query '${n}'`)}return e}const V3=function(n,e){const t=wz(n),r=t.namespace;t.domain==="firebase.com"&&Ys(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&Ys("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||kF();const i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new AR(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new ct(t.pathString)}},wz=function(n){let e="",t="",r="",i="",s="",o=!0,l="https",c=443;if(typeof n=="string"){let d=n.indexOf("//");d>=0&&(l=n.substring(0,d-1),n=n.substring(d+2));let p=n.indexOf("/");p===-1&&(p=n.length);let _=n.indexOf("?");_===-1&&(_=n.length),e=n.substring(0,Math.min(p,_)),p<_&&(i=yz(n.substring(p,_)));const m=vz(n.substring(Math.min(n.length,_)));d=e.indexOf(":"),d>=0?(o=l==="https"||l==="wss",c=parseInt(e.substring(d+1),10)):d=e.length;const S=e.slice(0,d);if(S.toLowerCase()==="localhost")t="localhost";else if(S.split(".").length<=2)t=S;else{const E=e.indexOf(".");r=e.substring(0,E).toLowerCase(),t=e.substring(E+1),s=r}"ns"in m&&(s=m.ns)}return{host:e,port:c,domain:t,subdomain:r,secure:o,scheme:l,pathString:i,namespace:s}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ez{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Cn(this.snapshot.exportVal())}}class Sz{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ik{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return ie(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tz{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new As;return hz(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Nh("OnDisconnect.remove",this._path);const e=new As;return F3(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Nh("OnDisconnect.set",this._path),a2("OnDisconnect.set",e,this._path);const t=new As;return F3(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){Nh("OnDisconnect.setWithPriority",this._path),a2("OnDisconnect.setWithPriority",e,this._path),JU("OnDisconnect.setWithPriority",t);const r=new As;return dz(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){Nh("OnDisconnect.update",this._path),XU("OnDisconnect.update",e,this._path);const t=new As;return fz(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HE{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return Fe(this._path)?null:_E(this._path)}get ref(){return new ca(this._repo,this._path)}get _queryIdentifier(){const e=E3(this._queryParams),t=fE(e);return t==="{}"?"default":t}get _queryObject(){return E3(this._queryParams)}isEqual(e){if(e=vt(e),!(e instanceof HE))return!1;const t=this._repo===e._repo,r=yE(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+hV(this._path)}}class ca extends HE{constructor(e,t){super(e,t,new SE,!1)}get parent(){const e=VR(this._path);return e===null?null:new ca(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class Pm{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new ct(e),r=l2(this.ref,e);return new Pm(this._node.getChild(t),r,Ot)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new Pm(i,l2(this.ref,r),Ot)))}hasChild(e){const t=new ct(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Pk(n,e){return n=vt(n),n._checkNotDeleted("ref"),e!==void 0?l2(n._root,e):n._root}function l2(n,e){return n=vt(n),Me(n._path)===null?ZU("child","path",e):gk("child","path",e),new ca(n._repo,Wt(n._path,e))}function Cz(n){return n=vt(n),new Tz(n._repo,n._path)}function Iz(n,e){n=vt(n),Nh("set",n._path),a2("set",e,n._path);const t=new As;return uz(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}class N0{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const r=t._queryParams.getIndex();return new Ez("value",this,new Pm(e.snapshotNode,new ca(t._repo,t._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Sz(this,e,t):null}matches(e){return e instanceof N0?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function Pz(n,e,t,r,i){const s=new Ik(t,void 0),o=new N0(s);return pz(n._repo,n,o),()=>vk(n._repo,n,o)}function Rz(n,e,t,r){return Pz(n,"value",e)}function kz(n,e,t){let r=null;const i=t?new Ik(t):null;r=new N0(i),vk(n._repo,n,r)}SU(ca);kU(ca);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Az="FIREBASE_DATABASE_EMULATOR_HOST",u2={};let xz=!1;function Nz(n,e,t,r){n.repoInfo_=new AR(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}function Dz(n,e,t,r,i){let s=r||n.options.databaseURL;s===void 0&&(n.options.projectId||Ys("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Mn("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=V3(s,i),l=o.repoInfo,c;typeof process<"u"&&r3&&(c=r3[Az]),c?(s=`http://${c}?ns=${l.namespace}`,o=V3(s,i),l=o.repoInfo):o.repoInfo.secure;const d=new UF(n.name,n.options,e);ez("Invalid Firebase Database URL",o),Fe(o.path)||Ys("Database URL must point to the root of a Firebase Database (not including a child path).");const p=bz(l,n,d,new VF(n.name,t));return new Mz(p,n)}function Oz(n,e){const t=u2[e];(!t||t[n.key]!==n)&&Ys(`Database ${e}(${n.repoInfo_}) has already been deleted.`),gz(n),delete t[n.key]}function bz(n,e,t,r){let i=u2[e.name];i||(i={},u2[e.name]=i);let s=i[n.toURLString()];return s&&Ys("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new sz(n,xz,t,r),i[n.toURLString()]=s,s}class Mz{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(oz(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ca(this._repo,it())),this._rootInternal}_delete(){return this._rootInternal!==null&&(Oz(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Ys("Cannot call "+e+" on a deleted database.")}}function $E(n=_w(),e){const t=Zm(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const r=X6("database");r&&Lz(t,...r)}return t}function Lz(n,e,t,r={}){n=vt(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&Ys("Cannot call useEmulator() after instance has already been initialized.");const i=n._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Ys('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Eg(Eg.OWNER);else if(r.mockUserToken){const o=typeof r.mockUserToken=="string"?r.mockUserToken:eP(r.mockUserToken,n.app.options.projectId);s=new Eg(o)}Nz(i,e,t,s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fz(n){SF(gl),nl(new Ko("database",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return Dz(r,i,s,t)},"PUBLIC").setMultipleInstances(!0)),ts(i3,s3,n),ts(i3,s3,"esm2017")}zs.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};zs.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};Fz();const Vz={apiKey:"AIzaSyDQZvIf-wol_S9nLsAHlFNfyBSxViW8xWc",authDomain:"collabcanvas-d5bce.firebaseapp.com",projectId:"collabcanvas-d5bce",storageBucket:"collabcanvas-d5bce.firebasestorage.app",messagingSenderId:"484501248859",appId:"1:484501248859:web:026a6bbbaa8652239b587e",databaseURL:"https://collabcanvas-d5bce-default-rtdb.firebaseio.com"},qE=sP(Vz),Ld=gb(qE),Or=iF(qE);$E(qE);const Uz=({onSuccess:n,onSwitchToRegister:e})=>{const[t,r]=Ee.useState(""),[i,s]=Ee.useState(""),[o,l]=Ee.useState(!1),[c,d]=Ee.useState(null),p=async m=>{m.preventDefault(),l(!0),d(null);try{await eO(Ld,t,i),n==null||n()}catch(S){d(S.message)}finally{l(!1)}},_=async()=>{l(!0),d(null);try{const m=new xs;await CO(Ld,m),n==null||n()}catch(m){d(m.message)}finally{l(!1)}};return Q.jsxs("div",{className:"max-w-md mx-auto bg-white rounded-lg shadow-md p-6",children:[Q.jsx("h2",{className:"text-2xl font-bold mb-6 text-center text-gray-800",children:"Sign In"}),c&&Q.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:c}),Q.jsxs("form",{onSubmit:p,className:"space-y-4",children:[Q.jsxs("div",{children:[Q.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),Q.jsx("input",{id:"email",type:"email",value:t,onChange:m=>r(m.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:o})]}),Q.jsxs("div",{children:[Q.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),Q.jsx("input",{id:"password",type:"password",value:i,onChange:m=>s(m.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:o})]}),Q.jsx("button",{type:"submit",disabled:o,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 disabled:opacity-50",children:o?"Signing In...":"Sign In"})]}),Q.jsx("div",{className:"my-4 text-center text-gray-500",children:"or"}),Q.jsx("button",{onClick:_,disabled:o,className:"w-full bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700 disabled:opacity-50",children:"Sign in with Google"}),Q.jsx("div",{className:"mt-4 text-center",children:Q.jsx("button",{onClick:e,className:"text-blue-600 hover:underline text-sm",children:"Need an account? Sign up"})})]})},zz=({onSuccess:n,onSwitchToLogin:e})=>{const[t,r]=Ee.useState(""),[i,s]=Ee.useState(""),[o,l]=Ee.useState(""),[c,d]=Ee.useState(!1),[p,_]=Ee.useState(null),m=async S=>{if(S.preventDefault(),d(!0),_(null),i!==o){_("Passwords do not match"),d(!1);return}if(i.length<6){_("Password must be at least 6 characters"),d(!1);return}try{await ZD(Ld,t,i),n==null||n()}catch(E){_(E.message)}finally{d(!1)}};return Q.jsxs("div",{className:"max-w-md mx-auto bg-white rounded-lg shadow-md p-6",children:[Q.jsx("h2",{className:"text-2xl font-bold mb-6 text-center text-gray-800",children:"Create Account"}),p&&Q.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:p}),Q.jsxs("form",{onSubmit:m,className:"space-y-4",children:[Q.jsxs("div",{children:[Q.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),Q.jsx("input",{id:"email",type:"email",value:t,onChange:S=>r(S.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:c})]}),Q.jsxs("div",{children:[Q.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),Q.jsx("input",{id:"password",type:"password",value:i,onChange:S=>s(S.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:c,minLength:6})]}),Q.jsxs("div",{children:[Q.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password"}),Q.jsx("input",{id:"confirmPassword",type:"password",value:o,onChange:S=>l(S.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:c})]}),Q.jsx("button",{type:"submit",disabled:c,className:"w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 disabled:opacity-50",children:c?"Creating Account...":"Create Account"})]}),Q.jsx("div",{className:"mt-4 text-center",children:Q.jsx("button",{onClick:e,className:"text-blue-600 hover:underline text-sm",children:"Already have an account? Sign in"})})]})},Bz=({onAuthSuccess:n})=>{const[e,t]=Ee.useState(!0),r=()=>{n==null||n()},i=()=>t(!0),s=()=>t(!1);return Q.jsx("div",{className:"w-full max-w-md mx-auto",children:e?Q.jsx(Uz,{onSuccess:r,onSwitchToRegister:s}):Q.jsx(zz,{onSuccess:r,onSwitchToLogin:i})})};var Rk={exports:{}},D0={},Rm={},be={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n._registerNode=n.Konva=n.glob=void 0;const e=Math.PI/180;function t(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}n.glob=typeof N4<"u"?N4:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},n.Konva={_global:n.glob,version:"9.3.22",isBrowser:t(),isUnminified:/param/.test((function(i){}).toString()),dblClickWindow:400,getAngle(i){return n.Konva.angleDeg?i*e:i},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return n.Konva.DD.isDragging},isTransforming(){var i;return(i=n.Konva.Transformer)===null||i===void 0?void 0:i.isTransforming()},isDragReady(){return!!n.Konva.DD.node},releaseCanvasOnDestroy:!0,document:n.glob.document,_injectGlobal(i){n.glob.Konva=i}};const r=i=>{n.Konva[i.prototype.getClassName()]=i};n._registerNode=r,n.Konva._injectGlobal(n.Konva)})(be);var Lt={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Util=n.Transform=void 0;const e=be;class t{constructor(P=[1,0,0,1,0,0]){this.dirty=!1,this.m=P&&P.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new t(this.m)}copyInto(P){P.m[0]=this.m[0],P.m[1]=this.m[1],P.m[2]=this.m[2],P.m[3]=this.m[3],P.m[4]=this.m[4],P.m[5]=this.m[5]}point(P){const V=this.m;return{x:V[0]*P.x+V[2]*P.y+V[4],y:V[1]*P.x+V[3]*P.y+V[5]}}translate(P,V){return this.m[4]+=this.m[0]*P+this.m[2]*V,this.m[5]+=this.m[1]*P+this.m[3]*V,this}scale(P,V){return this.m[0]*=P,this.m[1]*=P,this.m[2]*=V,this.m[3]*=V,this}rotate(P){const V=Math.cos(P),U=Math.sin(P),N=this.m[0]*V+this.m[2]*U,C=this.m[1]*V+this.m[3]*U,O=this.m[0]*-U+this.m[2]*V,x=this.m[1]*-U+this.m[3]*V;return this.m[0]=N,this.m[1]=C,this.m[2]=O,this.m[3]=x,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(P,V){const U=this.m[0]+this.m[2]*V,N=this.m[1]+this.m[3]*V,C=this.m[2]+this.m[0]*P,O=this.m[3]+this.m[1]*P;return this.m[0]=U,this.m[1]=N,this.m[2]=C,this.m[3]=O,this}multiply(P){const V=this.m[0]*P.m[0]+this.m[2]*P.m[1],U=this.m[1]*P.m[0]+this.m[3]*P.m[1],N=this.m[0]*P.m[2]+this.m[2]*P.m[3],C=this.m[1]*P.m[2]+this.m[3]*P.m[3],O=this.m[0]*P.m[4]+this.m[2]*P.m[5]+this.m[4],x=this.m[1]*P.m[4]+this.m[3]*P.m[5]+this.m[5];return this.m[0]=V,this.m[1]=U,this.m[2]=N,this.m[3]=C,this.m[4]=O,this.m[5]=x,this}invert(){const P=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),V=this.m[3]*P,U=-this.m[1]*P,N=-this.m[2]*P,C=this.m[0]*P,O=P*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),x=P*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=V,this.m[1]=U,this.m[2]=N,this.m[3]=C,this.m[4]=O,this.m[5]=x,this}getMatrix(){return this.m}decompose(){const P=this.m[0],V=this.m[1],U=this.m[2],N=this.m[3],C=this.m[4],O=this.m[5],x=P*N-V*U,L={x:C,y:O,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(P!=0||V!=0){const z=Math.sqrt(P*P+V*V);L.rotation=V>0?Math.acos(P/z):-Math.acos(P/z),L.scaleX=z,L.scaleY=x/z,L.skewX=(P*U+V*N)/x,L.skewY=0}else if(U!=0||N!=0){const z=Math.sqrt(U*U+N*N);L.rotation=Math.PI/2-(N>0?Math.acos(-U/z):-Math.acos(U/z)),L.scaleX=x/z,L.scaleY=z,L.skewX=0,L.skewY=(P*U+V*N)/x}return L.rotation=n.Util._getRotation(L.rotation),L}}n.Transform=t;const r="[object Array]",i="[object Number]",s="[object String]",o="[object Boolean]",l=Math.PI/180,c=180/Math.PI,d="#",p="",_="0",m="Konva warning: ",S="Konva error: ",E="rgb(",A={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},D=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let k=[];const R=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(w){setTimeout(w,60)};n.Util={_isElement(w){return!!(w&&w.nodeType==1)},_isFunction(w){return!!(w&&w.constructor&&w.call&&w.apply)},_isPlainObject(w){return!!w&&w.constructor===Object},_isArray(w){return Object.prototype.toString.call(w)===r},_isNumber(w){return Object.prototype.toString.call(w)===i&&!isNaN(w)&&isFinite(w)},_isString(w){return Object.prototype.toString.call(w)===s},_isBoolean(w){return Object.prototype.toString.call(w)===o},isObject(w){return w instanceof Object},isValidSelector(w){if(typeof w!="string")return!1;const P=w[0];return P==="#"||P==="."||P===P.toUpperCase()},_sign(w){return w===0||w>0?1:-1},requestAnimFrame(w){k.push(w),k.length===1&&R(function(){const P=k;k=[],P.forEach(function(V){V()})})},createCanvasElement(){const w=document.createElement("canvas");try{w.style=w.style||{}}catch{}return w},createImageElement(){return document.createElement("img")},_isInDocument(w){for(;w=w.parentNode;)if(w==document)return!0;return!1},_urlToImage(w,P){const V=n.Util.createImageElement();V.onload=function(){P(V)},V.src=w},_rgbToHex(w,P,V){return((1<<24)+(w<<16)+(P<<8)+V).toString(16).slice(1)},_hexToRgb(w){w=w.replace(d,p);const P=parseInt(w,16);return{r:P>>16&255,g:P>>8&255,b:P&255}},getRandomColor(){let w=(Math.random()*16777215<<0).toString(16);for(;w.length<6;)w=_+w;return d+w},getRGB(w){let P;return w in A?(P=A[w],{r:P[0],g:P[1],b:P[2]}):w[0]===d?this._hexToRgb(w.substring(1)):w.substr(0,4)===E?(P=D.exec(w.replace(/ /g,"")),{r:parseInt(P[1],10),g:parseInt(P[2],10),b:parseInt(P[3],10)}):{r:0,g:0,b:0}},colorToRGBA(w){return w=w||"black",n.Util._namedColorToRBA(w)||n.Util._hex3ColorToRGBA(w)||n.Util._hex4ColorToRGBA(w)||n.Util._hex6ColorToRGBA(w)||n.Util._hex8ColorToRGBA(w)||n.Util._rgbColorToRGBA(w)||n.Util._rgbaColorToRGBA(w)||n.Util._hslColorToRGBA(w)},_namedColorToRBA(w){const P=A[w.toLowerCase()];return P?{r:P[0],g:P[1],b:P[2],a:1}:null},_rgbColorToRGBA(w){if(w.indexOf("rgb(")===0){w=w.match(/rgb\(([^)]+)\)/)[1];const P=w.split(/ *, */).map(Number);return{r:P[0],g:P[1],b:P[2],a:1}}},_rgbaColorToRGBA(w){if(w.indexOf("rgba(")===0){w=w.match(/rgba\(([^)]+)\)/)[1];const P=w.split(/ *, */).map((V,U)=>V.slice(-1)==="%"?U===3?parseInt(V)/100:parseInt(V)/100*255:Number(V));return{r:P[0],g:P[1],b:P[2],a:P[3]}}},_hex8ColorToRGBA(w){if(w[0]==="#"&&w.length===9)return{r:parseInt(w.slice(1,3),16),g:parseInt(w.slice(3,5),16),b:parseInt(w.slice(5,7),16),a:parseInt(w.slice(7,9),16)/255}},_hex6ColorToRGBA(w){if(w[0]==="#"&&w.length===7)return{r:parseInt(w.slice(1,3),16),g:parseInt(w.slice(3,5),16),b:parseInt(w.slice(5,7),16),a:1}},_hex4ColorToRGBA(w){if(w[0]==="#"&&w.length===5)return{r:parseInt(w[1]+w[1],16),g:parseInt(w[2]+w[2],16),b:parseInt(w[3]+w[3],16),a:parseInt(w[4]+w[4],16)/255}},_hex3ColorToRGBA(w){if(w[0]==="#"&&w.length===4)return{r:parseInt(w[1]+w[1],16),g:parseInt(w[2]+w[2],16),b:parseInt(w[3]+w[3],16),a:1}},_hslColorToRGBA(w){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(w)){const[P,...V]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(w),U=Number(V[0])/360,N=Number(V[1])/100,C=Number(V[2])/100;let O,x,L;if(N===0)return L=C*255,{r:Math.round(L),g:Math.round(L),b:Math.round(L),a:1};C<.5?O=C*(1+N):O=C+N-C*N;const z=2*C-O,F=[0,0,0];for(let fe=0;fe<3;fe++)x=U+1/3*-(fe-1),x<0&&x++,x>1&&x--,6*x<1?L=z+(O-z)*6*x:2*x<1?L=O:3*x<2?L=z+(O-z)*(2/3-x)*6:L=z,F[fe]=L*255;return{r:Math.round(F[0]),g:Math.round(F[1]),b:Math.round(F[2]),a:1}}},haveIntersection(w,P){return!(P.x>w.x+w.width||P.x+P.width<w.x||P.y>w.y+w.height||P.y+P.height<w.y)},cloneObject(w){const P={};for(const V in w)this._isPlainObject(w[V])?P[V]=this.cloneObject(w[V]):this._isArray(w[V])?P[V]=this.cloneArray(w[V]):P[V]=w[V];return P},cloneArray(w){return w.slice(0)},degToRad(w){return w*l},radToDeg(w){return w*c},_degToRad(w){return n.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),n.Util.degToRad(w)},_radToDeg(w){return n.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),n.Util.radToDeg(w)},_getRotation(w){return e.Konva.angleDeg?n.Util.radToDeg(w):w},_capitalize(w){return w.charAt(0).toUpperCase()+w.slice(1)},throw(w){throw new Error(S+w)},error(w){console.error(S+w)},warn(w){e.Konva.showWarnings&&console.warn(m+w)},each(w,P){for(const V in w)P(V,w[V])},_inRange(w,P,V){return P<=w&&w<V},_getProjectionToSegment(w,P,V,U,N,C){let O,x,L;const z=(w-V)*(w-V)+(P-U)*(P-U);if(z==0)O=w,x=P,L=(N-V)*(N-V)+(C-U)*(C-U);else{const F=((N-w)*(V-w)+(C-P)*(U-P))/z;F<0?(O=w,x=P,L=(w-N)*(w-N)+(P-C)*(P-C)):F>1?(O=V,x=U,L=(V-N)*(V-N)+(U-C)*(U-C)):(O=w+F*(V-w),x=P+F*(U-P),L=(O-N)*(O-N)+(x-C)*(x-C))}return[O,x,L]},_getProjectionToLine(w,P,V){const U=n.Util.cloneObject(w);let N=Number.MAX_VALUE;return P.forEach(function(C,O){if(!V&&O===P.length-1)return;const x=P[(O+1)%P.length],L=n.Util._getProjectionToSegment(C.x,C.y,x.x,x.y,w.x,w.y),z=L[0],F=L[1],fe=L[2];fe<N&&(U.x=z,U.y=F,N=fe)}),U},_prepareArrayForTween(w,P,V){const U=[],N=[];if(w.length>P.length){const O=P;P=w,w=O}for(let O=0;O<w.length;O+=2)U.push({x:w[O],y:w[O+1]});for(let O=0;O<P.length;O+=2)N.push({x:P[O],y:P[O+1]});const C=[];return N.forEach(function(O){const x=n.Util._getProjectionToLine(O,U,V);C.push(x.x),C.push(x.y)}),C},_prepareToStringify(w){let P;w.visitedByCircularReferenceRemoval=!0;for(const V in w)if(w.hasOwnProperty(V)&&w[V]&&typeof w[V]=="object"){if(P=Object.getOwnPropertyDescriptor(w,V),w[V].visitedByCircularReferenceRemoval||n.Util._isElement(w[V]))if(P.configurable)delete w[V];else return null;else if(n.Util._prepareToStringify(w[V])===null)if(P.configurable)delete w[V];else return null}return delete w.visitedByCircularReferenceRemoval,w},_assign(w,P){for(const V in P)w[V]=P[V];return w},_getFirstPointerId(w){return w.touches?w.changedTouches[0].identifier:w.pointerId||999},releaseCanvas(...w){e.Konva.releaseCanvasOnDestroy&&w.forEach(P=>{P.width=0,P.height=0})},drawRoundedRectPath(w,P,V,U){let N=0,C=0,O=0,x=0;typeof U=="number"?N=C=O=x=Math.min(U,P/2,V/2):(N=Math.min(U[0]||0,P/2,V/2),C=Math.min(U[1]||0,P/2,V/2),x=Math.min(U[2]||0,P/2,V/2),O=Math.min(U[3]||0,P/2,V/2)),w.moveTo(N,0),w.lineTo(P-C,0),w.arc(P-C,C,C,Math.PI*3/2,0,!1),w.lineTo(P,V-x),w.arc(P-x,V-x,x,0,Math.PI/2,!1),w.lineTo(O,V),w.arc(O,V-O,O,Math.PI/2,Math.PI,!1),w.lineTo(0,N),w.arc(N,N,N,Math.PI,Math.PI*3/2,!1)}}})(Lt);var kt={},xi={},Bs={};Object.defineProperty(Bs,"__esModule",{value:!0});Bs.HitContext=Bs.SceneContext=Bs.Context=void 0;const kk=Lt,jz=be;function Gz(n){const e=[],t=n.length,r=kk.Util;for(let i=0;i<t;i++){let s=n[i];r._isNumber(s)?s=Math.round(s*1e3)/1e3:r._isString(s)||(s=s+""),e.push(s)}return e}const U3=",",Wz="(",Hz=")",$z="([",qz="])",Kz=";",Qz="()",Yz="=",z3=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],Xz=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],Jz=100;class O0{constructor(e){this.canvas=e,jz.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(e){e.fillEnabled()&&this._fill(e)}_fill(e){}strokeShape(e){e.hasStroke()&&this._stroke(e)}_stroke(e){}fillStrokeShape(e){e.attrs.fillAfterStrokeEnabled?(this.strokeShape(e),this.fillShape(e)):(this.fillShape(e),this.strokeShape(e))}getTrace(e,t){let r=this.traceArr,i=r.length,s="",o,l,c,d;for(o=0;o<i;o++)l=r[o],c=l.method,c?(d=l.args,s+=c,e?s+=Qz:kk.Util._isArray(d[0])?s+=$z+d.join(U3)+qz:(t&&(d=d.map(p=>typeof p=="number"?Math.floor(p):p)),s+=Wz+d.join(U3)+Hz)):(s+=l.property,e||(s+=Yz+l.val)),s+=Kz;return s}clearTrace(){this.traceArr=[]}_trace(e){let t=this.traceArr,r;t.push(e),r=t.length,r>=Jz&&t.shift()}reset(){const e=this.getCanvas().getPixelRatio();this.setTransform(1*e,0,0,1*e,0,0)}getCanvas(){return this.canvas}clear(e){const t=this.getCanvas();e?this.clearRect(e.x||0,e.y||0,e.width||0,e.height||0):this.clearRect(0,0,t.getWidth()/t.pixelRatio,t.getHeight()/t.pixelRatio)}_applyLineCap(e){const t=e.attrs.lineCap;t&&this.setAttr("lineCap",t)}_applyOpacity(e){const t=e.getAbsoluteOpacity();t!==1&&this.setAttr("globalAlpha",t)}_applyLineJoin(e){const t=e.attrs.lineJoin;t&&this.setAttr("lineJoin",t)}setAttr(e,t){this._context[e]=t}arc(e,t,r,i,s,o){this._context.arc(e,t,r,i,s,o)}arcTo(e,t,r,i,s){this._context.arcTo(e,t,r,i,s)}beginPath(){this._context.beginPath()}bezierCurveTo(e,t,r,i,s,o){this._context.bezierCurveTo(e,t,r,i,s,o)}clearRect(e,t,r,i){this._context.clearRect(e,t,r,i)}clip(...e){this._context.clip.apply(this._context,e)}closePath(){this._context.closePath()}createImageData(e,t){const r=arguments;if(r.length===2)return this._context.createImageData(e,t);if(r.length===1)return this._context.createImageData(e)}createLinearGradient(e,t,r,i){return this._context.createLinearGradient(e,t,r,i)}createPattern(e,t){return this._context.createPattern(e,t)}createRadialGradient(e,t,r,i,s,o){return this._context.createRadialGradient(e,t,r,i,s,o)}drawImage(e,t,r,i,s,o,l,c,d){const p=arguments,_=this._context;p.length===3?_.drawImage(e,t,r):p.length===5?_.drawImage(e,t,r,i,s):p.length===9&&_.drawImage(e,t,r,i,s,o,l,c,d)}ellipse(e,t,r,i,s,o,l,c){this._context.ellipse(e,t,r,i,s,o,l,c)}isPointInPath(e,t,r,i){return r?this._context.isPointInPath(r,e,t,i):this._context.isPointInPath(e,t,i)}fill(...e){this._context.fill.apply(this._context,e)}fillRect(e,t,r,i){this._context.fillRect(e,t,r,i)}strokeRect(e,t,r,i){this._context.strokeRect(e,t,r,i)}fillText(e,t,r,i){i?this._context.fillText(e,t,r,i):this._context.fillText(e,t,r)}measureText(e){return this._context.measureText(e)}getImageData(e,t,r,i){return this._context.getImageData(e,t,r,i)}lineTo(e,t){this._context.lineTo(e,t)}moveTo(e,t){this._context.moveTo(e,t)}rect(e,t,r,i){this._context.rect(e,t,r,i)}roundRect(e,t,r,i,s){this._context.roundRect(e,t,r,i,s)}putImageData(e,t,r){this._context.putImageData(e,t,r)}quadraticCurveTo(e,t,r,i){this._context.quadraticCurveTo(e,t,r,i)}restore(){this._context.restore()}rotate(e){this._context.rotate(e)}save(){this._context.save()}scale(e,t){this._context.scale(e,t)}setLineDash(e){this._context.setLineDash?this._context.setLineDash(e):"mozDash"in this._context?this._context.mozDash=e:"webkitLineDash"in this._context&&(this._context.webkitLineDash=e)}getLineDash(){return this._context.getLineDash()}setTransform(e,t,r,i,s,o){this._context.setTransform(e,t,r,i,s,o)}stroke(e){e?this._context.stroke(e):this._context.stroke()}strokeText(e,t,r,i){this._context.strokeText(e,t,r,i)}transform(e,t,r,i,s,o){this._context.transform(e,t,r,i,s,o)}translate(e,t){this._context.translate(e,t)}_enableTrace(){let e=this,t=z3.length,r=this.setAttr,i,s;const o=function(l){let c=e[l],d;e[l]=function(){return s=Gz(Array.prototype.slice.call(arguments,0)),d=c.apply(e,arguments),e._trace({method:l,args:s}),d}};for(i=0;i<t;i++)o(z3[i]);e.setAttr=function(){r.apply(e,arguments);const l=arguments[0];let c=arguments[1];(l==="shadowOffsetX"||l==="shadowOffsetY"||l==="shadowBlur")&&(c=c/this.canvas.getPixelRatio()),e._trace({property:l,val:c})}}_applyGlobalCompositeOperation(e){const t=e.attrs.globalCompositeOperation;!t||t==="source-over"||this.setAttr("globalCompositeOperation",t)}}Bs.Context=O0;Xz.forEach(function(n){Object.defineProperty(O0.prototype,n,{get(){return this._context[n]},set(e){this._context[n]=e}})});class Zz extends O0{constructor(e,{willReadFrequently:t=!1}={}){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:t})}_fillColor(e){const t=e.fill();this.setAttr("fillStyle",t),e._fillFunc(this)}_fillPattern(e){this.setAttr("fillStyle",e._getFillPattern()),e._fillFunc(this)}_fillLinearGradient(e){const t=e._getLinearGradient();t&&(this.setAttr("fillStyle",t),e._fillFunc(this))}_fillRadialGradient(e){const t=e._getRadialGradient();t&&(this.setAttr("fillStyle",t),e._fillFunc(this))}_fill(e){const t=e.fill(),r=e.getFillPriority();if(t&&r==="color"){this._fillColor(e);return}const i=e.getFillPatternImage();if(i&&r==="pattern"){this._fillPattern(e);return}const s=e.getFillLinearGradientColorStops();if(s&&r==="linear-gradient"){this._fillLinearGradient(e);return}const o=e.getFillRadialGradientColorStops();if(o&&r==="radial-gradient"){this._fillRadialGradient(e);return}t?this._fillColor(e):i?this._fillPattern(e):s?this._fillLinearGradient(e):o&&this._fillRadialGradient(e)}_strokeLinearGradient(e){const t=e.getStrokeLinearGradientStartPoint(),r=e.getStrokeLinearGradientEndPoint(),i=e.getStrokeLinearGradientColorStops(),s=this.createLinearGradient(t.x,t.y,r.x,r.y);if(i){for(let o=0;o<i.length;o+=2)s.addColorStop(i[o],i[o+1]);this.setAttr("strokeStyle",s)}}_stroke(e){const t=e.dash(),r=e.getStrokeScaleEnabled();if(e.hasStroke()){if(!r){this.save();const s=this.getCanvas().getPixelRatio();this.setTransform(s,0,0,s,0,0)}this._applyLineCap(e),t&&e.dashEnabled()&&(this.setLineDash(t),this.setAttr("lineDashOffset",e.dashOffset())),this.setAttr("lineWidth",e.strokeWidth()),e.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),e.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(e):this.setAttr("strokeStyle",e.stroke()),e._strokeFunc(this),r||this.restore()}}_applyShadow(e){var t,r,i;const s=(t=e.getShadowRGBA())!==null&&t!==void 0?t:"black",o=(r=e.getShadowBlur())!==null&&r!==void 0?r:5,l=(i=e.getShadowOffset())!==null&&i!==void 0?i:{x:0,y:0},c=e.getAbsoluteScale(),d=this.canvas.getPixelRatio(),p=c.x*d,_=c.y*d;this.setAttr("shadowColor",s),this.setAttr("shadowBlur",o*Math.min(Math.abs(p),Math.abs(_))),this.setAttr("shadowOffsetX",l.x*p),this.setAttr("shadowOffsetY",l.y*_)}}Bs.SceneContext=Zz;class eB extends O0{constructor(e){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:!0})}_fill(e){this.save(),this.setAttr("fillStyle",e.colorKey),e._fillFuncHit(this),this.restore()}strokeShape(e){e.hasHitStroke()&&this._stroke(e)}_stroke(e){if(e.hasHitStroke()){const t=e.getStrokeScaleEnabled();if(!t){this.save();const s=this.getCanvas().getPixelRatio();this.setTransform(s,0,0,s,0,0)}this._applyLineCap(e);const r=e.hitStrokeWidth(),i=r==="auto"?e.strokeWidth():r;this.setAttr("lineWidth",i),this.setAttr("strokeStyle",e.colorKey),e._strokeFuncHit(this),t||this.restore()}}}Bs.HitContext=eB;Object.defineProperty(xi,"__esModule",{value:!0});xi.HitCanvas=xi.SceneCanvas=xi.Canvas=void 0;const km=Lt,Ak=Bs,xk=be;let Kp;function tB(){if(Kp)return Kp;const n=km.Util.createCanvasElement(),e=n.getContext("2d");return Kp=function(){const t=xk.Konva._global.devicePixelRatio||1,r=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return t/r}(),km.Util.releaseCanvas(n),Kp}let KE=class{constructor(e){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const r=(e||{}).pixelRatio||xk.Konva.pixelRatio||tB();this.pixelRatio=r,this._canvas=km.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(e){const t=this.pixelRatio;this.pixelRatio=e,this.setSize(this.getWidth()/t,this.getHeight()/t)}setWidth(e){this.width=this._canvas.width=e*this.pixelRatio,this._canvas.style.width=e+"px";const t=this.pixelRatio;this.getContext()._context.scale(t,t)}setHeight(e){this.height=this._canvas.height=e*this.pixelRatio,this._canvas.style.height=e+"px";const t=this.pixelRatio;this.getContext()._context.scale(t,t)}getWidth(){return this.width}getHeight(){return this.height}setSize(e,t){this.setWidth(e||0),this.setHeight(t||0)}toDataURL(e,t){try{return this._canvas.toDataURL(e,t)}catch{try{return this._canvas.toDataURL()}catch(i){return km.Util.error("Unable to get data URL. "+i.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};xi.Canvas=KE;class nB extends KE{constructor(e={width:0,height:0,willReadFrequently:!1}){super(e),this.context=new Ak.SceneContext(this,{willReadFrequently:e.willReadFrequently}),this.setSize(e.width,e.height)}}xi.SceneCanvas=nB;class rB extends KE{constructor(e={width:0,height:0}){super(e),this.hitCanvas=!0,this.context=new Ak.HitContext(this),this.setSize(e.width,e.height)}}xi.HitCanvas=rB;var b0={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.DD=void 0;const e=be,t=Lt;n.DD={get isDragging(){let r=!1;return n.DD._dragElements.forEach(i=>{i.dragStatus==="dragging"&&(r=!0)}),r},justDragged:!1,get node(){let r;return n.DD._dragElements.forEach(i=>{r=i.node}),r},_dragElements:new Map,_drag(r){const i=[];n.DD._dragElements.forEach((s,o)=>{const{node:l}=s,c=l.getStage();c.setPointersPositions(r),s.pointerId===void 0&&(s.pointerId=t.Util._getFirstPointerId(r));const d=c._changedPointerPositions.find(p=>p.id===s.pointerId);if(d){if(s.dragStatus!=="dragging"){const p=l.dragDistance();if(Math.max(Math.abs(d.x-s.startPointerPos.x),Math.abs(d.y-s.startPointerPos.y))<p||(l.startDrag({evt:r}),!l.isDragging()))return}l._setDragPosition(r,s),i.push(l)}}),i.forEach(s=>{s.fire("dragmove",{type:"dragmove",target:s,evt:r},!0)})},_endDragBefore(r){const i=[];n.DD._dragElements.forEach(s=>{const{node:o}=s,l=o.getStage();if(r&&l.setPointersPositions(r),!l._changedPointerPositions.find(p=>p.id===s.pointerId))return;(s.dragStatus==="dragging"||s.dragStatus==="stopped")&&(n.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,s.dragStatus="stopped");const d=s.node.getLayer()||s.node instanceof e.Konva.Stage&&s.node;d&&i.indexOf(d)===-1&&i.push(d)}),i.forEach(s=>{s.draw()})},_endDragAfter(r){n.DD._dragElements.forEach((i,s)=>{i.dragStatus==="stopped"&&i.node.fire("dragend",{type:"dragend",target:i.node,evt:r},!0),i.dragStatus!=="dragging"&&n.DD._dragElements.delete(s)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",n.DD._endDragBefore,!0),window.addEventListener("touchend",n.DD._endDragBefore,!0),window.addEventListener("touchcancel",n.DD._endDragBefore,!0),window.addEventListener("mousemove",n.DD._drag),window.addEventListener("touchmove",n.DD._drag),window.addEventListener("mouseup",n.DD._endDragAfter,!1),window.addEventListener("touchend",n.DD._endDragAfter,!1),window.addEventListener("touchcancel",n.DD._endDragAfter,!1))})(b0);var Ue={},Pe={};Object.defineProperty(Pe,"__esModule",{value:!0});Pe.RGBComponent=iB;Pe.alphaComponent=sB;Pe.getNumberValidator=oB;Pe.getNumberOrArrayOfNumbersValidator=aB;Pe.getNumberOrAutoValidator=lB;Pe.getStringValidator=uB;Pe.getStringOrGradientValidator=cB;Pe.getFunctionValidator=hB;Pe.getNumberArrayValidator=dB;Pe.getBooleanValidator=fB;Pe.getComponentValidator=pB;const eo=be,Vt=Lt;function to(n){return Vt.Util._isString(n)?'"'+n+'"':Object.prototype.toString.call(n)==="[object Number]"||Vt.Util._isBoolean(n)?n:Object.prototype.toString.call(n)}function iB(n){return n>255?255:n<0?0:Math.round(n)}function sB(n){return n>1?1:n<1e-4?1e-4:n}function oB(){if(eo.Konva.isUnminified)return function(n,e){return Vt.Util._isNumber(n)||Vt.Util.warn(to(n)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),n}}function aB(n){if(eo.Konva.isUnminified)return function(e,t){let r=Vt.Util._isNumber(e),i=Vt.Util._isArray(e)&&e.length==n;return!r&&!i&&Vt.Util.warn(to(e)+' is a not valid value for "'+t+'" attribute. The value should be a number or Array<number>('+n+")"),e}}function lB(){if(eo.Konva.isUnminified)return function(n,e){return Vt.Util._isNumber(n)||n==="auto"||Vt.Util.warn(to(n)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),n}}function uB(){if(eo.Konva.isUnminified)return function(n,e){return Vt.Util._isString(n)||Vt.Util.warn(to(n)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),n}}function cB(){if(eo.Konva.isUnminified)return function(n,e){const t=Vt.Util._isString(n),r=Object.prototype.toString.call(n)==="[object CanvasGradient]"||n&&n.addColorStop;return t||r||Vt.Util.warn(to(n)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),n}}function hB(){if(eo.Konva.isUnminified)return function(n,e){return Vt.Util._isFunction(n)||Vt.Util.warn(to(n)+' is a not valid value for "'+e+'" attribute. The value should be a function.'),n}}function dB(){if(eo.Konva.isUnminified)return function(n,e){const t=Int8Array?Object.getPrototypeOf(Int8Array):null;return t&&n instanceof t||(Vt.Util._isArray(n)?n.forEach(function(r){Vt.Util._isNumber(r)||Vt.Util.warn('"'+e+'" attribute has non numeric element '+r+". Make sure that all elements are numbers.")}):Vt.Util.warn(to(n)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.')),n}}function fB(){if(eo.Konva.isUnminified)return function(n,e){return n===!0||n===!1||Vt.Util.warn(to(n)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),n}}function pB(n){if(eo.Konva.isUnminified)return function(e,t){return e==null||Vt.Util.isObject(e)||Vt.Util.warn(to(e)+' is a not valid value for "'+t+'" attribute. The value should be an object with properties '+n),e}}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Factory=void 0;const e=Lt,t=Pe,r="get",i="set";n.Factory={addGetterSetter(s,o,l,c,d){n.Factory.addGetter(s,o,l),n.Factory.addSetter(s,o,c,d),n.Factory.addOverloadedGetterSetter(s,o)},addGetter(s,o,l){const c=r+e.Util._capitalize(o);s.prototype[c]=s.prototype[c]||function(){const d=this.attrs[o];return d===void 0?l:d}},addSetter(s,o,l,c){const d=i+e.Util._capitalize(o);s.prototype[d]||n.Factory.overWriteSetter(s,o,l,c)},overWriteSetter(s,o,l,c){const d=i+e.Util._capitalize(o);s.prototype[d]=function(p){return l&&p!==void 0&&p!==null&&(p=l.call(this,p,o)),this._setAttr(o,p),c&&c.call(this),this}},addComponentsGetterSetter(s,o,l,c,d){const p=l.length,_=e.Util._capitalize,m=r+_(o),S=i+_(o);s.prototype[m]=function(){const A={};for(let D=0;D<p;D++){const k=l[D];A[k]=this.getAttr(o+_(k))}return A};const E=(0,t.getComponentValidator)(l);s.prototype[S]=function(A){const D=this.attrs[o];c&&(A=c.call(this,A,o)),E&&E.call(this,A,o);for(const k in A)A.hasOwnProperty(k)&&this._setAttr(o+_(k),A[k]);return A||l.forEach(k=>{this._setAttr(o+_(k),void 0)}),this._fireChangeEvent(o,D,A),d&&d.call(this),this},n.Factory.addOverloadedGetterSetter(s,o)},addOverloadedGetterSetter(s,o){const l=e.Util._capitalize(o),c=i+l,d=r+l;s.prototype[o]=function(){return arguments.length?(this[c](arguments[0]),this):this[d]()}},addDeprecatedGetterSetter(s,o,l,c){e.Util.error("Adding deprecated "+o);const d=r+e.Util._capitalize(o),p=o+" property is deprecated and will be removed soon. Look at Konva change log for more information.";s.prototype[d]=function(){e.Util.error(p);const _=this.attrs[o];return _===void 0?l:_},n.Factory.addSetter(s,o,c,function(){e.Util.error(p)}),n.Factory.addOverloadedGetterSetter(s,o)},backCompat(s,o){e.Util.each(o,function(l,c){const d=s.prototype[c],p=r+e.Util._capitalize(l),_=i+e.Util._capitalize(l);function m(){d.apply(this,arguments),e.Util.error('"'+l+'" method is deprecated and will be removed soon. Use ""'+c+'" instead.')}s.prototype[l]=m,s.prototype[p]=m,s.prototype[_]=m})},afterSetFilter(){this._filterUpToDate=!1}}})(Ue);Object.defineProperty(kt,"__esModule",{value:!0});kt.Node=void 0;const eu=xi,Jr=b0,gf=Ue,Eo=be,Ge=Lt,Ht=Pe,Sg="absoluteOpacity",Qp="allEventListeners",Ps="absoluteTransform",B3="absoluteScale",Ma="canvas",gB="Change",mB="children",_B="konva",c2="listening",yB="mouseenter",vB="mouseleave",wB="pointerenter",EB="pointerleave",SB="touchenter",TB="touchleave",j3="set",G3="Shape",Tg=" ",W3="stage",So="transform",CB="Stage",h2="visible",IB=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(Tg);let PB=1;class Ae{constructor(e){this._id=PB++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(e),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(e){(e===So||e===Ps)&&this._cache.get(e)?this._cache.get(e).dirty=!0:e?this._cache.delete(e):this._cache.clear()}_getCache(e,t){let r=this._cache.get(e);return(r===void 0||(e===So||e===Ps)&&r.dirty===!0)&&(r=t.call(this),this._cache.set(e,r)),r}_calculate(e,t,r){if(!this._attachedDepsListeners.get(e)){const i=t.map(s=>s+"Change.konva").join(Tg);this.on(i,()=>{this._clearCache(e)}),this._attachedDepsListeners.set(e,!0)}return this._getCache(e,r)}_getCanvasCache(){return this._cache.get(Ma)}_clearSelfAndDescendantCache(e){this._clearCache(e),e===Ps&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(Ma)){const{scene:e,filter:t,hit:r,buffer:i}=this._cache.get(Ma);Ge.Util.releaseCanvas(e,t,r,i),this._cache.delete(Ma)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(e){const t=e||{};let r={};(t.x===void 0||t.y===void 0||t.width===void 0||t.height===void 0)&&(r=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let i=Math.ceil(t.width||r.width),s=Math.ceil(t.height||r.height),o=t.pixelRatio,l=t.x===void 0?Math.floor(r.x):t.x,c=t.y===void 0?Math.floor(r.y):t.y,d=t.offset||0,p=t.drawBorder||!1,_=t.hitCanvasPixelRatio||1;if(!i||!s){Ge.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const m=Math.abs(Math.round(r.x)-l)>.5?1:0,S=Math.abs(Math.round(r.y)-c)>.5?1:0;i+=d*2+m,s+=d*2+S,l-=d,c-=d;const E=new eu.SceneCanvas({pixelRatio:o,width:i,height:s}),A=new eu.SceneCanvas({pixelRatio:o,width:0,height:0,willReadFrequently:!0}),D=new eu.HitCanvas({pixelRatio:_,width:i,height:s}),k=E.getContext(),R=D.getContext(),w=new eu.SceneCanvas({width:E.width/E.pixelRatio+Math.abs(l),height:E.height/E.pixelRatio+Math.abs(c),pixelRatio:E.pixelRatio}),P=w.getContext();return D.isCache=!0,E.isCache=!0,this._cache.delete(Ma),this._filterUpToDate=!1,t.imageSmoothingEnabled===!1&&(E.getContext()._context.imageSmoothingEnabled=!1,A.getContext()._context.imageSmoothingEnabled=!1),k.save(),R.save(),P.save(),k.translate(-l,-c),R.translate(-l,-c),P.translate(-l,-c),w.x=l,w.y=c,this._isUnderCache=!0,this._clearSelfAndDescendantCache(Sg),this._clearSelfAndDescendantCache(B3),this.drawScene(E,this,w),this.drawHit(D,this),this._isUnderCache=!1,k.restore(),R.restore(),p&&(k.save(),k.beginPath(),k.rect(0,0,i,s),k.closePath(),k.setAttr("strokeStyle","red"),k.setAttr("lineWidth",5),k.stroke(),k.restore()),this._cache.set(Ma,{scene:E,filter:A,hit:D,buffer:w,x:l,y:c}),this._requestDraw(),this}isCached(){return this._cache.has(Ma)}getClientRect(e){throw new Error('abstract "getClientRect" method call')}_transformedRect(e,t){const r=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}];let i=1/0,s=1/0,o=-1/0,l=-1/0;const c=this.getAbsoluteTransform(t);return r.forEach(function(d){const p=c.point(d);i===void 0&&(i=o=p.x,s=l=p.y),i=Math.min(i,p.x),s=Math.min(s,p.y),o=Math.max(o,p.x),l=Math.max(l,p.y)}),{x:i,y:s,width:o-i,height:l-s}}_drawCachedSceneCanvas(e){e.save(),e._applyOpacity(this),e._applyGlobalCompositeOperation(this);const t=this._getCanvasCache();e.translate(t.x,t.y);const r=this._getCachedSceneCanvas(),i=r.pixelRatio;e.drawImage(r._canvas,0,0,r.width/i,r.height/i),e.restore()}_drawCachedHitCanvas(e){const t=this._getCanvasCache(),r=t.hit;e.save(),e.translate(t.x,t.y),e.drawImage(r._canvas,0,0,r.width/r.pixelRatio,r.height/r.pixelRatio),e.restore()}_getCachedSceneCanvas(){let e=this.filters(),t=this._getCanvasCache(),r=t.scene,i=t.filter,s=i.getContext(),o,l,c,d;if(e){if(!this._filterUpToDate){const p=r.pixelRatio;i.setSize(r.width/r.pixelRatio,r.height/r.pixelRatio);try{for(o=e.length,s.clear(),s.drawImage(r._canvas,0,0,r.getWidth()/p,r.getHeight()/p),l=s.getImageData(0,0,i.getWidth(),i.getHeight()),c=0;c<o;c++){if(d=e[c],typeof d!="function"){Ge.Util.error("Filter should be type of function, but got "+typeof d+" instead. Please check correct filters");continue}d.call(this,l),s.putImageData(l,0,0)}}catch(_){Ge.Util.error("Unable to apply filter. "+_.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return i}return r}on(e,t){if(this._cache&&this._cache.delete(Qp),arguments.length===3)return this._delegate.apply(this,arguments);const r=e.split(Tg);for(let i=0;i<r.length;i++){const o=r[i].split("."),l=o[0],c=o[1]||"";this.eventListeners[l]||(this.eventListeners[l]=[]),this.eventListeners[l].push({name:c,handler:t})}return this}off(e,t){let r=(e||"").split(Tg),i=r.length,s,o,l,c,d,p;if(this._cache&&this._cache.delete(Qp),!e)for(o in this.eventListeners)this._off(o);for(s=0;s<i;s++)if(l=r[s],c=l.split("."),d=c[0],p=c[1],d)this.eventListeners[d]&&this._off(d,p,t);else for(o in this.eventListeners)this._off(o,p,t);return this}dispatchEvent(e){const t={target:this,type:e.type,evt:e};return this.fire(e.type,t),this}addEventListener(e,t){return this.on(e,function(r){t.call(this,r.evt)}),this}removeEventListener(e){return this.off(e),this}_delegate(e,t,r){const i=this;this.on(e,function(s){const o=s.target.findAncestors(t,!0,i);for(let l=0;l<o.length;l++)s=Ge.Util.cloneObject(s),s.currentTarget=o[l],r.call(o[l],s)})}remove(){return this.isDragging()&&this.stopDrag(),Jr.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Ps),this._clearSelfAndDescendantCache(Sg),this._clearSelfAndDescendantCache(B3),this._clearSelfAndDescendantCache(W3),this._clearSelfAndDescendantCache(h2),this._clearSelfAndDescendantCache(c2)}_remove(){this._clearCaches();const e=this.getParent();e&&e.children&&(e.children.splice(this.index,1),e._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(e){const t="get"+Ge.Util._capitalize(e);return Ge.Util._isFunction(this[t])?this[t]():this.attrs[e]}getAncestors(){let e=this.getParent(),t=[];for(;e;)t.push(e),e=e.getParent();return t}getAttrs(){return this.attrs||{}}setAttrs(e){return this._batchTransformChanges(()=>{let t,r;if(!e)return this;for(t in e)t!==mB&&(r=j3+Ge.Util._capitalize(t),Ge.Util._isFunction(this[r])?this[r](e[t]):this._setAttr(t,e[t]))}),this}isListening(){return this._getCache(c2,this._isListening)}_isListening(e){if(!this.listening())return!1;const r=this.getParent();return r&&r!==e&&this!==e?r._isListening(e):!0}isVisible(){return this._getCache(h2,this._isVisible)}_isVisible(e){if(!this.visible())return!1;const r=this.getParent();return r&&r!==e&&this!==e?r._isVisible(e):!0}shouldDrawHit(e,t=!1){if(e)return this._isVisible(e)&&this._isListening(e);const r=this.getLayer();let i=!1;Jr.DD._dragElements.forEach(o=>{o.dragStatus==="dragging"&&(o.node.nodeType==="Stage"||o.node.getLayer()===r)&&(i=!0)});const s=!t&&!Eo.Konva.hitOnDragEnabled&&(i||Eo.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!s}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let e=this.getDepth(),t=this,r=0,i,s,o,l;function c(p){for(i=[],s=p.length,o=0;o<s;o++)l=p[o],r++,l.nodeType!==G3&&(i=i.concat(l.getChildren().slice())),l._id===t._id&&(o=s);i.length>0&&i[0].getDepth()<=e&&c(i)}const d=this.getStage();return t.nodeType!==CB&&d&&c(d.getChildren()),r}getDepth(){let e=0,t=this.parent;for(;t;)e++,t=t.parent;return e}_batchTransformChanges(e){this._batchingTransformChange=!0,e(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(So),this._clearSelfAndDescendantCache(Ps)),this._needClearTransformCache=!1}setPosition(e){return this._batchTransformChanges(()=>{this.x(e.x),this.y(e.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const e=this.getStage();if(!e)return null;const t=e.getPointerPosition();if(!t)return null;const r=this.getAbsoluteTransform().copy();return r.invert(),r.point(t)}getAbsolutePosition(e){let t=!1,r=this.parent;for(;r;){if(r.isCached()){t=!0;break}r=r.parent}t&&!e&&(e=!0);const i=this.getAbsoluteTransform(e).getMatrix(),s=new Ge.Transform,o=this.offset();return s.m=i.slice(),s.translate(o.x,o.y),s.getTranslation()}setAbsolutePosition(e){const{x:t,y:r,...i}=this._clearTransform();this.attrs.x=t,this.attrs.y=r,this._clearCache(So);const s=this._getAbsoluteTransform().copy();return s.invert(),s.translate(e.x,e.y),e={x:this.attrs.x+s.getTranslation().x,y:this.attrs.y+s.getTranslation().y},this._setTransform(i),this.setPosition({x:e.x,y:e.y}),this._clearCache(So),this._clearSelfAndDescendantCache(Ps),this}_setTransform(e){let t;for(t in e)this.attrs[t]=e[t]}_clearTransform(){const e={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,e}move(e){let t=e.x,r=e.y,i=this.x(),s=this.y();return t!==void 0&&(i+=t),r!==void 0&&(s+=r),this.setPosition({x:i,y:s}),this}_eachAncestorReverse(e,t){let r=[],i=this.getParent(),s,o;if(!(t&&t._id===this._id)){for(r.unshift(this);i&&(!t||i._id!==t._id);)r.unshift(i),i=i.parent;for(s=r.length,o=0;o<s;o++)e(r[o])}}rotate(e){return this.rotation(this.rotation()+e),this}moveToTop(){if(!this.parent)return Ge.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const e=this.index,t=this.parent.getChildren().length;return e<t-1?(this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return Ge.Util.warn("Node has no parent. moveUp function is ignored."),!1;const e=this.index,t=this.parent.getChildren().length;return e<t-1?(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return Ge.Util.warn("Node has no parent. moveDown function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return Ge.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(e){if(!this.parent)return Ge.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(e<0||e>=this.parent.children.length)&&Ge.Util.warn("Unexpected value "+e+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const t=this.index;return this.parent.children.splice(t,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(Sg,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let e=this.opacity();const t=this.getParent();return t&&!t._isUnderCache&&(e*=t.getAbsoluteOpacity()),e}moveTo(e){return this.getParent()!==e&&(this._remove(),e.add(this)),this}toObject(){let e=this.getAttrs(),t,r,i,s,o;const l={attrs:{},className:this.getClassName()};for(t in e)r=e[t],o=Ge.Util.isObject(r)&&!Ge.Util._isPlainObject(r)&&!Ge.Util._isArray(r),!o&&(i=typeof this[t]=="function"&&this[t],delete e[t],s=i?i.call(this):null,e[t]=r,s!==r&&(l.attrs[t]=r));return Ge.Util._prepareToStringify(l)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(e,t,r){const i=[];t&&this._isMatch(e)&&i.push(this);let s=this.parent;for(;s;){if(s===r)return i;s._isMatch(e)&&i.push(s),s=s.parent}return i}isAncestorOf(e){return!1}findAncestor(e,t,r){return this.findAncestors(e,t,r)[0]}_isMatch(e){if(!e)return!1;if(typeof e=="function")return e(this);let t=e.replace(/ /g,"").split(","),r=t.length,i,s;for(i=0;i<r;i++)if(s=t[i],Ge.Util.isValidSelector(s)||(Ge.Util.warn('Selector "'+s+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),Ge.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),Ge.Util.warn("Konva is awesome, right?")),s.charAt(0)==="#"){if(this.id()===s.slice(1))return!0}else if(s.charAt(0)==="."){if(this.hasName(s.slice(1)))return!0}else if(this.className===s||this.nodeType===s)return!0;return!1}getLayer(){const e=this.getParent();return e?e.getLayer():null}getStage(){return this._getCache(W3,this._getStage)}_getStage(){const e=this.getParent();return e?e.getStage():null}fire(e,t={},r){return t.target=t.target||this,r?this._fireAndBubble(e,t):this._fire(e,t),this}getAbsoluteTransform(e){return e?this._getAbsoluteTransform(e):this._getCache(Ps,this._getAbsoluteTransform)}_getAbsoluteTransform(e){let t;if(e)return t=new Ge.Transform,this._eachAncestorReverse(function(r){const i=r.transformsEnabled();i==="all"?t.multiply(r.getTransform()):i==="position"&&t.translate(r.x()-r.offsetX(),r.y()-r.offsetY())},e),t;{t=this._cache.get(Ps)||new Ge.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(t):t.reset();const r=this.transformsEnabled();if(r==="all")t.multiply(this.getTransform());else if(r==="position"){const i=this.attrs.x||0,s=this.attrs.y||0,o=this.attrs.offsetX||0,l=this.attrs.offsetY||0;t.translate(i-o,s-l)}return t.dirty=!1,t}}getAbsoluteScale(e){let t=this;for(;t;)t._isUnderCache&&(e=t),t=t.getParent();const i=this.getAbsoluteTransform(e).decompose();return{x:i.scaleX,y:i.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(So,this._getTransform)}_getTransform(){var e,t;const r=this._cache.get(So)||new Ge.Transform;r.reset();const i=this.x(),s=this.y(),o=Eo.Konva.getAngle(this.rotation()),l=(e=this.attrs.scaleX)!==null&&e!==void 0?e:1,c=(t=this.attrs.scaleY)!==null&&t!==void 0?t:1,d=this.attrs.skewX||0,p=this.attrs.skewY||0,_=this.attrs.offsetX||0,m=this.attrs.offsetY||0;return(i!==0||s!==0)&&r.translate(i,s),o!==0&&r.rotate(o),(d!==0||p!==0)&&r.skew(d,p),(l!==1||c!==1)&&r.scale(l,c),(_!==0||m!==0)&&r.translate(-1*_,-1*m),r.dirty=!1,r}clone(e){let t=Ge.Util.cloneObject(this.attrs),r,i,s,o,l;for(r in e)t[r]=e[r];const c=new this.constructor(t);for(r in this.eventListeners)for(i=this.eventListeners[r],s=i.length,o=0;o<s;o++)l=i[o],l.name.indexOf(_B)<0&&(c.eventListeners[r]||(c.eventListeners[r]=[]),c.eventListeners[r].push(l));return c}_toKonvaCanvas(e){e=e||{};const t=this.getClientRect(),r=this.getStage(),i=e.x!==void 0?e.x:Math.floor(t.x),s=e.y!==void 0?e.y:Math.floor(t.y),o=e.pixelRatio||1,l=new eu.SceneCanvas({width:e.width||Math.ceil(t.width)||(r?r.width():0),height:e.height||Math.ceil(t.height)||(r?r.height():0),pixelRatio:o}),c=l.getContext(),d=new eu.SceneCanvas({width:l.width/l.pixelRatio+Math.abs(i),height:l.height/l.pixelRatio+Math.abs(s),pixelRatio:l.pixelRatio});return e.imageSmoothingEnabled===!1&&(c._context.imageSmoothingEnabled=!1),c.save(),(i||s)&&c.translate(-1*i,-1*s),this.drawScene(l,void 0,d),c.restore(),l}toCanvas(e){return this._toKonvaCanvas(e)._canvas}toDataURL(e){e=e||{};const t=e.mimeType||null,r=e.quality||null,i=this._toKonvaCanvas(e).toDataURL(t,r);return e.callback&&e.callback(i),i}toImage(e){return new Promise((t,r)=>{try{const i=e==null?void 0:e.callback;i&&delete e.callback,Ge.Util._urlToImage(this.toDataURL(e),function(s){t(s),i==null||i(s)})}catch(i){r(i)}})}toBlob(e){return new Promise((t,r)=>{try{const i=e==null?void 0:e.callback;i&&delete e.callback,this.toCanvas(e).toBlob(s=>{t(s),i==null||i(s)},e==null?void 0:e.mimeType,e==null?void 0:e.quality)}catch(i){r(i)}})}setSize(e){return this.width(e.width),this.height(e.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():Eo.Konva.dragDistance}_off(e,t,r){let i=this.eventListeners[e],s,o,l;for(s=0;s<i.length;s++)if(o=i[s].name,l=i[s].handler,(o!=="konva"||t==="konva")&&(!t||o===t)&&(!r||r===l)){if(i.splice(s,1),i.length===0){delete this.eventListeners[e];break}s--}}_fireChangeEvent(e,t,r){this._fire(e+gB,{oldVal:t,newVal:r})}addName(e){if(!this.hasName(e)){const t=this.name(),r=t?t+" "+e:e;this.name(r)}return this}hasName(e){if(!e)return!1;const t=this.name();return t?(t||"").split(/\s/g).indexOf(e)!==-1:!1}removeName(e){const t=(this.name()||"").split(/\s/g),r=t.indexOf(e);return r!==-1&&(t.splice(r,1),this.name(t.join(" "))),this}setAttr(e,t){const r=this[j3+Ge.Util._capitalize(e)];return Ge.Util._isFunction(r)?r.call(this,t):this._setAttr(e,t),this}_requestDraw(){if(Eo.Konva.autoDrawEnabled){const e=this.getLayer()||this.getStage();e==null||e.batchDraw()}}_setAttr(e,t){const r=this.attrs[e];r===t&&!Ge.Util.isObject(t)||(t==null?delete this.attrs[e]:this.attrs[e]=t,this._shouldFireChangeEvents&&this._fireChangeEvent(e,r,t),this._requestDraw())}_setComponentAttr(e,t,r){let i;r!==void 0&&(i=this.attrs[e],i||(this.attrs[e]=this.getAttr(e)),this.attrs[e][t]=r,this._fireChangeEvent(e,i,r))}_fireAndBubble(e,t,r){t&&this.nodeType===G3&&(t.target=this);const i=[yB,vB,wB,EB,SB,TB];if(!(i.indexOf(e)!==-1&&(r&&(this===r||this.isAncestorOf&&this.isAncestorOf(r))||this.nodeType==="Stage"&&!r))){this._fire(e,t);const o=i.indexOf(e)!==-1&&r&&r.isAncestorOf&&r.isAncestorOf(this)&&!r.isAncestorOf(this.parent);(t&&!t.cancelBubble||!t)&&this.parent&&this.parent.isListening()&&!o&&(r&&r.parent?this._fireAndBubble.call(this.parent,e,t,r):this._fireAndBubble.call(this.parent,e,t))}}_getProtoListeners(e){var t,r,i;const s=(t=this._cache.get(Qp))!==null&&t!==void 0?t:{};let o=s==null?void 0:s[e];if(o===void 0){o=[];let l=Object.getPrototypeOf(this);for(;l;){const c=(i=(r=l.eventListeners)===null||r===void 0?void 0:r[e])!==null&&i!==void 0?i:[];o.push(...c),l=Object.getPrototypeOf(l)}s[e]=o,this._cache.set(Qp,s)}return o}_fire(e,t){t=t||{},t.currentTarget=this,t.type=e;const r=this._getProtoListeners(e);if(r)for(let s=0;s<r.length;s++)r[s].handler.call(this,t);const i=this.eventListeners[e];if(i)for(let s=0;s<i.length;s++)i[s].handler.call(this,t)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(e){const t=e?e.pointerId:void 0,r=this.getStage(),i=this.getAbsolutePosition();if(!r)return;const s=r._getPointerById(t)||r._changedPointerPositions[0]||i;Jr.DD._dragElements.set(this._id,{node:this,startPointerPos:s,offset:{x:s.x-i.x,y:s.y-i.y},dragStatus:"ready",pointerId:t})}startDrag(e,t=!0){Jr.DD._dragElements.has(this._id)||this._createDragElement(e);const r=Jr.DD._dragElements.get(this._id);r.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:e&&e.evt},t)}_setDragPosition(e,t){const r=this.getStage()._getPointerById(t.pointerId);if(!r)return;let i={x:r.x-t.offset.x,y:r.y-t.offset.y};const s=this.dragBoundFunc();if(s!==void 0){const o=s.call(this,i,e);o?i=o:Ge.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==i.x||this._lastPos.y!==i.y)&&(this.setAbsolutePosition(i),this._requestDraw()),this._lastPos=i}stopDrag(e){const t=Jr.DD._dragElements.get(this._id);t&&(t.dragStatus="stopped"),Jr.DD._endDragBefore(e),Jr.DD._endDragAfter(e)}setDraggable(e){this._setAttr("draggable",e),this._dragChange()}isDragging(){const e=Jr.DD._dragElements.get(this._id);return e?e.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(e){if(!(!(e.evt.button!==void 0)||Eo.Konva.dragButtons.indexOf(e.evt.button)>=0)||this.isDragging())return;let i=!1;Jr.DD._dragElements.forEach(s=>{this.isAncestorOf(s.node)&&(i=!0)}),i||this._createDragElement(e)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const t=Jr.DD._dragElements.get(this._id),r=t&&t.dragStatus==="dragging",i=t&&t.dragStatus==="ready";r?this.stopDrag():i&&Jr.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(e={x:0,y:0}){const t=this.getStage();if(!t)return!1;const r={x:-e.x,y:-e.y,width:t.width()+2*e.x,height:t.height()+2*e.y};return Ge.Util.haveIntersection(r,this.getClientRect())}static create(e,t){return Ge.Util._isString(e)&&(e=JSON.parse(e)),this._createNode(e,t)}static _createNode(e,t){let r=Ae.prototype.getClassName.call(e),i=e.children,s,o,l;t&&(e.attrs.container=t),Eo.Konva[r]||(Ge.Util.warn('Can not find a node with class name "'+r+'". Fallback to "Shape".'),r="Shape");const c=Eo.Konva[r];if(s=new c(e.attrs),i)for(o=i.length,l=0;l<o;l++)s.add(Ae._createNode(i[l]));return s}}kt.Node=Ae;Ae.prototype.nodeType="Node";Ae.prototype._attrsAffectingSize=[];Ae.prototype.eventListeners={};Ae.prototype.on.call(Ae.prototype,IB,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(So),this._clearSelfAndDescendantCache(Ps)});Ae.prototype.on.call(Ae.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(h2)});Ae.prototype.on.call(Ae.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(c2)});Ae.prototype.on.call(Ae.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(Sg)});const wt=gf.Factory.addGetterSetter;wt(Ae,"zIndex");wt(Ae,"absolutePosition");wt(Ae,"position");wt(Ae,"x",0,(0,Ht.getNumberValidator)());wt(Ae,"y",0,(0,Ht.getNumberValidator)());wt(Ae,"globalCompositeOperation","source-over",(0,Ht.getStringValidator)());wt(Ae,"opacity",1,(0,Ht.getNumberValidator)());wt(Ae,"name","",(0,Ht.getStringValidator)());wt(Ae,"id","",(0,Ht.getStringValidator)());wt(Ae,"rotation",0,(0,Ht.getNumberValidator)());gf.Factory.addComponentsGetterSetter(Ae,"scale",["x","y"]);wt(Ae,"scaleX",1,(0,Ht.getNumberValidator)());wt(Ae,"scaleY",1,(0,Ht.getNumberValidator)());gf.Factory.addComponentsGetterSetter(Ae,"skew",["x","y"]);wt(Ae,"skewX",0,(0,Ht.getNumberValidator)());wt(Ae,"skewY",0,(0,Ht.getNumberValidator)());gf.Factory.addComponentsGetterSetter(Ae,"offset",["x","y"]);wt(Ae,"offsetX",0,(0,Ht.getNumberValidator)());wt(Ae,"offsetY",0,(0,Ht.getNumberValidator)());wt(Ae,"dragDistance",void 0,(0,Ht.getNumberValidator)());wt(Ae,"width",0,(0,Ht.getNumberValidator)());wt(Ae,"height",0,(0,Ht.getNumberValidator)());wt(Ae,"listening",!0,(0,Ht.getBooleanValidator)());wt(Ae,"preventDefault",!0,(0,Ht.getBooleanValidator)());wt(Ae,"filters",void 0,function(n){return this._filterUpToDate=!1,n});wt(Ae,"visible",!0,(0,Ht.getBooleanValidator)());wt(Ae,"transformsEnabled","all",(0,Ht.getStringValidator)());wt(Ae,"size");wt(Ae,"dragBoundFunc");wt(Ae,"draggable",!1,(0,Ht.getBooleanValidator)());gf.Factory.backCompat(Ae,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var El={};Object.defineProperty(El,"__esModule",{value:!0});El.Container=void 0;const _c=Ue,gv=kt,M0=Pe;class Sl extends gv.Node{constructor(){super(...arguments),this.children=[]}getChildren(e){const t=this.children||[];return e?t.filter(e):t}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.destroy()}),this.children=[],this._requestDraw(),this}add(...e){if(e.length===0)return this;if(e.length>1){for(let r=0;r<e.length;r++)this.add(e[r]);return this}const t=e[0];return t.getParent()?(t.moveTo(this),this):(this._validateAdd(t),t.index=this.getChildren().length,t.parent=this,t._clearCaches(),this.getChildren().push(t),this._fire("add",{child:t}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(e){return this._generalFind(e,!1)}findOne(e){const t=this._generalFind(e,!0);return t.length>0?t[0]:void 0}_generalFind(e,t){const r=[];return this._descendants(i=>{const s=i._isMatch(e);return s&&r.push(i),!!(s&&t)}),r}_descendants(e){let t=!1;const r=this.getChildren();for(const i of r){if(t=e(i),t)return!0;if(i.hasChildren()&&(t=i._descendants(e),t))return!0}return!1}toObject(){const e=gv.Node.prototype.toObject.call(this);return e.children=[],this.getChildren().forEach(t=>{e.children.push(t.toObject())}),e}isAncestorOf(e){let t=e.getParent();for(;t;){if(t._id===this._id)return!0;t=t.getParent()}return!1}clone(e){const t=gv.Node.prototype.clone.call(this,e);return this.getChildren().forEach(function(r){t.add(r.clone())}),t}getAllIntersections(e){const t=[];return this.find("Shape").forEach(r=>{r.isVisible()&&r.intersects(e)&&t.push(r)}),t}_clearSelfAndDescendantCache(e){var t;super._clearSelfAndDescendantCache(e),!this.isCached()&&((t=this.children)===null||t===void 0||t.forEach(function(r){r._clearSelfAndDescendantCache(e)}))}_setChildrenIndices(){var e;(e=this.children)===null||e===void 0||e.forEach(function(t,r){t.index=r}),this._requestDraw()}drawScene(e,t,r){const i=this.getLayer(),s=e||i&&i.getCanvas(),o=s&&s.getContext(),l=this._getCanvasCache(),c=l&&l.scene,d=s&&s.isCache;if(!this.isVisible()&&!d)return this;if(c){o.save();const p=this.getAbsoluteTransform(t).getMatrix();o.transform(p[0],p[1],p[2],p[3],p[4],p[5]),this._drawCachedSceneCanvas(o),o.restore()}else this._drawChildren("drawScene",s,t,r);return this}drawHit(e,t){if(!this.shouldDrawHit(t))return this;const r=this.getLayer(),i=e||r&&r.hitCanvas,s=i&&i.getContext(),o=this._getCanvasCache();if(o&&o.hit){s.save();const c=this.getAbsoluteTransform(t).getMatrix();s.transform(c[0],c[1],c[2],c[3],c[4],c[5]),this._drawCachedHitCanvas(s),s.restore()}else this._drawChildren("drawHit",i,t);return this}_drawChildren(e,t,r,i){var s;const o=t&&t.getContext(),l=this.clipWidth(),c=this.clipHeight(),d=this.clipFunc(),p=typeof l=="number"&&typeof c=="number"||d,_=r===this;if(p){o.save();const S=this.getAbsoluteTransform(r);let E=S.getMatrix();o.transform(E[0],E[1],E[2],E[3],E[4],E[5]),o.beginPath();let A;if(d)A=d.call(this,o,this);else{const D=this.clipX(),k=this.clipY();o.rect(D||0,k||0,l,c)}o.clip.apply(o,A),E=S.copy().invert().getMatrix(),o.transform(E[0],E[1],E[2],E[3],E[4],E[5])}const m=!_&&this.globalCompositeOperation()!=="source-over"&&e==="drawScene";m&&(o.save(),o._applyGlobalCompositeOperation(this)),(s=this.children)===null||s===void 0||s.forEach(function(S){S[e](t,r,i)}),m&&o.restore(),p&&o.restore()}getClientRect(e={}){var t;const r=e.skipTransform,i=e.relativeTo;let s,o,l,c,d={x:1/0,y:1/0,width:0,height:0};const p=this;(t=this.children)===null||t===void 0||t.forEach(function(S){if(!S.visible())return;const E=S.getClientRect({relativeTo:p,skipShadow:e.skipShadow,skipStroke:e.skipStroke});E.width===0&&E.height===0||(s===void 0?(s=E.x,o=E.y,l=E.x+E.width,c=E.y+E.height):(s=Math.min(s,E.x),o=Math.min(o,E.y),l=Math.max(l,E.x+E.width),c=Math.max(c,E.y+E.height)))});const _=this.find("Shape");let m=!1;for(let S=0;S<_.length;S++)if(_[S]._isVisible(this)){m=!0;break}return m&&s!==void 0?d={x:s,y:o,width:l-s,height:c-o}:d={x:0,y:0,width:0,height:0},r?d:this._transformedRect(d,i)}}El.Container=Sl;_c.Factory.addComponentsGetterSetter(Sl,"clip",["x","y","width","height"]);_c.Factory.addGetterSetter(Sl,"clipX",void 0,(0,M0.getNumberValidator)());_c.Factory.addGetterSetter(Sl,"clipY",void 0,(0,M0.getNumberValidator)());_c.Factory.addGetterSetter(Sl,"clipWidth",void 0,(0,M0.getNumberValidator)());_c.Factory.addGetterSetter(Sl,"clipHeight",void 0,(0,M0.getNumberValidator)());_c.Factory.addGetterSetter(Sl,"clipFunc");var Nk={},ha={};Object.defineProperty(ha,"__esModule",{value:!0});ha.getCapturedShape=kB;ha.createEvent=QE;ha.hasPointerCapture=AB;ha.setPointerCapture=xB;ha.releaseCapture=Ok;const RB=be,Fd=new Map,Dk=RB.Konva._global.PointerEvent!==void 0;function kB(n){return Fd.get(n)}function QE(n){return{evt:n,pointerId:n.pointerId}}function AB(n,e){return Fd.get(n)===e}function xB(n,e){Ok(n),e.getStage()&&(Fd.set(n,e),Dk&&e._fire("gotpointercapture",QE(new PointerEvent("gotpointercapture"))))}function Ok(n,e){const t=Fd.get(n);if(!t)return;const r=t.getStage();r&&r.content,Fd.delete(n),Dk&&t._fire("lostpointercapture",QE(new PointerEvent("lostpointercapture")))}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Stage=n.stages=void 0;const e=Lt,t=Ue,r=El,i=be,s=xi,o=b0,l=be,c=ha,d="Stage",p="string",_="px",m="mouseout",S="mouseleave",E="mouseover",A="mouseenter",D="mousemove",k="mousedown",R="mouseup",w="pointermove",P="pointerdown",V="pointerup",U="pointercancel",N="lostpointercapture",C="pointerout",O="pointerleave",x="pointerover",L="pointerenter",z="contextmenu",F="touchstart",fe="touchend",se="touchmove",ze="touchcancel",De="wheel",Y=5,oe=[[A,"_pointerenter"],[k,"_pointerdown"],[D,"_pointermove"],[R,"_pointerup"],[S,"_pointerleave"],[F,"_pointerdown"],[se,"_pointermove"],[fe,"_pointerup"],[ze,"_pointercancel"],[E,"_pointerover"],[De,"_wheel"],[z,"_contextmenu"],[P,"_pointerdown"],[w,"_pointermove"],[V,"_pointerup"],[U,"_pointercancel"],[O,"_pointerleave"],[N,"_lostpointercapture"]],ne={mouse:{[C]:m,[O]:S,[x]:E,[L]:A,[w]:D,[P]:k,[V]:R,[U]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[C]:"touchout",[O]:"touchleave",[x]:"touchover",[L]:"touchenter",[w]:se,[P]:F,[V]:fe,[U]:ze,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[C]:C,[O]:O,[x]:x,[L]:L,[w]:w,[P]:P,[V]:V,[U]:U,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},ae=pt=>pt.indexOf("pointer")>=0?"pointer":pt.indexOf("touch")>=0?"touch":"mouse",pe=pt=>{const B=ae(pt);if(B==="pointer")return i.Konva.pointerEventsEnabled&&ne.pointer;if(B==="touch")return ne.touch;if(B==="mouse")return ne.mouse};function Se(pt={}){return(pt.clipFunc||pt.clipWidth||pt.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),pt}const en="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";n.stages=[];class At extends r.Container{constructor(B){super(Se(B)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),n.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{Se(this.attrs)}),this._checkVisibility()}_validateAdd(B){const Z=B.getType()==="Layer",_e=B.getType()==="FastLayer";Z||_e||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const B=this.visible()?"":"none";this.content.style.display=B}setContainer(B){if(typeof B===p){let Z;if(B.charAt(0)==="."){const _e=B.slice(1);B=document.getElementsByClassName(_e)[0]}else B.charAt(0)!=="#"?Z=B:Z=B.slice(1),B=document.getElementById(Z);if(!B)throw"Can not find container in document with id "+Z}return this._setAttr("container",B),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),B.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const B=this.children,Z=B.length;for(let _e=0;_e<Z;_e++)B[_e].clear();return this}clone(B){return B||(B={}),B.container=typeof document<"u"&&document.createElement("div"),r.Container.prototype.clone.call(this,B)}destroy(){super.destroy();const B=this.content;B&&e.Util._isInDocument(B)&&this.container().removeChild(B);const Z=n.stages.indexOf(this);return Z>-1&&n.stages.splice(Z,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const B=this._pointerPositions[0]||this._changedPointerPositions[0];return B?{x:B.x,y:B.y}:(e.Util.warn(en),null)}_getPointerById(B){return this._pointerPositions.find(Z=>Z.id===B)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(B){B=B||{},B.x=B.x||0,B.y=B.y||0,B.width=B.width||this.width(),B.height=B.height||this.height();const Z=new s.SceneCanvas({width:B.width,height:B.height,pixelRatio:B.pixelRatio||1}),_e=Z.getContext()._context,Ke=this.children;return(B.x||B.y)&&_e.translate(-1*B.x,-1*B.y),Ke.forEach(function(Re){if(!Re.isVisible())return;const ot=Re._toKonvaCanvas(B);_e.drawImage(ot._canvas,B.x,B.y,ot.getWidth()/ot.getPixelRatio(),ot.getHeight()/ot.getPixelRatio())}),Z}getIntersection(B){if(!B)return null;const Z=this.children,_e=Z.length,Ke=_e-1;for(let Re=Ke;Re>=0;Re--){const ot=Z[Re].getIntersection(B);if(ot)return ot}return null}_resizeDOM(){const B=this.width(),Z=this.height();this.content&&(this.content.style.width=B+_,this.content.style.height=Z+_),this.bufferCanvas.setSize(B,Z),this.bufferHitCanvas.setSize(B,Z),this.children.forEach(_e=>{_e.setSize({width:B,height:Z}),_e.draw()})}add(B,...Z){if(arguments.length>1){for(let Ke=0;Ke<arguments.length;Ke++)this.add(arguments[Ke]);return this}super.add(B);const _e=this.children.length;return _e>Y&&e.Util.warn("The stage has "+_e+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),B.setSize({width:this.width(),height:this.height()}),B.draw(),i.Konva.isBrowser&&this.content.appendChild(B.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(B){return c.hasPointerCapture(B,this)}setPointerCapture(B){c.setPointerCapture(B,this)}releaseCapture(B){c.releaseCapture(B,this)}getLayers(){return this.children}_bindContentEvents(){i.Konva.isBrowser&&oe.forEach(([B,Z])=>{this.content.addEventListener(B,_e=>{this[Z](_e)},{passive:!1})})}_pointerenter(B){this.setPointersPositions(B);const Z=pe(B.type);Z&&this._fire(Z.pointerenter,{evt:B,target:this,currentTarget:this})}_pointerover(B){this.setPointersPositions(B);const Z=pe(B.type);Z&&this._fire(Z.pointerover,{evt:B,target:this,currentTarget:this})}_getTargetShape(B){let Z=this[B+"targetShape"];return Z&&!Z.getStage()&&(Z=null),Z}_pointerleave(B){const Z=pe(B.type),_e=ae(B.type);if(!Z)return;this.setPointersPositions(B);const Ke=this._getTargetShape(_e),Re=!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled;Ke&&Re?(Ke._fireAndBubble(Z.pointerout,{evt:B}),Ke._fireAndBubble(Z.pointerleave,{evt:B}),this._fire(Z.pointerleave,{evt:B,target:this,currentTarget:this}),this[_e+"targetShape"]=null):Re&&(this._fire(Z.pointerleave,{evt:B,target:this,currentTarget:this}),this._fire(Z.pointerout,{evt:B,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(B){const Z=pe(B.type),_e=ae(B.type);if(!Z)return;this.setPointersPositions(B);let Ke=!1;this._changedPointerPositions.forEach(Re=>{const ot=this.getIntersection(Re);if(o.DD.justDragged=!1,i.Konva["_"+_e+"ListenClick"]=!0,!ot||!ot.isListening()){this[_e+"ClickStartShape"]=void 0;return}i.Konva.capturePointerEventsEnabled&&ot.setPointerCapture(Re.id),this[_e+"ClickStartShape"]=ot,ot._fireAndBubble(Z.pointerdown,{evt:B,pointerId:Re.id}),Ke=!0;const lt=B.type.indexOf("touch")>=0;ot.preventDefault()&&B.cancelable&&lt&&B.preventDefault()}),Ke||this._fire(Z.pointerdown,{evt:B,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(B){const Z=pe(B.type),_e=ae(B.type);if(!Z||(i.Konva.isDragging()&&o.DD.node.preventDefault()&&B.cancelable&&B.preventDefault(),this.setPointersPositions(B),!(!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled)))return;const Re={};let ot=!1;const lt=this._getTargetShape(_e);this._changedPointerPositions.forEach(mr=>{const rt=c.getCapturedShape(mr.id)||this.getIntersection(mr),li=mr.id,br={evt:B,pointerId:li},bi=lt!==rt;if(bi&&lt&&(lt._fireAndBubble(Z.pointerout,{...br},rt),lt._fireAndBubble(Z.pointerleave,{...br},rt)),rt){if(Re[rt._id])return;Re[rt._id]=!0}rt&&rt.isListening()?(ot=!0,bi&&(rt._fireAndBubble(Z.pointerover,{...br},lt),rt._fireAndBubble(Z.pointerenter,{...br},lt),this[_e+"targetShape"]=rt),rt._fireAndBubble(Z.pointermove,{...br})):lt&&(this._fire(Z.pointerover,{evt:B,target:this,currentTarget:this,pointerId:li}),this[_e+"targetShape"]=null)}),ot||this._fire(Z.pointermove,{evt:B,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(B){const Z=pe(B.type),_e=ae(B.type);if(!Z)return;this.setPointersPositions(B);const Ke=this[_e+"ClickStartShape"],Re=this[_e+"ClickEndShape"],ot={};let lt=!1;this._changedPointerPositions.forEach(mr=>{const rt=c.getCapturedShape(mr.id)||this.getIntersection(mr);if(rt){if(rt.releaseCapture(mr.id),ot[rt._id])return;ot[rt._id]=!0}const li=mr.id,br={evt:B,pointerId:li};let bi=!1;i.Konva["_"+_e+"InDblClickWindow"]?(bi=!0,clearTimeout(this[_e+"DblTimeout"])):o.DD.justDragged||(i.Konva["_"+_e+"InDblClickWindow"]=!0,clearTimeout(this[_e+"DblTimeout"])),this[_e+"DblTimeout"]=setTimeout(function(){i.Konva["_"+_e+"InDblClickWindow"]=!1},i.Konva.dblClickWindow),rt&&rt.isListening()?(lt=!0,this[_e+"ClickEndShape"]=rt,rt._fireAndBubble(Z.pointerup,{...br}),i.Konva["_"+_e+"ListenClick"]&&Ke&&Ke===rt&&(rt._fireAndBubble(Z.pointerclick,{...br}),bi&&Re&&Re===rt&&rt._fireAndBubble(Z.pointerdblclick,{...br}))):(this[_e+"ClickEndShape"]=null,i.Konva["_"+_e+"ListenClick"]&&this._fire(Z.pointerclick,{evt:B,target:this,currentTarget:this,pointerId:li}),bi&&this._fire(Z.pointerdblclick,{evt:B,target:this,currentTarget:this,pointerId:li}))}),lt||this._fire(Z.pointerup,{evt:B,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),i.Konva["_"+_e+"ListenClick"]=!1,B.cancelable&&_e!=="touch"&&_e!=="pointer"&&B.preventDefault()}_contextmenu(B){this.setPointersPositions(B);const Z=this.getIntersection(this.getPointerPosition());Z&&Z.isListening()?Z._fireAndBubble(z,{evt:B}):this._fire(z,{evt:B,target:this,currentTarget:this})}_wheel(B){this.setPointersPositions(B);const Z=this.getIntersection(this.getPointerPosition());Z&&Z.isListening()?Z._fireAndBubble(De,{evt:B}):this._fire(De,{evt:B,target:this,currentTarget:this})}_pointercancel(B){this.setPointersPositions(B);const Z=c.getCapturedShape(B.pointerId)||this.getIntersection(this.getPointerPosition());Z&&Z._fireAndBubble(V,c.createEvent(B)),c.releaseCapture(B.pointerId)}_lostpointercapture(B){c.releaseCapture(B.pointerId)}setPointersPositions(B){const Z=this._getContentPosition();let _e=null,Ke=null;B=B||window.event,B.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(B.touches,Re=>{this._pointerPositions.push({id:Re.identifier,x:(Re.clientX-Z.left)/Z.scaleX,y:(Re.clientY-Z.top)/Z.scaleY})}),Array.prototype.forEach.call(B.changedTouches||B.touches,Re=>{this._changedPointerPositions.push({id:Re.identifier,x:(Re.clientX-Z.left)/Z.scaleX,y:(Re.clientY-Z.top)/Z.scaleY})})):(_e=(B.clientX-Z.left)/Z.scaleX,Ke=(B.clientY-Z.top)/Z.scaleY,this.pointerPos={x:_e,y:Ke},this._pointerPositions=[{x:_e,y:Ke,id:e.Util._getFirstPointerId(B)}],this._changedPointerPositions=[{x:_e,y:Ke,id:e.Util._getFirstPointerId(B)}])}_setPointerPosition(B){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(B)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const B=this.content.getBoundingClientRect();return{top:B.top,left:B.left,scaleX:B.width/this.content.clientWidth||1,scaleY:B.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new s.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new s.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!i.Konva.isBrowser)return;const B=this.container();if(!B)throw"Stage has no container. A container is required.";B.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),B.appendChild(this.content),this._resizeDOM()}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(B){B.batchDraw()}),this}}n.Stage=At,At.prototype.nodeType=d,(0,l._registerNode)(At),t.Factory.addGetterSetter(At,"container"),i.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{n.stages.forEach(pt=>{pt.batchDraw()})})})(Nk);var mf={},cn={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Shape=n.shapes=void 0;const e=be,t=Lt,r=Ue,i=kt,s=Pe,o=be,l=ha,c="hasShadow",d="shadowRGBA",p="patternImage",_="linearGradient",m="radialGradient";let S;function E(){return S||(S=t.Util.createCanvasElement().getContext("2d"),S)}n.shapes={};function A(O){const x=this.attrs.fillRule;x?O.fill(x):O.fill()}function D(O){O.stroke()}function k(O){const x=this.attrs.fillRule;x?O.fill(x):O.fill()}function R(O){O.stroke()}function w(){this._clearCache(c)}function P(){this._clearCache(d)}function V(){this._clearCache(p)}function U(){this._clearCache(_)}function N(){this._clearCache(m)}class C extends i.Node{constructor(x){super(x);let L;for(;L=t.Util.getRandomColor(),!(L&&!(L in n.shapes)););this.colorKey=L,n.shapes[L]=this}getContext(){return t.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return t.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(c,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(p,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const L=E().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(L&&L.setTransform){const z=new t.Transform;z.translate(this.fillPatternX(),this.fillPatternY()),z.rotate(e.Konva.getAngle(this.fillPatternRotation())),z.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),z.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const F=z.getMatrix(),fe=typeof DOMMatrix>"u"?{a:F[0],b:F[1],c:F[2],d:F[3],e:F[4],f:F[5]}:new DOMMatrix(F);L.setTransform(fe)}return L}}_getLinearGradient(){return this._getCache(_,this.__getLinearGradient)}__getLinearGradient(){const x=this.fillLinearGradientColorStops();if(x){const L=E(),z=this.fillLinearGradientStartPoint(),F=this.fillLinearGradientEndPoint(),fe=L.createLinearGradient(z.x,z.y,F.x,F.y);for(let se=0;se<x.length;se+=2)fe.addColorStop(x[se],x[se+1]);return fe}}_getRadialGradient(){return this._getCache(m,this.__getRadialGradient)}__getRadialGradient(){const x=this.fillRadialGradientColorStops();if(x){const L=E(),z=this.fillRadialGradientStartPoint(),F=this.fillRadialGradientEndPoint(),fe=L.createRadialGradient(z.x,z.y,this.fillRadialGradientStartRadius(),F.x,F.y,this.fillRadialGradientEndRadius());for(let se=0;se<x.length;se+=2)fe.addColorStop(x[se],x[se+1]);return fe}}getShadowRGBA(){return this._getCache(d,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const x=t.Util.colorToRGBA(this.shadowColor());if(x)return"rgba("+x.r+","+x.g+","+x.b+","+x.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const x=this.hitStrokeWidth();return x==="auto"?this.hasStroke():this.strokeEnabled()&&!!x}intersects(x){const L=this.getStage();if(!L)return!1;const z=L.bufferHitCanvas;return z.getContext().clear(),this.drawHit(z,void 0,!0),z.context.getImageData(Math.round(x.x),Math.round(x.y),1,1).data[3]>0}destroy(){return i.Node.prototype.destroy.call(this),delete n.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(x){var L;if(!((L=this.attrs.perfectDrawEnabled)!==null&&L!==void 0?L:!0))return!1;const F=x||this.hasFill(),fe=this.hasStroke(),se=this.getAbsoluteOpacity()!==1;if(F&&fe&&se)return!0;const ze=this.hasShadow(),De=this.shadowForStrokeEnabled();return!!(F&&fe&&ze&&De)}setStrokeHitEnabled(x){t.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),x?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const x=this.size();return{x:this._centroid?-x.width/2:0,y:this._centroid?-x.height/2:0,width:x.width,height:x.height}}getClientRect(x={}){let L=!1,z=this.getParent();for(;z;){if(z.isCached()){L=!0;break}z=z.getParent()}const F=x.skipTransform,fe=x.relativeTo||L&&this.getStage()||void 0,se=this.getSelfRect(),De=!x.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,Y=se.width+De,oe=se.height+De,ne=!x.skipShadow&&this.hasShadow(),ae=ne?this.shadowOffsetX():0,pe=ne?this.shadowOffsetY():0,Se=Y+Math.abs(ae),en=oe+Math.abs(pe),At=ne&&this.shadowBlur()||0,pt=Se+At*2,B=en+At*2,Z={width:pt,height:B,x:-(De/2+At)+Math.min(ae,0)+se.x,y:-(De/2+At)+Math.min(pe,0)+se.y};return F?Z:this._transformedRect(Z,fe)}drawScene(x,L,z){const F=this.getLayer(),fe=x||F.getCanvas(),se=fe.getContext(),ze=this._getCanvasCache(),De=this.getSceneFunc(),Y=this.hasShadow();let oe;const ne=L===this;if(!this.isVisible()&&!ne)return this;if(ze){se.save();const ae=this.getAbsoluteTransform(L).getMatrix();return se.transform(ae[0],ae[1],ae[2],ae[3],ae[4],ae[5]),this._drawCachedSceneCanvas(se),se.restore(),this}if(!De)return this;if(se.save(),this._useBufferCanvas()){oe=this.getStage();const ae=z||oe.bufferCanvas,pe=ae.getContext();pe.clear(),pe.save(),pe._applyLineJoin(this);const Se=this.getAbsoluteTransform(L).getMatrix();pe.transform(Se[0],Se[1],Se[2],Se[3],Se[4],Se[5]),De.call(this,pe,this),pe.restore();const en=ae.pixelRatio;Y&&se._applyShadow(this),se._applyOpacity(this),se._applyGlobalCompositeOperation(this),se.drawImage(ae._canvas,ae.x||0,ae.y||0,ae.width/en,ae.height/en)}else{if(se._applyLineJoin(this),!ne){const ae=this.getAbsoluteTransform(L).getMatrix();se.transform(ae[0],ae[1],ae[2],ae[3],ae[4],ae[5]),se._applyOpacity(this),se._applyGlobalCompositeOperation(this)}Y&&se._applyShadow(this),De.call(this,se,this)}return se.restore(),this}drawHit(x,L,z=!1){if(!this.shouldDrawHit(L,z))return this;const F=this.getLayer(),fe=x||F.hitCanvas,se=fe&&fe.getContext(),ze=this.hitFunc()||this.sceneFunc(),De=this._getCanvasCache(),Y=De&&De.hit;if(this.colorKey||t.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),Y){se.save();const ne=this.getAbsoluteTransform(L).getMatrix();return se.transform(ne[0],ne[1],ne[2],ne[3],ne[4],ne[5]),this._drawCachedHitCanvas(se),se.restore(),this}if(!ze)return this;if(se.save(),se._applyLineJoin(this),!(this===L)){const ne=this.getAbsoluteTransform(L).getMatrix();se.transform(ne[0],ne[1],ne[2],ne[3],ne[4],ne[5])}return ze.call(this,se,this),se.restore(),this}drawHitFromCache(x=0){const L=this._getCanvasCache(),z=this._getCachedSceneCanvas(),F=L.hit,fe=F.getContext(),se=F.getWidth(),ze=F.getHeight();fe.clear(),fe.drawImage(z._canvas,0,0,se,ze);try{const De=fe.getImageData(0,0,se,ze),Y=De.data,oe=Y.length,ne=t.Util._hexToRgb(this.colorKey);for(let ae=0;ae<oe;ae+=4)Y[ae+3]>x?(Y[ae]=ne.r,Y[ae+1]=ne.g,Y[ae+2]=ne.b,Y[ae+3]=255):Y[ae+3]=0;fe.putImageData(De,0,0)}catch(De){t.Util.error("Unable to draw hit graph from cached scene canvas. "+De.message)}return this}hasPointerCapture(x){return l.hasPointerCapture(x,this)}setPointerCapture(x){l.setPointerCapture(x,this)}releaseCapture(x){l.releaseCapture(x,this)}}n.Shape=C,C.prototype._fillFunc=A,C.prototype._strokeFunc=D,C.prototype._fillFuncHit=k,C.prototype._strokeFuncHit=R,C.prototype._centroid=!1,C.prototype.nodeType="Shape",(0,o._registerNode)(C),C.prototype.eventListeners={},C.prototype.on.call(C.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",w),C.prototype.on.call(C.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",P),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",V),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",U),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",N),r.Factory.addGetterSetter(C,"stroke",void 0,(0,s.getStringOrGradientValidator)()),r.Factory.addGetterSetter(C,"strokeWidth",2,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillAfterStrokeEnabled",!1),r.Factory.addGetterSetter(C,"hitStrokeWidth","auto",(0,s.getNumberOrAutoValidator)()),r.Factory.addGetterSetter(C,"strokeHitEnabled",!0,(0,s.getBooleanValidator)()),r.Factory.addGetterSetter(C,"perfectDrawEnabled",!0,(0,s.getBooleanValidator)()),r.Factory.addGetterSetter(C,"shadowForStrokeEnabled",!0,(0,s.getBooleanValidator)()),r.Factory.addGetterSetter(C,"lineJoin"),r.Factory.addGetterSetter(C,"lineCap"),r.Factory.addGetterSetter(C,"sceneFunc"),r.Factory.addGetterSetter(C,"hitFunc"),r.Factory.addGetterSetter(C,"dash"),r.Factory.addGetterSetter(C,"dashOffset",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"shadowColor",void 0,(0,s.getStringValidator)()),r.Factory.addGetterSetter(C,"shadowBlur",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"shadowOpacity",1,(0,s.getNumberValidator)()),r.Factory.addComponentsGetterSetter(C,"shadowOffset",["x","y"]),r.Factory.addGetterSetter(C,"shadowOffsetX",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"shadowOffsetY",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillPatternImage"),r.Factory.addGetterSetter(C,"fill",void 0,(0,s.getStringOrGradientValidator)()),r.Factory.addGetterSetter(C,"fillPatternX",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillPatternY",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillLinearGradientColorStops"),r.Factory.addGetterSetter(C,"strokeLinearGradientColorStops"),r.Factory.addGetterSetter(C,"fillRadialGradientStartRadius",0),r.Factory.addGetterSetter(C,"fillRadialGradientEndRadius",0),r.Factory.addGetterSetter(C,"fillRadialGradientColorStops"),r.Factory.addGetterSetter(C,"fillPatternRepeat","repeat"),r.Factory.addGetterSetter(C,"fillEnabled",!0),r.Factory.addGetterSetter(C,"strokeEnabled",!0),r.Factory.addGetterSetter(C,"shadowEnabled",!0),r.Factory.addGetterSetter(C,"dashEnabled",!0),r.Factory.addGetterSetter(C,"strokeScaleEnabled",!0),r.Factory.addGetterSetter(C,"fillPriority","color"),r.Factory.addComponentsGetterSetter(C,"fillPatternOffset",["x","y"]),r.Factory.addGetterSetter(C,"fillPatternOffsetX",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillPatternOffsetY",0,(0,s.getNumberValidator)()),r.Factory.addComponentsGetterSetter(C,"fillPatternScale",["x","y"]),r.Factory.addGetterSetter(C,"fillPatternScaleX",1,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillPatternScaleY",1,(0,s.getNumberValidator)()),r.Factory.addComponentsGetterSetter(C,"fillLinearGradientStartPoint",["x","y"]),r.Factory.addComponentsGetterSetter(C,"strokeLinearGradientStartPoint",["x","y"]),r.Factory.addGetterSetter(C,"fillLinearGradientStartPointX",0),r.Factory.addGetterSetter(C,"strokeLinearGradientStartPointX",0),r.Factory.addGetterSetter(C,"fillLinearGradientStartPointY",0),r.Factory.addGetterSetter(C,"strokeLinearGradientStartPointY",0),r.Factory.addComponentsGetterSetter(C,"fillLinearGradientEndPoint",["x","y"]),r.Factory.addComponentsGetterSetter(C,"strokeLinearGradientEndPoint",["x","y"]),r.Factory.addGetterSetter(C,"fillLinearGradientEndPointX",0),r.Factory.addGetterSetter(C,"strokeLinearGradientEndPointX",0),r.Factory.addGetterSetter(C,"fillLinearGradientEndPointY",0),r.Factory.addGetterSetter(C,"strokeLinearGradientEndPointY",0),r.Factory.addComponentsGetterSetter(C,"fillRadialGradientStartPoint",["x","y"]),r.Factory.addGetterSetter(C,"fillRadialGradientStartPointX",0),r.Factory.addGetterSetter(C,"fillRadialGradientStartPointY",0),r.Factory.addComponentsGetterSetter(C,"fillRadialGradientEndPoint",["x","y"]),r.Factory.addGetterSetter(C,"fillRadialGradientEndPointX",0),r.Factory.addGetterSetter(C,"fillRadialGradientEndPointY",0),r.Factory.addGetterSetter(C,"fillPatternRotation",0),r.Factory.addGetterSetter(C,"fillRule",void 0,(0,s.getStringValidator)()),r.Factory.backCompat(C,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(cn);Object.defineProperty(mf,"__esModule",{value:!0});mf.Layer=void 0;const Cs=Lt,mv=El,tu=kt,YE=Ue,H3=xi,NB=Pe,DB=cn,OB=be,bB="#",MB="beforeDraw",LB="draw",bk=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],FB=bk.length;let yc=class extends mv.Container{constructor(e){super(e),this.canvas=new H3.SceneCanvas,this.hitCanvas=new H3.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(e){return this.getContext().clear(e),this.getHitCanvas().getContext().clear(e),this}setZIndex(e){super.setZIndex(e);const t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),e<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[e+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){tu.Node.prototype.moveToTop.call(this);const e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!tu.Node.prototype.moveUp.call(this))return!1;const t=this.getStage();return!t||!t.content?!1:(t.content.removeChild(this.getNativeCanvasElement()),this.index<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[this.index+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(tu.Node.prototype.moveDown.call(this)){const e=this.getStage();if(e){const t=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),t[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(tu.Node.prototype.moveToBottom.call(this)){const e=this.getStage();if(e){const t=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),t[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const e=this.getNativeCanvasElement();return tu.Node.prototype.remove.call(this),e&&e.parentNode&&Cs.Util._isInDocument(e)&&e.parentNode.removeChild(e),this}getStage(){return this.parent}setSize({width:e,height:t}){return this.canvas.setSize(e,t),this.hitCanvas.setSize(e,t),this._setSmoothEnabled(),this}_validateAdd(e){const t=e.getType();t!=="Group"&&t!=="Shape"&&Cs.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(e){return e=e||{},e.width=e.width||this.getWidth(),e.height=e.height||this.getHeight(),e.x=e.x!==void 0?e.x:this.x(),e.y=e.y!==void 0?e.y:this.y(),tu.Node.prototype._toKonvaCanvas.call(this,e)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){Cs.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){Cs.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,Cs.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(e){if(!this.isListening()||!this.isVisible())return null;let t=1,r=!1;for(;;){for(let i=0;i<FB;i++){const s=bk[i],o=this._getIntersection({x:e.x+s.x*t,y:e.y+s.y*t}),l=o.shape;if(l)return l;if(r=!!o.antialiased,!o.antialiased)break}if(r)t+=1;else return null}}_getIntersection(e){const t=this.hitCanvas.pixelRatio,r=this.hitCanvas.context.getImageData(Math.round(e.x*t),Math.round(e.y*t),1,1).data,i=r[3];if(i===255){const s=Cs.Util._rgbToHex(r[0],r[1],r[2]),o=DB.shapes[bB+s];return o?{shape:o}:{antialiased:!0}}else if(i>0)return{antialiased:!0};return{}}drawScene(e,t,r){const i=this.getLayer(),s=e||i&&i.getCanvas();return this._fire(MB,{node:this}),this.clearBeforeDraw()&&s.getContext().clear(),mv.Container.prototype.drawScene.call(this,s,t,r),this._fire(LB,{node:this}),this}drawHit(e,t){const r=this.getLayer(),i=e||r&&r.hitCanvas;return r&&r.clearBeforeDraw()&&r.getHitCanvas().getContext().clear(),mv.Container.prototype.drawHit.call(this,i,t),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(e){Cs.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(e)}getHitGraphEnabled(e){return Cs.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const e=this.parent;!!this.hitCanvas._canvas.parentNode?e.content.removeChild(this.hitCanvas._canvas):e.content.appendChild(this.hitCanvas._canvas)}destroy(){return Cs.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};mf.Layer=yc;yc.prototype.nodeType="Layer";(0,OB._registerNode)(yc);YE.Factory.addGetterSetter(yc,"imageSmoothingEnabled",!0);YE.Factory.addGetterSetter(yc,"clearBeforeDraw",!0);YE.Factory.addGetterSetter(yc,"hitGraphEnabled",!0,(0,NB.getBooleanValidator)());var L0={};Object.defineProperty(L0,"__esModule",{value:!0});L0.FastLayer=void 0;const VB=Lt,UB=mf,zB=be;class XE extends UB.Layer{constructor(e){super(e),this.listening(!1),VB.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}L0.FastLayer=XE;XE.prototype.nodeType="FastLayer";(0,zB._registerNode)(XE);var vc={};Object.defineProperty(vc,"__esModule",{value:!0});vc.Group=void 0;const BB=Lt,jB=El,GB=be;class JE extends jB.Container{_validateAdd(e){const t=e.getType();t!=="Group"&&t!=="Shape"&&BB.Util.throw("You may only add groups and shapes to groups.")}}vc.Group=JE;JE.prototype.nodeType="Group";(0,GB._registerNode)(JE);var wc={};Object.defineProperty(wc,"__esModule",{value:!0});wc.Animation=void 0;const _v=be,$3=Lt,yv=function(){return _v.glob.performance&&_v.glob.performance.now?function(){return _v.glob.performance.now()}:function(){return new Date().getTime()}}();class Ji{constructor(e,t){this.id=Ji.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:yv(),frameRate:0},this.func=e,this.setLayers(t)}setLayers(e){let t=[];return e&&(t=Array.isArray(e)?e:[e]),this.layers=t,this}getLayers(){return this.layers}addLayer(e){const t=this.layers,r=t.length;for(let i=0;i<r;i++)if(t[i]._id===e._id)return!1;return this.layers.push(e),!0}isRunning(){const t=Ji.animations,r=t.length;for(let i=0;i<r;i++)if(t[i].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=yv(),Ji._addAnimation(this),this}stop(){return Ji._removeAnimation(this),this}_updateFrameObject(e){this.frame.timeDiff=e-this.frame.lastTime,this.frame.lastTime=e,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(e){this.animations.push(e),this._handleAnimation()}static _removeAnimation(e){const t=e.id,r=this.animations,i=r.length;for(let s=0;s<i;s++)if(r[s].id===t){this.animations.splice(s,1);break}}static _runFrames(){const e={},t=this.animations;for(let r=0;r<t.length;r++){const i=t[r],s=i.layers,o=i.func;i._updateFrameObject(yv());const l=s.length;let c;if(o?c=o.call(i,i.frame)!==!1:c=!0,!!c)for(let d=0;d<l;d++){const p=s[d];p._id!==void 0&&(e[p._id]=p)}}for(const r in e)e.hasOwnProperty(r)&&e[r].batchDraw()}static _animationLoop(){const e=Ji;e.animations.length?(e._runFrames(),$3.Util.requestAnimFrame(e._animationLoop)):e.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,$3.Util.requestAnimFrame(this._animationLoop))}}wc.Animation=Ji;Ji.animations=[];Ji.animIdCounter=0;Ji.animRunning=!1;var Mk={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Easings=n.Tween=void 0;const e=Lt,t=wc,r=kt,i=be,s={node:1,duration:1,easing:1,onFinish:1,yoyo:1},o=1,l=2,c=3,d=["fill","stroke","shadowColor"];let p=0;class _{constructor(E,A,D,k,R,w,P){this.prop=E,this.propFunc=A,this.begin=k,this._pos=k,this.duration=w,this._change=0,this.prevPos=0,this.yoyo=P,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=D,this._change=R-this.begin,this.pause()}fire(E){const A=this[E];A&&A()}setTime(E){E>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():E<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=E,this.update())}getTime(){return this._time}setPosition(E){this.prevPos=this._pos,this.propFunc(E),this._pos=E}getPosition(E){return E===void 0&&(E=this._time),this.func(E,this.begin,this._change,this.duration)}play(){this.state=l,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=c,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(E){this.pause(),this._time=E,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const E=this.getTimer()-this._startTime;this.state===l?this.setTime(E):this.state===c&&this.setTime(this.duration-E)}pause(){this.state=o,this.fire("onPause")}getTimer(){return new Date().getTime()}}class m{constructor(E){const A=this,D=E.node,k=D._id,R=E.easing||n.Easings.Linear,w=!!E.yoyo;let P,V;typeof E.duration>"u"?P=.3:E.duration===0?P=.001:P=E.duration,this.node=D,this._id=p++;const U=D.getLayer()||(D instanceof i.Konva.Stage?D.getLayers():null);U||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new t.Animation(function(){A.tween.onEnterFrame()},U),this.tween=new _(V,function(N){A._tweenFunc(N)},R,0,1,P*1e3,w),this._addListeners(),m.attrs[k]||(m.attrs[k]={}),m.attrs[k][this._id]||(m.attrs[k][this._id]={}),m.tweens[k]||(m.tweens[k]={});for(V in E)s[V]===void 0&&this._addAttr(V,E[V]);this.reset(),this.onFinish=E.onFinish,this.onReset=E.onReset,this.onUpdate=E.onUpdate}_addAttr(E,A){const D=this.node,k=D._id;let R,w,P,V,U;const N=m.tweens[k][E];N&&delete m.attrs[k][N][E];let C=D.getAttr(E);if(e.Util._isArray(A))if(R=[],w=Math.max(A.length,C.length),E==="points"&&A.length!==C.length&&(A.length>C.length?(V=C,C=e.Util._prepareArrayForTween(C,A,D.closed())):(P=A,A=e.Util._prepareArrayForTween(A,C,D.closed()))),E.indexOf("fill")===0)for(let O=0;O<w;O++)if(O%2===0)R.push(A[O]-C[O]);else{const x=e.Util.colorToRGBA(C[O]);U=e.Util.colorToRGBA(A[O]),C[O]=x,R.push({r:U.r-x.r,g:U.g-x.g,b:U.b-x.b,a:U.a-x.a})}else for(let O=0;O<w;O++)R.push(A[O]-C[O]);else d.indexOf(E)!==-1?(C=e.Util.colorToRGBA(C),U=e.Util.colorToRGBA(A),R={r:U.r-C.r,g:U.g-C.g,b:U.b-C.b,a:U.a-C.a}):R=A-C;m.attrs[k][this._id][E]={start:C,diff:R,end:A,trueEnd:P,trueStart:V},m.tweens[k][E]=this._id}_tweenFunc(E){const A=this.node,D=m.attrs[A._id][this._id];let k,R,w,P,V,U,N,C;for(k in D){if(R=D[k],w=R.start,P=R.diff,C=R.end,e.Util._isArray(w))if(V=[],N=Math.max(w.length,C.length),k.indexOf("fill")===0)for(U=0;U<N;U++)U%2===0?V.push((w[U]||0)+P[U]*E):V.push("rgba("+Math.round(w[U].r+P[U].r*E)+","+Math.round(w[U].g+P[U].g*E)+","+Math.round(w[U].b+P[U].b*E)+","+(w[U].a+P[U].a*E)+")");else for(U=0;U<N;U++)V.push((w[U]||0)+P[U]*E);else d.indexOf(k)!==-1?V="rgba("+Math.round(w.r+P.r*E)+","+Math.round(w.g+P.g*E)+","+Math.round(w.b+P.b*E)+","+(w.a+P.a*E)+")":V=w+P*E;A.setAttr(k,V)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const E=this.node,A=m.attrs[E._id][this._id];A.points&&A.points.trueEnd&&E.setAttr("points",A.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const E=this.node,A=m.attrs[E._id][this._id];A.points&&A.points.trueStart&&E.points(A.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(E){return this.tween.seek(E*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const E=this.node._id,A=this._id,D=m.tweens[E];this.pause(),this.anim&&this.anim.stop();for(const k in D)delete m.tweens[E][k];delete m.attrs[E][A],m.tweens[E]&&(Object.keys(m.tweens[E]).length===0&&delete m.tweens[E],Object.keys(m.attrs[E]).length===0&&delete m.attrs[E])}}n.Tween=m,m.attrs={},m.tweens={},r.Node.prototype.to=function(S){const E=S.onFinish;S.node=this,S.onFinish=function(){this.destroy(),E&&E()},new m(S).play()},n.Easings={BackEaseIn(S,E,A,D){return A*(S/=D)*S*((1.70158+1)*S-1.70158)+E},BackEaseOut(S,E,A,D){return A*((S=S/D-1)*S*((1.70158+1)*S+1.70158)+1)+E},BackEaseInOut(S,E,A,D){let k=1.70158;return(S/=D/2)<1?A/2*(S*S*(((k*=1.525)+1)*S-k))+E:A/2*((S-=2)*S*(((k*=1.525)+1)*S+k)+2)+E},ElasticEaseIn(S,E,A,D,k,R){let w=0;return S===0?E:(S/=D)===1?E+A:(R||(R=D*.3),!k||k<Math.abs(A)?(k=A,w=R/4):w=R/(2*Math.PI)*Math.asin(A/k),-(k*Math.pow(2,10*(S-=1))*Math.sin((S*D-w)*(2*Math.PI)/R))+E)},ElasticEaseOut(S,E,A,D,k,R){let w=0;return S===0?E:(S/=D)===1?E+A:(R||(R=D*.3),!k||k<Math.abs(A)?(k=A,w=R/4):w=R/(2*Math.PI)*Math.asin(A/k),k*Math.pow(2,-10*S)*Math.sin((S*D-w)*(2*Math.PI)/R)+A+E)},ElasticEaseInOut(S,E,A,D,k,R){let w=0;return S===0?E:(S/=D/2)===2?E+A:(R||(R=D*(.3*1.5)),!k||k<Math.abs(A)?(k=A,w=R/4):w=R/(2*Math.PI)*Math.asin(A/k),S<1?-.5*(k*Math.pow(2,10*(S-=1))*Math.sin((S*D-w)*(2*Math.PI)/R))+E:k*Math.pow(2,-10*(S-=1))*Math.sin((S*D-w)*(2*Math.PI)/R)*.5+A+E)},BounceEaseOut(S,E,A,D){return(S/=D)<1/2.75?A*(7.5625*S*S)+E:S<2/2.75?A*(7.5625*(S-=1.5/2.75)*S+.75)+E:S<2.5/2.75?A*(7.5625*(S-=2.25/2.75)*S+.9375)+E:A*(7.5625*(S-=2.625/2.75)*S+.984375)+E},BounceEaseIn(S,E,A,D){return A-n.Easings.BounceEaseOut(D-S,0,A,D)+E},BounceEaseInOut(S,E,A,D){return S<D/2?n.Easings.BounceEaseIn(S*2,0,A,D)*.5+E:n.Easings.BounceEaseOut(S*2-D,0,A,D)*.5+A*.5+E},EaseIn(S,E,A,D){return A*(S/=D)*S+E},EaseOut(S,E,A,D){return-A*(S/=D)*(S-2)+E},EaseInOut(S,E,A,D){return(S/=D/2)<1?A/2*S*S+E:-A/2*(--S*(S-2)-1)+E},StrongEaseIn(S,E,A,D){return A*(S/=D)*S*S*S*S+E},StrongEaseOut(S,E,A,D){return A*((S=S/D-1)*S*S*S*S+1)+E},StrongEaseInOut(S,E,A,D){return(S/=D/2)<1?A/2*S*S*S*S*S+E:A/2*((S-=2)*S*S*S*S+2)+E},Linear(S,E,A,D){return A*S/D+E}}})(Mk);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Konva=void 0;const e=be,t=Lt,r=kt,i=El,s=Nk,o=mf,l=L0,c=vc,d=b0,p=cn,_=wc,m=Mk,S=Bs,E=xi;n.Konva=t.Util._assign(e.Konva,{Util:t.Util,Transform:t.Transform,Node:r.Node,Container:i.Container,Stage:s.Stage,stages:s.stages,Layer:o.Layer,FastLayer:l.FastLayer,Group:c.Group,DD:d.DD,Shape:p.Shape,shapes:p.shapes,Animation:_.Animation,Tween:m.Tween,Easings:m.Easings,Context:S.Context,Canvas:E.Canvas}),n.default=n.Konva})(Rm);var F0={};Object.defineProperty(F0,"__esModule",{value:!0});F0.Arc=void 0;const V0=Ue,WB=cn,q3=be,U0=Pe,HB=be;class no extends WB.Shape{_sceneFunc(e){const t=q3.Konva.getAngle(this.angle()),r=this.clockwise();e.beginPath(),e.arc(0,0,this.outerRadius(),0,t,r),e.arc(0,0,this.innerRadius(),t,0,!r),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}getSelfRect(){const e=this.innerRadius(),t=this.outerRadius(),r=this.clockwise(),i=q3.Konva.getAngle(r?360-this.angle():this.angle()),s=Math.cos(Math.min(i,Math.PI)),o=1,l=Math.sin(Math.min(Math.max(Math.PI,i),3*Math.PI/2)),c=Math.sin(Math.min(i,Math.PI/2)),d=s*(s>0?e:t),p=o*t,_=l*(l>0?e:t),m=c*(c>0?t:e);return{x:d,y:r?-1*m:_,width:p-d,height:m-_}}}F0.Arc=no;no.prototype._centroid=!0;no.prototype.className="Arc";no.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];(0,HB._registerNode)(no);V0.Factory.addGetterSetter(no,"innerRadius",0,(0,U0.getNumberValidator)());V0.Factory.addGetterSetter(no,"outerRadius",0,(0,U0.getNumberValidator)());V0.Factory.addGetterSetter(no,"angle",0,(0,U0.getNumberValidator)());V0.Factory.addGetterSetter(no,"clockwise",!1,(0,U0.getBooleanValidator)());var z0={},_f={};Object.defineProperty(_f,"__esModule",{value:!0});_f.Line=void 0;const B0=Ue,$B=be,qB=cn,Lk=Pe;function d2(n,e,t,r,i,s,o){const l=Math.sqrt(Math.pow(t-n,2)+Math.pow(r-e,2)),c=Math.sqrt(Math.pow(i-t,2)+Math.pow(s-r,2)),d=o*l/(l+c),p=o*c/(l+c),_=t-d*(i-n),m=r-d*(s-e),S=t+p*(i-n),E=r+p*(s-e);return[_,m,S,E]}function K3(n,e){const t=n.length,r=[];for(let i=2;i<t-2;i+=2){const s=d2(n[i-2],n[i-1],n[i],n[i+1],n[i+2],n[i+3],e);isNaN(s[0])||(r.push(s[0]),r.push(s[1]),r.push(n[i]),r.push(n[i+1]),r.push(s[2]),r.push(s[3]))}return r}let da=class extends qB.Shape{constructor(e){super(e),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(e){const t=this.points(),r=t.length,i=this.tension(),s=this.closed(),o=this.bezier();if(!r)return;let l=0;if(e.beginPath(),e.moveTo(t[0],t[1]),i!==0&&r>4){const c=this.getTensionPoints(),d=c.length;for(l=s?0:4,s||e.quadraticCurveTo(c[0],c[1],c[2],c[3]);l<d-2;)e.bezierCurveTo(c[l++],c[l++],c[l++],c[l++],c[l++],c[l++]);s||e.quadraticCurveTo(c[d-2],c[d-1],t[r-2],t[r-1])}else if(o)for(l=2;l<r;)e.bezierCurveTo(t[l++],t[l++],t[l++],t[l++],t[l++],t[l++]);else for(l=2;l<r;l+=2)e.lineTo(t[l],t[l+1]);s?(e.closePath(),e.fillStrokeShape(this)):e.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():K3(this.points(),this.tension())}_getTensionPointsClosed(){const e=this.points(),t=e.length,r=this.tension(),i=d2(e[t-2],e[t-1],e[0],e[1],e[2],e[3],r),s=d2(e[t-4],e[t-3],e[t-2],e[t-1],e[0],e[1],r),o=K3(e,r);return[i[2],i[3]].concat(o).concat([s[0],s[1],e[t-2],e[t-1],s[2],s[3],i[0],i[1],e[0],e[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let e=this.points();if(e.length<4)return{x:e[0]||0,y:e[1]||0,width:0,height:0};this.tension()!==0?e=[e[0],e[1],...this._getTensionPoints(),e[e.length-2],e[e.length-1]]:e=this.points();let t=e[0],r=e[0],i=e[1],s=e[1],o,l;for(let c=0;c<e.length/2;c++)o=e[c*2],l=e[c*2+1],t=Math.min(t,o),r=Math.max(r,o),i=Math.min(i,l),s=Math.max(s,l);return{x:t,y:i,width:r-t,height:s-i}}};_f.Line=da;da.prototype.className="Line";da.prototype._attrsAffectingSize=["points","bezier","tension"];(0,$B._registerNode)(da);B0.Factory.addGetterSetter(da,"closed",!1);B0.Factory.addGetterSetter(da,"bezier",!1);B0.Factory.addGetterSetter(da,"tension",0,(0,Lk.getNumberValidator)());B0.Factory.addGetterSetter(da,"points",[],(0,Lk.getNumberArrayValidator)());var Ec={},Fk={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.t2length=n.getQuadraticArcLength=n.getCubicArcLength=n.binomialCoefficients=n.cValues=n.tValues=void 0,n.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],n.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],n.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(o,l,c)=>{let d,p;const m=c/2;d=0;for(let S=0;S<20;S++)p=m*n.tValues[20][S]+m,d+=n.cValues[20][S]*r(o,l,p);return m*d};n.getCubicArcLength=e;const t=(o,l,c)=>{c===void 0&&(c=1);const d=o[0]-2*o[1]+o[2],p=l[0]-2*l[1]+l[2],_=2*o[1]-2*o[0],m=2*l[1]-2*l[0],S=4*(d*d+p*p),E=4*(d*_+p*m),A=_*_+m*m;if(S===0)return c*Math.sqrt(Math.pow(o[2]-o[0],2)+Math.pow(l[2]-l[0],2));const D=E/(2*S),k=A/S,R=c+D,w=k-D*D,P=R*R+w>0?Math.sqrt(R*R+w):0,V=D*D+w>0?Math.sqrt(D*D+w):0,U=D+Math.sqrt(D*D+w)!==0?w*Math.log(Math.abs((R+P)/(D+V))):0;return Math.sqrt(S)/2*(R*P-D*V+U)};n.getQuadraticArcLength=t;function r(o,l,c){const d=i(1,c,o),p=i(1,c,l),_=d*d+p*p;return Math.sqrt(_)}const i=(o,l,c)=>{const d=c.length-1;let p,_;if(d===0)return 0;if(o===0){_=0;for(let m=0;m<=d;m++)_+=n.binomialCoefficients[d][m]*Math.pow(1-l,d-m)*Math.pow(l,m)*c[m];return _}else{p=new Array(d);for(let m=0;m<d;m++)p[m]=d*(c[m+1]-c[m]);return i(o-1,l,p)}},s=(o,l,c)=>{let d=1,p=o/l,_=(o-c(p))/l,m=0;for(;d>.001;){const S=c(p+_),E=Math.abs(o-S)/l;if(E<d)d=E,p+=_;else{const A=c(p-_),D=Math.abs(o-A)/l;D<d?(d=D,p-=_):_/=2}if(m++,m>500)break}return p};n.t2length=s})(Fk);Object.defineProperty(Ec,"__esModule",{value:!0});Ec.Path=void 0;const KB=Ue,QB=be,YB=cn,nu=Fk;class on extends YB.Shape{constructor(e){super(e),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=on.parsePathData(this.data()),this.pathLength=on.getPathLength(this.dataArray)}_sceneFunc(e){const t=this.dataArray;e.beginPath();let r=!1;for(let i=0;i<t.length;i++){const s=t[i].command,o=t[i].points;switch(s){case"L":e.lineTo(o[0],o[1]);break;case"M":e.moveTo(o[0],o[1]);break;case"C":e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]);break;case"Q":e.quadraticCurveTo(o[0],o[1],o[2],o[3]);break;case"A":const l=o[0],c=o[1],d=o[2],p=o[3],_=o[4],m=o[5],S=o[6],E=o[7],A=d>p?d:p,D=d>p?1:d/p,k=d>p?p/d:1;e.translate(l,c),e.rotate(S),e.scale(D,k),e.arc(0,0,A,_,_+m,1-E),e.scale(1/D,1/k),e.rotate(-S),e.translate(-l,-c);break;case"z":r=!0,e.closePath();break}}!r&&!this.hasFill()?e.strokeShape(this):e.fillStrokeShape(this)}getSelfRect(){let e=[];this.dataArray.forEach(function(c){if(c.command==="A"){const d=c.points[4],p=c.points[5],_=c.points[4]+p;let m=Math.PI/180;if(Math.abs(d-_)<m&&(m=Math.abs(d-_)),p<0)for(let S=d-m;S>_;S-=m){const E=on.getPointOnEllipticalArc(c.points[0],c.points[1],c.points[2],c.points[3],S,0);e.push(E.x,E.y)}else for(let S=d+m;S<_;S+=m){const E=on.getPointOnEllipticalArc(c.points[0],c.points[1],c.points[2],c.points[3],S,0);e.push(E.x,E.y)}}else if(c.command==="C")for(let d=0;d<=1;d+=.01){const p=on.getPointOnCubicBezier(d,c.start.x,c.start.y,c.points[0],c.points[1],c.points[2],c.points[3],c.points[4],c.points[5]);e.push(p.x,p.y)}else e=e.concat(c.points)});let t=e[0],r=e[0],i=e[1],s=e[1],o,l;for(let c=0;c<e.length/2;c++)o=e[c*2],l=e[c*2+1],isNaN(o)||(t=Math.min(t,o),r=Math.max(r,o)),isNaN(l)||(i=Math.min(i,l),s=Math.max(s,l));return{x:t,y:i,width:r-t,height:s-i}}getLength(){return this.pathLength}getPointAtLength(e){return on.getPointAtLengthOfDataArray(e,this.dataArray)}static getLineLength(e,t,r,i){return Math.sqrt((r-e)*(r-e)+(i-t)*(i-t))}static getPathLength(e){let t=0;for(let r=0;r<e.length;++r)t+=e[r].pathLength;return t}static getPointAtLengthOfDataArray(e,t){let r,i=0,s=t.length;if(!s)return null;for(;i<s&&e>t[i].pathLength;)e-=t[i].pathLength,++i;if(i===s)return r=t[i-1].points.slice(-2),{x:r[0],y:r[1]};if(e<.01)return t[i].command==="M"?(r=t[i].points.slice(0,2),{x:r[0],y:r[1]}):{x:t[i].start.x,y:t[i].start.y};const o=t[i],l=o.points;switch(o.command){case"L":return on.getPointOnLine(e,o.start.x,o.start.y,l[0],l[1]);case"C":return on.getPointOnCubicBezier((0,nu.t2length)(e,on.getPathLength(t),A=>(0,nu.getCubicArcLength)([o.start.x,l[0],l[2],l[4]],[o.start.y,l[1],l[3],l[5]],A)),o.start.x,o.start.y,l[0],l[1],l[2],l[3],l[4],l[5]);case"Q":return on.getPointOnQuadraticBezier((0,nu.t2length)(e,on.getPathLength(t),A=>(0,nu.getQuadraticArcLength)([o.start.x,l[0],l[2]],[o.start.y,l[1],l[3]],A)),o.start.x,o.start.y,l[0],l[1],l[2],l[3]);case"A":const c=l[0],d=l[1],p=l[2],_=l[3],m=l[5],S=l[6];let E=l[4];return E+=m*e/o.pathLength,on.getPointOnEllipticalArc(c,d,p,_,E,S)}return null}static getPointOnLine(e,t,r,i,s,o,l){o=o??t,l=l??r;const c=this.getLineLength(t,r,i,s);if(c<1e-10)return{x:t,y:r};if(i===t)return{x:o,y:l+(s>r?e:-e)};const d=(s-r)/(i-t),p=Math.sqrt(e*e/(1+d*d))*(i<t?-1:1),_=d*p;if(Math.abs(l-r-d*(o-t))<1e-10)return{x:o+p,y:l+_};const m=((o-t)*(i-t)+(l-r)*(s-r))/(c*c),S=t+m*(i-t),E=r+m*(s-r),A=this.getLineLength(o,l,S,E),D=Math.sqrt(e*e-A*A),k=Math.sqrt(D*D/(1+d*d))*(i<t?-1:1),R=d*k;return{x:S+k,y:E+R}}static getPointOnCubicBezier(e,t,r,i,s,o,l,c,d){function p(D){return D*D*D}function _(D){return 3*D*D*(1-D)}function m(D){return 3*D*(1-D)*(1-D)}function S(D){return(1-D)*(1-D)*(1-D)}const E=c*p(e)+o*_(e)+i*m(e)+t*S(e),A=d*p(e)+l*_(e)+s*m(e)+r*S(e);return{x:E,y:A}}static getPointOnQuadraticBezier(e,t,r,i,s,o,l){function c(S){return S*S}function d(S){return 2*S*(1-S)}function p(S){return(1-S)*(1-S)}const _=o*c(e)+i*d(e)+t*p(e),m=l*c(e)+s*d(e)+r*p(e);return{x:_,y:m}}static getPointOnEllipticalArc(e,t,r,i,s,o){const l=Math.cos(o),c=Math.sin(o),d={x:r*Math.cos(s),y:i*Math.sin(s)};return{x:e+(d.x*l-d.y*c),y:t+(d.x*c+d.y*l)}}static parsePathData(e){if(!e)return[];let t=e;const r=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];t=t.replace(new RegExp(" ","g"),",");for(let _=0;_<r.length;_++)t=t.replace(new RegExp(r[_],"g"),"|"+r[_]);const i=t.split("|"),s=[],o=[];let l=0,c=0;const d=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let p;for(let _=1;_<i.length;_++){let m=i[_],S=m.charAt(0);for(m=m.slice(1),o.length=0;p=d.exec(m);)o.push(p[0]);const E=[];for(let A=0,D=o.length;A<D;A++){if(o[A]==="00"){E.push(0,0);continue}const k=parseFloat(o[A]);isNaN(k)?E.push(0):E.push(k)}for(;E.length>0&&!isNaN(E[0]);){let A="",D=[];const k=l,R=c;let w,P,V,U,N,C,O,x,L,z;switch(S){case"l":l+=E.shift(),c+=E.shift(),A="L",D.push(l,c);break;case"L":l=E.shift(),c=E.shift(),D.push(l,c);break;case"m":const F=E.shift(),fe=E.shift();if(l+=F,c+=fe,A="M",s.length>2&&s[s.length-1].command==="z"){for(let se=s.length-2;se>=0;se--)if(s[se].command==="M"){l=s[se].points[0]+F,c=s[se].points[1]+fe;break}}D.push(l,c),S="l";break;case"M":l=E.shift(),c=E.shift(),A="M",D.push(l,c),S="L";break;case"h":l+=E.shift(),A="L",D.push(l,c);break;case"H":l=E.shift(),A="L",D.push(l,c);break;case"v":c+=E.shift(),A="L",D.push(l,c);break;case"V":c=E.shift(),A="L",D.push(l,c);break;case"C":D.push(E.shift(),E.shift(),E.shift(),E.shift()),l=E.shift(),c=E.shift(),D.push(l,c);break;case"c":D.push(l+E.shift(),c+E.shift(),l+E.shift(),c+E.shift()),l+=E.shift(),c+=E.shift(),A="C",D.push(l,c);break;case"S":P=l,V=c,w=s[s.length-1],w.command==="C"&&(P=l+(l-w.points[2]),V=c+(c-w.points[3])),D.push(P,V,E.shift(),E.shift()),l=E.shift(),c=E.shift(),A="C",D.push(l,c);break;case"s":P=l,V=c,w=s[s.length-1],w.command==="C"&&(P=l+(l-w.points[2]),V=c+(c-w.points[3])),D.push(P,V,l+E.shift(),c+E.shift()),l+=E.shift(),c+=E.shift(),A="C",D.push(l,c);break;case"Q":D.push(E.shift(),E.shift()),l=E.shift(),c=E.shift(),D.push(l,c);break;case"q":D.push(l+E.shift(),c+E.shift()),l+=E.shift(),c+=E.shift(),A="Q",D.push(l,c);break;case"T":P=l,V=c,w=s[s.length-1],w.command==="Q"&&(P=l+(l-w.points[0]),V=c+(c-w.points[1])),l=E.shift(),c=E.shift(),A="Q",D.push(P,V,l,c);break;case"t":P=l,V=c,w=s[s.length-1],w.command==="Q"&&(P=l+(l-w.points[0]),V=c+(c-w.points[1])),l+=E.shift(),c+=E.shift(),A="Q",D.push(P,V,l,c);break;case"A":U=E.shift(),N=E.shift(),C=E.shift(),O=E.shift(),x=E.shift(),L=l,z=c,l=E.shift(),c=E.shift(),A="A",D=this.convertEndpointToCenterParameterization(L,z,l,c,O,x,U,N,C);break;case"a":U=E.shift(),N=E.shift(),C=E.shift(),O=E.shift(),x=E.shift(),L=l,z=c,l+=E.shift(),c+=E.shift(),A="A",D=this.convertEndpointToCenterParameterization(L,z,l,c,O,x,U,N,C);break}s.push({command:A||S,points:D,start:{x:k,y:R},pathLength:this.calcLength(k,R,A||S,D)})}(S==="z"||S==="Z")&&s.push({command:"z",points:[],start:void 0,pathLength:0})}return s}static calcLength(e,t,r,i){let s,o,l,c;const d=on;switch(r){case"L":return d.getLineLength(e,t,i[0],i[1]);case"C":return(0,nu.getCubicArcLength)([e,i[0],i[2],i[4]],[t,i[1],i[3],i[5]],1);case"Q":return(0,nu.getQuadraticArcLength)([e,i[0],i[2]],[t,i[1],i[3]],1);case"A":s=0;const p=i[4],_=i[5],m=i[4]+_;let S=Math.PI/180;if(Math.abs(p-m)<S&&(S=Math.abs(p-m)),o=d.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],p,0),_<0)for(c=p-S;c>m;c-=S)l=d.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],c,0),s+=d.getLineLength(o.x,o.y,l.x,l.y),o=l;else for(c=p+S;c<m;c+=S)l=d.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],c,0),s+=d.getLineLength(o.x,o.y,l.x,l.y),o=l;return l=d.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],m,0),s+=d.getLineLength(o.x,o.y,l.x,l.y),s}return 0}static convertEndpointToCenterParameterization(e,t,r,i,s,o,l,c,d){const p=d*(Math.PI/180),_=Math.cos(p)*(e-r)/2+Math.sin(p)*(t-i)/2,m=-1*Math.sin(p)*(e-r)/2+Math.cos(p)*(t-i)/2,S=_*_/(l*l)+m*m/(c*c);S>1&&(l*=Math.sqrt(S),c*=Math.sqrt(S));let E=Math.sqrt((l*l*(c*c)-l*l*(m*m)-c*c*(_*_))/(l*l*(m*m)+c*c*(_*_)));s===o&&(E*=-1),isNaN(E)&&(E=0);const A=E*l*m/c,D=E*-c*_/l,k=(e+r)/2+Math.cos(p)*A-Math.sin(p)*D,R=(t+i)/2+Math.sin(p)*A+Math.cos(p)*D,w=function(x){return Math.sqrt(x[0]*x[0]+x[1]*x[1])},P=function(x,L){return(x[0]*L[0]+x[1]*L[1])/(w(x)*w(L))},V=function(x,L){return(x[0]*L[1]<x[1]*L[0]?-1:1)*Math.acos(P(x,L))},U=V([1,0],[(_-A)/l,(m-D)/c]),N=[(_-A)/l,(m-D)/c],C=[(-1*_-A)/l,(-1*m-D)/c];let O=V(N,C);return P(N,C)<=-1&&(O=Math.PI),P(N,C)>=1&&(O=0),o===0&&O>0&&(O=O-2*Math.PI),o===1&&O<0&&(O=O+2*Math.PI),[k,R,l,c,U,O,p,o]}}Ec.Path=on;on.prototype.className="Path";on.prototype._attrsAffectingSize=["data"];(0,QB._registerNode)(on);KB.Factory.addGetterSetter(on,"data");Object.defineProperty(z0,"__esModule",{value:!0});z0.Arrow=void 0;const j0=Ue,XB=_f,Vk=Pe,JB=be,Q3=Ec;class Tl extends XB.Line{_sceneFunc(e){super._sceneFunc(e);const t=Math.PI*2,r=this.points();let i=r;const s=this.tension()!==0&&r.length>4;s&&(i=this.getTensionPoints());const o=this.pointerLength(),l=r.length;let c,d;if(s){const m=[i[i.length-4],i[i.length-3],i[i.length-2],i[i.length-1],r[l-2],r[l-1]],S=Q3.Path.calcLength(i[i.length-4],i[i.length-3],"C",m),E=Q3.Path.getPointOnQuadraticBezier(Math.min(1,1-o/S),m[0],m[1],m[2],m[3],m[4],m[5]);c=r[l-2]-E.x,d=r[l-1]-E.y}else c=r[l-2]-r[l-4],d=r[l-1]-r[l-3];const p=(Math.atan2(d,c)+t)%t,_=this.pointerWidth();this.pointerAtEnding()&&(e.save(),e.beginPath(),e.translate(r[l-2],r[l-1]),e.rotate(p),e.moveTo(0,0),e.lineTo(-o,_/2),e.lineTo(-o,-_/2),e.closePath(),e.restore(),this.__fillStroke(e)),this.pointerAtBeginning()&&(e.save(),e.beginPath(),e.translate(r[0],r[1]),s?(c=(i[0]+i[2])/2-r[0],d=(i[1]+i[3])/2-r[1]):(c=r[2]-r[0],d=r[3]-r[1]),e.rotate((Math.atan2(-d,-c)+t)%t),e.moveTo(0,0),e.lineTo(-o,_/2),e.lineTo(-o,-_/2),e.closePath(),e.restore(),this.__fillStroke(e))}__fillStroke(e){const t=this.dashEnabled();t&&(this.attrs.dashEnabled=!1,e.setLineDash([])),e.fillStrokeShape(this),t&&(this.attrs.dashEnabled=!0)}getSelfRect(){const e=super.getSelfRect(),t=this.pointerWidth()/2;return{x:e.x,y:e.y-t,width:e.width,height:e.height+t*2}}}z0.Arrow=Tl;Tl.prototype.className="Arrow";(0,JB._registerNode)(Tl);j0.Factory.addGetterSetter(Tl,"pointerLength",10,(0,Vk.getNumberValidator)());j0.Factory.addGetterSetter(Tl,"pointerWidth",10,(0,Vk.getNumberValidator)());j0.Factory.addGetterSetter(Tl,"pointerAtBeginning",!1);j0.Factory.addGetterSetter(Tl,"pointerAtEnding",!0);var G0={};Object.defineProperty(G0,"__esModule",{value:!0});G0.Circle=void 0;const ZB=Ue,ej=cn,tj=Pe,nj=be;class Sc extends ej.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius()!==e/2&&this.radius(e/2)}setHeight(e){this.radius()!==e/2&&this.radius(e/2)}}G0.Circle=Sc;Sc.prototype._centroid=!0;Sc.prototype.className="Circle";Sc.prototype._attrsAffectingSize=["radius"];(0,nj._registerNode)(Sc);ZB.Factory.addGetterSetter(Sc,"radius",0,(0,tj.getNumberValidator)());var W0={};Object.defineProperty(W0,"__esModule",{value:!0});W0.Ellipse=void 0;const ZE=Ue,rj=cn,Uk=Pe,ij=be;class fa extends rj.Shape{_sceneFunc(e){const t=this.radiusX(),r=this.radiusY();e.beginPath(),e.save(),t!==r&&e.scale(1,r/t),e.arc(0,0,t,0,Math.PI*2,!1),e.restore(),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(e){this.radiusX(e/2)}setHeight(e){this.radiusY(e/2)}}W0.Ellipse=fa;fa.prototype.className="Ellipse";fa.prototype._centroid=!0;fa.prototype._attrsAffectingSize=["radiusX","radiusY"];(0,ij._registerNode)(fa);ZE.Factory.addComponentsGetterSetter(fa,"radius",["x","y"]);ZE.Factory.addGetterSetter(fa,"radiusX",0,(0,Uk.getNumberValidator)());ZE.Factory.addGetterSetter(fa,"radiusY",0,(0,Uk.getNumberValidator)());var H0={};Object.defineProperty(H0,"__esModule",{value:!0});H0.Image=void 0;const vv=Lt,Cl=Ue,sj=cn,oj=be,yf=Pe;let os=class zk extends sj.Shape{constructor(e){super(e),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",t=>{this._removeImageLoad(t.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const e=this.image();e&&e.complete||e&&e.readyState===4||e&&e.addEventListener&&e.addEventListener("load",this._loadListener)}_removeImageLoad(e){e&&e.removeEventListener&&e.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const e=!!this.cornerRadius(),t=this.hasShadow();return e&&t?!0:super._useBufferCanvas(!0)}_sceneFunc(e){const t=this.getWidth(),r=this.getHeight(),i=this.cornerRadius(),s=this.attrs.image;let o;if(s){const l=this.attrs.cropWidth,c=this.attrs.cropHeight;l&&c?o=[s,this.cropX(),this.cropY(),l,c,0,0,t,r]:o=[s,0,0,t,r]}(this.hasFill()||this.hasStroke()||i)&&(e.beginPath(),i?vv.Util.drawRoundedRectPath(e,t,r,i):e.rect(0,0,t,r),e.closePath(),e.fillStrokeShape(this)),s&&(i&&e.clip(),e.drawImage.apply(e,o))}_hitFunc(e){const t=this.width(),r=this.height(),i=this.cornerRadius();e.beginPath(),i?vv.Util.drawRoundedRectPath(e,t,r,i):e.rect(0,0,t,r),e.closePath(),e.fillStrokeShape(this)}getWidth(){var e,t;return(e=this.attrs.width)!==null&&e!==void 0?e:(t=this.image())===null||t===void 0?void 0:t.width}getHeight(){var e,t;return(e=this.attrs.height)!==null&&e!==void 0?e:(t=this.image())===null||t===void 0?void 0:t.height}static fromURL(e,t,r=null){const i=vv.Util.createImageElement();i.onload=function(){const s=new zk({image:i});t(s)},i.onerror=r,i.crossOrigin="Anonymous",i.src=e}};H0.Image=os;os.prototype.className="Image";(0,oj._registerNode)(os);Cl.Factory.addGetterSetter(os,"cornerRadius",0,(0,yf.getNumberOrArrayOfNumbersValidator)(4));Cl.Factory.addGetterSetter(os,"image");Cl.Factory.addComponentsGetterSetter(os,"crop",["x","y","width","height"]);Cl.Factory.addGetterSetter(os,"cropX",0,(0,yf.getNumberValidator)());Cl.Factory.addGetterSetter(os,"cropY",0,(0,yf.getNumberValidator)());Cl.Factory.addGetterSetter(os,"cropWidth",0,(0,yf.getNumberValidator)());Cl.Factory.addGetterSetter(os,"cropHeight",0,(0,yf.getNumberValidator)());var ec={};Object.defineProperty(ec,"__esModule",{value:!0});ec.Tag=ec.Label=void 0;const $0=Ue,aj=cn,lj=vc,eS=Pe,Bk=be,jk=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],uj="Change.konva",cj="none",f2="up",p2="right",g2="down",m2="left",hj=jk.length;class tS extends lj.Group{constructor(e){super(e),this.on("add.konva",function(t){this._addListeners(t.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(e){let t=this,r;const i=function(){t._sync()};for(r=0;r<hj;r++)e.on(jk[r]+uj,i)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let e=this.getText(),t=this.getTag(),r,i,s,o,l,c,d;if(e&&t){switch(r=e.width(),i=e.height(),s=t.pointerDirection(),o=t.pointerWidth(),d=t.pointerHeight(),l=0,c=0,s){case f2:l=r/2,c=-1*d;break;case p2:l=r+o,c=i/2;break;case g2:l=r/2,c=i+d;break;case m2:l=-1*o,c=i/2;break}t.setAttrs({x:-1*l,y:-1*c,width:r,height:i}),e.setAttrs({x:-1*l,y:-1*c})}}}ec.Label=tS;tS.prototype.className="Label";(0,Bk._registerNode)(tS);class Il extends aj.Shape{_sceneFunc(e){const t=this.width(),r=this.height(),i=this.pointerDirection(),s=this.pointerWidth(),o=this.pointerHeight(),l=this.cornerRadius();let c=0,d=0,p=0,_=0;typeof l=="number"?c=d=p=_=Math.min(l,t/2,r/2):(c=Math.min(l[0]||0,t/2,r/2),d=Math.min(l[1]||0,t/2,r/2),_=Math.min(l[2]||0,t/2,r/2),p=Math.min(l[3]||0,t/2,r/2)),e.beginPath(),e.moveTo(c,0),i===f2&&(e.lineTo((t-s)/2,0),e.lineTo(t/2,-1*o),e.lineTo((t+s)/2,0)),e.lineTo(t-d,0),e.arc(t-d,d,d,Math.PI*3/2,0,!1),i===p2&&(e.lineTo(t,(r-o)/2),e.lineTo(t+s,r/2),e.lineTo(t,(r+o)/2)),e.lineTo(t,r-_),e.arc(t-_,r-_,_,0,Math.PI/2,!1),i===g2&&(e.lineTo((t+s)/2,r),e.lineTo(t/2,r+o),e.lineTo((t-s)/2,r)),e.lineTo(p,r),e.arc(p,r-p,p,Math.PI/2,Math.PI,!1),i===m2&&(e.lineTo(0,(r+o)/2),e.lineTo(-1*s,r/2),e.lineTo(0,(r-o)/2)),e.lineTo(0,c),e.arc(c,c,c,Math.PI,Math.PI*3/2,!1),e.closePath(),e.fillStrokeShape(this)}getSelfRect(){let e=0,t=0,r=this.pointerWidth(),i=this.pointerHeight(),s=this.pointerDirection(),o=this.width(),l=this.height();return s===f2?(t-=i,l+=i):s===g2?l+=i:s===m2?(e-=r*1.5,o+=r):s===p2&&(o+=r*1.5),{x:e,y:t,width:o,height:l}}}ec.Tag=Il;Il.prototype.className="Tag";(0,Bk._registerNode)(Il);$0.Factory.addGetterSetter(Il,"pointerDirection",cj);$0.Factory.addGetterSetter(Il,"pointerWidth",0,(0,eS.getNumberValidator)());$0.Factory.addGetterSetter(Il,"pointerHeight",0,(0,eS.getNumberValidator)());$0.Factory.addGetterSetter(Il,"cornerRadius",0,(0,eS.getNumberOrArrayOfNumbersValidator)(4));var vf={};Object.defineProperty(vf,"__esModule",{value:!0});vf.Rect=void 0;const dj=Ue,fj=cn,pj=be,gj=Lt,mj=Pe;let q0=class extends fj.Shape{_sceneFunc(e){const t=this.cornerRadius(),r=this.width(),i=this.height();e.beginPath(),t?gj.Util.drawRoundedRectPath(e,r,i,t):e.rect(0,0,r,i),e.closePath(),e.fillStrokeShape(this)}};vf.Rect=q0;q0.prototype.className="Rect";(0,pj._registerNode)(q0);dj.Factory.addGetterSetter(q0,"cornerRadius",0,(0,mj.getNumberOrArrayOfNumbersValidator)(4));var K0={};Object.defineProperty(K0,"__esModule",{value:!0});K0.RegularPolygon=void 0;const Gk=Ue,_j=cn,Wk=Pe,yj=be;class Pl extends _j.Shape{_sceneFunc(e){const t=this._getPoints();e.beginPath(),e.moveTo(t[0].x,t[0].y);for(let r=1;r<t.length;r++)e.lineTo(t[r].x,t[r].y);e.closePath(),e.fillStrokeShape(this)}_getPoints(){const e=this.attrs.sides,t=this.attrs.radius||0,r=[];for(let i=0;i<e;i++)r.push({x:t*Math.sin(i*2*Math.PI/e),y:-1*t*Math.cos(i*2*Math.PI/e)});return r}getSelfRect(){const e=this._getPoints();let t=e[0].x,r=e[0].y,i=e[0].x,s=e[0].y;return e.forEach(o=>{t=Math.min(t,o.x),r=Math.max(r,o.x),i=Math.min(i,o.y),s=Math.max(s,o.y)}),{x:t,y:i,width:r-t,height:s-i}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}K0.RegularPolygon=Pl;Pl.prototype.className="RegularPolygon";Pl.prototype._centroid=!0;Pl.prototype._attrsAffectingSize=["radius"];(0,yj._registerNode)(Pl);Gk.Factory.addGetterSetter(Pl,"radius",0,(0,Wk.getNumberValidator)());Gk.Factory.addGetterSetter(Pl,"sides",0,(0,Wk.getNumberValidator)());var Q0={};Object.defineProperty(Q0,"__esModule",{value:!0});Q0.Ring=void 0;const Hk=Ue,vj=cn,$k=Pe,wj=be,Y3=Math.PI*2;class Rl extends vj.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.innerRadius(),0,Y3,!1),e.moveTo(this.outerRadius(),0),e.arc(0,0,this.outerRadius(),Y3,0,!0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}Q0.Ring=Rl;Rl.prototype.className="Ring";Rl.prototype._centroid=!0;Rl.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,wj._registerNode)(Rl);Hk.Factory.addGetterSetter(Rl,"innerRadius",0,(0,$k.getNumberValidator)());Hk.Factory.addGetterSetter(Rl,"outerRadius",0,(0,$k.getNumberValidator)());var Y0={};Object.defineProperty(Y0,"__esModule",{value:!0});Y0.Sprite=void 0;const kl=Ue,Ej=cn,Sj=wc,qk=Pe,Tj=be;class as extends Ej.Shape{constructor(e){super(e),this._updated=!0,this.anim=new Sj.Animation(()=>{const t=this._updated;return this._updated=!1,t}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(e){const t=this.animation(),r=this.frameIndex(),i=r*4,s=this.animations()[t],o=this.frameOffsets(),l=s[i+0],c=s[i+1],d=s[i+2],p=s[i+3],_=this.image();if((this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,d,p),e.closePath(),e.fillStrokeShape(this)),_)if(o){const m=o[t],S=r*2;e.drawImage(_,l,c,d,p,m[S+0],m[S+1],d,p)}else e.drawImage(_,l,c,d,p,0,0,d,p)}_hitFunc(e){const t=this.animation(),r=this.frameIndex(),i=r*4,s=this.animations()[t],o=this.frameOffsets(),l=s[i+2],c=s[i+3];if(e.beginPath(),o){const d=o[t],p=r*2;e.rect(d[p+0],d[p+1],l,c)}else e.rect(0,0,l,c);e.closePath(),e.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const e=this;this.interval=setInterval(function(){e._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const e=this.getLayer();this.anim.setLayers(e),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const e=this.frameIndex(),t=this.animation(),r=this.animations(),i=r[t],s=i.length/4;e<s-1?this.frameIndex(e+1):this.frameIndex(0)}}Y0.Sprite=as;as.prototype.className="Sprite";(0,Tj._registerNode)(as);kl.Factory.addGetterSetter(as,"animation");kl.Factory.addGetterSetter(as,"animations");kl.Factory.addGetterSetter(as,"frameOffsets");kl.Factory.addGetterSetter(as,"image");kl.Factory.addGetterSetter(as,"frameIndex",0,(0,qk.getNumberValidator)());kl.Factory.addGetterSetter(as,"frameRate",17,(0,qk.getNumberValidator)());kl.Factory.backCompat(as,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var X0={};Object.defineProperty(X0,"__esModule",{value:!0});X0.Star=void 0;const nS=Ue,Cj=cn,rS=Pe,Ij=be;class pa extends Cj.Shape{_sceneFunc(e){const t=this.innerRadius(),r=this.outerRadius(),i=this.numPoints();e.beginPath(),e.moveTo(0,0-r);for(let s=1;s<i*2;s++){const o=s%2===0?r:t,l=o*Math.sin(s*Math.PI/i),c=-1*o*Math.cos(s*Math.PI/i);e.lineTo(l,c)}e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}X0.Star=pa;pa.prototype.className="Star";pa.prototype._centroid=!0;pa.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,Ij._registerNode)(pa);nS.Factory.addGetterSetter(pa,"numPoints",5,(0,rS.getNumberValidator)());nS.Factory.addGetterSetter(pa,"innerRadius",0,(0,rS.getNumberValidator)());nS.Factory.addGetterSetter(pa,"outerRadius",0,(0,rS.getNumberValidator)());var Tc={};Object.defineProperty(Tc,"__esModule",{value:!0});Tc.Text=void 0;Tc.stringToArray=za;const _2=Lt,sr=Ue,Pj=cn,wv=be,ga=Pe,Rj=be;function za(n){return[...n].reduce((e,t,r,i)=>{if(new RegExp("\\p{Emoji}","u").test(t)){const s=i[r+1];s&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(s)?(e.push(t+s),i[r+1]=""):e.push(t)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(t+(i[r+1]||""))?e.push(t+i[r+1]):r>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(t)?e[e.length-1]+=t:t&&e.push(t);return e},[])}const ru="auto",kj="center",Kk="inherit",vh="justify",Aj="Change.konva",xj="2d",X3="-",Qk="left",Nj="text",Dj="Text",Oj="top",bj="bottom",J3="middle",Yk="normal",Mj="px ",Yp=" ",Lj="right",Z3="rtl",Fj="word",Vj="char",e5="none",Ev="…",Xk=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],Uj=Xk.length;function zj(n){return n.split(",").map(e=>{e=e.trim();const t=e.indexOf(" ")>=0,r=e.indexOf('"')>=0||e.indexOf("'")>=0;return t&&!r&&(e=`"${e}"`),e}).join(", ")}let Xp;function Sv(){return Xp||(Xp=_2.Util.createCanvasElement().getContext(xj),Xp)}function Bj(n){n.fillText(this._partialText,this._partialTextX,this._partialTextY)}function jj(n){n.setAttr("miterLimit",2),n.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function Gj(n){return n=n||{},!n.fillLinearGradientColorStops&&!n.fillRadialGradientColorStops&&!n.fillPatternImage&&(n.fill=n.fill||"black"),n}let Ut=class extends Pj.Shape{constructor(e){super(Gj(e)),this._partialTextX=0,this._partialTextY=0;for(let t=0;t<Uj;t++)this.on(Xk[t]+Aj,this._setTextData);this._setTextData()}_sceneFunc(e){const t=this.textArr,r=t.length;if(!this.text())return;let i=this.padding(),s=this.fontSize(),o=this.lineHeight()*s,l=this.verticalAlign(),c=this.direction(),d=0,p=this.align(),_=this.getWidth(),m=this.letterSpacing(),S=this.fill(),E=this.textDecoration(),A=E.indexOf("underline")!==-1,D=E.indexOf("line-through")!==-1,k;c=c===Kk?e.direction:c;let R=o/2,w=J3;if(wv.Konva._fixTextRendering){const P=this.measureSize("M");w="alphabetic",R=(P.fontBoundingBoxAscent-P.fontBoundingBoxDescent)/2+o/2}for(c===Z3&&e.setAttr("direction",c),e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",w),e.setAttr("textAlign",Qk),l===J3?d=(this.getHeight()-r*o-i*2)/2:l===bj&&(d=this.getHeight()-r*o-i*2),e.translate(i,d+i),k=0;k<r;k++){let P=0,V=0;const U=t[k],N=U.text,C=U.width,O=U.lastInParagraph;if(e.save(),p===Lj?P+=_-C-i*2:p===kj&&(P+=(_-C-i*2)/2),A){e.save(),e.beginPath();const x=wv.Konva._fixTextRendering?Math.round(s/4):Math.round(s/2),L=P,z=R+V+x;e.moveTo(L,z);const F=p===vh&&!O?_-i*2:C;e.lineTo(L+Math.round(F),z),e.lineWidth=s/15;const fe=this._getLinearGradient();e.strokeStyle=fe||S,e.stroke(),e.restore()}if(D){e.save(),e.beginPath();const x=wv.Konva._fixTextRendering?-Math.round(s/4):0;e.moveTo(P,R+V+x);const L=p===vh&&!O?_-i*2:C;e.lineTo(P+Math.round(L),R+V+x),e.lineWidth=s/15;const z=this._getLinearGradient();e.strokeStyle=z||S,e.stroke(),e.restore()}if(c!==Z3&&(m!==0||p===vh)){const x=N.split(" ").length-1,L=za(N);for(let z=0;z<L.length;z++){const F=L[z];F===" "&&!O&&p===vh&&(P+=(_-i*2-C)/x),this._partialTextX=P,this._partialTextY=R+V,this._partialText=F,e.fillStrokeShape(this),P+=this.measureSize(F).width+m}}else m!==0&&e.setAttr("letterSpacing",`${m}px`),this._partialTextX=P,this._partialTextY=R+V,this._partialText=N,e.fillStrokeShape(this);e.restore(),r>1&&(R+=o)}}_hitFunc(e){const t=this.getWidth(),r=this.getHeight();e.beginPath(),e.rect(0,0,t,r),e.closePath(),e.fillStrokeShape(this)}setText(e){const t=_2.Util._isString(e)?e:e==null?"":e+"";return this._setAttr(Nj,t),this}getWidth(){return this.attrs.width===ru||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===ru||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return _2.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(e){var t,r,i,s,o,l,c,d,p,_,m;let S=Sv(),E=this.fontSize(),A;S.save(),S.font=this._getContextFont(),A=S.measureText(e),S.restore();const D=E/100;return{actualBoundingBoxAscent:(t=A.actualBoundingBoxAscent)!==null&&t!==void 0?t:71.58203125*D,actualBoundingBoxDescent:(r=A.actualBoundingBoxDescent)!==null&&r!==void 0?r:0,actualBoundingBoxLeft:(i=A.actualBoundingBoxLeft)!==null&&i!==void 0?i:-7.421875*D,actualBoundingBoxRight:(s=A.actualBoundingBoxRight)!==null&&s!==void 0?s:75.732421875*D,alphabeticBaseline:(o=A.alphabeticBaseline)!==null&&o!==void 0?o:0,emHeightAscent:(l=A.emHeightAscent)!==null&&l!==void 0?l:100*D,emHeightDescent:(c=A.emHeightDescent)!==null&&c!==void 0?c:-20*D,fontBoundingBoxAscent:(d=A.fontBoundingBoxAscent)!==null&&d!==void 0?d:91*D,fontBoundingBoxDescent:(p=A.fontBoundingBoxDescent)!==null&&p!==void 0?p:21*D,hangingBaseline:(_=A.hangingBaseline)!==null&&_!==void 0?_:72.80000305175781*D,ideographicBaseline:(m=A.ideographicBaseline)!==null&&m!==void 0?m:-21*D,width:A.width,height:E}}_getContextFont(){return this.fontStyle()+Yp+this.fontVariant()+Yp+(this.fontSize()+Mj)+zj(this.fontFamily())}_addTextLine(e){this.align()===vh&&(e=e.trim());const r=this._getTextWidth(e);return this.textArr.push({text:e,width:r,lastInParagraph:!1})}_getTextWidth(e){const t=this.letterSpacing(),r=e.length;return Sv().measureText(e).width+t*r}_setTextData(){let e=this.text().split(`
`),t=+this.fontSize(),r=0,i=this.lineHeight()*t,s=this.attrs.width,o=this.attrs.height,l=s!==ru&&s!==void 0,c=o!==ru&&o!==void 0,d=this.padding(),p=s-d*2,_=o-d*2,m=0,S=this.wrap(),E=S!==e5,A=S!==Vj&&E,D=this.ellipsis();this.textArr=[],Sv().font=this._getContextFont();const k=D?this._getTextWidth(Ev):0;for(let R=0,w=e.length;R<w;++R){let P=e[R],V=this._getTextWidth(P);if(l&&V>p)for(;P.length>0;){let U=0,N=za(P).length,C="",O=0;for(;U<N;){const x=U+N>>>1,L=za(P),z=L.slice(0,x+1).join(""),F=this._getTextWidth(z);(D&&c&&m+i>_?F+k:F)<=p?(U=x+1,C=z,O=F):N=x}if(C){if(A){const z=za(P),F=za(C),fe=z[F.length],se=fe===Yp||fe===X3;let ze;if(se&&O<=p)ze=F.length;else{const De=F.lastIndexOf(Yp),Y=F.lastIndexOf(X3);ze=Math.max(De,Y)+1}ze>0&&(U=ze,C=z.slice(0,U).join(""),O=this._getTextWidth(C))}if(C=C.trimRight(),this._addTextLine(C),r=Math.max(r,O),m+=i,this._shouldHandleEllipsis(m)){this._tryToAddEllipsisToLastLine();break}if(P=za(P).slice(U).join("").trimLeft(),P.length>0&&(V=this._getTextWidth(P),V<=p)){this._addTextLine(P),m+=i,r=Math.max(r,V);break}}else break}else this._addTextLine(P),m+=i,r=Math.max(r,V),this._shouldHandleEllipsis(m)&&R<w-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),c&&m+i>_)break}this.textHeight=t,this.textWidth=r}_shouldHandleEllipsis(e){const t=+this.fontSize(),r=this.lineHeight()*t,i=this.attrs.height,s=i!==ru&&i!==void 0,o=this.padding(),l=i-o*2;return!(this.wrap()!==e5)||s&&e+r>l}_tryToAddEllipsisToLastLine(){const e=this.attrs.width,t=e!==ru&&e!==void 0,r=this.padding(),i=e-r*2,s=this.ellipsis(),o=this.textArr[this.textArr.length-1];!o||!s||(t&&(this._getTextWidth(o.text+Ev)<i||(o.text=o.text.slice(0,o.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(o.text+Ev))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const e=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,t=this.hasShadow();return e&&t?!0:super._useBufferCanvas()}};Tc.Text=Ut;Ut.prototype._fillFunc=Bj;Ut.prototype._strokeFunc=jj;Ut.prototype.className=Dj;Ut.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];(0,Rj._registerNode)(Ut);sr.Factory.overWriteSetter(Ut,"width",(0,ga.getNumberOrAutoValidator)());sr.Factory.overWriteSetter(Ut,"height",(0,ga.getNumberOrAutoValidator)());sr.Factory.addGetterSetter(Ut,"direction",Kk);sr.Factory.addGetterSetter(Ut,"fontFamily","Arial");sr.Factory.addGetterSetter(Ut,"fontSize",12,(0,ga.getNumberValidator)());sr.Factory.addGetterSetter(Ut,"fontStyle",Yk);sr.Factory.addGetterSetter(Ut,"fontVariant",Yk);sr.Factory.addGetterSetter(Ut,"padding",0,(0,ga.getNumberValidator)());sr.Factory.addGetterSetter(Ut,"align",Qk);sr.Factory.addGetterSetter(Ut,"verticalAlign",Oj);sr.Factory.addGetterSetter(Ut,"lineHeight",1,(0,ga.getNumberValidator)());sr.Factory.addGetterSetter(Ut,"wrap",Fj);sr.Factory.addGetterSetter(Ut,"ellipsis",!1,(0,ga.getBooleanValidator)());sr.Factory.addGetterSetter(Ut,"letterSpacing",0,(0,ga.getNumberValidator)());sr.Factory.addGetterSetter(Ut,"text","",(0,ga.getStringValidator)());sr.Factory.addGetterSetter(Ut,"textDecoration","");var J0={};Object.defineProperty(J0,"__esModule",{value:!0});J0.TextPath=void 0;const Tv=Lt,Oi=Ue,Wj=cn,wh=Ec,Cv=Tc,Jk=Pe,Hj=be,$j="",Zk="normal";function eA(n){n.fillText(this.partialText,0,0)}function tA(n){n.strokeText(this.partialText,0,0)}class hn extends Wj.Shape{constructor(e){super(e),this.dummyCanvas=Tv.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return wh.Path.getPathLength(this.dataArray)}_getPointAtLength(e){if(!this.attrs.data)return null;const t=this.pathLength;return e-1>t?null:wh.Path.getPointAtLengthOfDataArray(e,this.dataArray)}_readDataAttribute(){this.dataArray=wh.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(e){e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",this.textBaseline()),e.setAttr("textAlign","left"),e.save();const t=this.textDecoration(),r=this.fill(),i=this.fontSize(),s=this.glyphInfo;t==="underline"&&e.beginPath();for(let o=0;o<s.length;o++){e.save();const l=s[o].p0;e.translate(l.x,l.y),e.rotate(s[o].rotation),this.partialText=s[o].text,e.fillStrokeShape(this),t==="underline"&&(o===0&&e.moveTo(0,i/2+1),e.lineTo(i,i/2+1)),e.restore()}t==="underline"&&(e.strokeStyle=r,e.lineWidth=i/20,e.stroke()),e.restore()}_hitFunc(e){e.beginPath();const t=this.glyphInfo;if(t.length>=1){const r=t[0].p0;e.moveTo(r.x,r.y)}for(let r=0;r<t.length;r++){const i=t[r].p1;e.lineTo(i.x,i.y)}e.setAttr("lineWidth",this.fontSize()),e.setAttr("strokeStyle",this.colorKey),e.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return Tv.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(e){return Cv.Text.prototype.setText.call(this,e)}_getContextFont(){return Cv.Text.prototype._getContextFont.call(this)}_getTextSize(e){const r=this.dummyCanvas.getContext("2d");r.save(),r.font=this._getContextFont();const i=r.measureText(e);return r.restore(),{width:i.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:e,height:t}=this._getTextSize(this.attrs.text);if(this.textWidth=e,this.textHeight=t,this.glyphInfo=[],!this.attrs.data)return null;const r=this.letterSpacing(),i=this.align(),s=this.kerningFunc(),o=Math.max(this.textWidth+((this.attrs.text||"").length-1)*r,0);let l=0;i==="center"&&(l=Math.max(0,this.pathLength/2-o/2)),i==="right"&&(l=Math.max(0,this.pathLength-o));const c=(0,Cv.stringToArray)(this.text());let d=l;for(let p=0;p<c.length;p++){const _=this._getPointAtLength(d);if(!_)return;let m=this._getTextSize(c[p]).width+r;if(c[p]===" "&&i==="justify"){const R=this.text().split(" ").length-1;m+=(this.pathLength-o)/R}const S=this._getPointAtLength(d+m);if(!S)return;const E=wh.Path.getLineLength(_.x,_.y,S.x,S.y);let A=0;if(s)try{A=s(c[p-1],c[p])*this.fontSize()}catch{A=0}_.x+=A,S.x+=A,this.textWidth+=A;const D=wh.Path.getPointOnLine(A+E/2,_.x,_.y,S.x,S.y),k=Math.atan2(S.y-_.y,S.x-_.x);this.glyphInfo.push({transposeX:D.x,transposeY:D.y,text:c[p],rotation:k,p0:_,p1:S}),d+=m}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const e=[];this.glyphInfo.forEach(function(d){e.push(d.p0.x),e.push(d.p0.y),e.push(d.p1.x),e.push(d.p1.y)});let t=e[0]||0,r=e[0]||0,i=e[1]||0,s=e[1]||0,o,l;for(let d=0;d<e.length/2;d++)o=e[d*2],l=e[d*2+1],t=Math.min(t,o),r=Math.max(r,o),i=Math.min(i,l),s=Math.max(s,l);const c=this.fontSize();return{x:t-c/2,y:i-c/2,width:r-t+c,height:s-i+c}}destroy(){return Tv.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}J0.TextPath=hn;hn.prototype._fillFunc=eA;hn.prototype._strokeFunc=tA;hn.prototype._fillFuncHit=eA;hn.prototype._strokeFuncHit=tA;hn.prototype.className="TextPath";hn.prototype._attrsAffectingSize=["text","fontSize","data"];(0,Hj._registerNode)(hn);Oi.Factory.addGetterSetter(hn,"data");Oi.Factory.addGetterSetter(hn,"fontFamily","Arial");Oi.Factory.addGetterSetter(hn,"fontSize",12,(0,Jk.getNumberValidator)());Oi.Factory.addGetterSetter(hn,"fontStyle",Zk);Oi.Factory.addGetterSetter(hn,"align","left");Oi.Factory.addGetterSetter(hn,"letterSpacing",0,(0,Jk.getNumberValidator)());Oi.Factory.addGetterSetter(hn,"textBaseline","middle");Oi.Factory.addGetterSetter(hn,"fontVariant",Zk);Oi.Factory.addGetterSetter(hn,"text",$j);Oi.Factory.addGetterSetter(hn,"textDecoration","");Oi.Factory.addGetterSetter(hn,"kerningFunc",void 0);var Z0={};Object.defineProperty(Z0,"__esModule",{value:!0});Z0.Transformer=void 0;const ft=Lt,st=Ue,t5=kt,qj=cn,Kj=vf,n5=vc,vi=be,ma=Pe,Qj=be,nA="tr-konva",Yj=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(n=>n+`.${nA}`).join(" "),r5="nodesRect",Xj=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],Jj={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},Zj="ontouchstart"in vi.Konva._global;function eG(n,e,t){if(n==="rotater")return t;e+=ft.Util.degToRad(Jj[n]||0);const r=(ft.Util.radToDeg(e)%360+360)%360;return ft.Util._inRange(r,315+22.5,360)||ft.Util._inRange(r,0,22.5)?"ns-resize":ft.Util._inRange(r,45-22.5,45+22.5)?"nesw-resize":ft.Util._inRange(r,90-22.5,90+22.5)?"ew-resize":ft.Util._inRange(r,135-22.5,135+22.5)?"nwse-resize":ft.Util._inRange(r,180-22.5,180+22.5)?"ns-resize":ft.Util._inRange(r,225-22.5,225+22.5)?"nesw-resize":ft.Util._inRange(r,270-22.5,270+22.5)?"ew-resize":ft.Util._inRange(r,315-22.5,315+22.5)?"nwse-resize":(ft.Util.error("Transformer has unknown angle for cursor detection: "+r),"pointer")}const Am=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function tG(n){return{x:n.x+n.width/2*Math.cos(n.rotation)+n.height/2*Math.sin(-n.rotation),y:n.y+n.height/2*Math.cos(n.rotation)+n.width/2*Math.sin(n.rotation)}}function rA(n,e,t){const r=t.x+(n.x-t.x)*Math.cos(e)-(n.y-t.y)*Math.sin(e),i=t.y+(n.x-t.x)*Math.sin(e)+(n.y-t.y)*Math.cos(e);return{...n,rotation:n.rotation+e,x:r,y:i}}function nG(n,e){const t=tG(n);return rA(n,e,t)}function rG(n,e,t){let r=e;for(let i=0;i<n.length;i++){const s=vi.Konva.getAngle(n[i]),o=Math.abs(s-e)%(Math.PI*2);Math.min(o,Math.PI*2-o)<t&&(r=s)}return r}let y2=0;class qe extends n5.Group{constructor(e){super(e),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(Yj,this.update),this.getNode()&&this.update()}attachTo(e){return this.setNode(e),this}setNode(e){return ft.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([e])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return nA+this._id}setNodes(e=[]){this._nodes&&this._nodes.length&&this.detach();const t=e.filter(i=>i.isAncestorOf(this)?(ft.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=e=t,e.length===1&&this.useSingleNodeRotation()?this.rotation(e[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(i=>{const s=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(i._attrsAffectingSize.length){const o=i._attrsAffectingSize.map(l=>l+"Change."+this._getEventNamespace()).join(" ");i.on(o,s)}i.on(Xj.map(o=>o+`.${this._getEventNamespace()}`).join(" "),s),i.on(`absoluteTransformChange.${this._getEventNamespace()}`,s),this._proxyDrag(i)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(e){let t;e.on(`dragstart.${this._getEventNamespace()}`,r=>{t=e.getAbsolutePosition(),!this.isDragging()&&e!==this.findOne(".back")&&this.startDrag(r,!1)}),e.on(`dragmove.${this._getEventNamespace()}`,r=>{if(!t)return;const i=e.getAbsolutePosition(),s=i.x-t.x,o=i.y-t.y;this.nodes().forEach(l=>{if(l===e||l.isDragging())return;const c=l.getAbsolutePosition();l.setAbsolutePosition({x:c.x+s,y:c.y+o}),l.startDrag(r)}),t=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(e=>{e.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(r5),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(r5,this.__getNodeRect)}__getNodeShape(e,t=this.rotation(),r){const i=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),s=e.getAbsoluteScale(r),o=e.getAbsolutePosition(r),l=i.x*s.x-e.offsetX()*s.x,c=i.y*s.y-e.offsetY()*s.y,d=(vi.Konva.getAngle(e.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),p={x:o.x+l*Math.cos(d)+c*Math.sin(-d),y:o.y+c*Math.cos(d)+l*Math.sin(d),width:i.width*s.x,height:i.height*s.y,rotation:d};return rA(p,-vi.Konva.getAngle(t),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const t=[];this.nodes().map(d=>{const p=d.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),_=[{x:p.x,y:p.y},{x:p.x+p.width,y:p.y},{x:p.x+p.width,y:p.y+p.height},{x:p.x,y:p.y+p.height}],m=d.getAbsoluteTransform();_.forEach(function(S){const E=m.point(S);t.push(E)})});const r=new ft.Transform;r.rotate(-vi.Konva.getAngle(this.rotation()));let i=1/0,s=1/0,o=-1/0,l=-1/0;t.forEach(function(d){const p=r.point(d);i===void 0&&(i=o=p.x,s=l=p.y),i=Math.min(i,p.x),s=Math.min(s,p.y),o=Math.max(o,p.x),l=Math.max(l,p.y)}),r.invert();const c=r.point({x:i,y:s});return{x:c.x,y:c.y,width:o-i,height:l-s,rotation:vi.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),Am.forEach(e=>{this._createAnchor(e)}),this._createAnchor("rotater")}_createAnchor(e){const t=new Kj.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:e+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:Zj?10:"auto"}),r=this;t.on("mousedown touchstart",function(i){r._handleMouseDown(i)}),t.on("dragstart",i=>{t.stopDrag(),i.cancelBubble=!0}),t.on("dragend",i=>{i.cancelBubble=!0}),t.on("mouseenter",()=>{const i=vi.Konva.getAngle(this.rotation()),s=this.rotateAnchorCursor(),o=eG(e,i,s);t.getStage().content&&(t.getStage().content.style.cursor=o),this._cursorChange=!0}),t.on("mouseout",()=>{t.getStage().content&&(t.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(t)}_createBack(){const e=new qj.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(t,r){const i=r.getParent(),s=i.padding();t.beginPath(),t.rect(-s,-s,r.width()+s*2,r.height()+s*2),t.moveTo(r.width()/2,-s),i.rotateEnabled()&&i.rotateLineVisible()&&t.lineTo(r.width()/2,-i.rotateAnchorOffset()*ft.Util._sign(r.height())-s),t.fillStrokeShape(r)},hitFunc:(t,r)=>{if(!this.shouldOverdrawWholeArea())return;const i=this.padding();t.beginPath(),t.rect(-i,-i,r.width()+i*2,r.height()+i*2),t.fillStrokeShape(r)}});this.add(e),this._proxyDrag(e),e.on("dragstart",t=>{t.cancelBubble=!0}),e.on("dragmove",t=>{t.cancelBubble=!0}),e.on("dragend",t=>{t.cancelBubble=!0}),this.on("dragmove",t=>{this.update()})}_handleMouseDown(e){if(this._transforming)return;this._movingAnchorName=e.target.name().split(" ")[0];const t=this._getNodeRect(),r=t.width,i=t.height,s=Math.sqrt(Math.pow(r,2)+Math.pow(i,2));this.sin=Math.abs(i/s),this.cos=Math.abs(r/s),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const o=e.target.getAbsolutePosition(),l=e.target.getStage().getPointerPosition();this._anchorDragOffset={x:l.x-o.x,y:l.y-o.y},y2++,this._fire("transformstart",{evt:e.evt,target:this.getNode()}),this._nodes.forEach(c=>{c._fire("transformstart",{evt:e.evt,target:c})})}_handleMouseMove(e){let t,r,i;const s=this.findOne("."+this._movingAnchorName),o=s.getStage();o.setPointersPositions(e);const l=o.getPointerPosition();let c={x:l.x-this._anchorDragOffset.x,y:l.y-this._anchorDragOffset.y};const d=s.getAbsolutePosition();this.anchorDragBoundFunc()&&(c=this.anchorDragBoundFunc()(d,c,e)),s.setAbsolutePosition(c);const p=s.getAbsolutePosition();if(d.x===p.x&&d.y===p.y)return;if(this._movingAnchorName==="rotater"){const R=this._getNodeRect();t=s.x()-R.width/2,r=-s.y()+R.height/2;let w=Math.atan2(-r,t)+Math.PI/2;R.height<0&&(w-=Math.PI);const V=vi.Konva.getAngle(this.rotation())+w,U=vi.Konva.getAngle(this.rotationSnapTolerance()),C=rG(this.rotationSnaps(),V,U)-R.rotation,O=nG(R,C);this._fitNodesInto(O,e);return}const _=this.shiftBehavior();let m;_==="inverted"?m=this.keepRatio()&&!e.shiftKey:_==="none"?m=this.keepRatio():m=this.keepRatio()||e.shiftKey;let S=this.centeredScaling()||e.altKey;if(this._movingAnchorName==="top-left"){if(m){const R=S?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};i=Math.sqrt(Math.pow(R.x-s.x(),2)+Math.pow(R.y-s.y(),2));const w=this.findOne(".top-left").x()>R.x?-1:1,P=this.findOne(".top-left").y()>R.y?-1:1;t=i*this.cos*w,r=i*this.sin*P,this.findOne(".top-left").x(R.x-t),this.findOne(".top-left").y(R.y-r)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(s.y());else if(this._movingAnchorName==="top-right"){if(m){const R=S?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};i=Math.sqrt(Math.pow(s.x()-R.x,2)+Math.pow(R.y-s.y(),2));const w=this.findOne(".top-right").x()<R.x?-1:1,P=this.findOne(".top-right").y()>R.y?-1:1;t=i*this.cos*w,r=i*this.sin*P,this.findOne(".top-right").x(R.x+t),this.findOne(".top-right").y(R.y-r)}var E=s.position();this.findOne(".top-left").y(E.y),this.findOne(".bottom-right").x(E.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(s.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(s.x());else if(this._movingAnchorName==="bottom-left"){if(m){const R=S?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};i=Math.sqrt(Math.pow(R.x-s.x(),2)+Math.pow(s.y()-R.y,2));const w=R.x<s.x()?-1:1,P=s.y()<R.y?-1:1;t=i*this.cos*w,r=i*this.sin*P,s.x(R.x-t),s.y(R.y+r)}E=s.position(),this.findOne(".top-left").x(E.x),this.findOne(".bottom-right").y(E.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(s.y());else if(this._movingAnchorName==="bottom-right"){if(m){const R=S?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};i=Math.sqrt(Math.pow(s.x()-R.x,2)+Math.pow(s.y()-R.y,2));const w=this.findOne(".bottom-right").x()<R.x?-1:1,P=this.findOne(".bottom-right").y()<R.y?-1:1;t=i*this.cos*w,r=i*this.sin*P,this.findOne(".bottom-right").x(R.x+t),this.findOne(".bottom-right").y(R.y+r)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(S=this.centeredScaling()||e.altKey,S){const R=this.findOne(".top-left"),w=this.findOne(".bottom-right"),P=R.x(),V=R.y(),U=this.getWidth()-w.x(),N=this.getHeight()-w.y();w.move({x:-P,y:-V}),R.move({x:U,y:N})}const A=this.findOne(".top-left").getAbsolutePosition();t=A.x,r=A.y;const D=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),k=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:t,y:r,width:D,height:k,rotation:vi.Konva.getAngle(this.rotation())},e)}_handleMouseUp(e){this._removeEvents(e)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(e){var t;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const r=this.getNode();y2--,this._fire("transformend",{evt:e,target:r}),(t=this.getLayer())===null||t===void 0||t.batchDraw(),r&&this._nodes.forEach(i=>{var s;i._fire("transformend",{evt:e,target:i}),(s=i.getLayer())===null||s===void 0||s.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(e,t){const r=this._getNodeRect(),i=1;if(ft.Util._inRange(e.width,-this.padding()*2-i,i)){this.update();return}if(ft.Util._inRange(e.height,-this.padding()*2-i,i)){this.update();return}const s=new ft.Transform;if(s.rotate(vi.Konva.getAngle(this.rotation())),this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("left")>=0){const m=s.point({x:-this.padding()*2,y:0});e.x+=m.x,e.y+=m.y,e.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=m.x,this._anchorDragOffset.y-=m.y}else if(this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("right")>=0){const m=s.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=m.x,this._anchorDragOffset.y-=m.y,e.width+=this.padding()*2}if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("top")>=0){const m=s.point({x:0,y:-this.padding()*2});e.x+=m.x,e.y+=m.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=m.x,this._anchorDragOffset.y-=m.y,e.height+=this.padding()*2}else if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const m=s.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=m.x,this._anchorDragOffset.y-=m.y,e.height+=this.padding()*2}if(this.boundBoxFunc()){const m=this.boundBoxFunc()(r,e);m?e=m:ft.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const o=1e7,l=new ft.Transform;l.translate(r.x,r.y),l.rotate(r.rotation),l.scale(r.width/o,r.height/o);const c=new ft.Transform,d=e.width/o,p=e.height/o;this.flipEnabled()===!1?(c.translate(e.x,e.y),c.rotate(e.rotation),c.translate(e.width<0?e.width:0,e.height<0?e.height:0),c.scale(Math.abs(d),Math.abs(p))):(c.translate(e.x,e.y),c.rotate(e.rotation),c.scale(d,p));const _=c.multiply(l.invert());this._nodes.forEach(m=>{var S;const E=m.getParent().getAbsoluteTransform(),A=m.getTransform().copy();A.translate(m.offsetX(),m.offsetY());const D=new ft.Transform;D.multiply(E.copy().invert()).multiply(_).multiply(E).multiply(A);const k=D.decompose();m.setAttrs(k),(S=m.getLayer())===null||S===void 0||S.batchDraw()}),this.rotation(ft.Util._getRotation(e.rotation)),this._nodes.forEach(m=>{this._fire("transform",{evt:t,target:m}),m._fire("transform",{evt:t,target:m})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(e,t){this.findOne(e).setAttrs(t)}update(){var e;const t=this._getNodeRect();this.rotation(ft.Util._getRotation(t.rotation));const r=t.width,i=t.height,s=this.enabledAnchors(),o=this.resizeEnabled(),l=this.padding(),c=this.anchorSize(),d=this.find("._anchor");d.forEach(_=>{_.setAttrs({width:c,height:c,offsetX:c/2,offsetY:c/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:c/2+l,offsetY:c/2+l,visible:o&&s.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:r/2,y:0,offsetY:c/2+l,visible:o&&s.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:r,y:0,offsetX:c/2-l,offsetY:c/2+l,visible:o&&s.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:i/2,offsetX:c/2+l,visible:o&&s.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:r,y:i/2,offsetX:c/2-l,visible:o&&s.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:i,offsetX:c/2+l,offsetY:c/2-l,visible:o&&s.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:r/2,y:i,offsetY:c/2-l,visible:o&&s.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:r,y:i,offsetX:c/2-l,offsetY:c/2-l,visible:o&&s.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:r/2,y:-this.rotateAnchorOffset()*ft.Util._sign(i)-l,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:r,height:i,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const p=this.anchorStyleFunc();p&&d.forEach(_=>{p(_)}),(e=this.getLayer())===null||e===void 0||e.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const e=this.findOne("."+this._movingAnchorName);e&&e.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),n5.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return t5.Node.prototype.toObject.call(this)}clone(e){return t5.Node.prototype.clone.call(this,e)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}Z0.Transformer=qe;qe.isTransforming=()=>y2>0;function iG(n){return n instanceof Array||ft.Util.warn("enabledAnchors value should be an array"),n instanceof Array&&n.forEach(function(e){Am.indexOf(e)===-1&&ft.Util.warn("Unknown anchor name: "+e+". Available names are: "+Am.join(", "))}),n||[]}qe.prototype.className="Transformer";(0,Qj._registerNode)(qe);st.Factory.addGetterSetter(qe,"enabledAnchors",Am,iG);st.Factory.addGetterSetter(qe,"flipEnabled",!0,(0,ma.getBooleanValidator)());st.Factory.addGetterSetter(qe,"resizeEnabled",!0);st.Factory.addGetterSetter(qe,"anchorSize",10,(0,ma.getNumberValidator)());st.Factory.addGetterSetter(qe,"rotateEnabled",!0);st.Factory.addGetterSetter(qe,"rotateLineVisible",!0);st.Factory.addGetterSetter(qe,"rotationSnaps",[]);st.Factory.addGetterSetter(qe,"rotateAnchorOffset",50,(0,ma.getNumberValidator)());st.Factory.addGetterSetter(qe,"rotateAnchorCursor","crosshair");st.Factory.addGetterSetter(qe,"rotationSnapTolerance",5,(0,ma.getNumberValidator)());st.Factory.addGetterSetter(qe,"borderEnabled",!0);st.Factory.addGetterSetter(qe,"anchorStroke","rgb(0, 161, 255)");st.Factory.addGetterSetter(qe,"anchorStrokeWidth",1,(0,ma.getNumberValidator)());st.Factory.addGetterSetter(qe,"anchorFill","white");st.Factory.addGetterSetter(qe,"anchorCornerRadius",0,(0,ma.getNumberValidator)());st.Factory.addGetterSetter(qe,"borderStroke","rgb(0, 161, 255)");st.Factory.addGetterSetter(qe,"borderStrokeWidth",1,(0,ma.getNumberValidator)());st.Factory.addGetterSetter(qe,"borderDash");st.Factory.addGetterSetter(qe,"keepRatio",!0);st.Factory.addGetterSetter(qe,"shiftBehavior","default");st.Factory.addGetterSetter(qe,"centeredScaling",!1);st.Factory.addGetterSetter(qe,"ignoreStroke",!1);st.Factory.addGetterSetter(qe,"padding",0,(0,ma.getNumberValidator)());st.Factory.addGetterSetter(qe,"nodes");st.Factory.addGetterSetter(qe,"node");st.Factory.addGetterSetter(qe,"boundBoxFunc");st.Factory.addGetterSetter(qe,"anchorDragBoundFunc");st.Factory.addGetterSetter(qe,"anchorStyleFunc");st.Factory.addGetterSetter(qe,"shouldOverdrawWholeArea",!1);st.Factory.addGetterSetter(qe,"useSingleNodeRotation",!0);st.Factory.backCompat(qe,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var e_={};Object.defineProperty(e_,"__esModule",{value:!0});e_.Wedge=void 0;const t_=Ue,sG=cn,oG=be,iA=Pe,aG=be;class ro extends sG.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.radius(),0,oG.Konva.getAngle(this.angle()),this.clockwise()),e.lineTo(0,0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}e_.Wedge=ro;ro.prototype.className="Wedge";ro.prototype._centroid=!0;ro.prototype._attrsAffectingSize=["radius"];(0,aG._registerNode)(ro);t_.Factory.addGetterSetter(ro,"radius",0,(0,iA.getNumberValidator)());t_.Factory.addGetterSetter(ro,"angle",0,(0,iA.getNumberValidator)());t_.Factory.addGetterSetter(ro,"clockwise",!1);t_.Factory.backCompat(ro,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var n_={};Object.defineProperty(n_,"__esModule",{value:!0});n_.Blur=void 0;const i5=Ue,lG=kt,uG=Pe;function s5(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const cG=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],hG=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function dG(n,e){const t=n.data,r=n.width,i=n.height;let s,o,l,c,d,p,_,m,S,E,A,D,k,R,w,P,V,U,N,C;const O=e+e+1,x=r-1,L=i-1,z=e+1,F=z*(z+1)/2,fe=new s5,se=cG[e],ze=hG[e];let De=null,Y=fe,oe=null,ne=null;for(let ae=1;ae<O;ae++)Y=Y.next=new s5,ae===z&&(De=Y);Y.next=fe,l=o=0;for(let ae=0;ae<i;ae++){D=k=R=w=c=d=p=_=0,m=z*(P=t[o]),S=z*(V=t[o+1]),E=z*(U=t[o+2]),A=z*(N=t[o+3]),c+=F*P,d+=F*V,p+=F*U,_+=F*N,Y=fe;for(let pe=0;pe<z;pe++)Y.r=P,Y.g=V,Y.b=U,Y.a=N,Y=Y.next;for(let pe=1;pe<z;pe++)s=o+((x<pe?x:pe)<<2),c+=(Y.r=P=t[s])*(C=z-pe),d+=(Y.g=V=t[s+1])*C,p+=(Y.b=U=t[s+2])*C,_+=(Y.a=N=t[s+3])*C,D+=P,k+=V,R+=U,w+=N,Y=Y.next;oe=fe,ne=De;for(let pe=0;pe<r;pe++)t[o+3]=N=_*se>>ze,N!==0?(N=255/N,t[o]=(c*se>>ze)*N,t[o+1]=(d*se>>ze)*N,t[o+2]=(p*se>>ze)*N):t[o]=t[o+1]=t[o+2]=0,c-=m,d-=S,p-=E,_-=A,m-=oe.r,S-=oe.g,E-=oe.b,A-=oe.a,s=l+((s=pe+e+1)<x?s:x)<<2,D+=oe.r=t[s],k+=oe.g=t[s+1],R+=oe.b=t[s+2],w+=oe.a=t[s+3],c+=D,d+=k,p+=R,_+=w,oe=oe.next,m+=P=ne.r,S+=V=ne.g,E+=U=ne.b,A+=N=ne.a,D-=P,k-=V,R-=U,w-=N,ne=ne.next,o+=4;l+=r}for(let ae=0;ae<r;ae++){k=R=w=D=d=p=_=c=0,o=ae<<2,m=z*(P=t[o]),S=z*(V=t[o+1]),E=z*(U=t[o+2]),A=z*(N=t[o+3]),c+=F*P,d+=F*V,p+=F*U,_+=F*N,Y=fe;for(let Se=0;Se<z;Se++)Y.r=P,Y.g=V,Y.b=U,Y.a=N,Y=Y.next;let pe=r;for(let Se=1;Se<=e;Se++)o=pe+ae<<2,c+=(Y.r=P=t[o])*(C=z-Se),d+=(Y.g=V=t[o+1])*C,p+=(Y.b=U=t[o+2])*C,_+=(Y.a=N=t[o+3])*C,D+=P,k+=V,R+=U,w+=N,Y=Y.next,Se<L&&(pe+=r);o=ae,oe=fe,ne=De;for(let Se=0;Se<i;Se++)s=o<<2,t[s+3]=N=_*se>>ze,N>0?(N=255/N,t[s]=(c*se>>ze)*N,t[s+1]=(d*se>>ze)*N,t[s+2]=(p*se>>ze)*N):t[s]=t[s+1]=t[s+2]=0,c-=m,d-=S,p-=E,_-=A,m-=oe.r,S-=oe.g,E-=oe.b,A-=oe.a,s=ae+((s=Se+z)<L?s:L)*r<<2,c+=D+=oe.r=t[s],d+=k+=oe.g=t[s+1],p+=R+=oe.b=t[s+2],_+=w+=oe.a=t[s+3],oe=oe.next,m+=P=ne.r,S+=V=ne.g,E+=U=ne.b,A+=N=ne.a,D-=P,k-=V,R-=U,w-=N,ne=ne.next,o+=r}}const fG=function(e){const t=Math.round(this.blurRadius());t>0&&dG(e,t)};n_.Blur=fG;i5.Factory.addGetterSetter(lG.Node,"blurRadius",0,(0,uG.getNumberValidator)(),i5.Factory.afterSetFilter);var r_={};Object.defineProperty(r_,"__esModule",{value:!0});r_.Brighten=void 0;const o5=Ue,pG=kt,gG=Pe,mG=function(n){const e=this.brightness()*255,t=n.data,r=t.length;for(let i=0;i<r;i+=4)t[i]+=e,t[i+1]+=e,t[i+2]+=e};r_.Brighten=mG;o5.Factory.addGetterSetter(pG.Node,"brightness",0,(0,gG.getNumberValidator)(),o5.Factory.afterSetFilter);var i_={};Object.defineProperty(i_,"__esModule",{value:!0});i_.Contrast=void 0;const a5=Ue,_G=kt,yG=Pe,vG=function(n){const e=Math.pow((this.contrast()+100)/100,2),t=n.data,r=t.length;let i=150,s=150,o=150;for(let l=0;l<r;l+=4)i=t[l],s=t[l+1],o=t[l+2],i/=255,i-=.5,i*=e,i+=.5,i*=255,s/=255,s-=.5,s*=e,s+=.5,s*=255,o/=255,o-=.5,o*=e,o+=.5,o*=255,i=i<0?0:i>255?255:i,s=s<0?0:s>255?255:s,o=o<0?0:o>255?255:o,t[l]=i,t[l+1]=s,t[l+2]=o};i_.Contrast=vG;a5.Factory.addGetterSetter(_G.Node,"contrast",0,(0,yG.getNumberValidator)(),a5.Factory.afterSetFilter);var s_={};Object.defineProperty(s_,"__esModule",{value:!0});s_.Emboss=void 0;const ta=Ue,o_=kt,wG=Lt,sA=Pe,EG=function(n){const e=this.embossStrength()*10,t=this.embossWhiteLevel()*255,r=this.embossDirection(),i=this.embossBlend(),s=n.data,o=n.width,l=n.height,c=o*4;let d=0,p=0,_=l;switch(r){case"top-left":d=-1,p=-1;break;case"top":d=-1,p=0;break;case"top-right":d=-1,p=1;break;case"right":d=0,p=1;break;case"bottom-right":d=1,p=1;break;case"bottom":d=1,p=0;break;case"bottom-left":d=1,p=-1;break;case"left":d=0,p=-1;break;default:wG.Util.error("Unknown emboss direction: "+r)}do{const m=(_-1)*c;let S=d;_+S<1&&(S=0),_+S>l&&(S=0);const E=(_-1+S)*o*4;let A=o;do{const D=m+(A-1)*4;let k=p;A+k<1&&(k=0),A+k>o&&(k=0);const R=E+(A-1+k)*4,w=s[D]-s[R],P=s[D+1]-s[R+1],V=s[D+2]-s[R+2];let U=w;const N=U>0?U:-U,C=P>0?P:-P,O=V>0?V:-V;if(C>N&&(U=P),O>N&&(U=V),U*=e,i){const x=s[D]+U,L=s[D+1]+U,z=s[D+2]+U;s[D]=x>255?255:x<0?0:x,s[D+1]=L>255?255:L<0?0:L,s[D+2]=z>255?255:z<0?0:z}else{let x=t-U;x<0?x=0:x>255&&(x=255),s[D]=s[D+1]=s[D+2]=x}}while(--A)}while(--_)};s_.Emboss=EG;ta.Factory.addGetterSetter(o_.Node,"embossStrength",.5,(0,sA.getNumberValidator)(),ta.Factory.afterSetFilter);ta.Factory.addGetterSetter(o_.Node,"embossWhiteLevel",.5,(0,sA.getNumberValidator)(),ta.Factory.afterSetFilter);ta.Factory.addGetterSetter(o_.Node,"embossDirection","top-left",void 0,ta.Factory.afterSetFilter);ta.Factory.addGetterSetter(o_.Node,"embossBlend",!1,void 0,ta.Factory.afterSetFilter);var a_={};Object.defineProperty(a_,"__esModule",{value:!0});a_.Enhance=void 0;const l5=Ue,SG=kt,TG=Pe;function Iv(n,e,t,r,i){const s=t-e,o=i-r;if(s===0)return r+o/2;if(o===0)return r;let l=(n-e)/s;return l=o*l+r,l}const CG=function(n){const e=n.data,t=e.length;let r=e[0],i=r,s,o=e[1],l=o,c,d=e[2],p=d,_;const m=this.enhance();if(m===0)return;for(let w=0;w<t;w+=4)s=e[w+0],s<r?r=s:s>i&&(i=s),c=e[w+1],c<o?o=c:c>l&&(l=c),_=e[w+2],_<d?d=_:_>p&&(p=_);i===r&&(i=255,r=0),l===o&&(l=255,o=0),p===d&&(p=255,d=0);let S,E,A,D,k,R;if(m>0)S=i+m*(255-i),E=r-m*(r-0),A=l+m*(255-l),D=o-m*(o-0),k=p+m*(255-p),R=d-m*(d-0);else{const w=(i+r)*.5;S=i+m*(i-w),E=r+m*(r-w);const P=(l+o)*.5;A=l+m*(l-P),D=o+m*(o-P);const V=(p+d)*.5;k=p+m*(p-V),R=d+m*(d-V)}for(let w=0;w<t;w+=4)e[w+0]=Iv(e[w+0],r,i,E,S),e[w+1]=Iv(e[w+1],o,l,D,A),e[w+2]=Iv(e[w+2],d,p,R,k)};a_.Enhance=CG;l5.Factory.addGetterSetter(SG.Node,"enhance",0,(0,TG.getNumberValidator)(),l5.Factory.afterSetFilter);var l_={};Object.defineProperty(l_,"__esModule",{value:!0});l_.Grayscale=void 0;const IG=function(n){const e=n.data,t=e.length;for(let r=0;r<t;r+=4){const i=.34*e[r]+.5*e[r+1]+.16*e[r+2];e[r]=i,e[r+1]=i,e[r+2]=i}};l_.Grayscale=IG;var u_={};Object.defineProperty(u_,"__esModule",{value:!0});u_.HSL=void 0;const tc=Ue,iS=kt,sS=Pe;tc.Factory.addGetterSetter(iS.Node,"hue",0,(0,sS.getNumberValidator)(),tc.Factory.afterSetFilter);tc.Factory.addGetterSetter(iS.Node,"saturation",0,(0,sS.getNumberValidator)(),tc.Factory.afterSetFilter);tc.Factory.addGetterSetter(iS.Node,"luminance",0,(0,sS.getNumberValidator)(),tc.Factory.afterSetFilter);const PG=function(n){const e=n.data,t=e.length,r=1,i=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,o=this.luminance()*127,l=r*i*Math.cos(s*Math.PI/180),c=r*i*Math.sin(s*Math.PI/180),d=.299*r+.701*l+.167*c,p=.587*r-.587*l+.33*c,_=.114*r-.114*l-.497*c,m=.299*r-.299*l-.328*c,S=.587*r+.413*l+.035*c,E=.114*r-.114*l+.293*c,A=.299*r-.3*l+1.25*c,D=.587*r-.586*l-1.05*c,k=.114*r+.886*l-.2*c;let R,w,P,V;for(let U=0;U<t;U+=4)R=e[U+0],w=e[U+1],P=e[U+2],V=e[U+3],e[U+0]=d*R+p*w+_*P+o,e[U+1]=m*R+S*w+E*P+o,e[U+2]=A*R+D*w+k*P+o,e[U+3]=V};u_.HSL=PG;var c_={};Object.defineProperty(c_,"__esModule",{value:!0});c_.HSV=void 0;const nc=Ue,oS=kt,aS=Pe,RG=function(n){const e=n.data,t=e.length,r=Math.pow(2,this.value()),i=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,o=r*i*Math.cos(s*Math.PI/180),l=r*i*Math.sin(s*Math.PI/180),c=.299*r+.701*o+.167*l,d=.587*r-.587*o+.33*l,p=.114*r-.114*o-.497*l,_=.299*r-.299*o-.328*l,m=.587*r+.413*o+.035*l,S=.114*r-.114*o+.293*l,E=.299*r-.3*o+1.25*l,A=.587*r-.586*o-1.05*l,D=.114*r+.886*o-.2*l;for(let k=0;k<t;k+=4){const R=e[k+0],w=e[k+1],P=e[k+2],V=e[k+3];e[k+0]=c*R+d*w+p*P,e[k+1]=_*R+m*w+S*P,e[k+2]=E*R+A*w+D*P,e[k+3]=V}};c_.HSV=RG;nc.Factory.addGetterSetter(oS.Node,"hue",0,(0,aS.getNumberValidator)(),nc.Factory.afterSetFilter);nc.Factory.addGetterSetter(oS.Node,"saturation",0,(0,aS.getNumberValidator)(),nc.Factory.afterSetFilter);nc.Factory.addGetterSetter(oS.Node,"value",0,(0,aS.getNumberValidator)(),nc.Factory.afterSetFilter);var h_={};Object.defineProperty(h_,"__esModule",{value:!0});h_.Invert=void 0;const kG=function(n){const e=n.data,t=e.length;for(let r=0;r<t;r+=4)e[r]=255-e[r],e[r+1]=255-e[r+1],e[r+2]=255-e[r+2]};h_.Invert=kG;var d_={};Object.defineProperty(d_,"__esModule",{value:!0});d_.Kaleidoscope=void 0;const xm=Ue,oA=kt,u5=Lt,aA=Pe,AG=function(n,e,t){const r=n.data,i=e.data,s=n.width,o=n.height,l=t.polarCenterX||s/2,c=t.polarCenterY||o/2;let d=Math.sqrt(l*l+c*c),p=s-l,_=o-c;const m=Math.sqrt(p*p+_*_);d=m>d?m:d;const S=o,E=s,A=360/E*Math.PI/180;for(let D=0;D<E;D+=1){const k=Math.sin(D*A),R=Math.cos(D*A);for(let w=0;w<S;w+=1){p=Math.floor(l+d*w/S*R),_=Math.floor(c+d*w/S*k);let P=(_*s+p)*4;const V=r[P+0],U=r[P+1],N=r[P+2],C=r[P+3];P=(D+w*s)*4,i[P+0]=V,i[P+1]=U,i[P+2]=N,i[P+3]=C}}},xG=function(n,e,t){const r=n.data,i=e.data,s=n.width,o=n.height,l=t.polarCenterX||s/2,c=t.polarCenterY||o/2;let d=Math.sqrt(l*l+c*c),p=s-l,_=o-c;const m=Math.sqrt(p*p+_*_);d=m>d?m:d;const S=o,E=s,A=0;let D,k;for(p=0;p<s;p+=1)for(_=0;_<o;_+=1){const R=p-l,w=_-c,P=Math.sqrt(R*R+w*w)*S/d;let V=(Math.atan2(w,R)*180/Math.PI+360+A)%360;V=V*E/360,D=Math.floor(V),k=Math.floor(P);let U=(k*s+D)*4;const N=r[U+0],C=r[U+1],O=r[U+2],x=r[U+3];U=(_*s+p)*4,i[U+0]=N,i[U+1]=C,i[U+2]=O,i[U+3]=x}},NG=function(n){const e=n.width,t=n.height;let r,i,s,o,l,c,d,p,_,m,S=Math.round(this.kaleidoscopePower());const E=Math.round(this.kaleidoscopeAngle()),A=Math.floor(e*(E%360)/360);if(S<1)return;const D=u5.Util.createCanvasElement();D.width=e,D.height=t;const k=D.getContext("2d").getImageData(0,0,e,t);u5.Util.releaseCanvas(D),AG(n,k,{polarCenterX:e/2,polarCenterY:t/2});let R=e/Math.pow(2,S);for(;R<=8;)R=R*2,S-=1;R=Math.ceil(R);let w=R,P=0,V=w,U=1;for(A+R>e&&(P=w,V=0,U=-1),i=0;i<t;i+=1)for(r=P;r!==V;r+=U)s=Math.round(r+A)%e,_=(e*i+s)*4,l=k.data[_+0],c=k.data[_+1],d=k.data[_+2],p=k.data[_+3],m=(e*i+r)*4,k.data[m+0]=l,k.data[m+1]=c,k.data[m+2]=d,k.data[m+3]=p;for(i=0;i<t;i+=1)for(w=Math.floor(R),o=0;o<S;o+=1){for(r=0;r<w+1;r+=1)_=(e*i+r)*4,l=k.data[_+0],c=k.data[_+1],d=k.data[_+2],p=k.data[_+3],m=(e*i+w*2-r-1)*4,k.data[m+0]=l,k.data[m+1]=c,k.data[m+2]=d,k.data[m+3]=p;w*=2}xG(k,n,{})};d_.Kaleidoscope=NG;xm.Factory.addGetterSetter(oA.Node,"kaleidoscopePower",2,(0,aA.getNumberValidator)(),xm.Factory.afterSetFilter);xm.Factory.addGetterSetter(oA.Node,"kaleidoscopeAngle",0,(0,aA.getNumberValidator)(),xm.Factory.afterSetFilter);var f_={};Object.defineProperty(f_,"__esModule",{value:!0});f_.Mask=void 0;const c5=Ue,DG=kt,OG=Pe;function Jp(n,e,t){let r=(t*n.width+e)*4;const i=[];return i.push(n.data[r++],n.data[r++],n.data[r++],n.data[r++]),i}function Eh(n,e){return Math.sqrt(Math.pow(n[0]-e[0],2)+Math.pow(n[1]-e[1],2)+Math.pow(n[2]-e[2],2))}function bG(n){const e=[0,0,0];for(let t=0;t<n.length;t++)e[0]+=n[t][0],e[1]+=n[t][1],e[2]+=n[t][2];return e[0]/=n.length,e[1]/=n.length,e[2]/=n.length,e}function MG(n,e){const t=Jp(n,0,0),r=Jp(n,n.width-1,0),i=Jp(n,0,n.height-1),s=Jp(n,n.width-1,n.height-1),o=e||10;if(Eh(t,r)<o&&Eh(r,s)<o&&Eh(s,i)<o&&Eh(i,t)<o){const l=bG([r,t,s,i]),c=[];for(let d=0;d<n.width*n.height;d++){const p=Eh(l,[n.data[d*4],n.data[d*4+1],n.data[d*4+2]]);c[d]=p<o?0:255}return c}}function LG(n,e){for(let t=0;t<n.width*n.height;t++)n.data[4*t+3]=e[t]}function FG(n,e,t){const r=[1,1,1,1,0,1,1,1,1],i=Math.round(Math.sqrt(r.length)),s=Math.floor(i/2),o=[];for(let l=0;l<t;l++)for(let c=0;c<e;c++){const d=l*e+c;let p=0;for(let _=0;_<i;_++)for(let m=0;m<i;m++){const S=l+_-s,E=c+m-s;if(S>=0&&S<t&&E>=0&&E<e){const A=S*e+E,D=r[_*i+m];p+=n[A]*D}}o[d]=p===255*8?255:0}return o}function VG(n,e,t){const r=[1,1,1,1,1,1,1,1,1],i=Math.round(Math.sqrt(r.length)),s=Math.floor(i/2),o=[];for(let l=0;l<t;l++)for(let c=0;c<e;c++){const d=l*e+c;let p=0;for(let _=0;_<i;_++)for(let m=0;m<i;m++){const S=l+_-s,E=c+m-s;if(S>=0&&S<t&&E>=0&&E<e){const A=S*e+E,D=r[_*i+m];p+=n[A]*D}}o[d]=p>=255*4?255:0}return o}function UG(n,e,t){const r=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],i=Math.round(Math.sqrt(r.length)),s=Math.floor(i/2),o=[];for(let l=0;l<t;l++)for(let c=0;c<e;c++){const d=l*e+c;let p=0;for(let _=0;_<i;_++)for(let m=0;m<i;m++){const S=l+_-s,E=c+m-s;if(S>=0&&S<t&&E>=0&&E<e){const A=S*e+E,D=r[_*i+m];p+=n[A]*D}}o[d]=p}return o}const zG=function(n){const e=this.threshold();let t=MG(n,e);return t&&(t=FG(t,n.width,n.height),t=VG(t,n.width,n.height),t=UG(t,n.width,n.height),LG(n,t)),n};f_.Mask=zG;c5.Factory.addGetterSetter(DG.Node,"threshold",0,(0,OG.getNumberValidator)(),c5.Factory.afterSetFilter);var p_={};Object.defineProperty(p_,"__esModule",{value:!0});p_.Noise=void 0;const h5=Ue,BG=kt,jG=Pe,GG=function(n){const e=this.noise()*255,t=n.data,r=t.length,i=e/2;for(let s=0;s<r;s+=4)t[s+0]+=i-2*i*Math.random(),t[s+1]+=i-2*i*Math.random(),t[s+2]+=i-2*i*Math.random()};p_.Noise=GG;h5.Factory.addGetterSetter(BG.Node,"noise",.2,(0,jG.getNumberValidator)(),h5.Factory.afterSetFilter);var g_={};Object.defineProperty(g_,"__esModule",{value:!0});g_.Pixelate=void 0;const d5=Ue,WG=Lt,HG=kt,$G=Pe,qG=function(n){let e=Math.ceil(this.pixelSize()),t=n.width,r=n.height,i=Math.ceil(t/e),s=Math.ceil(r/e),o=n.data;if(e<=0){WG.Util.error("pixelSize value can not be <= 0");return}for(let l=0;l<i;l+=1)for(let c=0;c<s;c+=1){let d=0,p=0,_=0,m=0;const S=l*e,E=S+e,A=c*e,D=A+e;let k=0;for(let R=S;R<E;R+=1)if(!(R>=t))for(let w=A;w<D;w+=1){if(w>=r)continue;const P=(t*w+R)*4;d+=o[P+0],p+=o[P+1],_+=o[P+2],m+=o[P+3],k+=1}d=d/k,p=p/k,_=_/k,m=m/k;for(let R=S;R<E;R+=1)if(!(R>=t))for(let w=A;w<D;w+=1){if(w>=r)continue;const P=(t*w+R)*4;o[P+0]=d,o[P+1]=p,o[P+2]=_,o[P+3]=m}}};g_.Pixelate=qG;d5.Factory.addGetterSetter(HG.Node,"pixelSize",8,(0,$G.getNumberValidator)(),d5.Factory.afterSetFilter);var m_={};Object.defineProperty(m_,"__esModule",{value:!0});m_.Posterize=void 0;const f5=Ue,KG=kt,QG=Pe,YG=function(n){const e=Math.round(this.levels()*254)+1,t=n.data,r=t.length,i=255/e;for(let s=0;s<r;s+=1)t[s]=Math.floor(t[s]/i)*i};m_.Posterize=YG;f5.Factory.addGetterSetter(KG.Node,"levels",.5,(0,QG.getNumberValidator)(),f5.Factory.afterSetFilter);var __={};Object.defineProperty(__,"__esModule",{value:!0});__.RGB=void 0;const Nm=Ue,lS=kt,XG=Pe,JG=function(n){const e=n.data,t=e.length,r=this.red(),i=this.green(),s=this.blue();for(let o=0;o<t;o+=4){const l=(.34*e[o]+.5*e[o+1]+.16*e[o+2])/255;e[o]=l*r,e[o+1]=l*i,e[o+2]=l*s,e[o+3]=e[o+3]}};__.RGB=JG;Nm.Factory.addGetterSetter(lS.Node,"red",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)});Nm.Factory.addGetterSetter(lS.Node,"green",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)});Nm.Factory.addGetterSetter(lS.Node,"blue",0,XG.RGBComponent,Nm.Factory.afterSetFilter);var y_={};Object.defineProperty(y_,"__esModule",{value:!0});y_.RGBA=void 0;const Vd=Ue,v_=kt,ZG=Pe,eW=function(n){const e=n.data,t=e.length,r=this.red(),i=this.green(),s=this.blue(),o=this.alpha();for(let l=0;l<t;l+=4){const c=1-o;e[l]=r*o+e[l]*c,e[l+1]=i*o+e[l+1]*c,e[l+2]=s*o+e[l+2]*c}};y_.RGBA=eW;Vd.Factory.addGetterSetter(v_.Node,"red",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)});Vd.Factory.addGetterSetter(v_.Node,"green",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)});Vd.Factory.addGetterSetter(v_.Node,"blue",0,ZG.RGBComponent,Vd.Factory.afterSetFilter);Vd.Factory.addGetterSetter(v_.Node,"alpha",1,function(n){return this._filterUpToDate=!1,n>1?1:n<0?0:n});var w_={};Object.defineProperty(w_,"__esModule",{value:!0});w_.Sepia=void 0;const tW=function(n){const e=n.data,t=e.length;for(let r=0;r<t;r+=4){const i=e[r+0],s=e[r+1],o=e[r+2];e[r+0]=Math.min(255,i*.393+s*.769+o*.189),e[r+1]=Math.min(255,i*.349+s*.686+o*.168),e[r+2]=Math.min(255,i*.272+s*.534+o*.131)}};w_.Sepia=tW;var E_={};Object.defineProperty(E_,"__esModule",{value:!0});E_.Solarize=void 0;const nW=function(n){const e=n.data,t=n.width,r=n.height,i=t*4;let s=r;do{const o=(s-1)*i;let l=t;do{const c=o+(l-1)*4;let d=e[c],p=e[c+1],_=e[c+2];d>127&&(d=255-d),p>127&&(p=255-p),_>127&&(_=255-_),e[c]=d,e[c+1]=p,e[c+2]=_}while(--l)}while(--s)};E_.Solarize=nW;var S_={};Object.defineProperty(S_,"__esModule",{value:!0});S_.Threshold=void 0;const p5=Ue,rW=kt,iW=Pe,sW=function(n){const e=this.threshold()*255,t=n.data,r=t.length;for(let i=0;i<r;i+=1)t[i]=t[i]<e?0:255};S_.Threshold=sW;p5.Factory.addGetterSetter(rW.Node,"threshold",.5,(0,iW.getNumberValidator)(),p5.Factory.afterSetFilter);Object.defineProperty(D0,"__esModule",{value:!0});D0.Konva=void 0;const g5=Rm,oW=F0,aW=z0,lW=G0,uW=W0,cW=H0,m5=ec,hW=_f,dW=Ec,fW=vf,pW=K0,gW=Q0,mW=Y0,_W=X0,yW=Tc,vW=J0,wW=Z0,EW=e_,SW=n_,TW=r_,CW=i_,IW=s_,PW=a_,RW=l_,kW=u_,AW=c_,xW=h_,NW=d_,DW=f_,OW=p_,bW=g_,MW=m_,LW=__,FW=y_,VW=w_,UW=E_,zW=S_;D0.Konva=g5.Konva.Util._assign(g5.Konva,{Arc:oW.Arc,Arrow:aW.Arrow,Circle:lW.Circle,Ellipse:uW.Ellipse,Image:cW.Image,Label:m5.Label,Tag:m5.Tag,Line:hW.Line,Path:dW.Path,Rect:fW.Rect,RegularPolygon:pW.RegularPolygon,Ring:gW.Ring,Sprite:mW.Sprite,Star:_W.Star,Text:yW.Text,TextPath:vW.TextPath,Transformer:wW.Transformer,Wedge:EW.Wedge,Filters:{Blur:SW.Blur,Brighten:TW.Brighten,Contrast:CW.Contrast,Emboss:IW.Emboss,Enhance:PW.Enhance,Grayscale:RW.Grayscale,HSL:kW.HSL,HSV:AW.HSV,Invert:xW.Invert,Kaleidoscope:NW.Kaleidoscope,Mask:DW.Mask,Noise:OW.Noise,Pixelate:bW.Pixelate,Posterize:MW.Posterize,RGB:LW.RGB,RGBA:FW.RGBA,Sepia:VW.Sepia,Solarize:UW.Solarize,Threshold:zW.Threshold}});var BW=Rk.exports;Object.defineProperty(BW,"__esModule",{value:!0});const jW=D0;Rk.exports=jW.Konva;var v2={exports:{}};(function(n,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;var t=Rm;Object.defineProperty(e,"Konva",{enumerable:!0,get:function(){return t.Konva}});const r=Rm;n.exports=r.Konva})(v2,v2.exports);var GW=v2.exports;const Ud=Om(GW);var lA={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WW=function(e){var t={},r=Ee,i=Oh,s=Object.assign;function o(a){for(var u="https://reactjs.org/docs/error-decoder.html?invariant="+a,f=1;f<arguments.length;f++)u+="&args[]="+encodeURIComponent(arguments[f]);return"Minified React error #"+a+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var l=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,c=Symbol.for("react.element"),d=Symbol.for("react.portal"),p=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),m=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),E=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),k=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),P=Symbol.for("react.offscreen"),V=Symbol.iterator;function U(a){return a===null||typeof a!="object"?null:(a=V&&a[V]||a["@@iterator"],typeof a=="function"?a:null)}function N(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case p:return"Fragment";case d:return"Portal";case m:return"Profiler";case _:return"StrictMode";case D:return"Suspense";case k:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case E:return(a.displayName||"Context")+".Consumer";case S:return(a._context.displayName||"Context")+".Provider";case A:var u=a.render;return a=a.displayName,a||(a=u.displayName||u.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case R:return u=a.displayName||null,u!==null?u:N(a.type)||"Memo";case w:u=a._payload,a=a._init;try{return N(a(u))}catch{}}return null}function C(a){var u=a.type;switch(a.tag){case 24:return"Cache";case 9:return(u.displayName||"Context")+".Consumer";case 10:return(u._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=u.render,a=a.displayName||a.name||"",u.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return u;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return N(u);case 8:return u===_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u}return null}function O(a){var u=a,f=a;if(a.alternate)for(;u.return;)u=u.return;else{a=u;do u=a,u.flags&4098&&(f=u.return),a=u.return;while(a)}return u.tag===3?f:null}function x(a){if(O(a)!==a)throw Error(o(188))}function L(a){var u=a.alternate;if(!u){if(u=O(a),u===null)throw Error(o(188));return u!==a?null:a}for(var f=a,g=u;;){var y=f.return;if(y===null)break;var T=y.alternate;if(T===null){if(g=y.return,g!==null){f=g;continue}break}if(y.child===T.child){for(T=y.child;T;){if(T===f)return x(y),a;if(T===g)return x(y),u;T=T.sibling}throw Error(o(188))}if(f.return!==g.return)f=y,g=T;else{for(var M=!1,j=y.child;j;){if(j===f){M=!0,f=y,g=T;break}if(j===g){M=!0,g=y,f=T;break}j=j.sibling}if(!M){for(j=T.child;j;){if(j===f){M=!0,f=T,g=y;break}if(j===g){M=!0,g=T,f=y;break}j=j.sibling}if(!M)throw Error(o(189))}}if(f.alternate!==g)throw Error(o(190))}if(f.tag!==3)throw Error(o(188));return f.stateNode.current===f?a:u}function z(a){return a=L(a),a!==null?F(a):null}function F(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var u=F(a);if(u!==null)return u;a=a.sibling}return null}function fe(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){if(a.tag!==4){var u=fe(a);if(u!==null)return u}a=a.sibling}return null}var se=Array.isArray,ze=e.getPublicInstance,De=e.getRootHostContext,Y=e.getChildHostContext,oe=e.prepareForCommit,ne=e.resetAfterCommit,ae=e.createInstance,pe=e.appendInitialChild,Se=e.finalizeInitialChildren,en=e.prepareUpdate,At=e.shouldSetTextContent,pt=e.createTextInstance,B=e.scheduleTimeout,Z=e.cancelTimeout,_e=e.noTimeout,Ke=e.isPrimaryRenderer,Re=e.supportsMutation,ot=e.supportsPersistence,lt=e.supportsHydration,mr=e.getInstanceFromNode,rt=e.preparePortalMount,li=e.getCurrentEventPriority,br=e.detachDeletedInstance,bi=e.supportsMicrotasks,Ef=e.scheduleMicrotask,ls=e.supportsTestSelectors,Sf=e.findFiberRoot,I_=e.getBoundingRect,Cc=e.getTextContent,us=e.isHiddenSubtree,Tf=e.matchAccessibilityRole,dn=e.setFocusIfFocusable,Pn=e.setupIntersectionObserver,xl=e.appendChild,Cf=e.appendChildToContainer,If=e.commitTextUpdate,P_=e.commitMount,ya=e.commitUpdate,Pf=e.insertBefore,Rf=e.insertInContainerBefore,Ic=e.removeChild,R_=e.removeChildFromContainer,kf=e.resetTextContent,Pc=e.hideInstance,Af=e.hideTextInstance,xf=e.unhideInstance,va=e.unhideTextInstance,Rc=e.clearContainer,kc=e.cloneInstance,Mi=e.createContainerChildSet,Ac=e.appendChildToContainerChildSet,Nl=e.finalizeContainerChildren,Dl=e.replaceContainerChildren,io=e.cloneHiddenInstance,xc=e.cloneHiddenTextInstance,Rn=e.canHydrateInstance,Nf=e.canHydrateTextInstance,wa=e.canHydrateSuspenseInstance,so=e.isSuspenseInstancePending,Nc=e.isSuspenseInstanceFallback,k_=e.getSuspenseInstanceFallbackErrorDetails,oo=e.registerSuspenseInstanceRetry,Ol=e.getNextHydratableSibling,A_=e.getFirstHydratableChild,bl=e.getFirstHydratableChildWithinContainer,Df=e.getFirstHydratableChildWithinSuspenseInstance,Dc=e.hydrateInstance,Ml=e.hydrateTextInstance,Li=e.hydrateSuspenseInstance,Of=e.getNextHydratableInstanceAfterSuspenseInstance,bf=e.commitHydratedContainer,Oc=e.commitHydratedSuspenseInstance,bc=e.clearSuspenseBoundary,Mf=e.clearSuspenseBoundaryFromContainer,Lf=e.shouldDeleteUnhydratedTailInstances,x_=e.didNotMatchHydratedContainerTextInstance,Ll=e.didNotMatchHydratedTextInstance,Fl;function cs(a){if(Fl===void 0)try{throw Error()}catch(f){var u=f.stack.trim().match(/\n( *(at )?)/);Fl=u&&u[1]||""}return`
`+Fl+a}var hs=!1;function ui(a,u){if(!a||hs)return"";hs=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(u)if(u=function(){throw Error()},Object.defineProperty(u.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(u,[])}catch(te){var g=te}Reflect.construct(a,[],u)}else{try{u.call()}catch(te){g=te}a.call(u.prototype)}else{try{throw Error()}catch(te){g=te}a()}}catch(te){if(te&&g&&typeof te.stack=="string"){for(var y=te.stack.split(`
`),T=g.stack.split(`
`),M=y.length-1,j=T.length-1;1<=M&&0<=j&&y[M]!==T[j];)j--;for(;1<=M&&0<=j;M--,j--)if(y[M]!==T[j]){if(M!==1||j!==1)do if(M--,j--,0>j||y[M]!==T[j]){var $=`
`+y[M].replace(" at new "," at ");return a.displayName&&$.includes("<anonymous>")&&($=$.replace("<anonymous>",a.displayName)),$}while(1<=M&&0<=j);break}}}finally{hs=!1,Error.prepareStackTrace=f}return(a=a?a.displayName||a.name:"")?cs(a):""}var Mc=Object.prototype.hasOwnProperty,Lc=[],ds=-1;function ci(a){return{current:a}}function ht(a){0>ds||(a.current=Lc[ds],Lc[ds]=null,ds--)}function at(a,u){ds++,Lc[ds]=a.current,a.current=u}var Wr={},tn=ci(Wr),kn=ci(!1),fs=Wr;function ao(a,u){var f=a.type.contextTypes;if(!f)return Wr;var g=a.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===u)return g.__reactInternalMemoizedMaskedChildContext;var y={},T;for(T in f)y[T]=u[T];return g&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=u,a.__reactInternalMemoizedMaskedChildContext=y),y}function An(a){return a=a.childContextTypes,a!=null}function Ea(){ht(kn),ht(tn)}function Ff(a,u,f){if(tn.current!==Wr)throw Error(o(168));at(tn,u),at(kn,f)}function Fi(a,u,f){var g=a.stateNode;if(u=u.childContextTypes,typeof g.getChildContext!="function")return f;g=g.getChildContext();for(var y in g)if(!(y in u))throw Error(o(108,C(a)||"Unknown",y));return s({},f,g)}function _r(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Wr,fs=tn.current,at(tn,a),at(kn,kn.current),!0}function Sa(a,u,f){var g=a.stateNode;if(!g)throw Error(o(169));f?(a=Fi(a,u,fs),g.__reactInternalMemoizedMergedChildContext=a,ht(kn),ht(tn),at(tn,a)):ht(kn),at(kn,f)}var Bn=Math.clz32?Math.clz32:Vl,Vf=Math.log,gt=Math.LN2;function Vl(a){return a>>>=0,a===0?32:31-(Vf(a)/gt|0)|0}var Vi=64,Ui=4194304;function Ta(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function Ca(a,u){var f=a.pendingLanes;if(f===0)return 0;var g=0,y=a.suspendedLanes,T=a.pingedLanes,M=f&268435455;if(M!==0){var j=M&~y;j!==0?g=Ta(j):(T&=M,T!==0&&(g=Ta(T)))}else M=f&~y,M!==0?g=Ta(M):T!==0&&(g=Ta(T));if(g===0)return 0;if(u!==0&&u!==g&&!(u&y)&&(y=g&-g,T=u&-u,y>=T||y===16&&(T&4194240)!==0))return u;if(g&4&&(g|=f&16),u=a.entangledLanes,u!==0)for(a=a.entanglements,u&=g;0<u;)f=31-Bn(u),y=1<<f,g|=a[f],u&=~y;return g}function N_(a,u){switch(a){case 1:case 2:case 4:return u+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function D_(a,u){for(var f=a.suspendedLanes,g=a.pingedLanes,y=a.expirationTimes,T=a.pendingLanes;0<T;){var M=31-Bn(T),j=1<<M,$=y[M];$===-1?(!(j&f)||j&g)&&(y[M]=N_(j,u)):$<=u&&(a.expiredLanes|=j),T&=~j}}function Fc(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function Uf(){var a=Vi;return Vi<<=1,!(Vi&4194240)&&(Vi=64),a}function ps(a){for(var u=[],f=0;31>f;f++)u.push(a);return u}function yr(a,u,f){a.pendingLanes|=u,u!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,u=31-Bn(u),a[u]=f}function zf(a,u){var f=a.pendingLanes&~u;a.pendingLanes=u,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=u,a.mutableReadLanes&=u,a.entangledLanes&=u,u=a.entanglements;var g=a.eventTimes;for(a=a.expirationTimes;0<f;){var y=31-Bn(f),T=1<<y;u[y]=0,g[y]=-1,a[y]=-1,f&=~T}}function Ul(a,u){var f=a.entangledLanes|=u;for(a=a.entanglements;f;){var g=31-Bn(f),y=1<<g;y&u|a[g]&u&&(a[g]|=u),f&=~y}}var $e=0;function gs(a){return a&=-a,1<a?4<a?a&268435455?16:536870912:4:1}var Vc=i.unstable_scheduleCallback,Bf=i.unstable_cancelCallback,O_=i.unstable_shouldYield,zi=i.unstable_requestPaint,$t=i.unstable_now,Uc=i.unstable_ImmediatePriority,zl=i.unstable_UserBlockingPriority,lo=i.unstable_NormalPriority,jf=i.unstable_IdlePriority,Bi=null,jn=null;function Gf(a){if(jn&&typeof jn.onCommitFiberRoot=="function")try{jn.onCommitFiberRoot(Bi,a,void 0,(a.current.flags&128)===128)}catch{}}function zc(a,u){return a===u&&(a!==0||1/a===1/u)||a!==a&&u!==u}var Qe=typeof Object.is=="function"?Object.is:zc,hi=null,Bl=!1,jl=!1;function Bc(a){hi===null?hi=[a]:hi.push(a)}function Wf(a){Bl=!0,Bc(a)}function or(){if(!jl&&hi!==null){jl=!0;var a=0,u=$e;try{var f=hi;for($e=1;a<f.length;a++){var g=f[a];do g=g(!0);while(g!==null)}hi=null,Bl=!1}catch(y){throw hi!==null&&(hi=hi.slice(a+1)),Vc(Uc,or),y}finally{$e=u,jl=!1}}return null}var ms=[],Gn=0,Ia=null,Gl=0,fn=[],ar=0,di=null,vr=1,Hr="";function $r(a,u){ms[Gn++]=Gl,ms[Gn++]=Ia,Ia=a,Gl=u}function Hf(a,u,f){fn[ar++]=vr,fn[ar++]=Hr,fn[ar++]=di,di=a;var g=vr;a=Hr;var y=32-Bn(g)-1;g&=~(1<<y),f+=1;var T=32-Bn(u)+y;if(30<T){var M=y-y%5;T=(g&(1<<M)-1).toString(32),g>>=M,y-=M,vr=1<<32-Bn(u)+y|f<<y|g,Hr=T+a}else vr=1<<T|f<<y|g,Hr=a}function Wl(a){a.return!==null&&($r(a,1),Hf(a,1,0))}function _s(a){for(;a===Ia;)Ia=ms[--Gn],ms[Gn]=null,Gl=ms[--Gn],ms[Gn]=null;for(;a===di;)di=fn[--ar],fn[ar]=null,Hr=fn[--ar],fn[ar]=null,vr=fn[--ar],fn[ar]=null}var Wn=null,lr=null,dt=!1,ys=!1,wr=null;function Pa(a,u){var f=Xr(5,null,null,0);f.elementType="DELETED",f.stateNode=u,f.return=a,u=a.deletions,u===null?(a.deletions=[f],a.flags|=16):u.push(f)}function jc(a,u){switch(a.tag){case 5:return u=Rn(u,a.type,a.pendingProps),u!==null?(a.stateNode=u,Wn=a,lr=A_(u),!0):!1;case 6:return u=Nf(u,a.pendingProps),u!==null?(a.stateNode=u,Wn=a,lr=null,!0):!1;case 13:if(u=wa(u),u!==null){var f=di!==null?{id:vr,overflow:Hr}:null;return a.memoizedState={dehydrated:u,treeContext:f,retryLane:1073741824},f=Xr(18,null,null,0),f.stateNode=u,f.return=a,a.child=f,Wn=a,lr=null,!0}return!1;default:return!1}}function Hl(a){return(a.mode&1)!==0&&(a.flags&128)===0}function fi(a){if(dt){var u=lr;if(u){var f=u;if(!jc(a,u)){if(Hl(a))throw Error(o(418));u=Ol(f);var g=Wn;u&&jc(a,u)?Pa(g,f):(a.flags=a.flags&-4097|2,dt=!1,Wn=a)}}else{if(Hl(a))throw Error(o(418));a.flags=a.flags&-4097|2,dt=!1,Wn=a}}}function Gc(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;Wn=a}function Ra(a){if(!lt||a!==Wn)return!1;if(!dt)return Gc(a),dt=!0,!1;if(a.tag!==3&&(a.tag!==5||Lf(a.type)&&!At(a.type,a.memoizedProps))){var u=lr;if(u){if(Hl(a))throw Wc(),Error(o(418));for(;u;)Pa(a,u),u=Ol(u)}}if(Gc(a),a.tag===13){if(!lt)throw Error(o(316));if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(o(317));lr=Of(a)}else lr=Wn?Ol(a.stateNode):null;return!0}function Wc(){for(var a=lr;a;)a=Ol(a)}function vs(){lt&&(lr=Wn=null,ys=dt=!1)}function uo(a){wr===null?wr=[a]:wr.push(a)}var ur=l.ReactCurrentBatchConfig;function ka(a,u){if(Qe(a,u))return!0;if(typeof a!="object"||a===null||typeof u!="object"||u===null)return!1;var f=Object.keys(a),g=Object.keys(u);if(f.length!==g.length)return!1;for(g=0;g<f.length;g++){var y=f[g];if(!Mc.call(u,y)||!Qe(a[y],u[y]))return!1}return!0}function $f(a){switch(a.tag){case 5:return cs(a.type);case 16:return cs("Lazy");case 13:return cs("Suspense");case 19:return cs("SuspenseList");case 0:case 2:case 15:return a=ui(a.type,!1),a;case 11:return a=ui(a.type.render,!1),a;case 1:return a=ui(a.type,!0),a;default:return""}}function qr(a,u,f){if(a=f.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(f._owner){if(f=f._owner,f){if(f.tag!==1)throw Error(o(309));var g=f.stateNode}if(!g)throw Error(o(147,a));var y=g,T=""+a;return u!==null&&u.ref!==null&&typeof u.ref=="function"&&u.ref._stringRef===T?u.ref:(u=function(M){var j=y.refs;M===null?delete j[T]:j[T]=M},u._stringRef=T,u)}if(typeof a!="string")throw Error(o(284));if(!f._owner)throw Error(o(290,a))}return a}function h(a,u){throw a=Object.prototype.toString.call(u),Error(o(31,a==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":a))}function v(a){var u=a._init;return u(a._payload)}function I(a){function u(H,G){if(a){var K=H.deletions;K===null?(H.deletions=[G],H.flags|=16):K.push(G)}}function f(H,G){if(!a)return null;for(;G!==null;)u(H,G),G=G.sibling;return null}function g(H,G){for(H=new Map;G!==null;)G.key!==null?H.set(G.key,G):H.set(G.index,G),G=G.sibling;return H}function y(H,G){return H=_o(H,G),H.index=0,H.sibling=null,H}function T(H,G,K){return H.index=K,a?(K=H.alternate,K!==null?(K=K.index,K<G?(H.flags|=2,G):K):(H.flags|=2,G)):(H.flags|=1048576,G)}function M(H){return a&&H.alternate===null&&(H.flags|=2),H}function j(H,G,K,ce){return G===null||G.tag!==6?(G=Cy(K,H.mode,ce),G.return=H,G):(G=y(G,K),G.return=H,G)}function $(H,G,K,ce){var ve=K.type;return ve===p?ge(H,G,K.props.children,ce,K.key):G!==null&&(G.elementType===ve||typeof ve=="object"&&ve!==null&&ve.$$typeof===w&&v(ve)===G.type)?(ce=y(G,K.props),ce.ref=qr(H,G,K),ce.return=H,ce):(ce=Ep(K.type,K.key,K.props,null,H.mode,ce),ce.ref=qr(H,G,K),ce.return=H,ce)}function te(H,G,K,ce){return G===null||G.tag!==4||G.stateNode.containerInfo!==K.containerInfo||G.stateNode.implementation!==K.implementation?(G=Iy(K,H.mode,ce),G.return=H,G):(G=y(G,K.children||[]),G.return=H,G)}function ge(H,G,K,ce,ve){return G===null||G.tag!==7?(G=ba(K,H.mode,ce,ve),G.return=H,G):(G=y(G,K),G.return=H,G)}function xe(H,G,K){if(typeof G=="string"&&G!==""||typeof G=="number")return G=Cy(""+G,H.mode,K),G.return=H,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case c:return K=Ep(G.type,G.key,G.props,null,H.mode,K),K.ref=qr(H,null,G),K.return=H,K;case d:return G=Iy(G,H.mode,K),G.return=H,G;case w:var ce=G._init;return xe(H,ce(G._payload),K)}if(se(G)||U(G))return G=ba(G,H.mode,K,null),G.return=H,G;h(H,G)}return null}function le(H,G,K,ce){var ve=G!==null?G.key:null;if(typeof K=="string"&&K!==""||typeof K=="number")return ve!==null?null:j(H,G,""+K,ce);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case c:return K.key===ve?$(H,G,K,ce):null;case d:return K.key===ve?te(H,G,K,ce):null;case w:return ve=K._init,le(H,G,ve(K._payload),ce)}if(se(K)||U(K))return ve!==null?null:ge(H,G,K,ce,null);h(H,K)}return null}function St(H,G,K,ce,ve){if(typeof ce=="string"&&ce!==""||typeof ce=="number")return H=H.get(K)||null,j(G,H,""+ce,ve);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case c:return H=H.get(ce.key===null?K:ce.key)||null,$(G,H,ce,ve);case d:return H=H.get(ce.key===null?K:ce.key)||null,te(G,H,ce,ve);case w:var Oe=ce._init;return St(H,G,K,Oe(ce._payload),ve)}if(se(ce)||U(ce))return H=H.get(K)||null,ge(G,H,ce,ve,null);h(G,ce)}return null}function mt(H,G,K,ce){for(var ve=null,Oe=null,Ne=G,et=G=0,_n=null;Ne!==null&&et<K.length;et++){Ne.index>et?(_n=Ne,Ne=null):_n=Ne.sibling;var tt=le(H,Ne,K[et],ce);if(tt===null){Ne===null&&(Ne=_n);break}a&&Ne&&tt.alternate===null&&u(H,Ne),G=T(tt,G,et),Oe===null?ve=tt:Oe.sibling=tt,Oe=tt,Ne=_n}if(et===K.length)return f(H,Ne),dt&&$r(H,et),ve;if(Ne===null){for(;et<K.length;et++)Ne=xe(H,K[et],ce),Ne!==null&&(G=T(Ne,G,et),Oe===null?ve=Ne:Oe.sibling=Ne,Oe=Ne);return dt&&$r(H,et),ve}for(Ne=g(H,Ne);et<K.length;et++)_n=St(Ne,H,et,K[et],ce),_n!==null&&(a&&_n.alternate!==null&&Ne.delete(_n.key===null?et:_n.key),G=T(_n,G,et),Oe===null?ve=_n:Oe.sibling=_n,Oe=_n);return a&&Ne.forEach(function(yo){return u(H,yo)}),dt&&$r(H,et),ve}function Cr(H,G,K,ce){var ve=U(K);if(typeof ve!="function")throw Error(o(150));if(K=ve.call(K),K==null)throw Error(o(151));for(var Oe=ve=null,Ne=G,et=G=0,_n=null,tt=K.next();Ne!==null&&!tt.done;et++,tt=K.next()){Ne.index>et?(_n=Ne,Ne=null):_n=Ne.sibling;var yo=le(H,Ne,tt.value,ce);if(yo===null){Ne===null&&(Ne=_n);break}a&&Ne&&yo.alternate===null&&u(H,Ne),G=T(yo,G,et),Oe===null?ve=yo:Oe.sibling=yo,Oe=yo,Ne=_n}if(tt.done)return f(H,Ne),dt&&$r(H,et),ve;if(Ne===null){for(;!tt.done;et++,tt=K.next())tt=xe(H,tt.value,ce),tt!==null&&(G=T(tt,G,et),Oe===null?ve=tt:Oe.sibling=tt,Oe=tt);return dt&&$r(H,et),ve}for(Ne=g(H,Ne);!tt.done;et++,tt=K.next())tt=St(Ne,H,et,tt.value,ce),tt!==null&&(a&&tt.alternate!==null&&Ne.delete(tt.key===null?et:tt.key),G=T(tt,G,et),Oe===null?ve=tt:Oe.sibling=tt,Oe=tt);return a&&Ne.forEach(function(JA){return u(H,JA)}),dt&&$r(H,et),ve}function Ts(H,G,K,ce){if(typeof K=="object"&&K!==null&&K.type===p&&K.key===null&&(K=K.props.children),typeof K=="object"&&K!==null){switch(K.$$typeof){case c:e:{for(var ve=K.key,Oe=G;Oe!==null;){if(Oe.key===ve){if(ve=K.type,ve===p){if(Oe.tag===7){f(H,Oe.sibling),G=y(Oe,K.props.children),G.return=H,H=G;break e}}else if(Oe.elementType===ve||typeof ve=="object"&&ve!==null&&ve.$$typeof===w&&v(ve)===Oe.type){f(H,Oe.sibling),G=y(Oe,K.props),G.ref=qr(H,Oe,K),G.return=H,H=G;break e}f(H,Oe);break}else u(H,Oe);Oe=Oe.sibling}K.type===p?(G=ba(K.props.children,H.mode,ce,K.key),G.return=H,H=G):(ce=Ep(K.type,K.key,K.props,null,H.mode,ce),ce.ref=qr(H,G,K),ce.return=H,H=ce)}return M(H);case d:e:{for(Oe=K.key;G!==null;){if(G.key===Oe)if(G.tag===4&&G.stateNode.containerInfo===K.containerInfo&&G.stateNode.implementation===K.implementation){f(H,G.sibling),G=y(G,K.children||[]),G.return=H,H=G;break e}else{f(H,G);break}else u(H,G);G=G.sibling}G=Iy(K,H.mode,ce),G.return=H,H=G}return M(H);case w:return Oe=K._init,Ts(H,G,Oe(K._payload),ce)}if(se(K))return mt(H,G,K,ce);if(U(K))return Cr(H,G,K,ce);h(H,K)}return typeof K=="string"&&K!==""||typeof K=="number"?(K=""+K,G!==null&&G.tag===6?(f(H,G.sibling),G=y(G,K),G.return=H,H=G):(f(H,G),G=Cy(K,H.mode,ce),G.return=H,H=G),M(H)):f(H,G)}return Ts}var b=I(!0),W=I(!1),q=ci(null),re=null,Ye=null,zt=null;function je(){zt=Ye=re=null}function nn(a,u,f){Ke?(at(q,u._currentValue),u._currentValue=f):(at(q,u._currentValue2),u._currentValue2=f)}function qt(a){var u=q.current;ht(q),Ke?a._currentValue=u:a._currentValue2=u}function ji(a,u,f){for(;a!==null;){var g=a.alternate;if((a.childLanes&u)!==u?(a.childLanes|=u,g!==null&&(g.childLanes|=u)):g!==null&&(g.childLanes&u)!==u&&(g.childLanes|=u),a===f)break;a=a.return}}function pn(a,u){re=a,zt=Ye=null,a=a.dependencies,a!==null&&a.firstContext!==null&&(a.lanes&u&&(Er=!0),a.firstContext=null)}function xn(a){var u=Ke?a._currentValue:a._currentValue2;if(zt!==a)if(a={context:a,memoizedValue:u,next:null},Ye===null){if(re===null)throw Error(o(308));Ye=a,re.dependencies={lanes:0,firstContext:a}}else Ye=Ye.next=a;return u}var pi=null;function b_(a){pi===null?pi=[a]:pi.push(a)}function dS(a,u,f,g){var y=u.interleaved;return y===null?(f.next=f,b_(u)):(f.next=y.next,y.next=f),u.interleaved=f,Gi(a,g)}function Gi(a,u){a.lanes|=u;var f=a.alternate;for(f!==null&&(f.lanes|=u),f=a,a=a.return;a!==null;)a.childLanes|=u,f=a.alternate,f!==null&&(f.childLanes|=u),f=a,a=a.return;return f.tag===3?f.stateNode:null}var co=!1;function M_(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function fS(a,u){a=a.updateQueue,u.updateQueue===a&&(u.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function ws(a,u){return{eventTime:a,lane:u,tag:0,payload:null,callback:null,next:null}}function ho(a,u,f){var g=a.updateQueue;if(g===null)return null;if(g=g.shared,Le&2){var y=g.pending;return y===null?u.next=u:(u.next=y.next,y.next=u),g.pending=u,Gi(a,f)}return y=g.interleaved,y===null?(u.next=u,b_(g)):(u.next=y.next,y.next=u),g.interleaved=u,Gi(a,f)}function qf(a,u,f){if(u=u.updateQueue,u!==null&&(u=u.shared,(f&4194240)!==0)){var g=u.lanes;g&=a.pendingLanes,f|=g,u.lanes=f,Ul(a,f)}}function pS(a,u){var f=a.updateQueue,g=a.alternate;if(g!==null&&(g=g.updateQueue,f===g)){var y=null,T=null;if(f=f.firstBaseUpdate,f!==null){do{var M={eventTime:f.eventTime,lane:f.lane,tag:f.tag,payload:f.payload,callback:f.callback,next:null};T===null?y=T=M:T=T.next=M,f=f.next}while(f!==null);T===null?y=T=u:T=T.next=u}else y=T=u;f={baseState:g.baseState,firstBaseUpdate:y,lastBaseUpdate:T,shared:g.shared,effects:g.effects},a.updateQueue=f;return}a=f.lastBaseUpdate,a===null?f.firstBaseUpdate=u:a.next=u,f.lastBaseUpdate=u}function Kf(a,u,f,g){var y=a.updateQueue;co=!1;var T=y.firstBaseUpdate,M=y.lastBaseUpdate,j=y.shared.pending;if(j!==null){y.shared.pending=null;var $=j,te=$.next;$.next=null,M===null?T=te:M.next=te,M=$;var ge=a.alternate;ge!==null&&(ge=ge.updateQueue,j=ge.lastBaseUpdate,j!==M&&(j===null?ge.firstBaseUpdate=te:j.next=te,ge.lastBaseUpdate=$))}if(T!==null){var xe=y.baseState;M=0,ge=te=$=null,j=T;do{var le=j.lane,St=j.eventTime;if((g&le)===le){ge!==null&&(ge=ge.next={eventTime:St,lane:0,tag:j.tag,payload:j.payload,callback:j.callback,next:null});e:{var mt=a,Cr=j;switch(le=u,St=f,Cr.tag){case 1:if(mt=Cr.payload,typeof mt=="function"){xe=mt.call(St,xe,le);break e}xe=mt;break e;case 3:mt.flags=mt.flags&-65537|128;case 0:if(mt=Cr.payload,le=typeof mt=="function"?mt.call(St,xe,le):mt,le==null)break e;xe=s({},xe,le);break e;case 2:co=!0}}j.callback!==null&&j.lane!==0&&(a.flags|=64,le=y.effects,le===null?y.effects=[j]:le.push(j))}else St={eventTime:St,lane:le,tag:j.tag,payload:j.payload,callback:j.callback,next:null},ge===null?(te=ge=St,$=xe):ge=ge.next=St,M|=le;if(j=j.next,j===null){if(j=y.shared.pending,j===null)break;le=j,j=le.next,le.next=null,y.lastBaseUpdate=le,y.shared.pending=null}}while(!0);if(ge===null&&($=xe),y.baseState=$,y.firstBaseUpdate=te,y.lastBaseUpdate=ge,u=y.shared.interleaved,u!==null){y=u;do M|=y.lane,y=y.next;while(y!==u)}else T===null&&(y.shared.lanes=0);xa|=M,a.lanes=M,a.memoizedState=xe}}function gS(a,u,f){if(a=u.effects,u.effects=null,a!==null)for(u=0;u<a.length;u++){var g=a[u],y=g.callback;if(y!==null){if(g.callback=null,g=f,typeof y!="function")throw Error(o(191,y));y.call(g)}}}var Hc={},Kr=ci(Hc),$c=ci(Hc),$l=ci(Hc);function Wi(a){if(a===Hc)throw Error(o(174));return a}function L_(a,u){at($l,u),at($c,a),at(Kr,Hc),a=De(u),ht(Kr),at(Kr,a)}function ql(){ht(Kr),ht($c),ht($l)}function mS(a){var u=Wi($l.current),f=Wi(Kr.current);u=Y(f,a.type,u),f!==u&&(at($c,a),at(Kr,u))}function F_(a){$c.current===a&&(ht(Kr),ht($c))}var xt=ci(0);function Qf(a){for(var u=a;u!==null;){if(u.tag===13){var f=u.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||so(f)||Nc(f)))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if(u.flags&128)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===a)break;for(;u.sibling===null;){if(u.return===null||u.return===a)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var V_=[];function U_(){for(var a=0;a<V_.length;a++){var u=V_[a];Ke?u._workInProgressVersionPrimary=null:u._workInProgressVersionSecondary=null}V_.length=0}var Yf=l.ReactCurrentDispatcher,z_=l.ReactCurrentBatchConfig,Aa=0,Nt=null,rn=null,gn=null,Xf=!1,qc=!1,Kc=0,TA=0;function Hn(){throw Error(o(321))}function B_(a,u){if(u===null)return!1;for(var f=0;f<u.length&&f<a.length;f++)if(!Qe(a[f],u[f]))return!1;return!0}function j_(a,u,f,g,y,T){if(Aa=T,Nt=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,Yf.current=a===null||a.memoizedState===null?RA:kA,a=f(g,y),qc){T=0;do{if(qc=!1,Kc=0,25<=T)throw Error(o(301));T+=1,gn=rn=null,u.updateQueue=null,Yf.current=AA,a=f(g,y)}while(qc)}if(Yf.current=ep,u=rn!==null&&rn.next!==null,Aa=0,gn=rn=Nt=null,Xf=!1,u)throw Error(o(300));return a}function G_(){var a=Kc!==0;return Kc=0,a}function Hi(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gn===null?Nt.memoizedState=gn=a:gn=gn.next=a,gn}function Qr(){if(rn===null){var a=Nt.alternate;a=a!==null?a.memoizedState:null}else a=rn.next;var u=gn===null?Nt.memoizedState:gn.next;if(u!==null)gn=u,rn=a;else{if(a===null)throw Error(o(310));rn=a,a={memoizedState:rn.memoizedState,baseState:rn.baseState,baseQueue:rn.baseQueue,queue:rn.queue,next:null},gn===null?Nt.memoizedState=gn=a:gn=gn.next=a}return gn}function Qc(a,u){return typeof u=="function"?u(a):u}function W_(a){var u=Qr(),f=u.queue;if(f===null)throw Error(o(311));f.lastRenderedReducer=a;var g=rn,y=g.baseQueue,T=f.pending;if(T!==null){if(y!==null){var M=y.next;y.next=T.next,T.next=M}g.baseQueue=y=T,f.pending=null}if(y!==null){T=y.next,g=g.baseState;var j=M=null,$=null,te=T;do{var ge=te.lane;if((Aa&ge)===ge)$!==null&&($=$.next={lane:0,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null}),g=te.hasEagerState?te.eagerState:a(g,te.action);else{var xe={lane:ge,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null};$===null?(j=$=xe,M=g):$=$.next=xe,Nt.lanes|=ge,xa|=ge}te=te.next}while(te!==null&&te!==T);$===null?M=g:$.next=j,Qe(g,u.memoizedState)||(Er=!0),u.memoizedState=g,u.baseState=M,u.baseQueue=$,f.lastRenderedState=g}if(a=f.interleaved,a!==null){y=a;do T=y.lane,Nt.lanes|=T,xa|=T,y=y.next;while(y!==a)}else y===null&&(f.lanes=0);return[u.memoizedState,f.dispatch]}function H_(a){var u=Qr(),f=u.queue;if(f===null)throw Error(o(311));f.lastRenderedReducer=a;var g=f.dispatch,y=f.pending,T=u.memoizedState;if(y!==null){f.pending=null;var M=y=y.next;do T=a(T,M.action),M=M.next;while(M!==y);Qe(T,u.memoizedState)||(Er=!0),u.memoizedState=T,u.baseQueue===null&&(u.baseState=T),f.lastRenderedState=T}return[T,g]}function _S(){}function yS(a,u){var f=Nt,g=Qr(),y=u(),T=!Qe(g.memoizedState,y);if(T&&(g.memoizedState=y,Er=!0),g=g.queue,$_(ES.bind(null,f,g,a),[a]),g.getSnapshot!==u||T||gn!==null&&gn.memoizedState.tag&1){if(f.flags|=2048,Yc(9,wS.bind(null,f,g,y,u),void 0,null),mn===null)throw Error(o(349));Aa&30||vS(f,u,y)}return y}function vS(a,u,f){a.flags|=16384,a={getSnapshot:u,value:f},u=Nt.updateQueue,u===null?(u={lastEffect:null,stores:null},Nt.updateQueue=u,u.stores=[a]):(f=u.stores,f===null?u.stores=[a]:f.push(a))}function wS(a,u,f,g){u.value=f,u.getSnapshot=g,SS(u)&&TS(a)}function ES(a,u,f){return f(function(){SS(u)&&TS(a)})}function SS(a){var u=a.getSnapshot;a=a.value;try{var f=u();return!Qe(a,f)}catch{return!0}}function TS(a){var u=Gi(a,1);u!==null&&Yr(u,a,1,-1)}function CS(a){var u=Hi();return typeof a=="function"&&(a=a()),u.memoizedState=u.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Qc,lastRenderedState:a},u.queue=a,a=a.dispatch=PA.bind(null,Nt,a),[u.memoizedState,a]}function Yc(a,u,f,g){return a={tag:a,create:u,destroy:f,deps:g,next:null},u=Nt.updateQueue,u===null?(u={lastEffect:null,stores:null},Nt.updateQueue=u,u.lastEffect=a.next=a):(f=u.lastEffect,f===null?u.lastEffect=a.next=a:(g=f.next,f.next=a,a.next=g,u.lastEffect=a)),a}function IS(){return Qr().memoizedState}function Jf(a,u,f,g){var y=Hi();Nt.flags|=a,y.memoizedState=Yc(1|u,f,void 0,g===void 0?null:g)}function Zf(a,u,f,g){var y=Qr();g=g===void 0?null:g;var T=void 0;if(rn!==null){var M=rn.memoizedState;if(T=M.destroy,g!==null&&B_(g,M.deps)){y.memoizedState=Yc(u,f,T,g);return}}Nt.flags|=a,y.memoizedState=Yc(1|u,f,T,g)}function PS(a,u){return Jf(8390656,8,a,u)}function $_(a,u){return Zf(2048,8,a,u)}function RS(a,u){return Zf(4,2,a,u)}function kS(a,u){return Zf(4,4,a,u)}function AS(a,u){if(typeof u=="function")return a=a(),u(a),function(){u(null)};if(u!=null)return a=a(),u.current=a,function(){u.current=null}}function xS(a,u,f){return f=f!=null?f.concat([a]):null,Zf(4,4,AS.bind(null,u,a),f)}function q_(){}function NS(a,u){var f=Qr();u=u===void 0?null:u;var g=f.memoizedState;return g!==null&&u!==null&&B_(u,g[1])?g[0]:(f.memoizedState=[a,u],a)}function DS(a,u){var f=Qr();u=u===void 0?null:u;var g=f.memoizedState;return g!==null&&u!==null&&B_(u,g[1])?g[0]:(a=a(),f.memoizedState=[a,u],a)}function OS(a,u,f){return Aa&21?(Qe(f,u)||(f=Uf(),Nt.lanes|=f,xa|=f,a.baseState=!0),u):(a.baseState&&(a.baseState=!1,Er=!0),a.memoizedState=f)}function CA(a,u){var f=$e;$e=f!==0&&4>f?f:4,a(!0);var g=z_.transition;z_.transition={};try{a(!1),u()}finally{$e=f,z_.transition=g}}function bS(){return Qr().memoizedState}function IA(a,u,f){var g=go(a);if(f={lane:g,action:f,hasEagerState:!1,eagerState:null,next:null},MS(a))LS(u,f);else if(f=dS(a,u,f,g),f!==null){var y=Kn();Yr(f,a,g,y),FS(f,u,g)}}function PA(a,u,f){var g=go(a),y={lane:g,action:f,hasEagerState:!1,eagerState:null,next:null};if(MS(a))LS(u,y);else{var T=a.alternate;if(a.lanes===0&&(T===null||T.lanes===0)&&(T=u.lastRenderedReducer,T!==null))try{var M=u.lastRenderedState,j=T(M,f);if(y.hasEagerState=!0,y.eagerState=j,Qe(j,M)){var $=u.interleaved;$===null?(y.next=y,b_(u)):(y.next=$.next,$.next=y),u.interleaved=y;return}}catch{}finally{}f=dS(a,u,y,g),f!==null&&(y=Kn(),Yr(f,a,g,y),FS(f,u,g))}}function MS(a){var u=a.alternate;return a===Nt||u!==null&&u===Nt}function LS(a,u){qc=Xf=!0;var f=a.pending;f===null?u.next=u:(u.next=f.next,f.next=u),a.pending=u}function FS(a,u,f){if(f&4194240){var g=u.lanes;g&=a.pendingLanes,f|=g,u.lanes=f,Ul(a,f)}}var ep={readContext:xn,useCallback:Hn,useContext:Hn,useEffect:Hn,useImperativeHandle:Hn,useInsertionEffect:Hn,useLayoutEffect:Hn,useMemo:Hn,useReducer:Hn,useRef:Hn,useState:Hn,useDebugValue:Hn,useDeferredValue:Hn,useTransition:Hn,useMutableSource:Hn,useSyncExternalStore:Hn,useId:Hn,unstable_isNewReconciler:!1},RA={readContext:xn,useCallback:function(a,u){return Hi().memoizedState=[a,u===void 0?null:u],a},useContext:xn,useEffect:PS,useImperativeHandle:function(a,u,f){return f=f!=null?f.concat([a]):null,Jf(4194308,4,AS.bind(null,u,a),f)},useLayoutEffect:function(a,u){return Jf(4194308,4,a,u)},useInsertionEffect:function(a,u){return Jf(4,2,a,u)},useMemo:function(a,u){var f=Hi();return u=u===void 0?null:u,a=a(),f.memoizedState=[a,u],a},useReducer:function(a,u,f){var g=Hi();return u=f!==void 0?f(u):u,g.memoizedState=g.baseState=u,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:u},g.queue=a,a=a.dispatch=IA.bind(null,Nt,a),[g.memoizedState,a]},useRef:function(a){var u=Hi();return a={current:a},u.memoizedState=a},useState:CS,useDebugValue:q_,useDeferredValue:function(a){return Hi().memoizedState=a},useTransition:function(){var a=CS(!1),u=a[0];return a=CA.bind(null,a[1]),Hi().memoizedState=a,[u,a]},useMutableSource:function(){},useSyncExternalStore:function(a,u,f){var g=Nt,y=Hi();if(dt){if(f===void 0)throw Error(o(407));f=f()}else{if(f=u(),mn===null)throw Error(o(349));Aa&30||vS(g,u,f)}y.memoizedState=f;var T={value:f,getSnapshot:u};return y.queue=T,PS(ES.bind(null,g,T,a),[a]),g.flags|=2048,Yc(9,wS.bind(null,g,T,f,u),void 0,null),f},useId:function(){var a=Hi(),u=mn.identifierPrefix;if(dt){var f=Hr,g=vr;f=(g&~(1<<32-Bn(g)-1)).toString(32)+f,u=":"+u+"R"+f,f=Kc++,0<f&&(u+="H"+f.toString(32)),u+=":"}else f=TA++,u=":"+u+"r"+f.toString(32)+":";return a.memoizedState=u},unstable_isNewReconciler:!1},kA={readContext:xn,useCallback:NS,useContext:xn,useEffect:$_,useImperativeHandle:xS,useInsertionEffect:RS,useLayoutEffect:kS,useMemo:DS,useReducer:W_,useRef:IS,useState:function(){return W_(Qc)},useDebugValue:q_,useDeferredValue:function(a){var u=Qr();return OS(u,rn.memoizedState,a)},useTransition:function(){var a=W_(Qc)[0],u=Qr().memoizedState;return[a,u]},useMutableSource:_S,useSyncExternalStore:yS,useId:bS,unstable_isNewReconciler:!1},AA={readContext:xn,useCallback:NS,useContext:xn,useEffect:$_,useImperativeHandle:xS,useInsertionEffect:RS,useLayoutEffect:kS,useMemo:DS,useReducer:H_,useRef:IS,useState:function(){return H_(Qc)},useDebugValue:q_,useDeferredValue:function(a){var u=Qr();return rn===null?u.memoizedState=a:OS(u,rn.memoizedState,a)},useTransition:function(){var a=H_(Qc)[0],u=Qr().memoizedState;return[a,u]},useMutableSource:_S,useSyncExternalStore:yS,useId:bS,unstable_isNewReconciler:!1};function gi(a,u){if(a&&a.defaultProps){u=s({},u),a=a.defaultProps;for(var f in a)u[f]===void 0&&(u[f]=a[f]);return u}return u}function K_(a,u,f,g){u=a.memoizedState,f=f(g,u),f=f==null?u:s({},u,f),a.memoizedState=f,a.lanes===0&&(a.updateQueue.baseState=f)}var tp={isMounted:function(a){return(a=a._reactInternals)?O(a)===a:!1},enqueueSetState:function(a,u,f){a=a._reactInternals;var g=Kn(),y=go(a),T=ws(g,y);T.payload=u,f!=null&&(T.callback=f),u=ho(a,T,y),u!==null&&(Yr(u,a,y,g),qf(u,a,y))},enqueueReplaceState:function(a,u,f){a=a._reactInternals;var g=Kn(),y=go(a),T=ws(g,y);T.tag=1,T.payload=u,f!=null&&(T.callback=f),u=ho(a,T,y),u!==null&&(Yr(u,a,y,g),qf(u,a,y))},enqueueForceUpdate:function(a,u){a=a._reactInternals;var f=Kn(),g=go(a),y=ws(f,g);y.tag=2,u!=null&&(y.callback=u),u=ho(a,y,g),u!==null&&(Yr(u,a,g,f),qf(u,a,g))}};function VS(a,u,f,g,y,T,M){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(g,T,M):u.prototype&&u.prototype.isPureReactComponent?!ka(f,g)||!ka(y,T):!0}function US(a,u,f){var g=!1,y=Wr,T=u.contextType;return typeof T=="object"&&T!==null?T=xn(T):(y=An(u)?fs:tn.current,g=u.contextTypes,T=(g=g!=null)?ao(a,y):Wr),u=new u(f,T),a.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,u.updater=tp,a.stateNode=u,u._reactInternals=a,g&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=y,a.__reactInternalMemoizedMaskedChildContext=T),u}function zS(a,u,f,g){a=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(f,g),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(f,g),u.state!==a&&tp.enqueueReplaceState(u,u.state,null)}function Q_(a,u,f,g){var y=a.stateNode;y.props=f,y.state=a.memoizedState,y.refs={},M_(a);var T=u.contextType;typeof T=="object"&&T!==null?y.context=xn(T):(T=An(u)?fs:tn.current,y.context=ao(a,T)),y.state=a.memoizedState,T=u.getDerivedStateFromProps,typeof T=="function"&&(K_(a,u,T,f),y.state=a.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(u=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),u!==y.state&&tp.enqueueReplaceState(y,y.state,null),Kf(a,f,y,g),y.state=a.memoizedState),typeof y.componentDidMount=="function"&&(a.flags|=4194308)}function Kl(a,u){try{var f="",g=u;do f+=$f(g),g=g.return;while(g);var y=f}catch(T){y=`
Error generating stack: `+T.message+`
`+T.stack}return{value:a,source:u,stack:y,digest:null}}function Y_(a,u,f){return{value:a,source:null,stack:f??null,digest:u??null}}function X_(a,u){try{console.error(u.value)}catch(f){setTimeout(function(){throw f})}}var xA=typeof WeakMap=="function"?WeakMap:Map;function BS(a,u,f){f=ws(-1,f),f.tag=3,f.payload={element:null};var g=u.value;return f.callback=function(){gp||(gp=!0,_y=g),X_(a,u)},f}function jS(a,u,f){f=ws(-1,f),f.tag=3;var g=a.type.getDerivedStateFromError;if(typeof g=="function"){var y=u.value;f.payload=function(){return g(y)},f.callback=function(){X_(a,u)}}var T=a.stateNode;return T!==null&&typeof T.componentDidCatch=="function"&&(f.callback=function(){X_(a,u),typeof g!="function"&&(fo===null?fo=new Set([this]):fo.add(this));var M=u.stack;this.componentDidCatch(u.value,{componentStack:M!==null?M:""})}),f}function GS(a,u,f){var g=a.pingCache;if(g===null){g=a.pingCache=new xA;var y=new Set;g.set(u,y)}else y=g.get(u),y===void 0&&(y=new Set,g.set(u,y));y.has(f)||(y.add(f),a=WA.bind(null,a,u,f),u.then(a,a))}function WS(a){do{var u;if((u=a.tag===13)&&(u=a.memoizedState,u=u!==null?u.dehydrated!==null:!0),u)return a;a=a.return}while(a!==null);return null}function HS(a,u,f,g,y){return a.mode&1?(a.flags|=65536,a.lanes=y,a):(a===u?a.flags|=65536:(a.flags|=128,f.flags|=131072,f.flags&=-52805,f.tag===1&&(f.alternate===null?f.tag=17:(u=ws(-1,1),u.tag=2,ho(f,u,1))),f.lanes|=1),a)}var NA=l.ReactCurrentOwner,Er=!1;function cr(a,u,f,g){u.child=a===null?W(u,null,f,g):b(u,a.child,f,g)}function $S(a,u,f,g,y){f=f.render;var T=u.ref;return pn(u,y),g=j_(a,u,f,g,T,y),f=G_(),a!==null&&!Er?(u.updateQueue=a.updateQueue,u.flags&=-2053,a.lanes&=~y,Es(a,u,y)):(dt&&f&&Wl(u),u.flags|=1,cr(a,u,g,y),u.child)}function qS(a,u,f,g,y){if(a===null){var T=f.type;return typeof T=="function"&&!Ty(T)&&T.defaultProps===void 0&&f.compare===null&&f.defaultProps===void 0?(u.tag=15,u.type=T,KS(a,u,T,g,y)):(a=Ep(f.type,null,g,u,u.mode,y),a.ref=u.ref,a.return=u,u.child=a)}if(T=a.child,!(a.lanes&y)){var M=T.memoizedProps;if(f=f.compare,f=f!==null?f:ka,f(M,g)&&a.ref===u.ref)return Es(a,u,y)}return u.flags|=1,a=_o(T,g),a.ref=u.ref,a.return=u,u.child=a}function KS(a,u,f,g,y){if(a!==null){var T=a.memoizedProps;if(ka(T,g)&&a.ref===u.ref)if(Er=!1,u.pendingProps=g=T,(a.lanes&y)!==0)a.flags&131072&&(Er=!0);else return u.lanes=a.lanes,Es(a,u,y)}return J_(a,u,f,g,y)}function QS(a,u,f){var g=u.pendingProps,y=g.children,T=a!==null?a.memoizedState:null;if(g.mode==="hidden")if(!(u.mode&1))u.memoizedState={baseLanes:0,cachePool:null,transitions:null},at(Yl,Mr),Mr|=f;else{if(!(f&1073741824))return a=T!==null?T.baseLanes|f:f,u.lanes=u.childLanes=1073741824,u.memoizedState={baseLanes:a,cachePool:null,transitions:null},u.updateQueue=null,at(Yl,Mr),Mr|=a,null;u.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=T!==null?T.baseLanes:f,at(Yl,Mr),Mr|=g}else T!==null?(g=T.baseLanes|f,u.memoizedState=null):g=f,at(Yl,Mr),Mr|=g;return cr(a,u,y,f),u.child}function YS(a,u){var f=u.ref;(a===null&&f!==null||a!==null&&a.ref!==f)&&(u.flags|=512,u.flags|=2097152)}function J_(a,u,f,g,y){var T=An(f)?fs:tn.current;return T=ao(u,T),pn(u,y),f=j_(a,u,f,g,T,y),g=G_(),a!==null&&!Er?(u.updateQueue=a.updateQueue,u.flags&=-2053,a.lanes&=~y,Es(a,u,y)):(dt&&g&&Wl(u),u.flags|=1,cr(a,u,f,y),u.child)}function XS(a,u,f,g,y){if(An(f)){var T=!0;_r(u)}else T=!1;if(pn(u,y),u.stateNode===null)rp(a,u),US(u,f,g),Q_(u,f,g,y),g=!0;else if(a===null){var M=u.stateNode,j=u.memoizedProps;M.props=j;var $=M.context,te=f.contextType;typeof te=="object"&&te!==null?te=xn(te):(te=An(f)?fs:tn.current,te=ao(u,te));var ge=f.getDerivedStateFromProps,xe=typeof ge=="function"||typeof M.getSnapshotBeforeUpdate=="function";xe||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(j!==g||$!==te)&&zS(u,M,g,te),co=!1;var le=u.memoizedState;M.state=le,Kf(u,g,M,y),$=u.memoizedState,j!==g||le!==$||kn.current||co?(typeof ge=="function"&&(K_(u,f,ge,g),$=u.memoizedState),(j=co||VS(u,f,j,g,le,$,te))?(xe||typeof M.UNSAFE_componentWillMount!="function"&&typeof M.componentWillMount!="function"||(typeof M.componentWillMount=="function"&&M.componentWillMount(),typeof M.UNSAFE_componentWillMount=="function"&&M.UNSAFE_componentWillMount()),typeof M.componentDidMount=="function"&&(u.flags|=4194308)):(typeof M.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=g,u.memoizedState=$),M.props=g,M.state=$,M.context=te,g=j):(typeof M.componentDidMount=="function"&&(u.flags|=4194308),g=!1)}else{M=u.stateNode,fS(a,u),j=u.memoizedProps,te=u.type===u.elementType?j:gi(u.type,j),M.props=te,xe=u.pendingProps,le=M.context,$=f.contextType,typeof $=="object"&&$!==null?$=xn($):($=An(f)?fs:tn.current,$=ao(u,$));var St=f.getDerivedStateFromProps;(ge=typeof St=="function"||typeof M.getSnapshotBeforeUpdate=="function")||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(j!==xe||le!==$)&&zS(u,M,g,$),co=!1,le=u.memoizedState,M.state=le,Kf(u,g,M,y);var mt=u.memoizedState;j!==xe||le!==mt||kn.current||co?(typeof St=="function"&&(K_(u,f,St,g),mt=u.memoizedState),(te=co||VS(u,f,te,g,le,mt,$)||!1)?(ge||typeof M.UNSAFE_componentWillUpdate!="function"&&typeof M.componentWillUpdate!="function"||(typeof M.componentWillUpdate=="function"&&M.componentWillUpdate(g,mt,$),typeof M.UNSAFE_componentWillUpdate=="function"&&M.UNSAFE_componentWillUpdate(g,mt,$)),typeof M.componentDidUpdate=="function"&&(u.flags|=4),typeof M.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof M.componentDidUpdate!="function"||j===a.memoizedProps&&le===a.memoizedState||(u.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||j===a.memoizedProps&&le===a.memoizedState||(u.flags|=1024),u.memoizedProps=g,u.memoizedState=mt),M.props=g,M.state=mt,M.context=$,g=te):(typeof M.componentDidUpdate!="function"||j===a.memoizedProps&&le===a.memoizedState||(u.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||j===a.memoizedProps&&le===a.memoizedState||(u.flags|=1024),g=!1)}return Z_(a,u,f,g,T,y)}function Z_(a,u,f,g,y,T){YS(a,u);var M=(u.flags&128)!==0;if(!g&&!M)return y&&Sa(u,f,!1),Es(a,u,T);g=u.stateNode,NA.current=u;var j=M&&typeof f.getDerivedStateFromError!="function"?null:g.render();return u.flags|=1,a!==null&&M?(u.child=b(u,a.child,null,T),u.child=b(u,null,j,T)):cr(a,u,j,T),u.memoizedState=g.state,y&&Sa(u,f,!0),u.child}function JS(a){var u=a.stateNode;u.pendingContext?Ff(a,u.pendingContext,u.pendingContext!==u.context):u.context&&Ff(a,u.context,!1),L_(a,u.containerInfo)}function ZS(a,u,f,g,y){return vs(),uo(y),u.flags|=256,cr(a,u,f,g),u.child}var ey={dehydrated:null,treeContext:null,retryLane:0};function ty(a){return{baseLanes:a,cachePool:null,transitions:null}}function e4(a,u,f){var g=u.pendingProps,y=xt.current,T=!1,M=(u.flags&128)!==0,j;if((j=M)||(j=a!==null&&a.memoizedState===null?!1:(y&2)!==0),j?(T=!0,u.flags&=-129):(a===null||a.memoizedState!==null)&&(y|=1),at(xt,y&1),a===null)return fi(u),a=u.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?(u.mode&1?Nc(a)?u.lanes=8:u.lanes=1073741824:u.lanes=1,null):(M=g.children,a=g.fallback,T?(g=u.mode,T=u.child,M={mode:"hidden",children:M},!(g&1)&&T!==null?(T.childLanes=0,T.pendingProps=M):T=Sp(M,g,0,null),a=ba(a,g,f,null),T.return=u,a.return=u,T.sibling=a,u.child=T,u.child.memoizedState=ty(f),u.memoizedState=ey,a):ny(u,M));if(y=a.memoizedState,y!==null&&(j=y.dehydrated,j!==null))return DA(a,u,M,g,j,y,f);if(T){T=g.fallback,M=u.mode,y=a.child,j=y.sibling;var $={mode:"hidden",children:g.children};return!(M&1)&&u.child!==y?(g=u.child,g.childLanes=0,g.pendingProps=$,u.deletions=null):(g=_o(y,$),g.subtreeFlags=y.subtreeFlags&14680064),j!==null?T=_o(j,T):(T=ba(T,M,f,null),T.flags|=2),T.return=u,g.return=u,g.sibling=T,u.child=g,g=T,T=u.child,M=a.child.memoizedState,M=M===null?ty(f):{baseLanes:M.baseLanes|f,cachePool:null,transitions:M.transitions},T.memoizedState=M,T.childLanes=a.childLanes&~f,u.memoizedState=ey,g}return T=a.child,a=T.sibling,g=_o(T,{mode:"visible",children:g.children}),!(u.mode&1)&&(g.lanes=f),g.return=u,g.sibling=null,a!==null&&(f=u.deletions,f===null?(u.deletions=[a],u.flags|=16):f.push(a)),u.child=g,u.memoizedState=null,g}function ny(a,u){return u=Sp({mode:"visible",children:u},a.mode,0,null),u.return=a,a.child=u}function np(a,u,f,g){return g!==null&&uo(g),b(u,a.child,null,f),a=ny(u,u.pendingProps.children),a.flags|=2,u.memoizedState=null,a}function DA(a,u,f,g,y,T,M){if(f)return u.flags&256?(u.flags&=-257,g=Y_(Error(o(422))),np(a,u,M,g)):u.memoizedState!==null?(u.child=a.child,u.flags|=128,null):(T=g.fallback,y=u.mode,g=Sp({mode:"visible",children:g.children},y,0,null),T=ba(T,y,M,null),T.flags|=2,g.return=u,T.return=u,g.sibling=T,u.child=g,u.mode&1&&b(u,a.child,null,M),u.child.memoizedState=ty(M),u.memoizedState=ey,T);if(!(u.mode&1))return np(a,u,M,null);if(Nc(y))return g=k_(y).digest,T=Error(o(419)),g=Y_(T,g,void 0),np(a,u,M,g);if(f=(M&a.childLanes)!==0,Er||f){if(g=mn,g!==null){switch(M&-M){case 4:y=2;break;case 16:y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:y=32;break;case 536870912:y=268435456;break;default:y=0}y=y&(g.suspendedLanes|M)?0:y,y!==0&&y!==T.retryLane&&(T.retryLane=y,Gi(a,y),Yr(g,a,y,-1))}return Sy(),g=Y_(Error(o(421))),np(a,u,M,g)}return so(y)?(u.flags|=128,u.child=a.child,u=HA.bind(null,a),oo(y,u),null):(a=T.treeContext,lt&&(lr=Df(y),Wn=u,dt=!0,wr=null,ys=!1,a!==null&&(fn[ar++]=vr,fn[ar++]=Hr,fn[ar++]=di,vr=a.id,Hr=a.overflow,di=u)),u=ny(u,g.children),u.flags|=4096,u)}function t4(a,u,f){a.lanes|=u;var g=a.alternate;g!==null&&(g.lanes|=u),ji(a.return,u,f)}function ry(a,u,f,g,y){var T=a.memoizedState;T===null?a.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:g,tail:f,tailMode:y}:(T.isBackwards=u,T.rendering=null,T.renderingStartTime=0,T.last=g,T.tail=f,T.tailMode=y)}function n4(a,u,f){var g=u.pendingProps,y=g.revealOrder,T=g.tail;if(cr(a,u,g.children,f),g=xt.current,g&2)g=g&1|2,u.flags|=128;else{if(a!==null&&a.flags&128)e:for(a=u.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&t4(a,f,u);else if(a.tag===19)t4(a,f,u);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===u)break e;for(;a.sibling===null;){if(a.return===null||a.return===u)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}g&=1}if(at(xt,g),!(u.mode&1))u.memoizedState=null;else switch(y){case"forwards":for(f=u.child,y=null;f!==null;)a=f.alternate,a!==null&&Qf(a)===null&&(y=f),f=f.sibling;f=y,f===null?(y=u.child,u.child=null):(y=f.sibling,f.sibling=null),ry(u,!1,y,f,T);break;case"backwards":for(f=null,y=u.child,u.child=null;y!==null;){if(a=y.alternate,a!==null&&Qf(a)===null){u.child=y;break}a=y.sibling,y.sibling=f,f=y,y=a}ry(u,!0,f,null,T);break;case"together":ry(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function rp(a,u){!(u.mode&1)&&a!==null&&(a.alternate=null,u.alternate=null,u.flags|=2)}function Es(a,u,f){if(a!==null&&(u.dependencies=a.dependencies),xa|=u.lanes,!(f&u.childLanes))return null;if(a!==null&&u.child!==a.child)throw Error(o(153));if(u.child!==null){for(a=u.child,f=_o(a,a.pendingProps),u.child=f,f.return=u;a.sibling!==null;)a=a.sibling,f=f.sibling=_o(a,a.pendingProps),f.return=u;f.sibling=null}return u.child}function OA(a,u,f){switch(u.tag){case 3:JS(u),vs();break;case 5:mS(u);break;case 1:An(u.type)&&_r(u);break;case 4:L_(u,u.stateNode.containerInfo);break;case 10:nn(u,u.type._context,u.memoizedProps.value);break;case 13:var g=u.memoizedState;if(g!==null)return g.dehydrated!==null?(at(xt,xt.current&1),u.flags|=128,null):f&u.child.childLanes?e4(a,u,f):(at(xt,xt.current&1),a=Es(a,u,f),a!==null?a.sibling:null);at(xt,xt.current&1);break;case 19:if(g=(f&u.childLanes)!==0,a.flags&128){if(g)return n4(a,u,f);u.flags|=128}var y=u.memoizedState;if(y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),at(xt,xt.current),g)break;return null;case 22:case 23:return u.lanes=0,QS(a,u,f)}return Es(a,u,f)}function $i(a){a.flags|=4}function r4(a,u){if(a!==null&&a.child===u.child)return!0;if(u.flags&16)return!1;for(a=u.child;a!==null;){if(a.flags&12854||a.subtreeFlags&12854)return!1;a=a.sibling}return!0}var Xc,Jc,ip,sp;if(Re)Xc=function(a,u){for(var f=u.child;f!==null;){if(f.tag===5||f.tag===6)pe(a,f.stateNode);else if(f.tag!==4&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===u)break;for(;f.sibling===null;){if(f.return===null||f.return===u)return;f=f.return}f.sibling.return=f.return,f=f.sibling}},Jc=function(){},ip=function(a,u,f,g,y){if(a=a.memoizedProps,a!==g){var T=u.stateNode,M=Wi(Kr.current);f=en(T,f,a,g,y,M),(u.updateQueue=f)&&$i(u)}},sp=function(a,u,f,g){f!==g&&$i(u)};else if(ot){Xc=function(a,u,f,g){for(var y=u.child;y!==null;){if(y.tag===5){var T=y.stateNode;f&&g&&(T=io(T,y.type,y.memoizedProps,y)),pe(a,T)}else if(y.tag===6)T=y.stateNode,f&&g&&(T=xc(T,y.memoizedProps,y)),pe(a,T);else if(y.tag!==4){if(y.tag===22&&y.memoizedState!==null)T=y.child,T!==null&&(T.return=y),Xc(a,y,!0,!0);else if(y.child!==null){y.child.return=y,y=y.child;continue}}if(y===u)break;for(;y.sibling===null;){if(y.return===null||y.return===u)return;y=y.return}y.sibling.return=y.return,y=y.sibling}};var i4=function(a,u,f,g){for(var y=u.child;y!==null;){if(y.tag===5){var T=y.stateNode;f&&g&&(T=io(T,y.type,y.memoizedProps,y)),Ac(a,T)}else if(y.tag===6)T=y.stateNode,f&&g&&(T=xc(T,y.memoizedProps,y)),Ac(a,T);else if(y.tag!==4){if(y.tag===22&&y.memoizedState!==null)T=y.child,T!==null&&(T.return=y),i4(a,y,!0,!0);else if(y.child!==null){y.child.return=y,y=y.child;continue}}if(y===u)break;for(;y.sibling===null;){if(y.return===null||y.return===u)return;y=y.return}y.sibling.return=y.return,y=y.sibling}};Jc=function(a,u){var f=u.stateNode;if(!r4(a,u)){a=f.containerInfo;var g=Mi(a);i4(g,u,!1,!1),f.pendingChildren=g,$i(u),Nl(a,g)}},ip=function(a,u,f,g,y){var T=a.stateNode,M=a.memoizedProps;if((a=r4(a,u))&&M===g)u.stateNode=T;else{var j=u.stateNode,$=Wi(Kr.current),te=null;M!==g&&(te=en(j,f,M,g,y,$)),a&&te===null?u.stateNode=T:(T=kc(T,te,f,M,g,u,a,j),Se(T,f,g,y,$)&&$i(u),u.stateNode=T,a?$i(u):Xc(T,u,!1,!1))}},sp=function(a,u,f,g){f!==g?(a=Wi($l.current),f=Wi(Kr.current),u.stateNode=pt(g,a,f,u),$i(u)):u.stateNode=a.stateNode}}else Jc=function(){},ip=function(){},sp=function(){};function Zc(a,u){if(!dt)switch(a.tailMode){case"hidden":u=a.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?a.tail=null:f.sibling=null;break;case"collapsed":f=a.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?u||a.tail===null?a.tail=null:a.tail.sibling=null:g.sibling=null}}function $n(a){var u=a.alternate!==null&&a.alternate.child===a.child,f=0,g=0;if(u)for(var y=a.child;y!==null;)f|=y.lanes|y.childLanes,g|=y.subtreeFlags&14680064,g|=y.flags&14680064,y.return=a,y=y.sibling;else for(y=a.child;y!==null;)f|=y.lanes|y.childLanes,g|=y.subtreeFlags,g|=y.flags,y.return=a,y=y.sibling;return a.subtreeFlags|=g,a.childLanes=f,u}function bA(a,u,f){var g=u.pendingProps;switch(_s(u),u.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $n(u),null;case 1:return An(u.type)&&Ea(),$n(u),null;case 3:return f=u.stateNode,ql(),ht(kn),ht(tn),U_(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(a===null||a.child===null)&&(Ra(u)?$i(u):a===null||a.memoizedState.isDehydrated&&!(u.flags&256)||(u.flags|=1024,wr!==null&&(wy(wr),wr=null))),Jc(a,u),$n(u),null;case 5:F_(u),f=Wi($l.current);var y=u.type;if(a!==null&&u.stateNode!=null)ip(a,u,y,g,f),a.ref!==u.ref&&(u.flags|=512,u.flags|=2097152);else{if(!g){if(u.stateNode===null)throw Error(o(166));return $n(u),null}if(a=Wi(Kr.current),Ra(u)){if(!lt)throw Error(o(175));a=Dc(u.stateNode,u.type,u.memoizedProps,f,a,u,!ys),u.updateQueue=a,a!==null&&$i(u)}else{var T=ae(y,g,f,a,u);Xc(T,u,!1,!1),u.stateNode=T,Se(T,y,g,f,a)&&$i(u)}u.ref!==null&&(u.flags|=512,u.flags|=2097152)}return $n(u),null;case 6:if(a&&u.stateNode!=null)sp(a,u,a.memoizedProps,g);else{if(typeof g!="string"&&u.stateNode===null)throw Error(o(166));if(a=Wi($l.current),f=Wi(Kr.current),Ra(u)){if(!lt)throw Error(o(176));if(a=u.stateNode,f=u.memoizedProps,(g=Ml(a,f,u,!ys))&&(y=Wn,y!==null))switch(y.tag){case 3:x_(y.stateNode.containerInfo,a,f,(y.mode&1)!==0);break;case 5:Ll(y.type,y.memoizedProps,y.stateNode,a,f,(y.mode&1)!==0)}g&&$i(u)}else u.stateNode=pt(g,a,f,u)}return $n(u),null;case 13:if(ht(xt),g=u.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(dt&&lr!==null&&u.mode&1&&!(u.flags&128))Wc(),vs(),u.flags|=98560,y=!1;else if(y=Ra(u),g!==null&&g.dehydrated!==null){if(a===null){if(!y)throw Error(o(318));if(!lt)throw Error(o(344));if(y=u.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(o(317));Li(y,u)}else vs(),!(u.flags&128)&&(u.memoizedState=null),u.flags|=4;$n(u),y=!1}else wr!==null&&(wy(wr),wr=null),y=!0;if(!y)return u.flags&65536?u:null}return u.flags&128?(u.lanes=f,u):(f=g!==null,f!==(a!==null&&a.memoizedState!==null)&&f&&(u.child.flags|=8192,u.mode&1&&(a===null||xt.current&1?sn===0&&(sn=3):Sy())),u.updateQueue!==null&&(u.flags|=4),$n(u),null);case 4:return ql(),Jc(a,u),a===null&&rt(u.stateNode.containerInfo),$n(u),null;case 10:return qt(u.type._context),$n(u),null;case 17:return An(u.type)&&Ea(),$n(u),null;case 19:if(ht(xt),y=u.memoizedState,y===null)return $n(u),null;if(g=(u.flags&128)!==0,T=y.rendering,T===null)if(g)Zc(y,!1);else{if(sn!==0||a!==null&&a.flags&128)for(a=u.child;a!==null;){if(T=Qf(a),T!==null){for(u.flags|=128,Zc(y,!1),a=T.updateQueue,a!==null&&(u.updateQueue=a,u.flags|=4),u.subtreeFlags=0,a=f,f=u.child;f!==null;)g=f,y=a,g.flags&=14680066,T=g.alternate,T===null?(g.childLanes=0,g.lanes=y,g.child=null,g.subtreeFlags=0,g.memoizedProps=null,g.memoizedState=null,g.updateQueue=null,g.dependencies=null,g.stateNode=null):(g.childLanes=T.childLanes,g.lanes=T.lanes,g.child=T.child,g.subtreeFlags=0,g.deletions=null,g.memoizedProps=T.memoizedProps,g.memoizedState=T.memoizedState,g.updateQueue=T.updateQueue,g.type=T.type,y=T.dependencies,g.dependencies=y===null?null:{lanes:y.lanes,firstContext:y.firstContext}),f=f.sibling;return at(xt,xt.current&1|2),u.child}a=a.sibling}y.tail!==null&&$t()>my&&(u.flags|=128,g=!0,Zc(y,!1),u.lanes=4194304)}else{if(!g)if(a=Qf(T),a!==null){if(u.flags|=128,g=!0,a=a.updateQueue,a!==null&&(u.updateQueue=a,u.flags|=4),Zc(y,!0),y.tail===null&&y.tailMode==="hidden"&&!T.alternate&&!dt)return $n(u),null}else 2*$t()-y.renderingStartTime>my&&f!==1073741824&&(u.flags|=128,g=!0,Zc(y,!1),u.lanes=4194304);y.isBackwards?(T.sibling=u.child,u.child=T):(a=y.last,a!==null?a.sibling=T:u.child=T,y.last=T)}return y.tail!==null?(u=y.tail,y.rendering=u,y.tail=u.sibling,y.renderingStartTime=$t(),u.sibling=null,a=xt.current,at(xt,g?a&1|2:a&1),u):($n(u),null);case 22:case 23:return Ey(),f=u.memoizedState!==null,a!==null&&a.memoizedState!==null!==f&&(u.flags|=8192),f&&u.mode&1?Mr&1073741824&&($n(u),Re&&u.subtreeFlags&6&&(u.flags|=8192)):$n(u),null;case 24:return null;case 25:return null}throw Error(o(156,u.tag))}function MA(a,u){switch(_s(u),u.tag){case 1:return An(u.type)&&Ea(),a=u.flags,a&65536?(u.flags=a&-65537|128,u):null;case 3:return ql(),ht(kn),ht(tn),U_(),a=u.flags,a&65536&&!(a&128)?(u.flags=a&-65537|128,u):null;case 5:return F_(u),null;case 13:if(ht(xt),a=u.memoizedState,a!==null&&a.dehydrated!==null){if(u.alternate===null)throw Error(o(340));vs()}return a=u.flags,a&65536?(u.flags=a&-65537|128,u):null;case 19:return ht(xt),null;case 4:return ql(),null;case 10:return qt(u.type._context),null;case 22:case 23:return Ey(),null;case 24:return null;default:return null}}var op=!1,qn=!1,LA=typeof WeakSet=="function"?WeakSet:Set,he=null;function Ql(a,u){var f=a.ref;if(f!==null)if(typeof f=="function")try{f(null)}catch(g){Pt(a,u,g)}else f.current=null}function iy(a,u,f){try{f()}catch(g){Pt(a,u,g)}}var s4=!1;function FA(a,u){for(oe(a.containerInfo),he=u;he!==null;)if(a=he,u=a.child,(a.subtreeFlags&1028)!==0&&u!==null)u.return=a,he=u;else for(;he!==null;){a=he;try{var f=a.alternate;if(a.flags&1024)switch(a.tag){case 0:case 11:case 15:break;case 1:if(f!==null){var g=f.memoizedProps,y=f.memoizedState,T=a.stateNode,M=T.getSnapshotBeforeUpdate(a.elementType===a.type?g:gi(a.type,g),y);T.__reactInternalSnapshotBeforeUpdate=M}break;case 3:Re&&Rc(a.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(j){Pt(a,a.return,j)}if(u=a.sibling,u!==null){u.return=a.return,he=u;break}he=a.return}return f=s4,s4=!1,f}function eh(a,u,f){var g=u.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var y=g=g.next;do{if((y.tag&a)===a){var T=y.destroy;y.destroy=void 0,T!==void 0&&iy(u,f,T)}y=y.next}while(y!==g)}}function ap(a,u){if(u=u.updateQueue,u=u!==null?u.lastEffect:null,u!==null){var f=u=u.next;do{if((f.tag&a)===a){var g=f.create;f.destroy=g()}f=f.next}while(f!==u)}}function sy(a){var u=a.ref;if(u!==null){var f=a.stateNode;switch(a.tag){case 5:a=ze(f);break;default:a=f}typeof u=="function"?u(a):u.current=a}}function o4(a){var u=a.alternate;u!==null&&(a.alternate=null,o4(u)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(u=a.stateNode,u!==null&&br(u)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function a4(a){return a.tag===5||a.tag===3||a.tag===4}function l4(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||a4(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function oy(a,u,f){var g=a.tag;if(g===5||g===6)a=a.stateNode,u?Rf(f,a,u):Cf(f,a);else if(g!==4&&(a=a.child,a!==null))for(oy(a,u,f),a=a.sibling;a!==null;)oy(a,u,f),a=a.sibling}function ay(a,u,f){var g=a.tag;if(g===5||g===6)a=a.stateNode,u?Pf(f,a,u):xl(f,a);else if(g!==4&&(a=a.child,a!==null))for(ay(a,u,f),a=a.sibling;a!==null;)ay(a,u,f),a=a.sibling}var Nn=null,mi=!1;function qi(a,u,f){for(f=f.child;f!==null;)ly(a,u,f),f=f.sibling}function ly(a,u,f){if(jn&&typeof jn.onCommitFiberUnmount=="function")try{jn.onCommitFiberUnmount(Bi,f)}catch{}switch(f.tag){case 5:qn||Ql(f,u);case 6:if(Re){var g=Nn,y=mi;Nn=null,qi(a,u,f),Nn=g,mi=y,Nn!==null&&(mi?R_(Nn,f.stateNode):Ic(Nn,f.stateNode))}else qi(a,u,f);break;case 18:Re&&Nn!==null&&(mi?Mf(Nn,f.stateNode):bc(Nn,f.stateNode));break;case 4:Re?(g=Nn,y=mi,Nn=f.stateNode.containerInfo,mi=!0,qi(a,u,f),Nn=g,mi=y):(ot&&(g=f.stateNode.containerInfo,y=Mi(g),Dl(g,y)),qi(a,u,f));break;case 0:case 11:case 14:case 15:if(!qn&&(g=f.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){y=g=g.next;do{var T=y,M=T.destroy;T=T.tag,M!==void 0&&(T&2||T&4)&&iy(f,u,M),y=y.next}while(y!==g)}qi(a,u,f);break;case 1:if(!qn&&(Ql(f,u),g=f.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=f.memoizedProps,g.state=f.memoizedState,g.componentWillUnmount()}catch(j){Pt(f,u,j)}qi(a,u,f);break;case 21:qi(a,u,f);break;case 22:f.mode&1?(qn=(g=qn)||f.memoizedState!==null,qi(a,u,f),qn=g):qi(a,u,f);break;default:qi(a,u,f)}}function u4(a){var u=a.updateQueue;if(u!==null){a.updateQueue=null;var f=a.stateNode;f===null&&(f=a.stateNode=new LA),u.forEach(function(g){var y=$A.bind(null,a,g);f.has(g)||(f.add(g),g.then(y,y))})}}function _i(a,u){var f=u.deletions;if(f!==null)for(var g=0;g<f.length;g++){var y=f[g];try{var T=a,M=u;if(Re){var j=M;e:for(;j!==null;){switch(j.tag){case 5:Nn=j.stateNode,mi=!1;break e;case 3:Nn=j.stateNode.containerInfo,mi=!0;break e;case 4:Nn=j.stateNode.containerInfo,mi=!0;break e}j=j.return}if(Nn===null)throw Error(o(160));ly(T,M,y),Nn=null,mi=!1}else ly(T,M,y);var $=y.alternate;$!==null&&($.return=null),y.return=null}catch(te){Pt(y,u,te)}}if(u.subtreeFlags&12854)for(u=u.child;u!==null;)c4(u,a),u=u.sibling}function c4(a,u){var f=a.alternate,g=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(_i(u,a),Ki(a),g&4){try{eh(3,a,a.return),ap(3,a)}catch(le){Pt(a,a.return,le)}try{eh(5,a,a.return)}catch(le){Pt(a,a.return,le)}}break;case 1:_i(u,a),Ki(a),g&512&&f!==null&&Ql(f,f.return);break;case 5:if(_i(u,a),Ki(a),g&512&&f!==null&&Ql(f,f.return),Re){if(a.flags&32){var y=a.stateNode;try{kf(y)}catch(le){Pt(a,a.return,le)}}if(g&4&&(y=a.stateNode,y!=null)){var T=a.memoizedProps;if(f=f!==null?f.memoizedProps:T,g=a.type,u=a.updateQueue,a.updateQueue=null,u!==null)try{ya(y,u,g,f,T,a)}catch(le){Pt(a,a.return,le)}}}break;case 6:if(_i(u,a),Ki(a),g&4&&Re){if(a.stateNode===null)throw Error(o(162));y=a.stateNode,T=a.memoizedProps,f=f!==null?f.memoizedProps:T;try{If(y,f,T)}catch(le){Pt(a,a.return,le)}}break;case 3:if(_i(u,a),Ki(a),g&4){if(Re&&lt&&f!==null&&f.memoizedState.isDehydrated)try{bf(u.containerInfo)}catch(le){Pt(a,a.return,le)}if(ot){y=u.containerInfo,T=u.pendingChildren;try{Dl(y,T)}catch(le){Pt(a,a.return,le)}}}break;case 4:if(_i(u,a),Ki(a),g&4&&ot){T=a.stateNode,y=T.containerInfo,T=T.pendingChildren;try{Dl(y,T)}catch(le){Pt(a,a.return,le)}}break;case 13:_i(u,a),Ki(a),y=a.child,y.flags&8192&&(T=y.memoizedState!==null,y.stateNode.isHidden=T,!T||y.alternate!==null&&y.alternate.memoizedState!==null||(gy=$t())),g&4&&u4(a);break;case 22:var M=f!==null&&f.memoizedState!==null;if(a.mode&1?(qn=(f=qn)||M,_i(u,a),qn=f):_i(u,a),Ki(a),g&8192){if(f=a.memoizedState!==null,(a.stateNode.isHidden=f)&&!M&&a.mode&1)for(he=a,g=a.child;g!==null;){for(u=he=g;he!==null;){M=he;var j=M.child;switch(M.tag){case 0:case 11:case 14:case 15:eh(4,M,M.return);break;case 1:Ql(M,M.return);var $=M.stateNode;if(typeof $.componentWillUnmount=="function"){var te=M,ge=M.return;try{var xe=te;$.props=xe.memoizedProps,$.state=xe.memoizedState,$.componentWillUnmount()}catch(le){Pt(te,ge,le)}}break;case 5:Ql(M,M.return);break;case 22:if(M.memoizedState!==null){f4(u);continue}}j!==null?(j.return=M,he=j):f4(u)}g=g.sibling}if(Re){e:if(g=null,Re)for(u=a;;){if(u.tag===5){if(g===null){g=u;try{y=u.stateNode,f?Pc(y):xf(u.stateNode,u.memoizedProps)}catch(le){Pt(a,a.return,le)}}}else if(u.tag===6){if(g===null)try{T=u.stateNode,f?Af(T):va(T,u.memoizedProps)}catch(le){Pt(a,a.return,le)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===a)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===a)break e;for(;u.sibling===null;){if(u.return===null||u.return===a)break e;g===u&&(g=null),u=u.return}g===u&&(g=null),u.sibling.return=u.return,u=u.sibling}}}break;case 19:_i(u,a),Ki(a),g&4&&u4(a);break;case 21:break;default:_i(u,a),Ki(a)}}function Ki(a){var u=a.flags;if(u&2){try{if(Re){e:{for(var f=a.return;f!==null;){if(a4(f)){var g=f;break e}f=f.return}throw Error(o(160))}switch(g.tag){case 5:var y=g.stateNode;g.flags&32&&(kf(y),g.flags&=-33);var T=l4(a);ay(a,T,y);break;case 3:case 4:var M=g.stateNode.containerInfo,j=l4(a);oy(a,j,M);break;default:throw Error(o(161))}}}catch($){Pt(a,a.return,$)}a.flags&=-3}u&4096&&(a.flags&=-4097)}function VA(a,u,f){he=a,h4(a)}function h4(a,u,f){for(var g=(a.mode&1)!==0;he!==null;){var y=he,T=y.child;if(y.tag===22&&g){var M=y.memoizedState!==null||op;if(!M){var j=y.alternate,$=j!==null&&j.memoizedState!==null||qn;j=op;var te=qn;if(op=M,(qn=$)&&!te)for(he=y;he!==null;)M=he,$=M.child,M.tag===22&&M.memoizedState!==null?p4(y):$!==null?($.return=M,he=$):p4(y);for(;T!==null;)he=T,h4(T),T=T.sibling;he=y,op=j,qn=te}d4(a)}else y.subtreeFlags&8772&&T!==null?(T.return=y,he=T):d4(a)}}function d4(a){for(;he!==null;){var u=he;if(u.flags&8772){var f=u.alternate;try{if(u.flags&8772)switch(u.tag){case 0:case 11:case 15:qn||ap(5,u);break;case 1:var g=u.stateNode;if(u.flags&4&&!qn)if(f===null)g.componentDidMount();else{var y=u.elementType===u.type?f.memoizedProps:gi(u.type,f.memoizedProps);g.componentDidUpdate(y,f.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var T=u.updateQueue;T!==null&&gS(u,T,g);break;case 3:var M=u.updateQueue;if(M!==null){if(f=null,u.child!==null)switch(u.child.tag){case 5:f=ze(u.child.stateNode);break;case 1:f=u.child.stateNode}gS(u,M,f)}break;case 5:var j=u.stateNode;f===null&&u.flags&4&&P_(j,u.type,u.memoizedProps,u);break;case 6:break;case 4:break;case 12:break;case 13:if(lt&&u.memoizedState===null){var $=u.alternate;if($!==null){var te=$.memoizedState;if(te!==null){var ge=te.dehydrated;ge!==null&&Oc(ge)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(o(163))}qn||u.flags&512&&sy(u)}catch(xe){Pt(u,u.return,xe)}}if(u===a){he=null;break}if(f=u.sibling,f!==null){f.return=u.return,he=f;break}he=u.return}}function f4(a){for(;he!==null;){var u=he;if(u===a){he=null;break}var f=u.sibling;if(f!==null){f.return=u.return,he=f;break}he=u.return}}function p4(a){for(;he!==null;){var u=he;try{switch(u.tag){case 0:case 11:case 15:var f=u.return;try{ap(4,u)}catch($){Pt(u,f,$)}break;case 1:var g=u.stateNode;if(typeof g.componentDidMount=="function"){var y=u.return;try{g.componentDidMount()}catch($){Pt(u,y,$)}}var T=u.return;try{sy(u)}catch($){Pt(u,T,$)}break;case 5:var M=u.return;try{sy(u)}catch($){Pt(u,M,$)}}}catch($){Pt(u,u.return,$)}if(u===a){he=null;break}var j=u.sibling;if(j!==null){j.return=u.return,he=j;break}he=u.return}}var lp=0,up=1,cp=2,hp=3,dp=4;if(typeof Symbol=="function"&&Symbol.for){var th=Symbol.for;lp=th("selector.component"),up=th("selector.has_pseudo_class"),cp=th("selector.role"),hp=th("selector.test_id"),dp=th("selector.text")}function uy(a){var u=mr(a);if(u!=null){if(typeof u.memoizedProps["data-testname"]!="string")throw Error(o(364));return u}if(a=Sf(a),a===null)throw Error(o(362));return a.stateNode.current}function cy(a,u){switch(u.$$typeof){case lp:if(a.type===u.value)return!0;break;case up:e:{u=u.value,a=[a,0];for(var f=0;f<a.length;){var g=a[f++],y=a[f++],T=u[y];if(g.tag!==5||!us(g)){for(;T!=null&&cy(g,T);)y++,T=u[y];if(y===u.length){u=!0;break e}else for(g=g.child;g!==null;)a.push(g,y),g=g.sibling}}u=!1}return u;case cp:if(a.tag===5&&Tf(a.stateNode,u.value))return!0;break;case dp:if((a.tag===5||a.tag===6)&&(a=Cc(a),a!==null&&0<=a.indexOf(u.value)))return!0;break;case hp:if(a.tag===5&&(a=a.memoizedProps["data-testname"],typeof a=="string"&&a.toLowerCase()===u.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function hy(a){switch(a.$$typeof){case lp:return"<"+(N(a.value)||"Unknown")+">";case up:return":has("+(hy(a)||"")+")";case cp:return'[role="'+a.value+'"]';case dp:return'"'+a.value+'"';case hp:return'[data-testname="'+a.value+'"]';default:throw Error(o(365))}}function g4(a,u){var f=[];a=[a,0];for(var g=0;g<a.length;){var y=a[g++],T=a[g++],M=u[T];if(y.tag!==5||!us(y)){for(;M!=null&&cy(y,M);)T++,M=u[T];if(T===u.length)f.push(y);else for(y=y.child;y!==null;)a.push(y,T),y=y.sibling}}return f}function dy(a,u){if(!ls)throw Error(o(363));a=uy(a),a=g4(a,u),u=[],a=Array.from(a);for(var f=0;f<a.length;){var g=a[f++];if(g.tag===5)us(g)||u.push(g.stateNode);else for(g=g.child;g!==null;)a.push(g),g=g.sibling}return u}var UA=Math.ceil,fp=l.ReactCurrentDispatcher,fy=l.ReactCurrentOwner,Bt=l.ReactCurrentBatchConfig,Le=0,mn=null,Kt=null,Dn=0,Mr=0,Yl=ci(0),sn=0,nh=null,xa=0,pp=0,py=0,rh=null,Sr=null,gy=0,my=1/0,Ss=null;function Xl(){my=$t()+500}var gp=!1,_y=null,fo=null,mp=!1,po=null,_p=0,ih=0,yy=null,yp=-1,vp=0;function Kn(){return Le&6?$t():yp!==-1?yp:yp=$t()}function go(a){return a.mode&1?Le&2&&Dn!==0?Dn&-Dn:ur.transition!==null?(vp===0&&(vp=Uf()),vp):(a=$e,a!==0?a:li()):1}function Yr(a,u,f,g){if(50<ih)throw ih=0,yy=null,Error(o(185));yr(a,f,g),(!(Le&2)||a!==mn)&&(a===mn&&(!(Le&2)&&(pp|=f),sn===4&&mo(a,Dn)),Tr(a,g),f===1&&Le===0&&!(u.mode&1)&&(Xl(),Bl&&or()))}function Tr(a,u){var f=a.callbackNode;D_(a,u);var g=Ca(a,a===mn?Dn:0);if(g===0)f!==null&&Bf(f),a.callbackNode=null,a.callbackPriority=0;else if(u=g&-g,a.callbackPriority!==u){if(f!=null&&Bf(f),u===1)a.tag===0?Wf(_4.bind(null,a)):Bc(_4.bind(null,a)),bi?Ef(function(){!(Le&6)&&or()}):Vc(Uc,or),f=null;else{switch(gs(g)){case 1:f=Uc;break;case 4:f=zl;break;case 16:f=lo;break;case 536870912:f=jf;break;default:f=lo}f=P4(f,m4.bind(null,a))}a.callbackPriority=u,a.callbackNode=f}}function m4(a,u){if(yp=-1,vp=0,Le&6)throw Error(o(327));var f=a.callbackNode;if(Oa()&&a.callbackNode!==f)return null;var g=Ca(a,a===mn?Dn:0);if(g===0)return null;if(g&30||g&a.expiredLanes||u)u=wp(a,g);else{u=g;var y=Le;Le|=2;var T=w4();(mn!==a||Dn!==u)&&(Ss=null,Xl(),Na(a,u));do try{jA();break}catch(j){v4(a,j)}while(!0);je(),fp.current=T,Le=y,Kt!==null?u=0:(mn=null,Dn=0,u=sn)}if(u!==0){if(u===2&&(y=Fc(a),y!==0&&(g=y,u=vy(a,y))),u===1)throw f=nh,Na(a,0),mo(a,g),Tr(a,$t()),f;if(u===6)mo(a,g);else{if(y=a.current.alternate,!(g&30)&&!zA(y)&&(u=wp(a,g),u===2&&(T=Fc(a),T!==0&&(g=T,u=vy(a,T))),u===1))throw f=nh,Na(a,0),mo(a,g),Tr(a,$t()),f;switch(a.finishedWork=y,a.finishedLanes=g,u){case 0:case 1:throw Error(o(345));case 2:Da(a,Sr,Ss);break;case 3:if(mo(a,g),(g&130023424)===g&&(u=gy+500-$t(),10<u)){if(Ca(a,0)!==0)break;if(y=a.suspendedLanes,(y&g)!==g){Kn(),a.pingedLanes|=a.suspendedLanes&y;break}a.timeoutHandle=B(Da.bind(null,a,Sr,Ss),u);break}Da(a,Sr,Ss);break;case 4:if(mo(a,g),(g&4194240)===g)break;for(u=a.eventTimes,y=-1;0<g;){var M=31-Bn(g);T=1<<M,M=u[M],M>y&&(y=M),g&=~T}if(g=y,g=$t()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*UA(g/1960))-g,10<g){a.timeoutHandle=B(Da.bind(null,a,Sr,Ss),g);break}Da(a,Sr,Ss);break;case 5:Da(a,Sr,Ss);break;default:throw Error(o(329))}}}return Tr(a,$t()),a.callbackNode===f?m4.bind(null,a):null}function vy(a,u){var f=rh;return a.current.memoizedState.isDehydrated&&(Na(a,u).flags|=256),a=wp(a,u),a!==2&&(u=Sr,Sr=f,u!==null&&wy(u)),a}function wy(a){Sr===null?Sr=a:Sr.push.apply(Sr,a)}function zA(a){for(var u=a;;){if(u.flags&16384){var f=u.updateQueue;if(f!==null&&(f=f.stores,f!==null))for(var g=0;g<f.length;g++){var y=f[g],T=y.getSnapshot;y=y.value;try{if(!Qe(T(),y))return!1}catch{return!1}}}if(f=u.child,u.subtreeFlags&16384&&f!==null)f.return=u,u=f;else{if(u===a)break;for(;u.sibling===null;){if(u.return===null||u.return===a)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function mo(a,u){for(u&=~py,u&=~pp,a.suspendedLanes|=u,a.pingedLanes&=~u,a=a.expirationTimes;0<u;){var f=31-Bn(u),g=1<<f;a[f]=-1,u&=~g}}function _4(a){if(Le&6)throw Error(o(327));Oa();var u=Ca(a,0);if(!(u&1))return Tr(a,$t()),null;var f=wp(a,u);if(a.tag!==0&&f===2){var g=Fc(a);g!==0&&(u=g,f=vy(a,g))}if(f===1)throw f=nh,Na(a,0),mo(a,u),Tr(a,$t()),f;if(f===6)throw Error(o(345));return a.finishedWork=a.current.alternate,a.finishedLanes=u,Da(a,Sr,Ss),Tr(a,$t()),null}function y4(a){po!==null&&po.tag===0&&!(Le&6)&&Oa();var u=Le;Le|=1;var f=Bt.transition,g=$e;try{if(Bt.transition=null,$e=1,a)return a()}finally{$e=g,Bt.transition=f,Le=u,!(Le&6)&&or()}}function Ey(){Mr=Yl.current,ht(Yl)}function Na(a,u){a.finishedWork=null,a.finishedLanes=0;var f=a.timeoutHandle;if(f!==_e&&(a.timeoutHandle=_e,Z(f)),Kt!==null)for(f=Kt.return;f!==null;){var g=f;switch(_s(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&Ea();break;case 3:ql(),ht(kn),ht(tn),U_();break;case 5:F_(g);break;case 4:ql();break;case 13:ht(xt);break;case 19:ht(xt);break;case 10:qt(g.type._context);break;case 22:case 23:Ey()}f=f.return}if(mn=a,Kt=a=_o(a.current,null),Dn=Mr=u,sn=0,nh=null,py=pp=xa=0,Sr=rh=null,pi!==null){for(u=0;u<pi.length;u++)if(f=pi[u],g=f.interleaved,g!==null){f.interleaved=null;var y=g.next,T=f.pending;if(T!==null){var M=T.next;T.next=y,g.next=M}f.pending=g}pi=null}return a}function v4(a,u){do{var f=Kt;try{if(je(),Yf.current=ep,Xf){for(var g=Nt.memoizedState;g!==null;){var y=g.queue;y!==null&&(y.pending=null),g=g.next}Xf=!1}if(Aa=0,gn=rn=Nt=null,qc=!1,Kc=0,fy.current=null,f===null||f.return===null){sn=1,nh=u,Kt=null;break}e:{var T=a,M=f.return,j=f,$=u;if(u=Dn,j.flags|=32768,$!==null&&typeof $=="object"&&typeof $.then=="function"){var te=$,ge=j,xe=ge.tag;if(!(ge.mode&1)&&(xe===0||xe===11||xe===15)){var le=ge.alternate;le?(ge.updateQueue=le.updateQueue,ge.memoizedState=le.memoizedState,ge.lanes=le.lanes):(ge.updateQueue=null,ge.memoizedState=null)}var St=WS(M);if(St!==null){St.flags&=-257,HS(St,M,j,T,u),St.mode&1&&GS(T,te,u),u=St,$=te;var mt=u.updateQueue;if(mt===null){var Cr=new Set;Cr.add($),u.updateQueue=Cr}else mt.add($);break e}else{if(!(u&1)){GS(T,te,u),Sy();break e}$=Error(o(426))}}else if(dt&&j.mode&1){var Ts=WS(M);if(Ts!==null){!(Ts.flags&65536)&&(Ts.flags|=256),HS(Ts,M,j,T,u),uo(Kl($,j));break e}}T=$=Kl($,j),sn!==4&&(sn=2),rh===null?rh=[T]:rh.push(T),T=M;do{switch(T.tag){case 3:T.flags|=65536,u&=-u,T.lanes|=u;var H=BS(T,$,u);pS(T,H);break e;case 1:j=$;var G=T.type,K=T.stateNode;if(!(T.flags&128)&&(typeof G.getDerivedStateFromError=="function"||K!==null&&typeof K.componentDidCatch=="function"&&(fo===null||!fo.has(K)))){T.flags|=65536,u&=-u,T.lanes|=u;var ce=jS(T,j,u);pS(T,ce);break e}}T=T.return}while(T!==null)}S4(f)}catch(ve){u=ve,Kt===f&&f!==null&&(Kt=f=f.return);continue}break}while(!0)}function w4(){var a=fp.current;return fp.current=ep,a===null?ep:a}function Sy(){(sn===0||sn===3||sn===2)&&(sn=4),mn===null||!(xa&268435455)&&!(pp&268435455)||mo(mn,Dn)}function wp(a,u){var f=Le;Le|=2;var g=w4();(mn!==a||Dn!==u)&&(Ss=null,Na(a,u));do try{BA();break}catch(y){v4(a,y)}while(!0);if(je(),Le=f,fp.current=g,Kt!==null)throw Error(o(261));return mn=null,Dn=0,sn}function BA(){for(;Kt!==null;)E4(Kt)}function jA(){for(;Kt!==null&&!O_();)E4(Kt)}function E4(a){var u=I4(a.alternate,a,Mr);a.memoizedProps=a.pendingProps,u===null?S4(a):Kt=u,fy.current=null}function S4(a){var u=a;do{var f=u.alternate;if(a=u.return,u.flags&32768){if(f=MA(f,u),f!==null){f.flags&=32767,Kt=f;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{sn=6,Kt=null;return}}else if(f=bA(f,u,Mr),f!==null){Kt=f;return}if(u=u.sibling,u!==null){Kt=u;return}Kt=u=a}while(u!==null);sn===0&&(sn=5)}function Da(a,u,f){var g=$e,y=Bt.transition;try{Bt.transition=null,$e=1,GA(a,u,f,g)}finally{Bt.transition=y,$e=g}return null}function GA(a,u,f,g){do Oa();while(po!==null);if(Le&6)throw Error(o(327));f=a.finishedWork;var y=a.finishedLanes;if(f===null)return null;if(a.finishedWork=null,a.finishedLanes=0,f===a.current)throw Error(o(177));a.callbackNode=null,a.callbackPriority=0;var T=f.lanes|f.childLanes;if(zf(a,T),a===mn&&(Kt=mn=null,Dn=0),!(f.subtreeFlags&2064)&&!(f.flags&2064)||mp||(mp=!0,P4(lo,function(){return Oa(),null})),T=(f.flags&15990)!==0,f.subtreeFlags&15990||T){T=Bt.transition,Bt.transition=null;var M=$e;$e=1;var j=Le;Le|=4,fy.current=null,FA(a,f),c4(f,a),ne(a.containerInfo),a.current=f,VA(f),zi(),Le=j,$e=M,Bt.transition=T}else a.current=f;if(mp&&(mp=!1,po=a,_p=y),T=a.pendingLanes,T===0&&(fo=null),Gf(f.stateNode),Tr(a,$t()),u!==null)for(g=a.onRecoverableError,f=0;f<u.length;f++)y=u[f],g(y.value,{componentStack:y.stack,digest:y.digest});if(gp)throw gp=!1,a=_y,_y=null,a;return _p&1&&a.tag!==0&&Oa(),T=a.pendingLanes,T&1?a===yy?ih++:(ih=0,yy=a):ih=0,or(),null}function Oa(){if(po!==null){var a=gs(_p),u=Bt.transition,f=$e;try{if(Bt.transition=null,$e=16>a?16:a,po===null)var g=!1;else{if(a=po,po=null,_p=0,Le&6)throw Error(o(331));var y=Le;for(Le|=4,he=a.current;he!==null;){var T=he,M=T.child;if(he.flags&16){var j=T.deletions;if(j!==null){for(var $=0;$<j.length;$++){var te=j[$];for(he=te;he!==null;){var ge=he;switch(ge.tag){case 0:case 11:case 15:eh(8,ge,T)}var xe=ge.child;if(xe!==null)xe.return=ge,he=xe;else for(;he!==null;){ge=he;var le=ge.sibling,St=ge.return;if(o4(ge),ge===te){he=null;break}if(le!==null){le.return=St,he=le;break}he=St}}}var mt=T.alternate;if(mt!==null){var Cr=mt.child;if(Cr!==null){mt.child=null;do{var Ts=Cr.sibling;Cr.sibling=null,Cr=Ts}while(Cr!==null)}}he=T}}if(T.subtreeFlags&2064&&M!==null)M.return=T,he=M;else e:for(;he!==null;){if(T=he,T.flags&2048)switch(T.tag){case 0:case 11:case 15:eh(9,T,T.return)}var H=T.sibling;if(H!==null){H.return=T.return,he=H;break e}he=T.return}}var G=a.current;for(he=G;he!==null;){M=he;var K=M.child;if(M.subtreeFlags&2064&&K!==null)K.return=M,he=K;else e:for(M=G;he!==null;){if(j=he,j.flags&2048)try{switch(j.tag){case 0:case 11:case 15:ap(9,j)}}catch(ve){Pt(j,j.return,ve)}if(j===M){he=null;break e}var ce=j.sibling;if(ce!==null){ce.return=j.return,he=ce;break e}he=j.return}}if(Le=y,or(),jn&&typeof jn.onPostCommitFiberRoot=="function")try{jn.onPostCommitFiberRoot(Bi,a)}catch{}g=!0}return g}finally{$e=f,Bt.transition=u}}return!1}function T4(a,u,f){u=Kl(f,u),u=BS(a,u,1),a=ho(a,u,1),u=Kn(),a!==null&&(yr(a,1,u),Tr(a,u))}function Pt(a,u,f){if(a.tag===3)T4(a,a,f);else for(;u!==null;){if(u.tag===3){T4(u,a,f);break}else if(u.tag===1){var g=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(fo===null||!fo.has(g))){a=Kl(f,a),a=jS(u,a,1),u=ho(u,a,1),a=Kn(),u!==null&&(yr(u,1,a),Tr(u,a));break}}u=u.return}}function WA(a,u,f){var g=a.pingCache;g!==null&&g.delete(u),u=Kn(),a.pingedLanes|=a.suspendedLanes&f,mn===a&&(Dn&f)===f&&(sn===4||sn===3&&(Dn&130023424)===Dn&&500>$t()-gy?Na(a,0):py|=f),Tr(a,u)}function C4(a,u){u===0&&(a.mode&1?(u=Ui,Ui<<=1,!(Ui&130023424)&&(Ui=4194304)):u=1);var f=Kn();a=Gi(a,u),a!==null&&(yr(a,u,f),Tr(a,f))}function HA(a){var u=a.memoizedState,f=0;u!==null&&(f=u.retryLane),C4(a,f)}function $A(a,u){var f=0;switch(a.tag){case 13:var g=a.stateNode,y=a.memoizedState;y!==null&&(f=y.retryLane);break;case 19:g=a.stateNode;break;default:throw Error(o(314))}g!==null&&g.delete(u),C4(a,f)}var I4;I4=function(a,u,f){if(a!==null)if(a.memoizedProps!==u.pendingProps||kn.current)Er=!0;else{if(!(a.lanes&f)&&!(u.flags&128))return Er=!1,OA(a,u,f);Er=!!(a.flags&131072)}else Er=!1,dt&&u.flags&1048576&&Hf(u,Gl,u.index);switch(u.lanes=0,u.tag){case 2:var g=u.type;rp(a,u),a=u.pendingProps;var y=ao(u,tn.current);pn(u,f),y=j_(null,u,g,a,y,f);var T=G_();return u.flags|=1,typeof y=="object"&&y!==null&&typeof y.render=="function"&&y.$$typeof===void 0?(u.tag=1,u.memoizedState=null,u.updateQueue=null,An(g)?(T=!0,_r(u)):T=!1,u.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,M_(u),y.updater=tp,u.stateNode=y,y._reactInternals=u,Q_(u,g,a,f),u=Z_(null,u,g,!0,T,f)):(u.tag=0,dt&&T&&Wl(u),cr(null,u,y,f),u=u.child),u;case 16:g=u.elementType;e:{switch(rp(a,u),a=u.pendingProps,y=g._init,g=y(g._payload),u.type=g,y=u.tag=KA(g),a=gi(g,a),y){case 0:u=J_(null,u,g,a,f);break e;case 1:u=XS(null,u,g,a,f);break e;case 11:u=$S(null,u,g,a,f);break e;case 14:u=qS(null,u,g,gi(g.type,a),f);break e}throw Error(o(306,g,""))}return u;case 0:return g=u.type,y=u.pendingProps,y=u.elementType===g?y:gi(g,y),J_(a,u,g,y,f);case 1:return g=u.type,y=u.pendingProps,y=u.elementType===g?y:gi(g,y),XS(a,u,g,y,f);case 3:e:{if(JS(u),a===null)throw Error(o(387));g=u.pendingProps,T=u.memoizedState,y=T.element,fS(a,u),Kf(u,g,null,f);var M=u.memoizedState;if(g=M.element,lt&&T.isDehydrated)if(T={element:g,isDehydrated:!1,cache:M.cache,pendingSuspenseBoundaries:M.pendingSuspenseBoundaries,transitions:M.transitions},u.updateQueue.baseState=T,u.memoizedState=T,u.flags&256){y=Kl(Error(o(423)),u),u=ZS(a,u,g,f,y);break e}else if(g!==y){y=Kl(Error(o(424)),u),u=ZS(a,u,g,f,y);break e}else for(lt&&(lr=bl(u.stateNode.containerInfo),Wn=u,dt=!0,wr=null,ys=!1),f=W(u,null,g,f),u.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(vs(),g===y){u=Es(a,u,f);break e}cr(a,u,g,f)}u=u.child}return u;case 5:return mS(u),a===null&&fi(u),g=u.type,y=u.pendingProps,T=a!==null?a.memoizedProps:null,M=y.children,At(g,y)?M=null:T!==null&&At(g,T)&&(u.flags|=32),YS(a,u),cr(a,u,M,f),u.child;case 6:return a===null&&fi(u),null;case 13:return e4(a,u,f);case 4:return L_(u,u.stateNode.containerInfo),g=u.pendingProps,a===null?u.child=b(u,null,g,f):cr(a,u,g,f),u.child;case 11:return g=u.type,y=u.pendingProps,y=u.elementType===g?y:gi(g,y),$S(a,u,g,y,f);case 7:return cr(a,u,u.pendingProps,f),u.child;case 8:return cr(a,u,u.pendingProps.children,f),u.child;case 12:return cr(a,u,u.pendingProps.children,f),u.child;case 10:e:{if(g=u.type._context,y=u.pendingProps,T=u.memoizedProps,M=y.value,nn(u,g,M),T!==null)if(Qe(T.value,M)){if(T.children===y.children&&!kn.current){u=Es(a,u,f);break e}}else for(T=u.child,T!==null&&(T.return=u);T!==null;){var j=T.dependencies;if(j!==null){M=T.child;for(var $=j.firstContext;$!==null;){if($.context===g){if(T.tag===1){$=ws(-1,f&-f),$.tag=2;var te=T.updateQueue;if(te!==null){te=te.shared;var ge=te.pending;ge===null?$.next=$:($.next=ge.next,ge.next=$),te.pending=$}}T.lanes|=f,$=T.alternate,$!==null&&($.lanes|=f),ji(T.return,f,u),j.lanes|=f;break}$=$.next}}else if(T.tag===10)M=T.type===u.type?null:T.child;else if(T.tag===18){if(M=T.return,M===null)throw Error(o(341));M.lanes|=f,j=M.alternate,j!==null&&(j.lanes|=f),ji(M,f,u),M=T.sibling}else M=T.child;if(M!==null)M.return=T;else for(M=T;M!==null;){if(M===u){M=null;break}if(T=M.sibling,T!==null){T.return=M.return,M=T;break}M=M.return}T=M}cr(a,u,y.children,f),u=u.child}return u;case 9:return y=u.type,g=u.pendingProps.children,pn(u,f),y=xn(y),g=g(y),u.flags|=1,cr(a,u,g,f),u.child;case 14:return g=u.type,y=gi(g,u.pendingProps),y=gi(g.type,y),qS(a,u,g,y,f);case 15:return KS(a,u,u.type,u.pendingProps,f);case 17:return g=u.type,y=u.pendingProps,y=u.elementType===g?y:gi(g,y),rp(a,u),u.tag=1,An(g)?(a=!0,_r(u)):a=!1,pn(u,f),US(u,g,y),Q_(u,g,y,f),Z_(null,u,g,!0,a,f);case 19:return n4(a,u,f);case 22:return QS(a,u,f)}throw Error(o(156,u.tag))};function P4(a,u){return Vc(a,u)}function qA(a,u,f,g){this.tag=a,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xr(a,u,f,g){return new qA(a,u,f,g)}function Ty(a){return a=a.prototype,!(!a||!a.isReactComponent)}function KA(a){if(typeof a=="function")return Ty(a)?1:0;if(a!=null){if(a=a.$$typeof,a===A)return 11;if(a===R)return 14}return 2}function _o(a,u){var f=a.alternate;return f===null?(f=Xr(a.tag,u,a.key,a.mode),f.elementType=a.elementType,f.type=a.type,f.stateNode=a.stateNode,f.alternate=a,a.alternate=f):(f.pendingProps=u,f.type=a.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=a.flags&14680064,f.childLanes=a.childLanes,f.lanes=a.lanes,f.child=a.child,f.memoizedProps=a.memoizedProps,f.memoizedState=a.memoizedState,f.updateQueue=a.updateQueue,u=a.dependencies,f.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},f.sibling=a.sibling,f.index=a.index,f.ref=a.ref,f}function Ep(a,u,f,g,y,T){var M=2;if(g=a,typeof a=="function")Ty(a)&&(M=1);else if(typeof a=="string")M=5;else e:switch(a){case p:return ba(f.children,y,T,u);case _:M=8,y|=8;break;case m:return a=Xr(12,f,u,y|2),a.elementType=m,a.lanes=T,a;case D:return a=Xr(13,f,u,y),a.elementType=D,a.lanes=T,a;case k:return a=Xr(19,f,u,y),a.elementType=k,a.lanes=T,a;case P:return Sp(f,y,T,u);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case S:M=10;break e;case E:M=9;break e;case A:M=11;break e;case R:M=14;break e;case w:M=16,g=null;break e}throw Error(o(130,a==null?a:typeof a,""))}return u=Xr(M,f,u,y),u.elementType=a,u.type=g,u.lanes=T,u}function ba(a,u,f,g){return a=Xr(7,a,g,u),a.lanes=f,a}function Sp(a,u,f,g){return a=Xr(22,a,g,u),a.elementType=P,a.lanes=f,a.stateNode={isHidden:!1},a}function Cy(a,u,f){return a=Xr(6,a,null,u),a.lanes=f,a}function Iy(a,u,f){return u=Xr(4,a.children!==null?a.children:[],a.key,u),u.lanes=f,u.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},u}function QA(a,u,f,g,y){this.tag=u,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=_e,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ps(0),this.expirationTimes=ps(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ps(0),this.identifierPrefix=g,this.onRecoverableError=y,lt&&(this.mutableSourceEagerHydrationData=null)}function R4(a,u,f,g,y,T,M,j,$){return a=new QA(a,u,f,j,$),u===1?(u=1,T===!0&&(u|=8)):u=0,T=Xr(3,null,null,u),a.current=T,T.stateNode=a,T.memoizedState={element:g,isDehydrated:f,cache:null,transitions:null,pendingSuspenseBoundaries:null},M_(T),a}function k4(a){if(!a)return Wr;a=a._reactInternals;e:{if(O(a)!==a||a.tag!==1)throw Error(o(170));var u=a;do{switch(u.tag){case 3:u=u.stateNode.context;break e;case 1:if(An(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break e}}u=u.return}while(u!==null);throw Error(o(171))}if(a.tag===1){var f=a.type;if(An(f))return Fi(a,f,u)}return u}function A4(a){var u=a._reactInternals;if(u===void 0)throw typeof a.render=="function"?Error(o(188)):(a=Object.keys(a).join(","),Error(o(268,a)));return a=z(u),a===null?null:a.stateNode}function x4(a,u){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var f=a.retryLane;a.retryLane=f!==0&&f<u?f:u}}function Tp(a,u){x4(a,u),(a=a.alternate)&&x4(a,u)}function YA(a){return a=z(a),a===null?null:a.stateNode}function XA(){return null}return t.attemptContinuousHydration=function(a){if(a.tag===13){var u=Gi(a,134217728);if(u!==null){var f=Kn();Yr(u,a,134217728,f)}Tp(a,134217728)}},t.attemptDiscreteHydration=function(a){if(a.tag===13){var u=Gi(a,1);if(u!==null){var f=Kn();Yr(u,a,1,f)}Tp(a,1)}},t.attemptHydrationAtCurrentPriority=function(a){if(a.tag===13){var u=go(a),f=Gi(a,u);if(f!==null){var g=Kn();Yr(f,a,u,g)}Tp(a,u)}},t.attemptSynchronousHydration=function(a){switch(a.tag){case 3:var u=a.stateNode;if(u.current.memoizedState.isDehydrated){var f=Ta(u.pendingLanes);f!==0&&(Ul(u,f|1),Tr(u,$t()),!(Le&6)&&(Xl(),or()))}break;case 13:y4(function(){var g=Gi(a,1);if(g!==null){var y=Kn();Yr(g,a,1,y)}}),Tp(a,1)}},t.batchedUpdates=function(a,u){var f=Le;Le|=1;try{return a(u)}finally{Le=f,Le===0&&(Xl(),Bl&&or())}},t.createComponentSelector=function(a){return{$$typeof:lp,value:a}},t.createContainer=function(a,u,f,g,y,T,M){return R4(a,u,!1,null,f,g,y,T,M)},t.createHasPseudoClassSelector=function(a){return{$$typeof:up,value:a}},t.createHydrationContainer=function(a,u,f,g,y,T,M,j,$){return a=R4(f,g,!0,a,y,T,M,j,$),a.context=k4(null),f=a.current,g=Kn(),y=go(f),T=ws(g,y),T.callback=u??null,ho(f,T,y),a.current.lanes=y,yr(a,y,g),Tr(a,g),a},t.createPortal=function(a,u,f){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:d,key:g==null?null:""+g,children:a,containerInfo:u,implementation:f}},t.createRoleSelector=function(a){return{$$typeof:cp,value:a}},t.createTestNameSelector=function(a){return{$$typeof:hp,value:a}},t.createTextSelector=function(a){return{$$typeof:dp,value:a}},t.deferredUpdates=function(a){var u=$e,f=Bt.transition;try{return Bt.transition=null,$e=16,a()}finally{$e=u,Bt.transition=f}},t.discreteUpdates=function(a,u,f,g,y){var T=$e,M=Bt.transition;try{return Bt.transition=null,$e=1,a(u,f,g,y)}finally{$e=T,Bt.transition=M,Le===0&&Xl()}},t.findAllNodes=dy,t.findBoundingRects=function(a,u){if(!ls)throw Error(o(363));u=dy(a,u),a=[];for(var f=0;f<u.length;f++)a.push(I_(u[f]));for(u=a.length-1;0<u;u--){f=a[u];for(var g=f.x,y=g+f.width,T=f.y,M=T+f.height,j=u-1;0<=j;j--)if(u!==j){var $=a[j],te=$.x,ge=te+$.width,xe=$.y,le=xe+$.height;if(g>=te&&T>=xe&&y<=ge&&M<=le){a.splice(u,1);break}else if(g!==te||f.width!==$.width||le<T||xe>M){if(!(T!==xe||f.height!==$.height||ge<g||te>y)){te>g&&($.width+=te-g,$.x=g),ge<y&&($.width=y-te),a.splice(u,1);break}}else{xe>T&&($.height+=xe-T,$.y=T),le<M&&($.height=M-xe),a.splice(u,1);break}}}return a},t.findHostInstance=A4,t.findHostInstanceWithNoPortals=function(a){return a=L(a),a=a!==null?fe(a):null,a===null?null:a.stateNode},t.findHostInstanceWithWarning=function(a){return A4(a)},t.flushControlled=function(a){var u=Le;Le|=1;var f=Bt.transition,g=$e;try{Bt.transition=null,$e=1,a()}finally{$e=g,Bt.transition=f,Le=u,Le===0&&(Xl(),or())}},t.flushPassiveEffects=Oa,t.flushSync=y4,t.focusWithin=function(a,u){if(!ls)throw Error(o(363));for(a=uy(a),u=g4(a,u),u=Array.from(u),a=0;a<u.length;){var f=u[a++];if(!us(f)){if(f.tag===5&&dn(f.stateNode))return!0;for(f=f.child;f!==null;)u.push(f),f=f.sibling}}return!1},t.getCurrentUpdatePriority=function(){return $e},t.getFindAllNodesFailureDescription=function(a,u){if(!ls)throw Error(o(363));var f=0,g=[];a=[uy(a),0];for(var y=0;y<a.length;){var T=a[y++],M=a[y++],j=u[M];if((T.tag!==5||!us(T))&&(cy(T,j)&&(g.push(hy(j)),M++,M>f&&(f=M)),M<u.length))for(T=T.child;T!==null;)a.push(T,M),T=T.sibling}if(f<u.length){for(a=[];f<u.length;f++)a.push(hy(u[f]));return`findAllNodes was able to match part of the selector:
  `+(g.join(" > ")+`

No matching component was found for:
  `)+a.join(" > ")}return null},t.getPublicRootInstance=function(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return ze(a.child.stateNode);default:return a.child.stateNode}},t.injectIntoDevTools=function(a){if(a={bundleType:a.bundleType,version:a.version,rendererPackageName:a.rendererPackageName,rendererConfig:a.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:l.ReactCurrentDispatcher,findHostInstanceByFiber:YA,findFiberByHostInstance:a.findFiberByHostInstance||XA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")a=!1;else{var u=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(u.isDisabled||!u.supportsFiber)a=!0;else{try{Bi=u.inject(a),jn=u}catch{}a=!!u.checkDCE}}return a},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(a,u,f,g){if(!ls)throw Error(o(363));a=dy(a,u);var y=Pn(a,f,g).disconnect;return{disconnect:function(){y()}}},t.registerMutableSourceForHydration=function(a,u){var f=u._getVersion;f=f(u._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[u,f]:a.mutableSourceEagerHydrationData.push(u,f)},t.runWithPriority=function(a,u){var f=$e;try{return $e=a,u()}finally{$e=f}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(a,u,f,g){var y=u.current,T=Kn(),M=go(y);return f=k4(f),u.context===null?u.context=f:u.pendingContext=f,u=ws(T,M),u.payload={element:a},g=g===void 0?null:g,g!==null&&(u.callback=g),a=ho(y,u,M),a!==null&&(Yr(a,y,M,T),qf(a,y,M)),M},t};lA.exports=WW;var HW=lA.exports;const $W=Om(HW);var uA={exports:{}},Al={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Al.ConcurrentRoot=1;Al.ContinuousEventPriority=4;Al.DefaultEventPriority=16;Al.DiscreteEventPriority=1;Al.IdleEventPriority=536870912;Al.LegacyRoot=0;uA.exports=Al;var cA=uA.exports;const _5={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let y5=!1,v5=!1;const uS=".react-konva-event",qW=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,KW=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,QW={};function T_(n,e,t=QW){if(!y5&&"zIndex"in e&&(console.warn(KW),y5=!0),!v5&&e.draggable){var r=e.x!==void 0||e.y!==void 0,i=e.onDragEnd||e.onDragMove;r&&!i&&(console.warn(qW),v5=!0)}for(var s in t)if(!_5[s]){var o=s.slice(0,2)==="on",l=t[s]!==e[s];if(o&&l){var c=s.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),n.off(c,t[s])}var d=!e.hasOwnProperty(s);d&&n.setAttr(s,void 0)}var p=e._useStrictMode,_={},m=!1;const S={};for(var s in e)if(!_5[s]){var o=s.slice(0,2)==="on",E=t[s]!==e[s];if(o&&E){var c=s.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),e[s]&&(S[c]=e[s])}!o&&(e[s]!==t[s]||p&&e[s]!==n.getAttr(s))&&(m=!0,_[s]=e[s])}m&&(n.setAttrs(_),_a(n));for(var c in S)n.on(c+uS,S[c])}function _a(n){if(!be.Konva.autoDrawEnabled){var e=n.getLayer()||n.getStage();e&&e.batchDraw()}}const hA={},YW={};Ud.Node.prototype._applyProps=T_;function XW(n,e){if(typeof e=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${e}`);return}n.add(e),_a(n)}function JW(n,e,t){let r=Ud[n];r||(console.error(`Konva has no node with the type ${n}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${n}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),r=Ud.Group);const i={},s={};for(var o in e){var l=o.slice(0,2)==="on";l?s[o]=e[o]:i[o]=e[o]}const c=new r(i);return T_(c,s),c}function ZW(n,e,t){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${n}"`)}function eH(n,e,t){return!1}function tH(n){return n}function nH(){return null}function rH(){return null}function iH(n,e,t,r){return YW}function sH(){}function oH(n){}function aH(n,e){return!1}function lH(){return hA}function uH(){return hA}const cH=setTimeout,hH=clearTimeout,dH=-1;function fH(n,e){return!1}const pH=!1,gH=!0,mH=!0;function _H(n,e){e.parent===n?e.moveToTop():n.add(e),_a(n)}function yH(n,e){e.parent===n?e.moveToTop():n.add(e),_a(n)}function dA(n,e,t){e._remove(),n.add(e),e.setZIndex(t.getZIndex()),_a(n)}function vH(n,e,t){dA(n,e,t)}function wH(n,e){e.destroy(),e.off(uS),_a(n)}function EH(n,e){e.destroy(),e.off(uS),_a(n)}function SH(n,e,t){console.error(`Text components are not yet supported in ReactKonva. You text is: "${t}"`)}function TH(n,e,t){}function CH(n,e,t,r,i){T_(n,i,r)}function IH(n){n.hide(),_a(n)}function PH(n){}function RH(n,e){(e.visible==null||e.visible)&&n.show()}function kH(n,e){}function AH(n){}function xH(){}const NH=()=>cA.DefaultEventPriority,DH=Object.freeze(Object.defineProperty({__proto__:null,appendChild:_H,appendChildToContainer:yH,appendInitialChild:XW,cancelTimeout:hH,clearContainer:AH,commitMount:TH,commitTextUpdate:SH,commitUpdate:CH,createInstance:JW,createTextInstance:ZW,detachDeletedInstance:xH,finalizeInitialChildren:eH,getChildHostContext:uH,getCurrentEventPriority:NH,getPublicInstance:tH,getRootHostContext:lH,hideInstance:IH,hideTextInstance:PH,idlePriority:Oh.unstable_IdlePriority,insertBefore:dA,insertInContainerBefore:vH,isPrimaryRenderer:pH,noTimeout:dH,now:Oh.unstable_now,prepareForCommit:nH,preparePortalMount:rH,prepareUpdate:iH,removeChild:wH,removeChildFromContainer:EH,resetAfterCommit:sH,resetTextContent:oH,run:Oh.unstable_runWithPriority,scheduleTimeout:cH,shouldDeprioritizeSubtree:aH,shouldSetTextContent:fH,supportsMutation:mH,unhideInstance:RH,unhideTextInstance:kH,warnsIfNotActing:gH},Symbol.toStringTag,{value:"Module"}));var OH=Object.defineProperty,bH=Object.defineProperties,MH=Object.getOwnPropertyDescriptors,w5=Object.getOwnPropertySymbols,LH=Object.prototype.hasOwnProperty,FH=Object.prototype.propertyIsEnumerable,E5=(n,e,t)=>e in n?OH(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,S5=(n,e)=>{for(var t in e||(e={}))LH.call(e,t)&&E5(n,t,e[t]);if(w5)for(var t of w5(e))FH.call(e,t)&&E5(n,t,e[t]);return n},VH=(n,e)=>bH(n,MH(e)),T5,C5;typeof window<"u"&&((T5=window.document)!=null&&T5.createElement||((C5=window.navigator)==null?void 0:C5.product)==="ReactNative")?Ee.useLayoutEffect:Ee.useEffect;function fA(n,e,t){if(!n)return;if(t(n)===!0)return n;let r=n.child;for(;r;){const i=fA(r,e,t);if(i)return i;r=r.sibling}}function pA(n){try{return Object.defineProperties(n,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return n}}const I5=console.error;console.error=function(){const n=[...arguments].join("");if(n!=null&&n.startsWith("Warning:")&&n.includes("useContext")){console.error=I5;return}return I5.apply(this,arguments)};const cS=pA(Ee.createContext(null));class gA extends Ee.Component{render(){return Ee.createElement(cS.Provider,{value:this._reactInternals},this.props.children)}}function UH(){const n=Ee.useContext(cS);if(n===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=Ee.useId();return Ee.useMemo(()=>{for(const r of[n,n==null?void 0:n.alternate]){if(!r)continue;const i=fA(r,!1,s=>{let o=s.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(i)return i}},[n,e])}function zH(){const n=UH(),[e]=Ee.useState(()=>new Map);e.clear();let t=n;for(;t;){if(t.type&&typeof t.type=="object"){const i=t.type._context===void 0&&t.type.Provider===t.type?t.type:t.type._context;i&&i!==cS&&!e.has(i)&&e.set(i,Ee.useContext(pA(i)))}t=t.return}return e}function BH(){const n=zH();return Ee.useMemo(()=>Array.from(n.keys()).reduce((e,t)=>r=>Ee.createElement(e,null,Ee.createElement(t.Provider,VH(S5({},r),{value:n.get(t)}))),e=>Ee.createElement(gA,S5({},e))),[n])}function jH(n){const e=wn.useRef({});return wn.useLayoutEffect(()=>{e.current=n}),wn.useLayoutEffect(()=>()=>{e.current={}},[]),e.current}const GH=n=>{const e=wn.useRef(null),t=wn.useRef(null),r=wn.useRef(null),i=jH(n),s=BH(),o=l=>{const{forwardedRef:c}=n;c&&(typeof c=="function"?c(l):c.current=l)};return wn.useLayoutEffect(()=>(t.current=new Ud.Stage({width:n.width,height:n.height,container:e.current}),o(t.current),r.current=Dh.createContainer(t.current,cA.LegacyRoot,!1,null),Dh.updateContainer(wn.createElement(s,{},n.children),r.current),()=>{Ud.isBrowser&&(o(null),Dh.updateContainer(null,r.current,null),t.current.destroy())}),[]),wn.useLayoutEffect(()=>{o(t.current),T_(t.current,n,i),Dh.updateContainer(wn.createElement(s,{},n.children),r.current,null)}),wn.createElement("div",{ref:e,id:n.id,accessKey:n.accessKey,className:n.className,role:n.role,style:n.style,tabIndex:n.tabIndex,title:n.title})},zd="Layer",Bd="Rect",P5="Line",R5="Text",Dh=$W(DH);Dh.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:wn.version,rendererPackageName:"react-konva"});const WH=wn.forwardRef((n,e)=>wn.createElement(gA,{},wn.createElement(GH,{...n,forwardedRef:e}))),HH={},k5=n=>{let e;const t=new Set,r=(p,_)=>{const m=typeof p=="function"?p(e):p;if(!Object.is(m,e)){const S=e;e=_??(typeof m!="object"||m===null)?m:Object.assign({},e,m),t.forEach(E=>E(e,S))}},i=()=>e,c={setState:r,getState:i,getInitialState:()=>d,subscribe:p=>(t.add(p),()=>t.delete(p)),destroy:()=>{(HH?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},d=e=n(r,i,c);return c},$H=n=>n?k5(n):k5;var mA={exports:{}},_A={},yA={exports:{}},vA={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rc=Ee;function qH(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var KH=typeof Object.is=="function"?Object.is:qH,QH=rc.useState,YH=rc.useEffect,XH=rc.useLayoutEffect,JH=rc.useDebugValue;function ZH(n,e){var t=e(),r=QH({inst:{value:t,getSnapshot:e}}),i=r[0].inst,s=r[1];return XH(function(){i.value=t,i.getSnapshot=e,Pv(i)&&s({inst:i})},[n,t,e]),YH(function(){return Pv(i)&&s({inst:i}),n(function(){Pv(i)&&s({inst:i})})},[n]),JH(t),t}function Pv(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!KH(n,t)}catch{return!0}}function e$(n,e){return e()}var t$=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?e$:ZH;vA.useSyncExternalStore=rc.useSyncExternalStore!==void 0?rc.useSyncExternalStore:t$;yA.exports=vA;var n$=yA.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C_=Ee,r$=n$;function i$(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var s$=typeof Object.is=="function"?Object.is:i$,o$=r$.useSyncExternalStore,a$=C_.useRef,l$=C_.useEffect,u$=C_.useMemo,c$=C_.useDebugValue;_A.useSyncExternalStoreWithSelector=function(n,e,t,r,i){var s=a$(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=u$(function(){function c(S){if(!d){if(d=!0,p=S,S=r(S),i!==void 0&&o.hasValue){var E=o.value;if(i(E,S))return _=E}return _=S}if(E=_,s$(p,S))return E;var A=r(S);return i!==void 0&&i(E,A)?(p=S,E):(p=S,_=A)}var d=!1,p,_,m=t===void 0?null:t;return[function(){return c(e())},m===null?void 0:function(){return c(m())}]},[e,t,r,i]);var l=o$(n,s[0],s[1]);return l$(function(){o.hasValue=!0,o.value=l},[l]),c$(l),l};mA.exports=_A;var h$=mA.exports;const d$=Om(h$),wA={},{useDebugValue:f$}=wn,{useSyncExternalStoreWithSelector:p$}=d$;let A5=!1;const g$=n=>n;function m$(n,e=g$,t){(wA?"production":void 0)!=="production"&&t&&!A5&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),A5=!0);const r=p$(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return f$(r),r}const x5=n=>{(wA?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?$H(n):n,t=(r,i)=>m$(e,r,i);return Object.assign(t,e),t},EA=n=>n?x5(n):x5,N5={x:0,y:0,scale:1},wf=EA((n,e)=>({shapes:[],selectedShapeId:null,viewport:N5,addShape:t=>n(r=>({shapes:[...r.shapes,t]})),updateShape:(t,r)=>n(i=>({shapes:i.shapes.map(s=>s.id===t?{...s,...r}:s)})),deleteShape:t=>n(r=>({shapes:r.shapes.filter(i=>i.id!==t),selectedShapeId:r.selectedShapeId===t?null:r.selectedShapeId})),setShapes:t=>n({shapes:t}),selectShape:t=>n({selectedShapeId:t}),getSelectedShape:()=>{const{shapes:t,selectedShapeId:r}=e();return r&&t.find(i=>i.id===r)||null},setViewport:t=>n(r=>({viewport:{...r.viewport,...t}})),resetViewport:()=>n({viewport:N5})})),_$=n=>{const e=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD","#98D8C8","#F7DC6F"];let t=0;for(let r=0;r<n.length;r++)t=n.charCodeAt(r)+((t<<5)-t);return e[Math.abs(t)%e.length]},jd=EA(n=>({user:null,firebaseUser:null,isAuthenticated:!1,isLoading:!0,error:null,setUser:(e,t)=>n({user:e,firebaseUser:t,isAuthenticated:!!e,error:null}),setLoading:e=>n({isLoading:e}),setError:e=>n({error:e,isLoading:!1}),clearUser:()=>n({user:null,firebaseUser:null,isAuthenticated:!1,isLoading:!1})})),y$=n=>{var t;const e=n.displayName||((t=n.email)==null?void 0:t.split("@")[0])||"Anonymous User";return{uid:n.uid,displayName:e.length>20?e.substring(0,20):e,email:n.email||"",cursorColor:_$(n.uid)}};var On=[];for(var Rv=0;Rv<256;++Rv)On.push((Rv+256).toString(16).slice(1));function v$(n,e=0){return(On[n[e+0]]+On[n[e+1]]+On[n[e+2]]+On[n[e+3]]+"-"+On[n[e+4]]+On[n[e+5]]+"-"+On[n[e+6]]+On[n[e+7]]+"-"+On[n[e+8]]+On[n[e+9]]+"-"+On[n[e+10]]+On[n[e+11]]+On[n[e+12]]+On[n[e+13]]+On[n[e+14]]+On[n[e+15]]).toLowerCase()}var Zp,w$=new Uint8Array(16);function E$(){if(!Zp&&(Zp=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Zp))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Zp(w$)}var S$=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const D5={randomUUID:S$};function T$(n,e,t){if(D5.randomUUID&&!n)return D5.randomUUID();n=n||{};var r=n.random||(n.rng||E$)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,v$(r)}const hS="canvas/global-canvas-v1/shapes",C$=async(n,e,t,r)=>{try{const i=T$(),s=af(Or,hS),o={type:"rectangle",x:n,y:e,width:100,height:100,fill:"#CCCCCC",text:"",textColor:"#000000",fontSize:14,createdBy:t,createdAt:Qu(),lastModifiedBy:t,lastModifiedAt:Qu(),isLocked:!1,lockedBy:null};return await mF(yl(s,i),o),console.log(`🎯 Shape created by ${r}:`,i),i}catch(i){throw console.error("Error creating shape:",i),i}},I$=(n,e)=>{try{const t=af(Or,hS),r=uR(t,fF("createdAt","asc"));return yF(r,s=>{const o=[];s.forEach(l=>{l.exists()&&o.push({id:l.id,...l.data()})}),console.log(`🔄 Shapes synced: ${o.length} total`),n(o)},s=>{console.error("Error subscribing to shapes:",s),e==null||e(s)})}catch(t){throw console.error("Error setting up shapes subscription:",t),t}},P$=async(n,e,t)=>{try{const r=yl(Or,hS,n);await pR(r,{...e,lastModifiedBy:t,lastModifiedAt:Qu()}),console.log("📝 Shape updated:",n)}catch(r){throw console.error("Error updating shape:",r),r}},R$=()=>{const{setShapes:n}=wf();Ee.useEffect(()=>{console.log("🔄 Setting up shape sync...");const e=I$(t=>{n(t),console.log(`📦 Loaded ${t.length} shapes from Firestore:`),t.forEach(r=>{console.log(`   Shape ${r.id}: (${r.x}, ${r.y}) locked: ${r.isLocked}`)})},t=>{console.error("❌ Shape sync error:",t)});return()=>{console.log("🔄 Cleaning up shape sync..."),e==null||e()}},[n])},Dm="canvas/global-canvas-v1/shapes",k$=async(n,e,t)=>{try{const r=yl(Or,Dm,n);return await dE(Or,async s=>{const o=await s.get(r);if(!o.exists())throw new Error("Shape not found");const l=o.data();return l.isLocked&&l.lockedBy!==e?{success:!1,alreadyLocked:!0,lockedBy:l.lockedBy}:(s.update(r,{isLocked:!0,lockedBy:e,lastModifiedBy:e,lastModifiedAt:Qu()}),console.log(`🔒 Lock acquired by ${t} for shape:`,n),{success:!0})})}catch(r){return console.error("Error acquiring lock:",r),{success:!1,error:r instanceof Error?r.message:"Unknown error"}}},O5=async(n,e,t,r)=>{try{const i=yl(Or,Dm,n);return await dE(Or,async o=>{const l=await o.get(i);if(!l.exists())throw new Error("Shape not found");if(l.data().lockedBy!==e)return console.warn("Cannot release lock not owned by user"),{success:!1,error:"Lock not owned by user"};const d={isLocked:!1,lockedBy:null,lastModifiedBy:e,lastModifiedAt:Qu()};return o.update(i,d),console.log(`🔓 Lock released by ${t} for shape:`,n,r?`with position (${r.x}, ${r.y})`:"without position update"),{success:!0}})}catch(i){return console.error("Error releasing lock:",i),{success:!1,error:i instanceof Error?i.message:"Unknown error"}}},A$=async(n,e)=>{try{const t=$E(),r=Pk(t,`presence/${n}`);await Iz(r,{userId:n,displayName:e,online:!0,lastSeen:Date.now()}),await Cz(r).set({userId:n,displayName:e,online:!1,lastSeen:Date.now()}),console.log(`🔒 Set up disconnect cleanup for user: ${e}`)}catch(t){console.error("Error setting up disconnect cleanup:",t)}},x$=async n=>{try{console.log(`🧹 Force releasing all locks for user: ${n}`);const e=af(Or,Dm),t=uR(e,dF("lockedBy","==",n)),r=await cE(t),i=r.docs.map(async s=>{const o=yl(Or,Dm,s.id);return dE(Or,async l=>{const c=await l.get(o);c.exists()&&c.data().lockedBy===n&&(l.update(o,{isLocked:!1,lockedBy:null,lastModifiedAt:Qu()}),console.log(`🔓 Force unlocked shape: ${s.id}`))})});await Promise.all(i),console.log(`✅ Released ${r.docs.length} locks for user: ${n}`)}catch(e){console.error("Error force releasing user locks:",e)}},N$=()=>{Ee.useEffect(()=>{const n=$E(),e=Pk(n,"presence"),t=r=>{if(!r.exists())return;const i=r.val();Object.entries(i).forEach(([s,o])=>{const l=o;!l.online&&Date.now()-l.lastSeen>5e3&&(console.log(`👻 Detected offline user: ${l.displayName}, cleaning up locks`),x$(s).catch(c=>{console.error("Failed to cleanup locks for offline user:",c)}))})};return Rz(e,t),()=>{kz(e,"value",t)}},[])},D$=({width:n,height:e,listening:t})=>{const i=[];for(let o=0;o<=n/50;o++){const l=o*50;i.push(Q.jsx(P5,{points:[l,0,l,e],stroke:"#f0f0f0",strokeWidth:.5,listening:!1},`v-${o}`))}const s=[];for(let o=0;o<=e/50;o++){const l=o*50;s.push(Q.jsx(P5,{points:[0,l,n,l],stroke:"#f0f0f0",strokeWidth:.5,listening:!1},`h-${o}`))}return Q.jsxs(zd,{listening:t,children:[Q.jsx(Bd,{x:0,y:0,width:n,height:e,fill:"white",listening:!1}),i,s,Q.jsx(Bd,{x:0,y:0,width:n,height:e,stroke:"#cccccc",strokeWidth:2,fill:"transparent",listening:!1})]})},SA=wn.memo(({shape:n})=>{const{selectShape:e,selectedShapeId:t,shapes:r}=wf(),{user:i}=jd(),s=t===n.id,o=n.isLocked&&n.lockedBy!==(i==null?void 0:i.uid),l=!o&&!!i,c=Ee.useCallback(()=>{o||e(n.id)},[n.id,e,o]),d=Ee.useCallback(async m=>{if(!i){m.target.stopDrag();return}if(!r.find(E=>E.id===n.id)){console.warn(`Shape ${n.id} no longer exists, stopping drag`),m.target.stopDrag();return}try{const E=await k$(n.id,i.uid,i.displayName);E.success?e(n.id):(console.warn(`Failed to acquire lock: ${E.error}`),m.target.stopDrag())}catch(E){console.error("Error in drag start:",E),m.target.stopDrag()}},[i,n.id,e,r]),p=Ee.useCallback(async m=>{if(!i)return;const S=m.target,E=S.x(),A=S.y();try{if(!r.find(k=>k.id===n.id)){console.warn(`Shape ${n.id} was deleted during drag`);return}await P$(n.id,{x:E,y:A},i.uid),await O5(n.id,i.uid,i.displayName),console.log(`✅ Drag completed: ${n.id} -> (${E}, ${A})`)}catch(D){console.error("Drag end failed:",D);try{S.x(n.x),S.y(n.y),console.log(`🔄 Reset shape ${n.id} to original position after error`),await O5(n.id,i.uid,i.displayName)}catch(k){console.error("Failed to reset shape position:",k)}}},[i,n.id,n.x,n.y,r]),_=Ee.useCallback(m=>{const S=Math.round(m.x/20)*20,E=Math.round(m.y/20)*20;return{x:Math.max(0,Math.min(4900,S)),y:Math.max(0,Math.min(4900,E))}},[]);return Q.jsxs(Q.Fragment,{children:[Q.jsx(Bd,{x:n.x,y:n.y,width:n.width,height:n.height,fill:n.fill,stroke:s?(i==null?void 0:i.cursorColor)||"#0066ff":"transparent",strokeWidth:s?2:0,draggable:l,dragBoundFunc:l?_:void 0,onClick:c,onDragStart:d,onDragEnd:p}),n.text&&Q.jsx(R5,{x:n.x,y:n.y+42,width:n.width,text:n.text,fontSize:14,fill:"#000",align:"center",listening:!1}),o&&Q.jsx(R5,{x:n.x,y:n.y-20,text:`🔒 Editing: ${n.lockedBy===(i==null?void 0:i.uid)?"You":"Another user"}`,fontSize:12,fontFamily:"sans-serif",fill:"#ff6b6b",listening:!1})]})});SA.displayName="SimpleShape";const O$=({listening:n})=>{const{shapes:e}=wf();return Q.jsx(zd,{listening:n,children:e.map(t=>Q.jsx(SA,{shape:t},t.id))})},b$=({listening:n})=>Q.jsx(zd,{listening:n}),M$=({listening:n})=>{const{getSelectedShape:e}=wf(),t=e();return t?Q.jsxs(zd,{listening:n,children:[Q.jsx(Bd,{x:t.x-2,y:t.y-2,width:t.width+4,height:t.height+4,stroke:"#0066ff",strokeWidth:2,fill:"transparent",dash:[5,5],listening:!1}),[-2,t.width+2].map(r=>[-2,t.height+2].map(i=>Q.jsx(Bd,{x:t.x+r-3,y:t.y+i-3,width:6,height:6,fill:"#0066ff",stroke:"white",strokeWidth:1,listening:!1},`handle-${r}-${i}`)))]}):Q.jsx(zd,{listening:n})},kv=5e3,Av=5e3,L$=.1,F$=3,V$=({width:n,height:e})=>{const t=Ee.useRef(null),[r,i]=Ee.useState(!1),[s,o]=Ee.useState({x:0,y:0}),{viewport:l,setViewport:c,selectShape:d}=wf(),{user:p}=jd();R$(),N$();const _=Ee.useCallback(k=>{k.evt.preventDefault();const R=t.current;if(!R)return;const w=R.scaleX(),P=R.getPointerPosition();if(!P)return;const V=1.05,U=k.evt.deltaY>0?w/V:w*V,N=Math.max(L$,Math.min(F$,U)),C={x:(P.x-R.x())/w,y:(P.y-R.y())/w},O={x:P.x-C.x*N,y:P.y-C.y*N},x=m(O.x,O.y,N);c({x:x.x,y:x.y,scale:N}),R.position(x),R.scale({x:N,y:N})},[c]),m=Ee.useCallback((k,R,w)=>{const P=n,V=e,U=P-kv*w,N=V-Av*w;return{x:Math.max(U,Math.min(0,k)),y:Math.max(N,Math.min(0,R))}},[n,e]),S=Ee.useCallback(k=>{var w;if(k.evt.button===1||k.evt.button===0&&k.evt.ctrlKey){k.evt.preventDefault(),i(!0);const P=(w=k.target.getStage())==null?void 0:w.getPointerPosition();P&&o(P)}},[]),E=Ee.useCallback(k=>{if(!r)return;k.evt.preventDefault();const R=k.target.getStage();if(!R)return;const w=R.getPointerPosition();if(!w)return;const P=w.x-s.x,V=w.y-s.y,U={x:l.x+P,y:l.y+V},N=m(U.x,U.y,l.scale);c({x:N.x,y:N.y,scale:l.scale}),o(w)},[r,s,l,m,c]),A=Ee.useCallback(k=>{(k.evt.button===1||k.evt.button===0&&r)&&i(!1)},[r]),D=Ee.useCallback(async k=>{if(!(k.target!==t.current||k.evt.button!==0||k.evt.ctrlKey||r)&&(d(null),!!p))try{const R=t.current;if(!R)return;const w=R.getPointerPosition();if(!w)return;const P=(w.x-l.x)/l.scale,V=(w.y-l.y)/l.scale,U=Math.max(0,Math.min(kv-100,P)),N=Math.max(0,Math.min(Av-100,V));await C$(U,N,p.uid,p.displayName),console.log(`✨ Shape created at (${U}, ${N})`)}catch(R){console.error("Error creating shape:",R)}},[r,p,l,d]);return Ee.useEffect(()=>{const k=t.current;k&&(k.position({x:l.x,y:l.y}),k.scale({x:l.scale,y:l.scale}))},[l]),Q.jsxs("div",{className:"relative overflow-hidden bg-white border border-gray-300 rounded-lg shadow-sm",children:[Q.jsxs(WH,{ref:t,width:n,height:e,x:l.x,y:l.y,scaleX:l.scale,scaleY:l.scale,onWheel:_,onMouseDown:S,onMouseMove:E,onMouseUp:A,onClick:D,onTap:D,children:[Q.jsx(D$,{width:kv,height:Av,listening:!1}),Q.jsx(O$,{listening:!0}),Q.jsx(M$,{listening:!1}),Q.jsx(b$,{listening:!1})]}),Q.jsx("div",{className:"absolute top-2 right-2",children:Q.jsxs("div",{className:"text-xs text-gray-500 bg-white px-2 py-1 rounded shadow",children:["Scale: ",(l.scale*100).toFixed(0),"%"]})}),r&&Q.jsx("div",{className:"absolute bottom-2 left-2",children:Q.jsx("div",{className:"text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded shadow",children:"Panning..."})})]})},U$=async()=>{try{console.log("🧹 Clearing all locks...");const n=af(Or,"canvas/global-canvas-v1/shapes"),e=await cE(n),t=e.docs.map(async r=>{const i=yl(Or,"canvas/global-canvas-v1/shapes",r.id);await pR(i,{isLocked:!1,lockedBy:null}),console.log(`🔓 Cleared lock for shape: ${r.id}`)});return await Promise.all(t),console.log(`✅ Cleared ${e.docs.length} locks successfully!`),{success:!0,clearedCount:e.docs.length}}catch(n){return console.error("❌ Error clearing locks:",n),{success:!1,error:n}}},z$=async()=>{try{console.log("🗑️ Clearing all shapes...");const n=af(Or,"canvas/global-canvas-v1/shapes"),e=await cE(n),t=e.docs.map(async r=>{const i=yl(Or,"canvas/global-canvas-v1/shapes",r.id);await _F(i),console.log(`🗑️ Deleted shape: ${r.id}`)});return await Promise.all(t),console.log(`✅ Deleted ${e.docs.length} shapes successfully!`),{success:!0,deletedCount:e.docs.length}}catch(n){return console.error("❌ Error clearing shapes:",n),{success:!1,error:n}}},B$=()=>{const{user:n,isAuthenticated:e}=jd(),[t,r]=Ee.useState(!1),[i,s]=Ee.useState(!1),o=async()=>{try{await iO(Ld)}catch(d){console.error("Error signing out:",d)}},l=async()=>{if(confirm("⚠️ This will delete ALL shapes permanently. Are you sure?")){s(!0);try{const d=await z$();d.success?alert(`✅ Successfully deleted ${d.deletedCount} shapes!`):alert(`❌ Failed to clear shapes: ${d.error}`)}catch(d){alert(`❌ Error: ${d}`)}s(!1),r(!1)}},c=async()=>{s(!0);try{const d=await U$();d.success?alert(`✅ Successfully cleared ${d.clearedCount} locks!`):alert(`❌ Failed to clear locks: ${d.error}`)}catch(d){alert(`❌ Error: ${d}`)}s(!1),r(!1)};return e?Q.jsxs("header",{className:"bg-white border-b border-gray-200 px-4 py-3 flex justify-between items-center",children:[Q.jsxs("div",{className:"flex items-center space-x-4",children:[Q.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:"CollabCanvas"}),Q.jsx("div",{className:"text-sm text-gray-500",children:"Real-Time Collaborative Design Tool"})]}),Q.jsxs("div",{className:"flex items-center space-x-4",children:[Q.jsxs("div",{className:"flex items-center space-x-2",children:[Q.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:n==null?void 0:n.cursorColor}}),Q.jsx("span",{className:"text-sm font-medium text-gray-700",children:n==null?void 0:n.displayName})]}),Q.jsxs("div",{className:"relative",children:[Q.jsx("button",{onClick:()=>r(!t),className:"text-xs text-gray-400 hover:text-red-600 px-2 py-1 rounded border border-gray-200 hover:border-red-300",title:"Admin Panel",children:"🛠️"}),t&&Q.jsxs("div",{className:"absolute right-0 top-8 bg-white border border-gray-300 rounded shadow-lg p-3 z-50 min-w-[200px]",children:[Q.jsx("div",{className:"text-xs font-medium text-gray-600 mb-2",children:"Admin Panel"}),Q.jsx("button",{onClick:c,disabled:i,className:"w-full text-left text-xs text-blue-600 hover:text-blue-800 px-2 py-1 rounded hover:bg-blue-50 disabled:opacity-50",children:"🔓 Clear All Locks"}),Q.jsx("button",{onClick:l,disabled:i,className:"w-full text-left text-xs text-red-600 hover:text-red-800 px-2 py-1 rounded hover:bg-red-50 disabled:opacity-50",children:"🗑️ Delete All Shapes"}),i&&Q.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"Working..."})]})]}),Q.jsx("button",{onClick:o,className:"text-sm text-gray-500 hover:text-gray-700 px-3 py-1 rounded border border-gray-300 hover:border-gray-400",children:"Sign Out"})]})]}):null},j$=()=>{const{setUser:n,setLoading:e,setError:t,clearUser:r}=jd();return Ee.useEffect(()=>{const i=rO(Ld,async s=>{try{if(s){const o=y$(s);n(o,s),console.log("🔥 User authenticated:",o.displayName),await A$(o.uid,o.displayName)}else r(),console.log("🔥 User signed out")}catch(o){console.error("Auth state change error:",o),t("Authentication error occurred")}finally{e(!1)}},s=>{console.error("Auth state observer error:",s),t("Failed to initialize authentication"),e(!1)});return()=>i()},[n,e,t,r]),jd()},G$=({children:n,fallback:e})=>{const{isAuthenticated:t,isLoading:r,error:i}=j$();return r?Q.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:Q.jsx("div",{className:"bg-white rounded-lg shadow-md p-8",children:Q.jsxs("div",{className:"text-center",children:[Q.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),Q.jsx("p",{className:"text-gray-600",children:"Checking authentication..."})]})})}):i?Q.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:Q.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 max-w-md",children:[Q.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Authentication Error"}),Q.jsx("p",{className:"text-gray-700 mb-4",children:"Firebase authentication error:"}),Q.jsx("p",{className:"text-sm text-red-600 bg-red-50 p-3 rounded mb-4",children:i}),Q.jsx("button",{onClick:()=>window.location.reload(),className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700",children:"Reload Page"})]})}):t?Q.jsx(Q.Fragment,{children:n}):Q.jsx(Q.Fragment,{children:e})};function W$(){const n=Q.jsxs("div",{className:"container mx-auto px-4 py-8",children:[Q.jsx("h1",{className:"text-4xl font-bold text-center text-gray-800 mb-8",children:"CollabCanvas MVP"}),Q.jsxs("div",{className:"text-center mb-8",children:[Q.jsx("p",{className:"text-lg text-gray-600 mb-2",children:"Real-Time Collaborative Design Tool"}),Q.jsx("p",{className:"text-sm text-gray-500",children:"Please sign in to continue"})]}),Q.jsx(Bz,{})]});return Q.jsx("div",{className:"min-h-screen bg-gray-50",children:Q.jsx(G$,{fallback:n,children:Q.jsxs("div",{className:"h-screen flex flex-col",children:[Q.jsx(B$,{}),Q.jsx("main",{className:"flex-1 p-4",children:Q.jsxs("div",{className:"h-full flex",children:[Q.jsx("div",{className:"flex-1 mr-4",children:Q.jsx(V$,{width:800,height:600})}),Q.jsxs("div",{className:"w-64 bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[Q.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Canvas Tools"}),Q.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[Q.jsx("div",{children:"• Left-click empty space to create rectangles"}),Q.jsx("div",{children:"• Left-drag rectangles to move them"}),Q.jsx("div",{children:"• Left-click shapes to select them"}),Q.jsx("div",{children:"• Middle-click drag to pan (Ctrl+drag on Mac)"}),Q.jsx("div",{children:"• Mouse wheel to zoom"}),Q.jsx("div",{children:"• Canvas size: 5000×5000px"})]}),Q.jsxs("div",{className:"mt-6",children:[Q.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Phase 5 Progress:"}),Q.jsxs("div",{className:"space-y-1 text-sm text-gray-500",children:[Q.jsx("div",{children:"✅ Pan & Zoom"}),Q.jsx("div",{children:"✅ Shape Creation"}),Q.jsx("div",{children:"✅ Real-time Sync"}),Q.jsx("div",{children:"✅ Drag & Drop"}),Q.jsx("div",{children:"✅ Transaction Locking"}),Q.jsx("div",{children:"✅ Middle-click Pan"})]})]}),!1]})]})})]})})})}xv.createRoot(document.getElementById("root")).render(Q.jsx(wn.StrictMode,{children:Q.jsx(W$,{})}));
