var TA=Object.defineProperty;var IA=(n,e,t)=>e in n?TA(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Xn=(n,e,t)=>IA(n,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var Y4=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bm(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var eI={exports:{}},zm={},tI={exports:{}},We={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qd=Symbol.for("react.element"),PA=Symbol.for("react.portal"),kA=Symbol.for("react.fragment"),RA=Symbol.for("react.strict_mode"),xA=Symbol.for("react.profiler"),AA=Symbol.for("react.provider"),NA=Symbol.for("react.context"),bA=Symbol.for("react.forward_ref"),DA=Symbol.for("react.suspense"),MA=Symbol.for("react.memo"),OA=Symbol.for("react.lazy"),X4=Symbol.iterator;function LA(n){return n===null||typeof n!="object"?null:(n=X4&&n[X4]||n["@@iterator"],typeof n=="function"?n:null)}var nI={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},rI=Object.assign,iI={};function dc(n,e,t){this.props=n,this.context=e,this.refs=iI,this.updater=t||nI}dc.prototype.isReactComponent={};dc.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};dc.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function sI(){}sI.prototype=dc.prototype;function L2(n,e,t){this.props=n,this.context=e,this.refs=iI,this.updater=t||nI}var F2=L2.prototype=new sI;F2.constructor=L2;rI(F2,dc.prototype);F2.isPureReactComponent=!0;var J4=Array.isArray,oI=Object.prototype.hasOwnProperty,V2={current:null},aI={key:!0,ref:!0,__self:!0,__source:!0};function lI(n,e,t){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)oI.call(e,r)&&!aI.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=t;else if(1<l){for(var c=Array(l),h=0;h<l;h++)c[h]=arguments[h+2];i.children=c}if(n&&n.defaultProps)for(r in l=n.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:Qd,type:n,key:s,ref:o,props:i,_owner:V2.current}}function FA(n,e){return{$$typeof:Qd,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function U2(n){return typeof n=="object"&&n!==null&&n.$$typeof===Qd}function VA(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var Z4=/\/+/g;function Ly(n,e){return typeof n=="object"&&n!==null&&n.key!=null?VA(""+n.key):e.toString(36)}function ig(n,e,t,r,i){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case Qd:case PA:o=!0}}if(o)return o=n,i=i(o),n=r===""?"."+Ly(o,0):r,J4(i)?(t="",n!=null&&(t=n.replace(Z4,"$&/")+"/"),ig(i,e,t,"",function(h){return h})):i!=null&&(U2(i)&&(i=FA(i,t+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Z4,"$&/")+"/")+n)),e.push(i)),1;if(o=0,r=r===""?".":r+":",J4(n))for(var l=0;l<n.length;l++){s=n[l];var c=r+Ly(s,l);o+=ig(s,e,t,c,i)}else if(c=LA(n),typeof c=="function")for(n=c.call(n),l=0;!(s=n.next()).done;)s=s.value,c=r+Ly(s,l++),o+=ig(s,e,t,c,i);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Rp(n,e,t){if(n==null)return n;var r=[],i=0;return ig(n,r,"","",function(s){return e.call(t,s,i++)}),r}function UA(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var wr={current:null},sg={transition:null},BA={ReactCurrentDispatcher:wr,ReactCurrentBatchConfig:sg,ReactCurrentOwner:V2};function uI(){throw Error("act(...) is not supported in production builds of React.")}We.Children={map:Rp,forEach:function(n,e,t){Rp(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Rp(n,function(){e++}),e},toArray:function(n){return Rp(n,function(e){return e})||[]},only:function(n){if(!U2(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};We.Component=dc;We.Fragment=kA;We.Profiler=xA;We.PureComponent=L2;We.StrictMode=RA;We.Suspense=DA;We.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=BA;We.act=uI;We.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=rI({},n.props),i=n.key,s=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=V2.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var l=n.type.defaultProps;for(c in e)oI.call(e,c)&&!aI.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=t;else if(1<c){l=Array(c);for(var h=0;h<c;h++)l[h]=arguments[h+2];r.children=l}return{$$typeof:Qd,type:n.type,key:i,ref:s,props:r,_owner:o}};We.createContext=function(n){return n={$$typeof:NA,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:AA,_context:n},n.Consumer=n};We.createElement=lI;We.createFactory=function(n){var e=lI.bind(null,n);return e.type=n,e};We.createRef=function(){return{current:null}};We.forwardRef=function(n){return{$$typeof:bA,render:n}};We.isValidElement=U2;We.lazy=function(n){return{$$typeof:OA,_payload:{_status:-1,_result:n},_init:UA}};We.memo=function(n,e){return{$$typeof:MA,type:n,compare:e===void 0?null:e}};We.startTransition=function(n){var e=sg.transition;sg.transition={};try{n()}finally{sg.transition=e}};We.unstable_act=uI;We.useCallback=function(n,e){return wr.current.useCallback(n,e)};We.useContext=function(n){return wr.current.useContext(n)};We.useDebugValue=function(){};We.useDeferredValue=function(n){return wr.current.useDeferredValue(n)};We.useEffect=function(n,e){return wr.current.useEffect(n,e)};We.useId=function(){return wr.current.useId()};We.useImperativeHandle=function(n,e,t){return wr.current.useImperativeHandle(n,e,t)};We.useInsertionEffect=function(n,e){return wr.current.useInsertionEffect(n,e)};We.useLayoutEffect=function(n,e){return wr.current.useLayoutEffect(n,e)};We.useMemo=function(n,e){return wr.current.useMemo(n,e)};We.useReducer=function(n,e,t){return wr.current.useReducer(n,e,t)};We.useRef=function(n){return wr.current.useRef(n)};We.useState=function(n){return wr.current.useState(n)};We.useSyncExternalStore=function(n,e,t){return wr.current.useSyncExternalStore(n,e,t)};We.useTransition=function(){return wr.current.useTransition()};We.version="18.3.1";tI.exports=We;var ue=tI.exports;const En=Bm(ue);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zA=ue,jA=Symbol.for("react.element"),GA=Symbol.for("react.fragment"),WA=Object.prototype.hasOwnProperty,HA=zA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,$A={key:!0,ref:!0,__self:!0,__source:!0};function cI(n,e,t){var r,i={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)WA.call(e,r)&&!$A.hasOwnProperty(r)&&(i[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:jA,type:n,key:s,ref:o,props:i,_owner:HA.current}}zm.Fragment=GA;zm.jsx=cI;zm.jsxs=cI;eI.exports=zm;var z=eI.exports,Bv={},hI={exports:{}},Hr={},dI={exports:{}},fI={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e($,J){var ee=$.length;$.push(J);e:for(;0<ee;){var Z=ee-1>>>1,ie=$[Z];if(0<i(ie,J))$[Z]=J,$[ee]=ie,ee=Z;else break e}}function t($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var J=$[0],ee=$.pop();if(ee!==J){$[0]=ee;e:for(var Z=0,ie=$.length,_e=ie>>>1;Z<_e;){var Tt=2*(Z+1)-1,dt=$[Tt],Ve=Tt+1,j=$[Ve];if(0>i(dt,ee))Ve<ie&&0>i(j,dt)?($[Z]=j,$[Ve]=ee,Z=Ve):($[Z]=dt,$[Tt]=ee,Z=Tt);else if(Ve<ie&&0>i(j,ee))$[Z]=j,$[Ve]=ee,Z=Ve;else break e}}return J}function i($,J){var ee=$.sortIndex-J.sortIndex;return ee!==0?ee:$.id-J.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var c=[],h=[],p=1,m=null,_=3,w=!1,S=!1,k=!1,N=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E($){for(var J=t(h);J!==null;){if(J.callback===null)r(h);else if(J.startTime<=$)r(h),J.sortIndex=J.expirationTime,e(c,J);else break;J=t(h)}}function P($){if(k=!1,E($),!S)if(t(c)!==null)S=!0,Me(V);else{var J=t(h);J!==null&&be(P,J.startTime-$)}}function V($,J){S=!1,k&&(k=!1,x(T),T=-1),w=!0;var ee=_;try{for(E(J),m=t(c);m!==null&&(!(m.expirationTime>J)||$&&!O());){var Z=m.callback;if(typeof Z=="function"){m.callback=null,_=m.priorityLevel;var ie=Z(m.expirationTime<=J);J=n.unstable_now(),typeof ie=="function"?m.callback=ie:m===t(c)&&r(c),E(J)}else r(c);m=t(c)}if(m!==null)var _e=!0;else{var Tt=t(h);Tt!==null&&be(P,Tt.startTime-J),_e=!1}return _e}finally{m=null,_=ee,w=!1}}var B=!1,D=null,T=-1,b=5,A=-1;function O(){return!(n.unstable_now()-A<b)}function U(){if(D!==null){var $=n.unstable_now();A=$;var J=!0;try{J=D(!0,$)}finally{J?F():(B=!1,D=null)}}else B=!1}var F;if(typeof R=="function")F=function(){R(U)};else if(typeof MessageChannel<"u"){var ce=new MessageChannel,le=ce.port2;ce.port1.onmessage=U,F=function(){le.postMessage(null)}}else F=function(){N(U,0)};function Me($){D=$,B||(B=!0,F())}function be($,J){T=N(function(){$(n.unstable_now())},J)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function($){$.callback=null},n.unstable_continueExecution=function(){S||w||(S=!0,Me(V))},n.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<$?Math.floor(1e3/$):5},n.unstable_getCurrentPriorityLevel=function(){return _},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function($){switch(_){case 1:case 2:case 3:var J=3;break;default:J=_}var ee=_;_=J;try{return $()}finally{_=ee}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function($,J){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var ee=_;_=$;try{return J()}finally{_=ee}},n.unstable_scheduleCallback=function($,J,ee){var Z=n.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?Z+ee:Z):ee=Z,$){case 1:var ie=-1;break;case 2:ie=250;break;case 5:ie=1073741823;break;case 4:ie=1e4;break;default:ie=5e3}return ie=ee+ie,$={id:p++,callback:J,priorityLevel:$,startTime:ee,expirationTime:ie,sortIndex:-1},ee>Z?($.sortIndex=ee,e(h,$),t(c)===null&&$===t(h)&&(k?(x(T),T=-1):k=!0,be(P,ee-Z))):($.sortIndex=ie,e(c,$),S||w||(S=!0,Me(V))),$},n.unstable_shouldYield=O,n.unstable_wrapCallback=function($){var J=_;return function(){var ee=_;_=J;try{return $.apply(this,arguments)}finally{_=ee}}}})(fI);dI.exports=fI;var Gh=dI.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qA=ue,Wr=Gh;function re(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var pI=new Set,cd={};function wl(n,e){Bu(n,e),Bu(n+"Capture",e)}function Bu(n,e){for(cd[n]=e,n=0;n<e.length;n++)pI.add(e[n])}var Hs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),zv=Object.prototype.hasOwnProperty,KA=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,eC={},tC={};function QA(n){return zv.call(tC,n)?!0:zv.call(eC,n)?!1:KA.test(n)?tC[n]=!0:(eC[n]=!0,!1)}function YA(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function XA(n,e,t,r){if(e===null||typeof e>"u"||YA(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Er(n,e,t,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var zn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){zn[n]=new Er(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];zn[e]=new Er(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){zn[n]=new Er(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){zn[n]=new Er(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){zn[n]=new Er(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){zn[n]=new Er(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){zn[n]=new Er(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){zn[n]=new Er(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){zn[n]=new Er(n,5,!1,n.toLowerCase(),null,!1,!1)});var B2=/[\-:]([a-z])/g;function z2(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(B2,z2);zn[e]=new Er(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(B2,z2);zn[e]=new Er(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(B2,z2);zn[e]=new Er(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){zn[n]=new Er(n,1,!1,n.toLowerCase(),null,!1,!1)});zn.xlinkHref=new Er("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){zn[n]=new Er(n,1,!1,n.toLowerCase(),null,!0,!0)});function j2(n,e,t,r){var i=zn.hasOwnProperty(e)?zn[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(XA(e,t,i,r)&&(t=null),r||i===null?QA(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,r=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var eo=qA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,xp=Symbol.for("react.element"),fu=Symbol.for("react.portal"),pu=Symbol.for("react.fragment"),G2=Symbol.for("react.strict_mode"),jv=Symbol.for("react.profiler"),gI=Symbol.for("react.provider"),mI=Symbol.for("react.context"),W2=Symbol.for("react.forward_ref"),Gv=Symbol.for("react.suspense"),Wv=Symbol.for("react.suspense_list"),H2=Symbol.for("react.memo"),Io=Symbol.for("react.lazy"),_I=Symbol.for("react.offscreen"),nC=Symbol.iterator;function gh(n){return n===null||typeof n!="object"?null:(n=nC&&n[nC]||n["@@iterator"],typeof n=="function"?n:null)}var Ft=Object.assign,Fy;function bh(n){if(Fy===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Fy=e&&e[1]||""}return`
`+Fy+n}var Vy=!1;function Uy(n,e){if(!n||Vy)return"";Vy=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var r=h}Reflect.construct(n,[],e)}else{try{e.call()}catch(h){r=h}n.call(e.prototype)}else{try{throw Error()}catch(h){r=h}n()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var i=h.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var c=`
`+i[o].replace(" at new "," at ");return n.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",n.displayName)),c}while(1<=o&&0<=l);break}}}finally{Vy=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?bh(n):""}function JA(n){switch(n.tag){case 5:return bh(n.type);case 16:return bh("Lazy");case 13:return bh("Suspense");case 19:return bh("SuspenseList");case 0:case 2:case 15:return n=Uy(n.type,!1),n;case 11:return n=Uy(n.type.render,!1),n;case 1:return n=Uy(n.type,!0),n;default:return""}}function Hv(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case pu:return"Fragment";case fu:return"Portal";case jv:return"Profiler";case G2:return"StrictMode";case Gv:return"Suspense";case Wv:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case mI:return(n.displayName||"Context")+".Consumer";case gI:return(n._context.displayName||"Context")+".Provider";case W2:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case H2:return e=n.displayName||null,e!==null?e:Hv(n.type)||"Memo";case Io:e=n._payload,n=n._init;try{return Hv(n(e))}catch{}}return null}function ZA(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Hv(e);case 8:return e===G2?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Yo(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function yI(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function e8(n){var e=yI(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Ap(n){n._valueTracker||(n._valueTracker=e8(n))}function vI(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=yI(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function xg(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function $v(n,e){var t=e.checked;return Ft({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function rC(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=Yo(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function wI(n,e){e=e.checked,e!=null&&j2(n,"checked",e,!1)}function qv(n,e){wI(n,e);var t=Yo(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?Kv(n,e.type,t):e.hasOwnProperty("defaultValue")&&Kv(n,e.type,Yo(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function iC(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function Kv(n,e,t){(e!=="number"||xg(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Dh=Array.isArray;function ku(n,e,t,r){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&r&&(n[t].defaultSelected=!0)}else{for(t=""+Yo(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,r&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function Qv(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(re(91));return Ft({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function sC(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(re(92));if(Dh(t)){if(1<t.length)throw Error(re(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Yo(t)}}function EI(n,e){var t=Yo(e.value),r=Yo(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function oC(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function SI(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Yv(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?SI(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Np,CI=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Np=Np||document.createElement("div"),Np.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Np.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function hd(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var Wh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},t8=["Webkit","ms","Moz","O"];Object.keys(Wh).forEach(function(n){t8.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),Wh[e]=Wh[n]})});function TI(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Wh.hasOwnProperty(n)&&Wh[n]?(""+e).trim():e+"px"}function II(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,i=TI(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,i):n[t]=i}}var n8=Ft({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Xv(n,e){if(e){if(n8[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(re(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(re(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(re(61))}if(e.style!=null&&typeof e.style!="object")throw Error(re(62))}}function Jv(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zv=null;function $2(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var e1=null,Ru=null,xu=null;function aC(n){if(n=Jd(n)){if(typeof e1!="function")throw Error(re(280));var e=n.stateNode;e&&(e=$m(e),e1(n.stateNode,n.type,e))}}function PI(n){Ru?xu?xu.push(n):xu=[n]:Ru=n}function kI(){if(Ru){var n=Ru,e=xu;if(xu=Ru=null,aC(n),e)for(n=0;n<e.length;n++)aC(e[n])}}function RI(n,e){return n(e)}function xI(){}var By=!1;function AI(n,e,t){if(By)return n(e,t);By=!0;try{return RI(n,e,t)}finally{By=!1,(Ru!==null||xu!==null)&&(xI(),kI())}}function dd(n,e){var t=n.stateNode;if(t===null)return null;var r=$m(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(re(231,e,typeof t));return t}var t1=!1;if(Hs)try{var mh={};Object.defineProperty(mh,"passive",{get:function(){t1=!0}}),window.addEventListener("test",mh,mh),window.removeEventListener("test",mh,mh)}catch{t1=!1}function r8(n,e,t,r,i,s,o,l,c){var h=Array.prototype.slice.call(arguments,3);try{e.apply(t,h)}catch(p){this.onError(p)}}var Hh=!1,Ag=null,Ng=!1,n1=null,i8={onError:function(n){Hh=!0,Ag=n}};function s8(n,e,t,r,i,s,o,l,c){Hh=!1,Ag=null,r8.apply(i8,arguments)}function o8(n,e,t,r,i,s,o,l,c){if(s8.apply(this,arguments),Hh){if(Hh){var h=Ag;Hh=!1,Ag=null}else throw Error(re(198));Ng||(Ng=!0,n1=h)}}function El(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function NI(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function lC(n){if(El(n)!==n)throw Error(re(188))}function a8(n){var e=n.alternate;if(!e){if(e=El(n),e===null)throw Error(re(188));return e!==n?null:n}for(var t=n,r=e;;){var i=t.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){t=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===t)return lC(i),n;if(s===r)return lC(i),e;s=s.sibling}throw Error(re(188))}if(t.return!==r.return)t=i,r=s;else{for(var o=!1,l=i.child;l;){if(l===t){o=!0,t=i,r=s;break}if(l===r){o=!0,r=i,t=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===t){o=!0,t=s,r=i;break}if(l===r){o=!0,r=s,t=i;break}l=l.sibling}if(!o)throw Error(re(189))}}if(t.alternate!==r)throw Error(re(190))}if(t.tag!==3)throw Error(re(188));return t.stateNode.current===t?n:e}function bI(n){return n=a8(n),n!==null?DI(n):null}function DI(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=DI(n);if(e!==null)return e;n=n.sibling}return null}var MI=Wr.unstable_scheduleCallback,uC=Wr.unstable_cancelCallback,l8=Wr.unstable_shouldYield,u8=Wr.unstable_requestPaint,Ht=Wr.unstable_now,c8=Wr.unstable_getCurrentPriorityLevel,q2=Wr.unstable_ImmediatePriority,OI=Wr.unstable_UserBlockingPriority,bg=Wr.unstable_NormalPriority,h8=Wr.unstable_LowPriority,LI=Wr.unstable_IdlePriority,jm=null,rs=null;function d8(n){if(rs&&typeof rs.onCommitFiberRoot=="function")try{rs.onCommitFiberRoot(jm,n,void 0,(n.current.flags&128)===128)}catch{}}var Ri=Math.clz32?Math.clz32:g8,f8=Math.log,p8=Math.LN2;function g8(n){return n>>>=0,n===0?32:31-(f8(n)/p8|0)|0}var bp=64,Dp=4194304;function Mh(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Dg(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,i=n.suspendedLanes,s=n.pingedLanes,o=t&268435455;if(o!==0){var l=o&~i;l!==0?r=Mh(l):(s&=o,s!==0&&(r=Mh(s)))}else o=t&~i,o!==0?r=Mh(o):s!==0&&(r=Mh(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-Ri(e),i=1<<t,r|=n[t],e&=~i;return r}function m8(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _8(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,i=n.expirationTimes,s=n.pendingLanes;0<s;){var o=31-Ri(s),l=1<<o,c=i[o];c===-1?(!(l&t)||l&r)&&(i[o]=m8(l,e)):c<=e&&(n.expiredLanes|=l),s&=~l}}function r1(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function FI(){var n=bp;return bp<<=1,!(bp&4194240)&&(bp=64),n}function zy(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Yd(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Ri(e),n[e]=t}function y8(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-Ri(t),s=1<<i;e[i]=0,r[i]=-1,n[i]=-1,t&=~s}}function K2(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-Ri(t),i=1<<r;i&e|n[r]&e&&(n[r]|=e),t&=~i}}var ct=0;function VI(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var UI,Q2,BI,zI,jI,i1=!1,Mp=[],Lo=null,Fo=null,Vo=null,fd=new Map,pd=new Map,ko=[],v8="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function cC(n,e){switch(n){case"focusin":case"focusout":Lo=null;break;case"dragenter":case"dragleave":Fo=null;break;case"mouseover":case"mouseout":Vo=null;break;case"pointerover":case"pointerout":fd.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":pd.delete(e.pointerId)}}function _h(n,e,t,r,i,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Jd(e),e!==null&&Q2(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function w8(n,e,t,r,i){switch(e){case"focusin":return Lo=_h(Lo,n,e,t,r,i),!0;case"dragenter":return Fo=_h(Fo,n,e,t,r,i),!0;case"mouseover":return Vo=_h(Vo,n,e,t,r,i),!0;case"pointerover":var s=i.pointerId;return fd.set(s,_h(fd.get(s)||null,n,e,t,r,i)),!0;case"gotpointercapture":return s=i.pointerId,pd.set(s,_h(pd.get(s)||null,n,e,t,r,i)),!0}return!1}function GI(n){var e=Qa(n.target);if(e!==null){var t=El(e);if(t!==null){if(e=t.tag,e===13){if(e=NI(t),e!==null){n.blockedOn=e,jI(n.priority,function(){BI(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function og(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=s1(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);Zv=r,t.target.dispatchEvent(r),Zv=null}else return e=Jd(t),e!==null&&Q2(e),n.blockedOn=t,!1;e.shift()}return!0}function hC(n,e,t){og(n)&&t.delete(e)}function E8(){i1=!1,Lo!==null&&og(Lo)&&(Lo=null),Fo!==null&&og(Fo)&&(Fo=null),Vo!==null&&og(Vo)&&(Vo=null),fd.forEach(hC),pd.forEach(hC)}function yh(n,e){n.blockedOn===e&&(n.blockedOn=null,i1||(i1=!0,Wr.unstable_scheduleCallback(Wr.unstable_NormalPriority,E8)))}function gd(n){function e(i){return yh(i,n)}if(0<Mp.length){yh(Mp[0],n);for(var t=1;t<Mp.length;t++){var r=Mp[t];r.blockedOn===n&&(r.blockedOn=null)}}for(Lo!==null&&yh(Lo,n),Fo!==null&&yh(Fo,n),Vo!==null&&yh(Vo,n),fd.forEach(e),pd.forEach(e),t=0;t<ko.length;t++)r=ko[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<ko.length&&(t=ko[0],t.blockedOn===null);)GI(t),t.blockedOn===null&&ko.shift()}var Au=eo.ReactCurrentBatchConfig,Mg=!0;function S8(n,e,t,r){var i=ct,s=Au.transition;Au.transition=null;try{ct=1,Y2(n,e,t,r)}finally{ct=i,Au.transition=s}}function C8(n,e,t,r){var i=ct,s=Au.transition;Au.transition=null;try{ct=4,Y2(n,e,t,r)}finally{ct=i,Au.transition=s}}function Y2(n,e,t,r){if(Mg){var i=s1(n,e,t,r);if(i===null)Xy(n,e,r,Og,t),cC(n,r);else if(w8(i,n,e,t,r))r.stopPropagation();else if(cC(n,r),e&4&&-1<v8.indexOf(n)){for(;i!==null;){var s=Jd(i);if(s!==null&&UI(s),s=s1(n,e,t,r),s===null&&Xy(n,e,r,Og,t),s===i)break;i=s}i!==null&&r.stopPropagation()}else Xy(n,e,r,null,t)}}var Og=null;function s1(n,e,t,r){if(Og=null,n=$2(r),n=Qa(n),n!==null)if(e=El(n),e===null)n=null;else if(t=e.tag,t===13){if(n=NI(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return Og=n,null}function WI(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(c8()){case q2:return 1;case OI:return 4;case bg:case h8:return 16;case LI:return 536870912;default:return 16}default:return 16}}var bo=null,X2=null,ag=null;function HI(){if(ag)return ag;var n,e=X2,t=e.length,r,i="value"in bo?bo.value:bo.textContent,s=i.length;for(n=0;n<t&&e[n]===i[n];n++);var o=t-n;for(r=1;r<=o&&e[t-r]===i[s-r];r++);return ag=i.slice(n,1<r?1-r:void 0)}function lg(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Op(){return!0}function dC(){return!1}function $r(n){function e(t,r,i,s,o){this._reactName=t,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in n)n.hasOwnProperty(l)&&(t=n[l],this[l]=t?t(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Op:dC,this.isPropagationStopped=dC,this}return Ft(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Op)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Op)},persist:function(){},isPersistent:Op}),e}var fc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},J2=$r(fc),Xd=Ft({},fc,{view:0,detail:0}),T8=$r(Xd),jy,Gy,vh,Gm=Ft({},Xd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Z2,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==vh&&(vh&&n.type==="mousemove"?(jy=n.screenX-vh.screenX,Gy=n.screenY-vh.screenY):Gy=jy=0,vh=n),jy)},movementY:function(n){return"movementY"in n?n.movementY:Gy}}),fC=$r(Gm),I8=Ft({},Gm,{dataTransfer:0}),P8=$r(I8),k8=Ft({},Xd,{relatedTarget:0}),Wy=$r(k8),R8=Ft({},fc,{animationName:0,elapsedTime:0,pseudoElement:0}),x8=$r(R8),A8=Ft({},fc,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),N8=$r(A8),b8=Ft({},fc,{data:0}),pC=$r(b8),D8={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},M8={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},O8={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function L8(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=O8[n])?!!e[n]:!1}function Z2(){return L8}var F8=Ft({},Xd,{key:function(n){if(n.key){var e=D8[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=lg(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?M8[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Z2,charCode:function(n){return n.type==="keypress"?lg(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?lg(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),V8=$r(F8),U8=Ft({},Gm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),gC=$r(U8),B8=Ft({},Xd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Z2}),z8=$r(B8),j8=Ft({},fc,{propertyName:0,elapsedTime:0,pseudoElement:0}),G8=$r(j8),W8=Ft({},Gm,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),H8=$r(W8),$8=[9,13,27,32],ew=Hs&&"CompositionEvent"in window,$h=null;Hs&&"documentMode"in document&&($h=document.documentMode);var q8=Hs&&"TextEvent"in window&&!$h,$I=Hs&&(!ew||$h&&8<$h&&11>=$h),mC=" ",_C=!1;function qI(n,e){switch(n){case"keyup":return $8.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function KI(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var gu=!1;function K8(n,e){switch(n){case"compositionend":return KI(e);case"keypress":return e.which!==32?null:(_C=!0,mC);case"textInput":return n=e.data,n===mC&&_C?null:n;default:return null}}function Q8(n,e){if(gu)return n==="compositionend"||!ew&&qI(n,e)?(n=HI(),ag=X2=bo=null,gu=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return $I&&e.locale!=="ko"?null:e.data;default:return null}}var Y8={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function yC(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!Y8[n.type]:e==="textarea"}function QI(n,e,t,r){PI(r),e=Lg(e,"onChange"),0<e.length&&(t=new J2("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var qh=null,md=null;function X8(n){o6(n,0)}function Wm(n){var e=yu(n);if(vI(e))return n}function J8(n,e){if(n==="change")return e}var YI=!1;if(Hs){var Hy;if(Hs){var $y="oninput"in document;if(!$y){var vC=document.createElement("div");vC.setAttribute("oninput","return;"),$y=typeof vC.oninput=="function"}Hy=$y}else Hy=!1;YI=Hy&&(!document.documentMode||9<document.documentMode)}function wC(){qh&&(qh.detachEvent("onpropertychange",XI),md=qh=null)}function XI(n){if(n.propertyName==="value"&&Wm(md)){var e=[];QI(e,md,n,$2(n)),AI(X8,e)}}function Z8(n,e,t){n==="focusin"?(wC(),qh=e,md=t,qh.attachEvent("onpropertychange",XI)):n==="focusout"&&wC()}function eN(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Wm(md)}function tN(n,e){if(n==="click")return Wm(e)}function nN(n,e){if(n==="input"||n==="change")return Wm(e)}function rN(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Di=typeof Object.is=="function"?Object.is:rN;function _d(n,e){if(Di(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var i=t[r];if(!zv.call(e,i)||!Di(n[i],e[i]))return!1}return!0}function EC(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function SC(n,e){var t=EC(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=EC(t)}}function JI(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?JI(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function ZI(){for(var n=window,e=xg();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=xg(n.document)}return e}function tw(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function iN(n){var e=ZI(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&JI(t.ownerDocument.documentElement,t)){if(r!==null&&tw(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!n.extend&&s>r&&(i=r,r=s,s=i),i=SC(t,s);var o=SC(t,r);i&&o&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),s>r?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var sN=Hs&&"documentMode"in document&&11>=document.documentMode,mu=null,o1=null,Kh=null,a1=!1;function CC(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;a1||mu==null||mu!==xg(r)||(r=mu,"selectionStart"in r&&tw(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Kh&&_d(Kh,r)||(Kh=r,r=Lg(o1,"onSelect"),0<r.length&&(e=new J2("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=mu)))}function Lp(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var _u={animationend:Lp("Animation","AnimationEnd"),animationiteration:Lp("Animation","AnimationIteration"),animationstart:Lp("Animation","AnimationStart"),transitionend:Lp("Transition","TransitionEnd")},qy={},e6={};Hs&&(e6=document.createElement("div").style,"AnimationEvent"in window||(delete _u.animationend.animation,delete _u.animationiteration.animation,delete _u.animationstart.animation),"TransitionEvent"in window||delete _u.transitionend.transition);function Hm(n){if(qy[n])return qy[n];if(!_u[n])return n;var e=_u[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in e6)return qy[n]=e[t];return n}var t6=Hm("animationend"),n6=Hm("animationiteration"),r6=Hm("animationstart"),i6=Hm("transitionend"),s6=new Map,TC="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function aa(n,e){s6.set(n,e),wl(e,[n])}for(var Ky=0;Ky<TC.length;Ky++){var Qy=TC[Ky],oN=Qy.toLowerCase(),aN=Qy[0].toUpperCase()+Qy.slice(1);aa(oN,"on"+aN)}aa(t6,"onAnimationEnd");aa(n6,"onAnimationIteration");aa(r6,"onAnimationStart");aa("dblclick","onDoubleClick");aa("focusin","onFocus");aa("focusout","onBlur");aa(i6,"onTransitionEnd");Bu("onMouseEnter",["mouseout","mouseover"]);Bu("onMouseLeave",["mouseout","mouseover"]);Bu("onPointerEnter",["pointerout","pointerover"]);Bu("onPointerLeave",["pointerout","pointerover"]);wl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));wl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));wl("onBeforeInput",["compositionend","keypress","textInput","paste"]);wl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));wl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));wl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Oh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),lN=new Set("cancel close invalid load scroll toggle".split(" ").concat(Oh));function IC(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,o8(r,e,void 0,n),n.currentTarget=null}function o6(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,h=l.currentTarget;if(l=l.listener,c!==s&&i.isPropagationStopped())break e;IC(i,l,h),s=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,h=l.currentTarget,l=l.listener,c!==s&&i.isPropagationStopped())break e;IC(i,l,h),s=c}}}if(Ng)throw n=n1,Ng=!1,n1=null,n}function Pt(n,e){var t=e[d1];t===void 0&&(t=e[d1]=new Set);var r=n+"__bubble";t.has(r)||(a6(e,n,2,!1),t.add(r))}function Yy(n,e,t){var r=0;e&&(r|=4),a6(t,n,r,e)}var Fp="_reactListening"+Math.random().toString(36).slice(2);function yd(n){if(!n[Fp]){n[Fp]=!0,pI.forEach(function(t){t!=="selectionchange"&&(lN.has(t)||Yy(t,!1,n),Yy(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Fp]||(e[Fp]=!0,Yy("selectionchange",!1,e))}}function a6(n,e,t,r){switch(WI(e)){case 1:var i=S8;break;case 4:i=C8;break;default:i=Y2}t=i.bind(null,e,t,n),i=void 0,!t1||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function Xy(n,e,t,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=Qa(l),o===null)return;if(c=o.tag,c===5||c===6){r=s=o;continue e}l=l.parentNode}}r=r.return}AI(function(){var h=s,p=$2(t),m=[];e:{var _=s6.get(n);if(_!==void 0){var w=J2,S=n;switch(n){case"keypress":if(lg(t)===0)break e;case"keydown":case"keyup":w=V8;break;case"focusin":S="focus",w=Wy;break;case"focusout":S="blur",w=Wy;break;case"beforeblur":case"afterblur":w=Wy;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=fC;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=P8;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=z8;break;case t6:case n6:case r6:w=x8;break;case i6:w=G8;break;case"scroll":w=T8;break;case"wheel":w=H8;break;case"copy":case"cut":case"paste":w=N8;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=gC}var k=(e&4)!==0,N=!k&&n==="scroll",x=k?_!==null?_+"Capture":null:_;k=[];for(var R=h,E;R!==null;){E=R;var P=E.stateNode;if(E.tag===5&&P!==null&&(E=P,x!==null&&(P=dd(R,x),P!=null&&k.push(vd(R,P,E)))),N)break;R=R.return}0<k.length&&(_=new w(_,S,null,t,p),m.push({event:_,listeners:k}))}}if(!(e&7)){e:{if(_=n==="mouseover"||n==="pointerover",w=n==="mouseout"||n==="pointerout",_&&t!==Zv&&(S=t.relatedTarget||t.fromElement)&&(Qa(S)||S[$s]))break e;if((w||_)&&(_=p.window===p?p:(_=p.ownerDocument)?_.defaultView||_.parentWindow:window,w?(S=t.relatedTarget||t.toElement,w=h,S=S?Qa(S):null,S!==null&&(N=El(S),S!==N||S.tag!==5&&S.tag!==6)&&(S=null)):(w=null,S=h),w!==S)){if(k=fC,P="onMouseLeave",x="onMouseEnter",R="mouse",(n==="pointerout"||n==="pointerover")&&(k=gC,P="onPointerLeave",x="onPointerEnter",R="pointer"),N=w==null?_:yu(w),E=S==null?_:yu(S),_=new k(P,R+"leave",w,t,p),_.target=N,_.relatedTarget=E,P=null,Qa(p)===h&&(k=new k(x,R+"enter",S,t,p),k.target=E,k.relatedTarget=N,P=k),N=P,w&&S)t:{for(k=w,x=S,R=0,E=k;E;E=iu(E))R++;for(E=0,P=x;P;P=iu(P))E++;for(;0<R-E;)k=iu(k),R--;for(;0<E-R;)x=iu(x),E--;for(;R--;){if(k===x||x!==null&&k===x.alternate)break t;k=iu(k),x=iu(x)}k=null}else k=null;w!==null&&PC(m,_,w,k,!1),S!==null&&N!==null&&PC(m,N,S,k,!0)}}e:{if(_=h?yu(h):window,w=_.nodeName&&_.nodeName.toLowerCase(),w==="select"||w==="input"&&_.type==="file")var V=J8;else if(yC(_))if(YI)V=nN;else{V=eN;var B=Z8}else(w=_.nodeName)&&w.toLowerCase()==="input"&&(_.type==="checkbox"||_.type==="radio")&&(V=tN);if(V&&(V=V(n,h))){QI(m,V,t,p);break e}B&&B(n,_,h),n==="focusout"&&(B=_._wrapperState)&&B.controlled&&_.type==="number"&&Kv(_,"number",_.value)}switch(B=h?yu(h):window,n){case"focusin":(yC(B)||B.contentEditable==="true")&&(mu=B,o1=h,Kh=null);break;case"focusout":Kh=o1=mu=null;break;case"mousedown":a1=!0;break;case"contextmenu":case"mouseup":case"dragend":a1=!1,CC(m,t,p);break;case"selectionchange":if(sN)break;case"keydown":case"keyup":CC(m,t,p)}var D;if(ew)e:{switch(n){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else gu?qI(n,t)&&(T="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(T="onCompositionStart");T&&($I&&t.locale!=="ko"&&(gu||T!=="onCompositionStart"?T==="onCompositionEnd"&&gu&&(D=HI()):(bo=p,X2="value"in bo?bo.value:bo.textContent,gu=!0)),B=Lg(h,T),0<B.length&&(T=new pC(T,n,null,t,p),m.push({event:T,listeners:B}),D?T.data=D:(D=KI(t),D!==null&&(T.data=D)))),(D=q8?K8(n,t):Q8(n,t))&&(h=Lg(h,"onBeforeInput"),0<h.length&&(p=new pC("onBeforeInput","beforeinput",null,t,p),m.push({event:p,listeners:h}),p.data=D))}o6(m,e)})}function vd(n,e,t){return{instance:n,listener:e,currentTarget:t}}function Lg(n,e){for(var t=e+"Capture",r=[];n!==null;){var i=n,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=dd(n,t),s!=null&&r.unshift(vd(n,s,i)),s=dd(n,e),s!=null&&r.push(vd(n,s,i))),n=n.return}return r}function iu(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function PC(n,e,t,r,i){for(var s=e._reactName,o=[];t!==null&&t!==r;){var l=t,c=l.alternate,h=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&h!==null&&(l=h,i?(c=dd(t,s),c!=null&&o.unshift(vd(t,c,l))):i||(c=dd(t,s),c!=null&&o.push(vd(t,c,l)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var uN=/\r\n?/g,cN=/\u0000|\uFFFD/g;function kC(n){return(typeof n=="string"?n:""+n).replace(uN,`
`).replace(cN,"")}function Vp(n,e,t){if(e=kC(e),kC(n)!==e&&t)throw Error(re(425))}function Fg(){}var l1=null,u1=null;function c1(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var h1=typeof setTimeout=="function"?setTimeout:void 0,hN=typeof clearTimeout=="function"?clearTimeout:void 0,RC=typeof Promise=="function"?Promise:void 0,dN=typeof queueMicrotask=="function"?queueMicrotask:typeof RC<"u"?function(n){return RC.resolve(null).then(n).catch(fN)}:h1;function fN(n){setTimeout(function(){throw n})}function Jy(n,e){var t=e,r=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(r===0){n.removeChild(i),gd(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=i}while(t);gd(e)}function Uo(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function xC(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var pc=Math.random().toString(36).slice(2),es="__reactFiber$"+pc,wd="__reactProps$"+pc,$s="__reactContainer$"+pc,d1="__reactEvents$"+pc,pN="__reactListeners$"+pc,gN="__reactHandles$"+pc;function Qa(n){var e=n[es];if(e)return e;for(var t=n.parentNode;t;){if(e=t[$s]||t[es]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=xC(n);n!==null;){if(t=n[es])return t;n=xC(n)}return e}n=t,t=n.parentNode}return null}function Jd(n){return n=n[es]||n[$s],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function yu(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(re(33))}function $m(n){return n[wd]||null}var f1=[],vu=-1;function la(n){return{current:n}}function kt(n){0>vu||(n.current=f1[vu],f1[vu]=null,vu--)}function Ct(n,e){vu++,f1[vu]=n.current,n.current=e}var Xo={},or=la(Xo),Mr=la(!1),il=Xo;function zu(n,e){var t=n.type.contextTypes;if(!t)return Xo;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in t)i[s]=e[s];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function Or(n){return n=n.childContextTypes,n!=null}function Vg(){kt(Mr),kt(or)}function AC(n,e,t){if(or.current!==Xo)throw Error(re(168));Ct(or,e),Ct(Mr,t)}function l6(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(re(108,ZA(n)||"Unknown",i));return Ft({},t,r)}function Ug(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Xo,il=or.current,Ct(or,n),Ct(Mr,Mr.current),!0}function NC(n,e,t){var r=n.stateNode;if(!r)throw Error(re(169));t?(n=l6(n,e,il),r.__reactInternalMemoizedMergedChildContext=n,kt(Mr),kt(or),Ct(or,n)):kt(Mr),Ct(Mr,t)}var bs=null,qm=!1,Zy=!1;function u6(n){bs===null?bs=[n]:bs.push(n)}function mN(n){qm=!0,u6(n)}function ua(){if(!Zy&&bs!==null){Zy=!0;var n=0,e=ct;try{var t=bs;for(ct=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}bs=null,qm=!1}catch(i){throw bs!==null&&(bs=bs.slice(n+1)),MI(q2,ua),i}finally{ct=e,Zy=!1}}return null}var wu=[],Eu=0,Bg=null,zg=0,ni=[],ri=0,sl=null,Ms=1,Os="";function Wa(n,e){wu[Eu++]=zg,wu[Eu++]=Bg,Bg=n,zg=e}function c6(n,e,t){ni[ri++]=Ms,ni[ri++]=Os,ni[ri++]=sl,sl=n;var r=Ms;n=Os;var i=32-Ri(r)-1;r&=~(1<<i),t+=1;var s=32-Ri(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Ms=1<<32-Ri(e)+i|t<<i|r,Os=s+n}else Ms=1<<s|t<<i|r,Os=n}function nw(n){n.return!==null&&(Wa(n,1),c6(n,1,0))}function rw(n){for(;n===Bg;)Bg=wu[--Eu],wu[Eu]=null,zg=wu[--Eu],wu[Eu]=null;for(;n===sl;)sl=ni[--ri],ni[ri]=null,Os=ni[--ri],ni[ri]=null,Ms=ni[--ri],ni[ri]=null}var jr=null,Br=null,xt=!1,Ti=null;function h6(n,e){var t=ii(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function bC(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,jr=n,Br=Uo(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,jr=n,Br=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=sl!==null?{id:Ms,overflow:Os}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=ii(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,jr=n,Br=null,!0):!1;default:return!1}}function p1(n){return(n.mode&1)!==0&&(n.flags&128)===0}function g1(n){if(xt){var e=Br;if(e){var t=e;if(!bC(n,e)){if(p1(n))throw Error(re(418));e=Uo(t.nextSibling);var r=jr;e&&bC(n,e)?h6(r,t):(n.flags=n.flags&-4097|2,xt=!1,jr=n)}}else{if(p1(n))throw Error(re(418));n.flags=n.flags&-4097|2,xt=!1,jr=n}}}function DC(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;jr=n}function Up(n){if(n!==jr)return!1;if(!xt)return DC(n),xt=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!c1(n.type,n.memoizedProps)),e&&(e=Br)){if(p1(n))throw d6(),Error(re(418));for(;e;)h6(n,e),e=Uo(e.nextSibling)}if(DC(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(re(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Br=Uo(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Br=null}}else Br=jr?Uo(n.stateNode.nextSibling):null;return!0}function d6(){for(var n=Br;n;)n=Uo(n.nextSibling)}function ju(){Br=jr=null,xt=!1}function iw(n){Ti===null?Ti=[n]:Ti.push(n)}var _N=eo.ReactCurrentBatchConfig;function wh(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(re(309));var r=t.stateNode}if(!r)throw Error(re(147,n));var i=r,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},e._stringRef=s,e)}if(typeof n!="string")throw Error(re(284));if(!t._owner)throw Error(re(290,n))}return n}function Bp(n,e){throw n=Object.prototype.toString.call(e),Error(re(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function MC(n){var e=n._init;return e(n._payload)}function f6(n){function e(x,R){if(n){var E=x.deletions;E===null?(x.deletions=[R],x.flags|=16):E.push(R)}}function t(x,R){if(!n)return null;for(;R!==null;)e(x,R),R=R.sibling;return null}function r(x,R){for(x=new Map;R!==null;)R.key!==null?x.set(R.key,R):x.set(R.index,R),R=R.sibling;return x}function i(x,R){return x=Go(x,R),x.index=0,x.sibling=null,x}function s(x,R,E){return x.index=E,n?(E=x.alternate,E!==null?(E=E.index,E<R?(x.flags|=2,R):E):(x.flags|=2,R)):(x.flags|=1048576,R)}function o(x){return n&&x.alternate===null&&(x.flags|=2),x}function l(x,R,E,P){return R===null||R.tag!==6?(R=ov(E,x.mode,P),R.return=x,R):(R=i(R,E),R.return=x,R)}function c(x,R,E,P){var V=E.type;return V===pu?p(x,R,E.props.children,P,E.key):R!==null&&(R.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===Io&&MC(V)===R.type)?(P=i(R,E.props),P.ref=wh(x,R,E),P.return=x,P):(P=gg(E.type,E.key,E.props,null,x.mode,P),P.ref=wh(x,R,E),P.return=x,P)}function h(x,R,E,P){return R===null||R.tag!==4||R.stateNode.containerInfo!==E.containerInfo||R.stateNode.implementation!==E.implementation?(R=av(E,x.mode,P),R.return=x,R):(R=i(R,E.children||[]),R.return=x,R)}function p(x,R,E,P,V){return R===null||R.tag!==7?(R=nl(E,x.mode,P,V),R.return=x,R):(R=i(R,E),R.return=x,R)}function m(x,R,E){if(typeof R=="string"&&R!==""||typeof R=="number")return R=ov(""+R,x.mode,E),R.return=x,R;if(typeof R=="object"&&R!==null){switch(R.$$typeof){case xp:return E=gg(R.type,R.key,R.props,null,x.mode,E),E.ref=wh(x,null,R),E.return=x,E;case fu:return R=av(R,x.mode,E),R.return=x,R;case Io:var P=R._init;return m(x,P(R._payload),E)}if(Dh(R)||gh(R))return R=nl(R,x.mode,E,null),R.return=x,R;Bp(x,R)}return null}function _(x,R,E,P){var V=R!==null?R.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return V!==null?null:l(x,R,""+E,P);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case xp:return E.key===V?c(x,R,E,P):null;case fu:return E.key===V?h(x,R,E,P):null;case Io:return V=E._init,_(x,R,V(E._payload),P)}if(Dh(E)||gh(E))return V!==null?null:p(x,R,E,P,null);Bp(x,E)}return null}function w(x,R,E,P,V){if(typeof P=="string"&&P!==""||typeof P=="number")return x=x.get(E)||null,l(R,x,""+P,V);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case xp:return x=x.get(P.key===null?E:P.key)||null,c(R,x,P,V);case fu:return x=x.get(P.key===null?E:P.key)||null,h(R,x,P,V);case Io:var B=P._init;return w(x,R,E,B(P._payload),V)}if(Dh(P)||gh(P))return x=x.get(E)||null,p(R,x,P,V,null);Bp(R,P)}return null}function S(x,R,E,P){for(var V=null,B=null,D=R,T=R=0,b=null;D!==null&&T<E.length;T++){D.index>T?(b=D,D=null):b=D.sibling;var A=_(x,D,E[T],P);if(A===null){D===null&&(D=b);break}n&&D&&A.alternate===null&&e(x,D),R=s(A,R,T),B===null?V=A:B.sibling=A,B=A,D=b}if(T===E.length)return t(x,D),xt&&Wa(x,T),V;if(D===null){for(;T<E.length;T++)D=m(x,E[T],P),D!==null&&(R=s(D,R,T),B===null?V=D:B.sibling=D,B=D);return xt&&Wa(x,T),V}for(D=r(x,D);T<E.length;T++)b=w(D,x,T,E[T],P),b!==null&&(n&&b.alternate!==null&&D.delete(b.key===null?T:b.key),R=s(b,R,T),B===null?V=b:B.sibling=b,B=b);return n&&D.forEach(function(O){return e(x,O)}),xt&&Wa(x,T),V}function k(x,R,E,P){var V=gh(E);if(typeof V!="function")throw Error(re(150));if(E=V.call(E),E==null)throw Error(re(151));for(var B=V=null,D=R,T=R=0,b=null,A=E.next();D!==null&&!A.done;T++,A=E.next()){D.index>T?(b=D,D=null):b=D.sibling;var O=_(x,D,A.value,P);if(O===null){D===null&&(D=b);break}n&&D&&O.alternate===null&&e(x,D),R=s(O,R,T),B===null?V=O:B.sibling=O,B=O,D=b}if(A.done)return t(x,D),xt&&Wa(x,T),V;if(D===null){for(;!A.done;T++,A=E.next())A=m(x,A.value,P),A!==null&&(R=s(A,R,T),B===null?V=A:B.sibling=A,B=A);return xt&&Wa(x,T),V}for(D=r(x,D);!A.done;T++,A=E.next())A=w(D,x,T,A.value,P),A!==null&&(n&&A.alternate!==null&&D.delete(A.key===null?T:A.key),R=s(A,R,T),B===null?V=A:B.sibling=A,B=A);return n&&D.forEach(function(U){return e(x,U)}),xt&&Wa(x,T),V}function N(x,R,E,P){if(typeof E=="object"&&E!==null&&E.type===pu&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case xp:e:{for(var V=E.key,B=R;B!==null;){if(B.key===V){if(V=E.type,V===pu){if(B.tag===7){t(x,B.sibling),R=i(B,E.props.children),R.return=x,x=R;break e}}else if(B.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===Io&&MC(V)===B.type){t(x,B.sibling),R=i(B,E.props),R.ref=wh(x,B,E),R.return=x,x=R;break e}t(x,B);break}else e(x,B);B=B.sibling}E.type===pu?(R=nl(E.props.children,x.mode,P,E.key),R.return=x,x=R):(P=gg(E.type,E.key,E.props,null,x.mode,P),P.ref=wh(x,R,E),P.return=x,x=P)}return o(x);case fu:e:{for(B=E.key;R!==null;){if(R.key===B)if(R.tag===4&&R.stateNode.containerInfo===E.containerInfo&&R.stateNode.implementation===E.implementation){t(x,R.sibling),R=i(R,E.children||[]),R.return=x,x=R;break e}else{t(x,R);break}else e(x,R);R=R.sibling}R=av(E,x.mode,P),R.return=x,x=R}return o(x);case Io:return B=E._init,N(x,R,B(E._payload),P)}if(Dh(E))return S(x,R,E,P);if(gh(E))return k(x,R,E,P);Bp(x,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,R!==null&&R.tag===6?(t(x,R.sibling),R=i(R,E),R.return=x,x=R):(t(x,R),R=ov(E,x.mode,P),R.return=x,x=R),o(x)):t(x,R)}return N}var Gu=f6(!0),p6=f6(!1),jg=la(null),Gg=null,Su=null,sw=null;function ow(){sw=Su=Gg=null}function aw(n){var e=jg.current;kt(jg),n._currentValue=e}function m1(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function Nu(n,e){Gg=n,sw=Su=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Nr=!0),n.firstContext=null)}function li(n){var e=n._currentValue;if(sw!==n)if(n={context:n,memoizedValue:e,next:null},Su===null){if(Gg===null)throw Error(re(308));Su=n,Gg.dependencies={lanes:0,firstContext:n}}else Su=Su.next=n;return e}var Ya=null;function lw(n){Ya===null?Ya=[n]:Ya.push(n)}function g6(n,e,t,r){var i=e.interleaved;return i===null?(t.next=t,lw(e)):(t.next=i.next,i.next=t),e.interleaved=t,qs(n,r)}function qs(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Po=!1;function uw(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function m6(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Bs(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Bo(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,tt&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,qs(n,t)}return i=r.interleaved,i===null?(e.next=e,lw(r)):(e.next=i.next,i.next=e),r.interleaved=e,qs(n,t)}function ug(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,K2(n,t)}}function OC(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var i=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?i=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?i=s=e:s=s.next=e}else i=s=e;t={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Wg(n,e,t,r){var i=n.updateQueue;Po=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,h=c.next;c.next=null,o===null?s=h:o.next=h,o=c;var p=n.alternate;p!==null&&(p=p.updateQueue,l=p.lastBaseUpdate,l!==o&&(l===null?p.firstBaseUpdate=h:l.next=h,p.lastBaseUpdate=c))}if(s!==null){var m=i.baseState;o=0,p=h=c=null,l=s;do{var _=l.lane,w=l.eventTime;if((r&_)===_){p!==null&&(p=p.next={eventTime:w,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var S=n,k=l;switch(_=e,w=t,k.tag){case 1:if(S=k.payload,typeof S=="function"){m=S.call(w,m,_);break e}m=S;break e;case 3:S.flags=S.flags&-65537|128;case 0:if(S=k.payload,_=typeof S=="function"?S.call(w,m,_):S,_==null)break e;m=Ft({},m,_);break e;case 2:Po=!0}}l.callback!==null&&l.lane!==0&&(n.flags|=64,_=i.effects,_===null?i.effects=[l]:_.push(l))}else w={eventTime:w,lane:_,tag:l.tag,payload:l.payload,callback:l.callback,next:null},p===null?(h=p=w,c=m):p=p.next=w,o|=_;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;_=l,l=_.next,_.next=null,i.lastBaseUpdate=_,i.shared.pending=null}}while(!0);if(p===null&&(c=m),i.baseState=c,i.firstBaseUpdate=h,i.lastBaseUpdate=p,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);al|=o,n.lanes=o,n.memoizedState=m}}function LC(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],i=r.callback;if(i!==null){if(r.callback=null,r=t,typeof i!="function")throw Error(re(191,i));i.call(r)}}}var Zd={},is=la(Zd),Ed=la(Zd),Sd=la(Zd);function Xa(n){if(n===Zd)throw Error(re(174));return n}function cw(n,e){switch(Ct(Sd,e),Ct(Ed,n),Ct(is,Zd),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Yv(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=Yv(e,n)}kt(is),Ct(is,e)}function Wu(){kt(is),kt(Ed),kt(Sd)}function _6(n){Xa(Sd.current);var e=Xa(is.current),t=Yv(e,n.type);e!==t&&(Ct(Ed,n),Ct(is,t))}function hw(n){Ed.current===n&&(kt(is),kt(Ed))}var Dt=la(0);function Hg(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ev=[];function dw(){for(var n=0;n<ev.length;n++)ev[n]._workInProgressVersionPrimary=null;ev.length=0}var cg=eo.ReactCurrentDispatcher,tv=eo.ReactCurrentBatchConfig,ol=0,Lt=null,ln=null,Sn=null,$g=!1,Qh=!1,Cd=0,yN=0;function Jn(){throw Error(re(321))}function fw(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Di(n[t],e[t]))return!1;return!0}function pw(n,e,t,r,i,s){if(ol=s,Lt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,cg.current=n===null||n.memoizedState===null?SN:CN,n=t(r,i),Qh){s=0;do{if(Qh=!1,Cd=0,25<=s)throw Error(re(301));s+=1,Sn=ln=null,e.updateQueue=null,cg.current=TN,n=t(r,i)}while(Qh)}if(cg.current=qg,e=ln!==null&&ln.next!==null,ol=0,Sn=ln=Lt=null,$g=!1,e)throw Error(re(300));return n}function gw(){var n=Cd!==0;return Cd=0,n}function Zi(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Sn===null?Lt.memoizedState=Sn=n:Sn=Sn.next=n,Sn}function ui(){if(ln===null){var n=Lt.alternate;n=n!==null?n.memoizedState:null}else n=ln.next;var e=Sn===null?Lt.memoizedState:Sn.next;if(e!==null)Sn=e,ln=n;else{if(n===null)throw Error(re(310));ln=n,n={memoizedState:ln.memoizedState,baseState:ln.baseState,baseQueue:ln.baseQueue,queue:ln.queue,next:null},Sn===null?Lt.memoizedState=Sn=n:Sn=Sn.next=n}return Sn}function Td(n,e){return typeof e=="function"?e(n):e}function nv(n){var e=ui(),t=e.queue;if(t===null)throw Error(re(311));t.lastRenderedReducer=n;var r=ln,i=r.baseQueue,s=t.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,t.pending=null}if(i!==null){s=i.next,r=r.baseState;var l=o=null,c=null,h=s;do{var p=h.lane;if((ol&p)===p)c!==null&&(c=c.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:n(r,h.action);else{var m={lane:p,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};c===null?(l=c=m,o=r):c=c.next=m,Lt.lanes|=p,al|=p}h=h.next}while(h!==null&&h!==s);c===null?o=r:c.next=l,Di(r,e.memoizedState)||(Nr=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,t.lastRenderedState=r}if(n=t.interleaved,n!==null){i=n;do s=i.lane,Lt.lanes|=s,al|=s,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function rv(n){var e=ui(),t=e.queue;if(t===null)throw Error(re(311));t.lastRenderedReducer=n;var r=t.dispatch,i=t.pending,s=e.memoizedState;if(i!==null){t.pending=null;var o=i=i.next;do s=n(s,o.action),o=o.next;while(o!==i);Di(s,e.memoizedState)||(Nr=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,r]}function y6(){}function v6(n,e){var t=Lt,r=ui(),i=e(),s=!Di(r.memoizedState,i);if(s&&(r.memoizedState=i,Nr=!0),r=r.queue,mw(S6.bind(null,t,r,n),[n]),r.getSnapshot!==e||s||Sn!==null&&Sn.memoizedState.tag&1){if(t.flags|=2048,Id(9,E6.bind(null,t,r,i,e),void 0,null),kn===null)throw Error(re(349));ol&30||w6(t,e,i)}return i}function w6(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Lt.updateQueue,e===null?(e={lastEffect:null,stores:null},Lt.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function E6(n,e,t,r){e.value=t,e.getSnapshot=r,C6(e)&&T6(n)}function S6(n,e,t){return t(function(){C6(e)&&T6(n)})}function C6(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Di(n,t)}catch{return!0}}function T6(n){var e=qs(n,1);e!==null&&xi(e,n,1,-1)}function FC(n){var e=Zi();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Td,lastRenderedState:n},e.queue=n,n=n.dispatch=EN.bind(null,Lt,n),[e.memoizedState,n]}function Id(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=Lt.updateQueue,e===null?(e={lastEffect:null,stores:null},Lt.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function I6(){return ui().memoizedState}function hg(n,e,t,r){var i=Zi();Lt.flags|=n,i.memoizedState=Id(1|e,t,void 0,r===void 0?null:r)}function Km(n,e,t,r){var i=ui();r=r===void 0?null:r;var s=void 0;if(ln!==null){var o=ln.memoizedState;if(s=o.destroy,r!==null&&fw(r,o.deps)){i.memoizedState=Id(e,t,s,r);return}}Lt.flags|=n,i.memoizedState=Id(1|e,t,s,r)}function VC(n,e){return hg(8390656,8,n,e)}function mw(n,e){return Km(2048,8,n,e)}function P6(n,e){return Km(4,2,n,e)}function k6(n,e){return Km(4,4,n,e)}function R6(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function x6(n,e,t){return t=t!=null?t.concat([n]):null,Km(4,4,R6.bind(null,e,n),t)}function _w(){}function A6(n,e){var t=ui();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&fw(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function N6(n,e){var t=ui();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&fw(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function b6(n,e,t){return ol&21?(Di(t,e)||(t=FI(),Lt.lanes|=t,al|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Nr=!0),n.memoizedState=t)}function vN(n,e){var t=ct;ct=t!==0&&4>t?t:4,n(!0);var r=tv.transition;tv.transition={};try{n(!1),e()}finally{ct=t,tv.transition=r}}function D6(){return ui().memoizedState}function wN(n,e,t){var r=jo(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},M6(n))O6(e,t);else if(t=g6(n,e,t,r),t!==null){var i=yr();xi(t,n,r,i),L6(t,e,r)}}function EN(n,e,t){var r=jo(n),i={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(M6(n))O6(e,i);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,l=s(o,t);if(i.hasEagerState=!0,i.eagerState=l,Di(l,o)){var c=e.interleaved;c===null?(i.next=i,lw(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}t=g6(n,e,i,r),t!==null&&(i=yr(),xi(t,n,r,i),L6(t,e,r))}}function M6(n){var e=n.alternate;return n===Lt||e!==null&&e===Lt}function O6(n,e){Qh=$g=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function L6(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,K2(n,t)}}var qg={readContext:li,useCallback:Jn,useContext:Jn,useEffect:Jn,useImperativeHandle:Jn,useInsertionEffect:Jn,useLayoutEffect:Jn,useMemo:Jn,useReducer:Jn,useRef:Jn,useState:Jn,useDebugValue:Jn,useDeferredValue:Jn,useTransition:Jn,useMutableSource:Jn,useSyncExternalStore:Jn,useId:Jn,unstable_isNewReconciler:!1},SN={readContext:li,useCallback:function(n,e){return Zi().memoizedState=[n,e===void 0?null:e],n},useContext:li,useEffect:VC,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,hg(4194308,4,R6.bind(null,e,n),t)},useLayoutEffect:function(n,e){return hg(4194308,4,n,e)},useInsertionEffect:function(n,e){return hg(4,2,n,e)},useMemo:function(n,e){var t=Zi();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=Zi();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=wN.bind(null,Lt,n),[r.memoizedState,n]},useRef:function(n){var e=Zi();return n={current:n},e.memoizedState=n},useState:FC,useDebugValue:_w,useDeferredValue:function(n){return Zi().memoizedState=n},useTransition:function(){var n=FC(!1),e=n[0];return n=vN.bind(null,n[1]),Zi().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=Lt,i=Zi();if(xt){if(t===void 0)throw Error(re(407));t=t()}else{if(t=e(),kn===null)throw Error(re(349));ol&30||w6(r,e,t)}i.memoizedState=t;var s={value:t,getSnapshot:e};return i.queue=s,VC(S6.bind(null,r,s,n),[n]),r.flags|=2048,Id(9,E6.bind(null,r,s,t,e),void 0,null),t},useId:function(){var n=Zi(),e=kn.identifierPrefix;if(xt){var t=Os,r=Ms;t=(r&~(1<<32-Ri(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=Cd++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=yN++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},CN={readContext:li,useCallback:A6,useContext:li,useEffect:mw,useImperativeHandle:x6,useInsertionEffect:P6,useLayoutEffect:k6,useMemo:N6,useReducer:nv,useRef:I6,useState:function(){return nv(Td)},useDebugValue:_w,useDeferredValue:function(n){var e=ui();return b6(e,ln.memoizedState,n)},useTransition:function(){var n=nv(Td)[0],e=ui().memoizedState;return[n,e]},useMutableSource:y6,useSyncExternalStore:v6,useId:D6,unstable_isNewReconciler:!1},TN={readContext:li,useCallback:A6,useContext:li,useEffect:mw,useImperativeHandle:x6,useInsertionEffect:P6,useLayoutEffect:k6,useMemo:N6,useReducer:rv,useRef:I6,useState:function(){return rv(Td)},useDebugValue:_w,useDeferredValue:function(n){var e=ui();return ln===null?e.memoizedState=n:b6(e,ln.memoizedState,n)},useTransition:function(){var n=rv(Td)[0],e=ui().memoizedState;return[n,e]},useMutableSource:y6,useSyncExternalStore:v6,useId:D6,unstable_isNewReconciler:!1};function Si(n,e){if(n&&n.defaultProps){e=Ft({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function _1(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:Ft({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var Qm={isMounted:function(n){return(n=n._reactInternals)?El(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=yr(),i=jo(n),s=Bs(r,i);s.payload=e,t!=null&&(s.callback=t),e=Bo(n,s,i),e!==null&&(xi(e,n,i,r),ug(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=yr(),i=jo(n),s=Bs(r,i);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=Bo(n,s,i),e!==null&&(xi(e,n,i,r),ug(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=yr(),r=jo(n),i=Bs(t,r);i.tag=2,e!=null&&(i.callback=e),e=Bo(n,i,r),e!==null&&(xi(e,n,r,t),ug(e,n,r))}};function UC(n,e,t,r,i,s,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!_d(t,r)||!_d(i,s):!0}function F6(n,e,t){var r=!1,i=Xo,s=e.contextType;return typeof s=="object"&&s!==null?s=li(s):(i=Or(e)?il:or.current,r=e.contextTypes,s=(r=r!=null)?zu(n,i):Xo),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Qm,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=s),e}function BC(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&Qm.enqueueReplaceState(e,e.state,null)}function y1(n,e,t,r){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},uw(n);var s=e.contextType;typeof s=="object"&&s!==null?i.context=li(s):(s=Or(e)?il:or.current,i.context=zu(n,s)),i.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(_1(n,e,s,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Qm.enqueueReplaceState(i,i.state,null),Wg(n,t,i,r),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function Hu(n,e){try{var t="",r=e;do t+=JA(r),r=r.return;while(r);var i=t}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:i,digest:null}}function iv(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function v1(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var IN=typeof WeakMap=="function"?WeakMap:Map;function V6(n,e,t){t=Bs(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){Qg||(Qg=!0,x1=r),v1(n,e)},t}function U6(n,e,t){t=Bs(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;t.payload=function(){return r(i)},t.callback=function(){v1(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){v1(n,e),typeof r!="function"&&(zo===null?zo=new Set([this]):zo.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function zC(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new IN;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(t)||(i.add(t),n=UN.bind(null,n,e,t),e.then(n,n))}function jC(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function GC(n,e,t,r,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Bs(-1,1),e.tag=2,Bo(t,e,1))),t.lanes|=1),n)}var PN=eo.ReactCurrentOwner,Nr=!1;function gr(n,e,t,r){e.child=n===null?p6(e,null,t,r):Gu(e,n.child,t,r)}function WC(n,e,t,r,i){t=t.render;var s=e.ref;return Nu(e,i),r=pw(n,e,t,r,s,i),t=gw(),n!==null&&!Nr?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Ks(n,e,i)):(xt&&t&&nw(e),e.flags|=1,gr(n,e,r,i),e.child)}function HC(n,e,t,r,i){if(n===null){var s=t.type;return typeof s=="function"&&!Iw(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,B6(n,e,s,r,i)):(n=gg(t.type,null,r,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&i)){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:_d,t(o,r)&&n.ref===e.ref)return Ks(n,e,i)}return e.flags|=1,n=Go(s,r),n.ref=e.ref,n.return=e,e.child=n}function B6(n,e,t,r,i){if(n!==null){var s=n.memoizedProps;if(_d(s,r)&&n.ref===e.ref)if(Nr=!1,e.pendingProps=r=s,(n.lanes&i)!==0)n.flags&131072&&(Nr=!0);else return e.lanes=n.lanes,Ks(n,e,i)}return w1(n,e,t,r,i)}function z6(n,e,t){var r=e.pendingProps,i=r.children,s=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ct(Tu,Ur),Ur|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Ct(Tu,Ur),Ur|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:t,Ct(Tu,Ur),Ur|=r}else s!==null?(r=s.baseLanes|t,e.memoizedState=null):r=t,Ct(Tu,Ur),Ur|=r;return gr(n,e,i,t),e.child}function j6(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function w1(n,e,t,r,i){var s=Or(t)?il:or.current;return s=zu(e,s),Nu(e,i),t=pw(n,e,t,r,s,i),r=gw(),n!==null&&!Nr?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Ks(n,e,i)):(xt&&r&&nw(e),e.flags|=1,gr(n,e,t,i),e.child)}function $C(n,e,t,r,i){if(Or(t)){var s=!0;Ug(e)}else s=!1;if(Nu(e,i),e.stateNode===null)dg(n,e),F6(e,t,r),y1(e,t,r,i),r=!0;else if(n===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,h=t.contextType;typeof h=="object"&&h!==null?h=li(h):(h=Or(t)?il:or.current,h=zu(e,h));var p=t.getDerivedStateFromProps,m=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==h)&&BC(e,o,r,h),Po=!1;var _=e.memoizedState;o.state=_,Wg(e,r,o,i),c=e.memoizedState,l!==r||_!==c||Mr.current||Po?(typeof p=="function"&&(_1(e,t,p,r),c=e.memoizedState),(l=Po||UC(e,t,l,r,_,c,h))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=h,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,m6(n,e),l=e.memoizedProps,h=e.type===e.elementType?l:Si(e.type,l),o.props=h,m=e.pendingProps,_=o.context,c=t.contextType,typeof c=="object"&&c!==null?c=li(c):(c=Or(t)?il:or.current,c=zu(e,c));var w=t.getDerivedStateFromProps;(p=typeof w=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==m||_!==c)&&BC(e,o,r,c),Po=!1,_=e.memoizedState,o.state=_,Wg(e,r,o,i);var S=e.memoizedState;l!==m||_!==S||Mr.current||Po?(typeof w=="function"&&(_1(e,t,w,r),S=e.memoizedState),(h=Po||UC(e,t,h,r,_,S,c)||!1)?(p||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,S,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,S,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===n.memoizedProps&&_===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&_===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=S),o.props=r,o.state=S,o.context=c,r=h):(typeof o.componentDidUpdate!="function"||l===n.memoizedProps&&_===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&_===n.memoizedState||(e.flags|=1024),r=!1)}return E1(n,e,t,r,s,i)}function E1(n,e,t,r,i,s){j6(n,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&NC(e,t,!1),Ks(n,e,s);r=e.stateNode,PN.current=e;var l=o&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&o?(e.child=Gu(e,n.child,null,s),e.child=Gu(e,null,l,s)):gr(n,e,l,s),e.memoizedState=r.state,i&&NC(e,t,!0),e.child}function G6(n){var e=n.stateNode;e.pendingContext?AC(n,e.pendingContext,e.pendingContext!==e.context):e.context&&AC(n,e.context,!1),cw(n,e.containerInfo)}function qC(n,e,t,r,i){return ju(),iw(i),e.flags|=256,gr(n,e,t,r),e.child}var S1={dehydrated:null,treeContext:null,retryLane:0};function C1(n){return{baseLanes:n,cachePool:null,transitions:null}}function W6(n,e,t){var r=e.pendingProps,i=Dt.current,s=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=n!==null&&n.memoizedState===null?!1:(i&2)!==0),l?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),Ct(Dt,i&1),n===null)return g1(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,n=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Jm(o,r,0,null),n=nl(n,r,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=C1(t),e.memoizedState=S1,n):yw(e,o));if(i=n.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return kN(n,e,o,r,l,i,t);if(s){s=r.fallback,o=e.mode,i=n.child,l=i.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Go(i,c),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=Go(l,s):(s=nl(s,o,t,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=n.child.memoizedState,o=o===null?C1(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=n.childLanes&~t,e.memoizedState=S1,r}return s=n.child,n=s.sibling,r=Go(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function yw(n,e){return e=Jm({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function zp(n,e,t,r){return r!==null&&iw(r),Gu(e,n.child,null,t),n=yw(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function kN(n,e,t,r,i,s,o){if(t)return e.flags&256?(e.flags&=-257,r=iv(Error(re(422))),zp(n,e,o,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Jm({mode:"visible",children:r.children},i,0,null),s=nl(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Gu(e,n.child,null,o),e.child.memoizedState=C1(o),e.memoizedState=S1,s);if(!(e.mode&1))return zp(n,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error(re(419)),r=iv(s,r,void 0),zp(n,e,o,r)}if(l=(o&n.childLanes)!==0,Nr||l){if(r=kn,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,qs(n,i),xi(r,n,i,-1))}return Tw(),r=iv(Error(re(421))),zp(n,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=BN.bind(null,n),i._reactRetry=e,null):(n=s.treeContext,Br=Uo(i.nextSibling),jr=e,xt=!0,Ti=null,n!==null&&(ni[ri++]=Ms,ni[ri++]=Os,ni[ri++]=sl,Ms=n.id,Os=n.overflow,sl=e),e=yw(e,r.children),e.flags|=4096,e)}function KC(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),m1(n.return,e,t)}function sv(n,e,t,r,i){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=t,s.tailMode=i)}function H6(n,e,t){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(gr(n,e,r.children,t),r=Dt.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&KC(n,t,e);else if(n.tag===19)KC(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(Ct(Dt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&Hg(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),sv(e,!1,i,t,s);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&Hg(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}sv(e,!0,t,null,s);break;case"together":sv(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function dg(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Ks(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),al|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(re(153));if(e.child!==null){for(n=e.child,t=Go(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Go(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function RN(n,e,t){switch(e.tag){case 3:G6(e),ju();break;case 5:_6(e);break;case 1:Or(e.type)&&Ug(e);break;case 4:cw(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Ct(jg,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ct(Dt,Dt.current&1),e.flags|=128,null):t&e.child.childLanes?W6(n,e,t):(Ct(Dt,Dt.current&1),n=Ks(n,e,t),n!==null?n.sibling:null);Ct(Dt,Dt.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return H6(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ct(Dt,Dt.current),r)break;return null;case 22:case 23:return e.lanes=0,z6(n,e,t)}return Ks(n,e,t)}var $6,T1,q6,K6;$6=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};T1=function(){};q6=function(n,e,t,r){var i=n.memoizedProps;if(i!==r){n=e.stateNode,Xa(is.current);var s=null;switch(t){case"input":i=$v(n,i),r=$v(n,r),s=[];break;case"select":i=Ft({},i,{value:void 0}),r=Ft({},r,{value:void 0}),s=[];break;case"textarea":i=Qv(n,i),r=Qv(n,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=Fg)}Xv(t,r);var o;t=null;for(h in i)if(!r.hasOwnProperty(h)&&i.hasOwnProperty(h)&&i[h]!=null)if(h==="style"){var l=i[h];for(o in l)l.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(cd.hasOwnProperty(h)?s||(s=[]):(s=s||[]).push(h,null));for(h in r){var c=r[h];if(l=i!=null?i[h]:void 0,r.hasOwnProperty(h)&&c!==l&&(c!=null||l!=null))if(h==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(t||(t={}),t[o]=c[o])}else t||(s||(s=[]),s.push(h,t)),t=c;else h==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(h,c)):h==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(h,""+c):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(cd.hasOwnProperty(h)?(c!=null&&h==="onScroll"&&Pt("scroll",n),s||l===c||(s=[])):(s=s||[]).push(h,c))}t&&(s=s||[]).push("style",t);var h=s;(e.updateQueue=h)&&(e.flags|=4)}};K6=function(n,e,t,r){t!==r&&(e.flags|=4)};function Eh(n,e){if(!xt)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function Zn(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function xN(n,e,t){var r=e.pendingProps;switch(rw(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zn(e),null;case 1:return Or(e.type)&&Vg(),Zn(e),null;case 3:return r=e.stateNode,Wu(),kt(Mr),kt(or),dw(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(Up(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ti!==null&&(b1(Ti),Ti=null))),T1(n,e),Zn(e),null;case 5:hw(e);var i=Xa(Sd.current);if(t=e.type,n!==null&&e.stateNode!=null)q6(n,e,t,r,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(re(166));return Zn(e),null}if(n=Xa(is.current),Up(e)){r=e.stateNode,t=e.type;var s=e.memoizedProps;switch(r[es]=e,r[wd]=s,n=(e.mode&1)!==0,t){case"dialog":Pt("cancel",r),Pt("close",r);break;case"iframe":case"object":case"embed":Pt("load",r);break;case"video":case"audio":for(i=0;i<Oh.length;i++)Pt(Oh[i],r);break;case"source":Pt("error",r);break;case"img":case"image":case"link":Pt("error",r),Pt("load",r);break;case"details":Pt("toggle",r);break;case"input":rC(r,s),Pt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Pt("invalid",r);break;case"textarea":sC(r,s),Pt("invalid",r)}Xv(t,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&Vp(r.textContent,l,n),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&Vp(r.textContent,l,n),i=["children",""+l]):cd.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Pt("scroll",r)}switch(t){case"input":Ap(r),iC(r,s,!0);break;case"textarea":Ap(r),oC(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Fg)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=SI(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=o.createElement(t,{is:r.is}):(n=o.createElement(t),t==="select"&&(o=n,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):n=o.createElementNS(n,t),n[es]=e,n[wd]=r,$6(n,e,!1,!1),e.stateNode=n;e:{switch(o=Jv(t,r),t){case"dialog":Pt("cancel",n),Pt("close",n),i=r;break;case"iframe":case"object":case"embed":Pt("load",n),i=r;break;case"video":case"audio":for(i=0;i<Oh.length;i++)Pt(Oh[i],n);i=r;break;case"source":Pt("error",n),i=r;break;case"img":case"image":case"link":Pt("error",n),Pt("load",n),i=r;break;case"details":Pt("toggle",n),i=r;break;case"input":rC(n,r),i=$v(n,r),Pt("invalid",n);break;case"option":i=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},i=Ft({},r,{value:void 0}),Pt("invalid",n);break;case"textarea":sC(n,r),i=Qv(n,r),Pt("invalid",n);break;default:i=r}Xv(t,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?II(n,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&CI(n,c)):s==="children"?typeof c=="string"?(t!=="textarea"||c!=="")&&hd(n,c):typeof c=="number"&&hd(n,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(cd.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Pt("scroll",n):c!=null&&j2(n,s,c,o))}switch(t){case"input":Ap(n),iC(n,r,!1);break;case"textarea":Ap(n),oC(n);break;case"option":r.value!=null&&n.setAttribute("value",""+Yo(r.value));break;case"select":n.multiple=!!r.multiple,s=r.value,s!=null?ku(n,!!r.multiple,s,!1):r.defaultValue!=null&&ku(n,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=Fg)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Zn(e),null;case 6:if(n&&e.stateNode!=null)K6(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(re(166));if(t=Xa(Sd.current),Xa(is.current),Up(e)){if(r=e.stateNode,t=e.memoizedProps,r[es]=e,(s=r.nodeValue!==t)&&(n=jr,n!==null))switch(n.tag){case 3:Vp(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Vp(r.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[es]=e,e.stateNode=r}return Zn(e),null;case 13:if(kt(Dt),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(xt&&Br!==null&&e.mode&1&&!(e.flags&128))d6(),ju(),e.flags|=98560,s=!1;else if(s=Up(e),r!==null&&r.dehydrated!==null){if(n===null){if(!s)throw Error(re(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(re(317));s[es]=e}else ju(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Zn(e),s=!1}else Ti!==null&&(b1(Ti),Ti=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||Dt.current&1?un===0&&(un=3):Tw())),e.updateQueue!==null&&(e.flags|=4),Zn(e),null);case 4:return Wu(),T1(n,e),n===null&&yd(e.stateNode.containerInfo),Zn(e),null;case 10:return aw(e.type._context),Zn(e),null;case 17:return Or(e.type)&&Vg(),Zn(e),null;case 19:if(kt(Dt),s=e.memoizedState,s===null)return Zn(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Eh(s,!1);else{if(un!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=Hg(n),o!==null){for(e.flags|=128,Eh(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)s=t,n=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,n=o.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Ct(Dt,Dt.current&1|2),e.child}n=n.sibling}s.tail!==null&&Ht()>$u&&(e.flags|=128,r=!0,Eh(s,!1),e.lanes=4194304)}else{if(!r)if(n=Hg(o),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Eh(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!xt)return Zn(e),null}else 2*Ht()-s.renderingStartTime>$u&&t!==1073741824&&(e.flags|=128,r=!0,Eh(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(t=s.last,t!==null?t.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Ht(),e.sibling=null,t=Dt.current,Ct(Dt,r?t&1|2:t&1),e):(Zn(e),null);case 22:case 23:return Cw(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Ur&1073741824&&(Zn(e),e.subtreeFlags&6&&(e.flags|=8192)):Zn(e),null;case 24:return null;case 25:return null}throw Error(re(156,e.tag))}function AN(n,e){switch(rw(e),e.tag){case 1:return Or(e.type)&&Vg(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Wu(),kt(Mr),kt(or),dw(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return hw(e),null;case 13:if(kt(Dt),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(re(340));ju()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return kt(Dt),null;case 4:return Wu(),null;case 10:return aw(e.type._context),null;case 22:case 23:return Cw(),null;case 24:return null;default:return null}}var jp=!1,nr=!1,NN=typeof WeakSet=="function"?WeakSet:Set,ge=null;function Cu(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){Ut(n,e,r)}else t.current=null}function I1(n,e,t){try{t()}catch(r){Ut(n,e,r)}}var QC=!1;function bN(n,e){if(l1=Mg,n=ZI(),tw(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,l=-1,c=-1,h=0,p=0,m=n,_=null;t:for(;;){for(var w;m!==t||i!==0&&m.nodeType!==3||(l=o+i),m!==s||r!==0&&m.nodeType!==3||(c=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(w=m.firstChild)!==null;)_=m,m=w;for(;;){if(m===n)break t;if(_===t&&++h===i&&(l=o),_===s&&++p===r&&(c=o),(w=m.nextSibling)!==null)break;m=_,_=m.parentNode}m=w}t=l===-1||c===-1?null:{start:l,end:c}}else t=null}t=t||{start:0,end:0}}else t=null;for(u1={focusedElem:n,selectionRange:t},Mg=!1,ge=e;ge!==null;)if(e=ge,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,ge=n;else for(;ge!==null;){e=ge;try{var S=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(S!==null){var k=S.memoizedProps,N=S.memoizedState,x=e.stateNode,R=x.getSnapshotBeforeUpdate(e.elementType===e.type?k:Si(e.type,k),N);x.__reactInternalSnapshotBeforeUpdate=R}break;case 3:var E=e.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(re(163))}}catch(P){Ut(e,e.return,P)}if(n=e.sibling,n!==null){n.return=e.return,ge=n;break}ge=e.return}return S=QC,QC=!1,S}function Yh(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&n)===n){var s=i.destroy;i.destroy=void 0,s!==void 0&&I1(e,t,s)}i=i.next}while(i!==r)}}function Ym(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function P1(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function Q6(n){var e=n.alternate;e!==null&&(n.alternate=null,Q6(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[es],delete e[wd],delete e[d1],delete e[pN],delete e[gN])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function Y6(n){return n.tag===5||n.tag===3||n.tag===4}function YC(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Y6(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function k1(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Fg));else if(r!==4&&(n=n.child,n!==null))for(k1(n,e,t),n=n.sibling;n!==null;)k1(n,e,t),n=n.sibling}function R1(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(R1(n,e,t),n=n.sibling;n!==null;)R1(n,e,t),n=n.sibling}var Fn=null,Ci=!1;function Eo(n,e,t){for(t=t.child;t!==null;)X6(n,e,t),t=t.sibling}function X6(n,e,t){if(rs&&typeof rs.onCommitFiberUnmount=="function")try{rs.onCommitFiberUnmount(jm,t)}catch{}switch(t.tag){case 5:nr||Cu(t,e);case 6:var r=Fn,i=Ci;Fn=null,Eo(n,e,t),Fn=r,Ci=i,Fn!==null&&(Ci?(n=Fn,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):Fn.removeChild(t.stateNode));break;case 18:Fn!==null&&(Ci?(n=Fn,t=t.stateNode,n.nodeType===8?Jy(n.parentNode,t):n.nodeType===1&&Jy(n,t),gd(n)):Jy(Fn,t.stateNode));break;case 4:r=Fn,i=Ci,Fn=t.stateNode.containerInfo,Ci=!0,Eo(n,e,t),Fn=r,Ci=i;break;case 0:case 11:case 14:case 15:if(!nr&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&I1(t,e,o),i=i.next}while(i!==r)}Eo(n,e,t);break;case 1:if(!nr&&(Cu(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(l){Ut(t,e,l)}Eo(n,e,t);break;case 21:Eo(n,e,t);break;case 22:t.mode&1?(nr=(r=nr)||t.memoizedState!==null,Eo(n,e,t),nr=r):Eo(n,e,t);break;default:Eo(n,e,t)}}function XC(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new NN),e.forEach(function(r){var i=zN.bind(null,n,r);t.has(r)||(t.add(r),r.then(i,i))})}}function wi(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];try{var s=n,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Fn=l.stateNode,Ci=!1;break e;case 3:Fn=l.stateNode.containerInfo,Ci=!0;break e;case 4:Fn=l.stateNode.containerInfo,Ci=!0;break e}l=l.return}if(Fn===null)throw Error(re(160));X6(s,o,i),Fn=null,Ci=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(h){Ut(i,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)J6(e,n),e=e.sibling}function J6(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(wi(e,n),Ji(n),r&4){try{Yh(3,n,n.return),Ym(3,n)}catch(k){Ut(n,n.return,k)}try{Yh(5,n,n.return)}catch(k){Ut(n,n.return,k)}}break;case 1:wi(e,n),Ji(n),r&512&&t!==null&&Cu(t,t.return);break;case 5:if(wi(e,n),Ji(n),r&512&&t!==null&&Cu(t,t.return),n.flags&32){var i=n.stateNode;try{hd(i,"")}catch(k){Ut(n,n.return,k)}}if(r&4&&(i=n.stateNode,i!=null)){var s=n.memoizedProps,o=t!==null?t.memoizedProps:s,l=n.type,c=n.updateQueue;if(n.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&wI(i,s),Jv(l,o);var h=Jv(l,s);for(o=0;o<c.length;o+=2){var p=c[o],m=c[o+1];p==="style"?II(i,m):p==="dangerouslySetInnerHTML"?CI(i,m):p==="children"?hd(i,m):j2(i,p,m,h)}switch(l){case"input":qv(i,s);break;case"textarea":EI(i,s);break;case"select":var _=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var w=s.value;w!=null?ku(i,!!s.multiple,w,!1):_!==!!s.multiple&&(s.defaultValue!=null?ku(i,!!s.multiple,s.defaultValue,!0):ku(i,!!s.multiple,s.multiple?[]:"",!1))}i[wd]=s}catch(k){Ut(n,n.return,k)}}break;case 6:if(wi(e,n),Ji(n),r&4){if(n.stateNode===null)throw Error(re(162));i=n.stateNode,s=n.memoizedProps;try{i.nodeValue=s}catch(k){Ut(n,n.return,k)}}break;case 3:if(wi(e,n),Ji(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{gd(e.containerInfo)}catch(k){Ut(n,n.return,k)}break;case 4:wi(e,n),Ji(n);break;case 13:wi(e,n),Ji(n),i=n.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Ew=Ht())),r&4&&XC(n);break;case 22:if(p=t!==null&&t.memoizedState!==null,n.mode&1?(nr=(h=nr)||p,wi(e,n),nr=h):wi(e,n),Ji(n),r&8192){if(h=n.memoizedState!==null,(n.stateNode.isHidden=h)&&!p&&n.mode&1)for(ge=n,p=n.child;p!==null;){for(m=ge=p;ge!==null;){switch(_=ge,w=_.child,_.tag){case 0:case 11:case 14:case 15:Yh(4,_,_.return);break;case 1:Cu(_,_.return);var S=_.stateNode;if(typeof S.componentWillUnmount=="function"){r=_,t=_.return;try{e=r,S.props=e.memoizedProps,S.state=e.memoizedState,S.componentWillUnmount()}catch(k){Ut(r,t,k)}}break;case 5:Cu(_,_.return);break;case 22:if(_.memoizedState!==null){ZC(m);continue}}w!==null?(w.return=_,ge=w):ZC(m)}p=p.sibling}e:for(p=null,m=n;;){if(m.tag===5){if(p===null){p=m;try{i=m.stateNode,h?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=m.stateNode,c=m.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=TI("display",o))}catch(k){Ut(n,n.return,k)}}}else if(m.tag===6){if(p===null)try{m.stateNode.nodeValue=h?"":m.memoizedProps}catch(k){Ut(n,n.return,k)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===n)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===n)break e;for(;m.sibling===null;){if(m.return===null||m.return===n)break e;p===m&&(p=null),m=m.return}p===m&&(p=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:wi(e,n),Ji(n),r&4&&XC(n);break;case 21:break;default:wi(e,n),Ji(n)}}function Ji(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(Y6(t)){var r=t;break e}t=t.return}throw Error(re(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(hd(i,""),r.flags&=-33);var s=YC(n);R1(n,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,l=YC(n);k1(n,l,o);break;default:throw Error(re(161))}}catch(c){Ut(n,n.return,c)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function DN(n,e,t){ge=n,Z6(n)}function Z6(n,e,t){for(var r=(n.mode&1)!==0;ge!==null;){var i=ge,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||jp;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||nr;l=jp;var h=nr;if(jp=o,(nr=c)&&!h)for(ge=i;ge!==null;)o=ge,c=o.child,o.tag===22&&o.memoizedState!==null?eT(i):c!==null?(c.return=o,ge=c):eT(i);for(;s!==null;)ge=s,Z6(s),s=s.sibling;ge=i,jp=l,nr=h}JC(n)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ge=s):JC(n)}}function JC(n){for(;ge!==null;){var e=ge;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:nr||Ym(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!nr)if(t===null)r.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:Si(e.type,t.memoizedProps);r.componentDidUpdate(i,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&LC(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}LC(e,o,t)}break;case 5:var l=e.stateNode;if(t===null&&e.flags&4){t=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&t.focus();break;case"img":c.src&&(t.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var p=h.memoizedState;if(p!==null){var m=p.dehydrated;m!==null&&gd(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(re(163))}nr||e.flags&512&&P1(e)}catch(_){Ut(e,e.return,_)}}if(e===n){ge=null;break}if(t=e.sibling,t!==null){t.return=e.return,ge=t;break}ge=e.return}}function ZC(n){for(;ge!==null;){var e=ge;if(e===n){ge=null;break}var t=e.sibling;if(t!==null){t.return=e.return,ge=t;break}ge=e.return}}function eT(n){for(;ge!==null;){var e=ge;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Ym(4,e)}catch(c){Ut(e,t,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(c){Ut(e,i,c)}}var s=e.return;try{P1(e)}catch(c){Ut(e,s,c)}break;case 5:var o=e.return;try{P1(e)}catch(c){Ut(e,o,c)}}}catch(c){Ut(e,e.return,c)}if(e===n){ge=null;break}var l=e.sibling;if(l!==null){l.return=e.return,ge=l;break}ge=e.return}}var MN=Math.ceil,Kg=eo.ReactCurrentDispatcher,vw=eo.ReactCurrentOwner,oi=eo.ReactCurrentBatchConfig,tt=0,kn=null,Zt=null,Un=0,Ur=0,Tu=la(0),un=0,Pd=null,al=0,Xm=0,ww=0,Xh=null,Ar=null,Ew=0,$u=1/0,Ns=null,Qg=!1,x1=null,zo=null,Gp=!1,Do=null,Yg=0,Jh=0,A1=null,fg=-1,pg=0;function yr(){return tt&6?Ht():fg!==-1?fg:fg=Ht()}function jo(n){return n.mode&1?tt&2&&Un!==0?Un&-Un:_N.transition!==null?(pg===0&&(pg=FI()),pg):(n=ct,n!==0||(n=window.event,n=n===void 0?16:WI(n.type)),n):1}function xi(n,e,t,r){if(50<Jh)throw Jh=0,A1=null,Error(re(185));Yd(n,t,r),(!(tt&2)||n!==kn)&&(n===kn&&(!(tt&2)&&(Xm|=t),un===4&&Ro(n,Un)),Lr(n,r),t===1&&tt===0&&!(e.mode&1)&&($u=Ht()+500,qm&&ua()))}function Lr(n,e){var t=n.callbackNode;_8(n,e);var r=Dg(n,n===kn?Un:0);if(r===0)t!==null&&uC(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&uC(t),e===1)n.tag===0?mN(tT.bind(null,n)):u6(tT.bind(null,n)),dN(function(){!(tt&6)&&ua()}),t=null;else{switch(VI(r)){case 1:t=q2;break;case 4:t=OI;break;case 16:t=bg;break;case 536870912:t=LI;break;default:t=bg}t=aP(t,eP.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function eP(n,e){if(fg=-1,pg=0,tt&6)throw Error(re(327));var t=n.callbackNode;if(bu()&&n.callbackNode!==t)return null;var r=Dg(n,n===kn?Un:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=Xg(n,r);else{e=r;var i=tt;tt|=2;var s=nP();(kn!==n||Un!==e)&&(Ns=null,$u=Ht()+500,tl(n,e));do try{FN();break}catch(l){tP(n,l)}while(!0);ow(),Kg.current=s,tt=i,Zt!==null?e=0:(kn=null,Un=0,e=un)}if(e!==0){if(e===2&&(i=r1(n),i!==0&&(r=i,e=N1(n,i))),e===1)throw t=Pd,tl(n,0),Ro(n,r),Lr(n,Ht()),t;if(e===6)Ro(n,r);else{if(i=n.current.alternate,!(r&30)&&!ON(i)&&(e=Xg(n,r),e===2&&(s=r1(n),s!==0&&(r=s,e=N1(n,s))),e===1))throw t=Pd,tl(n,0),Ro(n,r),Lr(n,Ht()),t;switch(n.finishedWork=i,n.finishedLanes=r,e){case 0:case 1:throw Error(re(345));case 2:Ha(n,Ar,Ns);break;case 3:if(Ro(n,r),(r&130023424)===r&&(e=Ew+500-Ht(),10<e)){if(Dg(n,0)!==0)break;if(i=n.suspendedLanes,(i&r)!==r){yr(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=h1(Ha.bind(null,n,Ar,Ns),e);break}Ha(n,Ar,Ns);break;case 4:if(Ro(n,r),(r&4194240)===r)break;for(e=n.eventTimes,i=-1;0<r;){var o=31-Ri(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Ht()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*MN(r/1960))-r,10<r){n.timeoutHandle=h1(Ha.bind(null,n,Ar,Ns),r);break}Ha(n,Ar,Ns);break;case 5:Ha(n,Ar,Ns);break;default:throw Error(re(329))}}}return Lr(n,Ht()),n.callbackNode===t?eP.bind(null,n):null}function N1(n,e){var t=Xh;return n.current.memoizedState.isDehydrated&&(tl(n,e).flags|=256),n=Xg(n,e),n!==2&&(e=Ar,Ar=t,e!==null&&b1(e)),n}function b1(n){Ar===null?Ar=n:Ar.push.apply(Ar,n)}function ON(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var i=t[r],s=i.getSnapshot;i=i.value;try{if(!Di(s(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ro(n,e){for(e&=~ww,e&=~Xm,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Ri(e),r=1<<t;n[t]=-1,e&=~r}}function tT(n){if(tt&6)throw Error(re(327));bu();var e=Dg(n,0);if(!(e&1))return Lr(n,Ht()),null;var t=Xg(n,e);if(n.tag!==0&&t===2){var r=r1(n);r!==0&&(e=r,t=N1(n,r))}if(t===1)throw t=Pd,tl(n,0),Ro(n,e),Lr(n,Ht()),t;if(t===6)throw Error(re(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Ha(n,Ar,Ns),Lr(n,Ht()),null}function Sw(n,e){var t=tt;tt|=1;try{return n(e)}finally{tt=t,tt===0&&($u=Ht()+500,qm&&ua())}}function ll(n){Do!==null&&Do.tag===0&&!(tt&6)&&bu();var e=tt;tt|=1;var t=oi.transition,r=ct;try{if(oi.transition=null,ct=1,n)return n()}finally{ct=r,oi.transition=t,tt=e,!(tt&6)&&ua()}}function Cw(){Ur=Tu.current,kt(Tu)}function tl(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,hN(t)),Zt!==null)for(t=Zt.return;t!==null;){var r=t;switch(rw(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Vg();break;case 3:Wu(),kt(Mr),kt(or),dw();break;case 5:hw(r);break;case 4:Wu();break;case 13:kt(Dt);break;case 19:kt(Dt);break;case 10:aw(r.type._context);break;case 22:case 23:Cw()}t=t.return}if(kn=n,Zt=n=Go(n.current,null),Un=Ur=e,un=0,Pd=null,ww=Xm=al=0,Ar=Xh=null,Ya!==null){for(e=0;e<Ya.length;e++)if(t=Ya[e],r=t.interleaved,r!==null){t.interleaved=null;var i=r.next,s=t.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}t.pending=r}Ya=null}return n}function tP(n,e){do{var t=Zt;try{if(ow(),cg.current=qg,$g){for(var r=Lt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}$g=!1}if(ol=0,Sn=ln=Lt=null,Qh=!1,Cd=0,vw.current=null,t===null||t.return===null){un=1,Pd=e,Zt=null;break}e:{var s=n,o=t.return,l=t,c=e;if(e=Un,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var h=c,p=l,m=p.tag;if(!(p.mode&1)&&(m===0||m===11||m===15)){var _=p.alternate;_?(p.updateQueue=_.updateQueue,p.memoizedState=_.memoizedState,p.lanes=_.lanes):(p.updateQueue=null,p.memoizedState=null)}var w=jC(o);if(w!==null){w.flags&=-257,GC(w,o,l,s,e),w.mode&1&&zC(s,h,e),e=w,c=h;var S=e.updateQueue;if(S===null){var k=new Set;k.add(c),e.updateQueue=k}else S.add(c);break e}else{if(!(e&1)){zC(s,h,e),Tw();break e}c=Error(re(426))}}else if(xt&&l.mode&1){var N=jC(o);if(N!==null){!(N.flags&65536)&&(N.flags|=256),GC(N,o,l,s,e),iw(Hu(c,l));break e}}s=c=Hu(c,l),un!==4&&(un=2),Xh===null?Xh=[s]:Xh.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var x=V6(s,c,e);OC(s,x);break e;case 1:l=c;var R=s.type,E=s.stateNode;if(!(s.flags&128)&&(typeof R.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(zo===null||!zo.has(E)))){s.flags|=65536,e&=-e,s.lanes|=e;var P=U6(s,l,e);OC(s,P);break e}}s=s.return}while(s!==null)}iP(t)}catch(V){e=V,Zt===t&&t!==null&&(Zt=t=t.return);continue}break}while(!0)}function nP(){var n=Kg.current;return Kg.current=qg,n===null?qg:n}function Tw(){(un===0||un===3||un===2)&&(un=4),kn===null||!(al&268435455)&&!(Xm&268435455)||Ro(kn,Un)}function Xg(n,e){var t=tt;tt|=2;var r=nP();(kn!==n||Un!==e)&&(Ns=null,tl(n,e));do try{LN();break}catch(i){tP(n,i)}while(!0);if(ow(),tt=t,Kg.current=r,Zt!==null)throw Error(re(261));return kn=null,Un=0,un}function LN(){for(;Zt!==null;)rP(Zt)}function FN(){for(;Zt!==null&&!l8();)rP(Zt)}function rP(n){var e=oP(n.alternate,n,Ur);n.memoizedProps=n.pendingProps,e===null?iP(n):Zt=e,vw.current=null}function iP(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=AN(t,e),t!==null){t.flags&=32767,Zt=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{un=6,Zt=null;return}}else if(t=xN(t,e,Ur),t!==null){Zt=t;return}if(e=e.sibling,e!==null){Zt=e;return}Zt=e=n}while(e!==null);un===0&&(un=5)}function Ha(n,e,t){var r=ct,i=oi.transition;try{oi.transition=null,ct=1,VN(n,e,t,r)}finally{oi.transition=i,ct=r}return null}function VN(n,e,t,r){do bu();while(Do!==null);if(tt&6)throw Error(re(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(re(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(y8(n,s),n===kn&&(Zt=kn=null,Un=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Gp||(Gp=!0,aP(bg,function(){return bu(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=oi.transition,oi.transition=null;var o=ct;ct=1;var l=tt;tt|=4,vw.current=null,bN(n,t),J6(t,n),iN(u1),Mg=!!l1,u1=l1=null,n.current=t,DN(t),u8(),tt=l,ct=o,oi.transition=s}else n.current=t;if(Gp&&(Gp=!1,Do=n,Yg=i),s=n.pendingLanes,s===0&&(zo=null),d8(t.stateNode),Lr(n,Ht()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],r(i.value,{componentStack:i.stack,digest:i.digest});if(Qg)throw Qg=!1,n=x1,x1=null,n;return Yg&1&&n.tag!==0&&bu(),s=n.pendingLanes,s&1?n===A1?Jh++:(Jh=0,A1=n):Jh=0,ua(),null}function bu(){if(Do!==null){var n=VI(Yg),e=oi.transition,t=ct;try{if(oi.transition=null,ct=16>n?16:n,Do===null)var r=!1;else{if(n=Do,Do=null,Yg=0,tt&6)throw Error(re(331));var i=tt;for(tt|=4,ge=n.current;ge!==null;){var s=ge,o=s.child;if(ge.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var h=l[c];for(ge=h;ge!==null;){var p=ge;switch(p.tag){case 0:case 11:case 15:Yh(8,p,s)}var m=p.child;if(m!==null)m.return=p,ge=m;else for(;ge!==null;){p=ge;var _=p.sibling,w=p.return;if(Q6(p),p===h){ge=null;break}if(_!==null){_.return=w,ge=_;break}ge=w}}}var S=s.alternate;if(S!==null){var k=S.child;if(k!==null){S.child=null;do{var N=k.sibling;k.sibling=null,k=N}while(k!==null)}}ge=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ge=o;else e:for(;ge!==null;){if(s=ge,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Yh(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,ge=x;break e}ge=s.return}}var R=n.current;for(ge=R;ge!==null;){o=ge;var E=o.child;if(o.subtreeFlags&2064&&E!==null)E.return=o,ge=E;else e:for(o=R;ge!==null;){if(l=ge,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Ym(9,l)}}catch(V){Ut(l,l.return,V)}if(l===o){ge=null;break e}var P=l.sibling;if(P!==null){P.return=l.return,ge=P;break e}ge=l.return}}if(tt=i,ua(),rs&&typeof rs.onPostCommitFiberRoot=="function")try{rs.onPostCommitFiberRoot(jm,n)}catch{}r=!0}return r}finally{ct=t,oi.transition=e}}return!1}function nT(n,e,t){e=Hu(t,e),e=V6(n,e,1),n=Bo(n,e,1),e=yr(),n!==null&&(Yd(n,1,e),Lr(n,e))}function Ut(n,e,t){if(n.tag===3)nT(n,n,t);else for(;e!==null;){if(e.tag===3){nT(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(zo===null||!zo.has(r))){n=Hu(t,n),n=U6(e,n,1),e=Bo(e,n,1),n=yr(),e!==null&&(Yd(e,1,n),Lr(e,n));break}}e=e.return}}function UN(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=yr(),n.pingedLanes|=n.suspendedLanes&t,kn===n&&(Un&t)===t&&(un===4||un===3&&(Un&130023424)===Un&&500>Ht()-Ew?tl(n,0):ww|=t),Lr(n,e)}function sP(n,e){e===0&&(n.mode&1?(e=Dp,Dp<<=1,!(Dp&130023424)&&(Dp=4194304)):e=1);var t=yr();n=qs(n,e),n!==null&&(Yd(n,e,t),Lr(n,t))}function BN(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),sP(n,t)}function zN(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(re(314))}r!==null&&r.delete(e),sP(n,t)}var oP;oP=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Mr.current)Nr=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Nr=!1,RN(n,e,t);Nr=!!(n.flags&131072)}else Nr=!1,xt&&e.flags&1048576&&c6(e,zg,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;dg(n,e),n=e.pendingProps;var i=zu(e,or.current);Nu(e,t),i=pw(null,e,r,n,i,t);var s=gw();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Or(r)?(s=!0,Ug(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,uw(e),i.updater=Qm,e.stateNode=i,i._reactInternals=e,y1(e,r,n,t),e=E1(null,e,r,!0,s,t)):(e.tag=0,xt&&s&&nw(e),gr(null,e,i,t),e=e.child),e;case 16:r=e.elementType;e:{switch(dg(n,e),n=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=GN(r),n=Si(r,n),i){case 0:e=w1(null,e,r,n,t);break e;case 1:e=$C(null,e,r,n,t);break e;case 11:e=WC(null,e,r,n,t);break e;case 14:e=HC(null,e,r,Si(r.type,n),t);break e}throw Error(re(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Si(r,i),w1(n,e,r,i,t);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Si(r,i),$C(n,e,r,i,t);case 3:e:{if(G6(e),n===null)throw Error(re(387));r=e.pendingProps,s=e.memoizedState,i=s.element,m6(n,e),Wg(e,r,null,t);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Hu(Error(re(423)),e),e=qC(n,e,r,t,i);break e}else if(r!==i){i=Hu(Error(re(424)),e),e=qC(n,e,r,t,i);break e}else for(Br=Uo(e.stateNode.containerInfo.firstChild),jr=e,xt=!0,Ti=null,t=p6(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(ju(),r===i){e=Ks(n,e,t);break e}gr(n,e,r,t)}e=e.child}return e;case 5:return _6(e),n===null&&g1(e),r=e.type,i=e.pendingProps,s=n!==null?n.memoizedProps:null,o=i.children,c1(r,i)?o=null:s!==null&&c1(r,s)&&(e.flags|=32),j6(n,e),gr(n,e,o,t),e.child;case 6:return n===null&&g1(e),null;case 13:return W6(n,e,t);case 4:return cw(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=Gu(e,null,r,t):gr(n,e,r,t),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Si(r,i),WC(n,e,r,i,t);case 7:return gr(n,e,e.pendingProps,t),e.child;case 8:return gr(n,e,e.pendingProps.children,t),e.child;case 12:return gr(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Ct(jg,r._currentValue),r._currentValue=o,s!==null)if(Di(s.value,o)){if(s.children===i.children&&!Mr.current){e=Ks(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(s.tag===1){c=Bs(-1,t&-t),c.tag=2;var h=s.updateQueue;if(h!==null){h=h.shared;var p=h.pending;p===null?c.next=c:(c.next=p.next,p.next=c),h.pending=c}}s.lanes|=t,c=s.alternate,c!==null&&(c.lanes|=t),m1(s.return,t,e),l.lanes|=t;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(re(341));o.lanes|=t,l=o.alternate,l!==null&&(l.lanes|=t),m1(o,t,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}gr(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Nu(e,t),i=li(i),r=r(i),e.flags|=1,gr(n,e,r,t),e.child;case 14:return r=e.type,i=Si(r,e.pendingProps),i=Si(r.type,i),HC(n,e,r,i,t);case 15:return B6(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Si(r,i),dg(n,e),e.tag=1,Or(r)?(n=!0,Ug(e)):n=!1,Nu(e,t),F6(e,r,i),y1(e,r,i,t),E1(null,e,r,!0,n,t);case 19:return H6(n,e,t);case 22:return z6(n,e,t)}throw Error(re(156,e.tag))};function aP(n,e){return MI(n,e)}function jN(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ii(n,e,t,r){return new jN(n,e,t,r)}function Iw(n){return n=n.prototype,!(!n||!n.isReactComponent)}function GN(n){if(typeof n=="function")return Iw(n)?1:0;if(n!=null){if(n=n.$$typeof,n===W2)return 11;if(n===H2)return 14}return 2}function Go(n,e){var t=n.alternate;return t===null?(t=ii(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function gg(n,e,t,r,i,s){var o=2;if(r=n,typeof n=="function")Iw(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case pu:return nl(t.children,i,s,e);case G2:o=8,i|=8;break;case jv:return n=ii(12,t,e,i|2),n.elementType=jv,n.lanes=s,n;case Gv:return n=ii(13,t,e,i),n.elementType=Gv,n.lanes=s,n;case Wv:return n=ii(19,t,e,i),n.elementType=Wv,n.lanes=s,n;case _I:return Jm(t,i,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case gI:o=10;break e;case mI:o=9;break e;case W2:o=11;break e;case H2:o=14;break e;case Io:o=16,r=null;break e}throw Error(re(130,n==null?n:typeof n,""))}return e=ii(o,t,e,i),e.elementType=n,e.type=r,e.lanes=s,e}function nl(n,e,t,r){return n=ii(7,n,r,e),n.lanes=t,n}function Jm(n,e,t,r){return n=ii(22,n,r,e),n.elementType=_I,n.lanes=t,n.stateNode={isHidden:!1},n}function ov(n,e,t){return n=ii(6,n,null,e),n.lanes=t,n}function av(n,e,t){return e=ii(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function WN(n,e,t,r,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zy(0),this.expirationTimes=zy(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zy(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Pw(n,e,t,r,i,s,o,l,c){return n=new WN(n,e,t,l,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=ii(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},uw(s),n}function HN(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:fu,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function lP(n){if(!n)return Xo;n=n._reactInternals;e:{if(El(n)!==n||n.tag!==1)throw Error(re(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Or(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(re(171))}if(n.tag===1){var t=n.type;if(Or(t))return l6(n,t,e)}return e}function uP(n,e,t,r,i,s,o,l,c){return n=Pw(t,r,!0,n,i,s,o,l,c),n.context=lP(null),t=n.current,r=yr(),i=jo(t),s=Bs(r,i),s.callback=e??null,Bo(t,s,i),n.current.lanes=i,Yd(n,i,r),Lr(n,r),n}function Zm(n,e,t,r){var i=e.current,s=yr(),o=jo(i);return t=lP(t),e.context===null?e.context=t:e.pendingContext=t,e=Bs(s,o),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=Bo(i,e,o),n!==null&&(xi(n,i,o,s),ug(n,i,o)),o}function Jg(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function rT(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function kw(n,e){rT(n,e),(n=n.alternate)&&rT(n,e)}function $N(){return null}var cP=typeof reportError=="function"?reportError:function(n){console.error(n)};function Rw(n){this._internalRoot=n}e0.prototype.render=Rw.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(re(409));Zm(n,e,null,null)};e0.prototype.unmount=Rw.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;ll(function(){Zm(null,n,null,null)}),e[$s]=null}};function e0(n){this._internalRoot=n}e0.prototype.unstable_scheduleHydration=function(n){if(n){var e=zI();n={blockedOn:null,target:n,priority:e};for(var t=0;t<ko.length&&e!==0&&e<ko[t].priority;t++);ko.splice(t,0,n),t===0&&GI(n)}};function xw(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function t0(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function iT(){}function qN(n,e,t,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var h=Jg(o);s.call(h)}}var o=uP(e,r,n,0,null,!1,!1,"",iT);return n._reactRootContainer=o,n[$s]=o.current,yd(n.nodeType===8?n.parentNode:n),ll(),o}for(;i=n.lastChild;)n.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var h=Jg(c);l.call(h)}}var c=Pw(n,0,!1,null,null,!1,!1,"",iT);return n._reactRootContainer=c,n[$s]=c.current,yd(n.nodeType===8?n.parentNode:n),ll(function(){Zm(e,c,t,r)}),c}function n0(n,e,t,r,i){var s=t._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var c=Jg(o);l.call(c)}}Zm(e,o,n,i)}else o=qN(t,e,n,i,r);return Jg(o)}UI=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Mh(e.pendingLanes);t!==0&&(K2(e,t|1),Lr(e,Ht()),!(tt&6)&&($u=Ht()+500,ua()))}break;case 13:ll(function(){var r=qs(n,1);if(r!==null){var i=yr();xi(r,n,1,i)}}),kw(n,1)}};Q2=function(n){if(n.tag===13){var e=qs(n,134217728);if(e!==null){var t=yr();xi(e,n,134217728,t)}kw(n,134217728)}};BI=function(n){if(n.tag===13){var e=jo(n),t=qs(n,e);if(t!==null){var r=yr();xi(t,n,e,r)}kw(n,e)}};zI=function(){return ct};jI=function(n,e){var t=ct;try{return ct=n,e()}finally{ct=t}};e1=function(n,e,t){switch(e){case"input":if(qv(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var i=$m(r);if(!i)throw Error(re(90));vI(r),qv(r,i)}}}break;case"textarea":EI(n,t);break;case"select":e=t.value,e!=null&&ku(n,!!t.multiple,e,!1)}};RI=Sw;xI=ll;var KN={usingClientEntryPoint:!1,Events:[Jd,yu,$m,PI,kI,Sw]},Sh={findFiberByHostInstance:Qa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},QN={bundleType:Sh.bundleType,version:Sh.version,rendererPackageName:Sh.rendererPackageName,rendererConfig:Sh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:eo.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=bI(n),n===null?null:n.stateNode},findFiberByHostInstance:Sh.findFiberByHostInstance||$N,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wp.isDisabled&&Wp.supportsFiber)try{jm=Wp.inject(QN),rs=Wp}catch{}}Hr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=KN;Hr.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!xw(e))throw Error(re(200));return HN(n,e,null,t)};Hr.createRoot=function(n,e){if(!xw(n))throw Error(re(299));var t=!1,r="",i=cP;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Pw(n,1,!1,null,null,t,!1,r,i),n[$s]=e.current,yd(n.nodeType===8?n.parentNode:n),new Rw(e)};Hr.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(re(188)):(n=Object.keys(n).join(","),Error(re(268,n)));return n=bI(e),n=n===null?null:n.stateNode,n};Hr.flushSync=function(n){return ll(n)};Hr.hydrate=function(n,e,t){if(!t0(e))throw Error(re(200));return n0(null,n,e,!0,t)};Hr.hydrateRoot=function(n,e,t){if(!xw(n))throw Error(re(405));var r=t!=null&&t.hydratedSources||null,i=!1,s="",o=cP;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=uP(e,null,n,1,t??null,i,!1,s,o),n[$s]=e.current,yd(n),r)for(n=0;n<r.length;n++)t=r[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new e0(e)};Hr.render=function(n,e,t){if(!t0(e))throw Error(re(200));return n0(null,n,e,!1,t)};Hr.unmountComponentAtNode=function(n){if(!t0(n))throw Error(re(40));return n._reactRootContainer?(ll(function(){n0(null,null,n,!1,function(){n._reactRootContainer=null,n[$s]=null})}),!0):!1};Hr.unstable_batchedUpdates=Sw;Hr.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!t0(t))throw Error(re(200));if(n==null||n._reactInternals===void 0)throw Error(re(38));return n0(n,e,t,!1,r)};Hr.version="18.3.1-next-f1338f8080-20240426";function hP(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(hP)}catch(n){console.error(n)}}hP(),hI.exports=Hr;var YN=hI.exports,sT=YN;Bv.createRoot=sT.createRoot,Bv.hydrateRoot=sT.hydrateRoot;var oT={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dP={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ae=function(n,e){if(!n)throw gc(e)},gc=function(n){return new Error("Firebase Database ("+dP.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fP=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},XN=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],o=n[t++],l=n[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Aw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],o=i+1<n.length,l=o?n[i+1]:0,c=i+2<n.length,h=c?n[i+2]:0,p=s>>2,m=(s&3)<<4|l>>4;let _=(l&15)<<2|h>>6,w=h&63;c||(w=64,o||(_=64)),r.push(t[p],t[m],t[_],t[w])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(fP(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):XN(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],l=i<n.length?t[n.charAt(i)]:0;++i;const h=i<n.length?t[n.charAt(i)]:64;++i;const m=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||l==null||h==null||m==null)throw new JN;const _=s<<2|l>>4;if(r.push(_),h!==64){const w=l<<4&240|h>>2;if(r.push(w),m!==64){const S=h<<6&192|m;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class JN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const pP=function(n){const e=fP(n);return Aw.encodeByteArray(e,!0)},Zg=function(n){return pP(n).replace(/\./g,"")},em=function(n){try{return Aw.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZN(n){return gP(void 0,n)}function gP(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!e7(t)||(n[t]=gP(n[t],e[t]));return n}function e7(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t7(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n7=()=>t7().__FIREBASE_DEFAULTS__,r7=()=>{if(typeof process>"u"||typeof oT>"u")return;const n=oT.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},i7=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&em(n[1]);return e&&JSON.parse(e)},r0=()=>{try{return n7()||r7()||i7()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},mP=n=>{var e,t;return(t=(e=r0())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},_P=n=>{const e=mP(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},yP=()=>{var n;return(n=r0())===null||n===void 0?void 0:n.config},vP=n=>{var e;return(e=r0())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wP(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Zg(JSON.stringify(t)),Zg(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ar(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Nw(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ar())}function s7(){var n;const e=(n=r0())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function o7(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function a7(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function EP(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function l7(){const n=ar();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function u7(){return dP.NODE_ADMIN===!0}function c7(){return!s7()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function h7(){try{return typeof indexedDB=="object"}catch{return!1}}function d7(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f7="FirebaseError";class to extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=f7,Object.setPrototypeOf(this,to.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ef.prototype.create)}}class ef{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?p7(s,r):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new to(i,l,r)}}function p7(n,e){return n.replace(g7,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const g7=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kd(n){return JSON.parse(n)}function Pn(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SP=function(n){let e={},t={},r={},i="";try{const s=n.split(".");e=kd(em(s[0])||""),t=kd(em(s[1])||""),i=s[2],r=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:r,signature:i}},m7=function(n){const e=SP(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},_7=function(n){const e=SP(n).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function us(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function qu(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function tm(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function nm(n,e,t){const r={};for(const i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=e.call(t,n[i],i,n));return r}function rm(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],o=e[i];if(aT(s)&&aT(o)){if(!rm(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function aT(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mc(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Lh(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Fh(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y7{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const r=this.W_;if(typeof e=="string")for(let m=0;m<16;m++)r[m]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let m=0;m<16;m++)r[m]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let m=16;m<80;m++){const _=r[m-3]^r[m-8]^r[m-14]^r[m-16];r[m]=(_<<1|_>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],l=this.chain_[3],c=this.chain_[4],h,p;for(let m=0;m<80;m++){m<40?m<20?(h=l^s&(o^l),p=1518500249):(h=s^o^l,p=1859775393):m<60?(h=s&o|l&(s|o),p=2400959708):(h=s^o^l,p=3395469782);const _=(i<<5|i>>>27)+h+c+p+r[m]&4294967295;c=l,l=o,o=(s<<30|s>>>2)&4294967295,s=i,i=_}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const r=t-this.blockSize;let i=0;const s=this.buf_;let o=this.inbuf_;for(;i<t;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<t;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<t;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=t&255,t/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}}function v7(n,e){const t=new w7(n,e);return t.subscribe.bind(t)}class w7{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");E7(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=lv),i.error===void 0&&(i.error=lv),i.complete===void 0&&(i.complete=lv);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function E7(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function lv(){}function Ku(n,e){return`${n} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S7=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);if(i>=55296&&i<=56319){const s=i-55296;r++,ae(r<n.length,"Surrogate pair missing trail surrogate.");const o=n.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):i<65536?(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},i0=function(n){let e=0;for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wt(n){return n&&n._delegate?n._delegate:n}class Jo{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $a="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C7{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new ts;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(I7(e))try{this.getOrInitializeService({instanceIdentifier:$a})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=$a){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=$a){return this.instances.has(e)}getOptions(e=$a){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);r===l&&o.resolve(i)}return i}onInit(e,t){var r;const i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:T7(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=$a){return this.component?this.component.multipleInstances?e:$a:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function T7(n){return n===$a?void 0:n}function I7(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P7{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new C7(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var qe;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(qe||(qe={}));const k7={debug:qe.DEBUG,verbose:qe.VERBOSE,info:qe.INFO,warn:qe.WARN,error:qe.ERROR,silent:qe.SILENT},R7=qe.INFO,x7={[qe.DEBUG]:"log",[qe.VERBOSE]:"log",[qe.INFO]:"info",[qe.WARN]:"warn",[qe.ERROR]:"error"},A7=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=x7[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class s0{constructor(e){this.name=e,this._logLevel=R7,this._logHandler=A7,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in qe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?k7[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,qe.DEBUG,...e),this._logHandler(this,qe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,qe.VERBOSE,...e),this._logHandler(this,qe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,qe.INFO,...e),this._logHandler(this,qe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,qe.WARN,...e),this._logHandler(this,qe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,qe.ERROR,...e),this._logHandler(this,qe.ERROR,...e)}}const N7=(n,e)=>e.some(t=>n instanceof t);let lT,uT;function b7(){return lT||(lT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function D7(){return uT||(uT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const CP=new WeakMap,D1=new WeakMap,TP=new WeakMap,uv=new WeakMap,bw=new WeakMap;function M7(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Wo(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&CP.set(t,n)}).catch(()=>{}),bw.set(e,n),e}function O7(n){if(D1.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});D1.set(n,e)}let M1={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return D1.get(n);if(e==="objectStoreNames")return n.objectStoreNames||TP.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Wo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function L7(n){M1=n(M1)}function F7(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(cv(this),e,...t);return TP.set(r,e.sort?e.sort():[e]),Wo(r)}:D7().includes(n)?function(...e){return n.apply(cv(this),e),Wo(CP.get(this))}:function(...e){return Wo(n.apply(cv(this),e))}}function V7(n){return typeof n=="function"?F7(n):(n instanceof IDBTransaction&&O7(n),N7(n,b7())?new Proxy(n,M1):n)}function Wo(n){if(n instanceof IDBRequest)return M7(n);if(uv.has(n))return uv.get(n);const e=V7(n);return e!==n&&(uv.set(n,e),bw.set(e,n)),e}const cv=n=>bw.get(n);function U7(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(n,e),l=Wo(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Wo(o.result),c.oldVersion,c.newVersion,Wo(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),l.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const B7=["get","getKey","getAll","getAllKeys","count"],z7=["put","add","delete","clear"],hv=new Map;function cT(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(hv.get(e))return hv.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=z7.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||B7.includes(t)))return;const s=async function(o,...l){const c=this.transaction(o,i?"readwrite":"readonly");let h=c.store;return r&&(h=h.index(l.shift())),(await Promise.all([h[t](...l),i&&c.done]))[0]};return hv.set(e,s),s}L7(n=>({...n,get:(e,t,r)=>cT(e,t)||n.get(e,t,r),has:(e,t)=>!!cT(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j7{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(G7(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function G7(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const O1="@firebase/app",hT="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qs=new s0("@firebase/app"),W7="@firebase/app-compat",H7="@firebase/analytics-compat",$7="@firebase/analytics",q7="@firebase/app-check-compat",K7="@firebase/app-check",Q7="@firebase/auth",Y7="@firebase/auth-compat",X7="@firebase/database",J7="@firebase/data-connect",Z7="@firebase/database-compat",eb="@firebase/functions",tb="@firebase/functions-compat",nb="@firebase/installations",rb="@firebase/installations-compat",ib="@firebase/messaging",sb="@firebase/messaging-compat",ob="@firebase/performance",ab="@firebase/performance-compat",lb="@firebase/remote-config",ub="@firebase/remote-config-compat",cb="@firebase/storage",hb="@firebase/storage-compat",db="@firebase/firestore",fb="@firebase/vertexai-preview",pb="@firebase/firestore-compat",gb="firebase",mb="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L1="[DEFAULT]",_b={[O1]:"fire-core",[W7]:"fire-core-compat",[$7]:"fire-analytics",[H7]:"fire-analytics-compat",[K7]:"fire-app-check",[q7]:"fire-app-check-compat",[Q7]:"fire-auth",[Y7]:"fire-auth-compat",[X7]:"fire-rtdb",[J7]:"fire-data-connect",[Z7]:"fire-rtdb-compat",[eb]:"fire-fn",[tb]:"fire-fn-compat",[nb]:"fire-iid",[rb]:"fire-iid-compat",[ib]:"fire-fcm",[sb]:"fire-fcm-compat",[ob]:"fire-perf",[ab]:"fire-perf-compat",[lb]:"fire-rc",[ub]:"fire-rc-compat",[cb]:"fire-gcs",[hb]:"fire-gcs-compat",[db]:"fire-fst",[pb]:"fire-fst-compat",[fb]:"fire-vertex","fire-js":"fire-js",[gb]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const im=new Map,yb=new Map,F1=new Map;function dT(n,e){try{n.container.addComponent(e)}catch(t){Qs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ul(n){const e=n.name;if(F1.has(e))return Qs.debug(`There were multiple attempts to register component ${e}.`),!1;F1.set(e,n);for(const t of im.values())dT(t,n);for(const t of yb.values())dT(t,n);return!0}function o0(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Pi(n){return n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vb={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ho=new ef("app","Firebase",vb);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wb{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Jo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ho.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sl=mb;function IP(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:L1,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Ho.create("bad-app-name",{appName:String(i)});if(t||(t=yP()),!t)throw Ho.create("no-options");const s=im.get(i);if(s){if(rm(t,s.options)&&rm(r,s.config))return s;throw Ho.create("duplicate-app",{appName:i})}const o=new P7(i);for(const c of F1.values())o.addComponent(c);const l=new wb(t,r,o);return im.set(i,l),l}function Dw(n=L1){const e=im.get(n);if(!e&&n===L1&&yP())return IP();if(!e)throw Ho.create("no-app",{appName:n});return e}function ss(n,e,t){var r;let i=(r=_b[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Qs.warn(l.join(" "));return}ul(new Jo(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eb="firebase-heartbeat-database",Sb=1,Rd="firebase-heartbeat-store";let dv=null;function PP(){return dv||(dv=U7(Eb,Sb,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Rd)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ho.create("idb-open",{originalErrorMessage:n.message})})),dv}async function Cb(n){try{const t=(await PP()).transaction(Rd),r=await t.objectStore(Rd).get(kP(n));return await t.done,r}catch(e){if(e instanceof to)Qs.warn(e.message);else{const t=Ho.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Qs.warn(t.message)}}}async function fT(n,e){try{const r=(await PP()).transaction(Rd,"readwrite");await r.objectStore(Rd).put(e,kP(n)),await r.done}catch(t){if(t instanceof to)Qs.warn(t.message);else{const r=Ho.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Qs.warn(r.message)}}}function kP(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tb=1024,Ib=30*24*60*60*1e3;class Pb{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Rb(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=pT();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=Ib}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Qs.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=pT(),{heartbeatsToSend:r,unsentEntries:i}=kb(this._heartbeatsCache.heartbeats),s=Zg(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return Qs.warn(t),""}}}function pT(){return new Date().toISOString().substring(0,10)}function kb(n,e=Tb){const t=[];let r=n.slice();for(const i of n){const s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),gT(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),gT(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class Rb{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return h7()?d7().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Cb(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return fT(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return fT(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function gT(n){return Zg(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xb(n){ul(new Jo("platform-logger",e=>new j7(e),"PRIVATE")),ul(new Jo("heartbeat",e=>new Pb(e),"PRIVATE")),ss(O1,hT,n),ss(O1,hT,"esm2017"),ss("fire-js","")}xb("");function Mw(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function RP(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Ab=RP,xP=new ef("auth","Firebase",RP());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sm=new s0("@firebase/auth");function Nb(n,...e){sm.logLevel<=qe.WARN&&sm.warn(`Auth (${Sl}): ${n}`,...e)}function mg(n,...e){sm.logLevel<=qe.ERROR&&sm.error(`Auth (${Sl}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ci(n,...e){throw Lw(n,...e)}function Ai(n,...e){return Lw(n,...e)}function Ow(n,e,t){const r=Object.assign(Object.assign({},Ab()),{[e]:t});return new ef("auth","Firebase",r).create(e,{appName:n.name})}function zs(n){return Ow(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function bb(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&ci(n,"argument-error"),Ow(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Lw(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return xP.create(n,...e)}function Ie(n,e,...t){if(!n)throw Lw(e,...t)}function Ls(n){const e="INTERNAL ASSERTION FAILED: "+n;throw mg(e),new Error(e)}function Ys(n,e){n||Ls(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V1(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function Db(){return mT()==="http:"||mT()==="https:"}function mT(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mb(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Db()||a7()||"connection"in navigator)?navigator.onLine:!0}function Ob(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ys(t>e,"Short delay should be less than long delay!"),this.isMobile=Nw()||EP()}get(){return Mb()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fw(n,e){Ys(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AP{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ls("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ls("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ls("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lb={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fb=new tf(3e4,6e4);function ca(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function ha(n,e,t,r,i={}){return NP(n,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const l=mc(Object.assign({key:n.config.apiKey},o)).slice(1),c=await n._getAdditionalHeaders();c["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode);const h=Object.assign({method:e,headers:c},s);return o7()||(h.referrerPolicy="no-referrer"),AP.fetch()(bP(n,n.config.apiHost,t,l),h)})}async function NP(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},Lb),e);try{const i=new Ub(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Hp(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[c,h]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Hp(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Hp(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw Hp(n,"user-disabled",o);const p=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Ow(n,p,h);ci(n,p)}}catch(i){if(i instanceof to)throw i;ci(n,"network-request-failed",{message:String(i)})}}async function nf(n,e,t,r,i={}){const s=await ha(n,e,t,r,i);return"mfaPendingCredential"in s&&ci(n,"multi-factor-auth-required",{_serverResponse:s}),s}function bP(n,e,t,r){const i=`${e}${t}?${r}`;return n.config.emulator?Fw(n.config,i):`${n.config.apiScheme}://${i}`}function Vb(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Ub{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Ai(this.auth,"network-request-failed")),Fb.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Hp(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=Ai(n,e,r);return i.customData._tokenResponse=t,i}function _T(n){return n!==void 0&&n.enterprise!==void 0}class Bb{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Vb(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function zb(n,e){return ha(n,"GET","/v2/recaptchaConfig",ca(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jb(n,e){return ha(n,"POST","/v1/accounts:delete",e)}async function DP(n,e){return ha(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zh(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Gb(n,e=!1){const t=wt(n),r=await t.getIdToken(e),i=Vw(r);Ie(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Zh(fv(i.auth_time)),issuedAtTime:Zh(fv(i.iat)),expirationTime:Zh(fv(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function fv(n){return Number(n)*1e3}function Vw(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return mg("JWT malformed, contained fewer than 3 sections"),null;try{const i=em(t);return i?JSON.parse(i):(mg("Failed to decode base64 JWT payload"),null)}catch(i){return mg("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function yT(n){const e=Vw(n);return Ie(e,"internal-error"),Ie(typeof e.exp<"u","internal-error"),Ie(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xd(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof to&&Wb(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function Wb({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hb{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U1{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Zh(this.lastLoginAt),this.creationTime=Zh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function om(n){var e;const t=n.auth,r=await n.getIdToken(),i=await xd(n,DP(t,{idToken:r}));Ie(i==null?void 0:i.users.length,t,"internal-error");const s=i.users[0];n._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?MP(s.providerUserInfo):[],l=qb(n.providerData,o),c=n.isAnonymous,h=!(n.email&&s.passwordHash)&&!(l!=null&&l.length),p=c?h:!1,m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new U1(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,m)}async function $b(n){const e=wt(n);await om(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function qb(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function MP(n){return n.map(e=>{var{providerId:t}=e,r=Mw(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kb(n,e){const t=await NP(n,{},async()=>{const r=mc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=bP(n,i,"/v1/token",`key=${s}`),l=await n._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",AP.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Qb(n,e){return ha(n,"POST","/v2/accounts:revokeToken",ca(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ie(e.idToken,"internal-error"),Ie(typeof e.idToken<"u","internal-error"),Ie(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):yT(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ie(e.length!==0,"internal-error");const t=yT(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ie(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await Kb(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new Du;return r&&(Ie(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(Ie(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(Ie(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Du,this.toJSON())}_performRefresh(){return Ls("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function So(n,e){Ie(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Fs{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=Mw(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Hb(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new U1(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await xd(this,this.stsTokenManager.getToken(this.auth,e));return Ie(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Gb(this,e)}reload(){return $b(this)}_assign(e){this!==e&&(Ie(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Fs(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Ie(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await om(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Pi(this.auth.app))return Promise.reject(zs(this.auth));const e=await this.getIdToken();return await xd(this,jb(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,l,c,h,p;const m=(r=t.displayName)!==null&&r!==void 0?r:void 0,_=(i=t.email)!==null&&i!==void 0?i:void 0,w=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,S=(o=t.photoURL)!==null&&o!==void 0?o:void 0,k=(l=t.tenantId)!==null&&l!==void 0?l:void 0,N=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,x=(h=t.createdAt)!==null&&h!==void 0?h:void 0,R=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:E,emailVerified:P,isAnonymous:V,providerData:B,stsTokenManager:D}=t;Ie(E&&D,e,"internal-error");const T=Du.fromJSON(this.name,D);Ie(typeof E=="string",e,"internal-error"),So(m,e.name),So(_,e.name),Ie(typeof P=="boolean",e,"internal-error"),Ie(typeof V=="boolean",e,"internal-error"),So(w,e.name),So(S,e.name),So(k,e.name),So(N,e.name),So(x,e.name),So(R,e.name);const b=new Fs({uid:E,auth:e,email:_,emailVerified:P,displayName:m,isAnonymous:V,photoURL:S,phoneNumber:w,tenantId:k,stsTokenManager:T,createdAt:x,lastLoginAt:R});return B&&Array.isArray(B)&&(b.providerData=B.map(A=>Object.assign({},A))),N&&(b._redirectEventId=N),b}static async _fromIdTokenResponse(e,t,r=!1){const i=new Du;i.updateFromServerResponse(t);const s=new Fs({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await om(s),s}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];Ie(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?MP(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),l=new Du;l.updateFromIdToken(r);const c=new Fs({uid:i.localId,auth:e,stsTokenManager:l,isAnonymous:o}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new U1(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(c,h),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vT=new Map;function Vs(n){Ys(n instanceof Function,"Expected a class definition");let e=vT.get(n);return e?(Ys(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,vT.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OP{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}OP.type="NONE";const wT=OP;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _g(n,e,t){return`firebase:${n}:${e}:${t}`}class Mu{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=_g(this.userKey,i.apiKey,s),this.fullPersistenceKey=_g("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Fs._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Mu(Vs(wT),e,r);const i=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=i[0]||Vs(wT);const o=_g(r,e.config.apiKey,e.name);let l=null;for(const h of t)try{const p=await h._get(o);if(p){const m=Fs._fromJSON(e,p);h!==s&&(l=m),s=h;break}}catch{}const c=i.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new Mu(s,e,r):(s=c[0],l&&await s._set(o,l.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new Mu(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ET(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(UP(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(LP(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(zP(e))return"Blackberry";if(jP(e))return"Webos";if(FP(e))return"Safari";if((e.includes("chrome/")||VP(e))&&!e.includes("edge/"))return"Chrome";if(BP(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function LP(n=ar()){return/firefox\//i.test(n)}function FP(n=ar()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function VP(n=ar()){return/crios\//i.test(n)}function UP(n=ar()){return/iemobile/i.test(n)}function BP(n=ar()){return/android/i.test(n)}function zP(n=ar()){return/blackberry/i.test(n)}function jP(n=ar()){return/webos/i.test(n)}function Uw(n=ar()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Yb(n=ar()){var e;return Uw(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Xb(){return l7()&&document.documentMode===10}function GP(n=ar()){return Uw(n)||BP(n)||jP(n)||zP(n)||/windows phone/i.test(n)||UP(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WP(n,e=[]){let t;switch(n){case"Browser":t=ET(ar());break;case"Worker":t=`${ET(ar())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Sl}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jb{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((o,l)=>{try{const c=e(s);o(c)}catch(c){l(c)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zb(n,e={}){return ha(n,"GET","/v2/passwordPolicy",ca(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eD=6;class tD{constructor(e){var t,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:eD,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nD{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ST(this),this.idTokenSubscription=new ST(this),this.beforeStateQueue=new Jb(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=xP,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Vs(t)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await Mu.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await DP(this,{idToken:e}),r=await Fs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Pi(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,l=i==null?void 0:i._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ie(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await om(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Ob()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Pi(this.app))return Promise.reject(zs(this));const t=e?wt(e):null;return t&&Ie(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ie(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Pi(this.app)?Promise.reject(zs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Pi(this.app)?Promise.reject(zs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Vs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Zb(this),t=new tD(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new ef("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await Qb(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Vs(e)||this._popupRedirectResolver;Ie(t,this,"argument-error"),this.redirectPersistenceManager=await Mu.create(this,[Vs(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ie(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const c=e.addObserver(t,r,i);return()=>{o=!0,c()}}else{const c=e.addObserver(t);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ie(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=WP(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&Nb(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function da(n){return wt(n)}class ST{constructor(e){this.auth=e,this.observer=null,this.addObserver=v7(t=>this.observer=t)}get next(){return Ie(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let a0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function rD(n){a0=n}function HP(n){return a0.loadJS(n)}function iD(){return a0.recaptchaEnterpriseScript}function sD(){return a0.gapiScript}function oD(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const aD="recaptcha-enterprise",lD="NO_RECAPTCHA";class uD{constructor(e){this.type=aD,this.auth=da(e)}async verify(e="verify",t=!1){async function r(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,l)=>{zb(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const h=new Bb(c);return s.tenantId==null?s._agentRecaptchaConfig=h:s._tenantRecaptchaConfigs[s.tenantId]=h,o(h.siteKey)}}).catch(c=>{l(c)})})}function i(s,o,l){const c=window.grecaptcha;_T(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(h=>{o(h)}).catch(()=>{o(lD)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(l=>{if(!t&&_T(window.grecaptcha))i(l,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=iD();c.length!==0&&(c+=l),HP(c).then(()=>{i(l,s,o)}).catch(h=>{o(h)})}}).catch(l=>{o(l)})})}}async function CT(n,e,t,r=!1){const i=new uD(n);let s;try{s=await i.verify(t)}catch{s=await i.verify(t,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function B1(n,e,t,r){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await CT(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await CT(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cD(n,e){const t=o0(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(rm(s,e??{}))return i;ci(i,"already-initialized")}return t.initialize({options:e})}function hD(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Vs);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function $P(n,e,t){const r=da(n);Ie(r._canInitEmulator,r,"emulator-config-failed"),Ie(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(t!=null&&t.disableWarnings),s=qP(e),{host:o,port:l}=dD(e),c=l===null?"":`:${l}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||fD()}function qP(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function dD(n){const e=qP(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:TT(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:TT(o)}}}function TT(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function fD(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bw{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ls("not implemented")}_getIdTokenResponse(e){return Ls("not implemented")}_linkToIdToken(e,t){return Ls("not implemented")}_getReauthenticationResolver(e){return Ls("not implemented")}}async function pD(n,e){return ha(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gD(n,e){return nf(n,"POST","/v1/accounts:signInWithPassword",ca(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mD(n,e){return nf(n,"POST","/v1/accounts:signInWithEmailLink",ca(n,e))}async function _D(n,e){return nf(n,"POST","/v1/accounts:signInWithEmailLink",ca(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ad extends Bw{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Ad(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Ad(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return B1(e,t,"signInWithPassword",gD);case"emailLink":return mD(e,{email:this._email,oobCode:this._password});default:ci(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return B1(e,r,"signUpPassword",pD);case"emailLink":return _D(e,{idToken:t,email:this._email,oobCode:this._password});default:ci(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ou(n,e){return nf(n,"POST","/v1/accounts:signInWithIdp",ca(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yD="http://localhost";class cl extends Bw{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new cl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ci("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=Mw(t,["providerId","signInMethod"]);if(!r||!i)return null;const o=new cl(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Ou(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Ou(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ou(e,t)}buildRequest(){const e={requestUri:yD,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=mc(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vD(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function wD(n){const e=Lh(Fh(n)).link,t=e?Lh(Fh(e)).deep_link_id:null,r=Lh(Fh(n)).deep_link_id;return(r?Lh(Fh(r)).link:null)||r||t||e||n}class zw{constructor(e){var t,r,i,s,o,l;const c=Lh(Fh(e)),h=(t=c.apiKey)!==null&&t!==void 0?t:null,p=(r=c.oobCode)!==null&&r!==void 0?r:null,m=vD((i=c.mode)!==null&&i!==void 0?i:null);Ie(h&&p&&m,"argument-error"),this.apiKey=h,this.operation=m,this.code=p,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const t=wD(e);try{return new zw(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c{constructor(){this.providerId=_c.PROVIDER_ID}static credential(e,t){return Ad._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=zw.parseLink(t);return Ie(r,"argument-error"),Ad._fromEmailAndCode(e,r.code,r.tenantId)}}_c.PROVIDER_ID="password";_c.EMAIL_PASSWORD_SIGN_IN_METHOD="password";_c.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rf extends jw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo extends rf{constructor(){super("facebook.com")}static credential(e){return cl._fromParams({providerId:xo.PROVIDER_ID,signInMethod:xo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xo.credentialFromTaggedObject(e)}static credentialFromError(e){return xo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xo.credential(e.oauthAccessToken)}catch{return null}}}xo.FACEBOOK_SIGN_IN_METHOD="facebook.com";xo.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds extends rf{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return cl._fromParams({providerId:Ds.PROVIDER_ID,signInMethod:Ds.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ds.credentialFromTaggedObject(e)}static credentialFromError(e){return Ds.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Ds.credential(t,r)}catch{return null}}}Ds.GOOGLE_SIGN_IN_METHOD="google.com";Ds.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao extends rf{constructor(){super("github.com")}static credential(e){return cl._fromParams({providerId:Ao.PROVIDER_ID,signInMethod:Ao.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ao.credentialFromTaggedObject(e)}static credentialFromError(e){return Ao.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ao.credential(e.oauthAccessToken)}catch{return null}}}Ao.GITHUB_SIGN_IN_METHOD="github.com";Ao.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class No extends rf{constructor(){super("twitter.com")}static credential(e,t){return cl._fromParams({providerId:No.PROVIDER_ID,signInMethod:No.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return No.credentialFromTaggedObject(e)}static credentialFromError(e){return No.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return No.credential(t,r)}catch{return null}}}No.TWITTER_SIGN_IN_METHOD="twitter.com";No.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ED(n,e){return nf(n,"POST","/v1/accounts:signUp",ca(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await Fs._fromIdTokenResponse(e,r,i),o=IT(r);return new hl({user:s,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=IT(r);return new hl({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function IT(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class am extends to{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,am.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new am(e,t,r,i)}}function KP(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?am._fromErrorAndOperation(n,s,e,r):s})}async function SD(n,e,t=!1){const r=await xd(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return hl._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CD(n,e,t=!1){const{auth:r}=n;if(Pi(r.app))return Promise.reject(zs(r));const i="reauthenticate";try{const s=await xd(n,KP(r,i,e,n),t);Ie(s.idToken,r,"internal-error");const o=Vw(s.idToken);Ie(o,r,"internal-error");const{sub:l}=o;return Ie(n.uid===l,r,"user-mismatch"),hl._forOperation(n,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&ci(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QP(n,e,t=!1){if(Pi(n.app))return Promise.reject(zs(n));const r="signIn",i=await KP(n,r,e),s=await hl._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}async function TD(n,e){return QP(da(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YP(n){const e=da(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function ID(n,e,t){if(Pi(n.app))return Promise.reject(zs(n));const r=da(n),o=await B1(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",ED).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&YP(n),c}),l=await hl._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(l.user),l}function PD(n,e,t){return Pi(n.app)?Promise.reject(zs(n)):TD(wt(n),_c.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&YP(n),r})}function kD(n,e,t,r){return wt(n).onIdTokenChanged(e,t,r)}function RD(n,e,t){return wt(n).beforeAuthStateChanged(e,t)}function xD(n,e,t,r){return wt(n).onAuthStateChanged(e,t,r)}function AD(n){return wt(n).signOut()}const lm="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XP{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(lm,"1"),this.storage.removeItem(lm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ND=1e3,bD=10;class JP extends XP{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=GP(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);Xb()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,bD):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},ND)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}JP.type="LOCAL";const DD=JP;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZP extends XP{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}ZP.type="SESSION";const ek=ZP;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MD(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l0{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new l0(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const l=Array.from(o).map(async h=>h(t.origin,s)),c=await MD(l);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:c})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}l0.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gw(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OD{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((l,c)=>{const h=Gw("",20);i.port1.start();const p=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(m){const _=m;if(_.data.eventId===h)switch(_.data.status){case"ack":clearTimeout(p),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(_.data.response);break;default:clearTimeout(p),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function os(){return window}function LD(n){os().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tk(){return typeof os().WorkerGlobalScope<"u"&&typeof os().importScripts=="function"}async function FD(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function VD(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function UD(){return tk()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nk="firebaseLocalStorageDb",BD=1,um="firebaseLocalStorage",rk="fbase_key";class sf{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function u0(n,e){return n.transaction([um],e?"readwrite":"readonly").objectStore(um)}function zD(){const n=indexedDB.deleteDatabase(nk);return new sf(n).toPromise()}function z1(){const n=indexedDB.open(nk,BD);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(um,{keyPath:rk})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(um)?e(r):(r.close(),await zD(),e(await z1()))})})}async function PT(n,e,t){const r=u0(n,!0).put({[rk]:e,value:t});return new sf(r).toPromise()}async function jD(n,e){const t=u0(n,!1).get(e),r=await new sf(t).toPromise();return r===void 0?null:r.value}function kT(n,e){const t=u0(n,!0).delete(e);return new sf(t).toPromise()}const GD=800,WD=3;class ik{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await z1(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>WD)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return tk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=l0._getInstance(UD()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await FD(),!this.activeServiceWorker)return;this.sender=new OD(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||VD()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await z1();return await PT(e,lm,"1"),await kT(e,lm),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>PT(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>jD(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>kT(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=u0(i,!1).getAll();return new sf(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),GD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}ik.type="LOCAL";const HD=ik;new tf(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sk(n,e){return e?Vs(e):(Ie(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ww extends Bw{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ou(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ou(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ou(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function $D(n){return QP(n.auth,new Ww(n),n.bypassAuthState)}function qD(n){const{auth:e,user:t}=n;return Ie(t,e,"internal-error"),CD(t,new Ww(n),n.bypassAuthState)}async function KD(n){const{auth:e,user:t}=n;return Ie(t,e,"internal-error"),SD(t,new Ww(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ok{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return $D;case"linkViaPopup":case"linkViaRedirect":return KD;case"reauthViaPopup":case"reauthViaRedirect":return qD;default:ci(this.auth,"internal-error")}}resolve(e){Ys(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ys(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QD=new tf(2e3,1e4);async function YD(n,e,t){if(Pi(n.app))return Promise.reject(Ai(n,"operation-not-supported-in-this-environment"));const r=da(n);bb(n,e,jw);const i=sk(r,t);return new Ja(r,"signInViaPopup",e,i).executeNotNull()}class Ja extends ok{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Ja.currentPopupAction&&Ja.currentPopupAction.cancel(),Ja.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ie(e,this.auth,"internal-error"),e}async onExecution(){Ys(this.filter.length===1,"Popup operations only handle one event");const e=Gw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ai(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Ai(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ja.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ai(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,QD.get())};e()}}Ja.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XD="pendingRedirect",yg=new Map;class JD extends ok{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=yg.get(this.auth._key());if(!e){try{const r=await ZD(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}yg.set(this.auth._key(),e)}return this.bypassAuthState||yg.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function ZD(n,e){const t=nM(e),r=tM(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function eM(n,e){yg.set(n._key(),e)}function tM(n){return Vs(n._redirectPersistence)}function nM(n){return _g(XD,n.config.apiKey,n.name)}async function rM(n,e,t=!1){if(Pi(n.app))return Promise.reject(zs(n));const r=da(n),i=sk(r,e),o=await new JD(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iM=10*60*1e3;class sM{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!oM(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!ak(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Ai(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=iM&&this.cachedEventUids.clear(),this.cachedEventUids.has(RT(e))}saveEventToCache(e){this.cachedEventUids.add(RT(e)),this.lastProcessedEventTime=Date.now()}}function RT(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function ak({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function oM(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ak(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aM(n,e={}){return ha(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lM=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,uM=/^https?/;async function cM(n){if(n.config.emulator)return;const{authorizedDomains:e}=await aM(n);for(const t of e)try{if(hM(t))return}catch{}ci(n,"unauthorized-domain")}function hM(n){const e=V1(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!uM.test(t))return!1;if(lM.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dM=new tf(3e4,6e4);function xT(){const n=os().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function fM(n){return new Promise((e,t)=>{var r,i,s;function o(){xT(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{xT(),t(Ai(n,"network-request-failed"))},timeout:dM.get()})}if(!((i=(r=os().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=os().gapi)===null||s===void 0)&&s.load)o();else{const l=oD("iframefcb");return os()[l]=()=>{gapi.load?o():t(Ai(n,"network-request-failed"))},HP(`${sD()}?onload=${l}`).catch(c=>t(c))}}).catch(e=>{throw vg=null,e})}let vg=null;function pM(n){return vg=vg||fM(n),vg}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gM=new tf(5e3,15e3),mM="__/auth/iframe",_M="emulator/auth/iframe",yM={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},vM=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function wM(n){const e=n.config;Ie(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Fw(e,_M):`https://${n.config.authDomain}/${mM}`,r={apiKey:e.apiKey,appName:n.name,v:Sl},i=vM.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${mc(r).slice(1)}`}async function EM(n){const e=await pM(n),t=os().gapi;return Ie(t,n,"internal-error"),e.open({where:document.body,url:wM(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:yM,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=Ai(n,"network-request-failed"),l=os().setTimeout(()=>{s(o)},gM.get());function c(){os().clearTimeout(l),i(r)}r.ping(c).then(c,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SM={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},CM=500,TM=600,IM="_blank",PM="http://localhost";class AT{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function kM(n,e,t,r=CM,i=TM){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},SM),{width:r.toString(),height:i.toString(),top:s,left:o}),h=ar().toLowerCase();t&&(l=VP(h)?IM:t),LP(h)&&(e=e||PM,c.scrollbars="yes");const p=Object.entries(c).reduce((_,[w,S])=>`${_}${w}=${S},`,"");if(Yb(h)&&l!=="_self")return RM(e||"",l),new AT(null);const m=window.open(e||"",l,p);Ie(m,n,"popup-blocked");try{m.focus()}catch{}return new AT(m)}function RM(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xM="__/auth/handler",AM="emulator/auth/handler",NM=encodeURIComponent("fac");async function NT(n,e,t,r,i,s){Ie(n.config.authDomain,n,"auth-domain-config-required"),Ie(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Sl,eventId:i};if(e instanceof jw){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",tm(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,m]of Object.entries({}))o[p]=m}if(e instanceof rf){const p=e.getScopes().filter(m=>m!=="");p.length>0&&(o.scopes=p.join(","))}n.tenantId&&(o.tid=n.tenantId);const l=o;for(const p of Object.keys(l))l[p]===void 0&&delete l[p];const c=await n._getAppCheckToken(),h=c?`#${NM}=${encodeURIComponent(c)}`:"";return`${bM(n)}?${mc(l).slice(1)}${h}`}function bM({config:n}){return n.emulator?Fw(n,AM):`https://${n.authDomain}/${xM}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pv="webStorageSupport";class DM{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ek,this._completeRedirectFn=rM,this._overrideRedirectResult=eM}async _openPopup(e,t,r,i){var s;Ys((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await NT(e,t,r,V1(),i);return kM(e,o,Gw())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await NT(e,t,r,V1(),i);return LD(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Ys(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await EM(e),r=new sM(e);return t.register("authEvent",i=>(Ie(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(pv,{type:pv},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[pv];o!==void 0&&t(!!o),ci(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=cM(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return GP()||FP()||Uw()}}const MM=DM;var bT="@firebase/auth",DT="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OM{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ie(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LM(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function FM(n){ul(new Jo("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;Ie(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:WP(n)},h=new nD(r,i,s,c);return hD(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),ul(new Jo("auth-internal",e=>{const t=da(e.getProvider("auth").getImmediate());return(r=>new OM(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ss(bT,DT,LM(n)),ss(bT,DT,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VM=5*60,UM=vP("authIdTokenMaxAge")||VM;let MT=null;const BM=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>UM)return;const i=t==null?void 0:t.token;MT!==i&&(MT=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function zM(n=Dw()){const e=o0(n,"auth");if(e.isInitialized())return e.getImmediate();const t=cD(n,{popupRedirectResolver:MM,persistence:[HD,DD,ek]}),r=vP("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=BM(s.toString());RD(t,o,()=>o(t.currentUser)),kD(t,l=>o(l))}}const i=mP("auth");return i&&$P(t,`http://${i}`),t}function jM(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}rD({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=Ai("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",jM().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});FM("Browser");var GM="firebase",WM="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ss(GM,WM,"app");var OT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var rl,lk;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(D,T){function b(){}b.prototype=T.prototype,D.D=T.prototype,D.prototype=new b,D.prototype.constructor=D,D.C=function(A,O,U){for(var F=Array(arguments.length-2),ce=2;ce<arguments.length;ce++)F[ce-2]=arguments[ce];return T.prototype[O].apply(A,F)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(D,T,b){b||(b=0);var A=Array(16);if(typeof T=="string")for(var O=0;16>O;++O)A[O]=T.charCodeAt(b++)|T.charCodeAt(b++)<<8|T.charCodeAt(b++)<<16|T.charCodeAt(b++)<<24;else for(O=0;16>O;++O)A[O]=T[b++]|T[b++]<<8|T[b++]<<16|T[b++]<<24;T=D.g[0],b=D.g[1],O=D.g[2];var U=D.g[3],F=T+(U^b&(O^U))+A[0]+3614090360&4294967295;T=b+(F<<7&4294967295|F>>>25),F=U+(O^T&(b^O))+A[1]+3905402710&4294967295,U=T+(F<<12&4294967295|F>>>20),F=O+(b^U&(T^b))+A[2]+606105819&4294967295,O=U+(F<<17&4294967295|F>>>15),F=b+(T^O&(U^T))+A[3]+3250441966&4294967295,b=O+(F<<22&4294967295|F>>>10),F=T+(U^b&(O^U))+A[4]+4118548399&4294967295,T=b+(F<<7&4294967295|F>>>25),F=U+(O^T&(b^O))+A[5]+1200080426&4294967295,U=T+(F<<12&4294967295|F>>>20),F=O+(b^U&(T^b))+A[6]+2821735955&4294967295,O=U+(F<<17&4294967295|F>>>15),F=b+(T^O&(U^T))+A[7]+4249261313&4294967295,b=O+(F<<22&4294967295|F>>>10),F=T+(U^b&(O^U))+A[8]+1770035416&4294967295,T=b+(F<<7&4294967295|F>>>25),F=U+(O^T&(b^O))+A[9]+2336552879&4294967295,U=T+(F<<12&4294967295|F>>>20),F=O+(b^U&(T^b))+A[10]+4294925233&4294967295,O=U+(F<<17&4294967295|F>>>15),F=b+(T^O&(U^T))+A[11]+2304563134&4294967295,b=O+(F<<22&4294967295|F>>>10),F=T+(U^b&(O^U))+A[12]+1804603682&4294967295,T=b+(F<<7&4294967295|F>>>25),F=U+(O^T&(b^O))+A[13]+4254626195&4294967295,U=T+(F<<12&4294967295|F>>>20),F=O+(b^U&(T^b))+A[14]+2792965006&4294967295,O=U+(F<<17&4294967295|F>>>15),F=b+(T^O&(U^T))+A[15]+1236535329&4294967295,b=O+(F<<22&4294967295|F>>>10),F=T+(O^U&(b^O))+A[1]+4129170786&4294967295,T=b+(F<<5&4294967295|F>>>27),F=U+(b^O&(T^b))+A[6]+3225465664&4294967295,U=T+(F<<9&4294967295|F>>>23),F=O+(T^b&(U^T))+A[11]+643717713&4294967295,O=U+(F<<14&4294967295|F>>>18),F=b+(U^T&(O^U))+A[0]+3921069994&4294967295,b=O+(F<<20&4294967295|F>>>12),F=T+(O^U&(b^O))+A[5]+3593408605&4294967295,T=b+(F<<5&4294967295|F>>>27),F=U+(b^O&(T^b))+A[10]+38016083&4294967295,U=T+(F<<9&4294967295|F>>>23),F=O+(T^b&(U^T))+A[15]+3634488961&4294967295,O=U+(F<<14&4294967295|F>>>18),F=b+(U^T&(O^U))+A[4]+3889429448&4294967295,b=O+(F<<20&4294967295|F>>>12),F=T+(O^U&(b^O))+A[9]+568446438&4294967295,T=b+(F<<5&4294967295|F>>>27),F=U+(b^O&(T^b))+A[14]+3275163606&4294967295,U=T+(F<<9&4294967295|F>>>23),F=O+(T^b&(U^T))+A[3]+4107603335&4294967295,O=U+(F<<14&4294967295|F>>>18),F=b+(U^T&(O^U))+A[8]+1163531501&4294967295,b=O+(F<<20&4294967295|F>>>12),F=T+(O^U&(b^O))+A[13]+2850285829&4294967295,T=b+(F<<5&4294967295|F>>>27),F=U+(b^O&(T^b))+A[2]+4243563512&4294967295,U=T+(F<<9&4294967295|F>>>23),F=O+(T^b&(U^T))+A[7]+1735328473&4294967295,O=U+(F<<14&4294967295|F>>>18),F=b+(U^T&(O^U))+A[12]+2368359562&4294967295,b=O+(F<<20&4294967295|F>>>12),F=T+(b^O^U)+A[5]+4294588738&4294967295,T=b+(F<<4&4294967295|F>>>28),F=U+(T^b^O)+A[8]+2272392833&4294967295,U=T+(F<<11&4294967295|F>>>21),F=O+(U^T^b)+A[11]+1839030562&4294967295,O=U+(F<<16&4294967295|F>>>16),F=b+(O^U^T)+A[14]+4259657740&4294967295,b=O+(F<<23&4294967295|F>>>9),F=T+(b^O^U)+A[1]+2763975236&4294967295,T=b+(F<<4&4294967295|F>>>28),F=U+(T^b^O)+A[4]+1272893353&4294967295,U=T+(F<<11&4294967295|F>>>21),F=O+(U^T^b)+A[7]+4139469664&4294967295,O=U+(F<<16&4294967295|F>>>16),F=b+(O^U^T)+A[10]+3200236656&4294967295,b=O+(F<<23&4294967295|F>>>9),F=T+(b^O^U)+A[13]+681279174&4294967295,T=b+(F<<4&4294967295|F>>>28),F=U+(T^b^O)+A[0]+3936430074&4294967295,U=T+(F<<11&4294967295|F>>>21),F=O+(U^T^b)+A[3]+3572445317&4294967295,O=U+(F<<16&4294967295|F>>>16),F=b+(O^U^T)+A[6]+76029189&4294967295,b=O+(F<<23&4294967295|F>>>9),F=T+(b^O^U)+A[9]+3654602809&4294967295,T=b+(F<<4&4294967295|F>>>28),F=U+(T^b^O)+A[12]+3873151461&4294967295,U=T+(F<<11&4294967295|F>>>21),F=O+(U^T^b)+A[15]+530742520&4294967295,O=U+(F<<16&4294967295|F>>>16),F=b+(O^U^T)+A[2]+3299628645&4294967295,b=O+(F<<23&4294967295|F>>>9),F=T+(O^(b|~U))+A[0]+4096336452&4294967295,T=b+(F<<6&4294967295|F>>>26),F=U+(b^(T|~O))+A[7]+1126891415&4294967295,U=T+(F<<10&4294967295|F>>>22),F=O+(T^(U|~b))+A[14]+2878612391&4294967295,O=U+(F<<15&4294967295|F>>>17),F=b+(U^(O|~T))+A[5]+4237533241&4294967295,b=O+(F<<21&4294967295|F>>>11),F=T+(O^(b|~U))+A[12]+1700485571&4294967295,T=b+(F<<6&4294967295|F>>>26),F=U+(b^(T|~O))+A[3]+2399980690&4294967295,U=T+(F<<10&4294967295|F>>>22),F=O+(T^(U|~b))+A[10]+4293915773&4294967295,O=U+(F<<15&4294967295|F>>>17),F=b+(U^(O|~T))+A[1]+2240044497&4294967295,b=O+(F<<21&4294967295|F>>>11),F=T+(O^(b|~U))+A[8]+1873313359&4294967295,T=b+(F<<6&4294967295|F>>>26),F=U+(b^(T|~O))+A[15]+4264355552&4294967295,U=T+(F<<10&4294967295|F>>>22),F=O+(T^(U|~b))+A[6]+2734768916&4294967295,O=U+(F<<15&4294967295|F>>>17),F=b+(U^(O|~T))+A[13]+1309151649&4294967295,b=O+(F<<21&4294967295|F>>>11),F=T+(O^(b|~U))+A[4]+4149444226&4294967295,T=b+(F<<6&4294967295|F>>>26),F=U+(b^(T|~O))+A[11]+3174756917&4294967295,U=T+(F<<10&4294967295|F>>>22),F=O+(T^(U|~b))+A[2]+718787259&4294967295,O=U+(F<<15&4294967295|F>>>17),F=b+(U^(O|~T))+A[9]+3951481745&4294967295,D.g[0]=D.g[0]+T&4294967295,D.g[1]=D.g[1]+(O+(F<<21&4294967295|F>>>11))&4294967295,D.g[2]=D.g[2]+O&4294967295,D.g[3]=D.g[3]+U&4294967295}r.prototype.u=function(D,T){T===void 0&&(T=D.length);for(var b=T-this.blockSize,A=this.B,O=this.h,U=0;U<T;){if(O==0)for(;U<=b;)i(this,D,U),U+=this.blockSize;if(typeof D=="string"){for(;U<T;)if(A[O++]=D.charCodeAt(U++),O==this.blockSize){i(this,A),O=0;break}}else for(;U<T;)if(A[O++]=D[U++],O==this.blockSize){i(this,A),O=0;break}}this.h=O,this.o+=T},r.prototype.v=function(){var D=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);D[0]=128;for(var T=1;T<D.length-8;++T)D[T]=0;var b=8*this.o;for(T=D.length-8;T<D.length;++T)D[T]=b&255,b/=256;for(this.u(D),D=Array(16),T=b=0;4>T;++T)for(var A=0;32>A;A+=8)D[b++]=this.g[T]>>>A&255;return D};function s(D,T){var b=l;return Object.prototype.hasOwnProperty.call(b,D)?b[D]:b[D]=T(D)}function o(D,T){this.h=T;for(var b=[],A=!0,O=D.length-1;0<=O;O--){var U=D[O]|0;A&&U==T||(b[O]=U,A=!1)}this.g=b}var l={};function c(D){return-128<=D&&128>D?s(D,function(T){return new o([T|0],0>T?-1:0)}):new o([D|0],0>D?-1:0)}function h(D){if(isNaN(D)||!isFinite(D))return m;if(0>D)return N(h(-D));for(var T=[],b=1,A=0;D>=b;A++)T[A]=D/b|0,b*=4294967296;return new o(T,0)}function p(D,T){if(D.length==0)throw Error("number format error: empty string");if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(D.charAt(0)=="-")return N(p(D.substring(1),T));if(0<=D.indexOf("-"))throw Error('number format error: interior "-" character');for(var b=h(Math.pow(T,8)),A=m,O=0;O<D.length;O+=8){var U=Math.min(8,D.length-O),F=parseInt(D.substring(O,O+U),T);8>U?(U=h(Math.pow(T,U)),A=A.j(U).add(h(F))):(A=A.j(b),A=A.add(h(F)))}return A}var m=c(0),_=c(1),w=c(16777216);n=o.prototype,n.m=function(){if(k(this))return-N(this).m();for(var D=0,T=1,b=0;b<this.g.length;b++){var A=this.i(b);D+=(0<=A?A:4294967296+A)*T,T*=4294967296}return D},n.toString=function(D){if(D=D||10,2>D||36<D)throw Error("radix out of range: "+D);if(S(this))return"0";if(k(this))return"-"+N(this).toString(D);for(var T=h(Math.pow(D,6)),b=this,A="";;){var O=P(b,T).g;b=x(b,O.j(T));var U=((0<b.g.length?b.g[0]:b.h)>>>0).toString(D);if(b=O,S(b))return U+A;for(;6>U.length;)U="0"+U;A=U+A}},n.i=function(D){return 0>D?0:D<this.g.length?this.g[D]:this.h};function S(D){if(D.h!=0)return!1;for(var T=0;T<D.g.length;T++)if(D.g[T]!=0)return!1;return!0}function k(D){return D.h==-1}n.l=function(D){return D=x(this,D),k(D)?-1:S(D)?0:1};function N(D){for(var T=D.g.length,b=[],A=0;A<T;A++)b[A]=~D.g[A];return new o(b,~D.h).add(_)}n.abs=function(){return k(this)?N(this):this},n.add=function(D){for(var T=Math.max(this.g.length,D.g.length),b=[],A=0,O=0;O<=T;O++){var U=A+(this.i(O)&65535)+(D.i(O)&65535),F=(U>>>16)+(this.i(O)>>>16)+(D.i(O)>>>16);A=F>>>16,U&=65535,F&=65535,b[O]=F<<16|U}return new o(b,b[b.length-1]&-2147483648?-1:0)};function x(D,T){return D.add(N(T))}n.j=function(D){if(S(this)||S(D))return m;if(k(this))return k(D)?N(this).j(N(D)):N(N(this).j(D));if(k(D))return N(this.j(N(D)));if(0>this.l(w)&&0>D.l(w))return h(this.m()*D.m());for(var T=this.g.length+D.g.length,b=[],A=0;A<2*T;A++)b[A]=0;for(A=0;A<this.g.length;A++)for(var O=0;O<D.g.length;O++){var U=this.i(A)>>>16,F=this.i(A)&65535,ce=D.i(O)>>>16,le=D.i(O)&65535;b[2*A+2*O]+=F*le,R(b,2*A+2*O),b[2*A+2*O+1]+=U*le,R(b,2*A+2*O+1),b[2*A+2*O+1]+=F*ce,R(b,2*A+2*O+1),b[2*A+2*O+2]+=U*ce,R(b,2*A+2*O+2)}for(A=0;A<T;A++)b[A]=b[2*A+1]<<16|b[2*A];for(A=T;A<2*T;A++)b[A]=0;return new o(b,0)};function R(D,T){for(;(D[T]&65535)!=D[T];)D[T+1]+=D[T]>>>16,D[T]&=65535,T++}function E(D,T){this.g=D,this.h=T}function P(D,T){if(S(T))throw Error("division by zero");if(S(D))return new E(m,m);if(k(D))return T=P(N(D),T),new E(N(T.g),N(T.h));if(k(T))return T=P(D,N(T)),new E(N(T.g),T.h);if(30<D.g.length){if(k(D)||k(T))throw Error("slowDivide_ only works with positive integers.");for(var b=_,A=T;0>=A.l(D);)b=V(b),A=V(A);var O=B(b,1),U=B(A,1);for(A=B(A,2),b=B(b,2);!S(A);){var F=U.add(A);0>=F.l(D)&&(O=O.add(b),U=F),A=B(A,1),b=B(b,1)}return T=x(D,O.j(T)),new E(O,T)}for(O=m;0<=D.l(T);){for(b=Math.max(1,Math.floor(D.m()/T.m())),A=Math.ceil(Math.log(b)/Math.LN2),A=48>=A?1:Math.pow(2,A-48),U=h(b),F=U.j(T);k(F)||0<F.l(D);)b-=A,U=h(b),F=U.j(T);S(U)&&(U=_),O=O.add(U),D=x(D,F)}return new E(O,D)}n.A=function(D){return P(this,D).h},n.and=function(D){for(var T=Math.max(this.g.length,D.g.length),b=[],A=0;A<T;A++)b[A]=this.i(A)&D.i(A);return new o(b,this.h&D.h)},n.or=function(D){for(var T=Math.max(this.g.length,D.g.length),b=[],A=0;A<T;A++)b[A]=this.i(A)|D.i(A);return new o(b,this.h|D.h)},n.xor=function(D){for(var T=Math.max(this.g.length,D.g.length),b=[],A=0;A<T;A++)b[A]=this.i(A)^D.i(A);return new o(b,this.h^D.h)};function V(D){for(var T=D.g.length+1,b=[],A=0;A<T;A++)b[A]=D.i(A)<<1|D.i(A-1)>>>31;return new o(b,D.h)}function B(D,T){var b=T>>5;T%=32;for(var A=D.g.length-b,O=[],U=0;U<A;U++)O[U]=0<T?D.i(U+b)>>>T|D.i(U+b+1)<<32-T:D.i(U+b);return new o(O,D.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,lk=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=p,rl=o}).apply(typeof OT<"u"?OT:typeof self<"u"?self:typeof window<"u"?window:{});var $p=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var uk,Vh,ck,wg,j1,hk,dk,fk;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(d,v,I){return d==Array.prototype||d==Object.prototype||(d[v]=I.value),d};function t(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof $p=="object"&&$p];for(var v=0;v<d.length;++v){var I=d[v];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var r=t(this);function i(d,v){if(v)e:{var I=r;d=d.split(".");for(var M=0;M<d.length-1;M++){var H=d[M];if(!(H in I))break e;I=I[H]}d=d[d.length-1],M=I[d],v=v(M),v!=M&&v!=null&&e(I,d,{configurable:!0,writable:!0,value:v})}}function s(d,v){d instanceof String&&(d+="");var I=0,M=!1,H={next:function(){if(!M&&I<d.length){var Q=I++;return{value:v(Q,d[Q]),done:!1}}return M=!0,{done:!0,value:void 0}}};return H[Symbol.iterator]=function(){return H},H}i("Array.prototype.values",function(d){return d||function(){return s(this,function(v,I){return I})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(d){var v=typeof d;return v=v!="object"?v:d?Array.isArray(d)?"array":v:"null",v=="array"||v=="object"&&typeof d.length=="number"}function h(d){var v=typeof d;return v=="object"&&d!=null||v=="function"}function p(d,v,I){return d.call.apply(d.bind,arguments)}function m(d,v,I){if(!d)throw Error();if(2<arguments.length){var M=Array.prototype.slice.call(arguments,2);return function(){var H=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(H,M),d.apply(v,H)}}return function(){return d.apply(v,arguments)}}function _(d,v,I){return _=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:m,_.apply(null,arguments)}function w(d,v){var I=Array.prototype.slice.call(arguments,1);return function(){var M=I.slice();return M.push.apply(M,arguments),d.apply(this,M)}}function S(d,v){function I(){}I.prototype=v.prototype,d.aa=v.prototype,d.prototype=new I,d.prototype.constructor=d,d.Qb=function(M,H,Q){for(var oe=Array(arguments.length-2),Ze=2;Ze<arguments.length;Ze++)oe[Ze-2]=arguments[Ze];return v.prototype[H].apply(M,oe)}}function k(d){const v=d.length;if(0<v){const I=Array(v);for(let M=0;M<v;M++)I[M]=d[M];return I}return[]}function N(d,v){for(let I=1;I<arguments.length;I++){const M=arguments[I];if(c(M)){const H=d.length||0,Q=M.length||0;d.length=H+Q;for(let oe=0;oe<Q;oe++)d[H+oe]=M[oe]}else d.push(M)}}class x{constructor(v,I){this.i=v,this.j=I,this.h=0,this.g=null}get(){let v;return 0<this.h?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function R(d){return/^[\s\xa0]*$/.test(d)}function E(){var d=l.navigator;return d&&(d=d.userAgent)?d:""}function P(d){return P[" "](d),d}P[" "]=function(){};var V=E().indexOf("Gecko")!=-1&&!(E().toLowerCase().indexOf("webkit")!=-1&&E().indexOf("Edge")==-1)&&!(E().indexOf("Trident")!=-1||E().indexOf("MSIE")!=-1)&&E().indexOf("Edge")==-1;function B(d,v,I){for(const M in d)v.call(I,d[M],M,d)}function D(d,v){for(const I in d)v.call(void 0,d[I],I,d)}function T(d){const v={};for(const I in d)v[I]=d[I];return v}const b="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function A(d,v){let I,M;for(let H=1;H<arguments.length;H++){M=arguments[H];for(I in M)d[I]=M[I];for(let Q=0;Q<b.length;Q++)I=b[Q],Object.prototype.hasOwnProperty.call(M,I)&&(d[I]=M[I])}}function O(d){var v=1;d=d.split(":");const I=[];for(;0<v&&d.length;)I.push(d.shift()),v--;return d.length&&I.push(d.join(":")),I}function U(d){l.setTimeout(()=>{throw d},0)}function F(){var d=J;let v=null;return d.g&&(v=d.g,d.g=d.g.next,d.g||(d.h=null),v.next=null),v}class ce{constructor(){this.h=this.g=null}add(v,I){const M=le.get();M.set(v,I),this.h?this.h.next=M:this.g=M,this.h=M}}var le=new x(()=>new Me,d=>d.reset());class Me{constructor(){this.next=this.g=this.h=null}set(v,I){this.h=v,this.g=I,this.next=null}reset(){this.next=this.g=this.h=null}}let be,$=!1,J=new ce,ee=()=>{const d=l.Promise.resolve(void 0);be=()=>{d.then(Z)}};var Z=()=>{for(var d;d=F();){try{d.h.call(d.g)}catch(I){U(I)}var v=le;v.j(d),100>v.h&&(v.h++,d.next=v.g,v.g=d)}$=!1};function ie(){this.s=this.s,this.C=this.C}ie.prototype.s=!1,ie.prototype.ma=function(){this.s||(this.s=!0,this.N())},ie.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function _e(d,v){this.type=d,this.g=this.target=v,this.defaultPrevented=!1}_e.prototype.h=function(){this.defaultPrevented=!0};var Tt=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var d=!1,v=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const I=()=>{};l.addEventListener("test",I,v),l.removeEventListener("test",I,v)}catch{}return d}();function dt(d,v){if(_e.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d){var I=this.type=d.type,M=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;if(this.target=d.target||d.srcElement,this.g=v,v=d.relatedTarget){if(V){e:{try{P(v.nodeName);var H=!0;break e}catch{}H=!1}H||(v=null)}}else I=="mouseover"?v=d.fromElement:I=="mouseout"&&(v=d.toElement);this.relatedTarget=v,M?(this.clientX=M.clientX!==void 0?M.clientX:M.pageX,this.clientY=M.clientY!==void 0?M.clientY:M.pageY,this.screenX=M.screenX||0,this.screenY=M.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=typeof d.pointerType=="string"?d.pointerType:Ve[d.pointerType]||"",this.state=d.state,this.i=d,d.defaultPrevented&&dt.aa.h.call(this)}}S(dt,_e);var Ve={2:"touch",3:"pen",4:"mouse"};dt.prototype.h=function(){dt.aa.h.call(this);var d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var j="closure_listenable_"+(1e6*Math.random()|0),te=0;function ve(d,v,I,M,H){this.listener=d,this.proxy=null,this.src=v,this.type=I,this.capture=!!M,this.ha=H,this.key=++te,this.da=this.fa=!1}function De(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function Ce(d){this.src=d,this.g={},this.h=0}Ce.prototype.add=function(d,v,I,M,H){var Q=d.toString();d=this.g[Q],d||(d=this.g[Q]=[],this.h++);var oe=lt(d,v,M,H);return-1<oe?(v=d[oe],I||(v.fa=!1)):(v=new ve(v,this.src,Q,!!M,H),v.fa=I,d.push(v)),v};function Qe(d,v){var I=v.type;if(I in d.g){var M=d.g[I],H=Array.prototype.indexOf.call(M,v,void 0),Q;(Q=0<=H)&&Array.prototype.splice.call(M,H,1),Q&&(De(v),d.g[I].length==0&&(delete d.g[I],d.h--))}}function lt(d,v,I,M){for(var H=0;H<d.length;++H){var Q=d[H];if(!Q.da&&Q.listener==v&&Q.capture==!!I&&Q.ha==M)return H}return-1}var Kt="closure_lm_"+(1e6*Math.random()|0),Ge={};function ur(d,v,I,M,H){if(Array.isArray(v)){for(var Q=0;Q<v.length;Q++)ur(d,v[Q],I,M,H);return null}return I=kf(I),d&&d[j]?d.K(v,I,h(M)?!!M.capture:!1,H):Fr(d,v,I,!1,M,H)}function Fr(d,v,I,M,H,Q){if(!v)throw Error("Invalid event type");var oe=h(H)?!!H.capture:!!H,Ze=Mc(d);if(Ze||(d[Kt]=Ze=new Ce(d)),I=Ze.add(v,I,M,oe,Q),I.proxy)return I;if(M=Fi(),I.proxy=M,M.src=d,M.listener=I,d.addEventListener)Tt||(H=oe),H===void 0&&(H=!1),d.addEventListener(v.toString(),M,H);else if(d.attachEvent)d.attachEvent(Pf(v.toString()),M);else if(d.addListener&&d.removeListener)d.addListener(M);else throw Error("addEventListener and attachEvent are unavailable.");return I}function Fi(){function d(I){return v.call(d.src,d.listener,I)}const v=O_;return d}function If(d,v,I,M,H){if(Array.isArray(v))for(var Q=0;Q<v.length;Q++)If(d,v[Q],I,M,H);else M=h(M)?!!M.capture:!!M,I=kf(I),d&&d[j]?(d=d.i,v=String(v).toString(),v in d.g&&(Q=d.g[v],I=lt(Q,I,M,H),-1<I&&(De(Q[I]),Array.prototype.splice.call(Q,I,1),Q.length==0&&(delete d.g[v],d.h--)))):d&&(d=Mc(d))&&(v=d.g[v.toString()],d=-1,v&&(d=lt(v,I,M,H)),(I=-1<d?v[d]:null)&&ds(I))}function ds(d){if(typeof d!="number"&&d&&!d.da){var v=d.src;if(v&&v[j])Qe(v.i,d);else{var I=d.type,M=d.proxy;v.removeEventListener?v.removeEventListener(I,M,d.capture):v.detachEvent?v.detachEvent(Pf(I),M):v.addListener&&v.removeListener&&v.removeListener(M),(I=Mc(v))?(Qe(I,d),I.h==0&&(I.src=null,v[Kt]=null)):De(d)}}}function Pf(d){return d in Ge?Ge[d]:Ge[d]="on"+d}function O_(d,v){if(d.da)d=!0;else{v=new dt(v,this);var I=d.listener,M=d.ha||d.src;d.fa&&ds(d),d=I.call(M,v)}return d}function Mc(d){return d=d[Kt],d instanceof Ce?d:null}var fs="__closure_events_fn_"+(1e9*Math.random()>>>0);function kf(d){return typeof d=="function"?d:(d[fs]||(d[fs]=function(v){return d.handleEvent(v)}),d[fs])}function fn(){ie.call(this),this.i=new Ce(this),this.M=this,this.F=null}S(fn,ie),fn.prototype[j]=!0,fn.prototype.removeEventListener=function(d,v,I,M){If(this,d,v,I,M)};function xn(d,v){var I,M=d.F;if(M)for(I=[];M;M=M.F)I.push(M);if(d=d.M,M=v.type||v,typeof v=="string")v=new _e(v,d);else if(v instanceof _e)v.target=v.target||d;else{var H=v;v=new _e(M,d),A(v,H)}if(H=!0,I)for(var Q=I.length-1;0<=Q;Q--){var oe=v.g=I[Q];H=Ll(oe,M,!0,v)&&H}if(oe=v.g=d,H=Ll(oe,M,!0,v)&&H,H=Ll(oe,M,!1,v)&&H,I)for(Q=0;Q<I.length;Q++)oe=v.g=I[Q],H=Ll(oe,M,!1,v)&&H}fn.prototype.N=function(){if(fn.aa.N.call(this),this.i){var d=this.i,v;for(v in d.g){for(var I=d.g[v],M=0;M<I.length;M++)De(I[M]);delete d.g[v],d.h--}}this.F=null},fn.prototype.K=function(d,v,I,M){return this.i.add(String(d),v,!1,I,M)},fn.prototype.L=function(d,v,I,M){return this.i.add(String(d),v,!0,I,M)};function Ll(d,v,I,M){if(v=d.i.g[String(v)],!v)return!0;v=v.concat();for(var H=!0,Q=0;Q<v.length;++Q){var oe=v[Q];if(oe&&!oe.da&&oe.capture==I){var Ze=oe.listener,jt=oe.ha||oe.src;oe.fa&&Qe(d.i,oe),H=Ze.call(jt,M)!==!1&&H}}return H&&!M.defaultPrevented}function Rf(d,v,I){if(typeof d=="function")I&&(d=_(d,I));else if(d&&typeof d.handleEvent=="function")d=_(d.handleEvent,d);else throw Error("Invalid listener argument");return 2147483647<Number(v)?-1:l.setTimeout(d,v||0)}function xf(d){d.g=Rf(()=>{d.g=null,d.i&&(d.i=!1,xf(d))},d.l);const v=d.h;d.h=null,d.m.apply(null,v)}class L_ extends ie{constructor(v,I){super(),this.m=v,this.l=I,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:xf(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Pa(d){ie.call(this),this.h=d,this.g={}}S(Pa,ie);var Af=[];function Nf(d){B(d.g,function(v,I){this.g.hasOwnProperty(I)&&ds(v)},d),d.g={}}Pa.prototype.N=function(){Pa.aa.N.call(this),Nf(this)},Pa.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Oc=l.JSON.stringify,F_=l.JSON.parse,bf=class{stringify(d){return l.JSON.stringify(d,void 0)}parse(d){return l.JSON.parse(d,void 0)}};function Lc(){}Lc.prototype.h=null;function Df(d){return d.h||(d.h=d.i())}function Mf(){}var ka={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Fc(){_e.call(this,"d")}S(Fc,_e);function Vc(){_e.call(this,"c")}S(Vc,_e);var Vi={},Uc=null;function Fl(){return Uc=Uc||new fn}Vi.La="serverreachability";function Vl(d){_e.call(this,Vi.La,d)}S(Vl,_e);function oo(d){const v=Fl();xn(v,new Vl(v))}Vi.STAT_EVENT="statevent";function Bc(d,v){_e.call(this,Vi.STAT_EVENT,d),this.stat=v}S(Bc,_e);function An(d){const v=Fl();xn(v,new Bc(v,d))}Vi.Ma="timingevent";function Of(d,v){_e.call(this,Vi.Ma,d),this.size=v}S(Of,_e);function Ra(d,v){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){d()},v)}function ao(){this.g=!0}ao.prototype.xa=function(){this.g=!1};function zc(d,v,I,M,H,Q){d.info(function(){if(d.g)if(Q)for(var oe="",Ze=Q.split("&"),jt=0;jt<Ze.length;jt++){var He=Ze[jt].split("=");if(1<He.length){var rn=He[0];He=He[1];var Yt=rn.split("_");oe=2<=Yt.length&&Yt[1]=="type"?oe+(rn+"="+He+"&"):oe+(rn+"=redacted&")}}else oe=null;else oe=Q;return"XMLHTTP REQ ("+M+") [attempt "+H+"]: "+v+`
`+I+`
`+oe})}function V_(d,v,I,M,H,Q,oe){d.info(function(){return"XMLHTTP RESP ("+M+") [ attempt "+H+"]: "+v+`
`+I+`
`+Q+" "+oe})}function lo(d,v,I,M){d.info(function(){return"XMLHTTP TEXT ("+v+"): "+U_(d,I)+(M?" "+M:"")})}function Ul(d,v){d.info(function(){return"TIMEOUT: "+v})}ao.prototype.info=function(){};function U_(d,v){if(!d.g)return v;if(!v)return null;try{var I=JSON.parse(v);if(I){for(d=0;d<I.length;d++)if(Array.isArray(I[d])){var M=I[d];if(!(2>M.length)){var H=M[1];if(Array.isArray(H)&&!(1>H.length)){var Q=H[0];if(Q!="noop"&&Q!="stop"&&Q!="close")for(var oe=1;oe<H.length;oe++)H[oe]=""}}}}return Oc(I)}catch{return v}}var Bl={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Lf={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},jc;function zl(){}S(zl,Lc),zl.prototype.g=function(){return new XMLHttpRequest},zl.prototype.i=function(){return{}},jc=new zl;function Ui(d,v,I,M){this.j=d,this.i=v,this.l=I,this.R=M||1,this.U=new Pa(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ff}function Ff(){this.i=null,this.g="",this.h=!1}var Vf={},Gc={};function Wc(d,v,I){d.L=1,d.v=Wl(Sr(v)),d.m=I,d.P=!0,Uf(d,null)}function Uf(d,v){d.F=Date.now(),jl(d),d.A=Sr(d.v);var I=d.A,M=d.R;Array.isArray(M)||(M=[String(M)]),Ye(I.i,"t",M),d.C=0,I=d.j.J,d.h=new Ff,d.g=eh(d.j,I?v:null,!d.m),0<d.O&&(d.M=new L_(_(d.Y,d,d.g),d.O)),v=d.U,I=d.g,M=d.ca;var H="readystatechange";Array.isArray(H)||(H&&(Af[0]=H.toString()),H=Af);for(var Q=0;Q<H.length;Q++){var oe=ur(I,H[Q],M||v.handleEvent,!1,v.h||v);if(!oe)break;v.g[oe.key]=oe}v=d.H?T(d.H):{},d.m?(d.u||(d.u="POST"),v["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.A,d.u,d.m,v)):(d.u="GET",d.g.ea(d.A,d.u,null,v)),oo(),zc(d.i,d.u,d.A,d.l,d.R,d.m)}Ui.prototype.ca=function(d){d=d.target;const v=this.M;v&&Hn(d)==3?v.j():this.Y(d)},Ui.prototype.Y=function(d){try{if(d==this.g)e:{const Yt=Hn(this.g);var v=this.g.Ba();const Hi=this.g.Z();if(!(3>Yt)&&(Yt!=3||this.g&&(this.h.h||this.g.oa()||Da(this.g)))){this.J||Yt!=4||v==7||(v==8||0>=Hi?oo(3):oo(2)),ps(this);var I=this.g.Z();this.X=I;t:if(Bf(this)){var M=Da(this.g);d="";var H=M.length,Q=Hn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){hi(this),gs(this);var oe="";break t}this.h.i=new l.TextDecoder}for(v=0;v<H;v++)this.h.h=!0,d+=this.h.i.decode(M[v],{stream:!(Q&&v==H-1)});M.length=0,this.h.g+=d,this.C=0,oe=this.h.g}else oe=this.g.oa();if(this.o=I==200,V_(this.i,this.u,this.A,this.l,this.R,Yt,I),this.o){if(this.T&&!this.K){t:{if(this.g){var Ze,jt=this.g;if((Ze=jt.g?jt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!R(Ze)){var He=Ze;break t}}He=null}if(I=He)lo(this.i,this.l,I,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Hc(this,I);else{this.o=!1,this.s=3,An(12),hi(this),gs(this);break e}}if(this.P){I=!0;let gn;for(;!this.J&&this.C<oe.length;)if(gn=B_(this,oe),gn==Gc){Yt==4&&(this.s=4,An(14),I=!1),lo(this.i,this.l,null,"[Incomplete Response]");break}else if(gn==Vf){this.s=4,An(15),lo(this.i,this.l,oe,"[Invalid Chunk]"),I=!1;break}else lo(this.i,this.l,gn,null),Hc(this,gn);if(Bf(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Yt!=4||oe.length!=0||this.h.h||(this.s=1,An(16),I=!1),this.o=this.o&&I,!I)lo(this.i,this.l,oe,"[Invalid Chunked Response]"),hi(this),gs(this);else if(0<oe.length&&!this.W){this.W=!0;var rn=this.j;rn.g==this&&rn.ba&&!rn.M&&(rn.j.info("Great, no buffering proxy detected. Bytes received: "+oe.length),Ss(rn),rn.M=!0,An(11))}}else lo(this.i,this.l,oe,null),Hc(this,oe);Yt==4&&hi(this),this.o&&!this.J&&(Yt==4?Jc(this.j,this):(this.o=!1,jl(this)))}else Ql(this.g),I==400&&0<oe.indexOf("Unknown SID")?(this.s=3,An(12)):(this.s=0,An(13)),hi(this),gs(this)}}}catch{}finally{}};function Bf(d){return d.g?d.u=="GET"&&d.L!=2&&d.j.Ca:!1}function B_(d,v){var I=d.C,M=v.indexOf(`
`,I);return M==-1?Gc:(I=Number(v.substring(I,M)),isNaN(I)?Vf:(M+=1,M+I>v.length?Gc:(v=v.slice(M,M+I),d.C=M+I,v)))}Ui.prototype.cancel=function(){this.J=!0,hi(this)};function jl(d){d.S=Date.now()+d.I,Gl(d,d.I)}function Gl(d,v){if(d.B!=null)throw Error("WatchDog timer not null");d.B=Ra(_(d.ba,d),v)}function ps(d){d.B&&(l.clearTimeout(d.B),d.B=null)}Ui.prototype.ba=function(){this.B=null;const d=Date.now();0<=d-this.S?(Ul(this.i,this.A),this.L!=2&&(oo(),An(17)),hi(this),this.s=2,gs(this)):Gl(this,this.S-d)};function gs(d){d.j.G==0||d.J||Jc(d.j,d)}function hi(d){ps(d);var v=d.M;v&&typeof v.ma=="function"&&v.ma(),d.M=null,Nf(d.U),d.g&&(v=d.g,d.g=null,v.abort(),v.ma())}function Hc(d,v){try{var I=d.j;if(I.G!=0&&(I.g==d||ut(I.h,d))){if(!d.K&&ut(I.h,d)&&I.G==3){try{var M=I.Da.g.parse(v)}catch{M=null}if(Array.isArray(M)&&M.length==3){var H=M;if(H[0]==0){e:if(!I.u){if(I.g)if(I.g.F+3e3<d.F)Ma(I),Tr(I);else break e;pt(I),An(18)}}else I.za=H[1],0<I.za-I.T&&37500>H[2]&&I.F&&I.v==0&&!I.C&&(I.C=Ra(_(I.Za,I),6e3));if(1>=ft(I.h)&&I.ca){try{I.ca()}catch{}I.ca=void 0}}else gi(I,11)}else if((d.K||I.g==d)&&Ma(I),!R(v))for(H=I.Da.g.parse(v),v=0;v<H.length;v++){let He=H[v];if(I.T=He[0],He=He[1],I.G==2)if(He[0]=="c"){I.K=He[1],I.ia=He[2];const rn=He[3];rn!=null&&(I.la=rn,I.j.info("VER="+I.la));const Yt=He[4];Yt!=null&&(I.Aa=Yt,I.j.info("SVER="+I.Aa));const Hi=He[5];Hi!=null&&typeof Hi=="number"&&0<Hi&&(M=1.5*Hi,I.L=M,I.j.info("backChannelRequestTimeoutMs_="+M)),M=I;const gn=d.g;if(gn){const Dn=gn.g?gn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Dn){var Q=M.h;Q.g||Dn.indexOf("spdy")==-1&&Dn.indexOf("quic")==-1&&Dn.indexOf("h2")==-1||(Q.j=Q.l,Q.g=new Set,Q.h&&(qr(Q,Q.h),Q.h=null))}if(M.D){const mi=gn.g?gn.g.getResponseHeader("X-HTTP-Session-Id"):null;mi&&(M.ya=mi,mt(M.I,M.D,mi))}}I.G=3,I.l&&I.l.ua(),I.ba&&(I.R=Date.now()-d.F,I.j.info("Handshake RTT: "+I.R+"ms")),M=I;var oe=d;if(M.qa=Oa(M,M.J?M.ia:null,M.W),oe.K){nn(M.h,oe);var Ze=oe,jt=M.L;jt&&(Ze.I=jt),Ze.B&&(ps(Ze),jl(Ze)),M.g=oe}else dr(M);0<I.i.length&&Qr(I)}else He[0]!="stop"&&He[0]!="close"||gi(I,7);else I.G==3&&(He[0]=="stop"||He[0]=="close"?He[0]=="stop"?gi(I,7):pi(I):He[0]!="noop"&&I.l&&I.l.ta(He),I.v=0)}}oo(4)}catch{}}var $c=class{constructor(d,v){this.g=d,this.map=v}};function ms(d){this.l=d||10,l.PerformanceNavigationTiming?(d=l.performance.getEntriesByType("navigation"),d=0<d.length&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function di(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function ft(d){return d.h?1:d.g?d.g.size:0}function ut(d,v){return d.h?d.h==v:d.g?d.g.has(v):!1}function qr(d,v){d.g?d.g.add(v):d.h=v}function nn(d,v){d.h&&d.h==v?d.h=null:d.g&&d.g.has(v)&&d.g.delete(v)}ms.prototype.cancel=function(){if(this.i=Nn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function Nn(d){if(d.h!=null)return d.i.concat(d.h.D);if(d.g!=null&&d.g.size!==0){let v=d.i;for(const I of d.g.values())v=v.concat(I.D);return v}return k(d.i)}function _s(d){if(d.V&&typeof d.V=="function")return d.V();if(typeof Map<"u"&&d instanceof Map||typeof Set<"u"&&d instanceof Set)return Array.from(d.values());if(typeof d=="string")return d.split("");if(c(d)){for(var v=[],I=d.length,M=0;M<I;M++)v.push(d[M]);return v}v=[],I=0;for(M in d)v[I++]=d[M];return v}function uo(d){if(d.na&&typeof d.na=="function")return d.na();if(!d.V||typeof d.V!="function"){if(typeof Map<"u"&&d instanceof Map)return Array.from(d.keys());if(!(typeof Set<"u"&&d instanceof Set)){if(c(d)||typeof d=="string"){var v=[];d=d.length;for(var I=0;I<d;I++)v.push(I);return v}v=[],I=0;for(const M in d)v[I++]=M;return v}}}function bn(d,v){if(d.forEach&&typeof d.forEach=="function")d.forEach(v,void 0);else if(c(d)||typeof d=="string")Array.prototype.forEach.call(d,v,void 0);else for(var I=uo(d),M=_s(d),H=M.length,Q=0;Q<H;Q++)v.call(void 0,M[Q],I&&I[Q],d)}var xa=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function zf(d,v){if(d){d=d.split("&");for(var I=0;I<d.length;I++){var M=d[I].indexOf("="),H=null;if(0<=M){var Q=d[I].substring(0,M);H=d[I].substring(M+1)}else Q=d[I];v(Q,H?decodeURIComponent(H.replace(/\+/g," ")):"")}}}function Bi(d){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,d instanceof Bi){this.h=d.h,Aa(this,d.j),this.o=d.o,this.g=d.g,Gn(this,d.s),this.l=d.l;var v=d.i,I=new ys;I.i=v.i,v.g&&(I.g=new Map(v.g),I.h=v.h),jf(this,I),this.m=d.m}else d&&(v=String(d).match(xa))?(this.h=!1,Aa(this,v[1]||"",!0),this.o=zi(v[2]||""),this.g=zi(v[3]||"",!0),Gn(this,v[4]),this.l=zi(v[5]||"",!0),jf(this,v[6]||"",!0),this.m=zi(v[7]||"")):(this.h=!1,this.i=new ys(null,this.h))}Bi.prototype.toString=function(){var d=[],v=this.j;v&&d.push(ji(v,ba,!0),":");var I=this.g;return(I||v=="file")&&(d.push("//"),(v=this.o)&&d.push(ji(v,ba,!0),"@"),d.push(encodeURIComponent(String(I)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),I=this.s,I!=null&&d.push(":",String(I))),(I=this.l)&&(this.g&&I.charAt(0)!="/"&&d.push("/"),d.push(ji(I,I.charAt(0)=="/"?j_:z_,!0))),(I=this.i.toString())&&d.push("?",I),(I=this.m)&&d.push("#",ji(I,Gf)),d.join("")};function Sr(d){return new Bi(d)}function Aa(d,v,I){d.j=I?zi(v,!0):v,d.j&&(d.j=d.j.replace(/:$/,""))}function Gn(d,v){if(v){if(v=Number(v),isNaN(v)||0>v)throw Error("Bad port number "+v);d.s=v}else d.s=null}function jf(d,v,I){v instanceof ys?(d.i=v,Kc(d.i,d.h)):(I||(v=ji(v,qc)),d.i=new ys(v,d.h))}function mt(d,v,I){d.i.set(v,I)}function Wl(d){return mt(d,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),d}function zi(d,v){return d?v?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function ji(d,v,I){return typeof d=="string"?(d=encodeURI(d).replace(v,Na),I&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function Na(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var ba=/[#\/\?@]/g,z_=/[#\?:]/g,j_=/[#\?]/g,qc=/[#\?@]/g,Gf=/#/g;function ys(d,v){this.h=this.g=null,this.i=d||null,this.j=!!v}function Cr(d){d.g||(d.g=new Map,d.h=0,d.i&&zf(d.i,function(v,I){d.add(decodeURIComponent(v.replace(/\+/g," ")),I)}))}n=ys.prototype,n.add=function(d,v){Cr(this),this.i=null,d=vs(this,d);var I=this.g.get(d);return I||this.g.set(d,I=[]),I.push(v),this.h+=1,this};function Wf(d,v){Cr(d),v=vs(d,v),d.g.has(v)&&(d.i=null,d.h-=d.g.get(v).length,d.g.delete(v))}function Hl(d,v){return Cr(d),v=vs(d,v),d.g.has(v)}n.forEach=function(d,v){Cr(this),this.g.forEach(function(I,M){I.forEach(function(H){d.call(v,H,M,this)},this)},this)},n.na=function(){Cr(this);const d=Array.from(this.g.values()),v=Array.from(this.g.keys()),I=[];for(let M=0;M<v.length;M++){const H=d[M];for(let Q=0;Q<H.length;Q++)I.push(v[M])}return I},n.V=function(d){Cr(this);let v=[];if(typeof d=="string")Hl(this,d)&&(v=v.concat(this.g.get(vs(this,d))));else{d=Array.from(this.g.values());for(let I=0;I<d.length;I++)v=v.concat(d[I])}return v},n.set=function(d,v){return Cr(this),this.i=null,d=vs(this,d),Hl(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[v]),this.h+=1,this},n.get=function(d,v){return d?(d=this.V(d),0<d.length?String(d[0]):v):v};function Ye(d,v,I){Wf(d,v),0<I.length&&(d.i=null,d.g.set(vs(d,v),k(I)),d.h+=I.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],v=Array.from(this.g.keys());for(var I=0;I<v.length;I++){var M=v[I];const Q=encodeURIComponent(String(M)),oe=this.V(M);for(M=0;M<oe.length;M++){var H=Q;oe[M]!==""&&(H+="="+encodeURIComponent(String(oe[M]))),d.push(H)}}return this.i=d.join("&")};function vs(d,v){return v=String(v),d.j&&(v=v.toLowerCase()),v}function Kc(d,v){v&&!d.j&&(Cr(d),d.i=null,d.g.forEach(function(I,M){var H=M.toLowerCase();M!=H&&(Wf(this,M),Ye(this,H,I))},d)),d.j=v}function Hf(d,v){const I=new ao;if(l.Image){const M=new Image;M.onload=w(Gi,I,"TestLoadImage: loaded",!0,v,M),M.onerror=w(Gi,I,"TestLoadImage: error",!1,v,M),M.onabort=w(Gi,I,"TestLoadImage: abort",!1,v,M),M.ontimeout=w(Gi,I,"TestLoadImage: timeout",!1,v,M),l.setTimeout(function(){M.ontimeout&&M.ontimeout()},1e4),M.src=d}else v(!1)}function G_(d,v){const I=new ao,M=new AbortController,H=setTimeout(()=>{M.abort(),Gi(I,"TestPingServer: timeout",!1,v)},1e4);fetch(d,{signal:M.signal}).then(Q=>{clearTimeout(H),Q.ok?Gi(I,"TestPingServer: ok",!0,v):Gi(I,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(H),Gi(I,"TestPingServer: error",!1,v)})}function Gi(d,v,I,M,H){try{H&&(H.onload=null,H.onerror=null,H.onabort=null,H.ontimeout=null),M(I)}catch{}}function Qt(){this.g=new bf}function Qc(d,v,I){const M=I||"";try{bn(d,function(H,Q){let oe=H;h(H)&&(oe=Oc(H)),v.push(M+Q+"="+encodeURIComponent(oe))})}catch(H){throw v.push(M+"type="+encodeURIComponent("_badmap")),H}}function $l(d){this.l=d.Ub||null,this.j=d.eb||!1}S($l,Lc),$l.prototype.g=function(){return new co(this.l,this.j)},$l.prototype.i=function(d){return function(){return d}}({});function co(d,v){fn.call(this),this.D=d,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}S(co,fn),n=co.prototype,n.open=function(d,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=d,this.A=v,this.readyState=1,Wn(this)},n.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const v={headers:this.u,method:this.B,credentials:this.m,cache:void 0};d&&(v.body=d),(this.D||l).fetch(new Request(this.A,v)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Wi(this)),this.readyState=0},n.Sa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Wn(this)),this.g&&(this.readyState=3,Wn(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;$f(this)}else d.text().then(this.Ra.bind(this),this.ga.bind(this))};function $f(d){d.j.read().then(d.Pa.bind(d)).catch(d.ga.bind(d))}n.Pa=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var v=d.value?d.value:new Uint8Array(0);(v=this.v.decode(v,{stream:!d.done}))&&(this.response=this.responseText+=v)}d.done?Wi(this):Wn(this),this.readyState==3&&$f(this)}},n.Ra=function(d){this.g&&(this.response=this.responseText=d,Wi(this))},n.Qa=function(d){this.g&&(this.response=d,Wi(this))},n.ga=function(){this.g&&Wi(this)};function Wi(d){d.readyState=4,d.l=null,d.j=null,d.v=null,Wn(d)}n.setRequestHeader=function(d,v){this.u.append(d,v)},n.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],v=this.h.entries();for(var I=v.next();!I.done;)I=I.value,d.push(I[0]+": "+I[1]),I=v.next();return d.join(`\r
`)};function Wn(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(co.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function qf(d){let v="";return B(d,function(I,M){v+=M,v+=":",v+=I,v+=`\r
`}),v}function Yc(d,v,I){e:{for(M in I){var M=!1;break e}M=!0}M||(I=qf(I),typeof d=="string"?I!=null&&encodeURIComponent(String(I)):mt(d,v,I))}function Je(d){fn.call(this),this.headers=new Map,this.o=d||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}S(Je,fn);var fi=/^https?$/i,ql=["POST","PUT"];n=Je.prototype,n.Ha=function(d){this.J=d},n.ea=function(d,v,I,M){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);v=v?v.toUpperCase():"GET",this.D=d,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():jc.g(),this.v=this.o?Df(this.o):Df(jc),this.g.onreadystatechange=_(this.Ea,this);try{this.B=!0,this.g.open(v,String(d),!0),this.B=!1}catch(Q){Kl(this,Q);return}if(d=I||"",I=new Map(this.headers),M)if(Object.getPrototypeOf(M)===Object.prototype)for(var H in M)I.set(H,M[H]);else if(typeof M.keys=="function"&&typeof M.get=="function")for(const Q of M.keys())I.set(Q,M.get(Q));else throw Error("Unknown input type for opt_headers: "+String(M));M=Array.from(I.keys()).find(Q=>Q.toLowerCase()=="content-type"),H=l.FormData&&d instanceof l.FormData,!(0<=Array.prototype.indexOf.call(ql,v,void 0))||M||H||I.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Q,oe]of I)this.g.setRequestHeader(Q,oe);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ws(this),this.u=!0,this.g.send(d),this.u=!1}catch(Q){Kl(this,Q)}};function Kl(d,v){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=v,d.m=5,Xc(d),cr(d)}function Xc(d){d.A||(d.A=!0,xn(d,"complete"),xn(d,"error"))}n.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=d||7,xn(this,"complete"),xn(this,"abort"),cr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),cr(this,!0)),Je.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Kf(this):this.bb())},n.bb=function(){Kf(this)};function Kf(d){if(d.h&&typeof o<"u"&&(!d.v[1]||Hn(d)!=4||d.Z()!=2)){if(d.u&&Hn(d)==4)Rf(d.Ea,0,d);else if(xn(d,"readystatechange"),Hn(d)==4){d.h=!1;try{const oe=d.Z();e:switch(oe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var I;if(!(I=v)){var M;if(M=oe===0){var H=String(d.D).match(xa)[1]||null;!H&&l.self&&l.self.location&&(H=l.self.location.protocol.slice(0,-1)),M=!fi.test(H?H.toLowerCase():"")}I=M}if(I)xn(d,"complete"),xn(d,"success");else{d.m=6;try{var Q=2<Hn(d)?d.g.statusText:""}catch{Q=""}d.l=Q+" ["+d.Z()+"]",Xc(d)}}finally{cr(d)}}}}function cr(d,v){if(d.g){ws(d);const I=d.g,M=d.v[0]?()=>{}:null;d.g=null,d.v=null,v||xn(d,"ready");try{I.onreadystatechange=M}catch{}}}function ws(d){d.I&&(l.clearTimeout(d.I),d.I=null)}n.isActive=function(){return!!this.g};function Hn(d){return d.g?d.g.readyState:0}n.Z=function(){try{return 2<Hn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(d){if(this.g){var v=this.g.responseText;return d&&v.indexOf(d)==0&&(v=v.substring(d.length)),F_(v)}};function Da(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.H){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function Ql(d){const v={};d=(d.g&&2<=Hn(d)&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let M=0;M<d.length;M++){if(R(d[M]))continue;var I=O(d[M]);const H=I[0];if(I=I[1],typeof I!="string")continue;I=I.trim();const Q=v[H]||[];v[H]=Q,Q.push(I)}D(v,function(M){return M.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function pn(d,v,I){return I&&I.internalChannelParams&&I.internalChannelParams[d]||v}function hr(d){this.Aa=0,this.i=[],this.j=new ao,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=pn("failFast",!1,d),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=pn("baseRetryDelayMs",5e3,d),this.cb=pn("retryDelaySeedMs",1e4,d),this.Wa=pn("forwardChannelMaxRetries",2,d),this.wa=pn("forwardChannelRequestTimeoutMs",2e4,d),this.pa=d&&d.xmlHttpFactory||void 0,this.Xa=d&&d.Tb||void 0,this.Ca=d&&d.useFetchStreams||!1,this.L=void 0,this.J=d&&d.supportsCrossDomainXhr||!1,this.K="",this.h=new ms(d&&d.concurrentRequestLimit),this.Da=new Qt,this.P=d&&d.fastHandshake||!1,this.O=d&&d.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=d&&d.Rb||!1,d&&d.xa&&this.j.xa(),d&&d.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&d&&d.detectBufferingProxy||!1,this.ja=void 0,d&&d.longPollingTimeout&&0<d.longPollingTimeout&&(this.ja=d.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=hr.prototype,n.la=8,n.G=1,n.connect=function(d,v,I,M){An(0),this.W=d,this.H=v||{},I&&M!==void 0&&(this.H.OSID=I,this.H.OAID=M),this.F=this.X,this.I=Oa(this,null,this.W),Qr(this)};function pi(d){if(Kr(d),d.G==3){var v=d.U++,I=Sr(d.I);if(mt(I,"SID",d.K),mt(I,"RID",v),mt(I,"TYPE","terminate"),Es(d,I),v=new Ui(d,d.j,v),v.L=2,v.v=Wl(Sr(I)),I=!1,l.navigator&&l.navigator.sendBeacon)try{I=l.navigator.sendBeacon(v.v.toString(),"")}catch{}!I&&l.Image&&(new Image().src=v.v,I=!0),I||(v.g=eh(v.j,null),v.g.ea(v.v)),v.F=Date.now(),jl(v)}Zc(d)}function Tr(d){d.g&&(Ss(d),d.g.cancel(),d.g=null)}function Kr(d){Tr(d),d.u&&(l.clearTimeout(d.u),d.u=null),Ma(d),d.h.cancel(),d.s&&(typeof d.s=="number"&&l.clearTimeout(d.s),d.s=null)}function Qr(d){if(!di(d.h)&&!d.s){d.s=!0;var v=d.Ga;be||ee(),$||(be(),$=!0),J.add(v,d),d.B=0}}function Qf(d,v){return ft(d.h)>=d.h.j-(d.s?1:0)?!1:d.s?(d.i=v.D.concat(d.i),!0):d.G==1||d.G==2||d.B>=(d.Va?0:d.Wa)?!1:(d.s=Ra(_(d.Ga,d,v),Xl(d,d.B)),d.B++,!0)}n.Ga=function(d){if(this.s)if(this.s=null,this.G==1){if(!d){this.U=Math.floor(1e5*Math.random()),d=this.U++;const H=new Ui(this,this.j,d);let Q=this.o;if(this.S&&(Q?(Q=T(Q),A(Q,this.S)):Q=this.S),this.m!==null||this.O||(H.H=Q,Q=null),this.P)e:{for(var v=0,I=0;I<this.i.length;I++){t:{var M=this.i[I];if("__data__"in M.map&&(M=M.map.__data__,typeof M=="string")){M=M.length;break t}M=void 0}if(M===void 0)break;if(v+=M,4096<v){v=I;break e}if(v===4096||I===this.i.length-1){v=I+1;break e}}v=1e3}else v=1e3;v=$n(this,H,v),I=Sr(this.I),mt(I,"RID",d),mt(I,"CVER",22),this.D&&mt(I,"X-HTTP-Session-Id",this.D),Es(this,I),Q&&(this.O?v="headers="+encodeURIComponent(String(qf(Q)))+"&"+v:this.m&&Yc(I,this.m,Q)),qr(this.h,H),this.Ua&&mt(I,"TYPE","init"),this.P?(mt(I,"$req",v),mt(I,"SID","null"),H.T=!0,Wc(H,I,null)):Wc(H,I,v),this.G=2}}else this.G==3&&(d?Yl(this,d):this.i.length==0||di(this.h)||Yl(this))};function Yl(d,v){var I;v?I=v.l:I=d.U++;const M=Sr(d.I);mt(M,"SID",d.K),mt(M,"RID",I),mt(M,"AID",d.T),Es(d,M),d.m&&d.o&&Yc(M,d.m,d.o),I=new Ui(d,d.j,I,d.B+1),d.m===null&&(I.H=d.o),v&&(d.i=v.D.concat(d.i)),v=$n(d,I,1e3),I.I=Math.round(.5*d.wa)+Math.round(.5*d.wa*Math.random()),qr(d.h,I),Wc(I,M,v)}function Es(d,v){d.H&&B(d.H,function(I,M){mt(v,M,I)}),d.l&&bn({},function(I,M){mt(v,M,I)})}function $n(d,v,I){I=Math.min(d.i.length,I);var M=d.l?_(d.l.Na,d.l,d):null;e:{var H=d.i;let Q=-1;for(;;){const oe=["count="+I];Q==-1?0<I?(Q=H[0].g,oe.push("ofs="+Q)):Q=0:oe.push("ofs="+Q);let Ze=!0;for(let jt=0;jt<I;jt++){let He=H[jt].g;const rn=H[jt].map;if(He-=Q,0>He)Q=Math.max(0,H[jt].g-100),Ze=!1;else try{Qc(rn,oe,"req"+He+"_")}catch{M&&M(rn)}}if(Ze){M=oe.join("&");break e}}}return d=d.i.splice(0,I),v.D=d,M}function dr(d){if(!d.g&&!d.u){d.Y=1;var v=d.Fa;be||ee(),$||(be(),$=!0),J.add(v,d),d.v=0}}function pt(d){return d.g||d.u||3<=d.v?!1:(d.Y++,d.u=Ra(_(d.Fa,d),Xl(d,d.v)),d.v++,!0)}n.Fa=function(){if(this.u=null,Ir(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var d=2*this.R;this.j.info("BP detection timer enabled: "+d),this.A=Ra(_(this.ab,this),d)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,An(10),Tr(this),Ir(this))};function Ss(d){d.A!=null&&(l.clearTimeout(d.A),d.A=null)}function Ir(d){d.g=new Ui(d,d.j,"rpc",d.Y),d.m===null&&(d.g.H=d.o),d.g.O=0;var v=Sr(d.qa);mt(v,"RID","rpc"),mt(v,"SID",d.K),mt(v,"AID",d.T),mt(v,"CI",d.F?"0":"1"),!d.F&&d.ja&&mt(v,"TO",d.ja),mt(v,"TYPE","xmlhttp"),Es(d,v),d.m&&d.o&&Yc(v,d.m,d.o),d.L&&(d.g.I=d.L);var I=d.g;d=d.ia,I.L=1,I.v=Wl(Sr(v)),I.m=null,I.P=!0,Uf(I,d)}n.Za=function(){this.C!=null&&(this.C=null,Tr(this),pt(this),An(19))};function Ma(d){d.C!=null&&(l.clearTimeout(d.C),d.C=null)}function Jc(d,v){var I=null;if(d.g==v){Ma(d),Ss(d),d.g=null;var M=2}else if(ut(d.h,v))I=v.D,nn(d.h,v),M=1;else return;if(d.G!=0){if(v.o)if(M==1){I=v.m?v.m.length:0,v=Date.now()-v.F;var H=d.B;M=Fl(),xn(M,new Of(M,I)),Qr(d)}else dr(d);else if(H=v.s,H==3||H==0&&0<v.X||!(M==1&&Qf(d,v)||M==2&&pt(d)))switch(I&&0<I.length&&(v=d.h,v.i=v.i.concat(I)),H){case 1:gi(d,5);break;case 4:gi(d,10);break;case 3:gi(d,6);break;default:gi(d,2)}}}function Xl(d,v){let I=d.Ta+Math.floor(Math.random()*d.cb);return d.isActive()||(I*=2),I*v}function gi(d,v){if(d.j.info("Error code "+v),v==2){var I=_(d.fb,d),M=d.Xa;const H=!M;M=new Bi(M||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Aa(M,"https"),Wl(M),H?Hf(M.toString(),I):G_(M.toString(),I)}else An(2);d.G=0,d.l&&d.l.sa(v),Zc(d),Kr(d)}n.fb=function(d){d?(this.j.info("Successfully pinged google.com"),An(2)):(this.j.info("Failed to ping google.com"),An(1))};function Zc(d){if(d.G=0,d.ka=[],d.l){const v=Nn(d.h);(v.length!=0||d.i.length!=0)&&(N(d.ka,v),N(d.ka,d.i),d.h.i.length=0,k(d.i),d.i.length=0),d.l.ra()}}function Oa(d,v,I){var M=I instanceof Bi?Sr(I):new Bi(I);if(M.g!="")v&&(M.g=v+"."+M.g),Gn(M,M.s);else{var H=l.location;M=H.protocol,v=v?v+"."+H.hostname:H.hostname,H=+H.port;var Q=new Bi(null);M&&Aa(Q,M),v&&(Q.g=v),H&&Gn(Q,H),I&&(Q.l=I),M=Q}return I=d.D,v=d.ya,I&&v&&mt(M,I,v),mt(M,"VER",d.la),Es(d,M),M}function eh(d,v,I){if(v&&!d.J)throw Error("Can't create secondary domain capable XhrIo object.");return v=d.Ca&&!d.pa?new Je(new $l({eb:I})):new Je(d.pa),v.Ha(d.J),v}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Cs(){}n=Cs.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function ho(){}ho.prototype.g=function(d,v){return new fr(d,v)};function fr(d,v){fn.call(this),this.g=new hr(v),this.l=d,this.h=v&&v.messageUrlParams||null,d=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(d?d["X-WebChannel-Content-Type"]=v.messageContentType:d={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.va&&(d?d["X-WebChannel-Client-Profile"]=v.va:d={"X-WebChannel-Client-Profile":v.va}),this.g.S=d,(d=v&&v.Sb)&&!R(d)&&(this.g.m=d),this.v=v&&v.supportsCrossDomainXhr||!1,this.u=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!R(v)&&(this.g.D=v,d=this.h,d!==null&&v in d&&(d=this.h,v in d&&delete d[v])),this.j=new Yr(this)}S(fr,fn),fr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},fr.prototype.close=function(){pi(this.g)},fr.prototype.o=function(d){var v=this.g;if(typeof d=="string"){var I={};I.__data__=d,d=I}else this.u&&(I={},I.__data__=Oc(d),d=I);v.i.push(new $c(v.Ya++,d)),v.G==3&&Qr(v)},fr.prototype.N=function(){this.g.l=null,delete this.j,pi(this.g),delete this.g,fr.aa.N.call(this)};function La(d){Fc.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var v=d.__sm__;if(v){e:{for(const I in v){d=I;break e}d=void 0}(this.i=d)&&(d=this.i,v=v!==null&&d in v?v[d]:void 0),this.data=v}else this.data=d}S(La,Fc);function Yf(){Vc.call(this),this.status=1}S(Yf,Vc);function Yr(d){this.g=d}S(Yr,Cs),Yr.prototype.ua=function(){xn(this.g,"a")},Yr.prototype.ta=function(d){xn(this.g,new La(d))},Yr.prototype.sa=function(d){xn(this.g,new Yf)},Yr.prototype.ra=function(){xn(this.g,"b")},ho.prototype.createWebChannel=ho.prototype.g,fr.prototype.send=fr.prototype.o,fr.prototype.open=fr.prototype.m,fr.prototype.close=fr.prototype.close,fk=function(){return new ho},dk=function(){return Fl()},hk=Vi,j1={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Bl.NO_ERROR=0,Bl.TIMEOUT=8,Bl.HTTP_ERROR=6,wg=Bl,Lf.COMPLETE="complete",ck=Lf,Mf.EventType=ka,ka.OPEN="a",ka.CLOSE="b",ka.ERROR="c",ka.MESSAGE="d",fn.prototype.listen=fn.prototype.K,Vh=Mf,Je.prototype.listenOnce=Je.prototype.L,Je.prototype.getLastError=Je.prototype.Ka,Je.prototype.getLastErrorCode=Je.prototype.Ba,Je.prototype.getStatus=Je.prototype.Z,Je.prototype.getResponseJson=Je.prototype.Oa,Je.prototype.getResponseText=Je.prototype.oa,Je.prototype.send=Je.prototype.ea,Je.prototype.setWithCredentials=Je.prototype.Ha,uk=Je}).apply(typeof $p<"u"?$p:typeof self<"u"?self:typeof window<"u"?window:{});const LT="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}tr.UNAUTHENTICATED=new tr(null),tr.GOOGLE_CREDENTIALS=new tr("google-credentials-uid"),tr.FIRST_PARTY=new tr("first-party-uid"),tr.MOCK_USER=new tr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yc="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dl=new s0("@firebase/firestore");function Ch(){return dl.logLevel}function ye(n,...e){if(dl.logLevel<=qe.DEBUG){const t=e.map(Hw);dl.debug(`Firestore (${yc}): ${n}`,...t)}}function Xs(n,...e){if(dl.logLevel<=qe.ERROR){const t=e.map(Hw);dl.error(`Firestore (${yc}): ${n}`,...t)}}function Qu(n,...e){if(dl.logLevel<=qe.WARN){const t=e.map(Hw);dl.warn(`Firestore (${yc}): ${n}`,...t)}}function Hw(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Se(n="Unexpected state"){const e=`FIRESTORE (${yc}) INTERNAL ASSERTION FAILED: `+n;throw Xs(e),new Error(e)}function nt(n,e){n||Se()}function Re(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class de extends to{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class js{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pk{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class HM{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(tr.UNAUTHENTICATED))}shutdown(){}}class $M{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class qM{constructor(e){this.t=e,this.currentUser=tr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){nt(this.o===void 0);let r=this.i;const i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve();let s=new js;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new js,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},l=c=>{ye("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(ye("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new js)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(ye("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(nt(typeof r.accessToken=="string"),new pk(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return nt(e===null||typeof e=="string"),new tr(e)}}class KM{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=tr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class QM{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new KM(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(tr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class YM{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class XM{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){nt(this.o===void 0);const r=s=>{s.error!=null&&ye("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,ye("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{ye("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):ye("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(nt(typeof t.token=="string"),this.R=t.token,new YM(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JM(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gk{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=JM(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}}function st(n,e){return n<e?-1:n>e?1:0}function Yu(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new de(X.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new de(X.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new de(X.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new de(X.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return cn.fromMillis(Date.now())}static fromDate(e){return cn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new cn(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?st(this.nanoseconds,e.nanoseconds):st(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Te(e)}static min(){return new Te(new cn(0,0))}static max(){return new Te(new cn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd{constructor(e,t,r){t===void 0?t=0:t>e.length&&Se(),r===void 0?r=e.length-t:r>e.length-t&&Se(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Nd.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Nd?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class vt extends Nd{construct(e,t,r){return new vt(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new de(X.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new vt(t)}static emptyPath(){return new vt([])}}const ZM=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Vn extends Nd{construct(e,t,r){return new Vn(e,t,r)}static isValidIdentifier(e){return ZM.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Vn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Vn(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new de(X.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new de(X.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new de(X.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else l==="`"?(o=!o,i++):l!=="."||o?(r+=l,i++):(s(),i++)}if(s(),o)throw new de(X.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Vn(t)}static emptyPath(){return new Vn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e){this.path=e}static fromPath(e){return new we(vt.fromString(e))}static fromName(e){return new we(vt.fromString(e).popFirst(5))}static empty(){return new we(vt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&vt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return vt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new we(new vt(e.slice()))}}function eO(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Te.fromTimestamp(r===1e9?new cn(t+1,0):new cn(t,r));return new Zo(i,we.empty(),e)}function tO(n){return new Zo(n.readTime,n.key,-1)}class Zo{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Zo(Te.min(),we.empty(),-1)}static max(){return new Zo(Te.max(),we.empty(),-1)}}function nO(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=we.comparator(n.documentKey,e.documentKey),t!==0?t:st(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rO="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class iO{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function of(n){if(n.code!==X.FAILED_PRECONDITION||n.message!==rO)throw n;ye("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ne{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Se(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ne((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ne?t:ne.resolve(t)}catch(t){return ne.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ne.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ne.reject(t)}static resolve(e){return new ne((t,r)=>{t(e)})}static reject(e){return new ne((t,r)=>{r(e)})}static waitFor(e){return new ne((t,r)=>{let i=0,s=0,o=!1;e.forEach(l=>{++i,l.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=ne.resolve(!1);for(const r of e)t=t.next(i=>i?ne.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new ne((r,i)=>{const s=e.length,o=new Array(s);let l=0;for(let c=0;c<s;c++){const h=c;t(e[h]).next(p=>{o[h]=p,++l,l===s&&r(o)},p=>i(p))}})}static doWhile(e,t){return new ne((r,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}}function sO(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function af(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $w{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ie(r),this.se=r=>t.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}$w.oe=-1;function lf(n){return n==null}function cm(n){return n===0&&1/n==-1/0}function oO(n){return typeof n=="number"&&Number.isInteger(n)&&!cm(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FT(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Cl(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function mk(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tn=class G1{constructor(e,t){this.comparator=e,this.root=t||$o.EMPTY}insert(e,t){return new G1(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,$o.BLACK,null,null))}remove(e){return new G1(this.comparator,this.root.remove(e,this.comparator).copy(null,null,$o.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new qp(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new qp(this.root,e,this.comparator,!1)}getReverseIterator(){return new qp(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new qp(this.root,e,this.comparator,!0)}},qp=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},$o=class xs{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??xs.RED,this.left=i??xs.EMPTY,this.right=s??xs.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new xs(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return xs.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return xs.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,xs.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,xs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Se();const e=this.left.check();if(e!==this.right.check())throw Se();return e+(this.isRed()?0:1)}};$o.EMPTY=null,$o.RED=!0,$o.BLACK=!1;$o.EMPTY=new class{constructor(){this.size=0}get key(){throw Se()}get value(){throw Se()}get color(){throw Se()}get left(){throw Se()}get right(){throw Se()}copy(e,t,r,i,s){return this}insert(e,t,r){return new $o(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(e){this.comparator=e,this.data=new tn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new VT(this.data.getIterator())}getIteratorFrom(e){return new VT(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Bn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Bn(this.comparator);return t.data=e,t}}class VT{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zr{constructor(e){this.fields=e,e.sort(Vn.comparator)}static empty(){return new zr([])}unionWith(e){let t=new Bn(Vn.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new zr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Yu(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _k extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new _k("Invalid base64 string: "+s):s}}(e);return new jn(t)}static fromUint8Array(e){const t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new jn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return st(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}jn.EMPTY_BYTE_STRING=new jn("");const aO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ea(n){if(nt(!!n),typeof n=="string"){let e=0;const t=aO.exec(n);if(nt(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Wt(n.seconds),nanos:Wt(n.nanos)}}function Wt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function fl(n){return typeof n=="string"?jn.fromBase64String(n):jn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qw(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Kw(n){const e=n.mapValue.fields.__previous_value__;return qw(e)?Kw(e):e}function bd(n){const e=ea(n.mapValue.fields.__local_write_time__.timestampValue);return new cn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lO{constructor(e,t,r,i,s,o,l,c,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=h}}class Dd{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Dd("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Dd&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kp={mapValue:{}};function pl(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?qw(n)?4:cO(n)?9007199254740991:uO(n)?10:11:Se()}function ls(n,e){if(n===e)return!0;const t=pl(n);if(t!==pl(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return bd(n).isEqual(bd(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=ea(i.timestampValue),l=ea(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return fl(i.bytesValue).isEqual(fl(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return Wt(i.geoPointValue.latitude)===Wt(s.geoPointValue.latitude)&&Wt(i.geoPointValue.longitude)===Wt(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Wt(i.integerValue)===Wt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=Wt(i.doubleValue),l=Wt(s.doubleValue);return o===l?cm(o)===cm(l):isNaN(o)&&isNaN(l)}return!1}(n,e);case 9:return Yu(n.arrayValue.values||[],e.arrayValue.values||[],ls);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},l=s.mapValue.fields||{};if(FT(o)!==FT(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!ls(o[c],l[c])))return!1;return!0}(n,e);default:return Se()}}function Md(n,e){return(n.values||[]).find(t=>ls(t,e))!==void 0}function Xu(n,e){if(n===e)return 0;const t=pl(n),r=pl(e);if(t!==r)return st(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return st(n.booleanValue,e.booleanValue);case 2:return function(s,o){const l=Wt(s.integerValue||s.doubleValue),c=Wt(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(n,e);case 3:return UT(n.timestampValue,e.timestampValue);case 4:return UT(bd(n),bd(e));case 5:return st(n.stringValue,e.stringValue);case 6:return function(s,o){const l=fl(s),c=fl(o);return l.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){const l=s.split("/"),c=o.split("/");for(let h=0;h<l.length&&h<c.length;h++){const p=st(l[h],c[h]);if(p!==0)return p}return st(l.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){const l=st(Wt(s.latitude),Wt(o.latitude));return l!==0?l:st(Wt(s.longitude),Wt(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return BT(n.arrayValue,e.arrayValue);case 10:return function(s,o){var l,c,h,p;const m=s.fields||{},_=o.fields||{},w=(l=m.value)===null||l===void 0?void 0:l.arrayValue,S=(c=_.value)===null||c===void 0?void 0:c.arrayValue,k=st(((h=w==null?void 0:w.values)===null||h===void 0?void 0:h.length)||0,((p=S==null?void 0:S.values)===null||p===void 0?void 0:p.length)||0);return k!==0?k:BT(w,S)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===Kp.mapValue&&o===Kp.mapValue)return 0;if(s===Kp.mapValue)return 1;if(o===Kp.mapValue)return-1;const l=s.fields||{},c=Object.keys(l),h=o.fields||{},p=Object.keys(h);c.sort(),p.sort();for(let m=0;m<c.length&&m<p.length;++m){const _=st(c[m],p[m]);if(_!==0)return _;const w=Xu(l[c[m]],h[p[m]]);if(w!==0)return w}return st(c.length,p.length)}(n.mapValue,e.mapValue);default:throw Se()}}function UT(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return st(n,e);const t=ea(n),r=ea(e),i=st(t.seconds,r.seconds);return i!==0?i:st(t.nanos,r.nanos)}function BT(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=Xu(t[i],r[i]);if(s)return s}return st(t.length,r.length)}function Ju(n){return W1(n)}function W1(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=ea(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return fl(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return we.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=W1(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${W1(t.fields[o])}`;return i+"}"}(n.mapValue):Se()}function zT(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function H1(n){return!!n&&"integerValue"in n}function Qw(n){return!!n&&"arrayValue"in n}function jT(n){return!!n&&"nullValue"in n}function GT(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Eg(n){return!!n&&"mapValue"in n}function uO(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function ed(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Cl(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=ed(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ed(n.arrayValue.values[t]);return e}return Object.assign({},n)}function cO(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{constructor(e){this.value=e}static empty(){return new _r({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Eg(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ed(t)}setAll(e){let t=Vn.emptyPath(),r={},i=[];e.forEach((o,l)=>{if(!t.isImmediateParentOf(l)){const c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=l.popLast()}o?r[l.lastSegment()]=ed(o):i.push(l.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());Eg(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ls(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Eg(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Cl(t,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new _r(ed(this.value))}}function yk(n){const e=[];return Cl(n.fields,(t,r)=>{const i=new Vn([t]);if(Eg(r)){const s=yk(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new zr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn{constructor(e,t,r,i,s,o,l){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Tn(e,0,Te.min(),Te.min(),Te.min(),_r.empty(),0)}static newFoundDocument(e,t,r,i){return new Tn(e,1,t,Te.min(),r,i,0)}static newNoDocument(e,t){return new Tn(e,2,t,Te.min(),Te.min(),_r.empty(),0)}static newUnknownDocument(e,t){return new Tn(e,3,t,Te.min(),Te.min(),_r.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Te.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=_r.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=_r.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Te.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Tn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Tn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hm{constructor(e,t){this.position=e,this.inclusive=t}}function WT(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],o=n.position[i];if(s.field.isKeyField()?r=we.comparator(we.fromName(o.referenceValue),t.key):r=Xu(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function HT(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ls(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od{constructor(e,t="asc"){this.field=e,this.dir=t}}function hO(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vk{}class en extends vk{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new fO(e,t,r):t==="array-contains"?new mO(e,r):t==="in"?new _O(e,r):t==="not-in"?new yO(e,r):t==="array-contains-any"?new vO(e,r):new en(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new pO(e,r):new gO(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Xu(t,this.value)):t!==null&&pl(this.value)===pl(t)&&this.matchesComparison(Xu(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Se()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Mi extends vk{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new Mi(e,t)}matches(e){return wk(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function wk(n){return n.op==="and"}function Ek(n){return dO(n)&&wk(n)}function dO(n){for(const e of n.filters)if(e instanceof Mi)return!1;return!0}function $1(n){if(n instanceof en)return n.field.canonicalString()+n.op.toString()+Ju(n.value);if(Ek(n))return n.filters.map(e=>$1(e)).join(",");{const e=n.filters.map(t=>$1(t)).join(",");return`${n.op}(${e})`}}function Sk(n,e){return n instanceof en?function(r,i){return i instanceof en&&r.op===i.op&&r.field.isEqual(i.field)&&ls(r.value,i.value)}(n,e):n instanceof Mi?function(r,i){return i instanceof Mi&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,l)=>s&&Sk(o,i.filters[l]),!0):!1}(n,e):void Se()}function Ck(n){return n instanceof en?function(t){return`${t.field.canonicalString()} ${t.op} ${Ju(t.value)}`}(n):n instanceof Mi?function(t){return t.op.toString()+" {"+t.getFilters().map(Ck).join(" ,")+"}"}(n):"Filter"}class fO extends en{constructor(e,t,r){super(e,t,r),this.key=we.fromName(r.referenceValue)}matches(e){const t=we.comparator(e.key,this.key);return this.matchesComparison(t)}}class pO extends en{constructor(e,t){super(e,"in",t),this.keys=Tk("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class gO extends en{constructor(e,t){super(e,"not-in",t),this.keys=Tk("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Tk(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>we.fromName(r.referenceValue))}class mO extends en{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Qw(t)&&Md(t.arrayValue,this.value)}}class _O extends en{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Md(this.value.arrayValue,t)}}class yO extends en{constructor(e,t){super(e,"not-in",t)}matches(e){if(Md(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Md(this.value.arrayValue,t)}}class vO extends en{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Qw(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Md(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wO{constructor(e,t=null,r=[],i=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=l,this.ue=null}}function $T(n,e=null,t=[],r=[],i=null,s=null,o=null){return new wO(n,e,t,r,i,s,o)}function Yw(n){const e=Re(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>$1(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),lf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Ju(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Ju(r)).join(",")),e.ue=t}return e.ue}function Xw(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!hO(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Sk(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!HT(n.startAt,e.startAt)&&HT(n.endAt,e.endAt)}function q1(n){return we.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vc{constructor(e,t=null,r=[],i=[],s=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function EO(n,e,t,r,i,s,o,l){return new vc(n,e,t,r,i,s,o,l)}function Jw(n){return new vc(n)}function qT(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Ik(n){return n.collectionGroup!==null}function td(n){const e=Re(n);if(e.ce===null){e.ce=[];const t=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Bn(Vn.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(h=>{h.isInequality()&&(l=l.add(h.field))})}),l})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Od(s,r))}),t.has(Vn.keyField().canonicalString())||e.ce.push(new Od(Vn.keyField(),r))}return e.ce}function as(n){const e=Re(n);return e.le||(e.le=SO(e,td(n))),e.le}function SO(n,e){if(n.limitType==="F")return $T(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Od(i.field,s)});const t=n.endAt?new hm(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new hm(n.startAt.position,n.startAt.inclusive):null;return $T(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function K1(n,e){const t=n.filters.concat([e]);return new vc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Q1(n,e,t){return new vc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function c0(n,e){return Xw(as(n),as(e))&&n.limitType===e.limitType}function Pk(n){return`${Yw(as(n))}|lt:${n.limitType}`}function cu(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>Ck(i)).join(", ")}]`),lf(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Ju(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Ju(i)).join(",")),`Target(${r})`}(as(n))}; limitType=${n.limitType})`}function h0(n,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):we.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(const s of td(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,l,c){const h=WT(o,l,c);return o.inclusive?h<=0:h<0}(r.startAt,td(r),i)||r.endAt&&!function(o,l,c){const h=WT(o,l,c);return o.inclusive?h>=0:h>0}(r.endAt,td(r),i))}(n,e)}function CO(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function kk(n){return(e,t)=>{let r=!1;for(const i of td(n)){const s=TO(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function TO(n,e,t){const r=n.field.isKeyField()?we.comparator(e.key,t.key):function(s,o,l){const c=o.data.field(s),h=l.data.field(s);return c!==null&&h!==null?Xu(c,h):Se()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Se()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wc{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Cl(this.inner,(t,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return mk(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IO=new tn(we.comparator);function Js(){return IO}const Rk=new tn(we.comparator);function Uh(...n){let e=Rk;for(const t of n)e=e.insert(t.key,t);return e}function xk(n){let e=Rk;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Za(){return nd()}function Ak(){return nd()}function nd(){return new wc(n=>n.toString(),(n,e)=>n.isEqual(e))}const PO=new tn(we.comparator),kO=new Bn(we.comparator);function Ke(...n){let e=kO;for(const t of n)e=e.add(t);return e}const RO=new Bn(st);function xO(){return RO}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zw(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:cm(e)?"-0":e}}function Nk(n){return{integerValue:""+n}}function AO(n,e){return oO(e)?Nk(e):Zw(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d0{constructor(){this._=void 0}}function NO(n,e,t){return n instanceof Ld?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&qw(s)&&(s=Kw(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof Fd?Dk(n,e):n instanceof Vd?Mk(n,e):function(i,s){const o=bk(i,s),l=KT(o)+KT(i.Pe);return H1(o)&&H1(i.Pe)?Nk(l):Zw(i.serializer,l)}(n,e)}function bO(n,e,t){return n instanceof Fd?Dk(n,e):n instanceof Vd?Mk(n,e):t}function bk(n,e){return n instanceof dm?function(r){return H1(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Ld extends d0{}class Fd extends d0{constructor(e){super(),this.elements=e}}function Dk(n,e){const t=Ok(e);for(const r of n.elements)t.some(i=>ls(i,r))||t.push(r);return{arrayValue:{values:t}}}class Vd extends d0{constructor(e){super(),this.elements=e}}function Mk(n,e){let t=Ok(e);for(const r of n.elements)t=t.filter(i=>!ls(i,r));return{arrayValue:{values:t}}}class dm extends d0{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function KT(n){return Wt(n.integerValue||n.doubleValue)}function Ok(n){return Qw(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DO{constructor(e,t){this.field=e,this.transform=t}}function MO(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Fd&&i instanceof Fd||r instanceof Vd&&i instanceof Vd?Yu(r.elements,i.elements,ls):r instanceof dm&&i instanceof dm?ls(r.Pe,i.Pe):r instanceof Ld&&i instanceof Ld}(n.transform,e.transform)}class OO{constructor(e,t){this.version=e,this.transformResults=t}}class rr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new rr}static exists(e){return new rr(void 0,e)}static updateTime(e){return new rr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Sg(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class f0{}function Lk(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new p0(n.key,rr.none()):new uf(n.key,n.data,rr.none());{const t=n.data,r=_r.empty();let i=new Bn(Vn.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new fa(n.key,r,new zr(i.toArray()),rr.none())}}function LO(n,e,t){n instanceof uf?function(i,s,o){const l=i.value.clone(),c=YT(i.fieldTransforms,s,o.transformResults);l.setAll(c),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):n instanceof fa?function(i,s,o){if(!Sg(i.precondition,s))return void s.convertToUnknownDocument(o.version);const l=YT(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(Fk(i)),c.setAll(l),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function rd(n,e,t,r){return n instanceof uf?function(s,o,l,c){if(!Sg(s.precondition,o))return l;const h=s.value.clone(),p=XT(s.fieldTransforms,c,o);return h.setAll(p),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null}(n,e,t,r):n instanceof fa?function(s,o,l,c){if(!Sg(s.precondition,o))return l;const h=XT(s.fieldTransforms,c,o),p=o.data;return p.setAll(Fk(s)),p.setAll(h),o.convertToFoundDocument(o.version,p).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(m=>m.field))}(n,e,t,r):function(s,o,l){return Sg(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(n,e,t)}function FO(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=bk(r.transform,i||null);s!=null&&(t===null&&(t=_r.empty()),t.set(r.field,s))}return t||null}function QT(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Yu(r,i,(s,o)=>MO(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class uf extends f0{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class fa extends f0{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Fk(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function YT(n,e,t){const r=new Map;nt(n.length===t.length);for(let i=0;i<t.length;i++){const s=n[i],o=s.transform,l=e.data.field(s.field);r.set(s.field,bO(o,l,t[i]))}return r}function XT(n,e,t){const r=new Map;for(const i of n){const s=i.transform,o=t.data.field(i.field);r.set(i.field,NO(s,o,e))}return r}class p0 extends f0{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Vk extends f0{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VO{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&LO(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=rd(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=rd(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Ak();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=t.has(i.key)?null:l;const c=Lk(o,l);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(Te.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ke())}isEqual(e){return this.batchId===e.batchId&&Yu(this.mutations,e.mutations,(t,r)=>QT(t,r))&&Yu(this.baseMutations,e.baseMutations,(t,r)=>QT(t,r))}}class eE{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){nt(e.mutations.length===r.length);let i=function(){return PO}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new eE(e,t,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UO{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BO{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Jt,et;function Uk(n){switch(n){default:return Se();case X.CANCELLED:case X.UNKNOWN:case X.DEADLINE_EXCEEDED:case X.RESOURCE_EXHAUSTED:case X.INTERNAL:case X.UNAVAILABLE:case X.UNAUTHENTICATED:return!1;case X.INVALID_ARGUMENT:case X.NOT_FOUND:case X.ALREADY_EXISTS:case X.PERMISSION_DENIED:case X.FAILED_PRECONDITION:case X.ABORTED:case X.OUT_OF_RANGE:case X.UNIMPLEMENTED:case X.DATA_LOSS:return!0}}function Bk(n){if(n===void 0)return Xs("GRPC error has no .code"),X.UNKNOWN;switch(n){case Jt.OK:return X.OK;case Jt.CANCELLED:return X.CANCELLED;case Jt.UNKNOWN:return X.UNKNOWN;case Jt.DEADLINE_EXCEEDED:return X.DEADLINE_EXCEEDED;case Jt.RESOURCE_EXHAUSTED:return X.RESOURCE_EXHAUSTED;case Jt.INTERNAL:return X.INTERNAL;case Jt.UNAVAILABLE:return X.UNAVAILABLE;case Jt.UNAUTHENTICATED:return X.UNAUTHENTICATED;case Jt.INVALID_ARGUMENT:return X.INVALID_ARGUMENT;case Jt.NOT_FOUND:return X.NOT_FOUND;case Jt.ALREADY_EXISTS:return X.ALREADY_EXISTS;case Jt.PERMISSION_DENIED:return X.PERMISSION_DENIED;case Jt.FAILED_PRECONDITION:return X.FAILED_PRECONDITION;case Jt.ABORTED:return X.ABORTED;case Jt.OUT_OF_RANGE:return X.OUT_OF_RANGE;case Jt.UNIMPLEMENTED:return X.UNIMPLEMENTED;case Jt.DATA_LOSS:return X.DATA_LOSS;default:return Se()}}(et=Jt||(Jt={}))[et.OK=0]="OK",et[et.CANCELLED=1]="CANCELLED",et[et.UNKNOWN=2]="UNKNOWN",et[et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",et[et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",et[et.NOT_FOUND=5]="NOT_FOUND",et[et.ALREADY_EXISTS=6]="ALREADY_EXISTS",et[et.PERMISSION_DENIED=7]="PERMISSION_DENIED",et[et.UNAUTHENTICATED=16]="UNAUTHENTICATED",et[et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",et[et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",et[et.ABORTED=10]="ABORTED",et[et.OUT_OF_RANGE=11]="OUT_OF_RANGE",et[et.UNIMPLEMENTED=12]="UNIMPLEMENTED",et[et.INTERNAL=13]="INTERNAL",et[et.UNAVAILABLE=14]="UNAVAILABLE",et[et.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zO(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jO=new rl([4294967295,4294967295],0);function JT(n){const e=zO().encode(n),t=new lk;return t.update(e),new Uint8Array(t.digest())}function ZT(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new rl([t,r],0),new rl([i,s],0)]}class tE{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Bh(`Invalid padding: ${t}`);if(r<0)throw new Bh(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Bh(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Bh(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=rl.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(rl.fromNumber(r)));return i.compare(jO)===1&&(i=new rl([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=JT(e),[r,i]=ZT(t);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new tE(s,i,t);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const t=JT(e),[r,i]=ZT(t);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Bh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g0{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,cf.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new g0(Te.min(),i,new tn(st),Js(),Ke())}}class cf{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new cf(r,t,Ke(),Ke(),Ke())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cg{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}}class zk{constructor(e,t){this.targetId=e,this.me=t}}class jk{constructor(e,t,r=jn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class e3{constructor(){this.fe=0,this.ge=n3(),this.pe=jn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ke(),t=Ke(),r=Ke();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Se()}}),new cf(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=n3()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,nt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class GO{constructor(e){this.Le=e,this.Be=new Map,this.ke=Js(),this.qe=t3(),this.Qe=new tn(st)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:Se()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){const t=e.targetId,r=e.me.count,i=this.Je(t);if(i){const s=i.target;if(q1(s))if(r===0){const o=new we(s.path);this.Ue(t,o,Tn.newNoDocument(o,Te.min()))}else nt(r===1);else{const o=this.Ye(t);if(o!==r){const l=this.Ze(e),c=l?this.Xe(l,e,o):1;if(c!==0){this.je(t);const h=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,h)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let o,l;try{o=fl(r).toUint8Array()}catch(c){if(c instanceof _k)return Qu("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new tE(o,i,s)}catch(c){return Qu(c instanceof Bh?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let i=0;return r.forEach(s=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.Ue(t,s,null),i++)}),i}rt(e){const t=new Map;this.Be.forEach((s,o)=>{const l=this.Je(o);if(l){if(s.current&&q1(l.target)){const c=new we(l.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,Tn.newNoDocument(c,e))}s.be&&(t.set(o,s.ve()),s.Ce())}});let r=Ke();this.qe.forEach((s,o)=>{let l=!0;o.forEachWhile(c=>{const h=this.Je(c);return!h||h.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new g0(e,t,this.Qe,this.ke,r);return this.ke=Js(),this.qe=t3(),this.Qe=new tn(st),i}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new e3,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Bn(st),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||ye("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new e3),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function t3(){return new tn(we.comparator)}function n3(){return new tn(we.comparator)}const WO={asc:"ASCENDING",desc:"DESCENDING"},HO={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},$O={and:"AND",or:"OR"};class qO{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Y1(n,e){return n.useProto3Json||lf(e)?e:{value:e}}function fm(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Gk(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function KO(n,e){return fm(n,e.toTimestamp())}function Gr(n){return nt(!!n),Te.fromTimestamp(function(t){const r=ea(t);return new cn(r.seconds,r.nanos)}(n))}function nE(n,e){return X1(n,e).canonicalString()}function X1(n,e){const t=function(i){return new vt(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Wk(n){const e=vt.fromString(n);return nt(Yk(e)),e}function pm(n,e){return nE(n.databaseId,e.path)}function id(n,e){const t=Wk(e);if(t.get(1)!==n.databaseId.projectId)throw new de(X.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new de(X.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new we($k(t))}function Hk(n,e){return nE(n.databaseId,e)}function QO(n){const e=Wk(n);return e.length===4?vt.emptyPath():$k(e)}function J1(n){return new vt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function $k(n){return nt(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function r3(n,e,t){return{name:pm(n,e),fields:t.value.mapValue.fields}}function YO(n,e){return"found"in e?function(r,i){nt(!!i.found),i.found.name,i.found.updateTime;const s=id(r,i.found.name),o=Gr(i.found.updateTime),l=i.found.createTime?Gr(i.found.createTime):Te.min(),c=new _r({mapValue:{fields:i.found.fields}});return Tn.newFoundDocument(s,o,l,c)}(n,e):"missing"in e?function(r,i){nt(!!i.missing),nt(!!i.readTime);const s=id(r,i.missing),o=Gr(i.readTime);return Tn.newNoDocument(s,o)}(n,e):Se()}function XO(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:Se()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(h,p){return h.useProto3Json?(nt(p===void 0||typeof p=="string"),jn.fromBase64String(p||"")):(nt(p===void 0||p instanceof Buffer||p instanceof Uint8Array),jn.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(h){const p=h.code===void 0?X.UNKNOWN:Bk(h.code);return new de(p,h.message||"")}(o);t=new jk(r,i,s,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=id(n,r.document.name),s=Gr(r.document.updateTime),o=r.document.createTime?Gr(r.document.createTime):Te.min(),l=new _r({mapValue:{fields:r.document.fields}}),c=Tn.newFoundDocument(i,s,o,l),h=r.targetIds||[],p=r.removedTargetIds||[];t=new Cg(h,p,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=id(n,r.document),s=r.readTime?Gr(r.readTime):Te.min(),o=Tn.newNoDocument(i,s),l=r.removedTargetIds||[];t=new Cg([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=id(n,r.document),s=r.removedTargetIds||[];t=new Cg([],s,i,null)}else{if(!("filter"in e))return Se();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new BO(i,s),l=r.targetId;t=new zk(l,o)}}return t}function qk(n,e){let t;if(e instanceof uf)t={update:r3(n,e.key,e.value)};else if(e instanceof p0)t={delete:pm(n,e.key)};else if(e instanceof fa)t={update:r3(n,e.key,e.data),updateMask:oL(e.fieldMask)};else{if(!(e instanceof Vk))return Se();t={verify:pm(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const l=o.transform;if(l instanceof Ld)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Fd)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Vd)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof dm)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw Se()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:KO(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Se()}(n,e.precondition)),t}function JO(n,e){return n&&n.length>0?(nt(e!==void 0),n.map(t=>function(i,s){let o=i.updateTime?Gr(i.updateTime):Gr(s);return o.isEqual(Te.min())&&(o=Gr(s)),new OO(o,i.transformResults||[])}(t,e))):[]}function ZO(n,e){return{documents:[Hk(n,e.path)]}}function eL(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Hk(n,i);const s=function(h){if(h.length!==0)return Qk(Mi.create(h,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const o=function(h){if(h.length!==0)return h.map(p=>function(_){return{field:hu(_.field),direction:rL(_.dir)}}(p))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=Y1(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{_t:t,parent:i}}function tL(n){let e=QO(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){nt(r===1);const p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];t.where&&(s=function(m){const _=Kk(m);return _ instanceof Mi&&Ek(_)?_.getFilters():[_]}(t.where));let o=[];t.orderBy&&(o=function(m){return m.map(_=>function(S){return new Od(du(S.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(S.direction))}(_))}(t.orderBy));let l=null;t.limit&&(l=function(m){let _;return _=typeof m=="object"?m.value:m,lf(_)?null:_}(t.limit));let c=null;t.startAt&&(c=function(m){const _=!!m.before,w=m.values||[];return new hm(w,_)}(t.startAt));let h=null;return t.endAt&&(h=function(m){const _=!m.before,w=m.values||[];return new hm(w,_)}(t.endAt)),EO(e,i,o,s,l,"F",c,h)}function nL(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Se()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Kk(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=du(t.unaryFilter.field);return en.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=du(t.unaryFilter.field);return en.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=du(t.unaryFilter.field);return en.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=du(t.unaryFilter.field);return en.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Se()}}(n):n.fieldFilter!==void 0?function(t){return en.create(du(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Se()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Mi.create(t.compositeFilter.filters.map(r=>Kk(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Se()}}(t.compositeFilter.op))}(n):Se()}function rL(n){return WO[n]}function iL(n){return HO[n]}function sL(n){return $O[n]}function hu(n){return{fieldPath:n.canonicalString()}}function du(n){return Vn.fromServerFormat(n.fieldPath)}function Qk(n){return n instanceof en?function(t){if(t.op==="=="){if(GT(t.value))return{unaryFilter:{field:hu(t.field),op:"IS_NAN"}};if(jT(t.value))return{unaryFilter:{field:hu(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(GT(t.value))return{unaryFilter:{field:hu(t.field),op:"IS_NOT_NAN"}};if(jT(t.value))return{unaryFilter:{field:hu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:hu(t.field),op:iL(t.op),value:t.value}}}(n):n instanceof Mi?function(t){const r=t.getFilters().map(i=>Qk(i));return r.length===1?r[0]:{compositeFilter:{op:sL(t.op),filters:r}}}(n):Se()}function oL(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Yk(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mo{constructor(e,t,r,i,s=Te.min(),o=Te.min(),l=jn.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Mo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Mo(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Mo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Mo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aL{constructor(e){this.ct=e}}function lL(n){const e=tL({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Q1(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uL{constructor(){this.un=new cL}addToCollectionParentIndex(e,t){return this.un.add(t),ne.resolve()}getCollectionParents(e,t){return ne.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return ne.resolve()}deleteFieldIndex(e,t){return ne.resolve()}deleteAllFieldIndexes(e){return ne.resolve()}createTargetIndexes(e,t){return ne.resolve()}getDocumentsMatchingTarget(e,t){return ne.resolve(null)}getIndexType(e,t){return ne.resolve(0)}getFieldIndexes(e,t){return ne.resolve([])}getNextCollectionGroupToUpdate(e){return ne.resolve(null)}getMinOffset(e,t){return ne.resolve(Zo.min())}getMinOffsetFromCollectionGroup(e,t){return ne.resolve(Zo.min())}updateCollectionGroup(e,t,r){return ne.resolve()}updateIndexEntries(e,t){return ne.resolve()}}class cL{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Bn(vt.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Bn(vt.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zu{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Zu(0)}static kn(){return new Zu(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hL{constructor(){this.changes=new wc(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Tn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?ne.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dL{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fL{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&rd(r.mutation,i,zr.empty(),cn.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Ke()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Ke()){const i=Za();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=Uh();return s.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=Za();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Ke()))}populateOverlays(e,t,r){const i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,l)=>{t.set(o,l)})})}computeViews(e,t,r,i){let s=Js();const o=nd(),l=function(){return nd()}();return t.forEach((c,h)=>{const p=r.get(h.key);i.has(h.key)&&(p===void 0||p.mutation instanceof fa)?s=s.insert(h.key,h):p!==void 0?(o.set(h.key,p.mutation.getFieldMask()),rd(p.mutation,h,p.mutation.getFieldMask(),cn.now())):o.set(h.key,zr.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((h,p)=>o.set(h,p)),t.forEach((h,p)=>{var m;return l.set(h,new dL(p,(m=o.get(h))!==null&&m!==void 0?m:null))}),l))}recalculateAndSaveOverlays(e,t){const r=nd();let i=new tn((o,l)=>o-l),s=Ke();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const l of o)l.keys().forEach(c=>{const h=t.get(c);if(h===null)return;let p=r.get(c)||zr.empty();p=l.applyToLocalView(h,p),r.set(c,p);const m=(i.get(l.batchId)||Ke()).add(c);i=i.insert(l.batchId,m)})}).next(()=>{const o=[],l=i.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),h=c.key,p=c.value,m=Ak();p.forEach(_=>{if(!s.has(_)){const w=Lk(t.get(_),r.get(_));w!==null&&m.set(_,w),s=s.add(_)}}),o.push(this.documentOverlayCache.saveOverlays(e,h,m))}return ne.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return we.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Ik(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):ne.resolve(Za());let l=-1,c=s;return o.next(h=>ne.forEach(h,(p,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),s.get(p)?ne.resolve():this.remoteDocumentCache.getEntry(e,p).next(_=>{c=c.insert(p,_)}))).next(()=>this.populateOverlays(e,h,s)).next(()=>this.computeViews(e,c,h,Ke())).next(p=>({batchId:l,changes:xk(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new we(t)).next(r=>{let i=Uh();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let o=Uh();return this.indexManager.getCollectionParents(e,s).next(l=>ne.forEach(l,c=>{const h=function(m,_){return new vc(_,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,r,i).next(p=>{p.forEach((m,_)=>{o=o.insert(m,_)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((c,h)=>{const p=h.getKey();o.get(p)===null&&(o=o.insert(p,Tn.newInvalidDocument(p)))});let l=Uh();return o.forEach((c,h)=>{const p=s.get(c);p!==void 0&&rd(p.mutation,h,zr.empty(),cn.now()),h0(t,h)&&(l=l.insert(c,h))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pL{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return ne.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Gr(i.createTime)}}(t)),ne.resolve()}getNamedQuery(e,t){return ne.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:lL(i.bundledQuery),readTime:Gr(i.readTime)}}(t)),ne.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gL{constructor(){this.overlays=new tn(we.comparator),this.Ir=new Map}getOverlay(e,t){return ne.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Za();return ne.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),ne.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),ne.resolve()}getOverlaysForCollection(e,t,r){const i=Za(),s=t.length+1,o=new we(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,h=c.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return ne.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new tn((h,p)=>h-p);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>r){let p=s.get(h.largestBatchId);p===null&&(p=Za(),s=s.insert(h.largestBatchId,p)),p.set(h.getKey(),h)}}const l=Za(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((h,p)=>l.set(h,p)),!(l.size()>=i)););return ne.resolve(l)}ht(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new UO(t,r));let s=this.Ir.get(t);s===void 0&&(s=Ke(),this.Ir.set(t,s)),this.Ir.set(t,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mL{constructor(){this.sessionToken=jn.EMPTY_BYTE_STRING}getSessionToken(e){return ne.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ne.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rE{constructor(){this.Tr=new Bn(wn.Er),this.dr=new Bn(wn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const r=new wn(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new wn(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){const t=new we(new vt([])),r=new wn(t,e),i=new wn(t,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new we(new vt([])),r=new wn(t,e),i=new wn(t,e+1);let s=Ke();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new wn(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class wn{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return we.comparator(e.key,t.key)||st(e.wr,t.wr)}static Ar(e,t){return st(e.wr,t.wr)||we.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _L{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Bn(wn.Er)}checkEmpty(e){return ne.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new VO(s,t,r,i);this.mutationQueue.push(o);for(const l of i)this.br=this.br.add(new wn(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return ne.resolve(o)}lookupMutationBatch(e,t){return ne.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.vr(r),s=i<0?0:i;return ne.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ne.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return ne.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new wn(t,0),i=new wn(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{const l=this.Dr(o.wr);s.push(l)}),ne.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Bn(st);return t.forEach(i=>{const s=new wn(i,0),o=new wn(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],l=>{r=r.add(l.wr)})}),ne.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;we.isDocumentKey(s)||(s=s.child(""));const o=new wn(new we(s),0);let l=new Bn(st);return this.br.forEachWhile(c=>{const h=c.key.path;return!!r.isPrefixOf(h)&&(h.length===i&&(l=l.add(c.wr)),!0)},o),ne.resolve(this.Cr(l))}Cr(e){const t=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){nt(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return ne.forEach(t.mutations,i=>{const s=new wn(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){const r=new wn(t,0),i=this.br.firstAfterOrEqual(r);return ne.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ne.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yL{constructor(e){this.Mr=e,this.docs=function(){return new tn(we.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return ne.resolve(r?r.document.mutableCopy():Tn.newInvalidDocument(t))}getEntries(e,t){let r=Js();return t.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Tn.newInvalidDocument(i))}),ne.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Js();const o=t.path,l=new we(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:h,value:{document:p}}=c.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||nO(tO(p),r)<=0||(i.has(p.key)||h0(t,p))&&(s=s.insert(p.key,p.mutableCopy()))}return ne.resolve(s)}getAllFromCollectionGroup(e,t,r,i){Se()}Or(e,t){return ne.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new vL(this)}getSize(e){return ne.resolve(this.size)}}class vL extends hL{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),ne.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wL{constructor(e){this.persistence=e,this.Nr=new wc(t=>Yw(t),Xw),this.lastRemoteSnapshotVersion=Te.min(),this.highestTargetId=0,this.Lr=0,this.Br=new rE,this.targetCount=0,this.kr=Zu.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),ne.resolve()}getLastRemoteSnapshotVersion(e){return ne.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ne.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),ne.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),ne.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new Zu(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,ne.resolve()}updateTargetData(e,t){return this.Kn(t),ne.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,ne.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=t&&r.get(l.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),ne.waitFor(s).next(()=>i)}getTargetCount(e){return ne.resolve(this.targetCount)}getTargetData(e,t){const r=this.Nr.get(t)||null;return ne.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),ne.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),ne.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),ne.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Br.yr(t);return ne.resolve(r)}containsKey(e,t){return ne.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EL{constructor(e,t){this.qr={},this.overlays={},this.Qr=new $w(0),this.Kr=!1,this.Kr=!0,this.$r=new mL,this.referenceDelegate=e(this),this.Ur=new wL(this),this.indexManager=new uL,this.remoteDocumentCache=function(i){return new yL(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new aL(t),this.Gr=new pL(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new gL,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new _L(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){ye("MemoryPersistence","Starting transaction:",e);const i=new SL(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,t){return ne.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}}class SL extends iO{constructor(e){super(),this.currentSequenceNumber=e}}class iE{constructor(e){this.persistence=e,this.Jr=new rE,this.Yr=null}static Zr(e){return new iE(e)}get Xr(){if(this.Yr)return this.Yr;throw Se()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),ne.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),ne.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),ne.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ne.forEach(this.Xr,r=>{const i=we.fromPath(r);return this.ei(e,i).next(s=>{s||t.removeEntry(i,Te.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return ne.or([()=>ne.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sE{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=Ke(),i=Ke();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new sE(e,t.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CL{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TL{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return c7()?8:sO(ar())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.Yi(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new CL;return this.Xi(e,t,o).next(l=>{if(s.result=l,this.zi)return this.es(e,t,o,l.size)})}).next(()=>s.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(Ch()<=qe.DEBUG&&ye("QueryEngine","SDK will not create cache indexes for query:",cu(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),ne.resolve()):(Ch()<=qe.DEBUG&&ye("QueryEngine","Query:",cu(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Ch()<=qe.DEBUG&&ye("QueryEngine","The SDK decides to create cache indexes for query:",cu(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,as(t))):ne.resolve())}Yi(e,t){if(qT(t))return ne.resolve(null);let r=as(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Q1(t,null,"F"),r=as(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Ke(...s);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const h=this.ts(t,l);return this.ns(t,h,o,c.readTime)?this.Yi(e,Q1(t,null,"F")):this.rs(e,h,t,c)}))})))}Zi(e,t,r,i){return qT(t)||i.isEqual(Te.min())?ne.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const o=this.ts(t,s);return this.ns(t,o,r,i)?ne.resolve(null):(Ch()<=qe.DEBUG&&ye("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),cu(t)),this.rs(e,o,t,eO(i,-1)).next(l=>l))})}ts(e,t){let r=new Bn(kk(e));return t.forEach((i,s)=>{h0(e,s)&&(r=r.add(s))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,t,r){return Ch()<=qe.DEBUG&&ye("QueryEngine","Using full collection scan to execute query:",cu(t)),this.Ji.getDocumentsMatchingQuery(e,t,Zo.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IL{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new tn(st),this._s=new wc(s=>Yw(s),Xw),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new fL(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function PL(n,e,t,r){return new IL(n,e,t,r)}async function Xk(n,e){const t=Re(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],l=[];let c=Ke();for(const h of i){o.push(h.batchId);for(const p of h.mutations)c=c.add(p.key)}for(const h of s){l.push(h.batchId);for(const p of h.mutations)c=c.add(p.key)}return t.localDocuments.getDocuments(r,c).next(h=>({hs:h,removedBatchIds:o,addedBatchIds:l}))})})}function kL(n,e){const t=Re(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,h,p){const m=h.batch,_=m.keys();let w=ne.resolve();return _.forEach(S=>{w=w.next(()=>p.getEntry(c,S)).next(k=>{const N=h.docVersions.get(S);nt(N!==null),k.version.compareTo(N)<0&&(m.applyToRemoteDocument(k,h),k.isValidDocument()&&(k.setReadTime(h.commitVersion),p.addEntry(k)))})}),w.next(()=>l.mutationQueue.removeMutationBatch(c,m))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=Ke();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(c=c.add(l.batch.mutations[h].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function Jk(n){const e=Re(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function RL(n,e){const t=Re(n),r=e.snapshotVersion;let i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;const l=[];e.targetChanges.forEach((p,m)=>{const _=i.get(m);if(!_)return;l.push(t.Ur.removeMatchingKeys(s,p.removedDocuments,m).next(()=>t.Ur.addMatchingKeys(s,p.addedDocuments,m)));let w=_.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?w=w.withResumeToken(jn.EMPTY_BYTE_STRING,Te.min()).withLastLimboFreeSnapshotVersion(Te.min()):p.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(p.resumeToken,r)),i=i.insert(m,w),function(k,N,x){return k.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-k.snapshotVersion.toMicroseconds()>=3e8?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(_,w,p)&&l.push(t.Ur.updateTargetData(s,w))});let c=Js(),h=Ke();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(s,p))}),l.push(xL(s,o,e.documentUpdates).next(p=>{c=p.Ps,h=p.Is})),!r.isEqual(Te.min())){const p=t.Ur.getLastRemoteSnapshotVersion(s).next(m=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));l.push(p)}return ne.waitFor(l).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,h)).next(()=>c)}).then(s=>(t.os=i,s))}function xL(n,e,t){let r=Ke(),i=Ke();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=Js();return t.forEach((l,c)=>{const h=s.get(l);c.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(l)),c.isNoDocument()&&c.version.isEqual(Te.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!h.isValidDocument()||c.version.compareTo(h.version)>0||c.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):ye("LocalStore","Ignoring outdated watch update for ",l,". Current version:",h.version," Watch version:",c.version)}),{Ps:o,Is:i}})}function AL(n,e){const t=Re(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function NL(n,e){const t=Re(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(s=>s?(i=s,ne.resolve(i)):t.Ur.allocateTargetId(r).next(o=>(i=new Mo(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}async function Z1(n,e,t){const r=Re(n),i=r.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!af(o))throw o;ye("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function i3(n,e,t){const r=Re(n);let i=Te.min(),s=Ke();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,h,p){const m=Re(c),_=m._s.get(p);return _!==void 0?ne.resolve(m.os.get(_)):m.Ur.getTargetData(h,p)}(r,o,as(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,l.targetId).next(c=>{s=c})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?i:Te.min(),t?s:Ke())).next(l=>(bL(r,CO(e),l),{documents:l,Ts:s})))}function bL(n,e,t){let r=n.us.get(e)||Te.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.us.set(e,r)}class s3{constructor(){this.activeTargetIds=xO()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class DL{constructor(){this.so=new s3,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new s3,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ML{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o3{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){ye("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){ye("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qp=null;function gv(){return Qp===null?Qp=function(){return 268435456+Math.round(2147483648*Math.random())}():Qp++,"0x"+Qp.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LL{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const er="WebChannelConnection";class FL extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(t,r,i,s,o){const l=gv(),c=this.xo(t,r.toUriEncodedString());ye("RestConnection",`Sending RPC '${t}' ${l}:`,c,i);const h={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(h,s,o),this.No(t,c,h,i).then(p=>(ye("RestConnection",`Received RPC '${t}' ${l}: `,p),p),p=>{throw Qu("RestConnection",`RPC '${t}' ${l} failed with error: `,p,"url: ",c,"request:",i),p})}Lo(t,r,i,s,o,l){return this.Mo(t,r,i,s,o)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+yc}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}xo(t,r){const i=OL[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){const s=gv();return new Promise((o,l)=>{const c=new uk;c.setWithCredentials(!0),c.listenOnce(ck.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case wg.NO_ERROR:const p=c.getResponseJson();ye(er,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(p)),o(p);break;case wg.TIMEOUT:ye(er,`RPC '${e}' ${s} timed out`),l(new de(X.DEADLINE_EXCEEDED,"Request time out"));break;case wg.HTTP_ERROR:const m=c.getStatus();if(ye(er,`RPC '${e}' ${s} failed with status:`,m,"response text:",c.getResponseText()),m>0){let _=c.getResponseJson();Array.isArray(_)&&(_=_[0]);const w=_==null?void 0:_.error;if(w&&w.status&&w.message){const S=function(N){const x=N.toLowerCase().replace(/_/g,"-");return Object.values(X).indexOf(x)>=0?x:X.UNKNOWN}(w.status);l(new de(S,w.message))}else l(new de(X.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new de(X.UNAVAILABLE,"Connection failed."));break;default:Se()}}finally{ye(er,`RPC '${e}' ${s} completed.`)}});const h=JSON.stringify(i);ye(er,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",h,r,15)})}Bo(e,t,r){const i=gv(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=fk(),l=dk(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(c.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;const p=s.join("");ye(er,`Creating RPC '${e}' stream ${i}: ${p}`,c);const m=o.createWebChannel(p,c);let _=!1,w=!1;const S=new LL({Io:N=>{w?ye(er,`Not sending because RPC '${e}' stream ${i} is closed:`,N):(_||(ye(er,`Opening RPC '${e}' stream ${i} transport.`),m.open(),_=!0),ye(er,`RPC '${e}' stream ${i} sending:`,N),m.send(N))},To:()=>m.close()}),k=(N,x,R)=>{N.listen(x,E=>{try{R(E)}catch(P){setTimeout(()=>{throw P},0)}})};return k(m,Vh.EventType.OPEN,()=>{w||(ye(er,`RPC '${e}' stream ${i} transport opened.`),S.yo())}),k(m,Vh.EventType.CLOSE,()=>{w||(w=!0,ye(er,`RPC '${e}' stream ${i} transport closed`),S.So())}),k(m,Vh.EventType.ERROR,N=>{w||(w=!0,Qu(er,`RPC '${e}' stream ${i} transport errored:`,N),S.So(new de(X.UNAVAILABLE,"The operation could not be completed")))}),k(m,Vh.EventType.MESSAGE,N=>{var x;if(!w){const R=N.data[0];nt(!!R);const E=R,P=E.error||((x=E[0])===null||x===void 0?void 0:x.error);if(P){ye(er,`RPC '${e}' stream ${i} received error:`,P);const V=P.status;let B=function(b){const A=Jt[b];if(A!==void 0)return Bk(A)}(V),D=P.message;B===void 0&&(B=X.INTERNAL,D="Unknown error status: "+V+" with message "+P.message),w=!0,S.So(new de(B,D)),m.close()}else ye(er,`RPC '${e}' stream ${i} received:`,R),S.bo(R)}}),k(l,hk.STAT_EVENT,N=>{N.stat===j1.PROXY?ye(er,`RPC '${e}' stream ${i} detected buffering proxy`):N.stat===j1.NOPROXY&&ye(er,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{S.wo()},0),S}}function mv(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m0(n){return new qO(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oE{constructor(e,t,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&ye("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zk{constructor(e,t,r,i,s,o,l,c){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new oE(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===X.RESOURCE_EXHAUSTED?(Xs(t.toString()),Xs("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===X.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{const i=new de(X.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){const r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return ye("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(ye("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class VL extends Zk{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=XO(this.serializer,e),r=function(s){if(!("targetChange"in s))return Te.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Te.min():o.readTime?Gr(o.readTime):Te.min()}(e);return this.listener.d_(t,r)}A_(e){const t={};t.database=J1(this.serializer),t.addTarget=function(s,o){let l;const c=o.target;if(l=q1(c)?{documents:ZO(s,c)}:{query:eL(s,c)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=Gk(s,o.resumeToken);const h=Y1(s,o.expectedCount);h!==null&&(l.expectedCount=h)}else if(o.snapshotVersion.compareTo(Te.min())>0){l.readTime=fm(s,o.snapshotVersion.toTimestamp());const h=Y1(s,o.expectedCount);h!==null&&(l.expectedCount=h)}return l}(this.serializer,e);const r=nL(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){const t={};t.database=J1(this.serializer),t.removeTarget=e,this.a_(t)}}class UL extends Zk{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return nt(!!e.streamToken),this.lastStreamToken=e.streamToken,nt(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){nt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=JO(e.writeResults,e.commitTime),r=Gr(e.commitTime);return this.listener.g_(r,t)}p_(){const e={};e.database=J1(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>qk(this.serializer,r))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BL extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new de(X.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,X1(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===X.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new de(X.UNKNOWN,s.toString())})}Lo(e,t,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,X1(t,r),i,o,l,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===X.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new de(X.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class zL{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Xs(t),this.D_=!1):ye("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jL{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(async()=>{Tl(this)&&(ye("RemoteStore","Restarting streams for network reachability change."),await async function(c){const h=Re(c);h.L_.add(4),await hf(h),h.q_.set("Unknown"),h.L_.delete(4),await _0(h)}(this))})}),this.q_=new zL(r,i)}}async function _0(n){if(Tl(n))for(const e of n.B_)await e(!0)}async function hf(n){for(const e of n.B_)await e(!1)}function eR(n,e){const t=Re(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),cE(t)?uE(t):Ec(t).r_()&&lE(t,e))}function aE(n,e){const t=Re(n),r=Ec(t);t.N_.delete(e),r.r_()&&tR(t,e),t.N_.size===0&&(r.r_()?r.o_():Tl(t)&&t.q_.set("Unknown"))}function lE(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Te.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ec(n).A_(e)}function tR(n,e){n.Q_.xe(e),Ec(n).R_(e)}function uE(n){n.Q_=new GO({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Ec(n).start(),n.q_.v_()}function cE(n){return Tl(n)&&!Ec(n).n_()&&n.N_.size>0}function Tl(n){return Re(n).L_.size===0}function nR(n){n.Q_=void 0}async function GL(n){n.q_.set("Online")}async function WL(n){n.N_.forEach((e,t)=>{lE(n,e)})}async function HL(n,e){nR(n),cE(n)?(n.q_.M_(e),uE(n)):n.q_.set("Unknown")}async function $L(n,e,t){if(n.q_.set("Online"),e instanceof jk&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const l of s.targetIds)i.N_.has(l)&&(await i.remoteSyncer.rejectListen(l,o),i.N_.delete(l),i.Q_.removeTarget(l))}(n,e)}catch(r){ye("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await gm(n,r)}else if(e instanceof Cg?n.Q_.Ke(e):e instanceof zk?n.Q_.He(e):n.Q_.We(e),!t.isEqual(Te.min()))try{const r=await Jk(n.localStore);t.compareTo(r)>=0&&await function(s,o){const l=s.Q_.rt(o);return l.targetChanges.forEach((c,h)=>{if(c.resumeToken.approximateByteSize()>0){const p=s.N_.get(h);p&&s.N_.set(h,p.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,h)=>{const p=s.N_.get(c);if(!p)return;s.N_.set(c,p.withResumeToken(jn.EMPTY_BYTE_STRING,p.snapshotVersion)),tR(s,c);const m=new Mo(p.target,c,h,p.sequenceNumber);lE(s,m)}),s.remoteSyncer.applyRemoteEvent(l)}(n,t)}catch(r){ye("RemoteStore","Failed to raise snapshot:",r),await gm(n,r)}}async function gm(n,e,t){if(!af(e))throw e;n.L_.add(1),await hf(n),n.q_.set("Offline"),t||(t=()=>Jk(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{ye("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await _0(n)})}function rR(n,e){return e().catch(t=>gm(n,t,e))}async function y0(n){const e=Re(n),t=ta(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;qL(e);)try{const i=await AL(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,KL(e,i)}catch(i){await gm(e,i)}iR(e)&&sR(e)}function qL(n){return Tl(n)&&n.O_.length<10}function KL(n,e){n.O_.push(e);const t=ta(n);t.r_()&&t.V_&&t.m_(e.mutations)}function iR(n){return Tl(n)&&!ta(n).n_()&&n.O_.length>0}function sR(n){ta(n).start()}async function QL(n){ta(n).p_()}async function YL(n){const e=ta(n);for(const t of n.O_)e.m_(t.mutations)}async function XL(n,e,t){const r=n.O_.shift(),i=eE.from(r,e,t);await rR(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await y0(n)}async function JL(n,e){e&&ta(n).V_&&await async function(r,i){if(function(o){return Uk(o)&&o!==X.ABORTED}(i.code)){const s=r.O_.shift();ta(r).s_(),await rR(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await y0(r)}}(n,e),iR(n)&&sR(n)}async function a3(n,e){const t=Re(n);t.asyncQueue.verifyOperationInProgress(),ye("RemoteStore","RemoteStore received new credentials");const r=Tl(t);t.L_.add(3),await hf(t),r&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await _0(t)}async function ZL(n,e){const t=Re(n);e?(t.L_.delete(2),await _0(t)):e||(t.L_.add(2),await hf(t),t.q_.set("Unknown"))}function Ec(n){return n.K_||(n.K_=function(t,r,i){const s=Re(t);return s.w_(),new VL(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:GL.bind(null,n),Ro:WL.bind(null,n),mo:HL.bind(null,n),d_:$L.bind(null,n)}),n.B_.push(async e=>{e?(n.K_.s_(),cE(n)?uE(n):n.q_.set("Unknown")):(await n.K_.stop(),nR(n))})),n.K_}function ta(n){return n.U_||(n.U_=function(t,r,i){const s=Re(t);return s.w_(),new UL(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:QL.bind(null,n),mo:JL.bind(null,n),f_:YL.bind(null,n),g_:XL.bind(null,n)}),n.B_.push(async e=>{e?(n.U_.s_(),await y0(n)):(await n.U_.stop(),n.O_.length>0&&(ye("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))})),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hE{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new js,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const o=Date.now()+r,l=new hE(e,t,o,i,s);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new de(X.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function dE(n,e){if(Xs("AsyncQueue",`${e}: ${n}`),af(n))return new de(X.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu{constructor(e){this.comparator=e?(t,r)=>e(t,r)||we.comparator(t.key,r.key):(t,r)=>we.comparator(t.key,r.key),this.keyedMap=Uh(),this.sortedSet=new tn(this.comparator)}static emptySet(e){return new Lu(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Lu)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Lu;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l3{constructor(){this.W_=new tn(we.comparator)}track(e){const t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Se():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}}class ec{constructor(e,t,r,i,s,o,l,c,h){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=h}static fromInitialDocuments(e,t,r,i,s){const o=[];return t.forEach(l=>{o.push({type:0,doc:l})}),new ec(e,t,Lu.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&c0(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eF{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class tF{constructor(){this.queries=u3(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){const i=Re(t),s=i.queries;i.queries=u3(),s.forEach((o,l)=>{for(const c of l.j_)c.onError(r)})})(this,new de(X.ABORTED,"Firestore shutting down"))}}function u3(){return new wc(n=>Pk(n),c0)}async function oR(n,e){const t=Re(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new eF,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await t.onListen(i,!0);break;case 1:s.z_=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const l=dE(o,`Initialization of query '${cu(e.query)}' failed`);return void e.onError(l)}t.queries.set(i,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&fE(t)}async function aR(n,e){const t=Re(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function nF(n,e){const t=Re(n);let r=!1;for(const i of e){const s=i.query,o=t.queries.get(s);if(o){for(const l of o.j_)l.X_(i)&&(r=!0);o.z_=i}}r&&fE(t)}function rF(n,e,t){const r=Re(n),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(t);r.queries.delete(e)}function fE(n){n.Y_.forEach(e=>{e.next()})}var e2,c3;(c3=e2||(e2={})).ea="default",c3.Cache="cache";class lR{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new ec(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=ec.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==e2.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uR{constructor(e){this.key=e}}class cR{constructor(e){this.key=e}}class iF{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Ke(),this.mutatedKeys=Ke(),this.Aa=kk(e),this.Ra=new Lu(this.Aa)}get Va(){return this.Ta}ma(e,t){const r=t?t.fa:new l3,i=t?t.Ra:this.Ra;let s=t?t.mutatedKeys:this.mutatedKeys,o=i,l=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,m)=>{const _=i.get(p),w=h0(this.query,m)?m:null,S=!!_&&this.mutatedKeys.has(_.key),k=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let N=!1;_&&w?_.data.isEqual(w.data)?S!==k&&(r.track({type:3,doc:w}),N=!0):this.ga(_,w)||(r.track({type:2,doc:w}),N=!0,(c&&this.Aa(w,c)>0||h&&this.Aa(w,h)<0)&&(l=!0)):!_&&w?(r.track({type:0,doc:w}),N=!0):_&&!w&&(r.track({type:1,doc:_}),N=!0,(c||h)&&(l=!0)),N&&(w?(o=o.add(w),s=k?s.add(p):s.delete(p)):(o=o.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const p=this.query.limitType==="F"?o.last():o.first();o=o.delete(p.key),s=s.delete(p.key),r.track({type:1,doc:p})}return{Ra:o,fa:r,ns:l,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((p,m)=>function(w,S){const k=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Se()}};return k(w)-k(S)}(p.type,m.type)||this.Aa(p.doc,m.doc)),this.pa(r),i=i!=null&&i;const l=t&&!i?this.ya():[],c=this.da.size===0&&this.current&&!i?1:0,h=c!==this.Ea;return this.Ea=c,o.length!==0||h?{snapshot:new ec(this.query,e.Ra,s,o,e.mutatedKeys,c===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new l3,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Ke(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const t=[];return e.forEach(r=>{this.da.has(r)||t.push(new cR(r))}),this.da.forEach(r=>{e.has(r)||t.push(new uR(r))}),t}ba(e){this.Ta=e.Ts,this.da=Ke();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return ec.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class sF{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class oF{constructor(e){this.key=e,this.va=!1}}class aF{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new wc(l=>Pk(l),c0),this.Ma=new Map,this.xa=new Set,this.Oa=new tn(we.comparator),this.Na=new Map,this.La=new rE,this.Ba={},this.ka=new Map,this.qa=Zu.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function lF(n,e,t=!0){const r=mR(n);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await hR(r,e,t,!0),i}async function uF(n,e){const t=mR(n);await hR(t,e,!0,!1)}async function hR(n,e,t,r){const i=await NL(n.localStore,as(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t);let l;return r&&(l=await cF(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&eR(n.remoteStore,i),l}async function cF(n,e,t,r,i){n.Ka=(m,_,w)=>async function(k,N,x,R){let E=N.view.ma(x);E.ns&&(E=await i3(k.localStore,N.query,!1).then(({documents:D})=>N.view.ma(D,E)));const P=R&&R.targetChanges.get(N.targetId),V=R&&R.targetMismatches.get(N.targetId)!=null,B=N.view.applyChanges(E,k.isPrimaryClient,P,V);return d3(k,N.targetId,B.wa),B.snapshot}(n,m,_,w);const s=await i3(n.localStore,e,!0),o=new iF(e,s.Ts),l=o.ma(s.documents),c=cf.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),h=o.applyChanges(l,n.isPrimaryClient,c);d3(n,t,h.wa);const p=new sF(e,t,o);return n.Fa.set(e,p),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),h.snapshot}async function hF(n,e,t){const r=Re(n),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!c0(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Z1(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&aE(r.remoteStore,i.targetId),t2(r,i.targetId)}).catch(of)):(t2(r,i.targetId),await Z1(r.localStore,i.targetId,!0))}async function dF(n,e){const t=Re(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),aE(t.remoteStore,r.targetId))}async function fF(n,e,t){const r=wF(n);try{const i=await function(o,l){const c=Re(o),h=cn.now(),p=l.reduce((w,S)=>w.add(S.key),Ke());let m,_;return c.persistence.runTransaction("Locally write mutations","readwrite",w=>{let S=Js(),k=Ke();return c.cs.getEntries(w,p).next(N=>{S=N,S.forEach((x,R)=>{R.isValidDocument()||(k=k.add(x))})}).next(()=>c.localDocuments.getOverlayedDocuments(w,S)).next(N=>{m=N;const x=[];for(const R of l){const E=FO(R,m.get(R.key).overlayedDocument);E!=null&&x.push(new fa(R.key,E,yk(E.value.mapValue),rr.exists(!0)))}return c.mutationQueue.addMutationBatch(w,h,x,l)}).next(N=>{_=N;const x=N.applyToLocalDocumentSet(m,k);return c.documentOverlayCache.saveOverlays(w,N.batchId,x)})}).then(()=>({batchId:_.batchId,changes:xk(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,l,c){let h=o.Ba[o.currentUser.toKey()];h||(h=new tn(st)),h=h.insert(l,c),o.Ba[o.currentUser.toKey()]=h}(r,i.batchId,t),await df(r,i.changes),await y0(r.remoteStore)}catch(i){const s=dE(i,"Failed to persist write");t.reject(s)}}async function dR(n,e){const t=Re(n);try{const r=await RL(t.localStore,e);e.targetChanges.forEach((i,s)=>{const o=t.Na.get(s);o&&(nt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?nt(o.va):i.removedDocuments.size>0&&(nt(o.va),o.va=!1))}),await df(t,r,e)}catch(r){await of(r)}}function h3(n,e,t){const r=Re(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Fa.forEach((s,o)=>{const l=o.view.Z_(e);l.snapshot&&i.push(l.snapshot)}),function(o,l){const c=Re(o);c.onlineState=l;let h=!1;c.queries.forEach((p,m)=>{for(const _ of m.j_)_.Z_(l)&&(h=!0)}),h&&fE(c)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function pF(n,e,t){const r=Re(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Na.get(e),s=i&&i.key;if(s){let o=new tn(we.comparator);o=o.insert(s,Tn.newNoDocument(s,Te.min()));const l=Ke().add(s),c=new g0(Te.min(),new Map,new tn(st),o,l);await dR(r,c),r.Oa=r.Oa.remove(s),r.Na.delete(e),pE(r)}else await Z1(r.localStore,e,!1).then(()=>t2(r,e,t)).catch(of)}async function gF(n,e){const t=Re(n),r=e.batch.batchId;try{const i=await kL(t.localStore,e);pR(t,r,null),fR(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await df(t,i)}catch(i){await of(i)}}async function mF(n,e,t){const r=Re(n);try{const i=await function(o,l){const c=Re(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let p;return c.mutationQueue.lookupMutationBatch(h,l).next(m=>(nt(m!==null),p=m.keys(),c.mutationQueue.removeMutationBatch(h,m))).next(()=>c.mutationQueue.performConsistencyCheck(h)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(h,p,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,p)).next(()=>c.localDocuments.getDocuments(h,p))})}(r.localStore,e);pR(r,e,t),fR(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await df(r,i)}catch(i){await of(i)}}function fR(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function pR(n,e,t){const r=Re(n);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function t2(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||gR(n,r)})}function gR(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(aE(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),pE(n))}function d3(n,e,t){for(const r of t)r instanceof uR?(n.La.addReference(r.key,e),_F(n,r)):r instanceof cR?(ye("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||gR(n,r.key)):Se()}function _F(n,e){const t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(ye("SyncEngine","New document in limbo: "+t),n.xa.add(r),pE(n))}function pE(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new we(vt.fromString(e)),r=n.qa.next();n.Na.set(r,new oF(t)),n.Oa=n.Oa.insert(t,r),eR(n.remoteStore,new Mo(as(Jw(t.path)),r,"TargetPurposeLimboResolution",$w.oe))}}async function df(n,e,t){const r=Re(n),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((l,c)=>{o.push(r.Ka(c,e,t).then(h=>{var p;if((h||t)&&r.isPrimaryClient){const m=h?!h.fromCache:(p=t==null?void 0:t.targetChanges.get(c.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(c.targetId,m?"current":"not-current")}if(h){i.push(h);const m=sE.Wi(c.targetId,h);s.push(m)}}))}),await Promise.all(o),r.Ca.d_(i),await async function(c,h){const p=Re(c);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>ne.forEach(h,_=>ne.forEach(_.$i,w=>p.persistence.referenceDelegate.addReference(m,_.targetId,w)).next(()=>ne.forEach(_.Ui,w=>p.persistence.referenceDelegate.removeReference(m,_.targetId,w)))))}catch(m){if(!af(m))throw m;ye("LocalStore","Failed to update sequence numbers: "+m)}for(const m of h){const _=m.targetId;if(!m.fromCache){const w=p.os.get(_),S=w.snapshotVersion,k=w.withLastLimboFreeSnapshotVersion(S);p.os=p.os.insert(_,k)}}}(r.localStore,s))}async function yF(n,e){const t=Re(n);if(!t.currentUser.isEqual(e)){ye("SyncEngine","User change. New user:",e.toKey());const r=await Xk(t.localStore,e);t.currentUser=e,function(s,o){s.ka.forEach(l=>{l.forEach(c=>{c.reject(new de(X.CANCELLED,o))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await df(t,r.hs)}}function vF(n,e){const t=Re(n),r=t.Na.get(e);if(r&&r.va)return Ke().add(r.key);{let i=Ke();const s=t.Ma.get(e);if(!s)return i;for(const o of s){const l=t.Fa.get(o);i=i.unionWith(l.view.Va)}return i}}function mR(n){const e=Re(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=dR.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=vF.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=pF.bind(null,e),e.Ca.d_=nF.bind(null,e.eventManager),e.Ca.$a=rF.bind(null,e.eventManager),e}function wF(n){const e=Re(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=gF.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=mF.bind(null,e),e}class mm{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=m0(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return PL(this.persistence,new TL,e.initialUser,this.serializer)}Ga(e){return new EL(iE.Zr,this.serializer)}Wa(e){return new DL}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}mm.provider={build:()=>new mm};class n2{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>h3(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=yF.bind(null,this.syncEngine),await ZL(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new tF}()}createDatastore(e){const t=m0(e.databaseInfo.databaseId),r=function(s){return new FL(s)}(e.databaseInfo);return function(s,o,l,c){return new BL(s,o,l,c)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,o,l){return new jL(r,i,s,o,l)}(this.localStore,this.datastore,e.asyncQueue,t=>h3(this.syncEngine,t,0),function(){return o3.D()?new o3:new ML}())}createSyncEngine(e,t){return function(i,s,o,l,c,h,p){const m=new aF(i,s,o,l,c,h);return p&&(m.Qa=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const s=Re(i);ye("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await hf(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}n2.provider={build:()=>new n2};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _R{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Xs("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EF{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new de(X.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(i,s){const o=Re(i),l={documents:s.map(m=>pm(o.serializer,m))},c=await o.Lo("BatchGetDocuments",o.serializer.databaseId,vt.emptyPath(),l,s.length),h=new Map;c.forEach(m=>{const _=YO(o.serializer,m);h.set(_.key.toString(),_)});const p=[];return s.forEach(m=>{const _=h.get(m.toString());nt(!!_),p.push(_)}),p}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new p0(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{const i=we.fromPath(r);this.mutations.push(new Vk(i,this.precondition(i)))}),await async function(r,i){const s=Re(r),o={writes:i.map(l=>qk(s.serializer,l))};await s.Mo("Commit",s.serializer.databaseId,vt.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Se();t=Te.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new de(X.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Te.min())?rr.exists(!1):rr.updateTime(t):rr.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Te.min()))throw new de(X.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return rr.updateTime(t)}return rr.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SF{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this._u=r.maxAttempts,this.t_=new oE(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new EF(this.datastore),t=this.cu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.lu(i)}))}).catch(r=>{this.lu(r)})})}cu(e){try{const t=this.updateFunction(e);return!lf(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!Uk(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CF{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=tr.UNAUTHENTICATED,this.clientId=gk.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{ye("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ye("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new js;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=dE(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function _v(n,e){n.asyncQueue.verifyOperationInProgress(),ye("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await Xk(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function f3(n,e){n.asyncQueue.verifyOperationInProgress();const t=await TF(n);ye("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>a3(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>a3(e.remoteStore,i)),n._onlineComponents=e}async function TF(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ye("FirestoreClient","Using user provided OfflineComponentProvider");try{await _v(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===X.FAILED_PRECONDITION||i.code===X.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Qu("Error using user provided cache. Falling back to memory cache: "+t),await _v(n,new mm)}}else ye("FirestoreClient","Using default OfflineComponentProvider"),await _v(n,new mm);return n._offlineComponents}async function gE(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ye("FirestoreClient","Using user provided OnlineComponentProvider"),await f3(n,n._uninitializedComponentsProvider._online)):(ye("FirestoreClient","Using default OnlineComponentProvider"),await f3(n,new n2))),n._onlineComponents}function IF(n){return gE(n).then(e=>e.syncEngine)}function PF(n){return gE(n).then(e=>e.datastore)}async function r2(n){const e=await gE(n),t=e.eventManager;return t.onListen=lF.bind(null,e.syncEngine),t.onUnlisten=hF.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=uF.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=dF.bind(null,e.syncEngine),t}function kF(n,e,t={}){const r=new js;return n.asyncQueue.enqueueAndForget(async()=>function(s,o,l,c,h){const p=new _R({next:_=>{p.Za(),o.enqueueAndForget(()=>aR(s,m)),_.fromCache&&c.source==="server"?h.reject(new de(X.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(_)},error:_=>h.reject(_)}),m=new lR(l,p,{includeMetadataChanges:!0,_a:!0});return oR(s,m)}(await r2(n),n.asyncQueue,e,t,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yR(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p3=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vR(n,e,t){if(!t)throw new de(X.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function RF(n,e,t,r){if(e===!0&&r===!0)throw new de(X.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function g3(n){if(!we.isDocumentKey(n))throw new de(X.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function m3(n){if(we.isDocumentKey(n))throw new de(X.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function v0(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Se()}function ai(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new de(X.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=v0(n);throw new de(X.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _3{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new de(X.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new de(X.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}RF("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=yR((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new de(X.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new de(X.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new de(X.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class w0{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new _3({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new de(X.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new de(X.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new _3(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new HM;switch(r.type){case"firstParty":return new QM(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new de(X.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=p3.get(t);r&&(ye("ComponentProvider","Removing Datastore"),p3.delete(t),r.terminate())}(this),Promise.resolve()}}function wR(n,e,t,r={}){var i;const s=(n=ai(n,w0))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Qu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let l,c;if(typeof r.mockUserToken=="string")l=r.mockUserToken,c=tr.MOCK_USER;else{l=wP(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);const h=r.mockUserToken.sub||r.mockUserToken.user_id;if(!h)throw new de(X.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new tr(h)}n._authCredentials=new $M(new pk(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new pa(this.firestore,e,this._query)}}class ir{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new qo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ir(this.firestore,e,this._key)}}class qo extends pa{constructor(e,t,r){super(e,t,Jw(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ir(this.firestore,null,new we(e))}withConverter(e){return new qo(this.firestore,e,this._path)}}function ff(n,e,...t){if(n=wt(n),vR("collection","path",e),n instanceof w0){const r=vt.fromString(e,...t);return m3(r),new qo(n,null,r)}{if(!(n instanceof ir||n instanceof qo))throw new de(X.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(vt.fromString(e,...t));return m3(r),new qo(n.firestore,null,r)}}function ga(n,e,...t){if(n=wt(n),arguments.length===1&&(e=gk.newId()),vR("doc","path",e),n instanceof w0){const r=vt.fromString(e,...t);return g3(r),new ir(n,null,new we(r))}{if(!(n instanceof ir||n instanceof qo))throw new de(X.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(vt.fromString(e,...t));return g3(r),new ir(n.firestore,n instanceof qo?n.converter:null,new we(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y3{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new oE(this,"async_queue_retry"),this.Vu=()=>{const r=mv();r&&ye("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const t=mv();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=mv();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new js;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!af(e))throw e;ye("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(r);throw Xs("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const i=hE.createAndSchedule(this,e,t,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&Se()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function v3(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}class na extends w0{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new y3,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new y3(e),this._firestoreClient=void 0,await e}}}function xF(n,e){const t=typeof n=="object"?n:Dw(),r=typeof n=="string"?n:"(default)",i=o0(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=_P("firestore");s&&wR(i,...s)}return i}function E0(n){if(n._terminated)throw new de(X.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||AF(n),n._firestoreClient}function AF(n){var e,t,r;const i=n._freezeSettings(),s=function(l,c,h,p){return new lO(l,c,h,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,yR(p.experimentalLongPollingOptions),p.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new CF(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new gl(jn.fromBase64String(e))}catch(t){throw new de(X.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new gl(jn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new de(X.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Vn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S0{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mE{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new de(X.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new de(X.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return st(this._lat,e._lat)||st(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _E{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NF=/^__.*__$/;class bF{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new fa(e,this.data,this.fieldMask,t,this.fieldTransforms):new uf(e,this.data,t,this.fieldTransforms)}}class ER{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new fa(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function SR(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Se()}}class yE{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new yE(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return _m(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(SR(this.Cu)&&NF.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class DF{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||m0(e)}Qu(e,t,r,i=!1){return new yE({Cu:e,methodName:t,qu:r,path:Vn.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function C0(n){const e=n._freezeSettings(),t=m0(n._databaseId);return new DF(n._databaseId,!!e.ignoreUndefinedProperties,t)}function CR(n,e,t,r,i,s={}){const o=n.Qu(s.merge||s.mergeFields?2:0,e,t,i);wE("Data must be an object, but it was:",o,r);const l=PR(r,o);let c,h;if(s.merge)c=new zr(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){const p=[];for(const m of s.mergeFields){const _=i2(e,m,t);if(!o.contains(_))throw new de(X.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);RR(p,_)||p.push(_)}c=new zr(p),h=o.fieldTransforms.filter(m=>c.covers(m.field))}else c=null,h=o.fieldTransforms;return new bF(new _r(l),c,h)}class T0 extends S0{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof T0}}class vE extends S0{_toFieldTransform(e){return new DO(e.path,new Ld)}isEqual(e){return e instanceof vE}}function TR(n,e,t,r){const i=n.Qu(1,e,t);wE("Data must be an object, but it was:",i,r);const s=[],o=_r.empty();Cl(r,(c,h)=>{const p=EE(e,c,t);h=wt(h);const m=i.Nu(p);if(h instanceof T0)s.push(p);else{const _=gf(h,m);_!=null&&(s.push(p),o.set(p,_))}});const l=new zr(s);return new ER(o,l,i.fieldTransforms)}function IR(n,e,t,r,i,s){const o=n.Qu(1,e,t),l=[i2(e,r,t)],c=[i];if(s.length%2!=0)throw new de(X.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<s.length;_+=2)l.push(i2(e,s[_])),c.push(s[_+1]);const h=[],p=_r.empty();for(let _=l.length-1;_>=0;--_)if(!RR(h,l[_])){const w=l[_];let S=c[_];S=wt(S);const k=o.Nu(w);if(S instanceof T0)h.push(w);else{const N=gf(S,k);N!=null&&(h.push(w),p.set(w,N))}}const m=new zr(h);return new ER(p,m,o.fieldTransforms)}function MF(n,e,t,r=!1){return gf(t,n.Qu(r?4:3,e))}function gf(n,e){if(kR(n=wt(n)))return wE("Unsupported field value:",e,n),PR(n,e);if(n instanceof S0)return function(r,i){if(!SR(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const l of r){let c=gf(l,i.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=wt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return AO(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=cn.fromDate(r);return{timestampValue:fm(i.serializer,s)}}if(r instanceof cn){const s=new cn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:fm(i.serializer,s)}}if(r instanceof mE)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof gl)return{bytesValue:Gk(i.serializer,r._byteString)};if(r instanceof ir){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:nE(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof _E)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return Zw(l.serializer,c)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${v0(r)}`)}(n,e)}function PR(n,e){const t={};return mk(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Cl(n,(r,i)=>{const s=gf(i,e.Mu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function kR(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof cn||n instanceof mE||n instanceof gl||n instanceof ir||n instanceof S0||n instanceof _E)}function wE(n,e,t){if(!kR(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const r=v0(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function i2(n,e,t){if((e=wt(e))instanceof pf)return e._internalPath;if(typeof e=="string")return EE(n,e);throw _m("Field path arguments must be of type string or ",n,!1,void 0,t)}const OF=new RegExp("[~\\*/\\[\\]]");function EE(n,e,t){if(e.search(OF)>=0)throw _m(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new pf(...e.split("."))._internalPath}catch{throw _m(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function _m(n,e,t,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new de(X.INVALID_ARGUMENT,l+n+c)}function RR(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ym{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ir(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new LF(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(I0("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class LF extends ym{data(){return super.data()}}function I0(n,e){return typeof e=="string"?EE(n,e):e instanceof pf?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xR(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new de(X.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class SE{}class AR extends SE{}function NR(n,e,...t){let r=[];e instanceof SE&&r.push(e),r=r.concat(t),function(s){const o=s.filter(c=>c instanceof CE).length,l=s.filter(c=>c instanceof P0).length;if(o>1||o>0&&l>0)throw new de(X.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class P0 extends AR{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new P0(e,t,r)}_apply(e){const t=this._parse(e);return bR(e._query,t),new pa(e.firestore,e.converter,K1(e._query,t))}_parse(e){const t=C0(e.firestore);return function(s,o,l,c,h,p,m){let _;if(h.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new de(X.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){E3(m,p);const w=[];for(const S of m)w.push(w3(c,s,S));_={arrayValue:{values:w}}}else _=w3(c,s,m)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||E3(m,p),_=MF(l,o,m,p==="in"||p==="not-in");return en.create(h,p,_)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function FF(n,e,t){const r=e,i=I0("where",n);return P0._create(i,r,t)}class CE extends SE{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new CE(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Mi.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i;const l=s.getFlattenedFilters();for(const c of l)bR(o,c),o=K1(o,c)}(e._query,t),new pa(e.firestore,e.converter,K1(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class TE extends AR{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new TE(e,t)}_apply(e){const t=function(i,s,o){if(i.startAt!==null)throw new de(X.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new de(X.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Od(s,o)}(e._query,this._field,this._direction);return new pa(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new vc(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}function VF(n,e="asc"){const t=e,r=I0("orderBy",n);return TE._create(r,t)}function w3(n,e,t){if(typeof(t=wt(t))=="string"){if(t==="")throw new de(X.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ik(e)&&t.indexOf("/")!==-1)throw new de(X.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(vt.fromString(t));if(!we.isDocumentKey(r))throw new de(X.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return zT(n,new we(r))}if(t instanceof ir)return zT(n,t._key);throw new de(X.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${v0(t)}.`)}function E3(n,e){if(!Array.isArray(n)||n.length===0)throw new de(X.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function bR(n,e){const t=function(i,s){for(const o of i)for(const l of o.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new de(X.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new de(X.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class DR{convertValue(e,t="none"){switch(pl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Wt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(fl(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Se()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Cl(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;const s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>Wt(o.doubleValue));return new _E(s)}convertGeoPoint(e){return new mE(Wt(e.latitude),Wt(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Kw(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(bd(e));default:return null}}convertTimestamp(e){const t=ea(e);return new cn(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=vt.fromString(e);nt(Yk(r));const i=new Dd(r.get(1),r.get(3)),s=new we(r.popFirst(5));return i.isEqual(t)||Xs(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MR(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class UF extends DR{constructor(e){super(),this.firestore=e}convertBytes(e){return new gl(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ir(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class IE extends ym{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Tg(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(I0("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class Tg extends IE{data(e={}){return super.data(e)}}class OR{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Iu(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Tg(this._firestore,this._userDataWriter,r.key,r,new Iu(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new de(X.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(l=>{const c=new Tg(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Iu(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const c=new Tg(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Iu(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let h=-1,p=-1;return l.type!==0&&(h=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),p=o.indexOf(l.doc.key)),{type:BF(l.type),doc:c,oldIndex:h,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function BF(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Se()}}class k0 extends DR{constructor(e){super(),this.firestore=e}convertBytes(e){return new gl(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ir(this.firestore,null,t)}}function PE(n){n=ai(n,pa);const e=ai(n.firestore,na),t=E0(e),r=new k0(e);return xR(n._query),kF(t,n._query).then(i=>new OR(e,r,n,i))}function zF(n,e,t){n=ai(n,ir);const r=ai(n.firestore,na),i=MR(n.converter,e,t);return kE(r,[CR(C0(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,rr.none())])}function LR(n,e,t,...r){n=ai(n,ir);const i=ai(n.firestore,na),s=C0(i);let o;return o=typeof(e=wt(e))=="string"||e instanceof pf?IR(s,"updateDoc",n._key,e,t,r):TR(s,"updateDoc",n._key,e),kE(i,[o.toMutation(n._key,rr.exists(!0))])}function FR(n){return kE(ai(n.firestore,na),[new p0(n._key,rr.none())])}function jF(n,...e){var t,r,i;n=wt(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||v3(e[o])||(s=e[o],o++);const l={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(v3(e[o])){const m=e[o];e[o]=(t=m.next)===null||t===void 0?void 0:t.bind(m),e[o+1]=(r=m.error)===null||r===void 0?void 0:r.bind(m),e[o+2]=(i=m.complete)===null||i===void 0?void 0:i.bind(m)}let c,h,p;if(n instanceof ir)h=ai(n.firestore,na),p=Jw(n._key.path),c={next:m=>{e[o]&&e[o](GF(h,n,m))},error:e[o+1],complete:e[o+2]};else{const m=ai(n,pa);h=ai(m.firestore,na),p=m._query;const _=new k0(h);c={next:w=>{e[o]&&e[o](new OR(h,_,m,w))},error:e[o+1],complete:e[o+2]},xR(n._query)}return function(_,w,S,k){const N=new _R(k),x=new lR(w,N,S);return _.asyncQueue.enqueueAndForget(async()=>oR(await r2(_),x)),()=>{N.Za(),_.asyncQueue.enqueueAndForget(async()=>aR(await r2(_),x))}}(E0(h),p,l,c)}function kE(n,e){return function(r,i){const s=new js;return r.asyncQueue.enqueueAndForget(async()=>fF(await IF(r),i,s)),s.promise}(E0(n),e)}function GF(n,e,t){const r=t.docs.get(e._key),i=new k0(n);return new IE(n,i,e._key,r,new Iu(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WF={maxAttempts:5};function Th(n,e){if((n=wt(n)).firestore!==e)throw new de(X.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HF extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=C0(t)}get(t){const r=Th(t,this._firestore),i=new UF(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return Se();const o=s[0];if(o.isFoundDocument())return new ym(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new ym(this._firestore,i,r._key,null,r.converter);throw Se()})}set(t,r,i){const s=Th(t,this._firestore),o=MR(s.converter,r,i),l=CR(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,l),this}update(t,r,i,...s){const o=Th(t,this._firestore);let l;return l=typeof(r=wt(r))=="string"||r instanceof pf?IR(this._dataReader,"Transaction.update",o._key,r,i,s):TR(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,l),this}delete(t){const r=Th(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Th(e,this._firestore),r=new k0(this._firestore);return super.get(e).then(i=>new IE(this._firestore,r,t._key,i._document,new Iu(!1,!1),t.converter))}}function RE(n,e,t){n=ai(n,na);const r=Object.assign(Object.assign({},WF),t);return function(s){if(s.maxAttempts<1)throw new de(X.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,l){const c=new js;return s.asyncQueue.enqueueAndForget(async()=>{const h=await PF(s);new SF(s.asyncQueue,h,l,o,c).au()}),c.promise}(E0(n),i=>e(new HF(n,i)),r)}function tc(){return new vE("serverTimestamp")}(function(e,t=!0){(function(i){yc=i})(Sl),ul(new Jo("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),l=new na(new qM(r.getProvider("auth-internal")),new XM(r.getProvider("app-check-internal")),function(h,p){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new de(X.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Dd(h.options.projectId,p)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),ss(LT,"4.7.3",e),ss(LT,"4.7.3","esm2017")})();var S3={};const C3="@firebase/database",T3="1.0.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let VR="";function $F(n){VR=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qF{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Pn(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:kd(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KF{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return us(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UR=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new qF(e)}}catch{}return new KF},el=UR("localStorage"),QF=UR("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fu=new s0("@firebase/database"),YF=function(){let n=1;return function(){return n++}}(),BR=function(n){const e=S7(n),t=new y7;t.update(e);const r=t.digest();return Aw.encodeByteArray(r)},mf=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=mf.apply(null,r):typeof r=="object"?e+=Pn(r):e+=r,e+=" "}return e};let sd=null,I3=!0;const XF=function(n,e){ae(!0,"Can't turn on custom loggers persistently."),Fu.logLevel=qe.VERBOSE,sd=Fu.log.bind(Fu)},In=function(...n){if(I3===!0&&(I3=!1,sd===null&&QF.get("logging_enabled")===!0&&XF()),sd){const e=mf.apply(null,n);sd(e)}},_f=function(n){return function(...e){In(n,...e)}},s2=function(...n){const e="FIREBASE INTERNAL ERROR: "+mf(...n);Fu.error(e)},Zs=function(...n){const e=`FIREBASE FATAL ERROR: ${mf(...n)}`;throw Fu.error(e),new Error(e)},vr=function(...n){const e="FIREBASE WARNING: "+mf(...n);Fu.warn(e)},JF=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&vr("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},R0=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},ZF=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},nc="[MIN_NAME]",ml="[MAX_NAME]",Il=function(n,e){if(n===e)return 0;if(n===nc||e===ml)return-1;if(e===nc||n===ml)return 1;{const t=P3(n),r=P3(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},eV=function(n,e){return n===e?0:n<e?-1:1},Ih=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+Pn(e))},xE=function(n){if(typeof n!="object"||n===null)return Pn(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=Pn(e[r]),t+=":",t+=xE(n[e[r]]);return t+="}",t},zR=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function Rn(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const jR=function(n){ae(!R0(n),"Invalid JSON number");const e=11,t=52,r=(1<<e-1)-1;let i,s,o,l,c;n===0?(s=0,o=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(l=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=l+r,o=Math.round(n*Math.pow(2,t-l)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-r-t))));const h=[];for(c=t;c;c-=1)h.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)h.push(s%2?1:0),s=Math.floor(s/2);h.push(i?1:0),h.reverse();const p=h.join("");let m="";for(c=0;c<64;c+=8){let _=parseInt(p.substr(c,8),2).toString(16);_.length===1&&(_="0"+_),m=m+_}return m.toLowerCase()},tV=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},nV=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function rV(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");const r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}const iV=new RegExp("^-?(0*)\\d{1,10}$"),sV=-2147483648,oV=2147483647,P3=function(n){if(iV.test(n)){const e=Number(n);if(e>=sV&&e<=oV)return e}return null},Sc=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw vr("Exception was thrown by user callback.",t),e},Math.floor(0))}},aV=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},od=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lV{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){vr(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uV{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(In("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',vr(e)}}class Ig{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Ig.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AE="5",GR="v",WR="s",HR="r",$R="f",qR=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,KR="ls",QR="p",o2="ac",YR="websocket",XR="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JR{constructor(e,t,r,i,s=!1,o="",l=!1,c=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=l,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=el.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&el.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function cV(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function ZR(n,e,t){ae(typeof e=="string","typeof type must == string"),ae(typeof t=="object","typeof params must == object");let r;if(e===YR)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===XR)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);cV(n)&&(t.ns=n.namespace);const i=[];return Rn(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hV{constructor(){this.counters_={}}incrementCounter(e,t=1){us(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return ZN(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yv={},vv={};function NE(n){const e=n.toString();return yv[e]||(yv[e]=new hV),yv[e]}function dV(n,e){const t=n.toString();return vv[t]||(vv[t]=e()),vv[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fV{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Sc(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k3="start",pV="close",gV="pLPCommand",mV="pRTLPCB",e9="id",t9="pw",n9="ser",_V="cb",yV="seg",vV="ts",wV="d",EV="dframe",r9=1870,i9=30,SV=r9-i9,CV=25e3,TV=3e4;class Pu{constructor(e,t,r,i,s,o,l){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=l,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=_f(e),this.stats_=NE(t),this.urlFn=c=>(this.appCheckToken&&(c[o2]=this.appCheckToken),ZR(t,XR,c))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new fV(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(TV)),ZF(()=>{if(this.isClosed_)return;this.scriptTagHolder=new bE((...s)=>{const[o,l,c,h,p]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===k3)this.id=l,this.password=c;else if(o===pV)l?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(l,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{const[o,l]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,l)},()=>{this.onClosed_()},this.urlFn);const r={};r[k3]="t",r[n9]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[_V]=this.scriptTagHolder.uniqueCallbackIdentifier),r[GR]=AE,this.transportSessionId&&(r[WR]=this.transportSessionId),this.lastSessionId&&(r[KR]=this.lastSessionId),this.applicationId&&(r[QR]=this.applicationId),this.appCheckToken&&(r[o2]=this.appCheckToken),typeof location<"u"&&location.hostname&&qR.test(location.hostname)&&(r[HR]=$R);const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Pu.forceAllow_=!0}static forceDisallow(){Pu.forceDisallow_=!0}static isAvailable(){return Pu.forceAllow_?!0:!Pu.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!tV()&&!nV()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=Pn(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=pP(t),i=zR(r,SV);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const r={};r[EV]="t",r[e9]=e,r[t9]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=Pn(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class bE{constructor(e,t,r,i){this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=YF(),window[gV+this.uniqueCallbackIdentifier]=e,window[mV+this.uniqueCallbackIdentifier]=t,this.myIFrame=bE.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(l){In("frame writing exception"),l.stack&&In(l.stack),In(l)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||In("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[e9]=this.myID,e[t9]=this.myPW,e[n9]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+i9+r.length<=r9;){const o=this.pendingSegs.shift();r=r+"&"+yV+i+"="+o.seg+"&"+vV+i+"="+o.ts+"&"+wV+i+"="+o.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(CV)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{In("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IV=16384,PV=45e3;let vm=null;typeof MozWebSocket<"u"?vm=MozWebSocket:typeof WebSocket<"u"&&(vm=WebSocket);class Ii{constructor(e,t,r,i,s,o,l){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=_f(this.connId),this.stats_=NE(t),this.connURL=Ii.connectionURL_(t,o,l,i,r),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,r,i,s){const o={};return o[GR]=AE,typeof location<"u"&&location.hostname&&qR.test(location.hostname)&&(o[HR]=$R),t&&(o[WR]=t),r&&(o[KR]=r),i&&(o[o2]=i),s&&(o[QR]=s),ZR(e,YR,o)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,el.set("previous_websocket_failure",!0);try{let r;u7(),this.mySock=new vm(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){Ii.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(t);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&vm!==null&&!Ii.forceDisallow_}static previouslyFailed(){return el.isInMemoryStorage||el.get("previous_websocket_failure")===!0}markConnectionHealthy(){el.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const r=kd(t);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(ae(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const r=this.extractFrameCount_(t);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const t=Pn(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=zR(t,IV);r.length>1&&this.sendString_(String(r.length));for(let i=0;i<r.length;i++)this.sendString_(r[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(PV))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Ii.responsesRequiredToBeHealthy=2;Ii.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ud{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Pu,Ii]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=Ii&&Ii.isAvailable();let r=t&&!Ii.previouslyFailed();if(e.webSocketOnly&&(t||vr("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[Ii];else{const i=this.transports_=[];for(const s of Ud.ALL_TRANSPORTS)s&&s.isAvailable()&&i.push(s);Ud.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Ud.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kV=6e4,RV=5e3,xV=10*1024,AV=100*1024,wv="t",R3="d",NV="s",x3="r",bV="e",A3="o",N3="a",b3="n",D3="p",DV="h";class MV{constructor(e,t,r,i,s,o,l,c,h,p){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=l,this.onDisconnect_=c,this.onKill_=h,this.lastSessionId=p,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=_f("c:"+this.id+":"),this.transportManager_=new Ud(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=od(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>AV?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>xV?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(wv in e){const t=e[wv];t===N3?this.upgradeIfSecondaryHealthy_():t===x3?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===A3&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Ih("t",e),r=Ih("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:D3,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:N3,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:b3,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Ih("t",e),r=Ih("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Ih(wv,e);if(R3 in e){const r=e[R3];if(t===DV){const i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===b3){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===NV?this.onConnectionShutdown_(r):t===x3?this.onReset_(r):t===bV?s2("Server Error: "+r):t===A3?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):s2("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),AE!==r&&vr("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),od(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(kV))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):od(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(RV))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:D3,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(el.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s9{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o9{constructor(e){this.allowedEvents_=e,this.listeners_={},ae(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){ae(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wm extends o9{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Nw()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new wm}getInitialEvent(e){return ae(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M3=32,O3=768;let ht=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function ot(){return new ht("")}function Fe(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function ra(n){return n.pieces_.length-n.pieceNum_}function yt(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new ht(n.pieces_,e)}function DE(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function OV(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function Bd(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function a9(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new ht(e,0)}function Mt(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof ht)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new ht(t,0)}function Be(n){return n.pieceNum_>=n.pieces_.length}function br(n,e){const t=Fe(n),r=Fe(e);if(t===null)return e;if(t===r)return br(yt(n),yt(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function LV(n,e){const t=Bd(n,0),r=Bd(e,0);for(let i=0;i<t.length&&i<r.length;i++){const s=Il(t[i],r[i]);if(s!==0)return s}return t.length===r.length?0:t.length<r.length?-1:1}function ME(n,e){if(ra(n)!==ra(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function si(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(ra(n)>ra(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class FV{constructor(e,t){this.errorPrefix_=t,this.parts_=Bd(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=i0(this.parts_[r]);l9(this)}}function VV(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=i0(e),l9(n)}function UV(n){const e=n.parts_.pop();n.byteLength_-=i0(e),n.parts_.length>0&&(n.byteLength_-=1)}function l9(n){if(n.byteLength_>O3)throw new Error(n.errorPrefix_+"has a key path longer than "+O3+" bytes ("+n.byteLength_+").");if(n.parts_.length>M3)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+M3+") or object contains a cycle "+qa(n))}function qa(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OE extends o9{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new OE}getInitialEvent(e){return ae(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ph=1e3,BV=60*5*1e3,L3=30*1e3,zV=1.3,jV=3e4,GV="server_kill",F3=3;class Gs extends s9{constructor(e,t,r,i,s,o,l,c){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=r,this.onConnectStatus_=i,this.onServerInfoUpdate_=s,this.authTokenProvider_=o,this.appCheckTokenProvider_=l,this.authOverride_=c,this.id=Gs.nextPersistentConnectionId_++,this.log_=_f("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ph,this.maxReconnectDelay_=BV,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");OE.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&wm.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,r){const i=++this.requestNumber_,s={r:i,a:e,b:t};this.log_(Pn(s)),ae(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),r&&(this.requestCBHash_[i]=r)}get(e){this.initConnection_();const t=new ts,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const l=o.d;o.s==="ok"?t.resolve(l):t.reject(l)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),t.promise}listen(e,t,r,i){this.initConnection_();const s=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+s),this.listens.has(o)||this.listens.set(o,new Map),ae(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),ae(!this.listens.get(o).has(s),"listen() called twice for same path/queryId.");const l={onComplete:i,hashFn:t,query:e,tag:r};this.listens.get(o).set(s,l),this.connected_&&this.sendListen_(l)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(r)})}sendListen_(e){const t=e.query,r=t._path.toString(),i=t._queryIdentifier;this.log_("Listen on "+r+" for "+i);const s={p:r},o="q";e.tag&&(s.q=t._queryObject,s.t=e.tag),s.h=e.hashFn(),this.sendRequest(o,s,l=>{const c=l.d,h=l.s;Gs.warnOnListenWarnings_(c,t),(this.listens.get(r)&&this.listens.get(r).get(i))===e&&(this.log_("listen response",l),h!=="ok"&&this.removeListen_(r,i),e.onComplete&&e.onComplete(h,c))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&us(e,"w")){const r=qu(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const i='".indexOn": "'+t._queryParams.getIndex().toString()+'"',s=t._path.toString();vr(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||_7(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=L3)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=m7(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(t,r,i=>{const s=i.s,o=i.d||"error";this.authToken_===e&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,r=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,r)})}unlisten(e,t){const r=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+i),ae(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,i)&&this.connected_&&this.sendUnlisten_(r,i,e._queryObject,t)}sendUnlisten_(e,t,r,i){this.log_("Unlisten on "+e+" for "+t);const s={p:e},o="n";i&&(s.q=r,s.t=i),this.sendRequest(o,s)}onDisconnectPut(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:r})}onDisconnectMerge(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:r})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,r,i){const s={p:t,d:r};this.log_("onDisconnect "+e,s),this.sendRequest(e,s,o=>{i&&setTimeout(()=>{i(o.s,o.d)},Math.floor(0))})}put(e,t,r,i){this.putInternal("p",e,t,r,i)}merge(e,t,r,i){this.putInternal("m",e,t,r,i)}putInternal(e,t,r,i,s){this.initConnection_();const o={p:t,d:r};s!==void 0&&(o.h=s),this.outstandingPuts_.push({action:e,request:o,onComplete:i}),this.outstandingPutCount_++;const l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,r,s=>{this.log_(t+" response",s),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(s.s,s.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,r=>{if(r.s!=="ok"){const s=r.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Pn(e));const t=e.r,r=this.requestCBHash_[t];r&&(delete this.requestCBHash_[t],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):s2("Unrecognized action received from server: "+Pn(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){ae(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ph,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Ph,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>jV&&(this.reconnectDelay_=Ph),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*zV)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+Gs.nextConnectionId_++,s=this.lastSessionId;let o=!1,l=null;const c=function(){l?l.close():(o=!0,r())},h=function(m){ae(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(m)};this.realtime_={close:c,sendRequest:h};const p=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[m,_]=await Promise.all([this.authTokenProvider_.getToken(p),this.appCheckTokenProvider_.getToken(p)]);o?In("getToken() completed but was canceled"):(In("getToken() completed. Creating connection."),this.authToken_=m&&m.accessToken,this.appCheckToken_=_&&_.token,l=new MV(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,r,w=>{vr(w+" ("+this.repoInfo_.toString()+")"),this.interrupt(GV)},s))}catch(m){this.log_("Failed to get token: "+m),o||(this.repoInfo_.nodeAdmin&&vr(m),c())}}}interrupt(e){In("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){In("Resuming connection for reason: "+e),delete this.interruptReasons_[e],tm(this.interruptReasons_)&&(this.reconnectDelay_=Ph,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let r;t?r=t.map(s=>xE(s)).join("$"):r="default";const i=this.removeListen_(e,r);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,t){const r=new ht(e).toString();let i;if(this.listens.has(r)){const s=this.listens.get(r);i=s.get(t),s.delete(t),s.size===0&&this.listens.delete(r)}else i=void 0;return i}onAuthRevoked_(e,t){In("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=F3&&(this.reconnectDelay_=L3,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){In("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=F3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+VR.replace(/\./g,"-")]=1,Nw()?e["framework.cordova"]=1:EP()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=wm.getInstance().currentlyOnline();return tm(this.interruptReasons_)&&e}}Gs.nextPersistentConnectionId_=0;Gs.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ze{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new ze(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x0{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new ze(nc,e),i=new ze(nc,t);return this.compare(r,i)!==0}minPost(){return ze.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yp;class u9 extends x0{static get __EMPTY_NODE(){return Yp}static set __EMPTY_NODE(e){Yp=e}compare(e,t){return Il(e.name,t.name)}isDefinedOn(e){throw gc("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return ze.MIN}maxPost(){return new ze(ml,Yp)}makePost(e,t){return ae(typeof e=="string","KeyIndex indexValue must always be a string."),new ze(e,Yp)}toString(){return".key"}}const Vu=new u9;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xp{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Cn{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??Cn.RED,this.left=i??Dr.EMPTY_NODE,this.right=s??Dr.EMPTY_NODE}copy(e,t,r,i,s){return new Cn(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return s<0?i=i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i=i.copy(null,t,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return Dr.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let r,i;if(r=this,t(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),t(e,r.key)===0){if(r.right.isEmpty())return Dr.EMPTY_NODE;i=r.right.min_(),r=r.copy(i.key,i.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Cn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Cn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Cn.RED=!0;Cn.BLACK=!1;class WV{copy(e,t,r,i,s){return this}insert(e,t,r){return new Cn(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Dr{constructor(e,t=Dr.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Dr(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Cn.BLACK,null,null))}remove(e){return new Dr(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Cn.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Xp(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Xp(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Xp(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Xp(this.root_,null,this.comparator_,!0,e)}}Dr.EMPTY_NODE=new WV;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HV(n,e){return Il(n.name,e.name)}function LE(n,e){return Il(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let a2;function $V(n){a2=n}const c9=function(n){return typeof n=="number"?"number:"+jR(n):"string:"+n},h9=function(n){if(n.isLeafNode()){const e=n.val();ae(typeof e=="string"||typeof e=="number"||typeof e=="object"&&us(e,".sv"),"Priority must be a string or number.")}else ae(n===a2||n.isEmpty(),"priority of unexpected type.");ae(n===a2||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let V3;class vn{constructor(e,t=vn.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,ae(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),h9(this.priorityNode_)}static set __childrenNodeConstructor(e){V3=e}static get __childrenNodeConstructor(){return V3}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new vn(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:vn.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Be(e)?this:Fe(e)===".priority"?this.priorityNode_:vn.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:vn.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const r=Fe(e);return r===null?t:t.isEmpty()&&r!==".priority"?this:(ae(r!==".priority"||ra(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,vn.__childrenNodeConstructor.EMPTY_NODE.updateChild(yt(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+c9(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=jR(this.value_):e+=this.value_,this.lazyHash_=BR(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===vn.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof vn.__childrenNodeConstructor?-1:(ae(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,r=typeof this.value_,i=vn.VALUE_TYPE_ORDER.indexOf(t),s=vn.VALUE_TYPE_ORDER.indexOf(r);return ae(i>=0,"Unknown leaf type: "+t),ae(s>=0,"Unknown leaf type: "+r),i===s?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}vn.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let d9,f9;function qV(n){d9=n}function KV(n){f9=n}class QV extends x0{compare(e,t){const r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return s===0?Il(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return ze.MIN}maxPost(){return new ze(ml,new vn("[PRIORITY-POST]",f9))}makePost(e,t){const r=d9(e);return new ze(t,new vn("[PRIORITY-POST]",r))}toString(){return".priority"}}const Ot=new QV;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YV=Math.log(2);class XV{constructor(e){const t=s=>parseInt(Math.log(s)/YV,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Em=function(n,e,t,r){n.sort(e);const i=function(c,h){const p=h-c;let m,_;if(p===0)return null;if(p===1)return m=n[c],_=t?t(m):m,new Cn(_,m.node,Cn.BLACK,null,null);{const w=parseInt(p/2,10)+c,S=i(c,w),k=i(w+1,h);return m=n[w],_=t?t(m):m,new Cn(_,m.node,Cn.BLACK,S,k)}},s=function(c){let h=null,p=null,m=n.length;const _=function(S,k){const N=m-S,x=m;m-=S;const R=i(N+1,x),E=n[N],P=t?t(E):E;w(new Cn(P,E.node,k,null,R))},w=function(S){h?(h.left=S,h=S):(p=S,h=S)};for(let S=0;S<c.count;++S){const k=c.nextBitIsOne(),N=Math.pow(2,c.count-(S+1));k?_(N,Cn.BLACK):(_(N,Cn.BLACK),_(N,Cn.RED))}return p},o=new XV(n.length),l=s(o);return new Dr(r||e,l)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ev;const su={};class Us{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return ae(su&&Ot,"ChildrenNode.ts has not been loaded"),Ev=Ev||new Us({".priority":su},{".priority":Ot}),Ev}get(e){const t=qu(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Dr?t:null}hasIndex(e){return us(this.indexSet_,e.toString())}addIndex(e,t){ae(e!==Vu,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const s=t.getIterator(ze.Wrap);let o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let l;i?l=Em(r,e.getCompare()):l=su;const c=e.toString(),h=Object.assign({},this.indexSet_);h[c]=e;const p=Object.assign({},this.indexes_);return p[c]=l,new Us(p,h)}addToIndexes(e,t){const r=nm(this.indexes_,(i,s)=>{const o=qu(this.indexSet_,s);if(ae(o,"Missing index implementation for "+s),i===su)if(o.isDefinedOn(e.node)){const l=[],c=t.getIterator(ze.Wrap);let h=c.getNext();for(;h;)h.name!==e.name&&l.push(h),h=c.getNext();return l.push(e),Em(l,o.getCompare())}else return su;else{const l=t.get(e.name);let c=i;return l&&(c=c.remove(new ze(e.name,l))),c.insert(e,e.node)}});return new Us(r,this.indexSet_)}removeFromIndexes(e,t){const r=nm(this.indexes_,i=>{if(i===su)return i;{const s=t.get(e.name);return s?i.remove(new ze(e.name,s)):i}});return new Us(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kh;class Pe{constructor(e,t,r){this.children_=e,this.priorityNode_=t,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&h9(this.priorityNode_),this.children_.isEmpty()&&ae(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return kh||(kh=new Pe(new Dr(LE),null,Us.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||kh}updatePriority(e){return this.children_.isEmpty()?this:new Pe(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?kh:t}}getChild(e){const t=Fe(e);return t===null?this:this.getImmediateChild(t).getChild(yt(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(ae(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const r=new ze(e,t);let i,s;t.isEmpty()?(i=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,t),s=this.indexMap_.addToIndexes(r,this.children_));const o=i.isEmpty()?kh:this.priorityNode_;return new Pe(i,o,s)}}updateChild(e,t){const r=Fe(e);if(r===null)return t;{ae(Fe(e)!==".priority"||ra(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(r).updateChild(yt(e),t);return this.updateImmediateChild(r,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let r=0,i=0,s=!0;if(this.forEachChild(Ot,(o,l)=>{t[o]=l.val(e),r++,s&&Pe.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):s=!1}),!e&&s&&i<2*r){const o=[];for(const l in t)o[l]=t[l];return o}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+c9(this.getPriority().val())+":"),this.forEachChild(Ot,(t,r)=>{const i=r.hash();i!==""&&(e+=":"+t+":"+i)}),this.lazyHash_=e===""?"":BR(e)}return this.lazyHash_}getPredecessorChildName(e,t,r){const i=this.resolveIndex_(r);if(i){const s=i.getPredecessorKey(new ze(e,t));return s?s.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const r=t.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new ze(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const r=t.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new ze(t,this.children_.get(t)):null}forEachChild(e,t){const r=this.resolveIndex_(e);return r?r.inorderTraversal(i=>t(i.name,i.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const r=this.resolveIndex_(t);if(r)return r.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,ze.Wrap);let s=i.peek();for(;s!=null&&t.compare(s,e)<0;)i.getNext(),s=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const r=this.resolveIndex_(t);if(r)return r.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,ze.Wrap);let s=i.peek();for(;s!=null&&t.compare(s,e)>0;)i.getNext(),s=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===yf?-1:0}withIndex(e){if(e===Vu||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new Pe(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Vu||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const r=this.getIterator(Ot),i=t.getIterator(Ot);let s=r.getNext(),o=i.getNext();for(;s&&o;){if(s.name!==o.name||!s.node.equals(o.node))return!1;s=r.getNext(),o=i.getNext()}return s===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===Vu?null:this.indexMap_.get(e.toString())}}Pe.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class JV extends Pe{constructor(){super(new Dr(LE),Pe.EMPTY_NODE,Us.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Pe.EMPTY_NODE}isEmpty(){return!1}}const yf=new JV;Object.defineProperties(ze,{MIN:{value:new ze(nc,Pe.EMPTY_NODE)},MAX:{value:new ze(ml,yf)}});u9.__EMPTY_NODE=Pe.EMPTY_NODE;vn.__childrenNodeConstructor=Pe;$V(yf);KV(yf);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZV=!0;function $t(n,e=null){if(n===null)return Pe.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),ae(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new vn(t,$t(e))}if(!(n instanceof Array)&&ZV){const t=[];let r=!1;if(Rn(n,(o,l)=>{if(o.substring(0,1)!=="."){const c=$t(l);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),t.push(new ze(o,c)))}}),t.length===0)return Pe.EMPTY_NODE;const s=Em(t,HV,o=>o.name,LE);if(r){const o=Em(t,Ot.getCompare());return new Pe(s,$t(e),new Us({".priority":o},{".priority":Ot}))}else return new Pe(s,$t(e),Us.Default)}else{let t=Pe.EMPTY_NODE;return Rn(n,(r,i)=>{if(us(n,r)&&r.substring(0,1)!=="."){const s=$t(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority($t(e))}}qV($t);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eU extends x0{constructor(e){super(),this.indexPath_=e,ae(!Be(e)&&Fe(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return s===0?Il(e.name,t.name):s}makePost(e,t){const r=$t(e),i=Pe.EMPTY_NODE.updateChild(this.indexPath_,r);return new ze(t,i)}maxPost(){const e=Pe.EMPTY_NODE.updateChild(this.indexPath_,yf);return new ze(ml,e)}toString(){return Bd(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tU extends x0{compare(e,t){const r=e.node.compareTo(t.node);return r===0?Il(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return ze.MIN}maxPost(){return ze.MAX}makePost(e,t){const r=$t(e);return new ze(t,r)}toString(){return".value"}}const nU=new tU;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p9(n){return{type:"value",snapshotNode:n}}function rc(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function zd(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function jd(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function rU(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FE{constructor(e){this.index_=e}updateChild(e,t,r,i,s,o){ae(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const l=e.getImmediateChild(t);return l.getChild(i).equals(r.getChild(i))&&l.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(t)?o.trackChildChange(zd(t,l)):ae(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):l.isEmpty()?o.trackChildChange(rc(t,r)):o.trackChildChange(jd(t,r,l))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Ot,(i,s)=>{t.hasChild(i)||r.trackChildChange(zd(i,s))}),t.isLeafNode()||t.forEachChild(Ot,(i,s)=>{if(e.hasChild(i)){const o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(jd(i,s,o))}else r.trackChildChange(rc(i,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?Pe.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gd{constructor(e){this.indexedFilter_=new FE(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Gd.getStartPost_(e),this.endPost_=Gd.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,s,o){return this.matches(new ze(t,r))||(r=Pe.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,s,o)}updateFullNode(e,t,r){t.isLeafNode()&&(t=Pe.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(Pe.EMPTY_NODE);const s=this;return t.forEachChild(Ot,(o,l)=>{s.matches(new ze(o,l))||(i=i.updateImmediateChild(o,Pe.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iU{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{const r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Gd(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,s,o){return this.rangedFilter_.matches(new ze(t,r))||(r=Pe.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,s,o):this.fullLimitUpdateChild_(e,t,r,s,o)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=Pe.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){i=Pe.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){const l=s.getNext();if(this.withinDirectionalStart(l))if(this.withinDirectionalEnd(l))i=i.updateImmediateChild(l.name,l.node),o++;else break;else continue}}else{i=t.withIndex(this.index_),i=i.updatePriority(Pe.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){const l=s.getNext();o<this.limit_&&this.withinDirectionalStart(l)&&this.withinDirectionalEnd(l)?o++:i=i.updateImmediateChild(l.name,Pe.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,s){let o;if(this.reverse_){const m=this.index_.getCompare();o=(_,w)=>m(w,_)}else o=this.index_.getCompare();const l=e;ae(l.numChildren()===this.limit_,"");const c=new ze(t,r),h=this.reverse_?l.getFirstChild(this.index_):l.getLastChild(this.index_),p=this.rangedFilter_.matches(c);if(l.hasChild(t)){const m=l.getImmediateChild(t);let _=i.getChildAfterChild(this.index_,h,this.reverse_);for(;_!=null&&(_.name===t||l.hasChild(_.name));)_=i.getChildAfterChild(this.index_,_,this.reverse_);const w=_==null?1:o(_,c);if(p&&!r.isEmpty()&&w>=0)return s!=null&&s.trackChildChange(jd(t,r,m)),l.updateImmediateChild(t,r);{s!=null&&s.trackChildChange(zd(t,m));const k=l.updateImmediateChild(t,Pe.EMPTY_NODE);return _!=null&&this.rangedFilter_.matches(_)?(s!=null&&s.trackChildChange(rc(_.name,_.node)),k.updateImmediateChild(_.name,_.node)):k}}else return r.isEmpty()?e:p&&o(h,c)>=0?(s!=null&&(s.trackChildChange(zd(h.name,h.node)),s.trackChildChange(rc(t,r))),l.updateImmediateChild(t,r).updateImmediateChild(h.name,Pe.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VE{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ot}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return ae(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return ae(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:nc}hasEnd(){return this.endSet_}getIndexEndValue(){return ae(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return ae(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:ml}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return ae(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ot}copy(){const e=new VE;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function sU(n){return n.loadsAllData()?new FE(n.getIndex()):n.hasLimit()?new iU(n):new Gd(n)}function U3(n){const e={};if(n.isDefault())return e;let t;if(n.index_===Ot?t="$priority":n.index_===nU?t="$value":n.index_===Vu?t="$key":(ae(n.index_ instanceof eU,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=Pn(t),n.startSet_){const r=n.startAfterSet_?"startAfter":"startAt";e[r]=Pn(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+Pn(n.indexStartName_))}if(n.endSet_){const r=n.endBeforeSet_?"endBefore":"endAt";e[r]=Pn(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+Pn(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function B3(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==Ot&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sm extends s9{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=_f("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(ae(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const o=Sm.getListenId_(e,r),l={};this.listens_[o]=l;const c=U3(e._queryParams);this.restRequest_(s+".json",c,(h,p)=>{let m=p;if(h===404&&(m=null,h=null),h===null&&this.onDataUpdate_(s,m,!1,r),qu(this.listens_,o)===l){let _;h?h===401?_="permission_denied":_="rest_error:"+h:_="ok",i(_,null)}})}unlisten(e,t){const r=Sm.getListenId_(e,t);delete this.listens_[r]}get(e){const t=U3(e._queryParams),r=e._path.toString(),i=new ts;return this.restRequest_(r+".json",t,(s,o)=>{let l=o;s===404&&(l=null,s=null),s===null?(this.onDataUpdate_(r,l,!1,null),i.resolve(l)):i.reject(new Error(l))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+mc(t);this.log_("Sending REST request for "+o);const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(r&&l.readyState===4){this.log_("REST Response for "+o+" received. status:",l.status,"response:",l.responseText);let c=null;if(l.status>=200&&l.status<300){try{c=kd(l.responseText)}catch{vr("Failed to parse JSON response for "+o+": "+l.responseText)}r(null,c)}else l.status!==401&&l.status!==404&&vr("Got unsuccessful REST response for "+o+" Status: "+l.status),r(l.status);r=null}},l.open("GET",o,!0),l.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oU{constructor(){this.rootNode_=Pe.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cm(){return{value:null,children:new Map}}function Cc(n,e,t){if(Be(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const r=Fe(e);n.children.has(r)||n.children.set(r,Cm());const i=n.children.get(r);e=yt(e),Cc(i,e,t)}}function l2(n,e){if(Be(e))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{const t=n.value;return n.value=null,t.forEachChild(Ot,(r,i)=>{Cc(n,new ht(r),i)}),l2(n,e)}}else if(n.children.size>0){const t=Fe(e);return e=yt(e),n.children.has(t)&&l2(n.children.get(t),e)&&n.children.delete(t),n.children.size===0}else return!0}function u2(n,e,t){n.value!==null?t(e,n.value):aU(n,(r,i)=>{const s=new ht(e.toString()+"/"+r);u2(i,s,t)})}function aU(n,e){n.children.forEach((t,r)=>{e(r,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lU{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Rn(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z3=10*1e3,uU=30*1e3,cU=5*60*1e3;class hU{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new lU(e);const r=z3+(uU-z3)*Math.random();od(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;Rn(e,(i,s)=>{s>0&&us(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),od(this.reportStats_.bind(this),Math.floor(Math.random()*2*cU))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ki;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(ki||(ki={}));function UE(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function BE(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function zE(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tm{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=ki.ACK_USER_WRITE,this.source=UE()}operationForChild(e){if(Be(this.path)){if(this.affectedTree.value!=null)return ae(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new ht(e));return new Tm(ot(),t,this.revert)}}else return ae(Fe(this.path)===e,"operationForChild called for unrelated child."),new Tm(yt(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wd{constructor(e,t){this.source=e,this.path=t,this.type=ki.LISTEN_COMPLETE}operationForChild(e){return Be(this.path)?new Wd(this.source,ot()):new Wd(this.source,yt(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=ki.OVERWRITE}operationForChild(e){return Be(this.path)?new _l(this.source,ot(),this.snap.getImmediateChild(e)):new _l(this.source,yt(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=ki.MERGE}operationForChild(e){if(Be(this.path)){const t=this.children.subtree(new ht(e));return t.isEmpty()?null:t.value?new _l(this.source,ot(),t.value):new ic(this.source,ot(),t)}else return ae(Fe(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new ic(this.source,yt(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yl{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Be(e))return this.isFullyInitialized()&&!this.filtered_;const t=Fe(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dU{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function fU(n,e,t,r){const i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(rU(o.childName,o.snapshotNode))}),Rh(n,i,"child_removed",e,r,t),Rh(n,i,"child_added",e,r,t),Rh(n,i,"child_moved",s,r,t),Rh(n,i,"child_changed",e,r,t),Rh(n,i,"value",e,r,t),i}function Rh(n,e,t,r,i,s){const o=r.filter(l=>l.type===t);o.sort((l,c)=>gU(n,l,c)),o.forEach(l=>{const c=pU(n,l,s);i.forEach(h=>{h.respondsTo(l.type)&&e.push(h.createEvent(c,n.query_))})})}function pU(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function gU(n,e,t){if(e.childName==null||t.childName==null)throw gc("Should only compare child_ events.");const r=new ze(e.childName,e.snapshotNode),i=new ze(t.childName,t.snapshotNode);return n.index_.compare(r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A0(n,e){return{eventCache:n,serverCache:e}}function ad(n,e,t,r){return A0(new yl(e,t,r),n.serverCache)}function g9(n,e,t,r){return A0(n.eventCache,new yl(e,t,r))}function c2(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function vl(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sv;const mU=()=>(Sv||(Sv=new Dr(eV)),Sv);class St{constructor(e,t=mU()){this.value=e,this.children=t}static fromObject(e){let t=new St(null);return Rn(e,(r,i)=>{t=t.set(new ht(r),i)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:ot(),value:this.value};if(Be(e))return null;{const r=Fe(e),i=this.children.get(r);if(i!==null){const s=i.findRootMostMatchingPathAndValue(yt(e),t);return s!=null?{path:Mt(new ht(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Be(e))return this;{const t=Fe(e),r=this.children.get(t);return r!==null?r.subtree(yt(e)):new St(null)}}set(e,t){if(Be(e))return new St(t,this.children);{const r=Fe(e),s=(this.children.get(r)||new St(null)).set(yt(e),t),o=this.children.insert(r,s);return new St(this.value,o)}}remove(e){if(Be(e))return this.children.isEmpty()?new St(null):new St(null,this.children);{const t=Fe(e),r=this.children.get(t);if(r){const i=r.remove(yt(e));let s;return i.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,i),this.value===null&&s.isEmpty()?new St(null):new St(this.value,s)}else return this}}get(e){if(Be(e))return this.value;{const t=Fe(e),r=this.children.get(t);return r?r.get(yt(e)):null}}setTree(e,t){if(Be(e))return t;{const r=Fe(e),s=(this.children.get(r)||new St(null)).setTree(yt(e),t);let o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new St(this.value,o)}}fold(e){return this.fold_(ot(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Mt(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,ot(),t)}findOnPath_(e,t,r){const i=this.value?r(t,this.value):!1;if(i)return i;if(Be(e))return null;{const s=Fe(e),o=this.children.get(s);return o?o.findOnPath_(yt(e),Mt(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,ot(),t)}foreachOnPath_(e,t,r){if(Be(e))return this;{this.value&&r(t,this.value);const i=Fe(e),s=this.children.get(i);return s?s.foreachOnPath_(yt(e),Mt(t,i),r):new St(null)}}foreach(e){this.foreach_(ot(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(Mt(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(e){this.writeTree_=e}static empty(){return new Ni(new St(null))}}function ld(n,e,t){if(Be(e))return new Ni(new St(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){const i=r.path;let s=r.value;const o=br(i,e);return s=s.updateChild(o,t),new Ni(n.writeTree_.set(i,s))}else{const i=new St(t),s=n.writeTree_.setTree(e,i);return new Ni(s)}}}function h2(n,e,t){let r=n;return Rn(t,(i,s)=>{r=ld(r,Mt(e,i),s)}),r}function j3(n,e){if(Be(e))return Ni.empty();{const t=n.writeTree_.setTree(e,new St(null));return new Ni(t)}}function d2(n,e){return Pl(n,e)!=null}function Pl(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(br(t.path,e)):null}function G3(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(Ot,(r,i)=>{e.push(new ze(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new ze(r,i.value))}),e}function Ko(n,e){if(Be(e))return n;{const t=Pl(n,e);return t!=null?new Ni(new St(t)):new Ni(n.writeTree_.subtree(e))}}function f2(n){return n.writeTree_.isEmpty()}function sc(n,e){return m9(ot(),n.writeTree_,e)}function m9(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(ae(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):t=m9(Mt(n,i),s,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(Mt(n,".priority"),r)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jE(n,e){return w9(e,n)}function _U(n,e,t,r,i){ae(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=ld(n.visibleWrites,e,t)),n.lastWriteId=r}function yU(n,e,t,r){ae(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=h2(n.visibleWrites,e,t),n.lastWriteId=r}function vU(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}function wU(n,e){const t=n.allWrites.findIndex(l=>l.writeId===e);ae(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){const l=n.allWrites[o];l.visible&&(o>=t&&EU(l,r.path)?i=!1:si(r.path,l.path)&&(s=!0)),o--}if(i){if(s)return SU(n),!0;if(r.snap)n.visibleWrites=j3(n.visibleWrites,r.path);else{const l=r.children;Rn(l,c=>{n.visibleWrites=j3(n.visibleWrites,Mt(r.path,c))})}return!0}else return!1}function EU(n,e){if(n.snap)return si(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&si(Mt(n.path,t),e))return!0;return!1}function SU(n){n.visibleWrites=_9(n.allWrites,CU,ot()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function CU(n){return n.visible}function _9(n,e,t){let r=Ni.empty();for(let i=0;i<n.length;++i){const s=n[i];if(e(s)){const o=s.path;let l;if(s.snap)si(t,o)?(l=br(t,o),r=ld(r,l,s.snap)):si(o,t)&&(l=br(o,t),r=ld(r,ot(),s.snap.getChild(l)));else if(s.children){if(si(t,o))l=br(t,o),r=h2(r,l,s.children);else if(si(o,t))if(l=br(o,t),Be(l))r=h2(r,ot(),s.children);else{const c=qu(s.children,Fe(l));if(c){const h=c.getChild(yt(l));r=ld(r,ot(),h)}}}else throw gc("WriteRecord should have .snap or .children")}}return r}function y9(n,e,t,r,i){if(!r&&!i){const s=Pl(n.visibleWrites,e);if(s!=null)return s;{const o=Ko(n.visibleWrites,e);if(f2(o))return t;if(t==null&&!d2(o,ot()))return null;{const l=t||Pe.EMPTY_NODE;return sc(o,l)}}}else{const s=Ko(n.visibleWrites,e);if(!i&&f2(s))return t;if(!i&&t==null&&!d2(s,ot()))return null;{const o=function(h){return(h.visible||i)&&(!r||!~r.indexOf(h.writeId))&&(si(h.path,e)||si(e,h.path))},l=_9(n.allWrites,o,e),c=t||Pe.EMPTY_NODE;return sc(l,c)}}}function TU(n,e,t){let r=Pe.EMPTY_NODE;const i=Pl(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Ot,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){const s=Ko(n.visibleWrites,e);return t.forEachChild(Ot,(o,l)=>{const c=sc(Ko(s,new ht(o)),l);r=r.updateImmediateChild(o,c)}),G3(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{const s=Ko(n.visibleWrites,e);return G3(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function IU(n,e,t,r,i){ae(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=Mt(e,t);if(d2(n.visibleWrites,s))return null;{const o=Ko(n.visibleWrites,s);return f2(o)?i.getChild(t):sc(o,i.getChild(t))}}function PU(n,e,t,r){const i=Mt(e,t),s=Pl(n.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(t)){const o=Ko(n.visibleWrites,i);return sc(o,r.getNode().getImmediateChild(t))}else return null}function kU(n,e){return Pl(n.visibleWrites,e)}function RU(n,e,t,r,i,s,o){let l;const c=Ko(n.visibleWrites,e),h=Pl(c,ot());if(h!=null)l=h;else if(t!=null)l=sc(c,t);else return[];if(l=l.withIndex(o),!l.isEmpty()&&!l.isLeafNode()){const p=[],m=o.getCompare(),_=s?l.getReverseIteratorFrom(r,o):l.getIteratorFrom(r,o);let w=_.getNext();for(;w&&p.length<i;)m(w,r)!==0&&p.push(w),w=_.getNext();return p}else return[]}function xU(){return{visibleWrites:Ni.empty(),allWrites:[],lastWriteId:-1}}function Im(n,e,t,r){return y9(n.writeTree,n.treePath,e,t,r)}function GE(n,e){return TU(n.writeTree,n.treePath,e)}function W3(n,e,t,r){return IU(n.writeTree,n.treePath,e,t,r)}function Pm(n,e){return kU(n.writeTree,Mt(n.treePath,e))}function AU(n,e,t,r,i,s){return RU(n.writeTree,n.treePath,e,t,r,i,s)}function WE(n,e,t){return PU(n.writeTree,n.treePath,e,t)}function v9(n,e){return w9(Mt(n.treePath,e),n.writeTree)}function w9(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NU{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;ae(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),ae(r!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const s=i.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(r,jd(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(r,zd(r,i.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(r,rc(r,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(r,jd(r,e.snapshotNode,i.oldSnap));else throw gc("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bU{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}}const E9=new bU;class HE{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new yl(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return WE(this.writes_,e,r)}}getChildAfterChild(e,t,r){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:vl(this.viewCache_),s=AU(this.writes_,i,t,1,r,e);return s.length===0?null:s[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DU(n){return{filter:n}}function MU(n,e){ae(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),ae(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function OU(n,e,t,r,i){const s=new NU;let o,l;if(t.type===ki.OVERWRITE){const h=t;h.source.fromUser?o=p2(n,e,h.path,h.snap,r,i,s):(ae(h.source.fromServer,"Unknown source."),l=h.source.tagged||e.serverCache.isFiltered()&&!Be(h.path),o=km(n,e,h.path,h.snap,r,i,l,s))}else if(t.type===ki.MERGE){const h=t;h.source.fromUser?o=FU(n,e,h.path,h.children,r,i,s):(ae(h.source.fromServer,"Unknown source."),l=h.source.tagged||e.serverCache.isFiltered(),o=g2(n,e,h.path,h.children,r,i,l,s))}else if(t.type===ki.ACK_USER_WRITE){const h=t;h.revert?o=BU(n,e,h.path,r,i,s):o=VU(n,e,h.path,h.affectedTree,r,i,s)}else if(t.type===ki.LISTEN_COMPLETE)o=UU(n,e,t.path,r,s);else throw gc("Unknown operation type: "+t.type);const c=s.getChanges();return LU(e,o,c),{viewCache:o,changes:c}}function LU(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=c2(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(p9(c2(e)))}}function S9(n,e,t,r,i,s){const o=e.eventCache;if(Pm(r,t)!=null)return e;{let l,c;if(Be(t))if(ae(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const h=vl(e),p=h instanceof Pe?h:Pe.EMPTY_NODE,m=GE(r,p);l=n.filter.updateFullNode(e.eventCache.getNode(),m,s)}else{const h=Im(r,vl(e));l=n.filter.updateFullNode(e.eventCache.getNode(),h,s)}else{const h=Fe(t);if(h===".priority"){ae(ra(t)===1,"Can't have a priority with additional path components");const p=o.getNode();c=e.serverCache.getNode();const m=W3(r,t,p,c);m!=null?l=n.filter.updatePriority(p,m):l=o.getNode()}else{const p=yt(t);let m;if(o.isCompleteForChild(h)){c=e.serverCache.getNode();const _=W3(r,t,o.getNode(),c);_!=null?m=o.getNode().getImmediateChild(h).updateChild(p,_):m=o.getNode().getImmediateChild(h)}else m=WE(r,h,e.serverCache);m!=null?l=n.filter.updateChild(o.getNode(),h,m,p,i,s):l=o.getNode()}}return ad(e,l,o.isFullyInitialized()||Be(t),n.filter.filtersNodes())}}function km(n,e,t,r,i,s,o,l){const c=e.serverCache;let h;const p=o?n.filter:n.filter.getIndexedFilter();if(Be(t))h=p.updateFullNode(c.getNode(),r,null);else if(p.filtersNodes()&&!c.isFiltered()){const w=c.getNode().updateChild(t,r);h=p.updateFullNode(c.getNode(),w,null)}else{const w=Fe(t);if(!c.isCompleteForPath(t)&&ra(t)>1)return e;const S=yt(t),N=c.getNode().getImmediateChild(w).updateChild(S,r);w===".priority"?h=p.updatePriority(c.getNode(),N):h=p.updateChild(c.getNode(),w,N,S,E9,null)}const m=g9(e,h,c.isFullyInitialized()||Be(t),p.filtersNodes()),_=new HE(i,m,s);return S9(n,m,t,i,_,l)}function p2(n,e,t,r,i,s,o){const l=e.eventCache;let c,h;const p=new HE(i,e,s);if(Be(t))h=n.filter.updateFullNode(e.eventCache.getNode(),r,o),c=ad(e,h,!0,n.filter.filtersNodes());else{const m=Fe(t);if(m===".priority")h=n.filter.updatePriority(e.eventCache.getNode(),r),c=ad(e,h,l.isFullyInitialized(),l.isFiltered());else{const _=yt(t),w=l.getNode().getImmediateChild(m);let S;if(Be(_))S=r;else{const k=p.getCompleteChild(m);k!=null?DE(_)===".priority"&&k.getChild(a9(_)).isEmpty()?S=k:S=k.updateChild(_,r):S=Pe.EMPTY_NODE}if(w.equals(S))c=e;else{const k=n.filter.updateChild(l.getNode(),m,S,_,p,o);c=ad(e,k,l.isFullyInitialized(),n.filter.filtersNodes())}}}return c}function H3(n,e){return n.eventCache.isCompleteForChild(e)}function FU(n,e,t,r,i,s,o){let l=e;return r.foreach((c,h)=>{const p=Mt(t,c);H3(e,Fe(p))&&(l=p2(n,l,p,h,i,s,o))}),r.foreach((c,h)=>{const p=Mt(t,c);H3(e,Fe(p))||(l=p2(n,l,p,h,i,s,o))}),l}function $3(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function g2(n,e,t,r,i,s,o,l){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,h;Be(t)?h=r:h=new St(null).setTree(t,r);const p=e.serverCache.getNode();return h.children.inorderTraversal((m,_)=>{if(p.hasChild(m)){const w=e.serverCache.getNode().getImmediateChild(m),S=$3(n,w,_);c=km(n,c,new ht(m),S,i,s,o,l)}}),h.children.inorderTraversal((m,_)=>{const w=!e.serverCache.isCompleteForChild(m)&&_.value===null;if(!p.hasChild(m)&&!w){const S=e.serverCache.getNode().getImmediateChild(m),k=$3(n,S,_);c=km(n,c,new ht(m),k,i,s,o,l)}}),c}function VU(n,e,t,r,i,s,o){if(Pm(i,t)!=null)return e;const l=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(Be(t)&&c.isFullyInitialized()||c.isCompleteForPath(t))return km(n,e,t,c.getNode().getChild(t),i,s,l,o);if(Be(t)){let h=new St(null);return c.getNode().forEachChild(Vu,(p,m)=>{h=h.set(new ht(p),m)}),g2(n,e,t,h,i,s,l,o)}else return e}else{let h=new St(null);return r.foreach((p,m)=>{const _=Mt(t,p);c.isCompleteForPath(_)&&(h=h.set(p,c.getNode().getChild(_)))}),g2(n,e,t,h,i,s,l,o)}}function UU(n,e,t,r,i){const s=e.serverCache,o=g9(e,s.getNode(),s.isFullyInitialized()||Be(t),s.isFiltered());return S9(n,o,t,r,E9,i)}function BU(n,e,t,r,i,s){let o;if(Pm(r,t)!=null)return e;{const l=new HE(r,e,i),c=e.eventCache.getNode();let h;if(Be(t)||Fe(t)===".priority"){let p;if(e.serverCache.isFullyInitialized())p=Im(r,vl(e));else{const m=e.serverCache.getNode();ae(m instanceof Pe,"serverChildren would be complete if leaf node"),p=GE(r,m)}p=p,h=n.filter.updateFullNode(c,p,s)}else{const p=Fe(t);let m=WE(r,p,e.serverCache);m==null&&e.serverCache.isCompleteForChild(p)&&(m=c.getImmediateChild(p)),m!=null?h=n.filter.updateChild(c,p,m,yt(t),l,s):e.eventCache.getNode().hasChild(p)?h=n.filter.updateChild(c,p,Pe.EMPTY_NODE,yt(t),l,s):h=c,h.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Im(r,vl(e)),o.isLeafNode()&&(h=n.filter.updateFullNode(h,o,s)))}return o=e.serverCache.isFullyInitialized()||Pm(r,ot())!=null,ad(e,h,o,n.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zU{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new FE(r.getIndex()),s=sU(r);this.processor_=DU(s);const o=t.serverCache,l=t.eventCache,c=i.updateFullNode(Pe.EMPTY_NODE,o.getNode(),null),h=s.updateFullNode(Pe.EMPTY_NODE,l.getNode(),null),p=new yl(c,o.isFullyInitialized(),i.filtersNodes()),m=new yl(h,l.isFullyInitialized(),s.filtersNodes());this.viewCache_=A0(m,p),this.eventGenerator_=new dU(this.query_)}get query(){return this.query_}}function jU(n){return n.viewCache_.serverCache.getNode()}function GU(n,e){const t=vl(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!Be(e)&&!t.getImmediateChild(Fe(e)).isEmpty())?t.getChild(e):null}function q3(n){return n.eventRegistrations_.length===0}function WU(n,e){n.eventRegistrations_.push(e)}function K3(n,e,t){const r=[];if(t){ae(e==null,"A cancel should cancel all event registrations.");const i=n.query._path;n.eventRegistrations_.forEach(s=>{const o=s.createCancelEvent(t,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<n.eventRegistrations_.length;++s){const o=n.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(s+1));break}}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function Q3(n,e,t,r){e.type===ki.MERGE&&e.source.queryId!==null&&(ae(vl(n.viewCache_),"We should always have a full cache before handling merges"),ae(c2(n.viewCache_),"Missing event cache, even though we have a server cache"));const i=n.viewCache_,s=OU(n.processor_,i,e,t,r);return MU(n.processor_,s.viewCache),ae(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,C9(n,s.changes,s.viewCache.eventCache.getNode(),null)}function HU(n,e){const t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(Ot,(s,o)=>{r.push(rc(s,o))}),t.isFullyInitialized()&&r.push(p9(t.getNode())),C9(n,r,t.getNode(),e)}function C9(n,e,t,r){const i=r?[r]:n.eventRegistrations_;return fU(n.eventGenerator_,e,t,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rm;class $U{constructor(){this.views=new Map}}function qU(n){ae(!Rm,"__referenceConstructor has already been defined"),Rm=n}function KU(){return ae(Rm,"Reference.ts has not been loaded"),Rm}function QU(n){return n.views.size===0}function $E(n,e,t,r){const i=e.source.queryId;if(i!==null){const s=n.views.get(i);return ae(s!=null,"SyncTree gave us an op for an invalid query."),Q3(s,e,t,r)}else{let s=[];for(const o of n.views.values())s=s.concat(Q3(o,e,t,r));return s}}function YU(n,e,t,r,i){const s=e._queryIdentifier,o=n.views.get(s);if(!o){let l=Im(t,i?r:null),c=!1;l?c=!0:r instanceof Pe?(l=GE(t,r),c=!1):(l=Pe.EMPTY_NODE,c=!1);const h=A0(new yl(l,c,!1),new yl(r,i,!1));return new zU(e,h)}return o}function XU(n,e,t,r,i,s){const o=YU(n,e,r,i,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),WU(o,t),HU(o,t)}function JU(n,e,t,r){const i=e._queryIdentifier,s=[];let o=[];const l=ia(n);if(i==="default")for(const[c,h]of n.views.entries())o=o.concat(K3(h,t,r)),q3(h)&&(n.views.delete(c),h.query._queryParams.loadsAllData()||s.push(h.query));else{const c=n.views.get(i);c&&(o=o.concat(K3(c,t,r)),q3(c)&&(n.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return l&&!ia(n)&&s.push(new(KU())(e._repo,e._path)),{removed:s,events:o}}function T9(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Uu(n,e){let t=null;for(const r of n.views.values())t=t||GU(r,e);return t}function I9(n,e){if(e._queryParams.loadsAllData())return N0(n);{const r=e._queryIdentifier;return n.views.get(r)}}function P9(n,e){return I9(n,e)!=null}function ia(n){return N0(n)!=null}function N0(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xm;function ZU(n){ae(!xm,"__referenceConstructor has already been defined"),xm=n}function eB(){return ae(xm,"Reference.ts has not been loaded"),xm}let tB=1;class Y3{constructor(e){this.listenProvider_=e,this.syncPointTree_=new St(null),this.pendingWriteTree_=xU(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function k9(n,e,t,r,i){return _U(n.pendingWriteTree_,e,t,r,i),i?Tc(n,new _l(UE(),e,t)):[]}function nB(n,e,t,r){yU(n.pendingWriteTree_,e,t,r);const i=St.fromObject(t);return Tc(n,new ic(UE(),e,i))}function Oo(n,e,t=!1){const r=vU(n.pendingWriteTree_,e);if(wU(n.pendingWriteTree_,e)){let s=new St(null);return r.snap!=null?s=s.set(ot(),!0):Rn(r.children,o=>{s=s.set(new ht(o),!0)}),Tc(n,new Tm(r.path,s,t))}else return[]}function b0(n,e,t){return Tc(n,new _l(BE(),e,t))}function rB(n,e,t){const r=St.fromObject(t);return Tc(n,new ic(BE(),e,r))}function iB(n,e){return Tc(n,new Wd(BE(),e))}function sB(n,e,t){const r=KE(n,t);if(r){const i=QE(r),s=i.path,o=i.queryId,l=br(s,e),c=new Wd(zE(o),l);return YE(n,s,c)}else return[]}function m2(n,e,t,r,i=!1){const s=e._path,o=n.syncPointTree_.get(s);let l=[];if(o&&(e._queryIdentifier==="default"||P9(o,e))){const c=JU(o,e,t,r);QU(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));const h=c.removed;if(l=c.events,!i){const p=h.findIndex(_=>_._queryParams.loadsAllData())!==-1,m=n.syncPointTree_.findOnPath(s,(_,w)=>ia(w));if(p&&!m){const _=n.syncPointTree_.subtree(s);if(!_.isEmpty()){const w=lB(_);for(let S=0;S<w.length;++S){const k=w[S],N=k.query,x=A9(n,k);n.listenProvider_.startListening(ud(N),Am(n,N),x.hashFn,x.onComplete)}}}!m&&h.length>0&&!r&&(p?n.listenProvider_.stopListening(ud(e),null):h.forEach(_=>{const w=n.queryToTagMap.get(D0(_));n.listenProvider_.stopListening(ud(_),w)}))}uB(n,h)}return l}function oB(n,e,t,r){const i=KE(n,r);if(i!=null){const s=QE(i),o=s.path,l=s.queryId,c=br(o,e),h=new _l(zE(l),c,t);return YE(n,o,h)}else return[]}function aB(n,e,t,r){const i=KE(n,r);if(i){const s=QE(i),o=s.path,l=s.queryId,c=br(o,e),h=St.fromObject(t),p=new ic(zE(l),c,h);return YE(n,o,p)}else return[]}function X3(n,e,t,r=!1){const i=e._path;let s=null,o=!1;n.syncPointTree_.foreachOnPath(i,(_,w)=>{const S=br(_,i);s=s||Uu(w,S),o=o||ia(w)});let l=n.syncPointTree_.get(i);l?(o=o||ia(l),s=s||Uu(l,ot())):(l=new $U,n.syncPointTree_=n.syncPointTree_.set(i,l));let c;s!=null?c=!0:(c=!1,s=Pe.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((w,S)=>{const k=Uu(S,ot());k&&(s=s.updateImmediateChild(w,k))}));const h=P9(l,e);if(!h&&!e._queryParams.loadsAllData()){const _=D0(e);ae(!n.queryToTagMap.has(_),"View does not exist, but we have a tag");const w=cB();n.queryToTagMap.set(_,w),n.tagToQueryMap.set(w,_)}const p=jE(n.pendingWriteTree_,i);let m=XU(l,e,t,p,s,c);if(!h&&!o&&!r){const _=I9(l,e);m=m.concat(hB(n,e,_))}return m}function qE(n,e,t){const i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,l)=>{const c=br(o,e),h=Uu(l,c);if(h)return h});return y9(i,e,s,t,!0)}function Tc(n,e){return R9(e,n.syncPointTree_,null,jE(n.pendingWriteTree_,ot()))}function R9(n,e,t,r){if(Be(n.path))return x9(n,e,t,r);{const i=e.get(ot());t==null&&i!=null&&(t=Uu(i,ot()));let s=[];const o=Fe(n.path),l=n.operationForChild(o),c=e.children.get(o);if(c&&l){const h=t?t.getImmediateChild(o):null,p=v9(r,o);s=s.concat(R9(l,c,h,p))}return i&&(s=s.concat($E(i,n,r,t))),s}}function x9(n,e,t,r){const i=e.get(ot());t==null&&i!=null&&(t=Uu(i,ot()));let s=[];return e.children.inorderTraversal((o,l)=>{const c=t?t.getImmediateChild(o):null,h=v9(r,o),p=n.operationForChild(o);p&&(s=s.concat(x9(p,l,c,h)))}),i&&(s=s.concat($E(i,n,r,t))),s}function A9(n,e){const t=e.query,r=Am(n,t);return{hashFn:()=>(jU(e)||Pe.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?sB(n,t._path,r):iB(n,t._path);{const s=rV(i,t);return m2(n,t,null,s)}}}}function Am(n,e){const t=D0(e);return n.queryToTagMap.get(t)}function D0(n){return n._path.toString()+"$"+n._queryIdentifier}function KE(n,e){return n.tagToQueryMap.get(e)}function QE(n){const e=n.indexOf("$");return ae(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new ht(n.substr(0,e))}}function YE(n,e,t){const r=n.syncPointTree_.get(e);ae(r,"Missing sync point for query tag that we're tracking");const i=jE(n.pendingWriteTree_,e);return $E(r,t,i,null)}function lB(n){return n.fold((e,t,r)=>{if(t&&ia(t))return[N0(t)];{let i=[];return t&&(i=T9(t)),Rn(r,(s,o)=>{i=i.concat(o)}),i}})}function ud(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(eB())(n._repo,n._path):n}function uB(n,e){for(let t=0;t<e.length;++t){const r=e[t];if(!r._queryParams.loadsAllData()){const i=D0(r),s=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(s)}}}function cB(){return tB++}function hB(n,e,t){const r=e._path,i=Am(n,e),s=A9(n,t),o=n.listenProvider_.startListening(ud(e),i,s.hashFn,s.onComplete),l=n.syncPointTree_.subtree(r);if(i)ae(!ia(l.value),"If we're adding a query, it shouldn't be shadowed");else{const c=l.fold((h,p,m)=>{if(!Be(h)&&p&&ia(p))return[N0(p).query];{let _=[];return p&&(_=_.concat(T9(p).map(w=>w.query))),Rn(m,(w,S)=>{_=_.concat(S)}),_}});for(let h=0;h<c.length;++h){const p=c[h];n.listenProvider_.stopListening(ud(p),Am(n,p))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XE{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new XE(t)}node(){return this.node_}}class JE{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Mt(this.path_,e);return new JE(this.syncTree_,t)}node(){return qE(this.syncTree_,this.path_)}}const dB=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},J3=function(n,e,t){if(!n||typeof n!="object")return n;if(ae(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return fB(n[".sv"],e,t);if(typeof n[".sv"]=="object")return pB(n[".sv"],e);ae(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},fB=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:ae(!1,"Unexpected server value: "+n)}},pB=function(n,e,t){n.hasOwnProperty("increment")||ae(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;typeof r!="number"&&ae(!1,"Unexpected increment value: "+r);const i=e.node();if(ae(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return typeof o!="number"?r:o+r},N9=function(n,e,t,r){return ZE(e,new JE(t,n),r)},b9=function(n,e,t){return ZE(n,new XE(e),t)};function ZE(n,e,t){const r=n.getPriority().val(),i=J3(r,e.getImmediateChild(".priority"),t);let s;if(n.isLeafNode()){const o=n,l=J3(o.getValue(),e,t);return l!==o.getValue()||i!==o.getPriority().val()?new vn(l,$t(i)):n}else{const o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new vn(i))),o.forEachChild(Ot,(l,c)=>{const h=ZE(c,e.getImmediateChild(l),t);h!==c&&(s=s.updateImmediateChild(l,h))}),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eS{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function tS(n,e){let t=e instanceof ht?e:new ht(e),r=n,i=Fe(t);for(;i!==null;){const s=qu(r.node.children,i)||{children:{},childCount:0};r=new eS(i,r,s),t=yt(t),i=Fe(t)}return r}function Ic(n){return n.node.value}function D9(n,e){n.node.value=e,_2(n)}function M9(n){return n.node.childCount>0}function gB(n){return Ic(n)===void 0&&!M9(n)}function M0(n,e){Rn(n.node.children,(t,r)=>{e(new eS(t,n,r))})}function O9(n,e,t,r){t&&e(n),M0(n,i=>{O9(i,e,!0)})}function mB(n,e,t){let r=n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function vf(n){return new ht(n.parent===null?n.name:vf(n.parent)+"/"+n.name)}function _2(n){n.parent!==null&&_B(n.parent,n.name,n)}function _B(n,e,t){const r=gB(t),i=us(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,_2(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,_2(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yB=/[\[\].#$\/\u0000-\u001F\u007F]/,vB=/[\[\].#$\u0000-\u001F\u007F]/,Cv=10*1024*1024,nS=function(n){return typeof n=="string"&&n.length!==0&&!yB.test(n)},L9=function(n){return typeof n=="string"&&n.length!==0&&!vB.test(n)},wB=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),L9(n)},F9=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!R0(n)||n&&typeof n=="object"&&us(n,".sv")},y2=function(n,e,t,r){O0(Ku(n,"value"),e,t)},O0=function(n,e,t){const r=t instanceof ht?new FV(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+qa(r));if(typeof e=="function")throw new Error(n+"contains a function "+qa(r)+" with contents = "+e.toString());if(R0(e))throw new Error(n+"contains "+e.toString()+" "+qa(r));if(typeof e=="string"&&e.length>Cv/3&&i0(e)>Cv)throw new Error(n+"contains a string greater than "+Cv+" utf8 bytes "+qa(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(Rn(e,(o,l)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!nS(o)))throw new Error(n+" contains an invalid key ("+o+") "+qa(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);VV(r,o),O0(n,l,r),UV(r)}),i&&s)throw new Error(n+' contains ".value" child '+qa(r)+" in addition to actual children.")}},EB=function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];const s=Bd(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!nS(s[o]))throw new Error(n+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(LV);let i=null;for(t=0;t<e.length;t++){if(r=e[t],i!==null&&si(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},V9=function(n,e,t,r){const i=Ku(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const s=[];Rn(e,(o,l)=>{const c=new ht(o);if(O0(i,l,Mt(t,c)),DE(c)===".priority"&&!F9(l))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(c)}),EB(i,s)},SB=function(n,e,t){if(R0(e))throw new Error(Ku(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!F9(e))throw new Error(Ku(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},U9=function(n,e,t,r){if(!L9(t))throw new Error(Ku(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},CB=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),U9(n,e,t)},zh=function(n,e){if(Fe(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},TB=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!nS(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!wB(t))throw new Error(Ku(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IB{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function L0(n,e){let t=null;for(let r=0;r<e.length;r++){const i=e[r],s=i.getPath();t!==null&&!ME(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)}function B9(n,e,t){L0(n,t),z9(n,r=>ME(r,e))}function Oi(n,e,t){L0(n,t),z9(n,r=>si(r,e)||si(e,r))}function z9(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const i=n.eventLists_[r];if(i){const s=i.path;e(s)?(PB(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function PB(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const r=t.getEventRunner();sd&&In("event: "+t.toString()),Sc(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kB="repo_interrupt",RB=25;class xB{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new IB,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Cm(),this.transactionQueueTree_=new eS,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function AB(n,e,t){if(n.stats_=NE(n.repoInfo_),n.forceRestClient_||aV())n.server_=new Sm(n.repoInfo_,(r,i,s,o)=>{Z3(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>e5(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Pn(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new Gs(n.repoInfo_,e,(r,i,s,o)=>{Z3(n,r,i,s,o)},r=>{e5(n,r)},r=>{bB(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=dV(n.repoInfo_,()=>new hU(n.stats_,n.server_)),n.infoData_=new oU,n.infoSyncTree_=new Y3({startListening:(r,i,s,o)=>{let l=[];const c=n.infoData_.getNode(r._path);return c.isEmpty()||(l=b0(n.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),l},stopListening:()=>{}}),rS(n,"connected",!1),n.serverSyncTree_=new Y3({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(l,c)=>{const h=o(l,c);Oi(n.eventQueue_,r._path,h)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function NB(n){const t=n.infoData_.getNode(new ht(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function F0(n){return dB({timestamp:NB(n)})}function Z3(n,e,t,r,i){n.dataUpdateCount++;const s=new ht(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){const c=nm(t,h=>$t(h));o=aB(n.serverSyncTree_,s,c,i)}else{const c=$t(t);o=oB(n.serverSyncTree_,s,c,i)}else if(r){const c=nm(t,h=>$t(h));o=rB(n.serverSyncTree_,s,c)}else{const c=$t(t);o=b0(n.serverSyncTree_,s,c)}let l=s;o.length>0&&(l=oc(n,s)),Oi(n.eventQueue_,l,o)}function e5(n,e){rS(n,"connected",e),e===!1&&OB(n)}function bB(n,e){Rn(e,(t,r)=>{rS(n,t,r)})}function rS(n,e,t){const r=new ht("/.info/"+e),i=$t(t);n.infoData_.updateSnapshot(r,i);const s=b0(n.infoSyncTree_,r,i);Oi(n.eventQueue_,r,s)}function iS(n){return n.nextWriteId_++}function DB(n,e,t,r,i){V0(n,"set",{path:e.toString(),value:t,priority:r});const s=F0(n),o=$t(t,r),l=qE(n.serverSyncTree_,e),c=b9(o,l,s),h=iS(n),p=k9(n.serverSyncTree_,e,c,h,!0);L0(n.eventQueue_,p),n.server_.put(e.toString(),o.val(!0),(_,w)=>{const S=_==="ok";S||vr("set at "+e+" failed: "+_);const k=Oo(n.serverSyncTree_,h,!S);Oi(n.eventQueue_,e,k),sa(n,i,_,w)});const m=oS(n,e);oc(n,m),Oi(n.eventQueue_,m,[])}function MB(n,e,t,r){V0(n,"update",{path:e.toString(),value:t});let i=!0;const s=F0(n),o={};if(Rn(t,(l,c)=>{i=!1,o[l]=N9(Mt(e,l),$t(c),n.serverSyncTree_,s)}),i)In("update() called with empty data.  Don't do anything."),sa(n,r,"ok",void 0);else{const l=iS(n),c=nB(n.serverSyncTree_,e,o,l);L0(n.eventQueue_,c),n.server_.merge(e.toString(),t,(h,p)=>{const m=h==="ok";m||vr("update at "+e+" failed: "+h);const _=Oo(n.serverSyncTree_,l,!m),w=_.length>0?oc(n,e):e;Oi(n.eventQueue_,w,_),sa(n,r,h,p)}),Rn(t,h=>{const p=oS(n,Mt(e,h));oc(n,p)}),Oi(n.eventQueue_,e,[])}}function OB(n){V0(n,"onDisconnectEvents");const e=F0(n),t=Cm();u2(n.onDisconnect_,ot(),(i,s)=>{const o=N9(i,s,n.serverSyncTree_,e);Cc(t,i,o)});let r=[];u2(t,ot(),(i,s)=>{r=r.concat(b0(n.serverSyncTree_,i,s));const o=oS(n,i);oc(n,o)}),n.onDisconnect_=Cm(),Oi(n.eventQueue_,ot(),r)}function LB(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&l2(n.onDisconnect_,e),sa(n,t,r,i)})}function t5(n,e,t,r){const i=$t(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&Cc(n.onDisconnect_,e,i),sa(n,r,s,o)})}function FB(n,e,t,r,i){const s=$t(t,r);n.server_.onDisconnectPut(e.toString(),s.val(!0),(o,l)=>{o==="ok"&&Cc(n.onDisconnect_,e,s),sa(n,i,o,l)})}function VB(n,e,t,r){if(tm(t)){In("onDisconnect().update() called with empty data.  Don't do anything."),sa(n,r,"ok",void 0);return}n.server_.onDisconnectMerge(e.toString(),t,(i,s)=>{i==="ok"&&Rn(t,(o,l)=>{const c=$t(l);Cc(n.onDisconnect_,Mt(e,o),c)}),sa(n,r,i,s)})}function UB(n,e,t){let r;Fe(e._path)===".info"?r=X3(n.infoSyncTree_,e,t):r=X3(n.serverSyncTree_,e,t),B9(n.eventQueue_,e._path,r)}function n5(n,e,t){let r;Fe(e._path)===".info"?r=m2(n.infoSyncTree_,e,t):r=m2(n.serverSyncTree_,e,t),B9(n.eventQueue_,e._path,r)}function BB(n){n.persistentConnection_&&n.persistentConnection_.interrupt(kB)}function V0(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),In(t,...e)}function sa(n,e,t,r){e&&Sc(()=>{if(t==="ok")e(null);else{const i=(t||"error").toUpperCase();let s=i;r&&(s+=": "+r);const o=new Error(s);o.code=i,e(o)}})}function j9(n,e,t){return qE(n.serverSyncTree_,e,t)||Pe.EMPTY_NODE}function sS(n,e=n.transactionQueueTree_){if(e||U0(n,e),Ic(e)){const t=W9(n,e);ae(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&zB(n,vf(e),t)}else M9(e)&&M0(e,t=>{sS(n,t)})}function zB(n,e,t){const r=t.map(h=>h.currentWriteId),i=j9(n,e,r);let s=i;const o=i.hash();for(let h=0;h<t.length;h++){const p=t[h];ae(p.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),p.status=1,p.retryCount++;const m=br(e,p.path);s=s.updateChild(m,p.currentOutputSnapshotRaw)}const l=s.val(!0),c=e;n.server_.put(c.toString(),l,h=>{V0(n,"transaction put response",{path:c.toString(),status:h});let p=[];if(h==="ok"){const m=[];for(let _=0;_<t.length;_++)t[_].status=2,p=p.concat(Oo(n.serverSyncTree_,t[_].currentWriteId)),t[_].onComplete&&m.push(()=>t[_].onComplete(null,!0,t[_].currentOutputSnapshotResolved)),t[_].unwatcher();U0(n,tS(n.transactionQueueTree_,e)),sS(n,n.transactionQueueTree_),Oi(n.eventQueue_,e,p);for(let _=0;_<m.length;_++)Sc(m[_])}else{if(h==="datastale")for(let m=0;m<t.length;m++)t[m].status===3?t[m].status=4:t[m].status=0;else{vr("transaction at "+c.toString()+" failed: "+h);for(let m=0;m<t.length;m++)t[m].status=4,t[m].abortReason=h}oc(n,e)}},o)}function oc(n,e){const t=G9(n,e),r=vf(t),i=W9(n,t);return jB(n,i,r),r}function jB(n,e,t){if(e.length===0)return;const r=[];let i=[];const o=e.filter(l=>l.status===0).map(l=>l.currentWriteId);for(let l=0;l<e.length;l++){const c=e[l],h=br(t,c.path);let p=!1,m;if(ae(h!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)p=!0,m=c.abortReason,i=i.concat(Oo(n.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=RB)p=!0,m="maxretry",i=i.concat(Oo(n.serverSyncTree_,c.currentWriteId,!0));else{const _=j9(n,c.path,o);c.currentInputSnapshot=_;const w=e[l].update(_.val());if(w!==void 0){O0("transaction failed: Data returned ",w,c.path);let S=$t(w);typeof w=="object"&&w!=null&&us(w,".priority")||(S=S.updatePriority(_.getPriority()));const N=c.currentWriteId,x=F0(n),R=b9(S,_,x);c.currentOutputSnapshotRaw=S,c.currentOutputSnapshotResolved=R,c.currentWriteId=iS(n),o.splice(o.indexOf(N),1),i=i.concat(k9(n.serverSyncTree_,c.path,R,c.currentWriteId,c.applyLocally)),i=i.concat(Oo(n.serverSyncTree_,N,!0))}else p=!0,m="nodata",i=i.concat(Oo(n.serverSyncTree_,c.currentWriteId,!0))}Oi(n.eventQueue_,t,i),i=[],p&&(e[l].status=2,function(_){setTimeout(_,Math.floor(0))}(e[l].unwatcher),e[l].onComplete&&(m==="nodata"?r.push(()=>e[l].onComplete(null,!1,e[l].currentInputSnapshot)):r.push(()=>e[l].onComplete(new Error(m),!1,null))))}U0(n,n.transactionQueueTree_);for(let l=0;l<r.length;l++)Sc(r[l]);sS(n,n.transactionQueueTree_)}function G9(n,e){let t,r=n.transactionQueueTree_;for(t=Fe(e);t!==null&&Ic(r)===void 0;)r=tS(r,t),e=yt(e),t=Fe(e);return r}function W9(n,e){const t=[];return H9(n,e,t),t.sort((r,i)=>r.order-i.order),t}function H9(n,e,t){const r=Ic(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);M0(e,i=>{H9(n,i,t)})}function U0(n,e){const t=Ic(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,D9(e,t.length>0?t:void 0)}M0(e,r=>{U0(n,r)})}function oS(n,e){const t=vf(G9(n,e)),r=tS(n.transactionQueueTree_,e);return mB(r,i=>{Tv(n,i)}),Tv(n,r),O9(r,i=>{Tv(n,i)}),t}function Tv(n,e){const t=Ic(e);if(t){const r=[];let i=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(ae(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(ae(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(Oo(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?D9(e,void 0):t.length=s+1,Oi(n.eventQueue_,vf(e),i);for(let o=0;o<r.length;o++)Sc(r[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GB(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function WB(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):vr(`Invalid query segment '${t}' in query '${n}'`)}return e}const r5=function(n,e){const t=HB(n),r=t.namespace;t.domain==="firebase.com"&&Zs(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&Zs("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||JF();const i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new JR(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new ht(t.pathString)}},HB=function(n){let e="",t="",r="",i="",s="",o=!0,l="https",c=443;if(typeof n=="string"){let h=n.indexOf("//");h>=0&&(l=n.substring(0,h-1),n=n.substring(h+2));let p=n.indexOf("/");p===-1&&(p=n.length);let m=n.indexOf("?");m===-1&&(m=n.length),e=n.substring(0,Math.min(p,m)),p<m&&(i=GB(n.substring(p,m)));const _=WB(n.substring(Math.min(n.length,m)));h=e.indexOf(":"),h>=0?(o=l==="https"||l==="wss",c=parseInt(e.substring(h+1),10)):h=e.length;const w=e.slice(0,h);if(w.toLowerCase()==="localhost")t="localhost";else if(w.split(".").length<=2)t=w;else{const S=e.indexOf(".");r=e.substring(0,S).toLowerCase(),t=e.substring(S+1),s=r}"ns"in _&&(s=_.ns)}return{host:e,port:c,domain:t,subdomain:r,secure:o,scheme:l,pathString:i,namespace:s}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $B{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Pn(this.snapshot.exportVal())}}class qB{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KB{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return ae(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QB{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new ts;return LB(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){zh("OnDisconnect.remove",this._path);const e=new ts;return t5(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){zh("OnDisconnect.set",this._path),y2("OnDisconnect.set",e,this._path);const t=new ts;return t5(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){zh("OnDisconnect.setWithPriority",this._path),y2("OnDisconnect.setWithPriority",e,this._path),SB("OnDisconnect.setWithPriority",t);const r=new ts;return FB(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){zh("OnDisconnect.update",this._path),V9("OnDisconnect.update",e,this._path);const t=new ts;return VB(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aS{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return Be(this._path)?null:DE(this._path)}get ref(){return new ma(this._repo,this._path)}get _queryIdentifier(){const e=B3(this._queryParams),t=xE(e);return t==="{}"?"default":t}get _queryObject(){return B3(this._queryParams)}isEqual(e){if(e=wt(e),!(e instanceof aS))return!1;const t=this._repo===e._repo,r=ME(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+OV(this._path)}}class ma extends aS{constructor(e,t){super(e,t,new VE,!1)}get parent(){const e=a9(this._path);return e===null?null:new ma(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class Nm{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new ht(e),r=v2(this.ref,e);return new Nm(this._node.getChild(t),r,Ot)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new Nm(i,v2(this.ref,r),Ot)))}hasChild(e){const t=new ht(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function _a(n,e){return n=wt(n),n._checkNotDeleted("ref"),e!==void 0?v2(n._root,e):n._root}function v2(n,e){return n=wt(n),Fe(n._path)===null?CB("child","path",e):U9("child","path",e),new ma(n._repo,Mt(n._path,e))}function YB(n){return n=wt(n),new QB(n._repo,n._path)}function $9(n,e){n=wt(n),zh("set",n._path),y2("set",e,n._path);const t=new ts;return DB(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function q9(n,e){V9("update",e,n._path);const t=new ts;return MB(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}class lS{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const r=t._queryParams.getIndex();return new $B("value",this,new Nm(e.snapshotNode,new ma(t._repo,t._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new qB(this,e,t):null}matches(e){return e instanceof lS?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function XB(n,e,t,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){const c=t,h=(p,m)=>{n5(n._repo,n,l),c(p,m)};h.userCallback=t.userCallback,h.context=t.context,t=h}const o=new KB(t,s||void 0),l=new lS(o);return UB(n._repo,n,l),()=>n5(n._repo,n,l)}function B0(n,e,t,r){return XB(n,"value",e,t,r)}qU(ma);ZU(ma);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JB="FIREBASE_DATABASE_EMULATOR_HOST",w2={};let ZB=!1;function ez(n,e,t,r){n.repoInfo_=new JR(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}function tz(n,e,t,r,i){let s=r||n.options.databaseURL;s===void 0&&(n.options.projectId||Zs("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),In("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=r5(s,i),l=o.repoInfo,c;typeof process<"u"&&S3&&(c=S3[JB]),c?(s=`http://${c}?ns=${l.namespace}`,o=r5(s,i),l=o.repoInfo):o.repoInfo.secure;const h=new uV(n.name,n.options,e);TB("Invalid Firebase Database URL",o),Be(o.path)||Zs("Database URL must point to the root of a Firebase Database (not including a child path).");const p=rz(l,n,h,new lV(n.name,t));return new iz(p,n)}function nz(n,e){const t=w2[e];(!t||t[n.key]!==n)&&Zs(`Database ${e}(${n.repoInfo_}) has already been deleted.`),BB(n),delete t[n.key]}function rz(n,e,t,r){let i=w2[e.name];i||(i={},w2[e.name]=i);let s=i[n.toURLString()];return s&&Zs("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new xB(n,ZB,t,r),i[n.toURLString()]=s,s}class iz{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(AB(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ma(this._repo,ot())),this._rootInternal}_delete(){return this._rootInternal!==null&&(nz(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Zs("Cannot call "+e+" on a deleted database.")}}function K9(n=Dw(),e){const t=o0(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const r=_P("database");r&&Q9(t,...r)}return t}function Q9(n,e,t,r={}){n=wt(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&Zs("Cannot call useEmulator() after instance has already been initialized.");const i=n._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Zs('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Ig(Ig.OWNER);else if(r.mockUserToken){const o=typeof r.mockUserToken=="string"?r.mockUserToken:wP(r.mockUserToken,n.app.options.projectId);s=new Ig(o)}ez(i,e,t,s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sz(n){$F(Sl),ul(new Jo("database",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return tz(r,i,s,t)},"PUBLIC").setMultipleInstances(!0)),ss(C3,T3,n),ss(C3,T3,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oz={".sv":"timestamp"};function bm(){return oz}Gs.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};Gs.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};sz();console.log("🔍 [BUILD DEBUG] Starting Firebase module import...");console.log("🔍 [BUILD DEBUG] Firebase imports completed, reading config...");const Pg={apiKey:"AIzaSyDQZvIf-wol_S9nLsAHlFNfyBSxViW8xWc",authDomain:"collabcanvas-d5bce.firebaseapp.com",projectId:"collabcanvas-d5bce",storageBucket:"collabcanvas-d5bce.firebasestorage.app",messagingSenderId:"484501248859",appId:"1:484501248859:web:026a6bbbaa8652239b587e",databaseURL:"https://collabcanvas-d5bce-default-rtdb.firebaseio.com"};console.log("🔍 [BUILD DEBUG] Firebase config created:",{hasApiKey:!!Pg.apiKey,hasProjectId:!!Pg.projectId,hasDatabaseURL:!!Pg.databaseURL,environment:"production"});console.log("🔍 [BUILD DEBUG] About to initialize Firebase app...");const uS=IP(Pg);console.log("🔍 [BUILD DEBUG] Firebase app initialized successfully");console.log("🔍 [BUILD DEBUG] About to initialize Auth...");const ac=zM(uS);console.log("🔍 [BUILD DEBUG] Auth initialized successfully");console.log("🔍 [BUILD DEBUG] About to initialize Firestore...");const sr=xF(uS);console.log("🔍 [BUILD DEBUG] Firestore initialized successfully");console.log("🔍 [BUILD DEBUG] About to initialize Realtime Database...");const ya=K9(uS);console.log("🔍 [BUILD DEBUG] Realtime Database initialized successfully");console.log("🔍 [BUILD DEBUG] Checking emulator configuration...");const az=!0;console.log("🔍 [BUILD DEBUG] Emulator mode:",az);{console.log("🔥 Using Firebase Emulators (FREE - no quota usage)"),console.log("🔍 [BUILD DEBUG] About to connect to Auth emulator...");try{$P(ac,"http://localhost:9099",{disableWarnings:!0}),console.log("✅ Auth Emulator connected")}catch(n){console.log("Auth emulator already connected",n)}console.log("🔍 [BUILD DEBUG] About to connect to Firestore emulator...");try{wR(sr,"localhost",8080),console.log("✅ Firestore Emulator connected (FREE)")}catch(n){console.log("Firestore emulator already connected",n)}console.log("🔍 [BUILD DEBUG] About to connect to Database emulator...");try{Q9(ya,"localhost",9e3),console.log("✅ Realtime Database Emulator connected (FREE)")}catch(n){console.log("Realtime Database emulator already connected",n)}}console.log("🔍 [BUILD DEBUG] Firebase module initialization complete!");const E2=n=>{const e=(n==null?void 0:n.code)||"unknown",t={"auth/user-not-found":"No account found with this email address. Please check your email or create a new account.","auth/wrong-password":"Incorrect password. Please try again or reset your password.","auth/invalid-email":"Please enter a valid email address.","auth/user-disabled":"This account has been disabled. Please contact support.","auth/too-many-requests":"Too many failed attempts. Please try again later.","auth/invalid-credential":"Invalid email or password. Please check your credentials and try again.","auth/email-already-in-use":"An account with this email already exists. Try logging in instead.","auth/weak-password":"Password should be at least 6 characters long.","auth/operation-not-allowed":"Email/password accounts are not enabled. Please contact support.","auth/popup-closed-by-user":"Sign-in was cancelled. Please try again.","auth/popup-blocked":"Pop-up was blocked by your browser. Please allow pop-ups and try again.","auth/cancelled-popup-request":"Sign-in was cancelled. Please try again.","auth/account-exists-with-different-credential":"An account already exists with this email using a different sign-in method.","auth/network-request-failed":"Network error. Please check your internet connection and try again.","auth/timeout":"Request timed out. Please check your connection and try again.","auth/internal-error":"Something went wrong. Please try again.",unknown:"An unexpected error occurred. Please try again."};return t[e]||t.unknown},S2=n=>["auth/network-request-failed","auth/timeout","auth/too-many-requests","auth/internal-error","auth/popup-blocked"].includes(n==null?void 0:n.code),C2=n=>{const e=n==null?void 0:n.code;return{"auth/user-not-found":"Create Account","auth/email-already-in-use":"Sign In Instead","auth/popup-blocked":"Enable Pop-ups","auth/weak-password":"Use Stronger Password"}[e]||void 0},lz=({onSuccess:n,onSwitchToRegister:e})=>{const[t,r]=ue.useState(""),[i,s]=ue.useState(""),[o,l]=ue.useState(!1),[c,h]=ue.useState(null),p=async _=>{_.preventDefault(),l(!0),h(null);try{await PD(ac,t,i),n==null||n()}catch(w){h({message:E2(w),action:C2(w),retryable:S2(w)})}finally{l(!1)}},m=async()=>{l(!0),h(null);try{const _=new Ds;await YD(ac,_),n==null||n()}catch(_){h({message:E2(_),action:C2(_),retryable:S2(_)})}finally{l(!1)}};return z.jsxs("div",{className:"max-w-md mx-auto bg-white rounded-lg shadow-md p-6",children:[z.jsx("h2",{className:"text-2xl font-bold mb-6 text-center text-gray-800",children:"Sign In"}),c&&z.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:z.jsxs("div",{className:"flex items-start gap-3",children:[z.jsx("div",{className:"text-red-500 text-lg",children:"⚠️"}),z.jsxs("div",{className:"flex-1",children:[z.jsx("div",{className:"text-red-800 font-medium text-sm mb-1",children:"Sign In Error"}),z.jsx("div",{className:"text-red-700 text-sm",children:c.message}),c.action&&z.jsx("button",{onClick:()=>{c.action==="Create Account"&&(e==null||e()),h(null)},className:"mt-2 text-sm text-red-600 hover:text-red-800 underline",children:c.action}),c.retryable&&z.jsx("button",{onClick:()=>h(null),className:"mt-2 ml-2 text-sm text-red-600 hover:text-red-800 underline",children:"Try Again"})]})]})}),z.jsxs("form",{onSubmit:p,className:"space-y-4",children:[z.jsxs("div",{children:[z.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),z.jsx("input",{id:"email",type:"email",value:t,onChange:_=>r(_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:o})]}),z.jsxs("div",{children:[z.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),z.jsx("input",{id:"password",type:"password",value:i,onChange:_=>s(_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:o})]}),z.jsx("button",{type:"submit",disabled:o,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 disabled:opacity-50",children:o?"Signing In...":"Sign In"})]}),z.jsx("div",{className:"my-4 text-center text-gray-500",children:"or"}),z.jsx("button",{onClick:m,disabled:o,className:"w-full bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700 disabled:opacity-50",children:"Sign in with Google"}),z.jsx("div",{className:"mt-4 text-center",children:z.jsx("button",{onClick:e,className:"text-blue-600 hover:underline text-sm",children:"Need an account? Sign up"})})]})},uz=({onSuccess:n,onSwitchToLogin:e})=>{const[t,r]=ue.useState(""),[i,s]=ue.useState(""),[o,l]=ue.useState(""),[c,h]=ue.useState(!1),[p,m]=ue.useState(null),_=async w=>{if(w.preventDefault(),h(!0),m(null),i!==o){m({message:"Passwords do not match"}),h(!1);return}if(i.length<6){m({message:"Password must be at least 6 characters"}),h(!1);return}try{await ID(ac,t,i),n==null||n()}catch(S){m({message:E2(S),action:C2(S),retryable:S2(S)})}finally{h(!1)}};return z.jsxs("div",{className:"max-w-md mx-auto bg-white rounded-lg shadow-md p-6",children:[z.jsx("h2",{className:"text-2xl font-bold mb-6 text-center text-gray-800",children:"Create Account"}),p&&z.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:z.jsxs("div",{className:"flex items-start gap-3",children:[z.jsx("div",{className:"text-red-500 text-lg",children:"⚠️"}),z.jsxs("div",{className:"flex-1",children:[z.jsx("div",{className:"text-red-800 font-medium text-sm mb-1",children:"Registration Error"}),z.jsx("div",{className:"text-red-700 text-sm",children:p.message}),p.action&&z.jsx("button",{onClick:()=>{p.action==="Sign In Instead"&&(e==null||e()),m(null)},className:"mt-2 text-sm text-red-600 hover:text-red-800 underline",children:p.action}),p.retryable&&z.jsx("button",{onClick:()=>m(null),className:"mt-2 ml-2 text-sm text-red-600 hover:text-red-800 underline",children:"Try Again"})]})]})}),z.jsxs("form",{onSubmit:_,className:"space-y-4",children:[z.jsxs("div",{children:[z.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),z.jsx("input",{id:"email",type:"email",value:t,onChange:w=>r(w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:c})]}),z.jsxs("div",{children:[z.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),z.jsx("input",{id:"password",type:"password",value:i,onChange:w=>s(w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:c,minLength:6})]}),z.jsxs("div",{children:[z.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password"}),z.jsx("input",{id:"confirmPassword",type:"password",value:o,onChange:w=>l(w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:c})]}),z.jsx("button",{type:"submit",disabled:c,className:"w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 disabled:opacity-50",children:c?"Creating Account...":"Create Account"})]}),z.jsx("div",{className:"mt-4 text-center",children:z.jsx("button",{onClick:e,className:"text-blue-600 hover:underline text-sm",children:"Already have an account? Sign in"})})]})},cz=({onAuthSuccess:n})=>{const[e,t]=ue.useState(!0),r=()=>{n==null||n()},i=()=>t(!0),s=()=>t(!1);return z.jsx("div",{className:"w-full max-w-md mx-auto",children:e?z.jsx(lz,{onSuccess:r,onSwitchToRegister:s}):z.jsx(uz,{onSuccess:r,onSwitchToLogin:i})})};var Y9={exports:{}},z0={},Dm={},Le={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n._registerNode=n.Konva=n.glob=void 0;const e=Math.PI/180;function t(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}n.glob=typeof Y4<"u"?Y4:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},n.Konva={_global:n.glob,version:"9.3.22",isBrowser:t(),isUnminified:/param/.test((function(i){}).toString()),dblClickWindow:400,getAngle(i){return n.Konva.angleDeg?i*e:i},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return n.Konva.DD.isDragging},isTransforming(){var i;return(i=n.Konva.Transformer)===null||i===void 0?void 0:i.isTransforming()},isDragReady(){return!!n.Konva.DD.node},releaseCanvasOnDestroy:!0,document:n.glob.document,_injectGlobal(i){n.glob.Konva=i}};const r=i=>{n.Konva[i.prototype.getClassName()]=i};n._registerNode=r,n.Konva._injectGlobal(n.Konva)})(Le);var Vt={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Util=n.Transform=void 0;const e=Le;class t{constructor(P=[1,0,0,1,0,0]){this.dirty=!1,this.m=P&&P.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new t(this.m)}copyInto(P){P.m[0]=this.m[0],P.m[1]=this.m[1],P.m[2]=this.m[2],P.m[3]=this.m[3],P.m[4]=this.m[4],P.m[5]=this.m[5]}point(P){const V=this.m;return{x:V[0]*P.x+V[2]*P.y+V[4],y:V[1]*P.x+V[3]*P.y+V[5]}}translate(P,V){return this.m[4]+=this.m[0]*P+this.m[2]*V,this.m[5]+=this.m[1]*P+this.m[3]*V,this}scale(P,V){return this.m[0]*=P,this.m[1]*=P,this.m[2]*=V,this.m[3]*=V,this}rotate(P){const V=Math.cos(P),B=Math.sin(P),D=this.m[0]*V+this.m[2]*B,T=this.m[1]*V+this.m[3]*B,b=this.m[0]*-B+this.m[2]*V,A=this.m[1]*-B+this.m[3]*V;return this.m[0]=D,this.m[1]=T,this.m[2]=b,this.m[3]=A,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(P,V){const B=this.m[0]+this.m[2]*V,D=this.m[1]+this.m[3]*V,T=this.m[2]+this.m[0]*P,b=this.m[3]+this.m[1]*P;return this.m[0]=B,this.m[1]=D,this.m[2]=T,this.m[3]=b,this}multiply(P){const V=this.m[0]*P.m[0]+this.m[2]*P.m[1],B=this.m[1]*P.m[0]+this.m[3]*P.m[1],D=this.m[0]*P.m[2]+this.m[2]*P.m[3],T=this.m[1]*P.m[2]+this.m[3]*P.m[3],b=this.m[0]*P.m[4]+this.m[2]*P.m[5]+this.m[4],A=this.m[1]*P.m[4]+this.m[3]*P.m[5]+this.m[5];return this.m[0]=V,this.m[1]=B,this.m[2]=D,this.m[3]=T,this.m[4]=b,this.m[5]=A,this}invert(){const P=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),V=this.m[3]*P,B=-this.m[1]*P,D=-this.m[2]*P,T=this.m[0]*P,b=P*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),A=P*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=V,this.m[1]=B,this.m[2]=D,this.m[3]=T,this.m[4]=b,this.m[5]=A,this}getMatrix(){return this.m}decompose(){const P=this.m[0],V=this.m[1],B=this.m[2],D=this.m[3],T=this.m[4],b=this.m[5],A=P*D-V*B,O={x:T,y:b,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(P!=0||V!=0){const U=Math.sqrt(P*P+V*V);O.rotation=V>0?Math.acos(P/U):-Math.acos(P/U),O.scaleX=U,O.scaleY=A/U,O.skewX=(P*B+V*D)/A,O.skewY=0}else if(B!=0||D!=0){const U=Math.sqrt(B*B+D*D);O.rotation=Math.PI/2-(D>0?Math.acos(-B/U):-Math.acos(B/U)),O.scaleX=A/U,O.scaleY=U,O.skewX=0,O.skewY=(P*B+V*D)/A}return O.rotation=n.Util._getRotation(O.rotation),O}}n.Transform=t;const r="[object Array]",i="[object Number]",s="[object String]",o="[object Boolean]",l=Math.PI/180,c=180/Math.PI,h="#",p="",m="0",_="Konva warning: ",w="Konva error: ",S="rgb(",k={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},N=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let x=[];const R=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(E){setTimeout(E,60)};n.Util={_isElement(E){return!!(E&&E.nodeType==1)},_isFunction(E){return!!(E&&E.constructor&&E.call&&E.apply)},_isPlainObject(E){return!!E&&E.constructor===Object},_isArray(E){return Object.prototype.toString.call(E)===r},_isNumber(E){return Object.prototype.toString.call(E)===i&&!isNaN(E)&&isFinite(E)},_isString(E){return Object.prototype.toString.call(E)===s},_isBoolean(E){return Object.prototype.toString.call(E)===o},isObject(E){return E instanceof Object},isValidSelector(E){if(typeof E!="string")return!1;const P=E[0];return P==="#"||P==="."||P===P.toUpperCase()},_sign(E){return E===0||E>0?1:-1},requestAnimFrame(E){x.push(E),x.length===1&&R(function(){const P=x;x=[],P.forEach(function(V){V()})})},createCanvasElement(){const E=document.createElement("canvas");try{E.style=E.style||{}}catch{}return E},createImageElement(){return document.createElement("img")},_isInDocument(E){for(;E=E.parentNode;)if(E==document)return!0;return!1},_urlToImage(E,P){const V=n.Util.createImageElement();V.onload=function(){P(V)},V.src=E},_rgbToHex(E,P,V){return((1<<24)+(E<<16)+(P<<8)+V).toString(16).slice(1)},_hexToRgb(E){E=E.replace(h,p);const P=parseInt(E,16);return{r:P>>16&255,g:P>>8&255,b:P&255}},getRandomColor(){let E=(Math.random()*16777215<<0).toString(16);for(;E.length<6;)E=m+E;return h+E},getRGB(E){let P;return E in k?(P=k[E],{r:P[0],g:P[1],b:P[2]}):E[0]===h?this._hexToRgb(E.substring(1)):E.substr(0,4)===S?(P=N.exec(E.replace(/ /g,"")),{r:parseInt(P[1],10),g:parseInt(P[2],10),b:parseInt(P[3],10)}):{r:0,g:0,b:0}},colorToRGBA(E){return E=E||"black",n.Util._namedColorToRBA(E)||n.Util._hex3ColorToRGBA(E)||n.Util._hex4ColorToRGBA(E)||n.Util._hex6ColorToRGBA(E)||n.Util._hex8ColorToRGBA(E)||n.Util._rgbColorToRGBA(E)||n.Util._rgbaColorToRGBA(E)||n.Util._hslColorToRGBA(E)},_namedColorToRBA(E){const P=k[E.toLowerCase()];return P?{r:P[0],g:P[1],b:P[2],a:1}:null},_rgbColorToRGBA(E){if(E.indexOf("rgb(")===0){E=E.match(/rgb\(([^)]+)\)/)[1];const P=E.split(/ *, */).map(Number);return{r:P[0],g:P[1],b:P[2],a:1}}},_rgbaColorToRGBA(E){if(E.indexOf("rgba(")===0){E=E.match(/rgba\(([^)]+)\)/)[1];const P=E.split(/ *, */).map((V,B)=>V.slice(-1)==="%"?B===3?parseInt(V)/100:parseInt(V)/100*255:Number(V));return{r:P[0],g:P[1],b:P[2],a:P[3]}}},_hex8ColorToRGBA(E){if(E[0]==="#"&&E.length===9)return{r:parseInt(E.slice(1,3),16),g:parseInt(E.slice(3,5),16),b:parseInt(E.slice(5,7),16),a:parseInt(E.slice(7,9),16)/255}},_hex6ColorToRGBA(E){if(E[0]==="#"&&E.length===7)return{r:parseInt(E.slice(1,3),16),g:parseInt(E.slice(3,5),16),b:parseInt(E.slice(5,7),16),a:1}},_hex4ColorToRGBA(E){if(E[0]==="#"&&E.length===5)return{r:parseInt(E[1]+E[1],16),g:parseInt(E[2]+E[2],16),b:parseInt(E[3]+E[3],16),a:parseInt(E[4]+E[4],16)/255}},_hex3ColorToRGBA(E){if(E[0]==="#"&&E.length===4)return{r:parseInt(E[1]+E[1],16),g:parseInt(E[2]+E[2],16),b:parseInt(E[3]+E[3],16),a:1}},_hslColorToRGBA(E){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(E)){const[P,...V]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(E),B=Number(V[0])/360,D=Number(V[1])/100,T=Number(V[2])/100;let b,A,O;if(D===0)return O=T*255,{r:Math.round(O),g:Math.round(O),b:Math.round(O),a:1};T<.5?b=T*(1+D):b=T+D-T*D;const U=2*T-b,F=[0,0,0];for(let ce=0;ce<3;ce++)A=B+1/3*-(ce-1),A<0&&A++,A>1&&A--,6*A<1?O=U+(b-U)*6*A:2*A<1?O=b:3*A<2?O=U+(b-U)*(2/3-A)*6:O=U,F[ce]=O*255;return{r:Math.round(F[0]),g:Math.round(F[1]),b:Math.round(F[2]),a:1}}},haveIntersection(E,P){return!(P.x>E.x+E.width||P.x+P.width<E.x||P.y>E.y+E.height||P.y+P.height<E.y)},cloneObject(E){const P={};for(const V in E)this._isPlainObject(E[V])?P[V]=this.cloneObject(E[V]):this._isArray(E[V])?P[V]=this.cloneArray(E[V]):P[V]=E[V];return P},cloneArray(E){return E.slice(0)},degToRad(E){return E*l},radToDeg(E){return E*c},_degToRad(E){return n.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),n.Util.degToRad(E)},_radToDeg(E){return n.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),n.Util.radToDeg(E)},_getRotation(E){return e.Konva.angleDeg?n.Util.radToDeg(E):E},_capitalize(E){return E.charAt(0).toUpperCase()+E.slice(1)},throw(E){throw new Error(w+E)},error(E){console.error(w+E)},warn(E){e.Konva.showWarnings&&console.warn(_+E)},each(E,P){for(const V in E)P(V,E[V])},_inRange(E,P,V){return P<=E&&E<V},_getProjectionToSegment(E,P,V,B,D,T){let b,A,O;const U=(E-V)*(E-V)+(P-B)*(P-B);if(U==0)b=E,A=P,O=(D-V)*(D-V)+(T-B)*(T-B);else{const F=((D-E)*(V-E)+(T-P)*(B-P))/U;F<0?(b=E,A=P,O=(E-D)*(E-D)+(P-T)*(P-T)):F>1?(b=V,A=B,O=(V-D)*(V-D)+(B-T)*(B-T)):(b=E+F*(V-E),A=P+F*(B-P),O=(b-D)*(b-D)+(A-T)*(A-T))}return[b,A,O]},_getProjectionToLine(E,P,V){const B=n.Util.cloneObject(E);let D=Number.MAX_VALUE;return P.forEach(function(T,b){if(!V&&b===P.length-1)return;const A=P[(b+1)%P.length],O=n.Util._getProjectionToSegment(T.x,T.y,A.x,A.y,E.x,E.y),U=O[0],F=O[1],ce=O[2];ce<D&&(B.x=U,B.y=F,D=ce)}),B},_prepareArrayForTween(E,P,V){const B=[],D=[];if(E.length>P.length){const b=P;P=E,E=b}for(let b=0;b<E.length;b+=2)B.push({x:E[b],y:E[b+1]});for(let b=0;b<P.length;b+=2)D.push({x:P[b],y:P[b+1]});const T=[];return D.forEach(function(b){const A=n.Util._getProjectionToLine(b,B,V);T.push(A.x),T.push(A.y)}),T},_prepareToStringify(E){let P;E.visitedByCircularReferenceRemoval=!0;for(const V in E)if(E.hasOwnProperty(V)&&E[V]&&typeof E[V]=="object"){if(P=Object.getOwnPropertyDescriptor(E,V),E[V].visitedByCircularReferenceRemoval||n.Util._isElement(E[V]))if(P.configurable)delete E[V];else return null;else if(n.Util._prepareToStringify(E[V])===null)if(P.configurable)delete E[V];else return null}return delete E.visitedByCircularReferenceRemoval,E},_assign(E,P){for(const V in P)E[V]=P[V];return E},_getFirstPointerId(E){return E.touches?E.changedTouches[0].identifier:E.pointerId||999},releaseCanvas(...E){e.Konva.releaseCanvasOnDestroy&&E.forEach(P=>{P.width=0,P.height=0})},drawRoundedRectPath(E,P,V,B){let D=0,T=0,b=0,A=0;typeof B=="number"?D=T=b=A=Math.min(B,P/2,V/2):(D=Math.min(B[0]||0,P/2,V/2),T=Math.min(B[1]||0,P/2,V/2),A=Math.min(B[2]||0,P/2,V/2),b=Math.min(B[3]||0,P/2,V/2)),E.moveTo(D,0),E.lineTo(P-T,0),E.arc(P-T,T,T,Math.PI*3/2,0,!1),E.lineTo(P,V-A),E.arc(P-A,V-A,A,0,Math.PI/2,!1),E.lineTo(b,V),E.arc(b,V-b,b,Math.PI/2,Math.PI,!1),E.lineTo(0,D),E.arc(D,D,D,Math.PI,Math.PI*3/2,!1)}}})(Vt);var At={},bi={},Ws={};Object.defineProperty(Ws,"__esModule",{value:!0});Ws.HitContext=Ws.SceneContext=Ws.Context=void 0;const X9=Vt,hz=Le;function dz(n){const e=[],t=n.length,r=X9.Util;for(let i=0;i<t;i++){let s=n[i];r._isNumber(s)?s=Math.round(s*1e3)/1e3:r._isString(s)||(s=s+""),e.push(s)}return e}const i5=",",fz="(",pz=")",gz="([",mz="])",_z=";",yz="()",vz="=",s5=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],wz=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],Ez=100;class j0{constructor(e){this.canvas=e,hz.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(e){e.fillEnabled()&&this._fill(e)}_fill(e){}strokeShape(e){e.hasStroke()&&this._stroke(e)}_stroke(e){}fillStrokeShape(e){e.attrs.fillAfterStrokeEnabled?(this.strokeShape(e),this.fillShape(e)):(this.fillShape(e),this.strokeShape(e))}getTrace(e,t){let r=this.traceArr,i=r.length,s="",o,l,c,h;for(o=0;o<i;o++)l=r[o],c=l.method,c?(h=l.args,s+=c,e?s+=yz:X9.Util._isArray(h[0])?s+=gz+h.join(i5)+mz:(t&&(h=h.map(p=>typeof p=="number"?Math.floor(p):p)),s+=fz+h.join(i5)+pz)):(s+=l.property,e||(s+=vz+l.val)),s+=_z;return s}clearTrace(){this.traceArr=[]}_trace(e){let t=this.traceArr,r;t.push(e),r=t.length,r>=Ez&&t.shift()}reset(){const e=this.getCanvas().getPixelRatio();this.setTransform(1*e,0,0,1*e,0,0)}getCanvas(){return this.canvas}clear(e){const t=this.getCanvas();e?this.clearRect(e.x||0,e.y||0,e.width||0,e.height||0):this.clearRect(0,0,t.getWidth()/t.pixelRatio,t.getHeight()/t.pixelRatio)}_applyLineCap(e){const t=e.attrs.lineCap;t&&this.setAttr("lineCap",t)}_applyOpacity(e){const t=e.getAbsoluteOpacity();t!==1&&this.setAttr("globalAlpha",t)}_applyLineJoin(e){const t=e.attrs.lineJoin;t&&this.setAttr("lineJoin",t)}setAttr(e,t){this._context[e]=t}arc(e,t,r,i,s,o){this._context.arc(e,t,r,i,s,o)}arcTo(e,t,r,i,s){this._context.arcTo(e,t,r,i,s)}beginPath(){this._context.beginPath()}bezierCurveTo(e,t,r,i,s,o){this._context.bezierCurveTo(e,t,r,i,s,o)}clearRect(e,t,r,i){this._context.clearRect(e,t,r,i)}clip(...e){this._context.clip.apply(this._context,e)}closePath(){this._context.closePath()}createImageData(e,t){const r=arguments;if(r.length===2)return this._context.createImageData(e,t);if(r.length===1)return this._context.createImageData(e)}createLinearGradient(e,t,r,i){return this._context.createLinearGradient(e,t,r,i)}createPattern(e,t){return this._context.createPattern(e,t)}createRadialGradient(e,t,r,i,s,o){return this._context.createRadialGradient(e,t,r,i,s,o)}drawImage(e,t,r,i,s,o,l,c,h){const p=arguments,m=this._context;p.length===3?m.drawImage(e,t,r):p.length===5?m.drawImage(e,t,r,i,s):p.length===9&&m.drawImage(e,t,r,i,s,o,l,c,h)}ellipse(e,t,r,i,s,o,l,c){this._context.ellipse(e,t,r,i,s,o,l,c)}isPointInPath(e,t,r,i){return r?this._context.isPointInPath(r,e,t,i):this._context.isPointInPath(e,t,i)}fill(...e){this._context.fill.apply(this._context,e)}fillRect(e,t,r,i){this._context.fillRect(e,t,r,i)}strokeRect(e,t,r,i){this._context.strokeRect(e,t,r,i)}fillText(e,t,r,i){i?this._context.fillText(e,t,r,i):this._context.fillText(e,t,r)}measureText(e){return this._context.measureText(e)}getImageData(e,t,r,i){return this._context.getImageData(e,t,r,i)}lineTo(e,t){this._context.lineTo(e,t)}moveTo(e,t){this._context.moveTo(e,t)}rect(e,t,r,i){this._context.rect(e,t,r,i)}roundRect(e,t,r,i,s){this._context.roundRect(e,t,r,i,s)}putImageData(e,t,r){this._context.putImageData(e,t,r)}quadraticCurveTo(e,t,r,i){this._context.quadraticCurveTo(e,t,r,i)}restore(){this._context.restore()}rotate(e){this._context.rotate(e)}save(){this._context.save()}scale(e,t){this._context.scale(e,t)}setLineDash(e){this._context.setLineDash?this._context.setLineDash(e):"mozDash"in this._context?this._context.mozDash=e:"webkitLineDash"in this._context&&(this._context.webkitLineDash=e)}getLineDash(){return this._context.getLineDash()}setTransform(e,t,r,i,s,o){this._context.setTransform(e,t,r,i,s,o)}stroke(e){e?this._context.stroke(e):this._context.stroke()}strokeText(e,t,r,i){this._context.strokeText(e,t,r,i)}transform(e,t,r,i,s,o){this._context.transform(e,t,r,i,s,o)}translate(e,t){this._context.translate(e,t)}_enableTrace(){let e=this,t=s5.length,r=this.setAttr,i,s;const o=function(l){let c=e[l],h;e[l]=function(){return s=dz(Array.prototype.slice.call(arguments,0)),h=c.apply(e,arguments),e._trace({method:l,args:s}),h}};for(i=0;i<t;i++)o(s5[i]);e.setAttr=function(){r.apply(e,arguments);const l=arguments[0];let c=arguments[1];(l==="shadowOffsetX"||l==="shadowOffsetY"||l==="shadowBlur")&&(c=c/this.canvas.getPixelRatio()),e._trace({property:l,val:c})}}_applyGlobalCompositeOperation(e){const t=e.attrs.globalCompositeOperation;!t||t==="source-over"||this.setAttr("globalCompositeOperation",t)}}Ws.Context=j0;wz.forEach(function(n){Object.defineProperty(j0.prototype,n,{get(){return this._context[n]},set(e){this._context[n]=e}})});class Sz extends j0{constructor(e,{willReadFrequently:t=!1}={}){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:t})}_fillColor(e){const t=e.fill();this.setAttr("fillStyle",t),e._fillFunc(this)}_fillPattern(e){this.setAttr("fillStyle",e._getFillPattern()),e._fillFunc(this)}_fillLinearGradient(e){const t=e._getLinearGradient();t&&(this.setAttr("fillStyle",t),e._fillFunc(this))}_fillRadialGradient(e){const t=e._getRadialGradient();t&&(this.setAttr("fillStyle",t),e._fillFunc(this))}_fill(e){const t=e.fill(),r=e.getFillPriority();if(t&&r==="color"){this._fillColor(e);return}const i=e.getFillPatternImage();if(i&&r==="pattern"){this._fillPattern(e);return}const s=e.getFillLinearGradientColorStops();if(s&&r==="linear-gradient"){this._fillLinearGradient(e);return}const o=e.getFillRadialGradientColorStops();if(o&&r==="radial-gradient"){this._fillRadialGradient(e);return}t?this._fillColor(e):i?this._fillPattern(e):s?this._fillLinearGradient(e):o&&this._fillRadialGradient(e)}_strokeLinearGradient(e){const t=e.getStrokeLinearGradientStartPoint(),r=e.getStrokeLinearGradientEndPoint(),i=e.getStrokeLinearGradientColorStops(),s=this.createLinearGradient(t.x,t.y,r.x,r.y);if(i){for(let o=0;o<i.length;o+=2)s.addColorStop(i[o],i[o+1]);this.setAttr("strokeStyle",s)}}_stroke(e){const t=e.dash(),r=e.getStrokeScaleEnabled();if(e.hasStroke()){if(!r){this.save();const s=this.getCanvas().getPixelRatio();this.setTransform(s,0,0,s,0,0)}this._applyLineCap(e),t&&e.dashEnabled()&&(this.setLineDash(t),this.setAttr("lineDashOffset",e.dashOffset())),this.setAttr("lineWidth",e.strokeWidth()),e.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),e.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(e):this.setAttr("strokeStyle",e.stroke()),e._strokeFunc(this),r||this.restore()}}_applyShadow(e){var t,r,i;const s=(t=e.getShadowRGBA())!==null&&t!==void 0?t:"black",o=(r=e.getShadowBlur())!==null&&r!==void 0?r:5,l=(i=e.getShadowOffset())!==null&&i!==void 0?i:{x:0,y:0},c=e.getAbsoluteScale(),h=this.canvas.getPixelRatio(),p=c.x*h,m=c.y*h;this.setAttr("shadowColor",s),this.setAttr("shadowBlur",o*Math.min(Math.abs(p),Math.abs(m))),this.setAttr("shadowOffsetX",l.x*p),this.setAttr("shadowOffsetY",l.y*m)}}Ws.SceneContext=Sz;class Cz extends j0{constructor(e){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:!0})}_fill(e){this.save(),this.setAttr("fillStyle",e.colorKey),e._fillFuncHit(this),this.restore()}strokeShape(e){e.hasHitStroke()&&this._stroke(e)}_stroke(e){if(e.hasHitStroke()){const t=e.getStrokeScaleEnabled();if(!t){this.save();const s=this.getCanvas().getPixelRatio();this.setTransform(s,0,0,s,0,0)}this._applyLineCap(e);const r=e.hitStrokeWidth(),i=r==="auto"?e.strokeWidth():r;this.setAttr("lineWidth",i),this.setAttr("strokeStyle",e.colorKey),e._strokeFuncHit(this),t||this.restore()}}}Ws.HitContext=Cz;Object.defineProperty(bi,"__esModule",{value:!0});bi.HitCanvas=bi.SceneCanvas=bi.Canvas=void 0;const Mm=Vt,J9=Ws,Z9=Le;let Jp;function Tz(){if(Jp)return Jp;const n=Mm.Util.createCanvasElement(),e=n.getContext("2d");return Jp=function(){const t=Z9.Konva._global.devicePixelRatio||1,r=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return t/r}(),Mm.Util.releaseCanvas(n),Jp}let cS=class{constructor(e){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const r=(e||{}).pixelRatio||Z9.Konva.pixelRatio||Tz();this.pixelRatio=r,this._canvas=Mm.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(e){const t=this.pixelRatio;this.pixelRatio=e,this.setSize(this.getWidth()/t,this.getHeight()/t)}setWidth(e){this.width=this._canvas.width=e*this.pixelRatio,this._canvas.style.width=e+"px";const t=this.pixelRatio;this.getContext()._context.scale(t,t)}setHeight(e){this.height=this._canvas.height=e*this.pixelRatio,this._canvas.style.height=e+"px";const t=this.pixelRatio;this.getContext()._context.scale(t,t)}getWidth(){return this.width}getHeight(){return this.height}setSize(e,t){this.setWidth(e||0),this.setHeight(t||0)}toDataURL(e,t){try{return this._canvas.toDataURL(e,t)}catch{try{return this._canvas.toDataURL()}catch(i){return Mm.Util.error("Unable to get data URL. "+i.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};bi.Canvas=cS;class Iz extends cS{constructor(e={width:0,height:0,willReadFrequently:!1}){super(e),this.context=new J9.SceneContext(this,{willReadFrequently:e.willReadFrequently}),this.setSize(e.width,e.height)}}bi.SceneCanvas=Iz;class Pz extends cS{constructor(e={width:0,height:0}){super(e),this.hitCanvas=!0,this.context=new J9.HitContext(this),this.setSize(e.width,e.height)}}bi.HitCanvas=Pz;var G0={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.DD=void 0;const e=Le,t=Vt;n.DD={get isDragging(){let r=!1;return n.DD._dragElements.forEach(i=>{i.dragStatus==="dragging"&&(r=!0)}),r},justDragged:!1,get node(){let r;return n.DD._dragElements.forEach(i=>{r=i.node}),r},_dragElements:new Map,_drag(r){const i=[];n.DD._dragElements.forEach((s,o)=>{const{node:l}=s,c=l.getStage();c.setPointersPositions(r),s.pointerId===void 0&&(s.pointerId=t.Util._getFirstPointerId(r));const h=c._changedPointerPositions.find(p=>p.id===s.pointerId);if(h){if(s.dragStatus!=="dragging"){const p=l.dragDistance();if(Math.max(Math.abs(h.x-s.startPointerPos.x),Math.abs(h.y-s.startPointerPos.y))<p||(l.startDrag({evt:r}),!l.isDragging()))return}l._setDragPosition(r,s),i.push(l)}}),i.forEach(s=>{s.fire("dragmove",{type:"dragmove",target:s,evt:r},!0)})},_endDragBefore(r){const i=[];n.DD._dragElements.forEach(s=>{const{node:o}=s,l=o.getStage();if(r&&l.setPointersPositions(r),!l._changedPointerPositions.find(p=>p.id===s.pointerId))return;(s.dragStatus==="dragging"||s.dragStatus==="stopped")&&(n.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,s.dragStatus="stopped");const h=s.node.getLayer()||s.node instanceof e.Konva.Stage&&s.node;h&&i.indexOf(h)===-1&&i.push(h)}),i.forEach(s=>{s.draw()})},_endDragAfter(r){n.DD._dragElements.forEach((i,s)=>{i.dragStatus==="stopped"&&i.node.fire("dragend",{type:"dragend",target:i.node,evt:r},!0),i.dragStatus!=="dragging"&&n.DD._dragElements.delete(s)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",n.DD._endDragBefore,!0),window.addEventListener("touchend",n.DD._endDragBefore,!0),window.addEventListener("touchcancel",n.DD._endDragBefore,!0),window.addEventListener("mousemove",n.DD._drag),window.addEventListener("touchmove",n.DD._drag),window.addEventListener("mouseup",n.DD._endDragAfter,!1),window.addEventListener("touchend",n.DD._endDragAfter,!1),window.addEventListener("touchcancel",n.DD._endDragAfter,!1))})(G0);var je={},ke={};Object.defineProperty(ke,"__esModule",{value:!0});ke.RGBComponent=kz;ke.alphaComponent=Rz;ke.getNumberValidator=xz;ke.getNumberOrArrayOfNumbersValidator=Az;ke.getNumberOrAutoValidator=Nz;ke.getStringValidator=bz;ke.getStringOrGradientValidator=Dz;ke.getFunctionValidator=Mz;ke.getNumberArrayValidator=Oz;ke.getBooleanValidator=Lz;ke.getComponentValidator=Fz;const no=Le,Bt=Vt;function ro(n){return Bt.Util._isString(n)?'"'+n+'"':Object.prototype.toString.call(n)==="[object Number]"||Bt.Util._isBoolean(n)?n:Object.prototype.toString.call(n)}function kz(n){return n>255?255:n<0?0:Math.round(n)}function Rz(n){return n>1?1:n<1e-4?1e-4:n}function xz(){if(no.Konva.isUnminified)return function(n,e){return Bt.Util._isNumber(n)||Bt.Util.warn(ro(n)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),n}}function Az(n){if(no.Konva.isUnminified)return function(e,t){let r=Bt.Util._isNumber(e),i=Bt.Util._isArray(e)&&e.length==n;return!r&&!i&&Bt.Util.warn(ro(e)+' is a not valid value for "'+t+'" attribute. The value should be a number or Array<number>('+n+")"),e}}function Nz(){if(no.Konva.isUnminified)return function(n,e){return Bt.Util._isNumber(n)||n==="auto"||Bt.Util.warn(ro(n)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),n}}function bz(){if(no.Konva.isUnminified)return function(n,e){return Bt.Util._isString(n)||Bt.Util.warn(ro(n)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),n}}function Dz(){if(no.Konva.isUnminified)return function(n,e){const t=Bt.Util._isString(n),r=Object.prototype.toString.call(n)==="[object CanvasGradient]"||n&&n.addColorStop;return t||r||Bt.Util.warn(ro(n)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),n}}function Mz(){if(no.Konva.isUnminified)return function(n,e){return Bt.Util._isFunction(n)||Bt.Util.warn(ro(n)+' is a not valid value for "'+e+'" attribute. The value should be a function.'),n}}function Oz(){if(no.Konva.isUnminified)return function(n,e){const t=Int8Array?Object.getPrototypeOf(Int8Array):null;return t&&n instanceof t||(Bt.Util._isArray(n)?n.forEach(function(r){Bt.Util._isNumber(r)||Bt.Util.warn('"'+e+'" attribute has non numeric element '+r+". Make sure that all elements are numbers.")}):Bt.Util.warn(ro(n)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.')),n}}function Lz(){if(no.Konva.isUnminified)return function(n,e){return n===!0||n===!1||Bt.Util.warn(ro(n)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),n}}function Fz(n){if(no.Konva.isUnminified)return function(e,t){return e==null||Bt.Util.isObject(e)||Bt.Util.warn(ro(e)+' is a not valid value for "'+t+'" attribute. The value should be an object with properties '+n),e}}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Factory=void 0;const e=Vt,t=ke,r="get",i="set";n.Factory={addGetterSetter(s,o,l,c,h){n.Factory.addGetter(s,o,l),n.Factory.addSetter(s,o,c,h),n.Factory.addOverloadedGetterSetter(s,o)},addGetter(s,o,l){const c=r+e.Util._capitalize(o);s.prototype[c]=s.prototype[c]||function(){const h=this.attrs[o];return h===void 0?l:h}},addSetter(s,o,l,c){const h=i+e.Util._capitalize(o);s.prototype[h]||n.Factory.overWriteSetter(s,o,l,c)},overWriteSetter(s,o,l,c){const h=i+e.Util._capitalize(o);s.prototype[h]=function(p){return l&&p!==void 0&&p!==null&&(p=l.call(this,p,o)),this._setAttr(o,p),c&&c.call(this),this}},addComponentsGetterSetter(s,o,l,c,h){const p=l.length,m=e.Util._capitalize,_=r+m(o),w=i+m(o);s.prototype[_]=function(){const k={};for(let N=0;N<p;N++){const x=l[N];k[x]=this.getAttr(o+m(x))}return k};const S=(0,t.getComponentValidator)(l);s.prototype[w]=function(k){const N=this.attrs[o];c&&(k=c.call(this,k,o)),S&&S.call(this,k,o);for(const x in k)k.hasOwnProperty(x)&&this._setAttr(o+m(x),k[x]);return k||l.forEach(x=>{this._setAttr(o+m(x),void 0)}),this._fireChangeEvent(o,N,k),h&&h.call(this),this},n.Factory.addOverloadedGetterSetter(s,o)},addOverloadedGetterSetter(s,o){const l=e.Util._capitalize(o),c=i+l,h=r+l;s.prototype[o]=function(){return arguments.length?(this[c](arguments[0]),this):this[h]()}},addDeprecatedGetterSetter(s,o,l,c){e.Util.error("Adding deprecated "+o);const h=r+e.Util._capitalize(o),p=o+" property is deprecated and will be removed soon. Look at Konva change log for more information.";s.prototype[h]=function(){e.Util.error(p);const m=this.attrs[o];return m===void 0?l:m},n.Factory.addSetter(s,o,c,function(){e.Util.error(p)}),n.Factory.addOverloadedGetterSetter(s,o)},backCompat(s,o){e.Util.each(o,function(l,c){const h=s.prototype[c],p=r+e.Util._capitalize(l),m=i+e.Util._capitalize(l);function _(){h.apply(this,arguments),e.Util.error('"'+l+'" method is deprecated and will be removed soon. Use ""'+c+'" instead.')}s.prototype[l]=_,s.prototype[p]=_,s.prototype[m]=_})},afterSetFilter(){this._filterUpToDate=!1}}})(je);Object.defineProperty(At,"__esModule",{value:!0});At.Node=void 0;const ou=bi,ti=G0,wf=je,Co=Le,$e=Vt,qt=ke,kg="absoluteOpacity",Zp="allEventListeners",As="absoluteTransform",o5="absoluteScale",Ga="canvas",Vz="Change",Uz="children",Bz="konva",T2="listening",zz="mouseenter",jz="mouseleave",Gz="pointerenter",Wz="pointerleave",Hz="touchenter",$z="touchleave",a5="set",l5="Shape",Rg=" ",u5="stage",To="transform",qz="Stage",I2="visible",Kz=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(Rg);let Qz=1;class xe{constructor(e){this._id=Qz++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(e),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(e){(e===To||e===As)&&this._cache.get(e)?this._cache.get(e).dirty=!0:e?this._cache.delete(e):this._cache.clear()}_getCache(e,t){let r=this._cache.get(e);return(r===void 0||(e===To||e===As)&&r.dirty===!0)&&(r=t.call(this),this._cache.set(e,r)),r}_calculate(e,t,r){if(!this._attachedDepsListeners.get(e)){const i=t.map(s=>s+"Change.konva").join(Rg);this.on(i,()=>{this._clearCache(e)}),this._attachedDepsListeners.set(e,!0)}return this._getCache(e,r)}_getCanvasCache(){return this._cache.get(Ga)}_clearSelfAndDescendantCache(e){this._clearCache(e),e===As&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(Ga)){const{scene:e,filter:t,hit:r,buffer:i}=this._cache.get(Ga);$e.Util.releaseCanvas(e,t,r,i),this._cache.delete(Ga)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(e){const t=e||{};let r={};(t.x===void 0||t.y===void 0||t.width===void 0||t.height===void 0)&&(r=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let i=Math.ceil(t.width||r.width),s=Math.ceil(t.height||r.height),o=t.pixelRatio,l=t.x===void 0?Math.floor(r.x):t.x,c=t.y===void 0?Math.floor(r.y):t.y,h=t.offset||0,p=t.drawBorder||!1,m=t.hitCanvasPixelRatio||1;if(!i||!s){$e.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const _=Math.abs(Math.round(r.x)-l)>.5?1:0,w=Math.abs(Math.round(r.y)-c)>.5?1:0;i+=h*2+_,s+=h*2+w,l-=h,c-=h;const S=new ou.SceneCanvas({pixelRatio:o,width:i,height:s}),k=new ou.SceneCanvas({pixelRatio:o,width:0,height:0,willReadFrequently:!0}),N=new ou.HitCanvas({pixelRatio:m,width:i,height:s}),x=S.getContext(),R=N.getContext(),E=new ou.SceneCanvas({width:S.width/S.pixelRatio+Math.abs(l),height:S.height/S.pixelRatio+Math.abs(c),pixelRatio:S.pixelRatio}),P=E.getContext();return N.isCache=!0,S.isCache=!0,this._cache.delete(Ga),this._filterUpToDate=!1,t.imageSmoothingEnabled===!1&&(S.getContext()._context.imageSmoothingEnabled=!1,k.getContext()._context.imageSmoothingEnabled=!1),x.save(),R.save(),P.save(),x.translate(-l,-c),R.translate(-l,-c),P.translate(-l,-c),E.x=l,E.y=c,this._isUnderCache=!0,this._clearSelfAndDescendantCache(kg),this._clearSelfAndDescendantCache(o5),this.drawScene(S,this,E),this.drawHit(N,this),this._isUnderCache=!1,x.restore(),R.restore(),p&&(x.save(),x.beginPath(),x.rect(0,0,i,s),x.closePath(),x.setAttr("strokeStyle","red"),x.setAttr("lineWidth",5),x.stroke(),x.restore()),this._cache.set(Ga,{scene:S,filter:k,hit:N,buffer:E,x:l,y:c}),this._requestDraw(),this}isCached(){return this._cache.has(Ga)}getClientRect(e){throw new Error('abstract "getClientRect" method call')}_transformedRect(e,t){const r=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}];let i=1/0,s=1/0,o=-1/0,l=-1/0;const c=this.getAbsoluteTransform(t);return r.forEach(function(h){const p=c.point(h);i===void 0&&(i=o=p.x,s=l=p.y),i=Math.min(i,p.x),s=Math.min(s,p.y),o=Math.max(o,p.x),l=Math.max(l,p.y)}),{x:i,y:s,width:o-i,height:l-s}}_drawCachedSceneCanvas(e){e.save(),e._applyOpacity(this),e._applyGlobalCompositeOperation(this);const t=this._getCanvasCache();e.translate(t.x,t.y);const r=this._getCachedSceneCanvas(),i=r.pixelRatio;e.drawImage(r._canvas,0,0,r.width/i,r.height/i),e.restore()}_drawCachedHitCanvas(e){const t=this._getCanvasCache(),r=t.hit;e.save(),e.translate(t.x,t.y),e.drawImage(r._canvas,0,0,r.width/r.pixelRatio,r.height/r.pixelRatio),e.restore()}_getCachedSceneCanvas(){let e=this.filters(),t=this._getCanvasCache(),r=t.scene,i=t.filter,s=i.getContext(),o,l,c,h;if(e){if(!this._filterUpToDate){const p=r.pixelRatio;i.setSize(r.width/r.pixelRatio,r.height/r.pixelRatio);try{for(o=e.length,s.clear(),s.drawImage(r._canvas,0,0,r.getWidth()/p,r.getHeight()/p),l=s.getImageData(0,0,i.getWidth(),i.getHeight()),c=0;c<o;c++){if(h=e[c],typeof h!="function"){$e.Util.error("Filter should be type of function, but got "+typeof h+" instead. Please check correct filters");continue}h.call(this,l),s.putImageData(l,0,0)}}catch(m){$e.Util.error("Unable to apply filter. "+m.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return i}return r}on(e,t){if(this._cache&&this._cache.delete(Zp),arguments.length===3)return this._delegate.apply(this,arguments);const r=e.split(Rg);for(let i=0;i<r.length;i++){const o=r[i].split("."),l=o[0],c=o[1]||"";this.eventListeners[l]||(this.eventListeners[l]=[]),this.eventListeners[l].push({name:c,handler:t})}return this}off(e,t){let r=(e||"").split(Rg),i=r.length,s,o,l,c,h,p;if(this._cache&&this._cache.delete(Zp),!e)for(o in this.eventListeners)this._off(o);for(s=0;s<i;s++)if(l=r[s],c=l.split("."),h=c[0],p=c[1],h)this.eventListeners[h]&&this._off(h,p,t);else for(o in this.eventListeners)this._off(o,p,t);return this}dispatchEvent(e){const t={target:this,type:e.type,evt:e};return this.fire(e.type,t),this}addEventListener(e,t){return this.on(e,function(r){t.call(this,r.evt)}),this}removeEventListener(e){return this.off(e),this}_delegate(e,t,r){const i=this;this.on(e,function(s){const o=s.target.findAncestors(t,!0,i);for(let l=0;l<o.length;l++)s=$e.Util.cloneObject(s),s.currentTarget=o[l],r.call(o[l],s)})}remove(){return this.isDragging()&&this.stopDrag(),ti.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(As),this._clearSelfAndDescendantCache(kg),this._clearSelfAndDescendantCache(o5),this._clearSelfAndDescendantCache(u5),this._clearSelfAndDescendantCache(I2),this._clearSelfAndDescendantCache(T2)}_remove(){this._clearCaches();const e=this.getParent();e&&e.children&&(e.children.splice(this.index,1),e._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(e){const t="get"+$e.Util._capitalize(e);return $e.Util._isFunction(this[t])?this[t]():this.attrs[e]}getAncestors(){let e=this.getParent(),t=[];for(;e;)t.push(e),e=e.getParent();return t}getAttrs(){return this.attrs||{}}setAttrs(e){return this._batchTransformChanges(()=>{let t,r;if(!e)return this;for(t in e)t!==Uz&&(r=a5+$e.Util._capitalize(t),$e.Util._isFunction(this[r])?this[r](e[t]):this._setAttr(t,e[t]))}),this}isListening(){return this._getCache(T2,this._isListening)}_isListening(e){if(!this.listening())return!1;const r=this.getParent();return r&&r!==e&&this!==e?r._isListening(e):!0}isVisible(){return this._getCache(I2,this._isVisible)}_isVisible(e){if(!this.visible())return!1;const r=this.getParent();return r&&r!==e&&this!==e?r._isVisible(e):!0}shouldDrawHit(e,t=!1){if(e)return this._isVisible(e)&&this._isListening(e);const r=this.getLayer();let i=!1;ti.DD._dragElements.forEach(o=>{o.dragStatus==="dragging"&&(o.node.nodeType==="Stage"||o.node.getLayer()===r)&&(i=!0)});const s=!t&&!Co.Konva.hitOnDragEnabled&&(i||Co.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!s}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let e=this.getDepth(),t=this,r=0,i,s,o,l;function c(p){for(i=[],s=p.length,o=0;o<s;o++)l=p[o],r++,l.nodeType!==l5&&(i=i.concat(l.getChildren().slice())),l._id===t._id&&(o=s);i.length>0&&i[0].getDepth()<=e&&c(i)}const h=this.getStage();return t.nodeType!==qz&&h&&c(h.getChildren()),r}getDepth(){let e=0,t=this.parent;for(;t;)e++,t=t.parent;return e}_batchTransformChanges(e){this._batchingTransformChange=!0,e(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(To),this._clearSelfAndDescendantCache(As)),this._needClearTransformCache=!1}setPosition(e){return this._batchTransformChanges(()=>{this.x(e.x),this.y(e.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const e=this.getStage();if(!e)return null;const t=e.getPointerPosition();if(!t)return null;const r=this.getAbsoluteTransform().copy();return r.invert(),r.point(t)}getAbsolutePosition(e){let t=!1,r=this.parent;for(;r;){if(r.isCached()){t=!0;break}r=r.parent}t&&!e&&(e=!0);const i=this.getAbsoluteTransform(e).getMatrix(),s=new $e.Transform,o=this.offset();return s.m=i.slice(),s.translate(o.x,o.y),s.getTranslation()}setAbsolutePosition(e){const{x:t,y:r,...i}=this._clearTransform();this.attrs.x=t,this.attrs.y=r,this._clearCache(To);const s=this._getAbsoluteTransform().copy();return s.invert(),s.translate(e.x,e.y),e={x:this.attrs.x+s.getTranslation().x,y:this.attrs.y+s.getTranslation().y},this._setTransform(i),this.setPosition({x:e.x,y:e.y}),this._clearCache(To),this._clearSelfAndDescendantCache(As),this}_setTransform(e){let t;for(t in e)this.attrs[t]=e[t]}_clearTransform(){const e={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,e}move(e){let t=e.x,r=e.y,i=this.x(),s=this.y();return t!==void 0&&(i+=t),r!==void 0&&(s+=r),this.setPosition({x:i,y:s}),this}_eachAncestorReverse(e,t){let r=[],i=this.getParent(),s,o;if(!(t&&t._id===this._id)){for(r.unshift(this);i&&(!t||i._id!==t._id);)r.unshift(i),i=i.parent;for(s=r.length,o=0;o<s;o++)e(r[o])}}rotate(e){return this.rotation(this.rotation()+e),this}moveToTop(){if(!this.parent)return $e.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const e=this.index,t=this.parent.getChildren().length;return e<t-1?(this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return $e.Util.warn("Node has no parent. moveUp function is ignored."),!1;const e=this.index,t=this.parent.getChildren().length;return e<t-1?(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return $e.Util.warn("Node has no parent. moveDown function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return $e.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(e){if(!this.parent)return $e.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(e<0||e>=this.parent.children.length)&&$e.Util.warn("Unexpected value "+e+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const t=this.index;return this.parent.children.splice(t,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(kg,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let e=this.opacity();const t=this.getParent();return t&&!t._isUnderCache&&(e*=t.getAbsoluteOpacity()),e}moveTo(e){return this.getParent()!==e&&(this._remove(),e.add(this)),this}toObject(){let e=this.getAttrs(),t,r,i,s,o;const l={attrs:{},className:this.getClassName()};for(t in e)r=e[t],o=$e.Util.isObject(r)&&!$e.Util._isPlainObject(r)&&!$e.Util._isArray(r),!o&&(i=typeof this[t]=="function"&&this[t],delete e[t],s=i?i.call(this):null,e[t]=r,s!==r&&(l.attrs[t]=r));return $e.Util._prepareToStringify(l)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(e,t,r){const i=[];t&&this._isMatch(e)&&i.push(this);let s=this.parent;for(;s;){if(s===r)return i;s._isMatch(e)&&i.push(s),s=s.parent}return i}isAncestorOf(e){return!1}findAncestor(e,t,r){return this.findAncestors(e,t,r)[0]}_isMatch(e){if(!e)return!1;if(typeof e=="function")return e(this);let t=e.replace(/ /g,"").split(","),r=t.length,i,s;for(i=0;i<r;i++)if(s=t[i],$e.Util.isValidSelector(s)||($e.Util.warn('Selector "'+s+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),$e.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),$e.Util.warn("Konva is awesome, right?")),s.charAt(0)==="#"){if(this.id()===s.slice(1))return!0}else if(s.charAt(0)==="."){if(this.hasName(s.slice(1)))return!0}else if(this.className===s||this.nodeType===s)return!0;return!1}getLayer(){const e=this.getParent();return e?e.getLayer():null}getStage(){return this._getCache(u5,this._getStage)}_getStage(){const e=this.getParent();return e?e.getStage():null}fire(e,t={},r){return t.target=t.target||this,r?this._fireAndBubble(e,t):this._fire(e,t),this}getAbsoluteTransform(e){return e?this._getAbsoluteTransform(e):this._getCache(As,this._getAbsoluteTransform)}_getAbsoluteTransform(e){let t;if(e)return t=new $e.Transform,this._eachAncestorReverse(function(r){const i=r.transformsEnabled();i==="all"?t.multiply(r.getTransform()):i==="position"&&t.translate(r.x()-r.offsetX(),r.y()-r.offsetY())},e),t;{t=this._cache.get(As)||new $e.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(t):t.reset();const r=this.transformsEnabled();if(r==="all")t.multiply(this.getTransform());else if(r==="position"){const i=this.attrs.x||0,s=this.attrs.y||0,o=this.attrs.offsetX||0,l=this.attrs.offsetY||0;t.translate(i-o,s-l)}return t.dirty=!1,t}}getAbsoluteScale(e){let t=this;for(;t;)t._isUnderCache&&(e=t),t=t.getParent();const i=this.getAbsoluteTransform(e).decompose();return{x:i.scaleX,y:i.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(To,this._getTransform)}_getTransform(){var e,t;const r=this._cache.get(To)||new $e.Transform;r.reset();const i=this.x(),s=this.y(),o=Co.Konva.getAngle(this.rotation()),l=(e=this.attrs.scaleX)!==null&&e!==void 0?e:1,c=(t=this.attrs.scaleY)!==null&&t!==void 0?t:1,h=this.attrs.skewX||0,p=this.attrs.skewY||0,m=this.attrs.offsetX||0,_=this.attrs.offsetY||0;return(i!==0||s!==0)&&r.translate(i,s),o!==0&&r.rotate(o),(h!==0||p!==0)&&r.skew(h,p),(l!==1||c!==1)&&r.scale(l,c),(m!==0||_!==0)&&r.translate(-1*m,-1*_),r.dirty=!1,r}clone(e){let t=$e.Util.cloneObject(this.attrs),r,i,s,o,l;for(r in e)t[r]=e[r];const c=new this.constructor(t);for(r in this.eventListeners)for(i=this.eventListeners[r],s=i.length,o=0;o<s;o++)l=i[o],l.name.indexOf(Bz)<0&&(c.eventListeners[r]||(c.eventListeners[r]=[]),c.eventListeners[r].push(l));return c}_toKonvaCanvas(e){e=e||{};const t=this.getClientRect(),r=this.getStage(),i=e.x!==void 0?e.x:Math.floor(t.x),s=e.y!==void 0?e.y:Math.floor(t.y),o=e.pixelRatio||1,l=new ou.SceneCanvas({width:e.width||Math.ceil(t.width)||(r?r.width():0),height:e.height||Math.ceil(t.height)||(r?r.height():0),pixelRatio:o}),c=l.getContext(),h=new ou.SceneCanvas({width:l.width/l.pixelRatio+Math.abs(i),height:l.height/l.pixelRatio+Math.abs(s),pixelRatio:l.pixelRatio});return e.imageSmoothingEnabled===!1&&(c._context.imageSmoothingEnabled=!1),c.save(),(i||s)&&c.translate(-1*i,-1*s),this.drawScene(l,void 0,h),c.restore(),l}toCanvas(e){return this._toKonvaCanvas(e)._canvas}toDataURL(e){e=e||{};const t=e.mimeType||null,r=e.quality||null,i=this._toKonvaCanvas(e).toDataURL(t,r);return e.callback&&e.callback(i),i}toImage(e){return new Promise((t,r)=>{try{const i=e==null?void 0:e.callback;i&&delete e.callback,$e.Util._urlToImage(this.toDataURL(e),function(s){t(s),i==null||i(s)})}catch(i){r(i)}})}toBlob(e){return new Promise((t,r)=>{try{const i=e==null?void 0:e.callback;i&&delete e.callback,this.toCanvas(e).toBlob(s=>{t(s),i==null||i(s)},e==null?void 0:e.mimeType,e==null?void 0:e.quality)}catch(i){r(i)}})}setSize(e){return this.width(e.width),this.height(e.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():Co.Konva.dragDistance}_off(e,t,r){let i=this.eventListeners[e],s,o,l;for(s=0;s<i.length;s++)if(o=i[s].name,l=i[s].handler,(o!=="konva"||t==="konva")&&(!t||o===t)&&(!r||r===l)){if(i.splice(s,1),i.length===0){delete this.eventListeners[e];break}s--}}_fireChangeEvent(e,t,r){this._fire(e+Vz,{oldVal:t,newVal:r})}addName(e){if(!this.hasName(e)){const t=this.name(),r=t?t+" "+e:e;this.name(r)}return this}hasName(e){if(!e)return!1;const t=this.name();return t?(t||"").split(/\s/g).indexOf(e)!==-1:!1}removeName(e){const t=(this.name()||"").split(/\s/g),r=t.indexOf(e);return r!==-1&&(t.splice(r,1),this.name(t.join(" "))),this}setAttr(e,t){const r=this[a5+$e.Util._capitalize(e)];return $e.Util._isFunction(r)?r.call(this,t):this._setAttr(e,t),this}_requestDraw(){if(Co.Konva.autoDrawEnabled){const e=this.getLayer()||this.getStage();e==null||e.batchDraw()}}_setAttr(e,t){const r=this.attrs[e];r===t&&!$e.Util.isObject(t)||(t==null?delete this.attrs[e]:this.attrs[e]=t,this._shouldFireChangeEvents&&this._fireChangeEvent(e,r,t),this._requestDraw())}_setComponentAttr(e,t,r){let i;r!==void 0&&(i=this.attrs[e],i||(this.attrs[e]=this.getAttr(e)),this.attrs[e][t]=r,this._fireChangeEvent(e,i,r))}_fireAndBubble(e,t,r){t&&this.nodeType===l5&&(t.target=this);const i=[zz,jz,Gz,Wz,Hz,$z];if(!(i.indexOf(e)!==-1&&(r&&(this===r||this.isAncestorOf&&this.isAncestorOf(r))||this.nodeType==="Stage"&&!r))){this._fire(e,t);const o=i.indexOf(e)!==-1&&r&&r.isAncestorOf&&r.isAncestorOf(this)&&!r.isAncestorOf(this.parent);(t&&!t.cancelBubble||!t)&&this.parent&&this.parent.isListening()&&!o&&(r&&r.parent?this._fireAndBubble.call(this.parent,e,t,r):this._fireAndBubble.call(this.parent,e,t))}}_getProtoListeners(e){var t,r,i;const s=(t=this._cache.get(Zp))!==null&&t!==void 0?t:{};let o=s==null?void 0:s[e];if(o===void 0){o=[];let l=Object.getPrototypeOf(this);for(;l;){const c=(i=(r=l.eventListeners)===null||r===void 0?void 0:r[e])!==null&&i!==void 0?i:[];o.push(...c),l=Object.getPrototypeOf(l)}s[e]=o,this._cache.set(Zp,s)}return o}_fire(e,t){t=t||{},t.currentTarget=this,t.type=e;const r=this._getProtoListeners(e);if(r)for(let s=0;s<r.length;s++)r[s].handler.call(this,t);const i=this.eventListeners[e];if(i)for(let s=0;s<i.length;s++)i[s].handler.call(this,t)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(e){const t=e?e.pointerId:void 0,r=this.getStage(),i=this.getAbsolutePosition();if(!r)return;const s=r._getPointerById(t)||r._changedPointerPositions[0]||i;ti.DD._dragElements.set(this._id,{node:this,startPointerPos:s,offset:{x:s.x-i.x,y:s.y-i.y},dragStatus:"ready",pointerId:t})}startDrag(e,t=!0){ti.DD._dragElements.has(this._id)||this._createDragElement(e);const r=ti.DD._dragElements.get(this._id);r.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:e&&e.evt},t)}_setDragPosition(e,t){const r=this.getStage()._getPointerById(t.pointerId);if(!r)return;let i={x:r.x-t.offset.x,y:r.y-t.offset.y};const s=this.dragBoundFunc();if(s!==void 0){const o=s.call(this,i,e);o?i=o:$e.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==i.x||this._lastPos.y!==i.y)&&(this.setAbsolutePosition(i),this._requestDraw()),this._lastPos=i}stopDrag(e){const t=ti.DD._dragElements.get(this._id);t&&(t.dragStatus="stopped"),ti.DD._endDragBefore(e),ti.DD._endDragAfter(e)}setDraggable(e){this._setAttr("draggable",e),this._dragChange()}isDragging(){const e=ti.DD._dragElements.get(this._id);return e?e.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(e){if(!(!(e.evt.button!==void 0)||Co.Konva.dragButtons.indexOf(e.evt.button)>=0)||this.isDragging())return;let i=!1;ti.DD._dragElements.forEach(s=>{this.isAncestorOf(s.node)&&(i=!0)}),i||this._createDragElement(e)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const t=ti.DD._dragElements.get(this._id),r=t&&t.dragStatus==="dragging",i=t&&t.dragStatus==="ready";r?this.stopDrag():i&&ti.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(e={x:0,y:0}){const t=this.getStage();if(!t)return!1;const r={x:-e.x,y:-e.y,width:t.width()+2*e.x,height:t.height()+2*e.y};return $e.Util.haveIntersection(r,this.getClientRect())}static create(e,t){return $e.Util._isString(e)&&(e=JSON.parse(e)),this._createNode(e,t)}static _createNode(e,t){let r=xe.prototype.getClassName.call(e),i=e.children,s,o,l;t&&(e.attrs.container=t),Co.Konva[r]||($e.Util.warn('Can not find a node with class name "'+r+'". Fallback to "Shape".'),r="Shape");const c=Co.Konva[r];if(s=new c(e.attrs),i)for(o=i.length,l=0;l<o;l++)s.add(xe._createNode(i[l]));return s}}At.Node=xe;xe.prototype.nodeType="Node";xe.prototype._attrsAffectingSize=[];xe.prototype.eventListeners={};xe.prototype.on.call(xe.prototype,Kz,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(To),this._clearSelfAndDescendantCache(As)});xe.prototype.on.call(xe.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(I2)});xe.prototype.on.call(xe.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(T2)});xe.prototype.on.call(xe.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(kg)});const Et=wf.Factory.addGetterSetter;Et(xe,"zIndex");Et(xe,"absolutePosition");Et(xe,"position");Et(xe,"x",0,(0,qt.getNumberValidator)());Et(xe,"y",0,(0,qt.getNumberValidator)());Et(xe,"globalCompositeOperation","source-over",(0,qt.getStringValidator)());Et(xe,"opacity",1,(0,qt.getNumberValidator)());Et(xe,"name","",(0,qt.getStringValidator)());Et(xe,"id","",(0,qt.getStringValidator)());Et(xe,"rotation",0,(0,qt.getNumberValidator)());wf.Factory.addComponentsGetterSetter(xe,"scale",["x","y"]);Et(xe,"scaleX",1,(0,qt.getNumberValidator)());Et(xe,"scaleY",1,(0,qt.getNumberValidator)());wf.Factory.addComponentsGetterSetter(xe,"skew",["x","y"]);Et(xe,"skewX",0,(0,qt.getNumberValidator)());Et(xe,"skewY",0,(0,qt.getNumberValidator)());wf.Factory.addComponentsGetterSetter(xe,"offset",["x","y"]);Et(xe,"offsetX",0,(0,qt.getNumberValidator)());Et(xe,"offsetY",0,(0,qt.getNumberValidator)());Et(xe,"dragDistance",void 0,(0,qt.getNumberValidator)());Et(xe,"width",0,(0,qt.getNumberValidator)());Et(xe,"height",0,(0,qt.getNumberValidator)());Et(xe,"listening",!0,(0,qt.getBooleanValidator)());Et(xe,"preventDefault",!0,(0,qt.getBooleanValidator)());Et(xe,"filters",void 0,function(n){return this._filterUpToDate=!1,n});Et(xe,"visible",!0,(0,qt.getBooleanValidator)());Et(xe,"transformsEnabled","all",(0,qt.getStringValidator)());Et(xe,"size");Et(xe,"dragBoundFunc");Et(xe,"draggable",!1,(0,qt.getBooleanValidator)());wf.Factory.backCompat(xe,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var kl={};Object.defineProperty(kl,"__esModule",{value:!0});kl.Container=void 0;const Pc=je,Iv=At,W0=ke;class Rl extends Iv.Node{constructor(){super(...arguments),this.children=[]}getChildren(e){const t=this.children||[];return e?t.filter(e):t}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.destroy()}),this.children=[],this._requestDraw(),this}add(...e){if(e.length===0)return this;if(e.length>1){for(let r=0;r<e.length;r++)this.add(e[r]);return this}const t=e[0];return t.getParent()?(t.moveTo(this),this):(this._validateAdd(t),t.index=this.getChildren().length,t.parent=this,t._clearCaches(),this.getChildren().push(t),this._fire("add",{child:t}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(e){return this._generalFind(e,!1)}findOne(e){const t=this._generalFind(e,!0);return t.length>0?t[0]:void 0}_generalFind(e,t){const r=[];return this._descendants(i=>{const s=i._isMatch(e);return s&&r.push(i),!!(s&&t)}),r}_descendants(e){let t=!1;const r=this.getChildren();for(const i of r){if(t=e(i),t)return!0;if(i.hasChildren()&&(t=i._descendants(e),t))return!0}return!1}toObject(){const e=Iv.Node.prototype.toObject.call(this);return e.children=[],this.getChildren().forEach(t=>{e.children.push(t.toObject())}),e}isAncestorOf(e){let t=e.getParent();for(;t;){if(t._id===this._id)return!0;t=t.getParent()}return!1}clone(e){const t=Iv.Node.prototype.clone.call(this,e);return this.getChildren().forEach(function(r){t.add(r.clone())}),t}getAllIntersections(e){const t=[];return this.find("Shape").forEach(r=>{r.isVisible()&&r.intersects(e)&&t.push(r)}),t}_clearSelfAndDescendantCache(e){var t;super._clearSelfAndDescendantCache(e),!this.isCached()&&((t=this.children)===null||t===void 0||t.forEach(function(r){r._clearSelfAndDescendantCache(e)}))}_setChildrenIndices(){var e;(e=this.children)===null||e===void 0||e.forEach(function(t,r){t.index=r}),this._requestDraw()}drawScene(e,t,r){const i=this.getLayer(),s=e||i&&i.getCanvas(),o=s&&s.getContext(),l=this._getCanvasCache(),c=l&&l.scene,h=s&&s.isCache;if(!this.isVisible()&&!h)return this;if(c){o.save();const p=this.getAbsoluteTransform(t).getMatrix();o.transform(p[0],p[1],p[2],p[3],p[4],p[5]),this._drawCachedSceneCanvas(o),o.restore()}else this._drawChildren("drawScene",s,t,r);return this}drawHit(e,t){if(!this.shouldDrawHit(t))return this;const r=this.getLayer(),i=e||r&&r.hitCanvas,s=i&&i.getContext(),o=this._getCanvasCache();if(o&&o.hit){s.save();const c=this.getAbsoluteTransform(t).getMatrix();s.transform(c[0],c[1],c[2],c[3],c[4],c[5]),this._drawCachedHitCanvas(s),s.restore()}else this._drawChildren("drawHit",i,t);return this}_drawChildren(e,t,r,i){var s;const o=t&&t.getContext(),l=this.clipWidth(),c=this.clipHeight(),h=this.clipFunc(),p=typeof l=="number"&&typeof c=="number"||h,m=r===this;if(p){o.save();const w=this.getAbsoluteTransform(r);let S=w.getMatrix();o.transform(S[0],S[1],S[2],S[3],S[4],S[5]),o.beginPath();let k;if(h)k=h.call(this,o,this);else{const N=this.clipX(),x=this.clipY();o.rect(N||0,x||0,l,c)}o.clip.apply(o,k),S=w.copy().invert().getMatrix(),o.transform(S[0],S[1],S[2],S[3],S[4],S[5])}const _=!m&&this.globalCompositeOperation()!=="source-over"&&e==="drawScene";_&&(o.save(),o._applyGlobalCompositeOperation(this)),(s=this.children)===null||s===void 0||s.forEach(function(w){w[e](t,r,i)}),_&&o.restore(),p&&o.restore()}getClientRect(e={}){var t;const r=e.skipTransform,i=e.relativeTo;let s,o,l,c,h={x:1/0,y:1/0,width:0,height:0};const p=this;(t=this.children)===null||t===void 0||t.forEach(function(w){if(!w.visible())return;const S=w.getClientRect({relativeTo:p,skipShadow:e.skipShadow,skipStroke:e.skipStroke});S.width===0&&S.height===0||(s===void 0?(s=S.x,o=S.y,l=S.x+S.width,c=S.y+S.height):(s=Math.min(s,S.x),o=Math.min(o,S.y),l=Math.max(l,S.x+S.width),c=Math.max(c,S.y+S.height)))});const m=this.find("Shape");let _=!1;for(let w=0;w<m.length;w++)if(m[w]._isVisible(this)){_=!0;break}return _&&s!==void 0?h={x:s,y:o,width:l-s,height:c-o}:h={x:0,y:0,width:0,height:0},r?h:this._transformedRect(h,i)}}kl.Container=Rl;Pc.Factory.addComponentsGetterSetter(Rl,"clip",["x","y","width","height"]);Pc.Factory.addGetterSetter(Rl,"clipX",void 0,(0,W0.getNumberValidator)());Pc.Factory.addGetterSetter(Rl,"clipY",void 0,(0,W0.getNumberValidator)());Pc.Factory.addGetterSetter(Rl,"clipWidth",void 0,(0,W0.getNumberValidator)());Pc.Factory.addGetterSetter(Rl,"clipHeight",void 0,(0,W0.getNumberValidator)());Pc.Factory.addGetterSetter(Rl,"clipFunc");var ex={},va={};Object.defineProperty(va,"__esModule",{value:!0});va.getCapturedShape=Xz;va.createEvent=hS;va.hasPointerCapture=Jz;va.setPointerCapture=Zz;va.releaseCapture=nx;const Yz=Le,Hd=new Map,tx=Yz.Konva._global.PointerEvent!==void 0;function Xz(n){return Hd.get(n)}function hS(n){return{evt:n,pointerId:n.pointerId}}function Jz(n,e){return Hd.get(n)===e}function Zz(n,e){nx(n),e.getStage()&&(Hd.set(n,e),tx&&e._fire("gotpointercapture",hS(new PointerEvent("gotpointercapture"))))}function nx(n,e){const t=Hd.get(n);if(!t)return;const r=t.getStage();r&&r.content,Hd.delete(n),tx&&t._fire("lostpointercapture",hS(new PointerEvent("lostpointercapture")))}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Stage=n.stages=void 0;const e=Vt,t=je,r=kl,i=Le,s=bi,o=G0,l=Le,c=va,h="Stage",p="string",m="px",_="mouseout",w="mouseleave",S="mouseover",k="mouseenter",N="mousemove",x="mousedown",R="mouseup",E="pointermove",P="pointerdown",V="pointerup",B="pointercancel",D="lostpointercapture",T="pointerout",b="pointerleave",A="pointerover",O="pointerenter",U="contextmenu",F="touchstart",ce="touchend",le="touchmove",Me="touchcancel",be="wheel",$=5,J=[[k,"_pointerenter"],[x,"_pointerdown"],[N,"_pointermove"],[R,"_pointerup"],[w,"_pointerleave"],[F,"_pointerdown"],[le,"_pointermove"],[ce,"_pointerup"],[Me,"_pointercancel"],[S,"_pointerover"],[be,"_wheel"],[U,"_contextmenu"],[P,"_pointerdown"],[E,"_pointermove"],[V,"_pointerup"],[B,"_pointercancel"],[b,"_pointerleave"],[D,"_lostpointercapture"]],ee={mouse:{[T]:_,[b]:w,[A]:S,[O]:k,[E]:N,[P]:x,[V]:R,[B]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[T]:"touchout",[b]:"touchleave",[A]:"touchover",[O]:"touchenter",[E]:le,[P]:F,[V]:ce,[B]:Me,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[T]:T,[b]:b,[A]:A,[O]:O,[E]:E,[P]:P,[V]:V,[B]:B,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},Z=Ve=>Ve.indexOf("pointer")>=0?"pointer":Ve.indexOf("touch")>=0?"touch":"mouse",ie=Ve=>{const j=Z(Ve);if(j==="pointer")return i.Konva.pointerEventsEnabled&&ee.pointer;if(j==="touch")return ee.touch;if(j==="mouse")return ee.mouse};function _e(Ve={}){return(Ve.clipFunc||Ve.clipWidth||Ve.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),Ve}const Tt="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";n.stages=[];class dt extends r.Container{constructor(j){super(_e(j)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),n.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{_e(this.attrs)}),this._checkVisibility()}_validateAdd(j){const te=j.getType()==="Layer",ve=j.getType()==="FastLayer";te||ve||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const j=this.visible()?"":"none";this.content.style.display=j}setContainer(j){if(typeof j===p){let te;if(j.charAt(0)==="."){const ve=j.slice(1);j=document.getElementsByClassName(ve)[0]}else j.charAt(0)!=="#"?te=j:te=j.slice(1),j=document.getElementById(te);if(!j)throw"Can not find container in document with id "+te}return this._setAttr("container",j),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),j.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const j=this.children,te=j.length;for(let ve=0;ve<te;ve++)j[ve].clear();return this}clone(j){return j||(j={}),j.container=typeof document<"u"&&document.createElement("div"),r.Container.prototype.clone.call(this,j)}destroy(){super.destroy();const j=this.content;j&&e.Util._isInDocument(j)&&this.container().removeChild(j);const te=n.stages.indexOf(this);return te>-1&&n.stages.splice(te,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const j=this._pointerPositions[0]||this._changedPointerPositions[0];return j?{x:j.x,y:j.y}:(e.Util.warn(Tt),null)}_getPointerById(j){return this._pointerPositions.find(te=>te.id===j)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(j){j=j||{},j.x=j.x||0,j.y=j.y||0,j.width=j.width||this.width(),j.height=j.height||this.height();const te=new s.SceneCanvas({width:j.width,height:j.height,pixelRatio:j.pixelRatio||1}),ve=te.getContext()._context,De=this.children;return(j.x||j.y)&&ve.translate(-1*j.x,-1*j.y),De.forEach(function(Ce){if(!Ce.isVisible())return;const Qe=Ce._toKonvaCanvas(j);ve.drawImage(Qe._canvas,j.x,j.y,Qe.getWidth()/Qe.getPixelRatio(),Qe.getHeight()/Qe.getPixelRatio())}),te}getIntersection(j){if(!j)return null;const te=this.children,ve=te.length,De=ve-1;for(let Ce=De;Ce>=0;Ce--){const Qe=te[Ce].getIntersection(j);if(Qe)return Qe}return null}_resizeDOM(){const j=this.width(),te=this.height();this.content&&(this.content.style.width=j+m,this.content.style.height=te+m),this.bufferCanvas.setSize(j,te),this.bufferHitCanvas.setSize(j,te),this.children.forEach(ve=>{ve.setSize({width:j,height:te}),ve.draw()})}add(j,...te){if(arguments.length>1){for(let De=0;De<arguments.length;De++)this.add(arguments[De]);return this}super.add(j);const ve=this.children.length;return ve>$&&e.Util.warn("The stage has "+ve+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),j.setSize({width:this.width(),height:this.height()}),j.draw(),i.Konva.isBrowser&&this.content.appendChild(j.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(j){return c.hasPointerCapture(j,this)}setPointerCapture(j){c.setPointerCapture(j,this)}releaseCapture(j){c.releaseCapture(j,this)}getLayers(){return this.children}_bindContentEvents(){i.Konva.isBrowser&&J.forEach(([j,te])=>{this.content.addEventListener(j,ve=>{this[te](ve)},{passive:!1})})}_pointerenter(j){this.setPointersPositions(j);const te=ie(j.type);te&&this._fire(te.pointerenter,{evt:j,target:this,currentTarget:this})}_pointerover(j){this.setPointersPositions(j);const te=ie(j.type);te&&this._fire(te.pointerover,{evt:j,target:this,currentTarget:this})}_getTargetShape(j){let te=this[j+"targetShape"];return te&&!te.getStage()&&(te=null),te}_pointerleave(j){const te=ie(j.type),ve=Z(j.type);if(!te)return;this.setPointersPositions(j);const De=this._getTargetShape(ve),Ce=!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled;De&&Ce?(De._fireAndBubble(te.pointerout,{evt:j}),De._fireAndBubble(te.pointerleave,{evt:j}),this._fire(te.pointerleave,{evt:j,target:this,currentTarget:this}),this[ve+"targetShape"]=null):Ce&&(this._fire(te.pointerleave,{evt:j,target:this,currentTarget:this}),this._fire(te.pointerout,{evt:j,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(j){const te=ie(j.type),ve=Z(j.type);if(!te)return;this.setPointersPositions(j);let De=!1;this._changedPointerPositions.forEach(Ce=>{const Qe=this.getIntersection(Ce);if(o.DD.justDragged=!1,i.Konva["_"+ve+"ListenClick"]=!0,!Qe||!Qe.isListening()){this[ve+"ClickStartShape"]=void 0;return}i.Konva.capturePointerEventsEnabled&&Qe.setPointerCapture(Ce.id),this[ve+"ClickStartShape"]=Qe,Qe._fireAndBubble(te.pointerdown,{evt:j,pointerId:Ce.id}),De=!0;const lt=j.type.indexOf("touch")>=0;Qe.preventDefault()&&j.cancelable&&lt&&j.preventDefault()}),De||this._fire(te.pointerdown,{evt:j,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(j){const te=ie(j.type),ve=Z(j.type);if(!te||(i.Konva.isDragging()&&o.DD.node.preventDefault()&&j.cancelable&&j.preventDefault(),this.setPointersPositions(j),!(!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled)))return;const Ce={};let Qe=!1;const lt=this._getTargetShape(ve);this._changedPointerPositions.forEach(Kt=>{const Ge=c.getCapturedShape(Kt.id)||this.getIntersection(Kt),ur=Kt.id,Fr={evt:j,pointerId:ur},Fi=lt!==Ge;if(Fi&&lt&&(lt._fireAndBubble(te.pointerout,{...Fr},Ge),lt._fireAndBubble(te.pointerleave,{...Fr},Ge)),Ge){if(Ce[Ge._id])return;Ce[Ge._id]=!0}Ge&&Ge.isListening()?(Qe=!0,Fi&&(Ge._fireAndBubble(te.pointerover,{...Fr},lt),Ge._fireAndBubble(te.pointerenter,{...Fr},lt),this[ve+"targetShape"]=Ge),Ge._fireAndBubble(te.pointermove,{...Fr})):lt&&(this._fire(te.pointerover,{evt:j,target:this,currentTarget:this,pointerId:ur}),this[ve+"targetShape"]=null)}),Qe||this._fire(te.pointermove,{evt:j,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(j){const te=ie(j.type),ve=Z(j.type);if(!te)return;this.setPointersPositions(j);const De=this[ve+"ClickStartShape"],Ce=this[ve+"ClickEndShape"],Qe={};let lt=!1;this._changedPointerPositions.forEach(Kt=>{const Ge=c.getCapturedShape(Kt.id)||this.getIntersection(Kt);if(Ge){if(Ge.releaseCapture(Kt.id),Qe[Ge._id])return;Qe[Ge._id]=!0}const ur=Kt.id,Fr={evt:j,pointerId:ur};let Fi=!1;i.Konva["_"+ve+"InDblClickWindow"]?(Fi=!0,clearTimeout(this[ve+"DblTimeout"])):o.DD.justDragged||(i.Konva["_"+ve+"InDblClickWindow"]=!0,clearTimeout(this[ve+"DblTimeout"])),this[ve+"DblTimeout"]=setTimeout(function(){i.Konva["_"+ve+"InDblClickWindow"]=!1},i.Konva.dblClickWindow),Ge&&Ge.isListening()?(lt=!0,this[ve+"ClickEndShape"]=Ge,Ge._fireAndBubble(te.pointerup,{...Fr}),i.Konva["_"+ve+"ListenClick"]&&De&&De===Ge&&(Ge._fireAndBubble(te.pointerclick,{...Fr}),Fi&&Ce&&Ce===Ge&&Ge._fireAndBubble(te.pointerdblclick,{...Fr}))):(this[ve+"ClickEndShape"]=null,i.Konva["_"+ve+"ListenClick"]&&this._fire(te.pointerclick,{evt:j,target:this,currentTarget:this,pointerId:ur}),Fi&&this._fire(te.pointerdblclick,{evt:j,target:this,currentTarget:this,pointerId:ur}))}),lt||this._fire(te.pointerup,{evt:j,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),i.Konva["_"+ve+"ListenClick"]=!1,j.cancelable&&ve!=="touch"&&ve!=="pointer"&&j.preventDefault()}_contextmenu(j){this.setPointersPositions(j);const te=this.getIntersection(this.getPointerPosition());te&&te.isListening()?te._fireAndBubble(U,{evt:j}):this._fire(U,{evt:j,target:this,currentTarget:this})}_wheel(j){this.setPointersPositions(j);const te=this.getIntersection(this.getPointerPosition());te&&te.isListening()?te._fireAndBubble(be,{evt:j}):this._fire(be,{evt:j,target:this,currentTarget:this})}_pointercancel(j){this.setPointersPositions(j);const te=c.getCapturedShape(j.pointerId)||this.getIntersection(this.getPointerPosition());te&&te._fireAndBubble(V,c.createEvent(j)),c.releaseCapture(j.pointerId)}_lostpointercapture(j){c.releaseCapture(j.pointerId)}setPointersPositions(j){const te=this._getContentPosition();let ve=null,De=null;j=j||window.event,j.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(j.touches,Ce=>{this._pointerPositions.push({id:Ce.identifier,x:(Ce.clientX-te.left)/te.scaleX,y:(Ce.clientY-te.top)/te.scaleY})}),Array.prototype.forEach.call(j.changedTouches||j.touches,Ce=>{this._changedPointerPositions.push({id:Ce.identifier,x:(Ce.clientX-te.left)/te.scaleX,y:(Ce.clientY-te.top)/te.scaleY})})):(ve=(j.clientX-te.left)/te.scaleX,De=(j.clientY-te.top)/te.scaleY,this.pointerPos={x:ve,y:De},this._pointerPositions=[{x:ve,y:De,id:e.Util._getFirstPointerId(j)}],this._changedPointerPositions=[{x:ve,y:De,id:e.Util._getFirstPointerId(j)}])}_setPointerPosition(j){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(j)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const j=this.content.getBoundingClientRect();return{top:j.top,left:j.left,scaleX:j.width/this.content.clientWidth||1,scaleY:j.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new s.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new s.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!i.Konva.isBrowser)return;const j=this.container();if(!j)throw"Stage has no container. A container is required.";j.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),j.appendChild(this.content),this._resizeDOM()}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(j){j.batchDraw()}),this}}n.Stage=dt,dt.prototype.nodeType=h,(0,l._registerNode)(dt),t.Factory.addGetterSetter(dt,"container"),i.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{n.stages.forEach(Ve=>{Ve.batchDraw()})})})(ex);var Ef={},hn={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Shape=n.shapes=void 0;const e=Le,t=Vt,r=je,i=At,s=ke,o=Le,l=va,c="hasShadow",h="shadowRGBA",p="patternImage",m="linearGradient",_="radialGradient";let w;function S(){return w||(w=t.Util.createCanvasElement().getContext("2d"),w)}n.shapes={};function k(b){const A=this.attrs.fillRule;A?b.fill(A):b.fill()}function N(b){b.stroke()}function x(b){const A=this.attrs.fillRule;A?b.fill(A):b.fill()}function R(b){b.stroke()}function E(){this._clearCache(c)}function P(){this._clearCache(h)}function V(){this._clearCache(p)}function B(){this._clearCache(m)}function D(){this._clearCache(_)}class T extends i.Node{constructor(A){super(A);let O;for(;O=t.Util.getRandomColor(),!(O&&!(O in n.shapes)););this.colorKey=O,n.shapes[O]=this}getContext(){return t.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return t.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(c,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(p,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const O=S().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(O&&O.setTransform){const U=new t.Transform;U.translate(this.fillPatternX(),this.fillPatternY()),U.rotate(e.Konva.getAngle(this.fillPatternRotation())),U.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),U.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const F=U.getMatrix(),ce=typeof DOMMatrix>"u"?{a:F[0],b:F[1],c:F[2],d:F[3],e:F[4],f:F[5]}:new DOMMatrix(F);O.setTransform(ce)}return O}}_getLinearGradient(){return this._getCache(m,this.__getLinearGradient)}__getLinearGradient(){const A=this.fillLinearGradientColorStops();if(A){const O=S(),U=this.fillLinearGradientStartPoint(),F=this.fillLinearGradientEndPoint(),ce=O.createLinearGradient(U.x,U.y,F.x,F.y);for(let le=0;le<A.length;le+=2)ce.addColorStop(A[le],A[le+1]);return ce}}_getRadialGradient(){return this._getCache(_,this.__getRadialGradient)}__getRadialGradient(){const A=this.fillRadialGradientColorStops();if(A){const O=S(),U=this.fillRadialGradientStartPoint(),F=this.fillRadialGradientEndPoint(),ce=O.createRadialGradient(U.x,U.y,this.fillRadialGradientStartRadius(),F.x,F.y,this.fillRadialGradientEndRadius());for(let le=0;le<A.length;le+=2)ce.addColorStop(A[le],A[le+1]);return ce}}getShadowRGBA(){return this._getCache(h,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const A=t.Util.colorToRGBA(this.shadowColor());if(A)return"rgba("+A.r+","+A.g+","+A.b+","+A.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const A=this.hitStrokeWidth();return A==="auto"?this.hasStroke():this.strokeEnabled()&&!!A}intersects(A){const O=this.getStage();if(!O)return!1;const U=O.bufferHitCanvas;return U.getContext().clear(),this.drawHit(U,void 0,!0),U.context.getImageData(Math.round(A.x),Math.round(A.y),1,1).data[3]>0}destroy(){return i.Node.prototype.destroy.call(this),delete n.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(A){var O;if(!((O=this.attrs.perfectDrawEnabled)!==null&&O!==void 0?O:!0))return!1;const F=A||this.hasFill(),ce=this.hasStroke(),le=this.getAbsoluteOpacity()!==1;if(F&&ce&&le)return!0;const Me=this.hasShadow(),be=this.shadowForStrokeEnabled();return!!(F&&ce&&Me&&be)}setStrokeHitEnabled(A){t.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),A?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const A=this.size();return{x:this._centroid?-A.width/2:0,y:this._centroid?-A.height/2:0,width:A.width,height:A.height}}getClientRect(A={}){let O=!1,U=this.getParent();for(;U;){if(U.isCached()){O=!0;break}U=U.getParent()}const F=A.skipTransform,ce=A.relativeTo||O&&this.getStage()||void 0,le=this.getSelfRect(),be=!A.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,$=le.width+be,J=le.height+be,ee=!A.skipShadow&&this.hasShadow(),Z=ee?this.shadowOffsetX():0,ie=ee?this.shadowOffsetY():0,_e=$+Math.abs(Z),Tt=J+Math.abs(ie),dt=ee&&this.shadowBlur()||0,Ve=_e+dt*2,j=Tt+dt*2,te={width:Ve,height:j,x:-(be/2+dt)+Math.min(Z,0)+le.x,y:-(be/2+dt)+Math.min(ie,0)+le.y};return F?te:this._transformedRect(te,ce)}drawScene(A,O,U){const F=this.getLayer(),ce=A||F.getCanvas(),le=ce.getContext(),Me=this._getCanvasCache(),be=this.getSceneFunc(),$=this.hasShadow();let J;const ee=O===this;if(!this.isVisible()&&!ee)return this;if(Me){le.save();const Z=this.getAbsoluteTransform(O).getMatrix();return le.transform(Z[0],Z[1],Z[2],Z[3],Z[4],Z[5]),this._drawCachedSceneCanvas(le),le.restore(),this}if(!be)return this;if(le.save(),this._useBufferCanvas()){J=this.getStage();const Z=U||J.bufferCanvas,ie=Z.getContext();ie.clear(),ie.save(),ie._applyLineJoin(this);const _e=this.getAbsoluteTransform(O).getMatrix();ie.transform(_e[0],_e[1],_e[2],_e[3],_e[4],_e[5]),be.call(this,ie,this),ie.restore();const Tt=Z.pixelRatio;$&&le._applyShadow(this),le._applyOpacity(this),le._applyGlobalCompositeOperation(this),le.drawImage(Z._canvas,Z.x||0,Z.y||0,Z.width/Tt,Z.height/Tt)}else{if(le._applyLineJoin(this),!ee){const Z=this.getAbsoluteTransform(O).getMatrix();le.transform(Z[0],Z[1],Z[2],Z[3],Z[4],Z[5]),le._applyOpacity(this),le._applyGlobalCompositeOperation(this)}$&&le._applyShadow(this),be.call(this,le,this)}return le.restore(),this}drawHit(A,O,U=!1){if(!this.shouldDrawHit(O,U))return this;const F=this.getLayer(),ce=A||F.hitCanvas,le=ce&&ce.getContext(),Me=this.hitFunc()||this.sceneFunc(),be=this._getCanvasCache(),$=be&&be.hit;if(this.colorKey||t.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),$){le.save();const ee=this.getAbsoluteTransform(O).getMatrix();return le.transform(ee[0],ee[1],ee[2],ee[3],ee[4],ee[5]),this._drawCachedHitCanvas(le),le.restore(),this}if(!Me)return this;if(le.save(),le._applyLineJoin(this),!(this===O)){const ee=this.getAbsoluteTransform(O).getMatrix();le.transform(ee[0],ee[1],ee[2],ee[3],ee[4],ee[5])}return Me.call(this,le,this),le.restore(),this}drawHitFromCache(A=0){const O=this._getCanvasCache(),U=this._getCachedSceneCanvas(),F=O.hit,ce=F.getContext(),le=F.getWidth(),Me=F.getHeight();ce.clear(),ce.drawImage(U._canvas,0,0,le,Me);try{const be=ce.getImageData(0,0,le,Me),$=be.data,J=$.length,ee=t.Util._hexToRgb(this.colorKey);for(let Z=0;Z<J;Z+=4)$[Z+3]>A?($[Z]=ee.r,$[Z+1]=ee.g,$[Z+2]=ee.b,$[Z+3]=255):$[Z+3]=0;ce.putImageData(be,0,0)}catch(be){t.Util.error("Unable to draw hit graph from cached scene canvas. "+be.message)}return this}hasPointerCapture(A){return l.hasPointerCapture(A,this)}setPointerCapture(A){l.setPointerCapture(A,this)}releaseCapture(A){l.releaseCapture(A,this)}}n.Shape=T,T.prototype._fillFunc=k,T.prototype._strokeFunc=N,T.prototype._fillFuncHit=x,T.prototype._strokeFuncHit=R,T.prototype._centroid=!1,T.prototype.nodeType="Shape",(0,o._registerNode)(T),T.prototype.eventListeners={},T.prototype.on.call(T.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",E),T.prototype.on.call(T.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",P),T.prototype.on.call(T.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",V),T.prototype.on.call(T.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",B),T.prototype.on.call(T.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",D),r.Factory.addGetterSetter(T,"stroke",void 0,(0,s.getStringOrGradientValidator)()),r.Factory.addGetterSetter(T,"strokeWidth",2,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(T,"fillAfterStrokeEnabled",!1),r.Factory.addGetterSetter(T,"hitStrokeWidth","auto",(0,s.getNumberOrAutoValidator)()),r.Factory.addGetterSetter(T,"strokeHitEnabled",!0,(0,s.getBooleanValidator)()),r.Factory.addGetterSetter(T,"perfectDrawEnabled",!0,(0,s.getBooleanValidator)()),r.Factory.addGetterSetter(T,"shadowForStrokeEnabled",!0,(0,s.getBooleanValidator)()),r.Factory.addGetterSetter(T,"lineJoin"),r.Factory.addGetterSetter(T,"lineCap"),r.Factory.addGetterSetter(T,"sceneFunc"),r.Factory.addGetterSetter(T,"hitFunc"),r.Factory.addGetterSetter(T,"dash"),r.Factory.addGetterSetter(T,"dashOffset",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(T,"shadowColor",void 0,(0,s.getStringValidator)()),r.Factory.addGetterSetter(T,"shadowBlur",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(T,"shadowOpacity",1,(0,s.getNumberValidator)()),r.Factory.addComponentsGetterSetter(T,"shadowOffset",["x","y"]),r.Factory.addGetterSetter(T,"shadowOffsetX",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(T,"shadowOffsetY",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(T,"fillPatternImage"),r.Factory.addGetterSetter(T,"fill",void 0,(0,s.getStringOrGradientValidator)()),r.Factory.addGetterSetter(T,"fillPatternX",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(T,"fillPatternY",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(T,"fillLinearGradientColorStops"),r.Factory.addGetterSetter(T,"strokeLinearGradientColorStops"),r.Factory.addGetterSetter(T,"fillRadialGradientStartRadius",0),r.Factory.addGetterSetter(T,"fillRadialGradientEndRadius",0),r.Factory.addGetterSetter(T,"fillRadialGradientColorStops"),r.Factory.addGetterSetter(T,"fillPatternRepeat","repeat"),r.Factory.addGetterSetter(T,"fillEnabled",!0),r.Factory.addGetterSetter(T,"strokeEnabled",!0),r.Factory.addGetterSetter(T,"shadowEnabled",!0),r.Factory.addGetterSetter(T,"dashEnabled",!0),r.Factory.addGetterSetter(T,"strokeScaleEnabled",!0),r.Factory.addGetterSetter(T,"fillPriority","color"),r.Factory.addComponentsGetterSetter(T,"fillPatternOffset",["x","y"]),r.Factory.addGetterSetter(T,"fillPatternOffsetX",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(T,"fillPatternOffsetY",0,(0,s.getNumberValidator)()),r.Factory.addComponentsGetterSetter(T,"fillPatternScale",["x","y"]),r.Factory.addGetterSetter(T,"fillPatternScaleX",1,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(T,"fillPatternScaleY",1,(0,s.getNumberValidator)()),r.Factory.addComponentsGetterSetter(T,"fillLinearGradientStartPoint",["x","y"]),r.Factory.addComponentsGetterSetter(T,"strokeLinearGradientStartPoint",["x","y"]),r.Factory.addGetterSetter(T,"fillLinearGradientStartPointX",0),r.Factory.addGetterSetter(T,"strokeLinearGradientStartPointX",0),r.Factory.addGetterSetter(T,"fillLinearGradientStartPointY",0),r.Factory.addGetterSetter(T,"strokeLinearGradientStartPointY",0),r.Factory.addComponentsGetterSetter(T,"fillLinearGradientEndPoint",["x","y"]),r.Factory.addComponentsGetterSetter(T,"strokeLinearGradientEndPoint",["x","y"]),r.Factory.addGetterSetter(T,"fillLinearGradientEndPointX",0),r.Factory.addGetterSetter(T,"strokeLinearGradientEndPointX",0),r.Factory.addGetterSetter(T,"fillLinearGradientEndPointY",0),r.Factory.addGetterSetter(T,"strokeLinearGradientEndPointY",0),r.Factory.addComponentsGetterSetter(T,"fillRadialGradientStartPoint",["x","y"]),r.Factory.addGetterSetter(T,"fillRadialGradientStartPointX",0),r.Factory.addGetterSetter(T,"fillRadialGradientStartPointY",0),r.Factory.addComponentsGetterSetter(T,"fillRadialGradientEndPoint",["x","y"]),r.Factory.addGetterSetter(T,"fillRadialGradientEndPointX",0),r.Factory.addGetterSetter(T,"fillRadialGradientEndPointY",0),r.Factory.addGetterSetter(T,"fillPatternRotation",0),r.Factory.addGetterSetter(T,"fillRule",void 0,(0,s.getStringValidator)()),r.Factory.backCompat(T,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(hn);Object.defineProperty(Ef,"__esModule",{value:!0});Ef.Layer=void 0;const Rs=Vt,Pv=kl,au=At,dS=je,c5=bi,ej=ke,tj=hn,nj=Le,rj="#",ij="beforeDraw",sj="draw",rx=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],oj=rx.length;let kc=class extends Pv.Container{constructor(e){super(e),this.canvas=new c5.SceneCanvas,this.hitCanvas=new c5.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(e){return this.getContext().clear(e),this.getHitCanvas().getContext().clear(e),this}setZIndex(e){super.setZIndex(e);const t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),e<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[e+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){au.Node.prototype.moveToTop.call(this);const e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!au.Node.prototype.moveUp.call(this))return!1;const t=this.getStage();return!t||!t.content?!1:(t.content.removeChild(this.getNativeCanvasElement()),this.index<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[this.index+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(au.Node.prototype.moveDown.call(this)){const e=this.getStage();if(e){const t=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),t[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(au.Node.prototype.moveToBottom.call(this)){const e=this.getStage();if(e){const t=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),t[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const e=this.getNativeCanvasElement();return au.Node.prototype.remove.call(this),e&&e.parentNode&&Rs.Util._isInDocument(e)&&e.parentNode.removeChild(e),this}getStage(){return this.parent}setSize({width:e,height:t}){return this.canvas.setSize(e,t),this.hitCanvas.setSize(e,t),this._setSmoothEnabled(),this}_validateAdd(e){const t=e.getType();t!=="Group"&&t!=="Shape"&&Rs.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(e){return e=e||{},e.width=e.width||this.getWidth(),e.height=e.height||this.getHeight(),e.x=e.x!==void 0?e.x:this.x(),e.y=e.y!==void 0?e.y:this.y(),au.Node.prototype._toKonvaCanvas.call(this,e)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){Rs.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){Rs.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,Rs.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(e){if(!this.isListening()||!this.isVisible())return null;let t=1,r=!1;for(;;){for(let i=0;i<oj;i++){const s=rx[i],o=this._getIntersection({x:e.x+s.x*t,y:e.y+s.y*t}),l=o.shape;if(l)return l;if(r=!!o.antialiased,!o.antialiased)break}if(r)t+=1;else return null}}_getIntersection(e){const t=this.hitCanvas.pixelRatio,r=this.hitCanvas.context.getImageData(Math.round(e.x*t),Math.round(e.y*t),1,1).data,i=r[3];if(i===255){const s=Rs.Util._rgbToHex(r[0],r[1],r[2]),o=tj.shapes[rj+s];return o?{shape:o}:{antialiased:!0}}else if(i>0)return{antialiased:!0};return{}}drawScene(e,t,r){const i=this.getLayer(),s=e||i&&i.getCanvas();return this._fire(ij,{node:this}),this.clearBeforeDraw()&&s.getContext().clear(),Pv.Container.prototype.drawScene.call(this,s,t,r),this._fire(sj,{node:this}),this}drawHit(e,t){const r=this.getLayer(),i=e||r&&r.hitCanvas;return r&&r.clearBeforeDraw()&&r.getHitCanvas().getContext().clear(),Pv.Container.prototype.drawHit.call(this,i,t),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(e){Rs.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(e)}getHitGraphEnabled(e){return Rs.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const e=this.parent;!!this.hitCanvas._canvas.parentNode?e.content.removeChild(this.hitCanvas._canvas):e.content.appendChild(this.hitCanvas._canvas)}destroy(){return Rs.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};Ef.Layer=kc;kc.prototype.nodeType="Layer";(0,nj._registerNode)(kc);dS.Factory.addGetterSetter(kc,"imageSmoothingEnabled",!0);dS.Factory.addGetterSetter(kc,"clearBeforeDraw",!0);dS.Factory.addGetterSetter(kc,"hitGraphEnabled",!0,(0,ej.getBooleanValidator)());var H0={};Object.defineProperty(H0,"__esModule",{value:!0});H0.FastLayer=void 0;const aj=Vt,lj=Ef,uj=Le;class fS extends lj.Layer{constructor(e){super(e),this.listening(!1),aj.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}H0.FastLayer=fS;fS.prototype.nodeType="FastLayer";(0,uj._registerNode)(fS);var Rc={};Object.defineProperty(Rc,"__esModule",{value:!0});Rc.Group=void 0;const cj=Vt,hj=kl,dj=Le;let pS=class extends hj.Container{_validateAdd(e){const t=e.getType();t!=="Group"&&t!=="Shape"&&cj.Util.throw("You may only add groups and shapes to groups.")}};Rc.Group=pS;pS.prototype.nodeType="Group";(0,dj._registerNode)(pS);var xc={};Object.defineProperty(xc,"__esModule",{value:!0});xc.Animation=void 0;const kv=Le,h5=Vt,Rv=function(){return kv.glob.performance&&kv.glob.performance.now?function(){return kv.glob.performance.now()}:function(){return new Date().getTime()}}();class ns{constructor(e,t){this.id=ns.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:Rv(),frameRate:0},this.func=e,this.setLayers(t)}setLayers(e){let t=[];return e&&(t=Array.isArray(e)?e:[e]),this.layers=t,this}getLayers(){return this.layers}addLayer(e){const t=this.layers,r=t.length;for(let i=0;i<r;i++)if(t[i]._id===e._id)return!1;return this.layers.push(e),!0}isRunning(){const t=ns.animations,r=t.length;for(let i=0;i<r;i++)if(t[i].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=Rv(),ns._addAnimation(this),this}stop(){return ns._removeAnimation(this),this}_updateFrameObject(e){this.frame.timeDiff=e-this.frame.lastTime,this.frame.lastTime=e,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(e){this.animations.push(e),this._handleAnimation()}static _removeAnimation(e){const t=e.id,r=this.animations,i=r.length;for(let s=0;s<i;s++)if(r[s].id===t){this.animations.splice(s,1);break}}static _runFrames(){const e={},t=this.animations;for(let r=0;r<t.length;r++){const i=t[r],s=i.layers,o=i.func;i._updateFrameObject(Rv());const l=s.length;let c;if(o?c=o.call(i,i.frame)!==!1:c=!0,!!c)for(let h=0;h<l;h++){const p=s[h];p._id!==void 0&&(e[p._id]=p)}}for(const r in e)e.hasOwnProperty(r)&&e[r].batchDraw()}static _animationLoop(){const e=ns;e.animations.length?(e._runFrames(),h5.Util.requestAnimFrame(e._animationLoop)):e.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,h5.Util.requestAnimFrame(this._animationLoop))}}xc.Animation=ns;ns.animations=[];ns.animIdCounter=0;ns.animRunning=!1;var ix={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Easings=n.Tween=void 0;const e=Vt,t=xc,r=At,i=Le,s={node:1,duration:1,easing:1,onFinish:1,yoyo:1},o=1,l=2,c=3,h=["fill","stroke","shadowColor"];let p=0;class m{constructor(S,k,N,x,R,E,P){this.prop=S,this.propFunc=k,this.begin=x,this._pos=x,this.duration=E,this._change=0,this.prevPos=0,this.yoyo=P,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=N,this._change=R-this.begin,this.pause()}fire(S){const k=this[S];k&&k()}setTime(S){S>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():S<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=S,this.update())}getTime(){return this._time}setPosition(S){this.prevPos=this._pos,this.propFunc(S),this._pos=S}getPosition(S){return S===void 0&&(S=this._time),this.func(S,this.begin,this._change,this.duration)}play(){this.state=l,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=c,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(S){this.pause(),this._time=S,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const S=this.getTimer()-this._startTime;this.state===l?this.setTime(S):this.state===c&&this.setTime(this.duration-S)}pause(){this.state=o,this.fire("onPause")}getTimer(){return new Date().getTime()}}class _{constructor(S){const k=this,N=S.node,x=N._id,R=S.easing||n.Easings.Linear,E=!!S.yoyo;let P,V;typeof S.duration>"u"?P=.3:S.duration===0?P=.001:P=S.duration,this.node=N,this._id=p++;const B=N.getLayer()||(N instanceof i.Konva.Stage?N.getLayers():null);B||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new t.Animation(function(){k.tween.onEnterFrame()},B),this.tween=new m(V,function(D){k._tweenFunc(D)},R,0,1,P*1e3,E),this._addListeners(),_.attrs[x]||(_.attrs[x]={}),_.attrs[x][this._id]||(_.attrs[x][this._id]={}),_.tweens[x]||(_.tweens[x]={});for(V in S)s[V]===void 0&&this._addAttr(V,S[V]);this.reset(),this.onFinish=S.onFinish,this.onReset=S.onReset,this.onUpdate=S.onUpdate}_addAttr(S,k){const N=this.node,x=N._id;let R,E,P,V,B;const D=_.tweens[x][S];D&&delete _.attrs[x][D][S];let T=N.getAttr(S);if(e.Util._isArray(k))if(R=[],E=Math.max(k.length,T.length),S==="points"&&k.length!==T.length&&(k.length>T.length?(V=T,T=e.Util._prepareArrayForTween(T,k,N.closed())):(P=k,k=e.Util._prepareArrayForTween(k,T,N.closed()))),S.indexOf("fill")===0)for(let b=0;b<E;b++)if(b%2===0)R.push(k[b]-T[b]);else{const A=e.Util.colorToRGBA(T[b]);B=e.Util.colorToRGBA(k[b]),T[b]=A,R.push({r:B.r-A.r,g:B.g-A.g,b:B.b-A.b,a:B.a-A.a})}else for(let b=0;b<E;b++)R.push(k[b]-T[b]);else h.indexOf(S)!==-1?(T=e.Util.colorToRGBA(T),B=e.Util.colorToRGBA(k),R={r:B.r-T.r,g:B.g-T.g,b:B.b-T.b,a:B.a-T.a}):R=k-T;_.attrs[x][this._id][S]={start:T,diff:R,end:k,trueEnd:P,trueStart:V},_.tweens[x][S]=this._id}_tweenFunc(S){const k=this.node,N=_.attrs[k._id][this._id];let x,R,E,P,V,B,D,T;for(x in N){if(R=N[x],E=R.start,P=R.diff,T=R.end,e.Util._isArray(E))if(V=[],D=Math.max(E.length,T.length),x.indexOf("fill")===0)for(B=0;B<D;B++)B%2===0?V.push((E[B]||0)+P[B]*S):V.push("rgba("+Math.round(E[B].r+P[B].r*S)+","+Math.round(E[B].g+P[B].g*S)+","+Math.round(E[B].b+P[B].b*S)+","+(E[B].a+P[B].a*S)+")");else for(B=0;B<D;B++)V.push((E[B]||0)+P[B]*S);else h.indexOf(x)!==-1?V="rgba("+Math.round(E.r+P.r*S)+","+Math.round(E.g+P.g*S)+","+Math.round(E.b+P.b*S)+","+(E.a+P.a*S)+")":V=E+P*S;k.setAttr(x,V)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const S=this.node,k=_.attrs[S._id][this._id];k.points&&k.points.trueEnd&&S.setAttr("points",k.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const S=this.node,k=_.attrs[S._id][this._id];k.points&&k.points.trueStart&&S.points(k.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(S){return this.tween.seek(S*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const S=this.node._id,k=this._id,N=_.tweens[S];this.pause(),this.anim&&this.anim.stop();for(const x in N)delete _.tweens[S][x];delete _.attrs[S][k],_.tweens[S]&&(Object.keys(_.tweens[S]).length===0&&delete _.tweens[S],Object.keys(_.attrs[S]).length===0&&delete _.attrs[S])}}n.Tween=_,_.attrs={},_.tweens={},r.Node.prototype.to=function(w){const S=w.onFinish;w.node=this,w.onFinish=function(){this.destroy(),S&&S()},new _(w).play()},n.Easings={BackEaseIn(w,S,k,N){return k*(w/=N)*w*((1.70158+1)*w-1.70158)+S},BackEaseOut(w,S,k,N){return k*((w=w/N-1)*w*((1.70158+1)*w+1.70158)+1)+S},BackEaseInOut(w,S,k,N){let x=1.70158;return(w/=N/2)<1?k/2*(w*w*(((x*=1.525)+1)*w-x))+S:k/2*((w-=2)*w*(((x*=1.525)+1)*w+x)+2)+S},ElasticEaseIn(w,S,k,N,x,R){let E=0;return w===0?S:(w/=N)===1?S+k:(R||(R=N*.3),!x||x<Math.abs(k)?(x=k,E=R/4):E=R/(2*Math.PI)*Math.asin(k/x),-(x*Math.pow(2,10*(w-=1))*Math.sin((w*N-E)*(2*Math.PI)/R))+S)},ElasticEaseOut(w,S,k,N,x,R){let E=0;return w===0?S:(w/=N)===1?S+k:(R||(R=N*.3),!x||x<Math.abs(k)?(x=k,E=R/4):E=R/(2*Math.PI)*Math.asin(k/x),x*Math.pow(2,-10*w)*Math.sin((w*N-E)*(2*Math.PI)/R)+k+S)},ElasticEaseInOut(w,S,k,N,x,R){let E=0;return w===0?S:(w/=N/2)===2?S+k:(R||(R=N*(.3*1.5)),!x||x<Math.abs(k)?(x=k,E=R/4):E=R/(2*Math.PI)*Math.asin(k/x),w<1?-.5*(x*Math.pow(2,10*(w-=1))*Math.sin((w*N-E)*(2*Math.PI)/R))+S:x*Math.pow(2,-10*(w-=1))*Math.sin((w*N-E)*(2*Math.PI)/R)*.5+k+S)},BounceEaseOut(w,S,k,N){return(w/=N)<1/2.75?k*(7.5625*w*w)+S:w<2/2.75?k*(7.5625*(w-=1.5/2.75)*w+.75)+S:w<2.5/2.75?k*(7.5625*(w-=2.25/2.75)*w+.9375)+S:k*(7.5625*(w-=2.625/2.75)*w+.984375)+S},BounceEaseIn(w,S,k,N){return k-n.Easings.BounceEaseOut(N-w,0,k,N)+S},BounceEaseInOut(w,S,k,N){return w<N/2?n.Easings.BounceEaseIn(w*2,0,k,N)*.5+S:n.Easings.BounceEaseOut(w*2-N,0,k,N)*.5+k*.5+S},EaseIn(w,S,k,N){return k*(w/=N)*w+S},EaseOut(w,S,k,N){return-k*(w/=N)*(w-2)+S},EaseInOut(w,S,k,N){return(w/=N/2)<1?k/2*w*w+S:-k/2*(--w*(w-2)-1)+S},StrongEaseIn(w,S,k,N){return k*(w/=N)*w*w*w*w+S},StrongEaseOut(w,S,k,N){return k*((w=w/N-1)*w*w*w*w+1)+S},StrongEaseInOut(w,S,k,N){return(w/=N/2)<1?k/2*w*w*w*w*w+S:k/2*((w-=2)*w*w*w*w+2)+S},Linear(w,S,k,N){return k*w/N+S}}})(ix);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Konva=void 0;const e=Le,t=Vt,r=At,i=kl,s=ex,o=Ef,l=H0,c=Rc,h=G0,p=hn,m=xc,_=ix,w=Ws,S=bi;n.Konva=t.Util._assign(e.Konva,{Util:t.Util,Transform:t.Transform,Node:r.Node,Container:i.Container,Stage:s.Stage,stages:s.stages,Layer:o.Layer,FastLayer:l.FastLayer,Group:c.Group,DD:h.DD,Shape:p.Shape,shapes:p.shapes,Animation:m.Animation,Tween:_.Tween,Easings:_.Easings,Context:w.Context,Canvas:S.Canvas}),n.default=n.Konva})(Dm);var $0={};Object.defineProperty($0,"__esModule",{value:!0});$0.Arc=void 0;const q0=je,fj=hn,d5=Le,K0=ke,pj=Le;class io extends fj.Shape{_sceneFunc(e){const t=d5.Konva.getAngle(this.angle()),r=this.clockwise();e.beginPath(),e.arc(0,0,this.outerRadius(),0,t,r),e.arc(0,0,this.innerRadius(),t,0,!r),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}getSelfRect(){const e=this.innerRadius(),t=this.outerRadius(),r=this.clockwise(),i=d5.Konva.getAngle(r?360-this.angle():this.angle()),s=Math.cos(Math.min(i,Math.PI)),o=1,l=Math.sin(Math.min(Math.max(Math.PI,i),3*Math.PI/2)),c=Math.sin(Math.min(i,Math.PI/2)),h=s*(s>0?e:t),p=o*t,m=l*(l>0?e:t),_=c*(c>0?t:e);return{x:h,y:r?-1*_:m,width:p-h,height:_-m}}}$0.Arc=io;io.prototype._centroid=!0;io.prototype.className="Arc";io.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];(0,pj._registerNode)(io);q0.Factory.addGetterSetter(io,"innerRadius",0,(0,K0.getNumberValidator)());q0.Factory.addGetterSetter(io,"outerRadius",0,(0,K0.getNumberValidator)());q0.Factory.addGetterSetter(io,"angle",0,(0,K0.getNumberValidator)());q0.Factory.addGetterSetter(io,"clockwise",!1,(0,K0.getBooleanValidator)());var Q0={},Sf={};Object.defineProperty(Sf,"__esModule",{value:!0});Sf.Line=void 0;const Y0=je,gj=Le,mj=hn,sx=ke;function P2(n,e,t,r,i,s,o){const l=Math.sqrt(Math.pow(t-n,2)+Math.pow(r-e,2)),c=Math.sqrt(Math.pow(i-t,2)+Math.pow(s-r,2)),h=o*l/(l+c),p=o*c/(l+c),m=t-h*(i-n),_=r-h*(s-e),w=t+p*(i-n),S=r+p*(s-e);return[m,_,w,S]}function f5(n,e){const t=n.length,r=[];for(let i=2;i<t-2;i+=2){const s=P2(n[i-2],n[i-1],n[i],n[i+1],n[i+2],n[i+3],e);isNaN(s[0])||(r.push(s[0]),r.push(s[1]),r.push(n[i]),r.push(n[i+1]),r.push(s[2]),r.push(s[3]))}return r}let wa=class extends mj.Shape{constructor(e){super(e),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(e){const t=this.points(),r=t.length,i=this.tension(),s=this.closed(),o=this.bezier();if(!r)return;let l=0;if(e.beginPath(),e.moveTo(t[0],t[1]),i!==0&&r>4){const c=this.getTensionPoints(),h=c.length;for(l=s?0:4,s||e.quadraticCurveTo(c[0],c[1],c[2],c[3]);l<h-2;)e.bezierCurveTo(c[l++],c[l++],c[l++],c[l++],c[l++],c[l++]);s||e.quadraticCurveTo(c[h-2],c[h-1],t[r-2],t[r-1])}else if(o)for(l=2;l<r;)e.bezierCurveTo(t[l++],t[l++],t[l++],t[l++],t[l++],t[l++]);else for(l=2;l<r;l+=2)e.lineTo(t[l],t[l+1]);s?(e.closePath(),e.fillStrokeShape(this)):e.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():f5(this.points(),this.tension())}_getTensionPointsClosed(){const e=this.points(),t=e.length,r=this.tension(),i=P2(e[t-2],e[t-1],e[0],e[1],e[2],e[3],r),s=P2(e[t-4],e[t-3],e[t-2],e[t-1],e[0],e[1],r),o=f5(e,r);return[i[2],i[3]].concat(o).concat([s[0],s[1],e[t-2],e[t-1],s[2],s[3],i[0],i[1],e[0],e[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let e=this.points();if(e.length<4)return{x:e[0]||0,y:e[1]||0,width:0,height:0};this.tension()!==0?e=[e[0],e[1],...this._getTensionPoints(),e[e.length-2],e[e.length-1]]:e=this.points();let t=e[0],r=e[0],i=e[1],s=e[1],o,l;for(let c=0;c<e.length/2;c++)o=e[c*2],l=e[c*2+1],t=Math.min(t,o),r=Math.max(r,o),i=Math.min(i,l),s=Math.max(s,l);return{x:t,y:i,width:r-t,height:s-i}}};Sf.Line=wa;wa.prototype.className="Line";wa.prototype._attrsAffectingSize=["points","bezier","tension"];(0,gj._registerNode)(wa);Y0.Factory.addGetterSetter(wa,"closed",!1);Y0.Factory.addGetterSetter(wa,"bezier",!1);Y0.Factory.addGetterSetter(wa,"tension",0,(0,sx.getNumberValidator)());Y0.Factory.addGetterSetter(wa,"points",[],(0,sx.getNumberArrayValidator)());var Ac={},ox={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.t2length=n.getQuadraticArcLength=n.getCubicArcLength=n.binomialCoefficients=n.cValues=n.tValues=void 0,n.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],n.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],n.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(o,l,c)=>{let h,p;const _=c/2;h=0;for(let w=0;w<20;w++)p=_*n.tValues[20][w]+_,h+=n.cValues[20][w]*r(o,l,p);return _*h};n.getCubicArcLength=e;const t=(o,l,c)=>{c===void 0&&(c=1);const h=o[0]-2*o[1]+o[2],p=l[0]-2*l[1]+l[2],m=2*o[1]-2*o[0],_=2*l[1]-2*l[0],w=4*(h*h+p*p),S=4*(h*m+p*_),k=m*m+_*_;if(w===0)return c*Math.sqrt(Math.pow(o[2]-o[0],2)+Math.pow(l[2]-l[0],2));const N=S/(2*w),x=k/w,R=c+N,E=x-N*N,P=R*R+E>0?Math.sqrt(R*R+E):0,V=N*N+E>0?Math.sqrt(N*N+E):0,B=N+Math.sqrt(N*N+E)!==0?E*Math.log(Math.abs((R+P)/(N+V))):0;return Math.sqrt(w)/2*(R*P-N*V+B)};n.getQuadraticArcLength=t;function r(o,l,c){const h=i(1,c,o),p=i(1,c,l),m=h*h+p*p;return Math.sqrt(m)}const i=(o,l,c)=>{const h=c.length-1;let p,m;if(h===0)return 0;if(o===0){m=0;for(let _=0;_<=h;_++)m+=n.binomialCoefficients[h][_]*Math.pow(1-l,h-_)*Math.pow(l,_)*c[_];return m}else{p=new Array(h);for(let _=0;_<h;_++)p[_]=h*(c[_+1]-c[_]);return i(o-1,l,p)}},s=(o,l,c)=>{let h=1,p=o/l,m=(o-c(p))/l,_=0;for(;h>.001;){const w=c(p+m),S=Math.abs(o-w)/l;if(S<h)h=S,p+=m;else{const k=c(p-m),N=Math.abs(o-k)/l;N<h?(h=N,p-=m):m/=2}if(_++,_>500)break}return p};n.t2length=s})(ox);Object.defineProperty(Ac,"__esModule",{value:!0});Ac.Path=void 0;const _j=je,yj=Le,vj=hn,lu=ox;class an extends vj.Shape{constructor(e){super(e),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=an.parsePathData(this.data()),this.pathLength=an.getPathLength(this.dataArray)}_sceneFunc(e){const t=this.dataArray;e.beginPath();let r=!1;for(let i=0;i<t.length;i++){const s=t[i].command,o=t[i].points;switch(s){case"L":e.lineTo(o[0],o[1]);break;case"M":e.moveTo(o[0],o[1]);break;case"C":e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]);break;case"Q":e.quadraticCurveTo(o[0],o[1],o[2],o[3]);break;case"A":const l=o[0],c=o[1],h=o[2],p=o[3],m=o[4],_=o[5],w=o[6],S=o[7],k=h>p?h:p,N=h>p?1:h/p,x=h>p?p/h:1;e.translate(l,c),e.rotate(w),e.scale(N,x),e.arc(0,0,k,m,m+_,1-S),e.scale(1/N,1/x),e.rotate(-w),e.translate(-l,-c);break;case"z":r=!0,e.closePath();break}}!r&&!this.hasFill()?e.strokeShape(this):e.fillStrokeShape(this)}getSelfRect(){let e=[];this.dataArray.forEach(function(c){if(c.command==="A"){const h=c.points[4],p=c.points[5],m=c.points[4]+p;let _=Math.PI/180;if(Math.abs(h-m)<_&&(_=Math.abs(h-m)),p<0)for(let w=h-_;w>m;w-=_){const S=an.getPointOnEllipticalArc(c.points[0],c.points[1],c.points[2],c.points[3],w,0);e.push(S.x,S.y)}else for(let w=h+_;w<m;w+=_){const S=an.getPointOnEllipticalArc(c.points[0],c.points[1],c.points[2],c.points[3],w,0);e.push(S.x,S.y)}}else if(c.command==="C")for(let h=0;h<=1;h+=.01){const p=an.getPointOnCubicBezier(h,c.start.x,c.start.y,c.points[0],c.points[1],c.points[2],c.points[3],c.points[4],c.points[5]);e.push(p.x,p.y)}else e=e.concat(c.points)});let t=e[0],r=e[0],i=e[1],s=e[1],o,l;for(let c=0;c<e.length/2;c++)o=e[c*2],l=e[c*2+1],isNaN(o)||(t=Math.min(t,o),r=Math.max(r,o)),isNaN(l)||(i=Math.min(i,l),s=Math.max(s,l));return{x:t,y:i,width:r-t,height:s-i}}getLength(){return this.pathLength}getPointAtLength(e){return an.getPointAtLengthOfDataArray(e,this.dataArray)}static getLineLength(e,t,r,i){return Math.sqrt((r-e)*(r-e)+(i-t)*(i-t))}static getPathLength(e){let t=0;for(let r=0;r<e.length;++r)t+=e[r].pathLength;return t}static getPointAtLengthOfDataArray(e,t){let r,i=0,s=t.length;if(!s)return null;for(;i<s&&e>t[i].pathLength;)e-=t[i].pathLength,++i;if(i===s)return r=t[i-1].points.slice(-2),{x:r[0],y:r[1]};if(e<.01)return t[i].command==="M"?(r=t[i].points.slice(0,2),{x:r[0],y:r[1]}):{x:t[i].start.x,y:t[i].start.y};const o=t[i],l=o.points;switch(o.command){case"L":return an.getPointOnLine(e,o.start.x,o.start.y,l[0],l[1]);case"C":return an.getPointOnCubicBezier((0,lu.t2length)(e,an.getPathLength(t),k=>(0,lu.getCubicArcLength)([o.start.x,l[0],l[2],l[4]],[o.start.y,l[1],l[3],l[5]],k)),o.start.x,o.start.y,l[0],l[1],l[2],l[3],l[4],l[5]);case"Q":return an.getPointOnQuadraticBezier((0,lu.t2length)(e,an.getPathLength(t),k=>(0,lu.getQuadraticArcLength)([o.start.x,l[0],l[2]],[o.start.y,l[1],l[3]],k)),o.start.x,o.start.y,l[0],l[1],l[2],l[3]);case"A":const c=l[0],h=l[1],p=l[2],m=l[3],_=l[5],w=l[6];let S=l[4];return S+=_*e/o.pathLength,an.getPointOnEllipticalArc(c,h,p,m,S,w)}return null}static getPointOnLine(e,t,r,i,s,o,l){o=o??t,l=l??r;const c=this.getLineLength(t,r,i,s);if(c<1e-10)return{x:t,y:r};if(i===t)return{x:o,y:l+(s>r?e:-e)};const h=(s-r)/(i-t),p=Math.sqrt(e*e/(1+h*h))*(i<t?-1:1),m=h*p;if(Math.abs(l-r-h*(o-t))<1e-10)return{x:o+p,y:l+m};const _=((o-t)*(i-t)+(l-r)*(s-r))/(c*c),w=t+_*(i-t),S=r+_*(s-r),k=this.getLineLength(o,l,w,S),N=Math.sqrt(e*e-k*k),x=Math.sqrt(N*N/(1+h*h))*(i<t?-1:1),R=h*x;return{x:w+x,y:S+R}}static getPointOnCubicBezier(e,t,r,i,s,o,l,c,h){function p(N){return N*N*N}function m(N){return 3*N*N*(1-N)}function _(N){return 3*N*(1-N)*(1-N)}function w(N){return(1-N)*(1-N)*(1-N)}const S=c*p(e)+o*m(e)+i*_(e)+t*w(e),k=h*p(e)+l*m(e)+s*_(e)+r*w(e);return{x:S,y:k}}static getPointOnQuadraticBezier(e,t,r,i,s,o,l){function c(w){return w*w}function h(w){return 2*w*(1-w)}function p(w){return(1-w)*(1-w)}const m=o*c(e)+i*h(e)+t*p(e),_=l*c(e)+s*h(e)+r*p(e);return{x:m,y:_}}static getPointOnEllipticalArc(e,t,r,i,s,o){const l=Math.cos(o),c=Math.sin(o),h={x:r*Math.cos(s),y:i*Math.sin(s)};return{x:e+(h.x*l-h.y*c),y:t+(h.x*c+h.y*l)}}static parsePathData(e){if(!e)return[];let t=e;const r=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];t=t.replace(new RegExp(" ","g"),",");for(let m=0;m<r.length;m++)t=t.replace(new RegExp(r[m],"g"),"|"+r[m]);const i=t.split("|"),s=[],o=[];let l=0,c=0;const h=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let p;for(let m=1;m<i.length;m++){let _=i[m],w=_.charAt(0);for(_=_.slice(1),o.length=0;p=h.exec(_);)o.push(p[0]);const S=[];for(let k=0,N=o.length;k<N;k++){if(o[k]==="00"){S.push(0,0);continue}const x=parseFloat(o[k]);isNaN(x)?S.push(0):S.push(x)}for(;S.length>0&&!isNaN(S[0]);){let k="",N=[];const x=l,R=c;let E,P,V,B,D,T,b,A,O,U;switch(w){case"l":l+=S.shift(),c+=S.shift(),k="L",N.push(l,c);break;case"L":l=S.shift(),c=S.shift(),N.push(l,c);break;case"m":const F=S.shift(),ce=S.shift();if(l+=F,c+=ce,k="M",s.length>2&&s[s.length-1].command==="z"){for(let le=s.length-2;le>=0;le--)if(s[le].command==="M"){l=s[le].points[0]+F,c=s[le].points[1]+ce;break}}N.push(l,c),w="l";break;case"M":l=S.shift(),c=S.shift(),k="M",N.push(l,c),w="L";break;case"h":l+=S.shift(),k="L",N.push(l,c);break;case"H":l=S.shift(),k="L",N.push(l,c);break;case"v":c+=S.shift(),k="L",N.push(l,c);break;case"V":c=S.shift(),k="L",N.push(l,c);break;case"C":N.push(S.shift(),S.shift(),S.shift(),S.shift()),l=S.shift(),c=S.shift(),N.push(l,c);break;case"c":N.push(l+S.shift(),c+S.shift(),l+S.shift(),c+S.shift()),l+=S.shift(),c+=S.shift(),k="C",N.push(l,c);break;case"S":P=l,V=c,E=s[s.length-1],E.command==="C"&&(P=l+(l-E.points[2]),V=c+(c-E.points[3])),N.push(P,V,S.shift(),S.shift()),l=S.shift(),c=S.shift(),k="C",N.push(l,c);break;case"s":P=l,V=c,E=s[s.length-1],E.command==="C"&&(P=l+(l-E.points[2]),V=c+(c-E.points[3])),N.push(P,V,l+S.shift(),c+S.shift()),l+=S.shift(),c+=S.shift(),k="C",N.push(l,c);break;case"Q":N.push(S.shift(),S.shift()),l=S.shift(),c=S.shift(),N.push(l,c);break;case"q":N.push(l+S.shift(),c+S.shift()),l+=S.shift(),c+=S.shift(),k="Q",N.push(l,c);break;case"T":P=l,V=c,E=s[s.length-1],E.command==="Q"&&(P=l+(l-E.points[0]),V=c+(c-E.points[1])),l=S.shift(),c=S.shift(),k="Q",N.push(P,V,l,c);break;case"t":P=l,V=c,E=s[s.length-1],E.command==="Q"&&(P=l+(l-E.points[0]),V=c+(c-E.points[1])),l+=S.shift(),c+=S.shift(),k="Q",N.push(P,V,l,c);break;case"A":B=S.shift(),D=S.shift(),T=S.shift(),b=S.shift(),A=S.shift(),O=l,U=c,l=S.shift(),c=S.shift(),k="A",N=this.convertEndpointToCenterParameterization(O,U,l,c,b,A,B,D,T);break;case"a":B=S.shift(),D=S.shift(),T=S.shift(),b=S.shift(),A=S.shift(),O=l,U=c,l+=S.shift(),c+=S.shift(),k="A",N=this.convertEndpointToCenterParameterization(O,U,l,c,b,A,B,D,T);break}s.push({command:k||w,points:N,start:{x,y:R},pathLength:this.calcLength(x,R,k||w,N)})}(w==="z"||w==="Z")&&s.push({command:"z",points:[],start:void 0,pathLength:0})}return s}static calcLength(e,t,r,i){let s,o,l,c;const h=an;switch(r){case"L":return h.getLineLength(e,t,i[0],i[1]);case"C":return(0,lu.getCubicArcLength)([e,i[0],i[2],i[4]],[t,i[1],i[3],i[5]],1);case"Q":return(0,lu.getQuadraticArcLength)([e,i[0],i[2]],[t,i[1],i[3]],1);case"A":s=0;const p=i[4],m=i[5],_=i[4]+m;let w=Math.PI/180;if(Math.abs(p-_)<w&&(w=Math.abs(p-_)),o=h.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],p,0),m<0)for(c=p-w;c>_;c-=w)l=h.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],c,0),s+=h.getLineLength(o.x,o.y,l.x,l.y),o=l;else for(c=p+w;c<_;c+=w)l=h.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],c,0),s+=h.getLineLength(o.x,o.y,l.x,l.y),o=l;return l=h.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],_,0),s+=h.getLineLength(o.x,o.y,l.x,l.y),s}return 0}static convertEndpointToCenterParameterization(e,t,r,i,s,o,l,c,h){const p=h*(Math.PI/180),m=Math.cos(p)*(e-r)/2+Math.sin(p)*(t-i)/2,_=-1*Math.sin(p)*(e-r)/2+Math.cos(p)*(t-i)/2,w=m*m/(l*l)+_*_/(c*c);w>1&&(l*=Math.sqrt(w),c*=Math.sqrt(w));let S=Math.sqrt((l*l*(c*c)-l*l*(_*_)-c*c*(m*m))/(l*l*(_*_)+c*c*(m*m)));s===o&&(S*=-1),isNaN(S)&&(S=0);const k=S*l*_/c,N=S*-c*m/l,x=(e+r)/2+Math.cos(p)*k-Math.sin(p)*N,R=(t+i)/2+Math.sin(p)*k+Math.cos(p)*N,E=function(A){return Math.sqrt(A[0]*A[0]+A[1]*A[1])},P=function(A,O){return(A[0]*O[0]+A[1]*O[1])/(E(A)*E(O))},V=function(A,O){return(A[0]*O[1]<A[1]*O[0]?-1:1)*Math.acos(P(A,O))},B=V([1,0],[(m-k)/l,(_-N)/c]),D=[(m-k)/l,(_-N)/c],T=[(-1*m-k)/l,(-1*_-N)/c];let b=V(D,T);return P(D,T)<=-1&&(b=Math.PI),P(D,T)>=1&&(b=0),o===0&&b>0&&(b=b-2*Math.PI),o===1&&b<0&&(b=b+2*Math.PI),[x,R,l,c,B,b,p,o]}}Ac.Path=an;an.prototype.className="Path";an.prototype._attrsAffectingSize=["data"];(0,yj._registerNode)(an);_j.Factory.addGetterSetter(an,"data");Object.defineProperty(Q0,"__esModule",{value:!0});Q0.Arrow=void 0;const X0=je,wj=Sf,ax=ke,Ej=Le,p5=Ac;class xl extends wj.Line{_sceneFunc(e){super._sceneFunc(e);const t=Math.PI*2,r=this.points();let i=r;const s=this.tension()!==0&&r.length>4;s&&(i=this.getTensionPoints());const o=this.pointerLength(),l=r.length;let c,h;if(s){const _=[i[i.length-4],i[i.length-3],i[i.length-2],i[i.length-1],r[l-2],r[l-1]],w=p5.Path.calcLength(i[i.length-4],i[i.length-3],"C",_),S=p5.Path.getPointOnQuadraticBezier(Math.min(1,1-o/w),_[0],_[1],_[2],_[3],_[4],_[5]);c=r[l-2]-S.x,h=r[l-1]-S.y}else c=r[l-2]-r[l-4],h=r[l-1]-r[l-3];const p=(Math.atan2(h,c)+t)%t,m=this.pointerWidth();this.pointerAtEnding()&&(e.save(),e.beginPath(),e.translate(r[l-2],r[l-1]),e.rotate(p),e.moveTo(0,0),e.lineTo(-o,m/2),e.lineTo(-o,-m/2),e.closePath(),e.restore(),this.__fillStroke(e)),this.pointerAtBeginning()&&(e.save(),e.beginPath(),e.translate(r[0],r[1]),s?(c=(i[0]+i[2])/2-r[0],h=(i[1]+i[3])/2-r[1]):(c=r[2]-r[0],h=r[3]-r[1]),e.rotate((Math.atan2(-h,-c)+t)%t),e.moveTo(0,0),e.lineTo(-o,m/2),e.lineTo(-o,-m/2),e.closePath(),e.restore(),this.__fillStroke(e))}__fillStroke(e){const t=this.dashEnabled();t&&(this.attrs.dashEnabled=!1,e.setLineDash([])),e.fillStrokeShape(this),t&&(this.attrs.dashEnabled=!0)}getSelfRect(){const e=super.getSelfRect(),t=this.pointerWidth()/2;return{x:e.x,y:e.y-t,width:e.width,height:e.height+t*2}}}Q0.Arrow=xl;xl.prototype.className="Arrow";(0,Ej._registerNode)(xl);X0.Factory.addGetterSetter(xl,"pointerLength",10,(0,ax.getNumberValidator)());X0.Factory.addGetterSetter(xl,"pointerWidth",10,(0,ax.getNumberValidator)());X0.Factory.addGetterSetter(xl,"pointerAtBeginning",!1);X0.Factory.addGetterSetter(xl,"pointerAtEnding",!0);var J0={};Object.defineProperty(J0,"__esModule",{value:!0});J0.Circle=void 0;const Sj=je,Cj=hn,Tj=ke,Ij=Le;let Nc=class extends Cj.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius()!==e/2&&this.radius(e/2)}setHeight(e){this.radius()!==e/2&&this.radius(e/2)}};J0.Circle=Nc;Nc.prototype._centroid=!0;Nc.prototype.className="Circle";Nc.prototype._attrsAffectingSize=["radius"];(0,Ij._registerNode)(Nc);Sj.Factory.addGetterSetter(Nc,"radius",0,(0,Tj.getNumberValidator)());var Z0={};Object.defineProperty(Z0,"__esModule",{value:!0});Z0.Ellipse=void 0;const gS=je,Pj=hn,lx=ke,kj=Le;class Ea extends Pj.Shape{_sceneFunc(e){const t=this.radiusX(),r=this.radiusY();e.beginPath(),e.save(),t!==r&&e.scale(1,r/t),e.arc(0,0,t,0,Math.PI*2,!1),e.restore(),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(e){this.radiusX(e/2)}setHeight(e){this.radiusY(e/2)}}Z0.Ellipse=Ea;Ea.prototype.className="Ellipse";Ea.prototype._centroid=!0;Ea.prototype._attrsAffectingSize=["radiusX","radiusY"];(0,kj._registerNode)(Ea);gS.Factory.addComponentsGetterSetter(Ea,"radius",["x","y"]);gS.Factory.addGetterSetter(Ea,"radiusX",0,(0,lx.getNumberValidator)());gS.Factory.addGetterSetter(Ea,"radiusY",0,(0,lx.getNumberValidator)());var e_={};Object.defineProperty(e_,"__esModule",{value:!0});e_.Image=void 0;const xv=Vt,Al=je,Rj=hn,xj=Le,Cf=ke;let cs=class ux extends Rj.Shape{constructor(e){super(e),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",t=>{this._removeImageLoad(t.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const e=this.image();e&&e.complete||e&&e.readyState===4||e&&e.addEventListener&&e.addEventListener("load",this._loadListener)}_removeImageLoad(e){e&&e.removeEventListener&&e.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const e=!!this.cornerRadius(),t=this.hasShadow();return e&&t?!0:super._useBufferCanvas(!0)}_sceneFunc(e){const t=this.getWidth(),r=this.getHeight(),i=this.cornerRadius(),s=this.attrs.image;let o;if(s){const l=this.attrs.cropWidth,c=this.attrs.cropHeight;l&&c?o=[s,this.cropX(),this.cropY(),l,c,0,0,t,r]:o=[s,0,0,t,r]}(this.hasFill()||this.hasStroke()||i)&&(e.beginPath(),i?xv.Util.drawRoundedRectPath(e,t,r,i):e.rect(0,0,t,r),e.closePath(),e.fillStrokeShape(this)),s&&(i&&e.clip(),e.drawImage.apply(e,o))}_hitFunc(e){const t=this.width(),r=this.height(),i=this.cornerRadius();e.beginPath(),i?xv.Util.drawRoundedRectPath(e,t,r,i):e.rect(0,0,t,r),e.closePath(),e.fillStrokeShape(this)}getWidth(){var e,t;return(e=this.attrs.width)!==null&&e!==void 0?e:(t=this.image())===null||t===void 0?void 0:t.width}getHeight(){var e,t;return(e=this.attrs.height)!==null&&e!==void 0?e:(t=this.image())===null||t===void 0?void 0:t.height}static fromURL(e,t,r=null){const i=xv.Util.createImageElement();i.onload=function(){const s=new ux({image:i});t(s)},i.onerror=r,i.crossOrigin="Anonymous",i.src=e}};e_.Image=cs;cs.prototype.className="Image";(0,xj._registerNode)(cs);Al.Factory.addGetterSetter(cs,"cornerRadius",0,(0,Cf.getNumberOrArrayOfNumbersValidator)(4));Al.Factory.addGetterSetter(cs,"image");Al.Factory.addComponentsGetterSetter(cs,"crop",["x","y","width","height"]);Al.Factory.addGetterSetter(cs,"cropX",0,(0,Cf.getNumberValidator)());Al.Factory.addGetterSetter(cs,"cropY",0,(0,Cf.getNumberValidator)());Al.Factory.addGetterSetter(cs,"cropWidth",0,(0,Cf.getNumberValidator)());Al.Factory.addGetterSetter(cs,"cropHeight",0,(0,Cf.getNumberValidator)());var lc={};Object.defineProperty(lc,"__esModule",{value:!0});lc.Tag=lc.Label=void 0;const t_=je,Aj=hn,Nj=Rc,mS=ke,cx=Le,hx=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],bj="Change.konva",Dj="none",k2="up",R2="right",x2="down",A2="left",Mj=hx.length;class _S extends Nj.Group{constructor(e){super(e),this.on("add.konva",function(t){this._addListeners(t.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(e){let t=this,r;const i=function(){t._sync()};for(r=0;r<Mj;r++)e.on(hx[r]+bj,i)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let e=this.getText(),t=this.getTag(),r,i,s,o,l,c,h;if(e&&t){switch(r=e.width(),i=e.height(),s=t.pointerDirection(),o=t.pointerWidth(),h=t.pointerHeight(),l=0,c=0,s){case k2:l=r/2,c=-1*h;break;case R2:l=r+o,c=i/2;break;case x2:l=r/2,c=i+h;break;case A2:l=-1*o,c=i/2;break}t.setAttrs({x:-1*l,y:-1*c,width:r,height:i}),e.setAttrs({x:-1*l,y:-1*c})}}}lc.Label=_S;_S.prototype.className="Label";(0,cx._registerNode)(_S);class Nl extends Aj.Shape{_sceneFunc(e){const t=this.width(),r=this.height(),i=this.pointerDirection(),s=this.pointerWidth(),o=this.pointerHeight(),l=this.cornerRadius();let c=0,h=0,p=0,m=0;typeof l=="number"?c=h=p=m=Math.min(l,t/2,r/2):(c=Math.min(l[0]||0,t/2,r/2),h=Math.min(l[1]||0,t/2,r/2),m=Math.min(l[2]||0,t/2,r/2),p=Math.min(l[3]||0,t/2,r/2)),e.beginPath(),e.moveTo(c,0),i===k2&&(e.lineTo((t-s)/2,0),e.lineTo(t/2,-1*o),e.lineTo((t+s)/2,0)),e.lineTo(t-h,0),e.arc(t-h,h,h,Math.PI*3/2,0,!1),i===R2&&(e.lineTo(t,(r-o)/2),e.lineTo(t+s,r/2),e.lineTo(t,(r+o)/2)),e.lineTo(t,r-m),e.arc(t-m,r-m,m,0,Math.PI/2,!1),i===x2&&(e.lineTo((t+s)/2,r),e.lineTo(t/2,r+o),e.lineTo((t-s)/2,r)),e.lineTo(p,r),e.arc(p,r-p,p,Math.PI/2,Math.PI,!1),i===A2&&(e.lineTo(0,(r+o)/2),e.lineTo(-1*s,r/2),e.lineTo(0,(r-o)/2)),e.lineTo(0,c),e.arc(c,c,c,Math.PI,Math.PI*3/2,!1),e.closePath(),e.fillStrokeShape(this)}getSelfRect(){let e=0,t=0,r=this.pointerWidth(),i=this.pointerHeight(),s=this.pointerDirection(),o=this.width(),l=this.height();return s===k2?(t-=i,l+=i):s===x2?l+=i:s===A2?(e-=r*1.5,o+=r):s===R2&&(o+=r*1.5),{x:e,y:t,width:o,height:l}}}lc.Tag=Nl;Nl.prototype.className="Tag";(0,cx._registerNode)(Nl);t_.Factory.addGetterSetter(Nl,"pointerDirection",Dj);t_.Factory.addGetterSetter(Nl,"pointerWidth",0,(0,mS.getNumberValidator)());t_.Factory.addGetterSetter(Nl,"pointerHeight",0,(0,mS.getNumberValidator)());t_.Factory.addGetterSetter(Nl,"cornerRadius",0,(0,mS.getNumberOrArrayOfNumbersValidator)(4));var Tf={};Object.defineProperty(Tf,"__esModule",{value:!0});Tf.Rect=void 0;const Oj=je,Lj=hn,Fj=Le,Vj=Vt,Uj=ke;let n_=class extends Lj.Shape{_sceneFunc(e){const t=this.cornerRadius(),r=this.width(),i=this.height();e.beginPath(),t?Vj.Util.drawRoundedRectPath(e,r,i,t):e.rect(0,0,r,i),e.closePath(),e.fillStrokeShape(this)}};Tf.Rect=n_;n_.prototype.className="Rect";(0,Fj._registerNode)(n_);Oj.Factory.addGetterSetter(n_,"cornerRadius",0,(0,Uj.getNumberOrArrayOfNumbersValidator)(4));var r_={};Object.defineProperty(r_,"__esModule",{value:!0});r_.RegularPolygon=void 0;const dx=je,Bj=hn,fx=ke,zj=Le;class bl extends Bj.Shape{_sceneFunc(e){const t=this._getPoints();e.beginPath(),e.moveTo(t[0].x,t[0].y);for(let r=1;r<t.length;r++)e.lineTo(t[r].x,t[r].y);e.closePath(),e.fillStrokeShape(this)}_getPoints(){const e=this.attrs.sides,t=this.attrs.radius||0,r=[];for(let i=0;i<e;i++)r.push({x:t*Math.sin(i*2*Math.PI/e),y:-1*t*Math.cos(i*2*Math.PI/e)});return r}getSelfRect(){const e=this._getPoints();let t=e[0].x,r=e[0].y,i=e[0].x,s=e[0].y;return e.forEach(o=>{t=Math.min(t,o.x),r=Math.max(r,o.x),i=Math.min(i,o.y),s=Math.max(s,o.y)}),{x:t,y:i,width:r-t,height:s-i}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}r_.RegularPolygon=bl;bl.prototype.className="RegularPolygon";bl.prototype._centroid=!0;bl.prototype._attrsAffectingSize=["radius"];(0,zj._registerNode)(bl);dx.Factory.addGetterSetter(bl,"radius",0,(0,fx.getNumberValidator)());dx.Factory.addGetterSetter(bl,"sides",0,(0,fx.getNumberValidator)());var i_={};Object.defineProperty(i_,"__esModule",{value:!0});i_.Ring=void 0;const px=je,jj=hn,gx=ke,Gj=Le,g5=Math.PI*2;class Dl extends jj.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.innerRadius(),0,g5,!1),e.moveTo(this.outerRadius(),0),e.arc(0,0,this.outerRadius(),g5,0,!0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}i_.Ring=Dl;Dl.prototype.className="Ring";Dl.prototype._centroid=!0;Dl.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,Gj._registerNode)(Dl);px.Factory.addGetterSetter(Dl,"innerRadius",0,(0,gx.getNumberValidator)());px.Factory.addGetterSetter(Dl,"outerRadius",0,(0,gx.getNumberValidator)());var s_={};Object.defineProperty(s_,"__esModule",{value:!0});s_.Sprite=void 0;const Ml=je,Wj=hn,Hj=xc,mx=ke,$j=Le;class hs extends Wj.Shape{constructor(e){super(e),this._updated=!0,this.anim=new Hj.Animation(()=>{const t=this._updated;return this._updated=!1,t}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(e){const t=this.animation(),r=this.frameIndex(),i=r*4,s=this.animations()[t],o=this.frameOffsets(),l=s[i+0],c=s[i+1],h=s[i+2],p=s[i+3],m=this.image();if((this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,h,p),e.closePath(),e.fillStrokeShape(this)),m)if(o){const _=o[t],w=r*2;e.drawImage(m,l,c,h,p,_[w+0],_[w+1],h,p)}else e.drawImage(m,l,c,h,p,0,0,h,p)}_hitFunc(e){const t=this.animation(),r=this.frameIndex(),i=r*4,s=this.animations()[t],o=this.frameOffsets(),l=s[i+2],c=s[i+3];if(e.beginPath(),o){const h=o[t],p=r*2;e.rect(h[p+0],h[p+1],l,c)}else e.rect(0,0,l,c);e.closePath(),e.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const e=this;this.interval=setInterval(function(){e._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const e=this.getLayer();this.anim.setLayers(e),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const e=this.frameIndex(),t=this.animation(),r=this.animations(),i=r[t],s=i.length/4;e<s-1?this.frameIndex(e+1):this.frameIndex(0)}}s_.Sprite=hs;hs.prototype.className="Sprite";(0,$j._registerNode)(hs);Ml.Factory.addGetterSetter(hs,"animation");Ml.Factory.addGetterSetter(hs,"animations");Ml.Factory.addGetterSetter(hs,"frameOffsets");Ml.Factory.addGetterSetter(hs,"image");Ml.Factory.addGetterSetter(hs,"frameIndex",0,(0,mx.getNumberValidator)());Ml.Factory.addGetterSetter(hs,"frameRate",17,(0,mx.getNumberValidator)());Ml.Factory.backCompat(hs,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var o_={};Object.defineProperty(o_,"__esModule",{value:!0});o_.Star=void 0;const yS=je,qj=hn,vS=ke,Kj=Le;class Sa extends qj.Shape{_sceneFunc(e){const t=this.innerRadius(),r=this.outerRadius(),i=this.numPoints();e.beginPath(),e.moveTo(0,0-r);for(let s=1;s<i*2;s++){const o=s%2===0?r:t,l=o*Math.sin(s*Math.PI/i),c=-1*o*Math.cos(s*Math.PI/i);e.lineTo(l,c)}e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}o_.Star=Sa;Sa.prototype.className="Star";Sa.prototype._centroid=!0;Sa.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,Kj._registerNode)(Sa);yS.Factory.addGetterSetter(Sa,"numPoints",5,(0,vS.getNumberValidator)());yS.Factory.addGetterSetter(Sa,"innerRadius",0,(0,vS.getNumberValidator)());yS.Factory.addGetterSetter(Sa,"outerRadius",0,(0,vS.getNumberValidator)());var bc={};Object.defineProperty(bc,"__esModule",{value:!0});bc.Text=void 0;bc.stringToArray=Ka;const N2=Vt,lr=je,Qj=hn,Av=Le,Ca=ke,Yj=Le;function Ka(n){return[...n].reduce((e,t,r,i)=>{if(new RegExp("\\p{Emoji}","u").test(t)){const s=i[r+1];s&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(s)?(e.push(t+s),i[r+1]=""):e.push(t)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(t+(i[r+1]||""))?e.push(t+i[r+1]):r>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(t)?e[e.length-1]+=t:t&&e.push(t);return e},[])}const uu="auto",Xj="center",_x="inherit",xh="justify",Jj="Change.konva",Zj="2d",m5="-",yx="left",eG="text",tG="Text",nG="top",rG="bottom",_5="middle",vx="normal",iG="px ",eg=" ",sG="right",y5="rtl",oG="word",aG="char",v5="none",Nv="…",wx=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],lG=wx.length;function uG(n){return n.split(",").map(e=>{e=e.trim();const t=e.indexOf(" ")>=0,r=e.indexOf('"')>=0||e.indexOf("'")>=0;return t&&!r&&(e=`"${e}"`),e}).join(", ")}let tg;function bv(){return tg||(tg=N2.Util.createCanvasElement().getContext(Zj),tg)}function cG(n){n.fillText(this._partialText,this._partialTextX,this._partialTextY)}function hG(n){n.setAttr("miterLimit",2),n.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function dG(n){return n=n||{},!n.fillLinearGradientColorStops&&!n.fillRadialGradientColorStops&&!n.fillPatternImage&&(n.fill=n.fill||"black"),n}let zt=class extends Qj.Shape{constructor(e){super(dG(e)),this._partialTextX=0,this._partialTextY=0;for(let t=0;t<lG;t++)this.on(wx[t]+Jj,this._setTextData);this._setTextData()}_sceneFunc(e){const t=this.textArr,r=t.length;if(!this.text())return;let i=this.padding(),s=this.fontSize(),o=this.lineHeight()*s,l=this.verticalAlign(),c=this.direction(),h=0,p=this.align(),m=this.getWidth(),_=this.letterSpacing(),w=this.fill(),S=this.textDecoration(),k=S.indexOf("underline")!==-1,N=S.indexOf("line-through")!==-1,x;c=c===_x?e.direction:c;let R=o/2,E=_5;if(Av.Konva._fixTextRendering){const P=this.measureSize("M");E="alphabetic",R=(P.fontBoundingBoxAscent-P.fontBoundingBoxDescent)/2+o/2}for(c===y5&&e.setAttr("direction",c),e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",E),e.setAttr("textAlign",yx),l===_5?h=(this.getHeight()-r*o-i*2)/2:l===rG&&(h=this.getHeight()-r*o-i*2),e.translate(i,h+i),x=0;x<r;x++){let P=0,V=0;const B=t[x],D=B.text,T=B.width,b=B.lastInParagraph;if(e.save(),p===sG?P+=m-T-i*2:p===Xj&&(P+=(m-T-i*2)/2),k){e.save(),e.beginPath();const A=Av.Konva._fixTextRendering?Math.round(s/4):Math.round(s/2),O=P,U=R+V+A;e.moveTo(O,U);const F=p===xh&&!b?m-i*2:T;e.lineTo(O+Math.round(F),U),e.lineWidth=s/15;const ce=this._getLinearGradient();e.strokeStyle=ce||w,e.stroke(),e.restore()}if(N){e.save(),e.beginPath();const A=Av.Konva._fixTextRendering?-Math.round(s/4):0;e.moveTo(P,R+V+A);const O=p===xh&&!b?m-i*2:T;e.lineTo(P+Math.round(O),R+V+A),e.lineWidth=s/15;const U=this._getLinearGradient();e.strokeStyle=U||w,e.stroke(),e.restore()}if(c!==y5&&(_!==0||p===xh)){const A=D.split(" ").length-1,O=Ka(D);for(let U=0;U<O.length;U++){const F=O[U];F===" "&&!b&&p===xh&&(P+=(m-i*2-T)/A),this._partialTextX=P,this._partialTextY=R+V,this._partialText=F,e.fillStrokeShape(this),P+=this.measureSize(F).width+_}}else _!==0&&e.setAttr("letterSpacing",`${_}px`),this._partialTextX=P,this._partialTextY=R+V,this._partialText=D,e.fillStrokeShape(this);e.restore(),r>1&&(R+=o)}}_hitFunc(e){const t=this.getWidth(),r=this.getHeight();e.beginPath(),e.rect(0,0,t,r),e.closePath(),e.fillStrokeShape(this)}setText(e){const t=N2.Util._isString(e)?e:e==null?"":e+"";return this._setAttr(eG,t),this}getWidth(){return this.attrs.width===uu||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===uu||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return N2.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(e){var t,r,i,s,o,l,c,h,p,m,_;let w=bv(),S=this.fontSize(),k;w.save(),w.font=this._getContextFont(),k=w.measureText(e),w.restore();const N=S/100;return{actualBoundingBoxAscent:(t=k.actualBoundingBoxAscent)!==null&&t!==void 0?t:71.58203125*N,actualBoundingBoxDescent:(r=k.actualBoundingBoxDescent)!==null&&r!==void 0?r:0,actualBoundingBoxLeft:(i=k.actualBoundingBoxLeft)!==null&&i!==void 0?i:-7.421875*N,actualBoundingBoxRight:(s=k.actualBoundingBoxRight)!==null&&s!==void 0?s:75.732421875*N,alphabeticBaseline:(o=k.alphabeticBaseline)!==null&&o!==void 0?o:0,emHeightAscent:(l=k.emHeightAscent)!==null&&l!==void 0?l:100*N,emHeightDescent:(c=k.emHeightDescent)!==null&&c!==void 0?c:-20*N,fontBoundingBoxAscent:(h=k.fontBoundingBoxAscent)!==null&&h!==void 0?h:91*N,fontBoundingBoxDescent:(p=k.fontBoundingBoxDescent)!==null&&p!==void 0?p:21*N,hangingBaseline:(m=k.hangingBaseline)!==null&&m!==void 0?m:72.80000305175781*N,ideographicBaseline:(_=k.ideographicBaseline)!==null&&_!==void 0?_:-21*N,width:k.width,height:S}}_getContextFont(){return this.fontStyle()+eg+this.fontVariant()+eg+(this.fontSize()+iG)+uG(this.fontFamily())}_addTextLine(e){this.align()===xh&&(e=e.trim());const r=this._getTextWidth(e);return this.textArr.push({text:e,width:r,lastInParagraph:!1})}_getTextWidth(e){const t=this.letterSpacing(),r=e.length;return bv().measureText(e).width+t*r}_setTextData(){let e=this.text().split(`
`),t=+this.fontSize(),r=0,i=this.lineHeight()*t,s=this.attrs.width,o=this.attrs.height,l=s!==uu&&s!==void 0,c=o!==uu&&o!==void 0,h=this.padding(),p=s-h*2,m=o-h*2,_=0,w=this.wrap(),S=w!==v5,k=w!==aG&&S,N=this.ellipsis();this.textArr=[],bv().font=this._getContextFont();const x=N?this._getTextWidth(Nv):0;for(let R=0,E=e.length;R<E;++R){let P=e[R],V=this._getTextWidth(P);if(l&&V>p)for(;P.length>0;){let B=0,D=Ka(P).length,T="",b=0;for(;B<D;){const A=B+D>>>1,O=Ka(P),U=O.slice(0,A+1).join(""),F=this._getTextWidth(U);(N&&c&&_+i>m?F+x:F)<=p?(B=A+1,T=U,b=F):D=A}if(T){if(k){const U=Ka(P),F=Ka(T),ce=U[F.length],le=ce===eg||ce===m5;let Me;if(le&&b<=p)Me=F.length;else{const be=F.lastIndexOf(eg),$=F.lastIndexOf(m5);Me=Math.max(be,$)+1}Me>0&&(B=Me,T=U.slice(0,B).join(""),b=this._getTextWidth(T))}if(T=T.trimRight(),this._addTextLine(T),r=Math.max(r,b),_+=i,this._shouldHandleEllipsis(_)){this._tryToAddEllipsisToLastLine();break}if(P=Ka(P).slice(B).join("").trimLeft(),P.length>0&&(V=this._getTextWidth(P),V<=p)){this._addTextLine(P),_+=i,r=Math.max(r,V);break}}else break}else this._addTextLine(P),_+=i,r=Math.max(r,V),this._shouldHandleEllipsis(_)&&R<E-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),c&&_+i>m)break}this.textHeight=t,this.textWidth=r}_shouldHandleEllipsis(e){const t=+this.fontSize(),r=this.lineHeight()*t,i=this.attrs.height,s=i!==uu&&i!==void 0,o=this.padding(),l=i-o*2;return!(this.wrap()!==v5)||s&&e+r>l}_tryToAddEllipsisToLastLine(){const e=this.attrs.width,t=e!==uu&&e!==void 0,r=this.padding(),i=e-r*2,s=this.ellipsis(),o=this.textArr[this.textArr.length-1];!o||!s||(t&&(this._getTextWidth(o.text+Nv)<i||(o.text=o.text.slice(0,o.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(o.text+Nv))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const e=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,t=this.hasShadow();return e&&t?!0:super._useBufferCanvas()}};bc.Text=zt;zt.prototype._fillFunc=cG;zt.prototype._strokeFunc=hG;zt.prototype.className=tG;zt.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];(0,Yj._registerNode)(zt);lr.Factory.overWriteSetter(zt,"width",(0,Ca.getNumberOrAutoValidator)());lr.Factory.overWriteSetter(zt,"height",(0,Ca.getNumberOrAutoValidator)());lr.Factory.addGetterSetter(zt,"direction",_x);lr.Factory.addGetterSetter(zt,"fontFamily","Arial");lr.Factory.addGetterSetter(zt,"fontSize",12,(0,Ca.getNumberValidator)());lr.Factory.addGetterSetter(zt,"fontStyle",vx);lr.Factory.addGetterSetter(zt,"fontVariant",vx);lr.Factory.addGetterSetter(zt,"padding",0,(0,Ca.getNumberValidator)());lr.Factory.addGetterSetter(zt,"align",yx);lr.Factory.addGetterSetter(zt,"verticalAlign",nG);lr.Factory.addGetterSetter(zt,"lineHeight",1,(0,Ca.getNumberValidator)());lr.Factory.addGetterSetter(zt,"wrap",oG);lr.Factory.addGetterSetter(zt,"ellipsis",!1,(0,Ca.getBooleanValidator)());lr.Factory.addGetterSetter(zt,"letterSpacing",0,(0,Ca.getNumberValidator)());lr.Factory.addGetterSetter(zt,"text","",(0,Ca.getStringValidator)());lr.Factory.addGetterSetter(zt,"textDecoration","");var a_={};Object.defineProperty(a_,"__esModule",{value:!0});a_.TextPath=void 0;const Dv=Vt,Li=je,fG=hn,Ah=Ac,Mv=bc,Ex=ke,pG=Le,gG="",Sx="normal";function Cx(n){n.fillText(this.partialText,0,0)}function Tx(n){n.strokeText(this.partialText,0,0)}class dn extends fG.Shape{constructor(e){super(e),this.dummyCanvas=Dv.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return Ah.Path.getPathLength(this.dataArray)}_getPointAtLength(e){if(!this.attrs.data)return null;const t=this.pathLength;return e-1>t?null:Ah.Path.getPointAtLengthOfDataArray(e,this.dataArray)}_readDataAttribute(){this.dataArray=Ah.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(e){e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",this.textBaseline()),e.setAttr("textAlign","left"),e.save();const t=this.textDecoration(),r=this.fill(),i=this.fontSize(),s=this.glyphInfo;t==="underline"&&e.beginPath();for(let o=0;o<s.length;o++){e.save();const l=s[o].p0;e.translate(l.x,l.y),e.rotate(s[o].rotation),this.partialText=s[o].text,e.fillStrokeShape(this),t==="underline"&&(o===0&&e.moveTo(0,i/2+1),e.lineTo(i,i/2+1)),e.restore()}t==="underline"&&(e.strokeStyle=r,e.lineWidth=i/20,e.stroke()),e.restore()}_hitFunc(e){e.beginPath();const t=this.glyphInfo;if(t.length>=1){const r=t[0].p0;e.moveTo(r.x,r.y)}for(let r=0;r<t.length;r++){const i=t[r].p1;e.lineTo(i.x,i.y)}e.setAttr("lineWidth",this.fontSize()),e.setAttr("strokeStyle",this.colorKey),e.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return Dv.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(e){return Mv.Text.prototype.setText.call(this,e)}_getContextFont(){return Mv.Text.prototype._getContextFont.call(this)}_getTextSize(e){const r=this.dummyCanvas.getContext("2d");r.save(),r.font=this._getContextFont();const i=r.measureText(e);return r.restore(),{width:i.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:e,height:t}=this._getTextSize(this.attrs.text);if(this.textWidth=e,this.textHeight=t,this.glyphInfo=[],!this.attrs.data)return null;const r=this.letterSpacing(),i=this.align(),s=this.kerningFunc(),o=Math.max(this.textWidth+((this.attrs.text||"").length-1)*r,0);let l=0;i==="center"&&(l=Math.max(0,this.pathLength/2-o/2)),i==="right"&&(l=Math.max(0,this.pathLength-o));const c=(0,Mv.stringToArray)(this.text());let h=l;for(let p=0;p<c.length;p++){const m=this._getPointAtLength(h);if(!m)return;let _=this._getTextSize(c[p]).width+r;if(c[p]===" "&&i==="justify"){const R=this.text().split(" ").length-1;_+=(this.pathLength-o)/R}const w=this._getPointAtLength(h+_);if(!w)return;const S=Ah.Path.getLineLength(m.x,m.y,w.x,w.y);let k=0;if(s)try{k=s(c[p-1],c[p])*this.fontSize()}catch{k=0}m.x+=k,w.x+=k,this.textWidth+=k;const N=Ah.Path.getPointOnLine(k+S/2,m.x,m.y,w.x,w.y),x=Math.atan2(w.y-m.y,w.x-m.x);this.glyphInfo.push({transposeX:N.x,transposeY:N.y,text:c[p],rotation:x,p0:m,p1:w}),h+=_}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const e=[];this.glyphInfo.forEach(function(h){e.push(h.p0.x),e.push(h.p0.y),e.push(h.p1.x),e.push(h.p1.y)});let t=e[0]||0,r=e[0]||0,i=e[1]||0,s=e[1]||0,o,l;for(let h=0;h<e.length/2;h++)o=e[h*2],l=e[h*2+1],t=Math.min(t,o),r=Math.max(r,o),i=Math.min(i,l),s=Math.max(s,l);const c=this.fontSize();return{x:t-c/2,y:i-c/2,width:r-t+c,height:s-i+c}}destroy(){return Dv.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}a_.TextPath=dn;dn.prototype._fillFunc=Cx;dn.prototype._strokeFunc=Tx;dn.prototype._fillFuncHit=Cx;dn.prototype._strokeFuncHit=Tx;dn.prototype.className="TextPath";dn.prototype._attrsAffectingSize=["text","fontSize","data"];(0,pG._registerNode)(dn);Li.Factory.addGetterSetter(dn,"data");Li.Factory.addGetterSetter(dn,"fontFamily","Arial");Li.Factory.addGetterSetter(dn,"fontSize",12,(0,Ex.getNumberValidator)());Li.Factory.addGetterSetter(dn,"fontStyle",Sx);Li.Factory.addGetterSetter(dn,"align","left");Li.Factory.addGetterSetter(dn,"letterSpacing",0,(0,Ex.getNumberValidator)());Li.Factory.addGetterSetter(dn,"textBaseline","middle");Li.Factory.addGetterSetter(dn,"fontVariant",Sx);Li.Factory.addGetterSetter(dn,"text",gG);Li.Factory.addGetterSetter(dn,"textDecoration","");Li.Factory.addGetterSetter(dn,"kerningFunc",void 0);var l_={};Object.defineProperty(l_,"__esModule",{value:!0});l_.Transformer=void 0;const gt=Vt,at=je,w5=At,mG=hn,_G=Tf,E5=Rc,Ei=Le,Ta=ke,yG=Le,Ix="tr-konva",vG=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(n=>n+`.${Ix}`).join(" "),S5="nodesRect",wG=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],EG={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},SG="ontouchstart"in Ei.Konva._global;function CG(n,e,t){if(n==="rotater")return t;e+=gt.Util.degToRad(EG[n]||0);const r=(gt.Util.radToDeg(e)%360+360)%360;return gt.Util._inRange(r,315+22.5,360)||gt.Util._inRange(r,0,22.5)?"ns-resize":gt.Util._inRange(r,45-22.5,45+22.5)?"nesw-resize":gt.Util._inRange(r,90-22.5,90+22.5)?"ew-resize":gt.Util._inRange(r,135-22.5,135+22.5)?"nwse-resize":gt.Util._inRange(r,180-22.5,180+22.5)?"ns-resize":gt.Util._inRange(r,225-22.5,225+22.5)?"nesw-resize":gt.Util._inRange(r,270-22.5,270+22.5)?"ew-resize":gt.Util._inRange(r,315-22.5,315+22.5)?"nwse-resize":(gt.Util.error("Transformer has unknown angle for cursor detection: "+r),"pointer")}const Om=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function TG(n){return{x:n.x+n.width/2*Math.cos(n.rotation)+n.height/2*Math.sin(-n.rotation),y:n.y+n.height/2*Math.cos(n.rotation)+n.width/2*Math.sin(n.rotation)}}function Px(n,e,t){const r=t.x+(n.x-t.x)*Math.cos(e)-(n.y-t.y)*Math.sin(e),i=t.y+(n.x-t.x)*Math.sin(e)+(n.y-t.y)*Math.cos(e);return{...n,rotation:n.rotation+e,x:r,y:i}}function IG(n,e){const t=TG(n);return Px(n,e,t)}function PG(n,e,t){let r=e;for(let i=0;i<n.length;i++){const s=Ei.Konva.getAngle(n[i]),o=Math.abs(s-e)%(Math.PI*2);Math.min(o,Math.PI*2-o)<t&&(r=s)}return r}let b2=0;class Xe extends E5.Group{constructor(e){super(e),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(vG,this.update),this.getNode()&&this.update()}attachTo(e){return this.setNode(e),this}setNode(e){return gt.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([e])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return Ix+this._id}setNodes(e=[]){this._nodes&&this._nodes.length&&this.detach();const t=e.filter(i=>i.isAncestorOf(this)?(gt.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=e=t,e.length===1&&this.useSingleNodeRotation()?this.rotation(e[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(i=>{const s=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(i._attrsAffectingSize.length){const o=i._attrsAffectingSize.map(l=>l+"Change."+this._getEventNamespace()).join(" ");i.on(o,s)}i.on(wG.map(o=>o+`.${this._getEventNamespace()}`).join(" "),s),i.on(`absoluteTransformChange.${this._getEventNamespace()}`,s),this._proxyDrag(i)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(e){let t;e.on(`dragstart.${this._getEventNamespace()}`,r=>{t=e.getAbsolutePosition(),!this.isDragging()&&e!==this.findOne(".back")&&this.startDrag(r,!1)}),e.on(`dragmove.${this._getEventNamespace()}`,r=>{if(!t)return;const i=e.getAbsolutePosition(),s=i.x-t.x,o=i.y-t.y;this.nodes().forEach(l=>{if(l===e||l.isDragging())return;const c=l.getAbsolutePosition();l.setAbsolutePosition({x:c.x+s,y:c.y+o}),l.startDrag(r)}),t=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(e=>{e.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(S5),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(S5,this.__getNodeRect)}__getNodeShape(e,t=this.rotation(),r){const i=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),s=e.getAbsoluteScale(r),o=e.getAbsolutePosition(r),l=i.x*s.x-e.offsetX()*s.x,c=i.y*s.y-e.offsetY()*s.y,h=(Ei.Konva.getAngle(e.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),p={x:o.x+l*Math.cos(h)+c*Math.sin(-h),y:o.y+c*Math.cos(h)+l*Math.sin(h),width:i.width*s.x,height:i.height*s.y,rotation:h};return Px(p,-Ei.Konva.getAngle(t),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const t=[];this.nodes().map(h=>{const p=h.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),m=[{x:p.x,y:p.y},{x:p.x+p.width,y:p.y},{x:p.x+p.width,y:p.y+p.height},{x:p.x,y:p.y+p.height}],_=h.getAbsoluteTransform();m.forEach(function(w){const S=_.point(w);t.push(S)})});const r=new gt.Transform;r.rotate(-Ei.Konva.getAngle(this.rotation()));let i=1/0,s=1/0,o=-1/0,l=-1/0;t.forEach(function(h){const p=r.point(h);i===void 0&&(i=o=p.x,s=l=p.y),i=Math.min(i,p.x),s=Math.min(s,p.y),o=Math.max(o,p.x),l=Math.max(l,p.y)}),r.invert();const c=r.point({x:i,y:s});return{x:c.x,y:c.y,width:o-i,height:l-s,rotation:Ei.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),Om.forEach(e=>{this._createAnchor(e)}),this._createAnchor("rotater")}_createAnchor(e){const t=new _G.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:e+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:SG?10:"auto"}),r=this;t.on("mousedown touchstart",function(i){r._handleMouseDown(i)}),t.on("dragstart",i=>{t.stopDrag(),i.cancelBubble=!0}),t.on("dragend",i=>{i.cancelBubble=!0}),t.on("mouseenter",()=>{const i=Ei.Konva.getAngle(this.rotation()),s=this.rotateAnchorCursor(),o=CG(e,i,s);t.getStage().content&&(t.getStage().content.style.cursor=o),this._cursorChange=!0}),t.on("mouseout",()=>{t.getStage().content&&(t.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(t)}_createBack(){const e=new mG.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(t,r){const i=r.getParent(),s=i.padding();t.beginPath(),t.rect(-s,-s,r.width()+s*2,r.height()+s*2),t.moveTo(r.width()/2,-s),i.rotateEnabled()&&i.rotateLineVisible()&&t.lineTo(r.width()/2,-i.rotateAnchorOffset()*gt.Util._sign(r.height())-s),t.fillStrokeShape(r)},hitFunc:(t,r)=>{if(!this.shouldOverdrawWholeArea())return;const i=this.padding();t.beginPath(),t.rect(-i,-i,r.width()+i*2,r.height()+i*2),t.fillStrokeShape(r)}});this.add(e),this._proxyDrag(e),e.on("dragstart",t=>{t.cancelBubble=!0}),e.on("dragmove",t=>{t.cancelBubble=!0}),e.on("dragend",t=>{t.cancelBubble=!0}),this.on("dragmove",t=>{this.update()})}_handleMouseDown(e){if(this._transforming)return;this._movingAnchorName=e.target.name().split(" ")[0];const t=this._getNodeRect(),r=t.width,i=t.height,s=Math.sqrt(Math.pow(r,2)+Math.pow(i,2));this.sin=Math.abs(i/s),this.cos=Math.abs(r/s),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const o=e.target.getAbsolutePosition(),l=e.target.getStage().getPointerPosition();this._anchorDragOffset={x:l.x-o.x,y:l.y-o.y},b2++,this._fire("transformstart",{evt:e.evt,target:this.getNode()}),this._nodes.forEach(c=>{c._fire("transformstart",{evt:e.evt,target:c})})}_handleMouseMove(e){let t,r,i;const s=this.findOne("."+this._movingAnchorName),o=s.getStage();o.setPointersPositions(e);const l=o.getPointerPosition();let c={x:l.x-this._anchorDragOffset.x,y:l.y-this._anchorDragOffset.y};const h=s.getAbsolutePosition();this.anchorDragBoundFunc()&&(c=this.anchorDragBoundFunc()(h,c,e)),s.setAbsolutePosition(c);const p=s.getAbsolutePosition();if(h.x===p.x&&h.y===p.y)return;if(this._movingAnchorName==="rotater"){const R=this._getNodeRect();t=s.x()-R.width/2,r=-s.y()+R.height/2;let E=Math.atan2(-r,t)+Math.PI/2;R.height<0&&(E-=Math.PI);const V=Ei.Konva.getAngle(this.rotation())+E,B=Ei.Konva.getAngle(this.rotationSnapTolerance()),T=PG(this.rotationSnaps(),V,B)-R.rotation,b=IG(R,T);this._fitNodesInto(b,e);return}const m=this.shiftBehavior();let _;m==="inverted"?_=this.keepRatio()&&!e.shiftKey:m==="none"?_=this.keepRatio():_=this.keepRatio()||e.shiftKey;let w=this.centeredScaling()||e.altKey;if(this._movingAnchorName==="top-left"){if(_){const R=w?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};i=Math.sqrt(Math.pow(R.x-s.x(),2)+Math.pow(R.y-s.y(),2));const E=this.findOne(".top-left").x()>R.x?-1:1,P=this.findOne(".top-left").y()>R.y?-1:1;t=i*this.cos*E,r=i*this.sin*P,this.findOne(".top-left").x(R.x-t),this.findOne(".top-left").y(R.y-r)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(s.y());else if(this._movingAnchorName==="top-right"){if(_){const R=w?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};i=Math.sqrt(Math.pow(s.x()-R.x,2)+Math.pow(R.y-s.y(),2));const E=this.findOne(".top-right").x()<R.x?-1:1,P=this.findOne(".top-right").y()>R.y?-1:1;t=i*this.cos*E,r=i*this.sin*P,this.findOne(".top-right").x(R.x+t),this.findOne(".top-right").y(R.y-r)}var S=s.position();this.findOne(".top-left").y(S.y),this.findOne(".bottom-right").x(S.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(s.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(s.x());else if(this._movingAnchorName==="bottom-left"){if(_){const R=w?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};i=Math.sqrt(Math.pow(R.x-s.x(),2)+Math.pow(s.y()-R.y,2));const E=R.x<s.x()?-1:1,P=s.y()<R.y?-1:1;t=i*this.cos*E,r=i*this.sin*P,s.x(R.x-t),s.y(R.y+r)}S=s.position(),this.findOne(".top-left").x(S.x),this.findOne(".bottom-right").y(S.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(s.y());else if(this._movingAnchorName==="bottom-right"){if(_){const R=w?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};i=Math.sqrt(Math.pow(s.x()-R.x,2)+Math.pow(s.y()-R.y,2));const E=this.findOne(".bottom-right").x()<R.x?-1:1,P=this.findOne(".bottom-right").y()<R.y?-1:1;t=i*this.cos*E,r=i*this.sin*P,this.findOne(".bottom-right").x(R.x+t),this.findOne(".bottom-right").y(R.y+r)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(w=this.centeredScaling()||e.altKey,w){const R=this.findOne(".top-left"),E=this.findOne(".bottom-right"),P=R.x(),V=R.y(),B=this.getWidth()-E.x(),D=this.getHeight()-E.y();E.move({x:-P,y:-V}),R.move({x:B,y:D})}const k=this.findOne(".top-left").getAbsolutePosition();t=k.x,r=k.y;const N=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),x=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:t,y:r,width:N,height:x,rotation:Ei.Konva.getAngle(this.rotation())},e)}_handleMouseUp(e){this._removeEvents(e)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(e){var t;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const r=this.getNode();b2--,this._fire("transformend",{evt:e,target:r}),(t=this.getLayer())===null||t===void 0||t.batchDraw(),r&&this._nodes.forEach(i=>{var s;i._fire("transformend",{evt:e,target:i}),(s=i.getLayer())===null||s===void 0||s.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(e,t){const r=this._getNodeRect(),i=1;if(gt.Util._inRange(e.width,-this.padding()*2-i,i)){this.update();return}if(gt.Util._inRange(e.height,-this.padding()*2-i,i)){this.update();return}const s=new gt.Transform;if(s.rotate(Ei.Konva.getAngle(this.rotation())),this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("left")>=0){const _=s.point({x:-this.padding()*2,y:0});e.x+=_.x,e.y+=_.y,e.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=_.x,this._anchorDragOffset.y-=_.y}else if(this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("right")>=0){const _=s.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=_.x,this._anchorDragOffset.y-=_.y,e.width+=this.padding()*2}if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("top")>=0){const _=s.point({x:0,y:-this.padding()*2});e.x+=_.x,e.y+=_.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=_.x,this._anchorDragOffset.y-=_.y,e.height+=this.padding()*2}else if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const _=s.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=_.x,this._anchorDragOffset.y-=_.y,e.height+=this.padding()*2}if(this.boundBoxFunc()){const _=this.boundBoxFunc()(r,e);_?e=_:gt.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const o=1e7,l=new gt.Transform;l.translate(r.x,r.y),l.rotate(r.rotation),l.scale(r.width/o,r.height/o);const c=new gt.Transform,h=e.width/o,p=e.height/o;this.flipEnabled()===!1?(c.translate(e.x,e.y),c.rotate(e.rotation),c.translate(e.width<0?e.width:0,e.height<0?e.height:0),c.scale(Math.abs(h),Math.abs(p))):(c.translate(e.x,e.y),c.rotate(e.rotation),c.scale(h,p));const m=c.multiply(l.invert());this._nodes.forEach(_=>{var w;const S=_.getParent().getAbsoluteTransform(),k=_.getTransform().copy();k.translate(_.offsetX(),_.offsetY());const N=new gt.Transform;N.multiply(S.copy().invert()).multiply(m).multiply(S).multiply(k);const x=N.decompose();_.setAttrs(x),(w=_.getLayer())===null||w===void 0||w.batchDraw()}),this.rotation(gt.Util._getRotation(e.rotation)),this._nodes.forEach(_=>{this._fire("transform",{evt:t,target:_}),_._fire("transform",{evt:t,target:_})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(e,t){this.findOne(e).setAttrs(t)}update(){var e;const t=this._getNodeRect();this.rotation(gt.Util._getRotation(t.rotation));const r=t.width,i=t.height,s=this.enabledAnchors(),o=this.resizeEnabled(),l=this.padding(),c=this.anchorSize(),h=this.find("._anchor");h.forEach(m=>{m.setAttrs({width:c,height:c,offsetX:c/2,offsetY:c/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:c/2+l,offsetY:c/2+l,visible:o&&s.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:r/2,y:0,offsetY:c/2+l,visible:o&&s.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:r,y:0,offsetX:c/2-l,offsetY:c/2+l,visible:o&&s.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:i/2,offsetX:c/2+l,visible:o&&s.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:r,y:i/2,offsetX:c/2-l,visible:o&&s.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:i,offsetX:c/2+l,offsetY:c/2-l,visible:o&&s.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:r/2,y:i,offsetY:c/2-l,visible:o&&s.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:r,y:i,offsetX:c/2-l,offsetY:c/2-l,visible:o&&s.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:r/2,y:-this.rotateAnchorOffset()*gt.Util._sign(i)-l,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:r,height:i,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const p=this.anchorStyleFunc();p&&h.forEach(m=>{p(m)}),(e=this.getLayer())===null||e===void 0||e.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const e=this.findOne("."+this._movingAnchorName);e&&e.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),E5.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return w5.Node.prototype.toObject.call(this)}clone(e){return w5.Node.prototype.clone.call(this,e)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}l_.Transformer=Xe;Xe.isTransforming=()=>b2>0;function kG(n){return n instanceof Array||gt.Util.warn("enabledAnchors value should be an array"),n instanceof Array&&n.forEach(function(e){Om.indexOf(e)===-1&&gt.Util.warn("Unknown anchor name: "+e+". Available names are: "+Om.join(", "))}),n||[]}Xe.prototype.className="Transformer";(0,yG._registerNode)(Xe);at.Factory.addGetterSetter(Xe,"enabledAnchors",Om,kG);at.Factory.addGetterSetter(Xe,"flipEnabled",!0,(0,Ta.getBooleanValidator)());at.Factory.addGetterSetter(Xe,"resizeEnabled",!0);at.Factory.addGetterSetter(Xe,"anchorSize",10,(0,Ta.getNumberValidator)());at.Factory.addGetterSetter(Xe,"rotateEnabled",!0);at.Factory.addGetterSetter(Xe,"rotateLineVisible",!0);at.Factory.addGetterSetter(Xe,"rotationSnaps",[]);at.Factory.addGetterSetter(Xe,"rotateAnchorOffset",50,(0,Ta.getNumberValidator)());at.Factory.addGetterSetter(Xe,"rotateAnchorCursor","crosshair");at.Factory.addGetterSetter(Xe,"rotationSnapTolerance",5,(0,Ta.getNumberValidator)());at.Factory.addGetterSetter(Xe,"borderEnabled",!0);at.Factory.addGetterSetter(Xe,"anchorStroke","rgb(0, 161, 255)");at.Factory.addGetterSetter(Xe,"anchorStrokeWidth",1,(0,Ta.getNumberValidator)());at.Factory.addGetterSetter(Xe,"anchorFill","white");at.Factory.addGetterSetter(Xe,"anchorCornerRadius",0,(0,Ta.getNumberValidator)());at.Factory.addGetterSetter(Xe,"borderStroke","rgb(0, 161, 255)");at.Factory.addGetterSetter(Xe,"borderStrokeWidth",1,(0,Ta.getNumberValidator)());at.Factory.addGetterSetter(Xe,"borderDash");at.Factory.addGetterSetter(Xe,"keepRatio",!0);at.Factory.addGetterSetter(Xe,"shiftBehavior","default");at.Factory.addGetterSetter(Xe,"centeredScaling",!1);at.Factory.addGetterSetter(Xe,"ignoreStroke",!1);at.Factory.addGetterSetter(Xe,"padding",0,(0,Ta.getNumberValidator)());at.Factory.addGetterSetter(Xe,"nodes");at.Factory.addGetterSetter(Xe,"node");at.Factory.addGetterSetter(Xe,"boundBoxFunc");at.Factory.addGetterSetter(Xe,"anchorDragBoundFunc");at.Factory.addGetterSetter(Xe,"anchorStyleFunc");at.Factory.addGetterSetter(Xe,"shouldOverdrawWholeArea",!1);at.Factory.addGetterSetter(Xe,"useSingleNodeRotation",!0);at.Factory.backCompat(Xe,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var u_={};Object.defineProperty(u_,"__esModule",{value:!0});u_.Wedge=void 0;const c_=je,RG=hn,xG=Le,kx=ke,AG=Le;class so extends RG.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.radius(),0,xG.Konva.getAngle(this.angle()),this.clockwise()),e.lineTo(0,0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}u_.Wedge=so;so.prototype.className="Wedge";so.prototype._centroid=!0;so.prototype._attrsAffectingSize=["radius"];(0,AG._registerNode)(so);c_.Factory.addGetterSetter(so,"radius",0,(0,kx.getNumberValidator)());c_.Factory.addGetterSetter(so,"angle",0,(0,kx.getNumberValidator)());c_.Factory.addGetterSetter(so,"clockwise",!1);c_.Factory.backCompat(so,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var h_={};Object.defineProperty(h_,"__esModule",{value:!0});h_.Blur=void 0;const C5=je,NG=At,bG=ke;function T5(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const DG=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],MG=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function OG(n,e){const t=n.data,r=n.width,i=n.height;let s,o,l,c,h,p,m,_,w,S,k,N,x,R,E,P,V,B,D,T;const b=e+e+1,A=r-1,O=i-1,U=e+1,F=U*(U+1)/2,ce=new T5,le=DG[e],Me=MG[e];let be=null,$=ce,J=null,ee=null;for(let Z=1;Z<b;Z++)$=$.next=new T5,Z===U&&(be=$);$.next=ce,l=o=0;for(let Z=0;Z<i;Z++){N=x=R=E=c=h=p=m=0,_=U*(P=t[o]),w=U*(V=t[o+1]),S=U*(B=t[o+2]),k=U*(D=t[o+3]),c+=F*P,h+=F*V,p+=F*B,m+=F*D,$=ce;for(let ie=0;ie<U;ie++)$.r=P,$.g=V,$.b=B,$.a=D,$=$.next;for(let ie=1;ie<U;ie++)s=o+((A<ie?A:ie)<<2),c+=($.r=P=t[s])*(T=U-ie),h+=($.g=V=t[s+1])*T,p+=($.b=B=t[s+2])*T,m+=($.a=D=t[s+3])*T,N+=P,x+=V,R+=B,E+=D,$=$.next;J=ce,ee=be;for(let ie=0;ie<r;ie++)t[o+3]=D=m*le>>Me,D!==0?(D=255/D,t[o]=(c*le>>Me)*D,t[o+1]=(h*le>>Me)*D,t[o+2]=(p*le>>Me)*D):t[o]=t[o+1]=t[o+2]=0,c-=_,h-=w,p-=S,m-=k,_-=J.r,w-=J.g,S-=J.b,k-=J.a,s=l+((s=ie+e+1)<A?s:A)<<2,N+=J.r=t[s],x+=J.g=t[s+1],R+=J.b=t[s+2],E+=J.a=t[s+3],c+=N,h+=x,p+=R,m+=E,J=J.next,_+=P=ee.r,w+=V=ee.g,S+=B=ee.b,k+=D=ee.a,N-=P,x-=V,R-=B,E-=D,ee=ee.next,o+=4;l+=r}for(let Z=0;Z<r;Z++){x=R=E=N=h=p=m=c=0,o=Z<<2,_=U*(P=t[o]),w=U*(V=t[o+1]),S=U*(B=t[o+2]),k=U*(D=t[o+3]),c+=F*P,h+=F*V,p+=F*B,m+=F*D,$=ce;for(let _e=0;_e<U;_e++)$.r=P,$.g=V,$.b=B,$.a=D,$=$.next;let ie=r;for(let _e=1;_e<=e;_e++)o=ie+Z<<2,c+=($.r=P=t[o])*(T=U-_e),h+=($.g=V=t[o+1])*T,p+=($.b=B=t[o+2])*T,m+=($.a=D=t[o+3])*T,N+=P,x+=V,R+=B,E+=D,$=$.next,_e<O&&(ie+=r);o=Z,J=ce,ee=be;for(let _e=0;_e<i;_e++)s=o<<2,t[s+3]=D=m*le>>Me,D>0?(D=255/D,t[s]=(c*le>>Me)*D,t[s+1]=(h*le>>Me)*D,t[s+2]=(p*le>>Me)*D):t[s]=t[s+1]=t[s+2]=0,c-=_,h-=w,p-=S,m-=k,_-=J.r,w-=J.g,S-=J.b,k-=J.a,s=Z+((s=_e+U)<O?s:O)*r<<2,c+=N+=J.r=t[s],h+=x+=J.g=t[s+1],p+=R+=J.b=t[s+2],m+=E+=J.a=t[s+3],J=J.next,_+=P=ee.r,w+=V=ee.g,S+=B=ee.b,k+=D=ee.a,N-=P,x-=V,R-=B,E-=D,ee=ee.next,o+=r}}const LG=function(e){const t=Math.round(this.blurRadius());t>0&&OG(e,t)};h_.Blur=LG;C5.Factory.addGetterSetter(NG.Node,"blurRadius",0,(0,bG.getNumberValidator)(),C5.Factory.afterSetFilter);var d_={};Object.defineProperty(d_,"__esModule",{value:!0});d_.Brighten=void 0;const I5=je,FG=At,VG=ke,UG=function(n){const e=this.brightness()*255,t=n.data,r=t.length;for(let i=0;i<r;i+=4)t[i]+=e,t[i+1]+=e,t[i+2]+=e};d_.Brighten=UG;I5.Factory.addGetterSetter(FG.Node,"brightness",0,(0,VG.getNumberValidator)(),I5.Factory.afterSetFilter);var f_={};Object.defineProperty(f_,"__esModule",{value:!0});f_.Contrast=void 0;const P5=je,BG=At,zG=ke,jG=function(n){const e=Math.pow((this.contrast()+100)/100,2),t=n.data,r=t.length;let i=150,s=150,o=150;for(let l=0;l<r;l+=4)i=t[l],s=t[l+1],o=t[l+2],i/=255,i-=.5,i*=e,i+=.5,i*=255,s/=255,s-=.5,s*=e,s+=.5,s*=255,o/=255,o-=.5,o*=e,o+=.5,o*=255,i=i<0?0:i>255?255:i,s=s<0?0:s>255?255:s,o=o<0?0:o>255?255:o,t[l]=i,t[l+1]=s,t[l+2]=o};f_.Contrast=jG;P5.Factory.addGetterSetter(BG.Node,"contrast",0,(0,zG.getNumberValidator)(),P5.Factory.afterSetFilter);var p_={};Object.defineProperty(p_,"__esModule",{value:!0});p_.Emboss=void 0;const oa=je,g_=At,GG=Vt,Rx=ke,WG=function(n){const e=this.embossStrength()*10,t=this.embossWhiteLevel()*255,r=this.embossDirection(),i=this.embossBlend(),s=n.data,o=n.width,l=n.height,c=o*4;let h=0,p=0,m=l;switch(r){case"top-left":h=-1,p=-1;break;case"top":h=-1,p=0;break;case"top-right":h=-1,p=1;break;case"right":h=0,p=1;break;case"bottom-right":h=1,p=1;break;case"bottom":h=1,p=0;break;case"bottom-left":h=1,p=-1;break;case"left":h=0,p=-1;break;default:GG.Util.error("Unknown emboss direction: "+r)}do{const _=(m-1)*c;let w=h;m+w<1&&(w=0),m+w>l&&(w=0);const S=(m-1+w)*o*4;let k=o;do{const N=_+(k-1)*4;let x=p;k+x<1&&(x=0),k+x>o&&(x=0);const R=S+(k-1+x)*4,E=s[N]-s[R],P=s[N+1]-s[R+1],V=s[N+2]-s[R+2];let B=E;const D=B>0?B:-B,T=P>0?P:-P,b=V>0?V:-V;if(T>D&&(B=P),b>D&&(B=V),B*=e,i){const A=s[N]+B,O=s[N+1]+B,U=s[N+2]+B;s[N]=A>255?255:A<0?0:A,s[N+1]=O>255?255:O<0?0:O,s[N+2]=U>255?255:U<0?0:U}else{let A=t-B;A<0?A=0:A>255&&(A=255),s[N]=s[N+1]=s[N+2]=A}}while(--k)}while(--m)};p_.Emboss=WG;oa.Factory.addGetterSetter(g_.Node,"embossStrength",.5,(0,Rx.getNumberValidator)(),oa.Factory.afterSetFilter);oa.Factory.addGetterSetter(g_.Node,"embossWhiteLevel",.5,(0,Rx.getNumberValidator)(),oa.Factory.afterSetFilter);oa.Factory.addGetterSetter(g_.Node,"embossDirection","top-left",void 0,oa.Factory.afterSetFilter);oa.Factory.addGetterSetter(g_.Node,"embossBlend",!1,void 0,oa.Factory.afterSetFilter);var m_={};Object.defineProperty(m_,"__esModule",{value:!0});m_.Enhance=void 0;const k5=je,HG=At,$G=ke;function Ov(n,e,t,r,i){const s=t-e,o=i-r;if(s===0)return r+o/2;if(o===0)return r;let l=(n-e)/s;return l=o*l+r,l}const qG=function(n){const e=n.data,t=e.length;let r=e[0],i=r,s,o=e[1],l=o,c,h=e[2],p=h,m;const _=this.enhance();if(_===0)return;for(let E=0;E<t;E+=4)s=e[E+0],s<r?r=s:s>i&&(i=s),c=e[E+1],c<o?o=c:c>l&&(l=c),m=e[E+2],m<h?h=m:m>p&&(p=m);i===r&&(i=255,r=0),l===o&&(l=255,o=0),p===h&&(p=255,h=0);let w,S,k,N,x,R;if(_>0)w=i+_*(255-i),S=r-_*(r-0),k=l+_*(255-l),N=o-_*(o-0),x=p+_*(255-p),R=h-_*(h-0);else{const E=(i+r)*.5;w=i+_*(i-E),S=r+_*(r-E);const P=(l+o)*.5;k=l+_*(l-P),N=o+_*(o-P);const V=(p+h)*.5;x=p+_*(p-V),R=h+_*(h-V)}for(let E=0;E<t;E+=4)e[E+0]=Ov(e[E+0],r,i,S,w),e[E+1]=Ov(e[E+1],o,l,N,k),e[E+2]=Ov(e[E+2],h,p,R,x)};m_.Enhance=qG;k5.Factory.addGetterSetter(HG.Node,"enhance",0,(0,$G.getNumberValidator)(),k5.Factory.afterSetFilter);var __={};Object.defineProperty(__,"__esModule",{value:!0});__.Grayscale=void 0;const KG=function(n){const e=n.data,t=e.length;for(let r=0;r<t;r+=4){const i=.34*e[r]+.5*e[r+1]+.16*e[r+2];e[r]=i,e[r+1]=i,e[r+2]=i}};__.Grayscale=KG;var y_={};Object.defineProperty(y_,"__esModule",{value:!0});y_.HSL=void 0;const uc=je,wS=At,ES=ke;uc.Factory.addGetterSetter(wS.Node,"hue",0,(0,ES.getNumberValidator)(),uc.Factory.afterSetFilter);uc.Factory.addGetterSetter(wS.Node,"saturation",0,(0,ES.getNumberValidator)(),uc.Factory.afterSetFilter);uc.Factory.addGetterSetter(wS.Node,"luminance",0,(0,ES.getNumberValidator)(),uc.Factory.afterSetFilter);const QG=function(n){const e=n.data,t=e.length,r=1,i=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,o=this.luminance()*127,l=r*i*Math.cos(s*Math.PI/180),c=r*i*Math.sin(s*Math.PI/180),h=.299*r+.701*l+.167*c,p=.587*r-.587*l+.33*c,m=.114*r-.114*l-.497*c,_=.299*r-.299*l-.328*c,w=.587*r+.413*l+.035*c,S=.114*r-.114*l+.293*c,k=.299*r-.3*l+1.25*c,N=.587*r-.586*l-1.05*c,x=.114*r+.886*l-.2*c;let R,E,P,V;for(let B=0;B<t;B+=4)R=e[B+0],E=e[B+1],P=e[B+2],V=e[B+3],e[B+0]=h*R+p*E+m*P+o,e[B+1]=_*R+w*E+S*P+o,e[B+2]=k*R+N*E+x*P+o,e[B+3]=V};y_.HSL=QG;var v_={};Object.defineProperty(v_,"__esModule",{value:!0});v_.HSV=void 0;const cc=je,SS=At,CS=ke,YG=function(n){const e=n.data,t=e.length,r=Math.pow(2,this.value()),i=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,o=r*i*Math.cos(s*Math.PI/180),l=r*i*Math.sin(s*Math.PI/180),c=.299*r+.701*o+.167*l,h=.587*r-.587*o+.33*l,p=.114*r-.114*o-.497*l,m=.299*r-.299*o-.328*l,_=.587*r+.413*o+.035*l,w=.114*r-.114*o+.293*l,S=.299*r-.3*o+1.25*l,k=.587*r-.586*o-1.05*l,N=.114*r+.886*o-.2*l;for(let x=0;x<t;x+=4){const R=e[x+0],E=e[x+1],P=e[x+2],V=e[x+3];e[x+0]=c*R+h*E+p*P,e[x+1]=m*R+_*E+w*P,e[x+2]=S*R+k*E+N*P,e[x+3]=V}};v_.HSV=YG;cc.Factory.addGetterSetter(SS.Node,"hue",0,(0,CS.getNumberValidator)(),cc.Factory.afterSetFilter);cc.Factory.addGetterSetter(SS.Node,"saturation",0,(0,CS.getNumberValidator)(),cc.Factory.afterSetFilter);cc.Factory.addGetterSetter(SS.Node,"value",0,(0,CS.getNumberValidator)(),cc.Factory.afterSetFilter);var w_={};Object.defineProperty(w_,"__esModule",{value:!0});w_.Invert=void 0;const XG=function(n){const e=n.data,t=e.length;for(let r=0;r<t;r+=4)e[r]=255-e[r],e[r+1]=255-e[r+1],e[r+2]=255-e[r+2]};w_.Invert=XG;var E_={};Object.defineProperty(E_,"__esModule",{value:!0});E_.Kaleidoscope=void 0;const Lm=je,xx=At,R5=Vt,Ax=ke,JG=function(n,e,t){const r=n.data,i=e.data,s=n.width,o=n.height,l=t.polarCenterX||s/2,c=t.polarCenterY||o/2;let h=Math.sqrt(l*l+c*c),p=s-l,m=o-c;const _=Math.sqrt(p*p+m*m);h=_>h?_:h;const w=o,S=s,k=360/S*Math.PI/180;for(let N=0;N<S;N+=1){const x=Math.sin(N*k),R=Math.cos(N*k);for(let E=0;E<w;E+=1){p=Math.floor(l+h*E/w*R),m=Math.floor(c+h*E/w*x);let P=(m*s+p)*4;const V=r[P+0],B=r[P+1],D=r[P+2],T=r[P+3];P=(N+E*s)*4,i[P+0]=V,i[P+1]=B,i[P+2]=D,i[P+3]=T}}},ZG=function(n,e,t){const r=n.data,i=e.data,s=n.width,o=n.height,l=t.polarCenterX||s/2,c=t.polarCenterY||o/2;let h=Math.sqrt(l*l+c*c),p=s-l,m=o-c;const _=Math.sqrt(p*p+m*m);h=_>h?_:h;const w=o,S=s,k=0;let N,x;for(p=0;p<s;p+=1)for(m=0;m<o;m+=1){const R=p-l,E=m-c,P=Math.sqrt(R*R+E*E)*w/h;let V=(Math.atan2(E,R)*180/Math.PI+360+k)%360;V=V*S/360,N=Math.floor(V),x=Math.floor(P);let B=(x*s+N)*4;const D=r[B+0],T=r[B+1],b=r[B+2],A=r[B+3];B=(m*s+p)*4,i[B+0]=D,i[B+1]=T,i[B+2]=b,i[B+3]=A}},eW=function(n){const e=n.width,t=n.height;let r,i,s,o,l,c,h,p,m,_,w=Math.round(this.kaleidoscopePower());const S=Math.round(this.kaleidoscopeAngle()),k=Math.floor(e*(S%360)/360);if(w<1)return;const N=R5.Util.createCanvasElement();N.width=e,N.height=t;const x=N.getContext("2d").getImageData(0,0,e,t);R5.Util.releaseCanvas(N),JG(n,x,{polarCenterX:e/2,polarCenterY:t/2});let R=e/Math.pow(2,w);for(;R<=8;)R=R*2,w-=1;R=Math.ceil(R);let E=R,P=0,V=E,B=1;for(k+R>e&&(P=E,V=0,B=-1),i=0;i<t;i+=1)for(r=P;r!==V;r+=B)s=Math.round(r+k)%e,m=(e*i+s)*4,l=x.data[m+0],c=x.data[m+1],h=x.data[m+2],p=x.data[m+3],_=(e*i+r)*4,x.data[_+0]=l,x.data[_+1]=c,x.data[_+2]=h,x.data[_+3]=p;for(i=0;i<t;i+=1)for(E=Math.floor(R),o=0;o<w;o+=1){for(r=0;r<E+1;r+=1)m=(e*i+r)*4,l=x.data[m+0],c=x.data[m+1],h=x.data[m+2],p=x.data[m+3],_=(e*i+E*2-r-1)*4,x.data[_+0]=l,x.data[_+1]=c,x.data[_+2]=h,x.data[_+3]=p;E*=2}ZG(x,n,{})};E_.Kaleidoscope=eW;Lm.Factory.addGetterSetter(xx.Node,"kaleidoscopePower",2,(0,Ax.getNumberValidator)(),Lm.Factory.afterSetFilter);Lm.Factory.addGetterSetter(xx.Node,"kaleidoscopeAngle",0,(0,Ax.getNumberValidator)(),Lm.Factory.afterSetFilter);var S_={};Object.defineProperty(S_,"__esModule",{value:!0});S_.Mask=void 0;const x5=je,tW=At,nW=ke;function ng(n,e,t){let r=(t*n.width+e)*4;const i=[];return i.push(n.data[r++],n.data[r++],n.data[r++],n.data[r++]),i}function Nh(n,e){return Math.sqrt(Math.pow(n[0]-e[0],2)+Math.pow(n[1]-e[1],2)+Math.pow(n[2]-e[2],2))}function rW(n){const e=[0,0,0];for(let t=0;t<n.length;t++)e[0]+=n[t][0],e[1]+=n[t][1],e[2]+=n[t][2];return e[0]/=n.length,e[1]/=n.length,e[2]/=n.length,e}function iW(n,e){const t=ng(n,0,0),r=ng(n,n.width-1,0),i=ng(n,0,n.height-1),s=ng(n,n.width-1,n.height-1),o=e||10;if(Nh(t,r)<o&&Nh(r,s)<o&&Nh(s,i)<o&&Nh(i,t)<o){const l=rW([r,t,s,i]),c=[];for(let h=0;h<n.width*n.height;h++){const p=Nh(l,[n.data[h*4],n.data[h*4+1],n.data[h*4+2]]);c[h]=p<o?0:255}return c}}function sW(n,e){for(let t=0;t<n.width*n.height;t++)n.data[4*t+3]=e[t]}function oW(n,e,t){const r=[1,1,1,1,0,1,1,1,1],i=Math.round(Math.sqrt(r.length)),s=Math.floor(i/2),o=[];for(let l=0;l<t;l++)for(let c=0;c<e;c++){const h=l*e+c;let p=0;for(let m=0;m<i;m++)for(let _=0;_<i;_++){const w=l+m-s,S=c+_-s;if(w>=0&&w<t&&S>=0&&S<e){const k=w*e+S,N=r[m*i+_];p+=n[k]*N}}o[h]=p===255*8?255:0}return o}function aW(n,e,t){const r=[1,1,1,1,1,1,1,1,1],i=Math.round(Math.sqrt(r.length)),s=Math.floor(i/2),o=[];for(let l=0;l<t;l++)for(let c=0;c<e;c++){const h=l*e+c;let p=0;for(let m=0;m<i;m++)for(let _=0;_<i;_++){const w=l+m-s,S=c+_-s;if(w>=0&&w<t&&S>=0&&S<e){const k=w*e+S,N=r[m*i+_];p+=n[k]*N}}o[h]=p>=255*4?255:0}return o}function lW(n,e,t){const r=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],i=Math.round(Math.sqrt(r.length)),s=Math.floor(i/2),o=[];for(let l=0;l<t;l++)for(let c=0;c<e;c++){const h=l*e+c;let p=0;for(let m=0;m<i;m++)for(let _=0;_<i;_++){const w=l+m-s,S=c+_-s;if(w>=0&&w<t&&S>=0&&S<e){const k=w*e+S,N=r[m*i+_];p+=n[k]*N}}o[h]=p}return o}const uW=function(n){const e=this.threshold();let t=iW(n,e);return t&&(t=oW(t,n.width,n.height),t=aW(t,n.width,n.height),t=lW(t,n.width,n.height),sW(n,t)),n};S_.Mask=uW;x5.Factory.addGetterSetter(tW.Node,"threshold",0,(0,nW.getNumberValidator)(),x5.Factory.afterSetFilter);var C_={};Object.defineProperty(C_,"__esModule",{value:!0});C_.Noise=void 0;const A5=je,cW=At,hW=ke,dW=function(n){const e=this.noise()*255,t=n.data,r=t.length,i=e/2;for(let s=0;s<r;s+=4)t[s+0]+=i-2*i*Math.random(),t[s+1]+=i-2*i*Math.random(),t[s+2]+=i-2*i*Math.random()};C_.Noise=dW;A5.Factory.addGetterSetter(cW.Node,"noise",.2,(0,hW.getNumberValidator)(),A5.Factory.afterSetFilter);var T_={};Object.defineProperty(T_,"__esModule",{value:!0});T_.Pixelate=void 0;const N5=je,fW=Vt,pW=At,gW=ke,mW=function(n){let e=Math.ceil(this.pixelSize()),t=n.width,r=n.height,i=Math.ceil(t/e),s=Math.ceil(r/e),o=n.data;if(e<=0){fW.Util.error("pixelSize value can not be <= 0");return}for(let l=0;l<i;l+=1)for(let c=0;c<s;c+=1){let h=0,p=0,m=0,_=0;const w=l*e,S=w+e,k=c*e,N=k+e;let x=0;for(let R=w;R<S;R+=1)if(!(R>=t))for(let E=k;E<N;E+=1){if(E>=r)continue;const P=(t*E+R)*4;h+=o[P+0],p+=o[P+1],m+=o[P+2],_+=o[P+3],x+=1}h=h/x,p=p/x,m=m/x,_=_/x;for(let R=w;R<S;R+=1)if(!(R>=t))for(let E=k;E<N;E+=1){if(E>=r)continue;const P=(t*E+R)*4;o[P+0]=h,o[P+1]=p,o[P+2]=m,o[P+3]=_}}};T_.Pixelate=mW;N5.Factory.addGetterSetter(pW.Node,"pixelSize",8,(0,gW.getNumberValidator)(),N5.Factory.afterSetFilter);var I_={};Object.defineProperty(I_,"__esModule",{value:!0});I_.Posterize=void 0;const b5=je,_W=At,yW=ke,vW=function(n){const e=Math.round(this.levels()*254)+1,t=n.data,r=t.length,i=255/e;for(let s=0;s<r;s+=1)t[s]=Math.floor(t[s]/i)*i};I_.Posterize=vW;b5.Factory.addGetterSetter(_W.Node,"levels",.5,(0,yW.getNumberValidator)(),b5.Factory.afterSetFilter);var P_={};Object.defineProperty(P_,"__esModule",{value:!0});P_.RGB=void 0;const Fm=je,TS=At,wW=ke,EW=function(n){const e=n.data,t=e.length,r=this.red(),i=this.green(),s=this.blue();for(let o=0;o<t;o+=4){const l=(.34*e[o]+.5*e[o+1]+.16*e[o+2])/255;e[o]=l*r,e[o+1]=l*i,e[o+2]=l*s,e[o+3]=e[o+3]}};P_.RGB=EW;Fm.Factory.addGetterSetter(TS.Node,"red",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)});Fm.Factory.addGetterSetter(TS.Node,"green",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)});Fm.Factory.addGetterSetter(TS.Node,"blue",0,wW.RGBComponent,Fm.Factory.afterSetFilter);var k_={};Object.defineProperty(k_,"__esModule",{value:!0});k_.RGBA=void 0;const $d=je,R_=At,SW=ke,CW=function(n){const e=n.data,t=e.length,r=this.red(),i=this.green(),s=this.blue(),o=this.alpha();for(let l=0;l<t;l+=4){const c=1-o;e[l]=r*o+e[l]*c,e[l+1]=i*o+e[l+1]*c,e[l+2]=s*o+e[l+2]*c}};k_.RGBA=CW;$d.Factory.addGetterSetter(R_.Node,"red",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)});$d.Factory.addGetterSetter(R_.Node,"green",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)});$d.Factory.addGetterSetter(R_.Node,"blue",0,SW.RGBComponent,$d.Factory.afterSetFilter);$d.Factory.addGetterSetter(R_.Node,"alpha",1,function(n){return this._filterUpToDate=!1,n>1?1:n<0?0:n});var x_={};Object.defineProperty(x_,"__esModule",{value:!0});x_.Sepia=void 0;const TW=function(n){const e=n.data,t=e.length;for(let r=0;r<t;r+=4){const i=e[r+0],s=e[r+1],o=e[r+2];e[r+0]=Math.min(255,i*.393+s*.769+o*.189),e[r+1]=Math.min(255,i*.349+s*.686+o*.168),e[r+2]=Math.min(255,i*.272+s*.534+o*.131)}};x_.Sepia=TW;var A_={};Object.defineProperty(A_,"__esModule",{value:!0});A_.Solarize=void 0;const IW=function(n){const e=n.data,t=n.width,r=n.height,i=t*4;let s=r;do{const o=(s-1)*i;let l=t;do{const c=o+(l-1)*4;let h=e[c],p=e[c+1],m=e[c+2];h>127&&(h=255-h),p>127&&(p=255-p),m>127&&(m=255-m),e[c]=h,e[c+1]=p,e[c+2]=m}while(--l)}while(--s)};A_.Solarize=IW;var N_={};Object.defineProperty(N_,"__esModule",{value:!0});N_.Threshold=void 0;const D5=je,PW=At,kW=ke,RW=function(n){const e=this.threshold()*255,t=n.data,r=t.length;for(let i=0;i<r;i+=1)t[i]=t[i]<e?0:255};N_.Threshold=RW;D5.Factory.addGetterSetter(PW.Node,"threshold",.5,(0,kW.getNumberValidator)(),D5.Factory.afterSetFilter);Object.defineProperty(z0,"__esModule",{value:!0});z0.Konva=void 0;const M5=Dm,xW=$0,AW=Q0,NW=J0,bW=Z0,DW=e_,O5=lc,MW=Sf,OW=Ac,LW=Tf,FW=r_,VW=i_,UW=s_,BW=o_,zW=bc,jW=a_,GW=l_,WW=u_,HW=h_,$W=d_,qW=f_,KW=p_,QW=m_,YW=__,XW=y_,JW=v_,ZW=w_,eH=E_,tH=S_,nH=C_,rH=T_,iH=I_,sH=P_,oH=k_,aH=x_,lH=A_,uH=N_;z0.Konva=M5.Konva.Util._assign(M5.Konva,{Arc:xW.Arc,Arrow:AW.Arrow,Circle:NW.Circle,Ellipse:bW.Ellipse,Image:DW.Image,Label:O5.Label,Tag:O5.Tag,Line:MW.Line,Path:OW.Path,Rect:LW.Rect,RegularPolygon:FW.RegularPolygon,Ring:VW.Ring,Sprite:UW.Sprite,Star:BW.Star,Text:zW.Text,TextPath:jW.TextPath,Transformer:GW.Transformer,Wedge:WW.Wedge,Filters:{Blur:HW.Blur,Brighten:$W.Brighten,Contrast:qW.Contrast,Emboss:KW.Emboss,Enhance:QW.Enhance,Grayscale:YW.Grayscale,HSL:XW.HSL,HSV:JW.HSV,Invert:ZW.Invert,Kaleidoscope:eH.Kaleidoscope,Mask:tH.Mask,Noise:nH.Noise,Pixelate:rH.Pixelate,Posterize:iH.Posterize,RGB:sH.RGB,RGBA:oH.RGBA,Sepia:aH.Sepia,Solarize:lH.Solarize,Threshold:uH.Threshold}});var cH=Y9.exports;Object.defineProperty(cH,"__esModule",{value:!0});const hH=z0;Y9.exports=hH.Konva;var D2={exports:{}};(function(n,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;var t=Dm;Object.defineProperty(e,"Konva",{enumerable:!0,get:function(){return t.Konva}});const r=Dm;n.exports=r.Konva})(D2,D2.exports);var dH=D2.exports;const qd=Bm(dH);var Nx={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fH=function(e){var t={},r=ue,i=Gh,s=Object.assign;function o(a){for(var u="https://reactjs.org/docs/error-decoder.html?invariant="+a,f=1;f<arguments.length;f++)u+="&args[]="+encodeURIComponent(arguments[f]);return"Minified React error #"+a+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var l=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,c=Symbol.for("react.element"),h=Symbol.for("react.portal"),p=Symbol.for("react.fragment"),m=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),w=Symbol.for("react.provider"),S=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),x=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),P=Symbol.for("react.offscreen"),V=Symbol.iterator;function B(a){return a===null||typeof a!="object"?null:(a=V&&a[V]||a["@@iterator"],typeof a=="function"?a:null)}function D(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case p:return"Fragment";case h:return"Portal";case _:return"Profiler";case m:return"StrictMode";case N:return"Suspense";case x:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case S:return(a.displayName||"Context")+".Consumer";case w:return(a._context.displayName||"Context")+".Provider";case k:var u=a.render;return a=a.displayName,a||(a=u.displayName||u.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case R:return u=a.displayName||null,u!==null?u:D(a.type)||"Memo";case E:u=a._payload,a=a._init;try{return D(a(u))}catch{}}return null}function T(a){var u=a.type;switch(a.tag){case 24:return"Cache";case 9:return(u.displayName||"Context")+".Consumer";case 10:return(u._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=u.render,a=a.displayName||a.name||"",u.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return u;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return D(u);case 8:return u===m?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u}return null}function b(a){var u=a,f=a;if(a.alternate)for(;u.return;)u=u.return;else{a=u;do u=a,u.flags&4098&&(f=u.return),a=u.return;while(a)}return u.tag===3?f:null}function A(a){if(b(a)!==a)throw Error(o(188))}function O(a){var u=a.alternate;if(!u){if(u=b(a),u===null)throw Error(o(188));return u!==a?null:a}for(var f=a,g=u;;){var y=f.return;if(y===null)break;var C=y.alternate;if(C===null){if(g=y.return,g!==null){f=g;continue}break}if(y.child===C.child){for(C=y.child;C;){if(C===f)return A(y),a;if(C===g)return A(y),u;C=C.sibling}throw Error(o(188))}if(f.return!==g.return)f=y,g=C;else{for(var L=!1,G=y.child;G;){if(G===f){L=!0,f=y,g=C;break}if(G===g){L=!0,g=y,f=C;break}G=G.sibling}if(!L){for(G=C.child;G;){if(G===f){L=!0,f=C,g=y;break}if(G===g){L=!0,g=C,f=y;break}G=G.sibling}if(!L)throw Error(o(189))}}if(f.alternate!==g)throw Error(o(190))}if(f.tag!==3)throw Error(o(188));return f.stateNode.current===f?a:u}function U(a){return a=O(a),a!==null?F(a):null}function F(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var u=F(a);if(u!==null)return u;a=a.sibling}return null}function ce(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){if(a.tag!==4){var u=ce(a);if(u!==null)return u}a=a.sibling}return null}var le=Array.isArray,Me=e.getPublicInstance,be=e.getRootHostContext,$=e.getChildHostContext,J=e.prepareForCommit,ee=e.resetAfterCommit,Z=e.createInstance,ie=e.appendInitialChild,_e=e.finalizeInitialChildren,Tt=e.prepareUpdate,dt=e.shouldSetTextContent,Ve=e.createTextInstance,j=e.scheduleTimeout,te=e.cancelTimeout,ve=e.noTimeout,De=e.isPrimaryRenderer,Ce=e.supportsMutation,Qe=e.supportsPersistence,lt=e.supportsHydration,Kt=e.getInstanceFromNode,Ge=e.preparePortalMount,ur=e.getCurrentEventPriority,Fr=e.detachDeletedInstance,Fi=e.supportsMicrotasks,If=e.scheduleMicrotask,ds=e.supportsTestSelectors,Pf=e.findFiberRoot,O_=e.getBoundingRect,Mc=e.getTextContent,fs=e.isHiddenSubtree,kf=e.matchAccessibilityRole,fn=e.setFocusIfFocusable,xn=e.setupIntersectionObserver,Ll=e.appendChild,Rf=e.appendChildToContainer,xf=e.commitTextUpdate,L_=e.commitMount,Pa=e.commitUpdate,Af=e.insertBefore,Nf=e.insertInContainerBefore,Oc=e.removeChild,F_=e.removeChildFromContainer,bf=e.resetTextContent,Lc=e.hideInstance,Df=e.hideTextInstance,Mf=e.unhideInstance,ka=e.unhideTextInstance,Fc=e.clearContainer,Vc=e.cloneInstance,Vi=e.createContainerChildSet,Uc=e.appendChildToContainerChildSet,Fl=e.finalizeContainerChildren,Vl=e.replaceContainerChildren,oo=e.cloneHiddenInstance,Bc=e.cloneHiddenTextInstance,An=e.canHydrateInstance,Of=e.canHydrateTextInstance,Ra=e.canHydrateSuspenseInstance,ao=e.isSuspenseInstancePending,zc=e.isSuspenseInstanceFallback,V_=e.getSuspenseInstanceFallbackErrorDetails,lo=e.registerSuspenseInstanceRetry,Ul=e.getNextHydratableSibling,U_=e.getFirstHydratableChild,Bl=e.getFirstHydratableChildWithinContainer,Lf=e.getFirstHydratableChildWithinSuspenseInstance,jc=e.hydrateInstance,zl=e.hydrateTextInstance,Ui=e.hydrateSuspenseInstance,Ff=e.getNextHydratableInstanceAfterSuspenseInstance,Vf=e.commitHydratedContainer,Gc=e.commitHydratedSuspenseInstance,Wc=e.clearSuspenseBoundary,Uf=e.clearSuspenseBoundaryFromContainer,Bf=e.shouldDeleteUnhydratedTailInstances,B_=e.didNotMatchHydratedContainerTextInstance,jl=e.didNotMatchHydratedTextInstance,Gl;function ps(a){if(Gl===void 0)try{throw Error()}catch(f){var u=f.stack.trim().match(/\n( *(at )?)/);Gl=u&&u[1]||""}return`
`+Gl+a}var gs=!1;function hi(a,u){if(!a||gs)return"";gs=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(u)if(u=function(){throw Error()},Object.defineProperty(u.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(u,[])}catch(se){var g=se}Reflect.construct(a,[],u)}else{try{u.call()}catch(se){g=se}a.call(u.prototype)}else{try{throw Error()}catch(se){g=se}a()}}catch(se){if(se&&g&&typeof se.stack=="string"){for(var y=se.stack.split(`
`),C=g.stack.split(`
`),L=y.length-1,G=C.length-1;1<=L&&0<=G&&y[L]!==C[G];)G--;for(;1<=L&&0<=G;L--,G--)if(y[L]!==C[G]){if(L!==1||G!==1)do if(L--,G--,0>G||y[L]!==C[G]){var K=`
`+y[L].replace(" at new "," at ");return a.displayName&&K.includes("<anonymous>")&&(K=K.replace("<anonymous>",a.displayName)),K}while(1<=L&&0<=G);break}}}finally{gs=!1,Error.prepareStackTrace=f}return(a=a?a.displayName||a.name:"")?ps(a):""}var Hc=Object.prototype.hasOwnProperty,$c=[],ms=-1;function di(a){return{current:a}}function ft(a){0>ms||(a.current=$c[ms],$c[ms]=null,ms--)}function ut(a,u){ms++,$c[ms]=a.current,a.current=u}var qr={},nn=di(qr),Nn=di(!1),_s=qr;function uo(a,u){var f=a.type.contextTypes;if(!f)return qr;var g=a.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===u)return g.__reactInternalMemoizedMaskedChildContext;var y={},C;for(C in f)y[C]=u[C];return g&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=u,a.__reactInternalMemoizedMaskedChildContext=y),y}function bn(a){return a=a.childContextTypes,a!=null}function xa(){ft(Nn),ft(nn)}function zf(a,u,f){if(nn.current!==qr)throw Error(o(168));ut(nn,u),ut(Nn,f)}function Bi(a,u,f){var g=a.stateNode;if(u=u.childContextTypes,typeof g.getChildContext!="function")return f;g=g.getChildContext();for(var y in g)if(!(y in u))throw Error(o(108,T(a)||"Unknown",y));return s({},f,g)}function Sr(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||qr,_s=nn.current,ut(nn,a),ut(Nn,Nn.current),!0}function Aa(a,u,f){var g=a.stateNode;if(!g)throw Error(o(169));f?(a=Bi(a,u,_s),g.__reactInternalMemoizedMergedChildContext=a,ft(Nn),ft(nn),ut(nn,a)):ft(Nn),ut(Nn,f)}var Gn=Math.clz32?Math.clz32:Wl,jf=Math.log,mt=Math.LN2;function Wl(a){return a>>>=0,a===0?32:31-(jf(a)/mt|0)|0}var zi=64,ji=4194304;function Na(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function ba(a,u){var f=a.pendingLanes;if(f===0)return 0;var g=0,y=a.suspendedLanes,C=a.pingedLanes,L=f&268435455;if(L!==0){var G=L&~y;G!==0?g=Na(G):(C&=L,C!==0&&(g=Na(C)))}else L=f&~y,L!==0?g=Na(L):C!==0&&(g=Na(C));if(g===0)return 0;if(u!==0&&u!==g&&!(u&y)&&(y=g&-g,C=u&-u,y>=C||y===16&&(C&4194240)!==0))return u;if(g&4&&(g|=f&16),u=a.entangledLanes,u!==0)for(a=a.entanglements,u&=g;0<u;)f=31-Gn(u),y=1<<f,g|=a[f],u&=~y;return g}function z_(a,u){switch(a){case 1:case 2:case 4:return u+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function j_(a,u){for(var f=a.suspendedLanes,g=a.pingedLanes,y=a.expirationTimes,C=a.pendingLanes;0<C;){var L=31-Gn(C),G=1<<L,K=y[L];K===-1?(!(G&f)||G&g)&&(y[L]=z_(G,u)):K<=u&&(a.expiredLanes|=G),C&=~G}}function qc(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function Gf(){var a=zi;return zi<<=1,!(zi&4194240)&&(zi=64),a}function ys(a){for(var u=[],f=0;31>f;f++)u.push(a);return u}function Cr(a,u,f){a.pendingLanes|=u,u!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,u=31-Gn(u),a[u]=f}function Wf(a,u){var f=a.pendingLanes&~u;a.pendingLanes=u,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=u,a.mutableReadLanes&=u,a.entangledLanes&=u,u=a.entanglements;var g=a.eventTimes;for(a=a.expirationTimes;0<f;){var y=31-Gn(f),C=1<<y;u[y]=0,g[y]=-1,a[y]=-1,f&=~C}}function Hl(a,u){var f=a.entangledLanes|=u;for(a=a.entanglements;f;){var g=31-Gn(f),y=1<<g;y&u|a[g]&u&&(a[g]|=u),f&=~y}}var Ye=0;function vs(a){return a&=-a,1<a?4<a?a&268435455?16:536870912:4:1}var Kc=i.unstable_scheduleCallback,Hf=i.unstable_cancelCallback,G_=i.unstable_shouldYield,Gi=i.unstable_requestPaint,Qt=i.unstable_now,Qc=i.unstable_ImmediatePriority,$l=i.unstable_UserBlockingPriority,co=i.unstable_NormalPriority,$f=i.unstable_IdlePriority,Wi=null,Wn=null;function qf(a){if(Wn&&typeof Wn.onCommitFiberRoot=="function")try{Wn.onCommitFiberRoot(Wi,a,void 0,(a.current.flags&128)===128)}catch{}}function Yc(a,u){return a===u&&(a!==0||1/a===1/u)||a!==a&&u!==u}var Je=typeof Object.is=="function"?Object.is:Yc,fi=null,ql=!1,Kl=!1;function Xc(a){fi===null?fi=[a]:fi.push(a)}function Kf(a){ql=!0,Xc(a)}function cr(){if(!Kl&&fi!==null){Kl=!0;var a=0,u=Ye;try{var f=fi;for(Ye=1;a<f.length;a++){var g=f[a];do g=g(!0);while(g!==null)}fi=null,ql=!1}catch(y){throw fi!==null&&(fi=fi.slice(a+1)),Kc(Qc,cr),y}finally{Ye=u,Kl=!1}}return null}var ws=[],Hn=0,Da=null,Ql=0,pn=[],hr=0,pi=null,Tr=1,Kr="";function Qr(a,u){ws[Hn++]=Ql,ws[Hn++]=Da,Da=a,Ql=u}function Qf(a,u,f){pn[hr++]=Tr,pn[hr++]=Kr,pn[hr++]=pi,pi=a;var g=Tr;a=Kr;var y=32-Gn(g)-1;g&=~(1<<y),f+=1;var C=32-Gn(u)+y;if(30<C){var L=y-y%5;C=(g&(1<<L)-1).toString(32),g>>=L,y-=L,Tr=1<<32-Gn(u)+y|f<<y|g,Kr=C+a}else Tr=1<<C|f<<y|g,Kr=a}function Yl(a){a.return!==null&&(Qr(a,1),Qf(a,1,0))}function Es(a){for(;a===Da;)Da=ws[--Hn],ws[Hn]=null,Ql=ws[--Hn],ws[Hn]=null;for(;a===pi;)pi=pn[--hr],pn[hr]=null,Kr=pn[--hr],pn[hr]=null,Tr=pn[--hr],pn[hr]=null}var $n=null,dr=null,pt=!1,Ss=!1,Ir=null;function Ma(a,u){var f=ei(5,null,null,0);f.elementType="DELETED",f.stateNode=u,f.return=a,u=a.deletions,u===null?(a.deletions=[f],a.flags|=16):u.push(f)}function Jc(a,u){switch(a.tag){case 5:return u=An(u,a.type,a.pendingProps),u!==null?(a.stateNode=u,$n=a,dr=U_(u),!0):!1;case 6:return u=Of(u,a.pendingProps),u!==null?(a.stateNode=u,$n=a,dr=null,!0):!1;case 13:if(u=Ra(u),u!==null){var f=pi!==null?{id:Tr,overflow:Kr}:null;return a.memoizedState={dehydrated:u,treeContext:f,retryLane:1073741824},f=ei(18,null,null,0),f.stateNode=u,f.return=a,a.child=f,$n=a,dr=null,!0}return!1;default:return!1}}function Xl(a){return(a.mode&1)!==0&&(a.flags&128)===0}function gi(a){if(pt){var u=dr;if(u){var f=u;if(!Jc(a,u)){if(Xl(a))throw Error(o(418));u=Ul(f);var g=$n;u&&Jc(a,u)?Ma(g,f):(a.flags=a.flags&-4097|2,pt=!1,$n=a)}}else{if(Xl(a))throw Error(o(418));a.flags=a.flags&-4097|2,pt=!1,$n=a}}}function Zc(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;$n=a}function Oa(a){if(!lt||a!==$n)return!1;if(!pt)return Zc(a),pt=!0,!1;if(a.tag!==3&&(a.tag!==5||Bf(a.type)&&!dt(a.type,a.memoizedProps))){var u=dr;if(u){if(Xl(a))throw eh(),Error(o(418));for(;u;)Ma(a,u),u=Ul(u)}}if(Zc(a),a.tag===13){if(!lt)throw Error(o(316));if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(o(317));dr=Ff(a)}else dr=$n?Ul(a.stateNode):null;return!0}function eh(){for(var a=dr;a;)a=Ul(a)}function Cs(){lt&&(dr=$n=null,Ss=pt=!1)}function ho(a){Ir===null?Ir=[a]:Ir.push(a)}var fr=l.ReactCurrentBatchConfig;function La(a,u){if(Je(a,u))return!0;if(typeof a!="object"||a===null||typeof u!="object"||u===null)return!1;var f=Object.keys(a),g=Object.keys(u);if(f.length!==g.length)return!1;for(g=0;g<f.length;g++){var y=f[g];if(!Hc.call(u,y)||!Je(a[y],u[y]))return!1}return!0}function Yf(a){switch(a.tag){case 5:return ps(a.type);case 16:return ps("Lazy");case 13:return ps("Suspense");case 19:return ps("SuspenseList");case 0:case 2:case 15:return a=hi(a.type,!1),a;case 11:return a=hi(a.type.render,!1),a;case 1:return a=hi(a.type,!0),a;default:return""}}function Yr(a,u,f){if(a=f.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(f._owner){if(f=f._owner,f){if(f.tag!==1)throw Error(o(309));var g=f.stateNode}if(!g)throw Error(o(147,a));var y=g,C=""+a;return u!==null&&u.ref!==null&&typeof u.ref=="function"&&u.ref._stringRef===C?u.ref:(u=function(L){var G=y.refs;L===null?delete G[C]:G[C]=L},u._stringRef=C,u)}if(typeof a!="string")throw Error(o(284));if(!f._owner)throw Error(o(290,a))}return a}function d(a,u){throw a=Object.prototype.toString.call(u),Error(o(31,a==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":a))}function v(a){var u=a._init;return u(a._payload)}function I(a){function u(q,W){if(a){var Y=q.deletions;Y===null?(q.deletions=[W],q.flags|=16):Y.push(W)}}function f(q,W){if(!a)return null;for(;W!==null;)u(q,W),W=W.sibling;return null}function g(q,W){for(q=new Map;W!==null;)W.key!==null?q.set(W.key,W):q.set(W.index,W),W=W.sibling;return q}function y(q,W){return q=vo(q,W),q.index=0,q.sibling=null,q}function C(q,W,Y){return q.index=Y,a?(Y=q.alternate,Y!==null?(Y=Y.index,Y<W?(q.flags|=2,W):Y):(q.flags|=2,W)):(q.flags|=1048576,W)}function L(q){return a&&q.alternate===null&&(q.flags|=2),q}function G(q,W,Y,fe){return W===null||W.tag!==6?(W=My(Y,q.mode,fe),W.return=q,W):(W=y(W,Y),W.return=q,W)}function K(q,W,Y,fe){var Ee=Y.type;return Ee===p?me(q,W,Y.props.children,fe,Y.key):W!==null&&(W.elementType===Ee||typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===E&&v(Ee)===W.type)?(fe=y(W,Y.props),fe.ref=Yr(q,W,Y),fe.return=q,fe):(fe=Ip(Y.type,Y.key,Y.props,null,q.mode,fe),fe.ref=Yr(q,W,Y),fe.return=q,fe)}function se(q,W,Y,fe){return W===null||W.tag!==4||W.stateNode.containerInfo!==Y.containerInfo||W.stateNode.implementation!==Y.implementation?(W=Oy(Y,q.mode,fe),W.return=q,W):(W=y(W,Y.children||[]),W.return=q,W)}function me(q,W,Y,fe,Ee){return W===null||W.tag!==7?(W=ja(Y,q.mode,fe,Ee),W.return=q,W):(W=y(W,Y),W.return=q,W)}function Ae(q,W,Y){if(typeof W=="string"&&W!==""||typeof W=="number")return W=My(""+W,q.mode,Y),W.return=q,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case c:return Y=Ip(W.type,W.key,W.props,null,q.mode,Y),Y.ref=Yr(q,null,W),Y.return=q,Y;case h:return W=Oy(W,q.mode,Y),W.return=q,W;case E:var fe=W._init;return Ae(q,fe(W._payload),Y)}if(le(W)||B(W))return W=ja(W,q.mode,Y,null),W.return=q,W;d(q,W)}return null}function he(q,W,Y,fe){var Ee=W!==null?W.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number")return Ee!==null?null:G(q,W,""+Y,fe);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case c:return Y.key===Ee?K(q,W,Y,fe):null;case h:return Y.key===Ee?se(q,W,Y,fe):null;case E:return Ee=Y._init,he(q,W,Ee(Y._payload),fe)}if(le(Y)||B(Y))return Ee!==null?null:me(q,W,Y,fe,null);d(q,Y)}return null}function It(q,W,Y,fe,Ee){if(typeof fe=="string"&&fe!==""||typeof fe=="number")return q=q.get(Y)||null,G(W,q,""+fe,Ee);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case c:return q=q.get(fe.key===null?Y:fe.key)||null,K(W,q,fe,Ee);case h:return q=q.get(fe.key===null?Y:fe.key)||null,se(W,q,fe,Ee);case E:var Oe=fe._init;return It(q,W,Y,Oe(fe._payload),Ee)}if(le(fe)||B(fe))return q=q.get(Y)||null,me(W,q,fe,Ee,null);d(W,fe)}return null}function _t(q,W,Y,fe){for(var Ee=null,Oe=null,Ne=W,rt=W=0,yn=null;Ne!==null&&rt<Y.length;rt++){Ne.index>rt?(yn=Ne,Ne=null):yn=Ne.sibling;var it=he(q,Ne,Y[rt],fe);if(it===null){Ne===null&&(Ne=yn);break}a&&Ne&&it.alternate===null&&u(q,Ne),W=C(it,W,rt),Oe===null?Ee=it:Oe.sibling=it,Oe=it,Ne=yn}if(rt===Y.length)return f(q,Ne),pt&&Qr(q,rt),Ee;if(Ne===null){for(;rt<Y.length;rt++)Ne=Ae(q,Y[rt],fe),Ne!==null&&(W=C(Ne,W,rt),Oe===null?Ee=Ne:Oe.sibling=Ne,Oe=Ne);return pt&&Qr(q,rt),Ee}for(Ne=g(q,Ne);rt<Y.length;rt++)yn=It(Ne,q,rt,Y[rt],fe),yn!==null&&(a&&yn.alternate!==null&&Ne.delete(yn.key===null?rt:yn.key),W=C(yn,W,rt),Oe===null?Ee=yn:Oe.sibling=yn,Oe=yn);return a&&Ne.forEach(function(wo){return u(q,wo)}),pt&&Qr(q,rt),Ee}function xr(q,W,Y,fe){var Ee=B(Y);if(typeof Ee!="function")throw Error(o(150));if(Y=Ee.call(Y),Y==null)throw Error(o(151));for(var Oe=Ee=null,Ne=W,rt=W=0,yn=null,it=Y.next();Ne!==null&&!it.done;rt++,it=Y.next()){Ne.index>rt?(yn=Ne,Ne=null):yn=Ne.sibling;var wo=he(q,Ne,it.value,fe);if(wo===null){Ne===null&&(Ne=yn);break}a&&Ne&&wo.alternate===null&&u(q,Ne),W=C(wo,W,rt),Oe===null?Ee=wo:Oe.sibling=wo,Oe=wo,Ne=yn}if(it.done)return f(q,Ne),pt&&Qr(q,rt),Ee;if(Ne===null){for(;!it.done;rt++,it=Y.next())it=Ae(q,it.value,fe),it!==null&&(W=C(it,W,rt),Oe===null?Ee=it:Oe.sibling=it,Oe=it);return pt&&Qr(q,rt),Ee}for(Ne=g(q,Ne);!it.done;rt++,it=Y.next())it=It(Ne,q,rt,it.value,fe),it!==null&&(a&&it.alternate!==null&&Ne.delete(it.key===null?rt:it.key),W=C(it,W,rt),Oe===null?Ee=it:Oe.sibling=it,Oe=it);return a&&Ne.forEach(function(CA){return u(q,CA)}),pt&&Qr(q,rt),Ee}function ks(q,W,Y,fe){if(typeof Y=="object"&&Y!==null&&Y.type===p&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case c:e:{for(var Ee=Y.key,Oe=W;Oe!==null;){if(Oe.key===Ee){if(Ee=Y.type,Ee===p){if(Oe.tag===7){f(q,Oe.sibling),W=y(Oe,Y.props.children),W.return=q,q=W;break e}}else if(Oe.elementType===Ee||typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===E&&v(Ee)===Oe.type){f(q,Oe.sibling),W=y(Oe,Y.props),W.ref=Yr(q,Oe,Y),W.return=q,q=W;break e}f(q,Oe);break}else u(q,Oe);Oe=Oe.sibling}Y.type===p?(W=ja(Y.props.children,q.mode,fe,Y.key),W.return=q,q=W):(fe=Ip(Y.type,Y.key,Y.props,null,q.mode,fe),fe.ref=Yr(q,W,Y),fe.return=q,q=fe)}return L(q);case h:e:{for(Oe=Y.key;W!==null;){if(W.key===Oe)if(W.tag===4&&W.stateNode.containerInfo===Y.containerInfo&&W.stateNode.implementation===Y.implementation){f(q,W.sibling),W=y(W,Y.children||[]),W.return=q,q=W;break e}else{f(q,W);break}else u(q,W);W=W.sibling}W=Oy(Y,q.mode,fe),W.return=q,q=W}return L(q);case E:return Oe=Y._init,ks(q,W,Oe(Y._payload),fe)}if(le(Y))return _t(q,W,Y,fe);if(B(Y))return xr(q,W,Y,fe);d(q,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"?(Y=""+Y,W!==null&&W.tag===6?(f(q,W.sibling),W=y(W,Y),W.return=q,q=W):(f(q,W),W=My(Y,q.mode,fe),W.return=q,q=W),L(q)):f(q,W)}return ks}var M=I(!0),H=I(!1),Q=di(null),oe=null,Ze=null,jt=null;function He(){jt=Ze=oe=null}function rn(a,u,f){De?(ut(Q,u._currentValue),u._currentValue=f):(ut(Q,u._currentValue2),u._currentValue2=f)}function Yt(a){var u=Q.current;ft(Q),De?a._currentValue=u:a._currentValue2=u}function Hi(a,u,f){for(;a!==null;){var g=a.alternate;if((a.childLanes&u)!==u?(a.childLanes|=u,g!==null&&(g.childLanes|=u)):g!==null&&(g.childLanes&u)!==u&&(g.childLanes|=u),a===f)break;a=a.return}}function gn(a,u){oe=a,jt=Ze=null,a=a.dependencies,a!==null&&a.firstContext!==null&&(a.lanes&u&&(Pr=!0),a.firstContext=null)}function Dn(a){var u=De?a._currentValue:a._currentValue2;if(jt!==a)if(a={context:a,memoizedValue:u,next:null},Ze===null){if(oe===null)throw Error(o(308));Ze=a,oe.dependencies={lanes:0,firstContext:a}}else Ze=Ze.next=a;return u}var mi=null;function W_(a){mi===null?mi=[a]:mi.push(a)}function NS(a,u,f,g){var y=u.interleaved;return y===null?(f.next=f,W_(u)):(f.next=y.next,y.next=f),u.interleaved=f,$i(a,g)}function $i(a,u){a.lanes|=u;var f=a.alternate;for(f!==null&&(f.lanes|=u),f=a,a=a.return;a!==null;)a.childLanes|=u,f=a.alternate,f!==null&&(f.childLanes|=u),f=a,a=a.return;return f.tag===3?f.stateNode:null}var fo=!1;function H_(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bS(a,u){a=a.updateQueue,u.updateQueue===a&&(u.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function Ts(a,u){return{eventTime:a,lane:u,tag:0,payload:null,callback:null,next:null}}function po(a,u,f){var g=a.updateQueue;if(g===null)return null;if(g=g.shared,Ue&2){var y=g.pending;return y===null?u.next=u:(u.next=y.next,y.next=u),g.pending=u,$i(a,f)}return y=g.interleaved,y===null?(u.next=u,W_(g)):(u.next=y.next,y.next=u),g.interleaved=u,$i(a,f)}function Xf(a,u,f){if(u=u.updateQueue,u!==null&&(u=u.shared,(f&4194240)!==0)){var g=u.lanes;g&=a.pendingLanes,f|=g,u.lanes=f,Hl(a,f)}}function DS(a,u){var f=a.updateQueue,g=a.alternate;if(g!==null&&(g=g.updateQueue,f===g)){var y=null,C=null;if(f=f.firstBaseUpdate,f!==null){do{var L={eventTime:f.eventTime,lane:f.lane,tag:f.tag,payload:f.payload,callback:f.callback,next:null};C===null?y=C=L:C=C.next=L,f=f.next}while(f!==null);C===null?y=C=u:C=C.next=u}else y=C=u;f={baseState:g.baseState,firstBaseUpdate:y,lastBaseUpdate:C,shared:g.shared,effects:g.effects},a.updateQueue=f;return}a=f.lastBaseUpdate,a===null?f.firstBaseUpdate=u:a.next=u,f.lastBaseUpdate=u}function Jf(a,u,f,g){var y=a.updateQueue;fo=!1;var C=y.firstBaseUpdate,L=y.lastBaseUpdate,G=y.shared.pending;if(G!==null){y.shared.pending=null;var K=G,se=K.next;K.next=null,L===null?C=se:L.next=se,L=K;var me=a.alternate;me!==null&&(me=me.updateQueue,G=me.lastBaseUpdate,G!==L&&(G===null?me.firstBaseUpdate=se:G.next=se,me.lastBaseUpdate=K))}if(C!==null){var Ae=y.baseState;L=0,me=se=K=null,G=C;do{var he=G.lane,It=G.eventTime;if((g&he)===he){me!==null&&(me=me.next={eventTime:It,lane:0,tag:G.tag,payload:G.payload,callback:G.callback,next:null});e:{var _t=a,xr=G;switch(he=u,It=f,xr.tag){case 1:if(_t=xr.payload,typeof _t=="function"){Ae=_t.call(It,Ae,he);break e}Ae=_t;break e;case 3:_t.flags=_t.flags&-65537|128;case 0:if(_t=xr.payload,he=typeof _t=="function"?_t.call(It,Ae,he):_t,he==null)break e;Ae=s({},Ae,he);break e;case 2:fo=!0}}G.callback!==null&&G.lane!==0&&(a.flags|=64,he=y.effects,he===null?y.effects=[G]:he.push(G))}else It={eventTime:It,lane:he,tag:G.tag,payload:G.payload,callback:G.callback,next:null},me===null?(se=me=It,K=Ae):me=me.next=It,L|=he;if(G=G.next,G===null){if(G=y.shared.pending,G===null)break;he=G,G=he.next,he.next=null,y.lastBaseUpdate=he,y.shared.pending=null}}while(!0);if(me===null&&(K=Ae),y.baseState=K,y.firstBaseUpdate=se,y.lastBaseUpdate=me,u=y.shared.interleaved,u!==null){y=u;do L|=y.lane,y=y.next;while(y!==u)}else C===null&&(y.shared.lanes=0);Va|=L,a.lanes=L,a.memoizedState=Ae}}function MS(a,u,f){if(a=u.effects,u.effects=null,a!==null)for(u=0;u<a.length;u++){var g=a[u],y=g.callback;if(y!==null){if(g.callback=null,g=f,typeof y!="function")throw Error(o(191,y));y.call(g)}}}var th={},Xr=di(th),nh=di(th),Jl=di(th);function qi(a){if(a===th)throw Error(o(174));return a}function $_(a,u){ut(Jl,u),ut(nh,a),ut(Xr,th),a=be(u),ft(Xr),ut(Xr,a)}function Zl(){ft(Xr),ft(nh),ft(Jl)}function OS(a){var u=qi(Jl.current),f=qi(Xr.current);u=$(f,a.type,u),f!==u&&(ut(nh,a),ut(Xr,u))}function q_(a){nh.current===a&&(ft(Xr),ft(nh))}var Nt=di(0);function Zf(a){for(var u=a;u!==null;){if(u.tag===13){var f=u.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||ao(f)||zc(f)))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if(u.flags&128)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===a)break;for(;u.sibling===null;){if(u.return===null||u.return===a)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var K_=[];function Q_(){for(var a=0;a<K_.length;a++){var u=K_[a];De?u._workInProgressVersionPrimary=null:u._workInProgressVersionSecondary=null}K_.length=0}var ep=l.ReactCurrentDispatcher,Y_=l.ReactCurrentBatchConfig,Fa=0,bt=null,sn=null,mn=null,tp=!1,rh=!1,ih=0,Kx=0;function qn(){throw Error(o(321))}function X_(a,u){if(u===null)return!1;for(var f=0;f<u.length&&f<a.length;f++)if(!Je(a[f],u[f]))return!1;return!0}function J_(a,u,f,g,y,C){if(Fa=C,bt=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,ep.current=a===null||a.memoizedState===null?Jx:Zx,a=f(g,y),rh){C=0;do{if(rh=!1,ih=0,25<=C)throw Error(o(301));C+=1,mn=sn=null,u.updateQueue=null,ep.current=eA,a=f(g,y)}while(rh)}if(ep.current=ip,u=sn!==null&&sn.next!==null,Fa=0,mn=sn=bt=null,tp=!1,u)throw Error(o(300));return a}function Z_(){var a=ih!==0;return ih=0,a}function Ki(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mn===null?bt.memoizedState=mn=a:mn=mn.next=a,mn}function Jr(){if(sn===null){var a=bt.alternate;a=a!==null?a.memoizedState:null}else a=sn.next;var u=mn===null?bt.memoizedState:mn.next;if(u!==null)mn=u,sn=a;else{if(a===null)throw Error(o(310));sn=a,a={memoizedState:sn.memoizedState,baseState:sn.baseState,baseQueue:sn.baseQueue,queue:sn.queue,next:null},mn===null?bt.memoizedState=mn=a:mn=mn.next=a}return mn}function sh(a,u){return typeof u=="function"?u(a):u}function ey(a){var u=Jr(),f=u.queue;if(f===null)throw Error(o(311));f.lastRenderedReducer=a;var g=sn,y=g.baseQueue,C=f.pending;if(C!==null){if(y!==null){var L=y.next;y.next=C.next,C.next=L}g.baseQueue=y=C,f.pending=null}if(y!==null){C=y.next,g=g.baseState;var G=L=null,K=null,se=C;do{var me=se.lane;if((Fa&me)===me)K!==null&&(K=K.next={lane:0,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null}),g=se.hasEagerState?se.eagerState:a(g,se.action);else{var Ae={lane:me,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null};K===null?(G=K=Ae,L=g):K=K.next=Ae,bt.lanes|=me,Va|=me}se=se.next}while(se!==null&&se!==C);K===null?L=g:K.next=G,Je(g,u.memoizedState)||(Pr=!0),u.memoizedState=g,u.baseState=L,u.baseQueue=K,f.lastRenderedState=g}if(a=f.interleaved,a!==null){y=a;do C=y.lane,bt.lanes|=C,Va|=C,y=y.next;while(y!==a)}else y===null&&(f.lanes=0);return[u.memoizedState,f.dispatch]}function ty(a){var u=Jr(),f=u.queue;if(f===null)throw Error(o(311));f.lastRenderedReducer=a;var g=f.dispatch,y=f.pending,C=u.memoizedState;if(y!==null){f.pending=null;var L=y=y.next;do C=a(C,L.action),L=L.next;while(L!==y);Je(C,u.memoizedState)||(Pr=!0),u.memoizedState=C,u.baseQueue===null&&(u.baseState=C),f.lastRenderedState=C}return[C,g]}function LS(){}function FS(a,u){var f=bt,g=Jr(),y=u(),C=!Je(g.memoizedState,y);if(C&&(g.memoizedState=y,Pr=!0),g=g.queue,ny(BS.bind(null,f,g,a),[a]),g.getSnapshot!==u||C||mn!==null&&mn.memoizedState.tag&1){if(f.flags|=2048,oh(9,US.bind(null,f,g,y,u),void 0,null),_n===null)throw Error(o(349));Fa&30||VS(f,u,y)}return y}function VS(a,u,f){a.flags|=16384,a={getSnapshot:u,value:f},u=bt.updateQueue,u===null?(u={lastEffect:null,stores:null},bt.updateQueue=u,u.stores=[a]):(f=u.stores,f===null?u.stores=[a]:f.push(a))}function US(a,u,f,g){u.value=f,u.getSnapshot=g,zS(u)&&jS(a)}function BS(a,u,f){return f(function(){zS(u)&&jS(a)})}function zS(a){var u=a.getSnapshot;a=a.value;try{var f=u();return!Je(a,f)}catch{return!0}}function jS(a){var u=$i(a,1);u!==null&&Zr(u,a,1,-1)}function GS(a){var u=Ki();return typeof a=="function"&&(a=a()),u.memoizedState=u.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:sh,lastRenderedState:a},u.queue=a,a=a.dispatch=Xx.bind(null,bt,a),[u.memoizedState,a]}function oh(a,u,f,g){return a={tag:a,create:u,destroy:f,deps:g,next:null},u=bt.updateQueue,u===null?(u={lastEffect:null,stores:null},bt.updateQueue=u,u.lastEffect=a.next=a):(f=u.lastEffect,f===null?u.lastEffect=a.next=a:(g=f.next,f.next=a,a.next=g,u.lastEffect=a)),a}function WS(){return Jr().memoizedState}function np(a,u,f,g){var y=Ki();bt.flags|=a,y.memoizedState=oh(1|u,f,void 0,g===void 0?null:g)}function rp(a,u,f,g){var y=Jr();g=g===void 0?null:g;var C=void 0;if(sn!==null){var L=sn.memoizedState;if(C=L.destroy,g!==null&&X_(g,L.deps)){y.memoizedState=oh(u,f,C,g);return}}bt.flags|=a,y.memoizedState=oh(1|u,f,C,g)}function HS(a,u){return np(8390656,8,a,u)}function ny(a,u){return rp(2048,8,a,u)}function $S(a,u){return rp(4,2,a,u)}function qS(a,u){return rp(4,4,a,u)}function KS(a,u){if(typeof u=="function")return a=a(),u(a),function(){u(null)};if(u!=null)return a=a(),u.current=a,function(){u.current=null}}function QS(a,u,f){return f=f!=null?f.concat([a]):null,rp(4,4,KS.bind(null,u,a),f)}function ry(){}function YS(a,u){var f=Jr();u=u===void 0?null:u;var g=f.memoizedState;return g!==null&&u!==null&&X_(u,g[1])?g[0]:(f.memoizedState=[a,u],a)}function XS(a,u){var f=Jr();u=u===void 0?null:u;var g=f.memoizedState;return g!==null&&u!==null&&X_(u,g[1])?g[0]:(a=a(),f.memoizedState=[a,u],a)}function JS(a,u,f){return Fa&21?(Je(f,u)||(f=Gf(),bt.lanes|=f,Va|=f,a.baseState=!0),u):(a.baseState&&(a.baseState=!1,Pr=!0),a.memoizedState=f)}function Qx(a,u){var f=Ye;Ye=f!==0&&4>f?f:4,a(!0);var g=Y_.transition;Y_.transition={};try{a(!1),u()}finally{Ye=f,Y_.transition=g}}function ZS(){return Jr().memoizedState}function Yx(a,u,f){var g=_o(a);if(f={lane:g,action:f,hasEagerState:!1,eagerState:null,next:null},e4(a))t4(u,f);else if(f=NS(a,u,f,g),f!==null){var y=Yn();Zr(f,a,g,y),n4(f,u,g)}}function Xx(a,u,f){var g=_o(a),y={lane:g,action:f,hasEagerState:!1,eagerState:null,next:null};if(e4(a))t4(u,y);else{var C=a.alternate;if(a.lanes===0&&(C===null||C.lanes===0)&&(C=u.lastRenderedReducer,C!==null))try{var L=u.lastRenderedState,G=C(L,f);if(y.hasEagerState=!0,y.eagerState=G,Je(G,L)){var K=u.interleaved;K===null?(y.next=y,W_(u)):(y.next=K.next,K.next=y),u.interleaved=y;return}}catch{}finally{}f=NS(a,u,y,g),f!==null&&(y=Yn(),Zr(f,a,g,y),n4(f,u,g))}}function e4(a){var u=a.alternate;return a===bt||u!==null&&u===bt}function t4(a,u){rh=tp=!0;var f=a.pending;f===null?u.next=u:(u.next=f.next,f.next=u),a.pending=u}function n4(a,u,f){if(f&4194240){var g=u.lanes;g&=a.pendingLanes,f|=g,u.lanes=f,Hl(a,f)}}var ip={readContext:Dn,useCallback:qn,useContext:qn,useEffect:qn,useImperativeHandle:qn,useInsertionEffect:qn,useLayoutEffect:qn,useMemo:qn,useReducer:qn,useRef:qn,useState:qn,useDebugValue:qn,useDeferredValue:qn,useTransition:qn,useMutableSource:qn,useSyncExternalStore:qn,useId:qn,unstable_isNewReconciler:!1},Jx={readContext:Dn,useCallback:function(a,u){return Ki().memoizedState=[a,u===void 0?null:u],a},useContext:Dn,useEffect:HS,useImperativeHandle:function(a,u,f){return f=f!=null?f.concat([a]):null,np(4194308,4,KS.bind(null,u,a),f)},useLayoutEffect:function(a,u){return np(4194308,4,a,u)},useInsertionEffect:function(a,u){return np(4,2,a,u)},useMemo:function(a,u){var f=Ki();return u=u===void 0?null:u,a=a(),f.memoizedState=[a,u],a},useReducer:function(a,u,f){var g=Ki();return u=f!==void 0?f(u):u,g.memoizedState=g.baseState=u,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:u},g.queue=a,a=a.dispatch=Yx.bind(null,bt,a),[g.memoizedState,a]},useRef:function(a){var u=Ki();return a={current:a},u.memoizedState=a},useState:GS,useDebugValue:ry,useDeferredValue:function(a){return Ki().memoizedState=a},useTransition:function(){var a=GS(!1),u=a[0];return a=Qx.bind(null,a[1]),Ki().memoizedState=a,[u,a]},useMutableSource:function(){},useSyncExternalStore:function(a,u,f){var g=bt,y=Ki();if(pt){if(f===void 0)throw Error(o(407));f=f()}else{if(f=u(),_n===null)throw Error(o(349));Fa&30||VS(g,u,f)}y.memoizedState=f;var C={value:f,getSnapshot:u};return y.queue=C,HS(BS.bind(null,g,C,a),[a]),g.flags|=2048,oh(9,US.bind(null,g,C,f,u),void 0,null),f},useId:function(){var a=Ki(),u=_n.identifierPrefix;if(pt){var f=Kr,g=Tr;f=(g&~(1<<32-Gn(g)-1)).toString(32)+f,u=":"+u+"R"+f,f=ih++,0<f&&(u+="H"+f.toString(32)),u+=":"}else f=Kx++,u=":"+u+"r"+f.toString(32)+":";return a.memoizedState=u},unstable_isNewReconciler:!1},Zx={readContext:Dn,useCallback:YS,useContext:Dn,useEffect:ny,useImperativeHandle:QS,useInsertionEffect:$S,useLayoutEffect:qS,useMemo:XS,useReducer:ey,useRef:WS,useState:function(){return ey(sh)},useDebugValue:ry,useDeferredValue:function(a){var u=Jr();return JS(u,sn.memoizedState,a)},useTransition:function(){var a=ey(sh)[0],u=Jr().memoizedState;return[a,u]},useMutableSource:LS,useSyncExternalStore:FS,useId:ZS,unstable_isNewReconciler:!1},eA={readContext:Dn,useCallback:YS,useContext:Dn,useEffect:ny,useImperativeHandle:QS,useInsertionEffect:$S,useLayoutEffect:qS,useMemo:XS,useReducer:ty,useRef:WS,useState:function(){return ty(sh)},useDebugValue:ry,useDeferredValue:function(a){var u=Jr();return sn===null?u.memoizedState=a:JS(u,sn.memoizedState,a)},useTransition:function(){var a=ty(sh)[0],u=Jr().memoizedState;return[a,u]},useMutableSource:LS,useSyncExternalStore:FS,useId:ZS,unstable_isNewReconciler:!1};function _i(a,u){if(a&&a.defaultProps){u=s({},u),a=a.defaultProps;for(var f in a)u[f]===void 0&&(u[f]=a[f]);return u}return u}function iy(a,u,f,g){u=a.memoizedState,f=f(g,u),f=f==null?u:s({},u,f),a.memoizedState=f,a.lanes===0&&(a.updateQueue.baseState=f)}var sp={isMounted:function(a){return(a=a._reactInternals)?b(a)===a:!1},enqueueSetState:function(a,u,f){a=a._reactInternals;var g=Yn(),y=_o(a),C=Ts(g,y);C.payload=u,f!=null&&(C.callback=f),u=po(a,C,y),u!==null&&(Zr(u,a,y,g),Xf(u,a,y))},enqueueReplaceState:function(a,u,f){a=a._reactInternals;var g=Yn(),y=_o(a),C=Ts(g,y);C.tag=1,C.payload=u,f!=null&&(C.callback=f),u=po(a,C,y),u!==null&&(Zr(u,a,y,g),Xf(u,a,y))},enqueueForceUpdate:function(a,u){a=a._reactInternals;var f=Yn(),g=_o(a),y=Ts(f,g);y.tag=2,u!=null&&(y.callback=u),u=po(a,y,g),u!==null&&(Zr(u,a,g,f),Xf(u,a,g))}};function r4(a,u,f,g,y,C,L){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(g,C,L):u.prototype&&u.prototype.isPureReactComponent?!La(f,g)||!La(y,C):!0}function i4(a,u,f){var g=!1,y=qr,C=u.contextType;return typeof C=="object"&&C!==null?C=Dn(C):(y=bn(u)?_s:nn.current,g=u.contextTypes,C=(g=g!=null)?uo(a,y):qr),u=new u(f,C),a.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,u.updater=sp,a.stateNode=u,u._reactInternals=a,g&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=y,a.__reactInternalMemoizedMaskedChildContext=C),u}function s4(a,u,f,g){a=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(f,g),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(f,g),u.state!==a&&sp.enqueueReplaceState(u,u.state,null)}function sy(a,u,f,g){var y=a.stateNode;y.props=f,y.state=a.memoizedState,y.refs={},H_(a);var C=u.contextType;typeof C=="object"&&C!==null?y.context=Dn(C):(C=bn(u)?_s:nn.current,y.context=uo(a,C)),y.state=a.memoizedState,C=u.getDerivedStateFromProps,typeof C=="function"&&(iy(a,u,C,f),y.state=a.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(u=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),u!==y.state&&sp.enqueueReplaceState(y,y.state,null),Jf(a,f,y,g),y.state=a.memoizedState),typeof y.componentDidMount=="function"&&(a.flags|=4194308)}function eu(a,u){try{var f="",g=u;do f+=Yf(g),g=g.return;while(g);var y=f}catch(C){y=`
Error generating stack: `+C.message+`
`+C.stack}return{value:a,source:u,stack:y,digest:null}}function oy(a,u,f){return{value:a,source:null,stack:f??null,digest:u??null}}function ay(a,u){try{console.error(u.value)}catch(f){setTimeout(function(){throw f})}}var tA=typeof WeakMap=="function"?WeakMap:Map;function o4(a,u,f){f=Ts(-1,f),f.tag=3,f.payload={element:null};var g=u.value;return f.callback=function(){vp||(vp=!0,ky=g),ay(a,u)},f}function a4(a,u,f){f=Ts(-1,f),f.tag=3;var g=a.type.getDerivedStateFromError;if(typeof g=="function"){var y=u.value;f.payload=function(){return g(y)},f.callback=function(){ay(a,u)}}var C=a.stateNode;return C!==null&&typeof C.componentDidCatch=="function"&&(f.callback=function(){ay(a,u),typeof g!="function"&&(go===null?go=new Set([this]):go.add(this));var L=u.stack;this.componentDidCatch(u.value,{componentStack:L!==null?L:""})}),f}function l4(a,u,f){var g=a.pingCache;if(g===null){g=a.pingCache=new tA;var y=new Set;g.set(u,y)}else y=g.get(u),y===void 0&&(y=new Set,g.set(u,y));y.has(f)||(y.add(f),a=gA.bind(null,a,u,f),u.then(a,a))}function u4(a){do{var u;if((u=a.tag===13)&&(u=a.memoizedState,u=u!==null?u.dehydrated!==null:!0),u)return a;a=a.return}while(a!==null);return null}function c4(a,u,f,g,y){return a.mode&1?(a.flags|=65536,a.lanes=y,a):(a===u?a.flags|=65536:(a.flags|=128,f.flags|=131072,f.flags&=-52805,f.tag===1&&(f.alternate===null?f.tag=17:(u=Ts(-1,1),u.tag=2,po(f,u,1))),f.lanes|=1),a)}var nA=l.ReactCurrentOwner,Pr=!1;function pr(a,u,f,g){u.child=a===null?H(u,null,f,g):M(u,a.child,f,g)}function h4(a,u,f,g,y){f=f.render;var C=u.ref;return gn(u,y),g=J_(a,u,f,g,C,y),f=Z_(),a!==null&&!Pr?(u.updateQueue=a.updateQueue,u.flags&=-2053,a.lanes&=~y,Is(a,u,y)):(pt&&f&&Yl(u),u.flags|=1,pr(a,u,g,y),u.child)}function d4(a,u,f,g,y){if(a===null){var C=f.type;return typeof C=="function"&&!Dy(C)&&C.defaultProps===void 0&&f.compare===null&&f.defaultProps===void 0?(u.tag=15,u.type=C,f4(a,u,C,g,y)):(a=Ip(f.type,null,g,u,u.mode,y),a.ref=u.ref,a.return=u,u.child=a)}if(C=a.child,!(a.lanes&y)){var L=C.memoizedProps;if(f=f.compare,f=f!==null?f:La,f(L,g)&&a.ref===u.ref)return Is(a,u,y)}return u.flags|=1,a=vo(C,g),a.ref=u.ref,a.return=u,u.child=a}function f4(a,u,f,g,y){if(a!==null){var C=a.memoizedProps;if(La(C,g)&&a.ref===u.ref)if(Pr=!1,u.pendingProps=g=C,(a.lanes&y)!==0)a.flags&131072&&(Pr=!0);else return u.lanes=a.lanes,Is(a,u,y)}return ly(a,u,f,g,y)}function p4(a,u,f){var g=u.pendingProps,y=g.children,C=a!==null?a.memoizedState:null;if(g.mode==="hidden")if(!(u.mode&1))u.memoizedState={baseLanes:0,cachePool:null,transitions:null},ut(nu,Vr),Vr|=f;else{if(!(f&1073741824))return a=C!==null?C.baseLanes|f:f,u.lanes=u.childLanes=1073741824,u.memoizedState={baseLanes:a,cachePool:null,transitions:null},u.updateQueue=null,ut(nu,Vr),Vr|=a,null;u.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=C!==null?C.baseLanes:f,ut(nu,Vr),Vr|=g}else C!==null?(g=C.baseLanes|f,u.memoizedState=null):g=f,ut(nu,Vr),Vr|=g;return pr(a,u,y,f),u.child}function g4(a,u){var f=u.ref;(a===null&&f!==null||a!==null&&a.ref!==f)&&(u.flags|=512,u.flags|=2097152)}function ly(a,u,f,g,y){var C=bn(f)?_s:nn.current;return C=uo(u,C),gn(u,y),f=J_(a,u,f,g,C,y),g=Z_(),a!==null&&!Pr?(u.updateQueue=a.updateQueue,u.flags&=-2053,a.lanes&=~y,Is(a,u,y)):(pt&&g&&Yl(u),u.flags|=1,pr(a,u,f,y),u.child)}function m4(a,u,f,g,y){if(bn(f)){var C=!0;Sr(u)}else C=!1;if(gn(u,y),u.stateNode===null)ap(a,u),i4(u,f,g),sy(u,f,g,y),g=!0;else if(a===null){var L=u.stateNode,G=u.memoizedProps;L.props=G;var K=L.context,se=f.contextType;typeof se=="object"&&se!==null?se=Dn(se):(se=bn(f)?_s:nn.current,se=uo(u,se));var me=f.getDerivedStateFromProps,Ae=typeof me=="function"||typeof L.getSnapshotBeforeUpdate=="function";Ae||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(G!==g||K!==se)&&s4(u,L,g,se),fo=!1;var he=u.memoizedState;L.state=he,Jf(u,g,L,y),K=u.memoizedState,G!==g||he!==K||Nn.current||fo?(typeof me=="function"&&(iy(u,f,me,g),K=u.memoizedState),(G=fo||r4(u,f,G,g,he,K,se))?(Ae||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount()),typeof L.componentDidMount=="function"&&(u.flags|=4194308)):(typeof L.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=g,u.memoizedState=K),L.props=g,L.state=K,L.context=se,g=G):(typeof L.componentDidMount=="function"&&(u.flags|=4194308),g=!1)}else{L=u.stateNode,bS(a,u),G=u.memoizedProps,se=u.type===u.elementType?G:_i(u.type,G),L.props=se,Ae=u.pendingProps,he=L.context,K=f.contextType,typeof K=="object"&&K!==null?K=Dn(K):(K=bn(f)?_s:nn.current,K=uo(u,K));var It=f.getDerivedStateFromProps;(me=typeof It=="function"||typeof L.getSnapshotBeforeUpdate=="function")||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(G!==Ae||he!==K)&&s4(u,L,g,K),fo=!1,he=u.memoizedState,L.state=he,Jf(u,g,L,y);var _t=u.memoizedState;G!==Ae||he!==_t||Nn.current||fo?(typeof It=="function"&&(iy(u,f,It,g),_t=u.memoizedState),(se=fo||r4(u,f,se,g,he,_t,K)||!1)?(me||typeof L.UNSAFE_componentWillUpdate!="function"&&typeof L.componentWillUpdate!="function"||(typeof L.componentWillUpdate=="function"&&L.componentWillUpdate(g,_t,K),typeof L.UNSAFE_componentWillUpdate=="function"&&L.UNSAFE_componentWillUpdate(g,_t,K)),typeof L.componentDidUpdate=="function"&&(u.flags|=4),typeof L.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof L.componentDidUpdate!="function"||G===a.memoizedProps&&he===a.memoizedState||(u.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||G===a.memoizedProps&&he===a.memoizedState||(u.flags|=1024),u.memoizedProps=g,u.memoizedState=_t),L.props=g,L.state=_t,L.context=K,g=se):(typeof L.componentDidUpdate!="function"||G===a.memoizedProps&&he===a.memoizedState||(u.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||G===a.memoizedProps&&he===a.memoizedState||(u.flags|=1024),g=!1)}return uy(a,u,f,g,C,y)}function uy(a,u,f,g,y,C){g4(a,u);var L=(u.flags&128)!==0;if(!g&&!L)return y&&Aa(u,f,!1),Is(a,u,C);g=u.stateNode,nA.current=u;var G=L&&typeof f.getDerivedStateFromError!="function"?null:g.render();return u.flags|=1,a!==null&&L?(u.child=M(u,a.child,null,C),u.child=M(u,null,G,C)):pr(a,u,G,C),u.memoizedState=g.state,y&&Aa(u,f,!0),u.child}function _4(a){var u=a.stateNode;u.pendingContext?zf(a,u.pendingContext,u.pendingContext!==u.context):u.context&&zf(a,u.context,!1),$_(a,u.containerInfo)}function y4(a,u,f,g,y){return Cs(),ho(y),u.flags|=256,pr(a,u,f,g),u.child}var cy={dehydrated:null,treeContext:null,retryLane:0};function hy(a){return{baseLanes:a,cachePool:null,transitions:null}}function v4(a,u,f){var g=u.pendingProps,y=Nt.current,C=!1,L=(u.flags&128)!==0,G;if((G=L)||(G=a!==null&&a.memoizedState===null?!1:(y&2)!==0),G?(C=!0,u.flags&=-129):(a===null||a.memoizedState!==null)&&(y|=1),ut(Nt,y&1),a===null)return gi(u),a=u.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?(u.mode&1?zc(a)?u.lanes=8:u.lanes=1073741824:u.lanes=1,null):(L=g.children,a=g.fallback,C?(g=u.mode,C=u.child,L={mode:"hidden",children:L},!(g&1)&&C!==null?(C.childLanes=0,C.pendingProps=L):C=Pp(L,g,0,null),a=ja(a,g,f,null),C.return=u,a.return=u,C.sibling=a,u.child=C,u.child.memoizedState=hy(f),u.memoizedState=cy,a):dy(u,L));if(y=a.memoizedState,y!==null&&(G=y.dehydrated,G!==null))return rA(a,u,L,g,G,y,f);if(C){C=g.fallback,L=u.mode,y=a.child,G=y.sibling;var K={mode:"hidden",children:g.children};return!(L&1)&&u.child!==y?(g=u.child,g.childLanes=0,g.pendingProps=K,u.deletions=null):(g=vo(y,K),g.subtreeFlags=y.subtreeFlags&14680064),G!==null?C=vo(G,C):(C=ja(C,L,f,null),C.flags|=2),C.return=u,g.return=u,g.sibling=C,u.child=g,g=C,C=u.child,L=a.child.memoizedState,L=L===null?hy(f):{baseLanes:L.baseLanes|f,cachePool:null,transitions:L.transitions},C.memoizedState=L,C.childLanes=a.childLanes&~f,u.memoizedState=cy,g}return C=a.child,a=C.sibling,g=vo(C,{mode:"visible",children:g.children}),!(u.mode&1)&&(g.lanes=f),g.return=u,g.sibling=null,a!==null&&(f=u.deletions,f===null?(u.deletions=[a],u.flags|=16):f.push(a)),u.child=g,u.memoizedState=null,g}function dy(a,u){return u=Pp({mode:"visible",children:u},a.mode,0,null),u.return=a,a.child=u}function op(a,u,f,g){return g!==null&&ho(g),M(u,a.child,null,f),a=dy(u,u.pendingProps.children),a.flags|=2,u.memoizedState=null,a}function rA(a,u,f,g,y,C,L){if(f)return u.flags&256?(u.flags&=-257,g=oy(Error(o(422))),op(a,u,L,g)):u.memoizedState!==null?(u.child=a.child,u.flags|=128,null):(C=g.fallback,y=u.mode,g=Pp({mode:"visible",children:g.children},y,0,null),C=ja(C,y,L,null),C.flags|=2,g.return=u,C.return=u,g.sibling=C,u.child=g,u.mode&1&&M(u,a.child,null,L),u.child.memoizedState=hy(L),u.memoizedState=cy,C);if(!(u.mode&1))return op(a,u,L,null);if(zc(y))return g=V_(y).digest,C=Error(o(419)),g=oy(C,g,void 0),op(a,u,L,g);if(f=(L&a.childLanes)!==0,Pr||f){if(g=_n,g!==null){switch(L&-L){case 4:y=2;break;case 16:y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:y=32;break;case 536870912:y=268435456;break;default:y=0}y=y&(g.suspendedLanes|L)?0:y,y!==0&&y!==C.retryLane&&(C.retryLane=y,$i(a,y),Zr(g,a,y,-1))}return by(),g=oy(Error(o(421))),op(a,u,L,g)}return ao(y)?(u.flags|=128,u.child=a.child,u=mA.bind(null,a),lo(y,u),null):(a=C.treeContext,lt&&(dr=Lf(y),$n=u,pt=!0,Ir=null,Ss=!1,a!==null&&(pn[hr++]=Tr,pn[hr++]=Kr,pn[hr++]=pi,Tr=a.id,Kr=a.overflow,pi=u)),u=dy(u,g.children),u.flags|=4096,u)}function w4(a,u,f){a.lanes|=u;var g=a.alternate;g!==null&&(g.lanes|=u),Hi(a.return,u,f)}function fy(a,u,f,g,y){var C=a.memoizedState;C===null?a.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:g,tail:f,tailMode:y}:(C.isBackwards=u,C.rendering=null,C.renderingStartTime=0,C.last=g,C.tail=f,C.tailMode=y)}function E4(a,u,f){var g=u.pendingProps,y=g.revealOrder,C=g.tail;if(pr(a,u,g.children,f),g=Nt.current,g&2)g=g&1|2,u.flags|=128;else{if(a!==null&&a.flags&128)e:for(a=u.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&w4(a,f,u);else if(a.tag===19)w4(a,f,u);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===u)break e;for(;a.sibling===null;){if(a.return===null||a.return===u)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}g&=1}if(ut(Nt,g),!(u.mode&1))u.memoizedState=null;else switch(y){case"forwards":for(f=u.child,y=null;f!==null;)a=f.alternate,a!==null&&Zf(a)===null&&(y=f),f=f.sibling;f=y,f===null?(y=u.child,u.child=null):(y=f.sibling,f.sibling=null),fy(u,!1,y,f,C);break;case"backwards":for(f=null,y=u.child,u.child=null;y!==null;){if(a=y.alternate,a!==null&&Zf(a)===null){u.child=y;break}a=y.sibling,y.sibling=f,f=y,y=a}fy(u,!0,f,null,C);break;case"together":fy(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function ap(a,u){!(u.mode&1)&&a!==null&&(a.alternate=null,u.alternate=null,u.flags|=2)}function Is(a,u,f){if(a!==null&&(u.dependencies=a.dependencies),Va|=u.lanes,!(f&u.childLanes))return null;if(a!==null&&u.child!==a.child)throw Error(o(153));if(u.child!==null){for(a=u.child,f=vo(a,a.pendingProps),u.child=f,f.return=u;a.sibling!==null;)a=a.sibling,f=f.sibling=vo(a,a.pendingProps),f.return=u;f.sibling=null}return u.child}function iA(a,u,f){switch(u.tag){case 3:_4(u),Cs();break;case 5:OS(u);break;case 1:bn(u.type)&&Sr(u);break;case 4:$_(u,u.stateNode.containerInfo);break;case 10:rn(u,u.type._context,u.memoizedProps.value);break;case 13:var g=u.memoizedState;if(g!==null)return g.dehydrated!==null?(ut(Nt,Nt.current&1),u.flags|=128,null):f&u.child.childLanes?v4(a,u,f):(ut(Nt,Nt.current&1),a=Is(a,u,f),a!==null?a.sibling:null);ut(Nt,Nt.current&1);break;case 19:if(g=(f&u.childLanes)!==0,a.flags&128){if(g)return E4(a,u,f);u.flags|=128}var y=u.memoizedState;if(y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),ut(Nt,Nt.current),g)break;return null;case 22:case 23:return u.lanes=0,p4(a,u,f)}return Is(a,u,f)}function Qi(a){a.flags|=4}function S4(a,u){if(a!==null&&a.child===u.child)return!0;if(u.flags&16)return!1;for(a=u.child;a!==null;){if(a.flags&12854||a.subtreeFlags&12854)return!1;a=a.sibling}return!0}var ah,lh,lp,up;if(Ce)ah=function(a,u){for(var f=u.child;f!==null;){if(f.tag===5||f.tag===6)ie(a,f.stateNode);else if(f.tag!==4&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===u)break;for(;f.sibling===null;){if(f.return===null||f.return===u)return;f=f.return}f.sibling.return=f.return,f=f.sibling}},lh=function(){},lp=function(a,u,f,g,y){if(a=a.memoizedProps,a!==g){var C=u.stateNode,L=qi(Xr.current);f=Tt(C,f,a,g,y,L),(u.updateQueue=f)&&Qi(u)}},up=function(a,u,f,g){f!==g&&Qi(u)};else if(Qe){ah=function(a,u,f,g){for(var y=u.child;y!==null;){if(y.tag===5){var C=y.stateNode;f&&g&&(C=oo(C,y.type,y.memoizedProps,y)),ie(a,C)}else if(y.tag===6)C=y.stateNode,f&&g&&(C=Bc(C,y.memoizedProps,y)),ie(a,C);else if(y.tag!==4){if(y.tag===22&&y.memoizedState!==null)C=y.child,C!==null&&(C.return=y),ah(a,y,!0,!0);else if(y.child!==null){y.child.return=y,y=y.child;continue}}if(y===u)break;for(;y.sibling===null;){if(y.return===null||y.return===u)return;y=y.return}y.sibling.return=y.return,y=y.sibling}};var C4=function(a,u,f,g){for(var y=u.child;y!==null;){if(y.tag===5){var C=y.stateNode;f&&g&&(C=oo(C,y.type,y.memoizedProps,y)),Uc(a,C)}else if(y.tag===6)C=y.stateNode,f&&g&&(C=Bc(C,y.memoizedProps,y)),Uc(a,C);else if(y.tag!==4){if(y.tag===22&&y.memoizedState!==null)C=y.child,C!==null&&(C.return=y),C4(a,y,!0,!0);else if(y.child!==null){y.child.return=y,y=y.child;continue}}if(y===u)break;for(;y.sibling===null;){if(y.return===null||y.return===u)return;y=y.return}y.sibling.return=y.return,y=y.sibling}};lh=function(a,u){var f=u.stateNode;if(!S4(a,u)){a=f.containerInfo;var g=Vi(a);C4(g,u,!1,!1),f.pendingChildren=g,Qi(u),Fl(a,g)}},lp=function(a,u,f,g,y){var C=a.stateNode,L=a.memoizedProps;if((a=S4(a,u))&&L===g)u.stateNode=C;else{var G=u.stateNode,K=qi(Xr.current),se=null;L!==g&&(se=Tt(G,f,L,g,y,K)),a&&se===null?u.stateNode=C:(C=Vc(C,se,f,L,g,u,a,G),_e(C,f,g,y,K)&&Qi(u),u.stateNode=C,a?Qi(u):ah(C,u,!1,!1))}},up=function(a,u,f,g){f!==g?(a=qi(Jl.current),f=qi(Xr.current),u.stateNode=Ve(g,a,f,u),Qi(u)):u.stateNode=a.stateNode}}else lh=function(){},lp=function(){},up=function(){};function uh(a,u){if(!pt)switch(a.tailMode){case"hidden":u=a.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?a.tail=null:f.sibling=null;break;case"collapsed":f=a.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?u||a.tail===null?a.tail=null:a.tail.sibling=null:g.sibling=null}}function Kn(a){var u=a.alternate!==null&&a.alternate.child===a.child,f=0,g=0;if(u)for(var y=a.child;y!==null;)f|=y.lanes|y.childLanes,g|=y.subtreeFlags&14680064,g|=y.flags&14680064,y.return=a,y=y.sibling;else for(y=a.child;y!==null;)f|=y.lanes|y.childLanes,g|=y.subtreeFlags,g|=y.flags,y.return=a,y=y.sibling;return a.subtreeFlags|=g,a.childLanes=f,u}function sA(a,u,f){var g=u.pendingProps;switch(Es(u),u.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kn(u),null;case 1:return bn(u.type)&&xa(),Kn(u),null;case 3:return f=u.stateNode,Zl(),ft(Nn),ft(nn),Q_(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(a===null||a.child===null)&&(Oa(u)?Qi(u):a===null||a.memoizedState.isDehydrated&&!(u.flags&256)||(u.flags|=1024,Ir!==null&&(Ay(Ir),Ir=null))),lh(a,u),Kn(u),null;case 5:q_(u),f=qi(Jl.current);var y=u.type;if(a!==null&&u.stateNode!=null)lp(a,u,y,g,f),a.ref!==u.ref&&(u.flags|=512,u.flags|=2097152);else{if(!g){if(u.stateNode===null)throw Error(o(166));return Kn(u),null}if(a=qi(Xr.current),Oa(u)){if(!lt)throw Error(o(175));a=jc(u.stateNode,u.type,u.memoizedProps,f,a,u,!Ss),u.updateQueue=a,a!==null&&Qi(u)}else{var C=Z(y,g,f,a,u);ah(C,u,!1,!1),u.stateNode=C,_e(C,y,g,f,a)&&Qi(u)}u.ref!==null&&(u.flags|=512,u.flags|=2097152)}return Kn(u),null;case 6:if(a&&u.stateNode!=null)up(a,u,a.memoizedProps,g);else{if(typeof g!="string"&&u.stateNode===null)throw Error(o(166));if(a=qi(Jl.current),f=qi(Xr.current),Oa(u)){if(!lt)throw Error(o(176));if(a=u.stateNode,f=u.memoizedProps,(g=zl(a,f,u,!Ss))&&(y=$n,y!==null))switch(y.tag){case 3:B_(y.stateNode.containerInfo,a,f,(y.mode&1)!==0);break;case 5:jl(y.type,y.memoizedProps,y.stateNode,a,f,(y.mode&1)!==0)}g&&Qi(u)}else u.stateNode=Ve(g,a,f,u)}return Kn(u),null;case 13:if(ft(Nt),g=u.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(pt&&dr!==null&&u.mode&1&&!(u.flags&128))eh(),Cs(),u.flags|=98560,y=!1;else if(y=Oa(u),g!==null&&g.dehydrated!==null){if(a===null){if(!y)throw Error(o(318));if(!lt)throw Error(o(344));if(y=u.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(o(317));Ui(y,u)}else Cs(),!(u.flags&128)&&(u.memoizedState=null),u.flags|=4;Kn(u),y=!1}else Ir!==null&&(Ay(Ir),Ir=null),y=!0;if(!y)return u.flags&65536?u:null}return u.flags&128?(u.lanes=f,u):(f=g!==null,f!==(a!==null&&a.memoizedState!==null)&&f&&(u.child.flags|=8192,u.mode&1&&(a===null||Nt.current&1?on===0&&(on=3):by())),u.updateQueue!==null&&(u.flags|=4),Kn(u),null);case 4:return Zl(),lh(a,u),a===null&&Ge(u.stateNode.containerInfo),Kn(u),null;case 10:return Yt(u.type._context),Kn(u),null;case 17:return bn(u.type)&&xa(),Kn(u),null;case 19:if(ft(Nt),y=u.memoizedState,y===null)return Kn(u),null;if(g=(u.flags&128)!==0,C=y.rendering,C===null)if(g)uh(y,!1);else{if(on!==0||a!==null&&a.flags&128)for(a=u.child;a!==null;){if(C=Zf(a),C!==null){for(u.flags|=128,uh(y,!1),a=C.updateQueue,a!==null&&(u.updateQueue=a,u.flags|=4),u.subtreeFlags=0,a=f,f=u.child;f!==null;)g=f,y=a,g.flags&=14680066,C=g.alternate,C===null?(g.childLanes=0,g.lanes=y,g.child=null,g.subtreeFlags=0,g.memoizedProps=null,g.memoizedState=null,g.updateQueue=null,g.dependencies=null,g.stateNode=null):(g.childLanes=C.childLanes,g.lanes=C.lanes,g.child=C.child,g.subtreeFlags=0,g.deletions=null,g.memoizedProps=C.memoizedProps,g.memoizedState=C.memoizedState,g.updateQueue=C.updateQueue,g.type=C.type,y=C.dependencies,g.dependencies=y===null?null:{lanes:y.lanes,firstContext:y.firstContext}),f=f.sibling;return ut(Nt,Nt.current&1|2),u.child}a=a.sibling}y.tail!==null&&Qt()>Py&&(u.flags|=128,g=!0,uh(y,!1),u.lanes=4194304)}else{if(!g)if(a=Zf(C),a!==null){if(u.flags|=128,g=!0,a=a.updateQueue,a!==null&&(u.updateQueue=a,u.flags|=4),uh(y,!0),y.tail===null&&y.tailMode==="hidden"&&!C.alternate&&!pt)return Kn(u),null}else 2*Qt()-y.renderingStartTime>Py&&f!==1073741824&&(u.flags|=128,g=!0,uh(y,!1),u.lanes=4194304);y.isBackwards?(C.sibling=u.child,u.child=C):(a=y.last,a!==null?a.sibling=C:u.child=C,y.last=C)}return y.tail!==null?(u=y.tail,y.rendering=u,y.tail=u.sibling,y.renderingStartTime=Qt(),u.sibling=null,a=Nt.current,ut(Nt,g?a&1|2:a&1),u):(Kn(u),null);case 22:case 23:return Ny(),f=u.memoizedState!==null,a!==null&&a.memoizedState!==null!==f&&(u.flags|=8192),f&&u.mode&1?Vr&1073741824&&(Kn(u),Ce&&u.subtreeFlags&6&&(u.flags|=8192)):Kn(u),null;case 24:return null;case 25:return null}throw Error(o(156,u.tag))}function oA(a,u){switch(Es(u),u.tag){case 1:return bn(u.type)&&xa(),a=u.flags,a&65536?(u.flags=a&-65537|128,u):null;case 3:return Zl(),ft(Nn),ft(nn),Q_(),a=u.flags,a&65536&&!(a&128)?(u.flags=a&-65537|128,u):null;case 5:return q_(u),null;case 13:if(ft(Nt),a=u.memoizedState,a!==null&&a.dehydrated!==null){if(u.alternate===null)throw Error(o(340));Cs()}return a=u.flags,a&65536?(u.flags=a&-65537|128,u):null;case 19:return ft(Nt),null;case 4:return Zl(),null;case 10:return Yt(u.type._context),null;case 22:case 23:return Ny(),null;case 24:return null;default:return null}}var cp=!1,Qn=!1,aA=typeof WeakSet=="function"?WeakSet:Set,pe=null;function tu(a,u){var f=a.ref;if(f!==null)if(typeof f=="function")try{f(null)}catch(g){Rt(a,u,g)}else f.current=null}function py(a,u,f){try{f()}catch(g){Rt(a,u,g)}}var T4=!1;function lA(a,u){for(J(a.containerInfo),pe=u;pe!==null;)if(a=pe,u=a.child,(a.subtreeFlags&1028)!==0&&u!==null)u.return=a,pe=u;else for(;pe!==null;){a=pe;try{var f=a.alternate;if(a.flags&1024)switch(a.tag){case 0:case 11:case 15:break;case 1:if(f!==null){var g=f.memoizedProps,y=f.memoizedState,C=a.stateNode,L=C.getSnapshotBeforeUpdate(a.elementType===a.type?g:_i(a.type,g),y);C.__reactInternalSnapshotBeforeUpdate=L}break;case 3:Ce&&Fc(a.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(G){Rt(a,a.return,G)}if(u=a.sibling,u!==null){u.return=a.return,pe=u;break}pe=a.return}return f=T4,T4=!1,f}function ch(a,u,f){var g=u.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var y=g=g.next;do{if((y.tag&a)===a){var C=y.destroy;y.destroy=void 0,C!==void 0&&py(u,f,C)}y=y.next}while(y!==g)}}function hp(a,u){if(u=u.updateQueue,u=u!==null?u.lastEffect:null,u!==null){var f=u=u.next;do{if((f.tag&a)===a){var g=f.create;f.destroy=g()}f=f.next}while(f!==u)}}function gy(a){var u=a.ref;if(u!==null){var f=a.stateNode;switch(a.tag){case 5:a=Me(f);break;default:a=f}typeof u=="function"?u(a):u.current=a}}function I4(a){var u=a.alternate;u!==null&&(a.alternate=null,I4(u)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(u=a.stateNode,u!==null&&Fr(u)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function P4(a){return a.tag===5||a.tag===3||a.tag===4}function k4(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||P4(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function my(a,u,f){var g=a.tag;if(g===5||g===6)a=a.stateNode,u?Nf(f,a,u):Rf(f,a);else if(g!==4&&(a=a.child,a!==null))for(my(a,u,f),a=a.sibling;a!==null;)my(a,u,f),a=a.sibling}function _y(a,u,f){var g=a.tag;if(g===5||g===6)a=a.stateNode,u?Af(f,a,u):Ll(f,a);else if(g!==4&&(a=a.child,a!==null))for(_y(a,u,f),a=a.sibling;a!==null;)_y(a,u,f),a=a.sibling}var Mn=null,yi=!1;function Yi(a,u,f){for(f=f.child;f!==null;)yy(a,u,f),f=f.sibling}function yy(a,u,f){if(Wn&&typeof Wn.onCommitFiberUnmount=="function")try{Wn.onCommitFiberUnmount(Wi,f)}catch{}switch(f.tag){case 5:Qn||tu(f,u);case 6:if(Ce){var g=Mn,y=yi;Mn=null,Yi(a,u,f),Mn=g,yi=y,Mn!==null&&(yi?F_(Mn,f.stateNode):Oc(Mn,f.stateNode))}else Yi(a,u,f);break;case 18:Ce&&Mn!==null&&(yi?Uf(Mn,f.stateNode):Wc(Mn,f.stateNode));break;case 4:Ce?(g=Mn,y=yi,Mn=f.stateNode.containerInfo,yi=!0,Yi(a,u,f),Mn=g,yi=y):(Qe&&(g=f.stateNode.containerInfo,y=Vi(g),Vl(g,y)),Yi(a,u,f));break;case 0:case 11:case 14:case 15:if(!Qn&&(g=f.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){y=g=g.next;do{var C=y,L=C.destroy;C=C.tag,L!==void 0&&(C&2||C&4)&&py(f,u,L),y=y.next}while(y!==g)}Yi(a,u,f);break;case 1:if(!Qn&&(tu(f,u),g=f.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=f.memoizedProps,g.state=f.memoizedState,g.componentWillUnmount()}catch(G){Rt(f,u,G)}Yi(a,u,f);break;case 21:Yi(a,u,f);break;case 22:f.mode&1?(Qn=(g=Qn)||f.memoizedState!==null,Yi(a,u,f),Qn=g):Yi(a,u,f);break;default:Yi(a,u,f)}}function R4(a){var u=a.updateQueue;if(u!==null){a.updateQueue=null;var f=a.stateNode;f===null&&(f=a.stateNode=new aA),u.forEach(function(g){var y=_A.bind(null,a,g);f.has(g)||(f.add(g),g.then(y,y))})}}function vi(a,u){var f=u.deletions;if(f!==null)for(var g=0;g<f.length;g++){var y=f[g];try{var C=a,L=u;if(Ce){var G=L;e:for(;G!==null;){switch(G.tag){case 5:Mn=G.stateNode,yi=!1;break e;case 3:Mn=G.stateNode.containerInfo,yi=!0;break e;case 4:Mn=G.stateNode.containerInfo,yi=!0;break e}G=G.return}if(Mn===null)throw Error(o(160));yy(C,L,y),Mn=null,yi=!1}else yy(C,L,y);var K=y.alternate;K!==null&&(K.return=null),y.return=null}catch(se){Rt(y,u,se)}}if(u.subtreeFlags&12854)for(u=u.child;u!==null;)x4(u,a),u=u.sibling}function x4(a,u){var f=a.alternate,g=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(vi(u,a),Xi(a),g&4){try{ch(3,a,a.return),hp(3,a)}catch(he){Rt(a,a.return,he)}try{ch(5,a,a.return)}catch(he){Rt(a,a.return,he)}}break;case 1:vi(u,a),Xi(a),g&512&&f!==null&&tu(f,f.return);break;case 5:if(vi(u,a),Xi(a),g&512&&f!==null&&tu(f,f.return),Ce){if(a.flags&32){var y=a.stateNode;try{bf(y)}catch(he){Rt(a,a.return,he)}}if(g&4&&(y=a.stateNode,y!=null)){var C=a.memoizedProps;if(f=f!==null?f.memoizedProps:C,g=a.type,u=a.updateQueue,a.updateQueue=null,u!==null)try{Pa(y,u,g,f,C,a)}catch(he){Rt(a,a.return,he)}}}break;case 6:if(vi(u,a),Xi(a),g&4&&Ce){if(a.stateNode===null)throw Error(o(162));y=a.stateNode,C=a.memoizedProps,f=f!==null?f.memoizedProps:C;try{xf(y,f,C)}catch(he){Rt(a,a.return,he)}}break;case 3:if(vi(u,a),Xi(a),g&4){if(Ce&&lt&&f!==null&&f.memoizedState.isDehydrated)try{Vf(u.containerInfo)}catch(he){Rt(a,a.return,he)}if(Qe){y=u.containerInfo,C=u.pendingChildren;try{Vl(y,C)}catch(he){Rt(a,a.return,he)}}}break;case 4:if(vi(u,a),Xi(a),g&4&&Qe){C=a.stateNode,y=C.containerInfo,C=C.pendingChildren;try{Vl(y,C)}catch(he){Rt(a,a.return,he)}}break;case 13:vi(u,a),Xi(a),y=a.child,y.flags&8192&&(C=y.memoizedState!==null,y.stateNode.isHidden=C,!C||y.alternate!==null&&y.alternate.memoizedState!==null||(Iy=Qt())),g&4&&R4(a);break;case 22:var L=f!==null&&f.memoizedState!==null;if(a.mode&1?(Qn=(f=Qn)||L,vi(u,a),Qn=f):vi(u,a),Xi(a),g&8192){if(f=a.memoizedState!==null,(a.stateNode.isHidden=f)&&!L&&a.mode&1)for(pe=a,g=a.child;g!==null;){for(u=pe=g;pe!==null;){L=pe;var G=L.child;switch(L.tag){case 0:case 11:case 14:case 15:ch(4,L,L.return);break;case 1:tu(L,L.return);var K=L.stateNode;if(typeof K.componentWillUnmount=="function"){var se=L,me=L.return;try{var Ae=se;K.props=Ae.memoizedProps,K.state=Ae.memoizedState,K.componentWillUnmount()}catch(he){Rt(se,me,he)}}break;case 5:tu(L,L.return);break;case 22:if(L.memoizedState!==null){b4(u);continue}}G!==null?(G.return=L,pe=G):b4(u)}g=g.sibling}if(Ce){e:if(g=null,Ce)for(u=a;;){if(u.tag===5){if(g===null){g=u;try{y=u.stateNode,f?Lc(y):Mf(u.stateNode,u.memoizedProps)}catch(he){Rt(a,a.return,he)}}}else if(u.tag===6){if(g===null)try{C=u.stateNode,f?Df(C):ka(C,u.memoizedProps)}catch(he){Rt(a,a.return,he)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===a)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===a)break e;for(;u.sibling===null;){if(u.return===null||u.return===a)break e;g===u&&(g=null),u=u.return}g===u&&(g=null),u.sibling.return=u.return,u=u.sibling}}}break;case 19:vi(u,a),Xi(a),g&4&&R4(a);break;case 21:break;default:vi(u,a),Xi(a)}}function Xi(a){var u=a.flags;if(u&2){try{if(Ce){e:{for(var f=a.return;f!==null;){if(P4(f)){var g=f;break e}f=f.return}throw Error(o(160))}switch(g.tag){case 5:var y=g.stateNode;g.flags&32&&(bf(y),g.flags&=-33);var C=k4(a);_y(a,C,y);break;case 3:case 4:var L=g.stateNode.containerInfo,G=k4(a);my(a,G,L);break;default:throw Error(o(161))}}}catch(K){Rt(a,a.return,K)}a.flags&=-3}u&4096&&(a.flags&=-4097)}function uA(a,u,f){pe=a,A4(a)}function A4(a,u,f){for(var g=(a.mode&1)!==0;pe!==null;){var y=pe,C=y.child;if(y.tag===22&&g){var L=y.memoizedState!==null||cp;if(!L){var G=y.alternate,K=G!==null&&G.memoizedState!==null||Qn;G=cp;var se=Qn;if(cp=L,(Qn=K)&&!se)for(pe=y;pe!==null;)L=pe,K=L.child,L.tag===22&&L.memoizedState!==null?D4(y):K!==null?(K.return=L,pe=K):D4(y);for(;C!==null;)pe=C,A4(C),C=C.sibling;pe=y,cp=G,Qn=se}N4(a)}else y.subtreeFlags&8772&&C!==null?(C.return=y,pe=C):N4(a)}}function N4(a){for(;pe!==null;){var u=pe;if(u.flags&8772){var f=u.alternate;try{if(u.flags&8772)switch(u.tag){case 0:case 11:case 15:Qn||hp(5,u);break;case 1:var g=u.stateNode;if(u.flags&4&&!Qn)if(f===null)g.componentDidMount();else{var y=u.elementType===u.type?f.memoizedProps:_i(u.type,f.memoizedProps);g.componentDidUpdate(y,f.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var C=u.updateQueue;C!==null&&MS(u,C,g);break;case 3:var L=u.updateQueue;if(L!==null){if(f=null,u.child!==null)switch(u.child.tag){case 5:f=Me(u.child.stateNode);break;case 1:f=u.child.stateNode}MS(u,L,f)}break;case 5:var G=u.stateNode;f===null&&u.flags&4&&L_(G,u.type,u.memoizedProps,u);break;case 6:break;case 4:break;case 12:break;case 13:if(lt&&u.memoizedState===null){var K=u.alternate;if(K!==null){var se=K.memoizedState;if(se!==null){var me=se.dehydrated;me!==null&&Gc(me)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(o(163))}Qn||u.flags&512&&gy(u)}catch(Ae){Rt(u,u.return,Ae)}}if(u===a){pe=null;break}if(f=u.sibling,f!==null){f.return=u.return,pe=f;break}pe=u.return}}function b4(a){for(;pe!==null;){var u=pe;if(u===a){pe=null;break}var f=u.sibling;if(f!==null){f.return=u.return,pe=f;break}pe=u.return}}function D4(a){for(;pe!==null;){var u=pe;try{switch(u.tag){case 0:case 11:case 15:var f=u.return;try{hp(4,u)}catch(K){Rt(u,f,K)}break;case 1:var g=u.stateNode;if(typeof g.componentDidMount=="function"){var y=u.return;try{g.componentDidMount()}catch(K){Rt(u,y,K)}}var C=u.return;try{gy(u)}catch(K){Rt(u,C,K)}break;case 5:var L=u.return;try{gy(u)}catch(K){Rt(u,L,K)}}}catch(K){Rt(u,u.return,K)}if(u===a){pe=null;break}var G=u.sibling;if(G!==null){G.return=u.return,pe=G;break}pe=u.return}}var dp=0,fp=1,pp=2,gp=3,mp=4;if(typeof Symbol=="function"&&Symbol.for){var hh=Symbol.for;dp=hh("selector.component"),fp=hh("selector.has_pseudo_class"),pp=hh("selector.role"),gp=hh("selector.test_id"),mp=hh("selector.text")}function vy(a){var u=Kt(a);if(u!=null){if(typeof u.memoizedProps["data-testname"]!="string")throw Error(o(364));return u}if(a=Pf(a),a===null)throw Error(o(362));return a.stateNode.current}function wy(a,u){switch(u.$$typeof){case dp:if(a.type===u.value)return!0;break;case fp:e:{u=u.value,a=[a,0];for(var f=0;f<a.length;){var g=a[f++],y=a[f++],C=u[y];if(g.tag!==5||!fs(g)){for(;C!=null&&wy(g,C);)y++,C=u[y];if(y===u.length){u=!0;break e}else for(g=g.child;g!==null;)a.push(g,y),g=g.sibling}}u=!1}return u;case pp:if(a.tag===5&&kf(a.stateNode,u.value))return!0;break;case mp:if((a.tag===5||a.tag===6)&&(a=Mc(a),a!==null&&0<=a.indexOf(u.value)))return!0;break;case gp:if(a.tag===5&&(a=a.memoizedProps["data-testname"],typeof a=="string"&&a.toLowerCase()===u.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function Ey(a){switch(a.$$typeof){case dp:return"<"+(D(a.value)||"Unknown")+">";case fp:return":has("+(Ey(a)||"")+")";case pp:return'[role="'+a.value+'"]';case mp:return'"'+a.value+'"';case gp:return'[data-testname="'+a.value+'"]';default:throw Error(o(365))}}function M4(a,u){var f=[];a=[a,0];for(var g=0;g<a.length;){var y=a[g++],C=a[g++],L=u[C];if(y.tag!==5||!fs(y)){for(;L!=null&&wy(y,L);)C++,L=u[C];if(C===u.length)f.push(y);else for(y=y.child;y!==null;)a.push(y,C),y=y.sibling}}return f}function Sy(a,u){if(!ds)throw Error(o(363));a=vy(a),a=M4(a,u),u=[],a=Array.from(a);for(var f=0;f<a.length;){var g=a[f++];if(g.tag===5)fs(g)||u.push(g.stateNode);else for(g=g.child;g!==null;)a.push(g),g=g.sibling}return u}var cA=Math.ceil,_p=l.ReactCurrentDispatcher,Cy=l.ReactCurrentOwner,Gt=l.ReactCurrentBatchConfig,Ue=0,_n=null,Xt=null,On=0,Vr=0,nu=di(0),on=0,dh=null,Va=0,yp=0,Ty=0,fh=null,kr=null,Iy=0,Py=1/0,Ps=null;function ru(){Py=Qt()+500}var vp=!1,ky=null,go=null,wp=!1,mo=null,Ep=0,ph=0,Ry=null,Sp=-1,Cp=0;function Yn(){return Ue&6?Qt():Sp!==-1?Sp:Sp=Qt()}function _o(a){return a.mode&1?Ue&2&&On!==0?On&-On:fr.transition!==null?(Cp===0&&(Cp=Gf()),Cp):(a=Ye,a!==0?a:ur()):1}function Zr(a,u,f,g){if(50<ph)throw ph=0,Ry=null,Error(o(185));Cr(a,f,g),(!(Ue&2)||a!==_n)&&(a===_n&&(!(Ue&2)&&(yp|=f),on===4&&yo(a,On)),Rr(a,g),f===1&&Ue===0&&!(u.mode&1)&&(ru(),ql&&cr()))}function Rr(a,u){var f=a.callbackNode;j_(a,u);var g=ba(a,a===_n?On:0);if(g===0)f!==null&&Hf(f),a.callbackNode=null,a.callbackPriority=0;else if(u=g&-g,a.callbackPriority!==u){if(f!=null&&Hf(f),u===1)a.tag===0?Kf(L4.bind(null,a)):Xc(L4.bind(null,a)),Fi?If(function(){!(Ue&6)&&cr()}):Kc(Qc,cr),f=null;else{switch(vs(g)){case 1:f=Qc;break;case 4:f=$l;break;case 16:f=co;break;case 536870912:f=$f;break;default:f=co}f=H4(f,O4.bind(null,a))}a.callbackPriority=u,a.callbackNode=f}}function O4(a,u){if(Sp=-1,Cp=0,Ue&6)throw Error(o(327));var f=a.callbackNode;if(za()&&a.callbackNode!==f)return null;var g=ba(a,a===_n?On:0);if(g===0)return null;if(g&30||g&a.expiredLanes||u)u=Tp(a,g);else{u=g;var y=Ue;Ue|=2;var C=U4();(_n!==a||On!==u)&&(Ps=null,ru(),Ua(a,u));do try{fA();break}catch(G){V4(a,G)}while(!0);He(),_p.current=C,Ue=y,Xt!==null?u=0:(_n=null,On=0,u=on)}if(u!==0){if(u===2&&(y=qc(a),y!==0&&(g=y,u=xy(a,y))),u===1)throw f=dh,Ua(a,0),yo(a,g),Rr(a,Qt()),f;if(u===6)yo(a,g);else{if(y=a.current.alternate,!(g&30)&&!hA(y)&&(u=Tp(a,g),u===2&&(C=qc(a),C!==0&&(g=C,u=xy(a,C))),u===1))throw f=dh,Ua(a,0),yo(a,g),Rr(a,Qt()),f;switch(a.finishedWork=y,a.finishedLanes=g,u){case 0:case 1:throw Error(o(345));case 2:Ba(a,kr,Ps);break;case 3:if(yo(a,g),(g&130023424)===g&&(u=Iy+500-Qt(),10<u)){if(ba(a,0)!==0)break;if(y=a.suspendedLanes,(y&g)!==g){Yn(),a.pingedLanes|=a.suspendedLanes&y;break}a.timeoutHandle=j(Ba.bind(null,a,kr,Ps),u);break}Ba(a,kr,Ps);break;case 4:if(yo(a,g),(g&4194240)===g)break;for(u=a.eventTimes,y=-1;0<g;){var L=31-Gn(g);C=1<<L,L=u[L],L>y&&(y=L),g&=~C}if(g=y,g=Qt()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*cA(g/1960))-g,10<g){a.timeoutHandle=j(Ba.bind(null,a,kr,Ps),g);break}Ba(a,kr,Ps);break;case 5:Ba(a,kr,Ps);break;default:throw Error(o(329))}}}return Rr(a,Qt()),a.callbackNode===f?O4.bind(null,a):null}function xy(a,u){var f=fh;return a.current.memoizedState.isDehydrated&&(Ua(a,u).flags|=256),a=Tp(a,u),a!==2&&(u=kr,kr=f,u!==null&&Ay(u)),a}function Ay(a){kr===null?kr=a:kr.push.apply(kr,a)}function hA(a){for(var u=a;;){if(u.flags&16384){var f=u.updateQueue;if(f!==null&&(f=f.stores,f!==null))for(var g=0;g<f.length;g++){var y=f[g],C=y.getSnapshot;y=y.value;try{if(!Je(C(),y))return!1}catch{return!1}}}if(f=u.child,u.subtreeFlags&16384&&f!==null)f.return=u,u=f;else{if(u===a)break;for(;u.sibling===null;){if(u.return===null||u.return===a)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function yo(a,u){for(u&=~Ty,u&=~yp,a.suspendedLanes|=u,a.pingedLanes&=~u,a=a.expirationTimes;0<u;){var f=31-Gn(u),g=1<<f;a[f]=-1,u&=~g}}function L4(a){if(Ue&6)throw Error(o(327));za();var u=ba(a,0);if(!(u&1))return Rr(a,Qt()),null;var f=Tp(a,u);if(a.tag!==0&&f===2){var g=qc(a);g!==0&&(u=g,f=xy(a,g))}if(f===1)throw f=dh,Ua(a,0),yo(a,u),Rr(a,Qt()),f;if(f===6)throw Error(o(345));return a.finishedWork=a.current.alternate,a.finishedLanes=u,Ba(a,kr,Ps),Rr(a,Qt()),null}function F4(a){mo!==null&&mo.tag===0&&!(Ue&6)&&za();var u=Ue;Ue|=1;var f=Gt.transition,g=Ye;try{if(Gt.transition=null,Ye=1,a)return a()}finally{Ye=g,Gt.transition=f,Ue=u,!(Ue&6)&&cr()}}function Ny(){Vr=nu.current,ft(nu)}function Ua(a,u){a.finishedWork=null,a.finishedLanes=0;var f=a.timeoutHandle;if(f!==ve&&(a.timeoutHandle=ve,te(f)),Xt!==null)for(f=Xt.return;f!==null;){var g=f;switch(Es(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&xa();break;case 3:Zl(),ft(Nn),ft(nn),Q_();break;case 5:q_(g);break;case 4:Zl();break;case 13:ft(Nt);break;case 19:ft(Nt);break;case 10:Yt(g.type._context);break;case 22:case 23:Ny()}f=f.return}if(_n=a,Xt=a=vo(a.current,null),On=Vr=u,on=0,dh=null,Ty=yp=Va=0,kr=fh=null,mi!==null){for(u=0;u<mi.length;u++)if(f=mi[u],g=f.interleaved,g!==null){f.interleaved=null;var y=g.next,C=f.pending;if(C!==null){var L=C.next;C.next=y,g.next=L}f.pending=g}mi=null}return a}function V4(a,u){do{var f=Xt;try{if(He(),ep.current=ip,tp){for(var g=bt.memoizedState;g!==null;){var y=g.queue;y!==null&&(y.pending=null),g=g.next}tp=!1}if(Fa=0,mn=sn=bt=null,rh=!1,ih=0,Cy.current=null,f===null||f.return===null){on=1,dh=u,Xt=null;break}e:{var C=a,L=f.return,G=f,K=u;if(u=On,G.flags|=32768,K!==null&&typeof K=="object"&&typeof K.then=="function"){var se=K,me=G,Ae=me.tag;if(!(me.mode&1)&&(Ae===0||Ae===11||Ae===15)){var he=me.alternate;he?(me.updateQueue=he.updateQueue,me.memoizedState=he.memoizedState,me.lanes=he.lanes):(me.updateQueue=null,me.memoizedState=null)}var It=u4(L);if(It!==null){It.flags&=-257,c4(It,L,G,C,u),It.mode&1&&l4(C,se,u),u=It,K=se;var _t=u.updateQueue;if(_t===null){var xr=new Set;xr.add(K),u.updateQueue=xr}else _t.add(K);break e}else{if(!(u&1)){l4(C,se,u),by();break e}K=Error(o(426))}}else if(pt&&G.mode&1){var ks=u4(L);if(ks!==null){!(ks.flags&65536)&&(ks.flags|=256),c4(ks,L,G,C,u),ho(eu(K,G));break e}}C=K=eu(K,G),on!==4&&(on=2),fh===null?fh=[C]:fh.push(C),C=L;do{switch(C.tag){case 3:C.flags|=65536,u&=-u,C.lanes|=u;var q=o4(C,K,u);DS(C,q);break e;case 1:G=K;var W=C.type,Y=C.stateNode;if(!(C.flags&128)&&(typeof W.getDerivedStateFromError=="function"||Y!==null&&typeof Y.componentDidCatch=="function"&&(go===null||!go.has(Y)))){C.flags|=65536,u&=-u,C.lanes|=u;var fe=a4(C,G,u);DS(C,fe);break e}}C=C.return}while(C!==null)}z4(f)}catch(Ee){u=Ee,Xt===f&&f!==null&&(Xt=f=f.return);continue}break}while(!0)}function U4(){var a=_p.current;return _p.current=ip,a===null?ip:a}function by(){(on===0||on===3||on===2)&&(on=4),_n===null||!(Va&268435455)&&!(yp&268435455)||yo(_n,On)}function Tp(a,u){var f=Ue;Ue|=2;var g=U4();(_n!==a||On!==u)&&(Ps=null,Ua(a,u));do try{dA();break}catch(y){V4(a,y)}while(!0);if(He(),Ue=f,_p.current=g,Xt!==null)throw Error(o(261));return _n=null,On=0,on}function dA(){for(;Xt!==null;)B4(Xt)}function fA(){for(;Xt!==null&&!G_();)B4(Xt)}function B4(a){var u=W4(a.alternate,a,Vr);a.memoizedProps=a.pendingProps,u===null?z4(a):Xt=u,Cy.current=null}function z4(a){var u=a;do{var f=u.alternate;if(a=u.return,u.flags&32768){if(f=oA(f,u),f!==null){f.flags&=32767,Xt=f;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{on=6,Xt=null;return}}else if(f=sA(f,u,Vr),f!==null){Xt=f;return}if(u=u.sibling,u!==null){Xt=u;return}Xt=u=a}while(u!==null);on===0&&(on=5)}function Ba(a,u,f){var g=Ye,y=Gt.transition;try{Gt.transition=null,Ye=1,pA(a,u,f,g)}finally{Gt.transition=y,Ye=g}return null}function pA(a,u,f,g){do za();while(mo!==null);if(Ue&6)throw Error(o(327));f=a.finishedWork;var y=a.finishedLanes;if(f===null)return null;if(a.finishedWork=null,a.finishedLanes=0,f===a.current)throw Error(o(177));a.callbackNode=null,a.callbackPriority=0;var C=f.lanes|f.childLanes;if(Wf(a,C),a===_n&&(Xt=_n=null,On=0),!(f.subtreeFlags&2064)&&!(f.flags&2064)||wp||(wp=!0,H4(co,function(){return za(),null})),C=(f.flags&15990)!==0,f.subtreeFlags&15990||C){C=Gt.transition,Gt.transition=null;var L=Ye;Ye=1;var G=Ue;Ue|=4,Cy.current=null,lA(a,f),x4(f,a),ee(a.containerInfo),a.current=f,uA(f),Gi(),Ue=G,Ye=L,Gt.transition=C}else a.current=f;if(wp&&(wp=!1,mo=a,Ep=y),C=a.pendingLanes,C===0&&(go=null),qf(f.stateNode),Rr(a,Qt()),u!==null)for(g=a.onRecoverableError,f=0;f<u.length;f++)y=u[f],g(y.value,{componentStack:y.stack,digest:y.digest});if(vp)throw vp=!1,a=ky,ky=null,a;return Ep&1&&a.tag!==0&&za(),C=a.pendingLanes,C&1?a===Ry?ph++:(ph=0,Ry=a):ph=0,cr(),null}function za(){if(mo!==null){var a=vs(Ep),u=Gt.transition,f=Ye;try{if(Gt.transition=null,Ye=16>a?16:a,mo===null)var g=!1;else{if(a=mo,mo=null,Ep=0,Ue&6)throw Error(o(331));var y=Ue;for(Ue|=4,pe=a.current;pe!==null;){var C=pe,L=C.child;if(pe.flags&16){var G=C.deletions;if(G!==null){for(var K=0;K<G.length;K++){var se=G[K];for(pe=se;pe!==null;){var me=pe;switch(me.tag){case 0:case 11:case 15:ch(8,me,C)}var Ae=me.child;if(Ae!==null)Ae.return=me,pe=Ae;else for(;pe!==null;){me=pe;var he=me.sibling,It=me.return;if(I4(me),me===se){pe=null;break}if(he!==null){he.return=It,pe=he;break}pe=It}}}var _t=C.alternate;if(_t!==null){var xr=_t.child;if(xr!==null){_t.child=null;do{var ks=xr.sibling;xr.sibling=null,xr=ks}while(xr!==null)}}pe=C}}if(C.subtreeFlags&2064&&L!==null)L.return=C,pe=L;else e:for(;pe!==null;){if(C=pe,C.flags&2048)switch(C.tag){case 0:case 11:case 15:ch(9,C,C.return)}var q=C.sibling;if(q!==null){q.return=C.return,pe=q;break e}pe=C.return}}var W=a.current;for(pe=W;pe!==null;){L=pe;var Y=L.child;if(L.subtreeFlags&2064&&Y!==null)Y.return=L,pe=Y;else e:for(L=W;pe!==null;){if(G=pe,G.flags&2048)try{switch(G.tag){case 0:case 11:case 15:hp(9,G)}}catch(Ee){Rt(G,G.return,Ee)}if(G===L){pe=null;break e}var fe=G.sibling;if(fe!==null){fe.return=G.return,pe=fe;break e}pe=G.return}}if(Ue=y,cr(),Wn&&typeof Wn.onPostCommitFiberRoot=="function")try{Wn.onPostCommitFiberRoot(Wi,a)}catch{}g=!0}return g}finally{Ye=f,Gt.transition=u}}return!1}function j4(a,u,f){u=eu(f,u),u=o4(a,u,1),a=po(a,u,1),u=Yn(),a!==null&&(Cr(a,1,u),Rr(a,u))}function Rt(a,u,f){if(a.tag===3)j4(a,a,f);else for(;u!==null;){if(u.tag===3){j4(u,a,f);break}else if(u.tag===1){var g=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(go===null||!go.has(g))){a=eu(f,a),a=a4(u,a,1),u=po(u,a,1),a=Yn(),u!==null&&(Cr(u,1,a),Rr(u,a));break}}u=u.return}}function gA(a,u,f){var g=a.pingCache;g!==null&&g.delete(u),u=Yn(),a.pingedLanes|=a.suspendedLanes&f,_n===a&&(On&f)===f&&(on===4||on===3&&(On&130023424)===On&&500>Qt()-Iy?Ua(a,0):Ty|=f),Rr(a,u)}function G4(a,u){u===0&&(a.mode&1?(u=ji,ji<<=1,!(ji&130023424)&&(ji=4194304)):u=1);var f=Yn();a=$i(a,u),a!==null&&(Cr(a,u,f),Rr(a,f))}function mA(a){var u=a.memoizedState,f=0;u!==null&&(f=u.retryLane),G4(a,f)}function _A(a,u){var f=0;switch(a.tag){case 13:var g=a.stateNode,y=a.memoizedState;y!==null&&(f=y.retryLane);break;case 19:g=a.stateNode;break;default:throw Error(o(314))}g!==null&&g.delete(u),G4(a,f)}var W4;W4=function(a,u,f){if(a!==null)if(a.memoizedProps!==u.pendingProps||Nn.current)Pr=!0;else{if(!(a.lanes&f)&&!(u.flags&128))return Pr=!1,iA(a,u,f);Pr=!!(a.flags&131072)}else Pr=!1,pt&&u.flags&1048576&&Qf(u,Ql,u.index);switch(u.lanes=0,u.tag){case 2:var g=u.type;ap(a,u),a=u.pendingProps;var y=uo(u,nn.current);gn(u,f),y=J_(null,u,g,a,y,f);var C=Z_();return u.flags|=1,typeof y=="object"&&y!==null&&typeof y.render=="function"&&y.$$typeof===void 0?(u.tag=1,u.memoizedState=null,u.updateQueue=null,bn(g)?(C=!0,Sr(u)):C=!1,u.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,H_(u),y.updater=sp,u.stateNode=y,y._reactInternals=u,sy(u,g,a,f),u=uy(null,u,g,!0,C,f)):(u.tag=0,pt&&C&&Yl(u),pr(null,u,y,f),u=u.child),u;case 16:g=u.elementType;e:{switch(ap(a,u),a=u.pendingProps,y=g._init,g=y(g._payload),u.type=g,y=u.tag=vA(g),a=_i(g,a),y){case 0:u=ly(null,u,g,a,f);break e;case 1:u=m4(null,u,g,a,f);break e;case 11:u=h4(null,u,g,a,f);break e;case 14:u=d4(null,u,g,_i(g.type,a),f);break e}throw Error(o(306,g,""))}return u;case 0:return g=u.type,y=u.pendingProps,y=u.elementType===g?y:_i(g,y),ly(a,u,g,y,f);case 1:return g=u.type,y=u.pendingProps,y=u.elementType===g?y:_i(g,y),m4(a,u,g,y,f);case 3:e:{if(_4(u),a===null)throw Error(o(387));g=u.pendingProps,C=u.memoizedState,y=C.element,bS(a,u),Jf(u,g,null,f);var L=u.memoizedState;if(g=L.element,lt&&C.isDehydrated)if(C={element:g,isDehydrated:!1,cache:L.cache,pendingSuspenseBoundaries:L.pendingSuspenseBoundaries,transitions:L.transitions},u.updateQueue.baseState=C,u.memoizedState=C,u.flags&256){y=eu(Error(o(423)),u),u=y4(a,u,g,f,y);break e}else if(g!==y){y=eu(Error(o(424)),u),u=y4(a,u,g,f,y);break e}else for(lt&&(dr=Bl(u.stateNode.containerInfo),$n=u,pt=!0,Ir=null,Ss=!1),f=H(u,null,g,f),u.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(Cs(),g===y){u=Is(a,u,f);break e}pr(a,u,g,f)}u=u.child}return u;case 5:return OS(u),a===null&&gi(u),g=u.type,y=u.pendingProps,C=a!==null?a.memoizedProps:null,L=y.children,dt(g,y)?L=null:C!==null&&dt(g,C)&&(u.flags|=32),g4(a,u),pr(a,u,L,f),u.child;case 6:return a===null&&gi(u),null;case 13:return v4(a,u,f);case 4:return $_(u,u.stateNode.containerInfo),g=u.pendingProps,a===null?u.child=M(u,null,g,f):pr(a,u,g,f),u.child;case 11:return g=u.type,y=u.pendingProps,y=u.elementType===g?y:_i(g,y),h4(a,u,g,y,f);case 7:return pr(a,u,u.pendingProps,f),u.child;case 8:return pr(a,u,u.pendingProps.children,f),u.child;case 12:return pr(a,u,u.pendingProps.children,f),u.child;case 10:e:{if(g=u.type._context,y=u.pendingProps,C=u.memoizedProps,L=y.value,rn(u,g,L),C!==null)if(Je(C.value,L)){if(C.children===y.children&&!Nn.current){u=Is(a,u,f);break e}}else for(C=u.child,C!==null&&(C.return=u);C!==null;){var G=C.dependencies;if(G!==null){L=C.child;for(var K=G.firstContext;K!==null;){if(K.context===g){if(C.tag===1){K=Ts(-1,f&-f),K.tag=2;var se=C.updateQueue;if(se!==null){se=se.shared;var me=se.pending;me===null?K.next=K:(K.next=me.next,me.next=K),se.pending=K}}C.lanes|=f,K=C.alternate,K!==null&&(K.lanes|=f),Hi(C.return,f,u),G.lanes|=f;break}K=K.next}}else if(C.tag===10)L=C.type===u.type?null:C.child;else if(C.tag===18){if(L=C.return,L===null)throw Error(o(341));L.lanes|=f,G=L.alternate,G!==null&&(G.lanes|=f),Hi(L,f,u),L=C.sibling}else L=C.child;if(L!==null)L.return=C;else for(L=C;L!==null;){if(L===u){L=null;break}if(C=L.sibling,C!==null){C.return=L.return,L=C;break}L=L.return}C=L}pr(a,u,y.children,f),u=u.child}return u;case 9:return y=u.type,g=u.pendingProps.children,gn(u,f),y=Dn(y),g=g(y),u.flags|=1,pr(a,u,g,f),u.child;case 14:return g=u.type,y=_i(g,u.pendingProps),y=_i(g.type,y),d4(a,u,g,y,f);case 15:return f4(a,u,u.type,u.pendingProps,f);case 17:return g=u.type,y=u.pendingProps,y=u.elementType===g?y:_i(g,y),ap(a,u),u.tag=1,bn(g)?(a=!0,Sr(u)):a=!1,gn(u,f),i4(u,g,y),sy(u,g,y,f),uy(null,u,g,!0,a,f);case 19:return E4(a,u,f);case 22:return p4(a,u,f)}throw Error(o(156,u.tag))};function H4(a,u){return Kc(a,u)}function yA(a,u,f,g){this.tag=a,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ei(a,u,f,g){return new yA(a,u,f,g)}function Dy(a){return a=a.prototype,!(!a||!a.isReactComponent)}function vA(a){if(typeof a=="function")return Dy(a)?1:0;if(a!=null){if(a=a.$$typeof,a===k)return 11;if(a===R)return 14}return 2}function vo(a,u){var f=a.alternate;return f===null?(f=ei(a.tag,u,a.key,a.mode),f.elementType=a.elementType,f.type=a.type,f.stateNode=a.stateNode,f.alternate=a,a.alternate=f):(f.pendingProps=u,f.type=a.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=a.flags&14680064,f.childLanes=a.childLanes,f.lanes=a.lanes,f.child=a.child,f.memoizedProps=a.memoizedProps,f.memoizedState=a.memoizedState,f.updateQueue=a.updateQueue,u=a.dependencies,f.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},f.sibling=a.sibling,f.index=a.index,f.ref=a.ref,f}function Ip(a,u,f,g,y,C){var L=2;if(g=a,typeof a=="function")Dy(a)&&(L=1);else if(typeof a=="string")L=5;else e:switch(a){case p:return ja(f.children,y,C,u);case m:L=8,y|=8;break;case _:return a=ei(12,f,u,y|2),a.elementType=_,a.lanes=C,a;case N:return a=ei(13,f,u,y),a.elementType=N,a.lanes=C,a;case x:return a=ei(19,f,u,y),a.elementType=x,a.lanes=C,a;case P:return Pp(f,y,C,u);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case w:L=10;break e;case S:L=9;break e;case k:L=11;break e;case R:L=14;break e;case E:L=16,g=null;break e}throw Error(o(130,a==null?a:typeof a,""))}return u=ei(L,f,u,y),u.elementType=a,u.type=g,u.lanes=C,u}function ja(a,u,f,g){return a=ei(7,a,g,u),a.lanes=f,a}function Pp(a,u,f,g){return a=ei(22,a,g,u),a.elementType=P,a.lanes=f,a.stateNode={isHidden:!1},a}function My(a,u,f){return a=ei(6,a,null,u),a.lanes=f,a}function Oy(a,u,f){return u=ei(4,a.children!==null?a.children:[],a.key,u),u.lanes=f,u.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},u}function wA(a,u,f,g,y){this.tag=u,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=ve,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ys(0),this.expirationTimes=ys(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ys(0),this.identifierPrefix=g,this.onRecoverableError=y,lt&&(this.mutableSourceEagerHydrationData=null)}function $4(a,u,f,g,y,C,L,G,K){return a=new wA(a,u,f,G,K),u===1?(u=1,C===!0&&(u|=8)):u=0,C=ei(3,null,null,u),a.current=C,C.stateNode=a,C.memoizedState={element:g,isDehydrated:f,cache:null,transitions:null,pendingSuspenseBoundaries:null},H_(C),a}function q4(a){if(!a)return qr;a=a._reactInternals;e:{if(b(a)!==a||a.tag!==1)throw Error(o(170));var u=a;do{switch(u.tag){case 3:u=u.stateNode.context;break e;case 1:if(bn(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break e}}u=u.return}while(u!==null);throw Error(o(171))}if(a.tag===1){var f=a.type;if(bn(f))return Bi(a,f,u)}return u}function K4(a){var u=a._reactInternals;if(u===void 0)throw typeof a.render=="function"?Error(o(188)):(a=Object.keys(a).join(","),Error(o(268,a)));return a=U(u),a===null?null:a.stateNode}function Q4(a,u){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var f=a.retryLane;a.retryLane=f!==0&&f<u?f:u}}function kp(a,u){Q4(a,u),(a=a.alternate)&&Q4(a,u)}function EA(a){return a=U(a),a===null?null:a.stateNode}function SA(){return null}return t.attemptContinuousHydration=function(a){if(a.tag===13){var u=$i(a,134217728);if(u!==null){var f=Yn();Zr(u,a,134217728,f)}kp(a,134217728)}},t.attemptDiscreteHydration=function(a){if(a.tag===13){var u=$i(a,1);if(u!==null){var f=Yn();Zr(u,a,1,f)}kp(a,1)}},t.attemptHydrationAtCurrentPriority=function(a){if(a.tag===13){var u=_o(a),f=$i(a,u);if(f!==null){var g=Yn();Zr(f,a,u,g)}kp(a,u)}},t.attemptSynchronousHydration=function(a){switch(a.tag){case 3:var u=a.stateNode;if(u.current.memoizedState.isDehydrated){var f=Na(u.pendingLanes);f!==0&&(Hl(u,f|1),Rr(u,Qt()),!(Ue&6)&&(ru(),cr()))}break;case 13:F4(function(){var g=$i(a,1);if(g!==null){var y=Yn();Zr(g,a,1,y)}}),kp(a,1)}},t.batchedUpdates=function(a,u){var f=Ue;Ue|=1;try{return a(u)}finally{Ue=f,Ue===0&&(ru(),ql&&cr())}},t.createComponentSelector=function(a){return{$$typeof:dp,value:a}},t.createContainer=function(a,u,f,g,y,C,L){return $4(a,u,!1,null,f,g,y,C,L)},t.createHasPseudoClassSelector=function(a){return{$$typeof:fp,value:a}},t.createHydrationContainer=function(a,u,f,g,y,C,L,G,K){return a=$4(f,g,!0,a,y,C,L,G,K),a.context=q4(null),f=a.current,g=Yn(),y=_o(f),C=Ts(g,y),C.callback=u??null,po(f,C,y),a.current.lanes=y,Cr(a,y,g),Rr(a,g),a},t.createPortal=function(a,u,f){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:h,key:g==null?null:""+g,children:a,containerInfo:u,implementation:f}},t.createRoleSelector=function(a){return{$$typeof:pp,value:a}},t.createTestNameSelector=function(a){return{$$typeof:gp,value:a}},t.createTextSelector=function(a){return{$$typeof:mp,value:a}},t.deferredUpdates=function(a){var u=Ye,f=Gt.transition;try{return Gt.transition=null,Ye=16,a()}finally{Ye=u,Gt.transition=f}},t.discreteUpdates=function(a,u,f,g,y){var C=Ye,L=Gt.transition;try{return Gt.transition=null,Ye=1,a(u,f,g,y)}finally{Ye=C,Gt.transition=L,Ue===0&&ru()}},t.findAllNodes=Sy,t.findBoundingRects=function(a,u){if(!ds)throw Error(o(363));u=Sy(a,u),a=[];for(var f=0;f<u.length;f++)a.push(O_(u[f]));for(u=a.length-1;0<u;u--){f=a[u];for(var g=f.x,y=g+f.width,C=f.y,L=C+f.height,G=u-1;0<=G;G--)if(u!==G){var K=a[G],se=K.x,me=se+K.width,Ae=K.y,he=Ae+K.height;if(g>=se&&C>=Ae&&y<=me&&L<=he){a.splice(u,1);break}else if(g!==se||f.width!==K.width||he<C||Ae>L){if(!(C!==Ae||f.height!==K.height||me<g||se>y)){se>g&&(K.width+=se-g,K.x=g),me<y&&(K.width=y-se),a.splice(u,1);break}}else{Ae>C&&(K.height+=Ae-C,K.y=C),he<L&&(K.height=L-Ae),a.splice(u,1);break}}}return a},t.findHostInstance=K4,t.findHostInstanceWithNoPortals=function(a){return a=O(a),a=a!==null?ce(a):null,a===null?null:a.stateNode},t.findHostInstanceWithWarning=function(a){return K4(a)},t.flushControlled=function(a){var u=Ue;Ue|=1;var f=Gt.transition,g=Ye;try{Gt.transition=null,Ye=1,a()}finally{Ye=g,Gt.transition=f,Ue=u,Ue===0&&(ru(),cr())}},t.flushPassiveEffects=za,t.flushSync=F4,t.focusWithin=function(a,u){if(!ds)throw Error(o(363));for(a=vy(a),u=M4(a,u),u=Array.from(u),a=0;a<u.length;){var f=u[a++];if(!fs(f)){if(f.tag===5&&fn(f.stateNode))return!0;for(f=f.child;f!==null;)u.push(f),f=f.sibling}}return!1},t.getCurrentUpdatePriority=function(){return Ye},t.getFindAllNodesFailureDescription=function(a,u){if(!ds)throw Error(o(363));var f=0,g=[];a=[vy(a),0];for(var y=0;y<a.length;){var C=a[y++],L=a[y++],G=u[L];if((C.tag!==5||!fs(C))&&(wy(C,G)&&(g.push(Ey(G)),L++,L>f&&(f=L)),L<u.length))for(C=C.child;C!==null;)a.push(C,L),C=C.sibling}if(f<u.length){for(a=[];f<u.length;f++)a.push(Ey(u[f]));return`findAllNodes was able to match part of the selector:
  `+(g.join(" > ")+`

No matching component was found for:
  `)+a.join(" > ")}return null},t.getPublicRootInstance=function(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return Me(a.child.stateNode);default:return a.child.stateNode}},t.injectIntoDevTools=function(a){if(a={bundleType:a.bundleType,version:a.version,rendererPackageName:a.rendererPackageName,rendererConfig:a.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:l.ReactCurrentDispatcher,findHostInstanceByFiber:EA,findFiberByHostInstance:a.findFiberByHostInstance||SA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")a=!1;else{var u=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(u.isDisabled||!u.supportsFiber)a=!0;else{try{Wi=u.inject(a),Wn=u}catch{}a=!!u.checkDCE}}return a},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(a,u,f,g){if(!ds)throw Error(o(363));a=Sy(a,u);var y=xn(a,f,g).disconnect;return{disconnect:function(){y()}}},t.registerMutableSourceForHydration=function(a,u){var f=u._getVersion;f=f(u._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[u,f]:a.mutableSourceEagerHydrationData.push(u,f)},t.runWithPriority=function(a,u){var f=Ye;try{return Ye=a,u()}finally{Ye=f}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(a,u,f,g){var y=u.current,C=Yn(),L=_o(y);return f=q4(f),u.context===null?u.context=f:u.pendingContext=f,u=Ts(C,L),u.payload={element:a},g=g===void 0?null:g,g!==null&&(u.callback=g),a=po(y,u,L),a!==null&&(Zr(a,y,L,C),Xf(a,y,L)),L},t};Nx.exports=fH;var pH=Nx.exports;const gH=Bm(pH);var bx={exports:{}},Ol={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Ol.ConcurrentRoot=1;Ol.ContinuousEventPriority=4;Ol.DefaultEventPriority=16;Ol.DiscreteEventPriority=1;Ol.IdleEventPriority=536870912;Ol.LegacyRoot=0;bx.exports=Ol;var Dx=bx.exports;const L5={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let F5=!1,V5=!1;const IS=".react-konva-event",mH=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,_H=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,yH={};function b_(n,e,t=yH){if(!F5&&"zIndex"in e&&(console.warn(_H),F5=!0),!V5&&e.draggable){var r=e.x!==void 0||e.y!==void 0,i=e.onDragEnd||e.onDragMove;r&&!i&&(console.warn(mH),V5=!0)}for(var s in t)if(!L5[s]){var o=s.slice(0,2)==="on",l=t[s]!==e[s];if(o&&l){var c=s.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),n.off(c,t[s])}var h=!e.hasOwnProperty(s);h&&n.setAttr(s,void 0)}var p=e._useStrictMode,m={},_=!1;const w={};for(var s in e)if(!L5[s]){var o=s.slice(0,2)==="on",S=t[s]!==e[s];if(o&&S){var c=s.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),e[s]&&(w[c]=e[s])}!o&&(e[s]!==t[s]||p&&e[s]!==n.getAttr(s))&&(_=!0,m[s]=e[s])}_&&(n.setAttrs(m),Ia(n));for(var c in w)n.on(c+IS,w[c])}function Ia(n){if(!Le.Konva.autoDrawEnabled){var e=n.getLayer()||n.getStage();e&&e.batchDraw()}}const Mx={},vH={};qd.Node.prototype._applyProps=b_;function wH(n,e){if(typeof e=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${e}`);return}n.add(e),Ia(n)}function EH(n,e,t){let r=qd[n];r||(console.error(`Konva has no node with the type ${n}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${n}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),r=qd.Group);const i={},s={};for(var o in e){var l=o.slice(0,2)==="on";l?s[o]=e[o]:i[o]=e[o]}const c=new r(i);return b_(c,s),c}function SH(n,e,t){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${n}"`)}function CH(n,e,t){return!1}function TH(n){return n}function IH(){return null}function PH(){return null}function kH(n,e,t,r){return vH}function RH(){}function xH(n){}function AH(n,e){return!1}function NH(){return Mx}function bH(){return Mx}const DH=setTimeout,MH=clearTimeout,OH=-1;function LH(n,e){return!1}const FH=!1,VH=!0,UH=!0;function BH(n,e){e.parent===n?e.moveToTop():n.add(e),Ia(n)}function zH(n,e){e.parent===n?e.moveToTop():n.add(e),Ia(n)}function Ox(n,e,t){e._remove(),n.add(e),e.setZIndex(t.getZIndex()),Ia(n)}function jH(n,e,t){Ox(n,e,t)}function GH(n,e){e.destroy(),e.off(IS),Ia(n)}function WH(n,e){e.destroy(),e.off(IS),Ia(n)}function HH(n,e,t){console.error(`Text components are not yet supported in ReactKonva. You text is: "${t}"`)}function $H(n,e,t){}function qH(n,e,t,r,i){b_(n,i,r)}function KH(n){n.hide(),Ia(n)}function QH(n){}function YH(n,e){(e.visible==null||e.visible)&&n.show()}function XH(n,e){}function JH(n){}function ZH(){}const e$=()=>Dx.DefaultEventPriority,t$=Object.freeze(Object.defineProperty({__proto__:null,appendChild:BH,appendChildToContainer:zH,appendInitialChild:wH,cancelTimeout:MH,clearContainer:JH,commitMount:$H,commitTextUpdate:HH,commitUpdate:qH,createInstance:EH,createTextInstance:SH,detachDeletedInstance:ZH,finalizeInitialChildren:CH,getChildHostContext:bH,getCurrentEventPriority:e$,getPublicInstance:TH,getRootHostContext:NH,hideInstance:KH,hideTextInstance:QH,idlePriority:Gh.unstable_IdlePriority,insertBefore:Ox,insertInContainerBefore:jH,isPrimaryRenderer:FH,noTimeout:OH,now:Gh.unstable_now,prepareForCommit:IH,preparePortalMount:PH,prepareUpdate:kH,removeChild:GH,removeChildFromContainer:WH,resetAfterCommit:RH,resetTextContent:xH,run:Gh.unstable_runWithPriority,scheduleTimeout:DH,shouldDeprioritizeSubtree:AH,shouldSetTextContent:LH,supportsMutation:UH,unhideInstance:YH,unhideTextInstance:XH,warnsIfNotActing:VH},Symbol.toStringTag,{value:"Module"}));var n$=Object.defineProperty,r$=Object.defineProperties,i$=Object.getOwnPropertyDescriptors,U5=Object.getOwnPropertySymbols,s$=Object.prototype.hasOwnProperty,o$=Object.prototype.propertyIsEnumerable,B5=(n,e,t)=>e in n?n$(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,z5=(n,e)=>{for(var t in e||(e={}))s$.call(e,t)&&B5(n,t,e[t]);if(U5)for(var t of U5(e))o$.call(e,t)&&B5(n,t,e[t]);return n},a$=(n,e)=>r$(n,i$(e)),j5,G5;typeof window<"u"&&((j5=window.document)!=null&&j5.createElement||((G5=window.navigator)==null?void 0:G5.product)==="ReactNative")?ue.useLayoutEffect:ue.useEffect;function Lx(n,e,t){if(!n)return;if(t(n)===!0)return n;let r=n.child;for(;r;){const i=Lx(r,e,t);if(i)return i;r=r.sibling}}function Fx(n){try{return Object.defineProperties(n,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return n}}const W5=console.error;console.error=function(){const n=[...arguments].join("");if(n!=null&&n.startsWith("Warning:")&&n.includes("useContext")){console.error=W5;return}return W5.apply(this,arguments)};const PS=Fx(ue.createContext(null));class Vx extends ue.Component{render(){return ue.createElement(PS.Provider,{value:this._reactInternals},this.props.children)}}function l$(){const n=ue.useContext(PS);if(n===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=ue.useId();return ue.useMemo(()=>{for(const r of[n,n==null?void 0:n.alternate]){if(!r)continue;const i=Lx(r,!1,s=>{let o=s.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(i)return i}},[n,e])}function u$(){const n=l$(),[e]=ue.useState(()=>new Map);e.clear();let t=n;for(;t;){if(t.type&&typeof t.type=="object"){const i=t.type._context===void 0&&t.type.Provider===t.type?t.type:t.type._context;i&&i!==PS&&!e.has(i)&&e.set(i,ue.useContext(Fx(i)))}t=t.return}return e}function c$(){const n=u$();return ue.useMemo(()=>Array.from(n.keys()).reduce((e,t)=>r=>ue.createElement(e,null,ue.createElement(t.Provider,a$(z5({},r),{value:n.get(t)}))),e=>ue.createElement(Vx,z5({},e))),[n])}function h$(n){const e=En.useRef({});return En.useLayoutEffect(()=>{e.current=n}),En.useLayoutEffect(()=>()=>{e.current={}},[]),e.current}const d$=n=>{const e=En.useRef(null),t=En.useRef(null),r=En.useRef(null),i=h$(n),s=c$(),o=l=>{const{forwardedRef:c}=n;c&&(typeof c=="function"?c(l):c.current=l)};return En.useLayoutEffect(()=>(t.current=new qd.Stage({width:n.width,height:n.height,container:e.current}),o(t.current),r.current=jh.createContainer(t.current,Dx.LegacyRoot,!1,null),jh.updateContainer(En.createElement(s,{},n.children),r.current),()=>{qd.isBrowser&&(o(null),jh.updateContainer(null,r.current,null),t.current.destroy())}),[]),En.useLayoutEffect(()=>{o(t.current),b_(t.current,n,i),jh.updateContainer(En.createElement(s,{},n.children),r.current,null)}),En.createElement("div",{ref:e,id:n.id,accessKey:n.accessKey,className:n.className,role:n.role,style:n.style,tabIndex:n.tabIndex,title:n.title})},Kd="Layer",H5="Group",Vm="Rect",Ux="Circle",M2="Line",Bx="Text",jh=gH(t$);jh.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:En.version,rendererPackageName:"react-konva"});const f$=En.forwardRef((n,e)=>En.createElement(Vx,{},En.createElement(d$,{...n,forwardedRef:e}))),p$={},$5=n=>{let e;const t=new Set,r=(p,m)=>{const _=typeof p=="function"?p(e):p;if(!Object.is(_,e)){const w=e;e=m??(typeof _!="object"||_===null)?_:Object.assign({},e,_),t.forEach(S=>S(e,w))}},i=()=>e,c={setState:r,getState:i,getInitialState:()=>h,subscribe:p=>(t.add(p),()=>t.delete(p)),destroy:()=>{(p$?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},h=e=n(r,i,c);return c},g$=n=>n?$5(n):$5;var zx={exports:{}},jx={},Gx={exports:{}},Wx={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hc=ue;function m$(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var _$=typeof Object.is=="function"?Object.is:m$,y$=hc.useState,v$=hc.useEffect,w$=hc.useLayoutEffect,E$=hc.useDebugValue;function S$(n,e){var t=e(),r=y$({inst:{value:t,getSnapshot:e}}),i=r[0].inst,s=r[1];return w$(function(){i.value=t,i.getSnapshot=e,Lv(i)&&s({inst:i})},[n,t,e]),v$(function(){return Lv(i)&&s({inst:i}),n(function(){Lv(i)&&s({inst:i})})},[n]),E$(t),t}function Lv(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!_$(n,t)}catch{return!0}}function C$(n,e){return e()}var T$=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?C$:S$;Wx.useSyncExternalStore=hc.useSyncExternalStore!==void 0?hc.useSyncExternalStore:T$;Gx.exports=Wx;var I$=Gx.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var D_=ue,P$=I$;function k$(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var R$=typeof Object.is=="function"?Object.is:k$,x$=P$.useSyncExternalStore,A$=D_.useRef,N$=D_.useEffect,b$=D_.useMemo,D$=D_.useDebugValue;jx.useSyncExternalStoreWithSelector=function(n,e,t,r,i){var s=A$(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=b$(function(){function c(w){if(!h){if(h=!0,p=w,w=r(w),i!==void 0&&o.hasValue){var S=o.value;if(i(S,w))return m=S}return m=w}if(S=m,R$(p,w))return S;var k=r(w);return i!==void 0&&i(S,k)?(p=w,S):(p=w,m=k)}var h=!1,p,m,_=t===void 0?null:t;return[function(){return c(e())},_===null?void 0:function(){return c(_())}]},[e,t,r,i]);var l=x$(n,s[0],s[1]);return N$(function(){o.hasValue=!0,o.value=l},[l]),D$(l),l};zx.exports=jx;var M$=zx.exports;const O$=Bm(M$),Hx={},{useDebugValue:L$}=En,{useSyncExternalStoreWithSelector:F$}=O$;let q5=!1;const V$=n=>n;function U$(n,e=V$,t){(Hx?"production":void 0)!=="production"&&t&&!q5&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),q5=!0);const r=F$(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return L$(r),r}const K5=n=>{(Hx?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?g$(n):n,t=(r,i)=>U$(e,r,i);return Object.assign(t,e),t},$x=n=>n?K5(n):K5,Q5=2e3,mr=$x(n=>({shapes:[],optimisticUpdates:new Map,addShape:e=>n(t=>({shapes:[...t.shapes,e]})),updateShape:(e,t)=>n(r=>({shapes:r.shapes.map(i=>i.id===e?{...i,...t}:i)})),updateShapeOptimistic:(e,t)=>n(r=>{const i=new Map(r.optimisticUpdates);i.set(e,{timestamp:Date.now(),updates:t});const s=Date.now();for(const[o,l]of i.entries())s-l.timestamp>Q5&&i.delete(o);return{shapes:r.shapes.map(o=>o.id===e?{...o,...t}:o),optimisticUpdates:i}}),deleteShape:e=>n(t=>({shapes:t.shapes.filter(r=>r.id!==e)})),setShapes:e=>n(t=>{const r=Date.now();return{shapes:e.map(s=>{const o=t.optimisticUpdates.get(s.id);return o&&r-o.timestamp<Q5?{...s,...o.updates}:s})}})})),B$=n=>{const e=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD","#98D8C8","#F7DC6F"];let t=0;for(let r=0;r<n.length;r++)t=n.charCodeAt(r)+((t<<5)-t);return e[Math.abs(t)%e.length]},Qo=$x(n=>({user:null,firebaseUser:null,isAuthenticated:!1,isLoading:!0,error:null,setUser:(e,t)=>n({user:e,firebaseUser:t,isAuthenticated:!!e,error:null}),setLoading:e=>n({isLoading:e}),setError:e=>n({error:e,isLoading:!1}),clearUser:()=>n({user:null,firebaseUser:null,isAuthenticated:!1,isLoading:!1})})),z$=n=>{var t;const e=n.displayName||((t=n.email)==null?void 0:t.split("@")[0])||"Anonymous User";return{uid:n.uid,displayName:e.length>20?e.substring(0,20):e,email:n.email||"",cursorColor:B$(n.uid)}};class j${constructor(){Xn(this,"frameCount",0);Xn(this,"lastTime",performance.now());Xn(this,"fps",0);Xn(this,"isRunning",!1);Xn(this,"animationId");Xn(this,"fpsHistory",[]);Xn(this,"maxHistorySize",60);Xn(this,"firestoreReads",0);Xn(this,"firestoreWrites",0);Xn(this,"rtdbUpdates",0);Xn(this,"lastFirebaseLogTime",performance.now());Xn(this,"animate",()=>{if(!this.isRunning)return;const e=performance.now();if(this.frameCount++,e-this.lastTime>=1e3){if(this.fps=Math.round(this.frameCount*1e3/(e-this.lastTime)),this.frameCount=0,this.lastTime=e,this.fpsHistory.push(this.fps),this.fpsHistory.length>this.maxHistorySize&&this.fpsHistory.shift(),this.updateTitle(),this.fps<30){console.warn(`⚠️ Low FPS detected: ${this.fps} fps`);const t=this.fpsHistory.slice(-5),r=t.reduce((i,s)=>i+s,0)/t.length;r<25&&console.warn(`🔴 Consistently low FPS: ${r.toFixed(1)} fps average`)}e-this.lastFirebaseLogTime>=5e3&&(this.logFirebaseStats(),this.lastFirebaseLogTime=e)}this.animationId=requestAnimationFrame(this.animate)})}start(){this.isRunning||(this.isRunning=!0,this.lastTime=performance.now(),this.frameCount=0,console.log("🚀 Performance monitoring started"),this.animate())}updateTitle(){}logFirebaseStats(){const e=(performance.now()-this.lastFirebaseLogTime)/1e3;console.log(`📊 Firebase Operations (last ${e.toFixed(1)}s):`,{"Firestore Reads":this.firestoreReads,"Firestore Writes":this.firestoreWrites,"Realtime DB Updates":this.rtdbUpdates,"Read Rate":`${(this.firestoreReads/e).toFixed(1)}/s`,"Write Rate":`${(this.firestoreWrites/e).toFixed(1)}/s`,"RTDB Rate":`${(this.rtdbUpdates/e).toFixed(1)}/s`}),this.firestoreReads=0,this.firestoreWrites=0,this.rtdbUpdates=0}logFirestoreRead(e,t=1){}logFirestoreWrite(e,t=1){}logRTDBUpdate(e){}getStats(){const e=this.fpsHistory.length>0?this.fpsHistory.reduce((t,r)=>t+r,0)/this.fpsHistory.length:this.fps;return{currentFps:this.fps,averageFps:Math.round(e*10)/10,minFps:Math.min(...this.fpsHistory),maxFps:Math.max(...this.fpsHistory),firestoreReads:this.firestoreReads,firestoreWrites:this.firestoreWrites,rtdbUpdates:this.rtdbUpdates}}stop(){this.isRunning=!1,this.animationId&&cancelAnimationFrame(this.animationId),document.title="CollabCanvas",console.log("🛑 Performance monitoring stopped")}}const kS=new j$,G$=(n,e)=>kS.logFirestoreRead(n,e),RS=(n,e)=>kS.logFirestoreWrite(n,e),xS=n=>kS.logRTDBUpdate(n);class Dc{static async withRetry(e,t={}){const r={...this.DEFAULT_RETRY_OPTIONS,...t};let i;for(let s=0;s<=r.maxRetries;s++)try{return await e()}catch(o){if(i=o,this.isNonRetryableError(o))throw o;if(s<r.maxRetries){const l=Math.min(r.initialDelayMs*Math.pow(r.backoffMultiplier,s),r.maxDelayMs);console.log(`Operation failed (attempt ${s+1}/${r.maxRetries+1}), retrying in ${l}ms...`),await this.delay(l)}}throw i}static isNonRetryableError(e){const t=e==null?void 0:e.code;return["auth/invalid-user-token","auth/user-disabled","permission-denied","invalid-argument"].includes(t)}static delay(e){return new Promise(t=>setTimeout(t,e))}}Xn(Dc,"DEFAULT_RETRY_OPTIONS",{maxRetries:3,initialDelayMs:1e3,maxDelayMs:1e4,backoffMultiplier:2});const W$=async n=>Dc.withRetry(async()=>{xS("initializePresence"),console.log(`🟢 Initializing presence for ${n.displayName}`);const e=_a(ya,`/sessions/global-canvas-v1/${n.uid}`),t={userId:n.uid,displayName:n.displayName||"Anonymous",email:n.email||"",cursorColor:n.cursorColor,cursorX:300,cursorY:200,lastSeen:bm(),isOnline:!0,currentlyEditing:null};await $9(e,t),await YB(e).update({isOnline:!1,lastSeen:bm(),currentlyEditing:null}),console.log(`✅ Presence initialized for ${n.displayName}`)},{maxRetries:3}),Y5=async(n,e,t,r=null)=>{try{xS("updateCursorPosition");const i=_a(ya,`/sessions/global-canvas-v1/${n}`),s={cursorX:e,cursorY:t,lastSeen:bm(),isOnline:!0};r!==void 0&&(s.currentlyEditing=r),await q9(i,s)}catch(i){console.error("❌ Failed to update cursor position:",i)}},AS=async(n,e)=>{xS("updateCurrentlyEditing");try{const t=_a(ya,`/sessions/global-canvas-v1/${n}/currentlyEditing`);await $9(t,e),console.log(`📝 User ${n} now editing: ${e||"nothing"}`)}catch(t){console.error("❌ Failed to update currently editing:",t)}},H$=n=>{console.log("🔄 Subscribing to presence updates...");const e=_a(ya,"/sessions/global-canvas-v1"),t=B0(e,r=>{const i=r.val()||{};console.log("📡 Presence update received:",Object.keys(i).length,"users"),n(i)},r=>{console.error("❌ Presence subscription error:",r)});return()=>{console.log("🔄 Unsubscribing from presence updates"),t()}},$$=async n=>Dc.withRetry(async()=>{const e=_a(ya,`/sessions/global-canvas-v1/${n}`);await q9(e,{isOnline:!1,lastSeen:bm(),currentlyEditing:null}),console.log(`🔴 Presence cleaned up for user: ${n}`)},{maxRetries:2}),q$=n=>{const e=ue.useRef(0),t=ue.useRef({x:300,y:200}),r=ue.useRef(null),i=ue.useRef(null),s=ue.useRef(!1);ue.useEffect(()=>{n&&!s.current&&(Y5(n.uid,300,200),s.current=!0)},[n]);const o=ue.useCallback((c,h)=>{if(!n)return;const p=Date.now(),m=t.current;if(Math.sqrt(Math.pow(c-m.x,2)+Math.pow(h-m.y,2))<5&&p-e.current<1e3)return;r.current&&(clearTimeout(r.current),r.current=null),i.current&&(clearTimeout(i.current),i.current=null);const w=p-e.current;w>=50?(l(n,c,h),e.current=p,t.current={x:c,y:h}):r.current=setTimeout(()=>{l(n,c,h),e.current=Date.now(),t.current={x:c,y:h}},50-w),i.current=setTimeout(()=>{},2e3)},[n]),l=ue.useCallback((c,h,p)=>{Y5(c.uid,h,p)},[]);return{updateCursor:o}},K$=(n,e)=>{if(!e.current)return null;const t=e.current,r=t.container();if(!r)return null;const i=r.getBoundingClientRect(),s=n.clientX-i.left,o=n.clientY-i.top,c=t.getAbsoluteTransform().copy().invert().point({x:s,y:o});return{x:Math.round(c.x),y:Math.round(c.y)}},Q$=(n,e)=>{const t=ue.useRef({x:0,y:0,time:0}),r=ue.useCallback(h=>{h.evt.preventDefault(),h.evt.stopPropagation();const p=n.current;if(!p)return;e==null||e(!0);const{deltaX:m,deltaY:_,ctrlKey:w,metaKey:S}=h.evt,k=Math.abs(_)<50;w||S?i(h,p,_):k&&(Math.abs(m)>0||Math.abs(_)>0)?s(p,m,_):i(h,p,_),setTimeout(()=>e==null?void 0:e(!1),50)},[n,e]),i=ue.useCallback((h,p,m)=>{const _=p.getPointerPosition();if(!_)return;const w=p.scaleX(),S=1+Math.abs(m)*.02,k=m>0?w/S:w*S,N=Math.max(.01,Math.min(100,k)),x={x:(_.x-p.x())/w,y:(_.y-p.y())/w};p.scale({x:N,y:N});const R={x:_.x-x.x*N,y:_.y-x.y*N},E=o(R,p,N);p.position(E)},[]),s=ue.useCallback((h,p,m)=>{const _=h.position(),w=Date.now(),S={x:_.x-p,y:_.y-m},k=h.scaleX(),N=o(S,h,k);h.position(N),t.current={x:p,y:m,time:w}},[]),o=ue.useCallback((h,p,m)=>{const _=p.width(),w=p.height(),S=5e3*m,k=5e3*m,N=Math.min(_,w)*.1;return{x:Math.max(_-S-N,Math.min(N,h.x)),y:Math.max(w-k-N,Math.min(N,h.y))}},[]),l=ue.useCallback(h=>{},[]),c=ue.useCallback(h=>{h.evt.preventDefault()},[]);return{handleWheel:r,handleTouchStart:l,handleTouchMove:c}};var Ln=[];for(var Fv=0;Fv<256;++Fv)Ln.push((Fv+256).toString(16).slice(1));function Y$(n,e=0){return(Ln[n[e+0]]+Ln[n[e+1]]+Ln[n[e+2]]+Ln[n[e+3]]+"-"+Ln[n[e+4]]+Ln[n[e+5]]+"-"+Ln[n[e+6]]+Ln[n[e+7]]+"-"+Ln[n[e+8]]+Ln[n[e+9]]+"-"+Ln[n[e+10]]+Ln[n[e+11]]+Ln[n[e+12]]+Ln[n[e+13]]+Ln[n[e+14]]+Ln[n[e+15]]).toLowerCase()}var rg,X$=new Uint8Array(16);function J$(){if(!rg&&(rg=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!rg))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return rg(X$)}var Z$=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const X5={randomUUID:Z$};function eq(n,e,t){if(X5.randomUUID&&!n)return X5.randomUUID();n=n||{};var r=n.random||(n.rng||J$)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Y$(r)}const M_="canvas/global-canvas-v1/shapes",tq=async(n,e,t,r,i,s)=>Dc.withRetry(async()=>{RS("createShape");const o=eq(),l=ff(sr,M_),c={type:t,x:n,y:e,width:100,height:100,fill:r,text:"",textColor:"#000000",fontSize:14,createdBy:i,createdAt:tc(),lastModifiedBy:i,lastModifiedAt:tc(),isLocked:!1,lockedBy:null};return await zF(ga(l,o),c),console.log(`🎯 Shape created by ${s}:`,o),o},{maxRetries:2}),nq=(n,e)=>{try{const t=ff(sr,M_),r=NR(t,VF("createdAt","asc"));return jF(r,s=>{G$("subscribeToShapes",s.size);const o=[];s.forEach(l=>{l.exists()&&o.push({id:l.id,...l.data()})}),console.log(`🔄 Shapes synced: ${o.length} total`),n(o)},s=>{console.error("Error subscribing to shapes:",s),e==null||e(s)})}catch(t){throw console.error("Error setting up shapes subscription:",t),t}},qx=async(n,e,t)=>Dc.withRetry(async()=>{RS("updateShape");const r=ga(sr,M_,n),i={...e,lastModifiedBy:t,lastModifiedAt:tc()};await LR(r,i),console.log("📝 Shape updated:",n)},{maxRetries:2}),rq=async n=>Dc.withRetry(async()=>{RS("deleteShape");const e=ga(sr,M_,n);await FR(e),console.log("🗑️ Shape deleted:",n)},{maxRetries:2}),iq=()=>{const{setShapes:n}=mr();ue.useEffect(()=>{console.log("🔄 Setting up shape sync...");const e=nq(t=>{n(t),console.log(`📦 Loaded ${t.length} shapes from Firestore:`),t.forEach(r=>{console.log(`   Shape ${r.id}: (${r.x}, ${r.y}) locked: ${r.isLocked}`)})},t=>{console.error("❌ Shape sync error:",t)});return()=>{console.log("🔄 Cleaning up shape sync..."),e==null||e()}},[n])},Um="canvas/global-canvas-v1/shapes",J5=async(n,e,t,r)=>{try{const i=ga(sr,Um,n);return await RE(sr,async o=>{const l=await o.get(i);if(!l.exists())throw new Error("Shape not found");const c=l.data();return c.isLocked&&c.lockedBy!==e?{success:!1,alreadyLocked:!0,lockedBy:c.lockedBy}:(o.update(i,{isLocked:!0,lockedBy:e,lockedByName:t,lockedByColor:r,lastModifiedBy:e,lastModifiedAt:tc()}),console.log(`🔒 Lock acquired by ${t} for shape:`,n),setTimeout(()=>{AS(e,n).catch(h=>{console.warn("Failed to update currently editing status:",h)})},0),{success:!0})})}catch(i){return console.error("Error acquiring lock:",i),{success:!1,error:i instanceof Error?i.message:"Unknown error"}}},O2=async(n,e,t,r)=>{try{const i=ga(sr,Um,n);return await RE(sr,async o=>{const l=await o.get(i);if(!l.exists())throw new Error("Shape not found");if(l.data().lockedBy!==e)return console.warn("Cannot release lock not owned by user"),{success:!1,error:"Lock not owned by user"};const h={isLocked:!1,lockedBy:null,lockedByName:null,lockedByColor:null,lastModifiedBy:e,lastModifiedAt:tc()};return o.update(i,h),console.log(`🔓 Lock released by ${t} for shape:`,n,r?`with position (${r.x}, ${r.y})`:"without position update"),setTimeout(()=>{AS(e,null).catch(p=>{console.warn("Failed to clear currently editing status:",p)})},0),{success:!0}})}catch(i){return console.error("Error releasing lock:",i),{success:!1,error:i instanceof Error?i.message:"Unknown error"}}},sq=async n=>{try{console.log(`🧹 Force releasing all locks for user: ${n}`);const e=ff(sr,Um),t=NR(e,FF("lockedBy","==",n)),r=await PE(t),i=r.docs.map(async s=>{const o=ga(sr,Um,s.id);return RE(sr,async l=>{const c=await l.get(o);c.exists()&&c.data().lockedBy===n&&(l.update(o,{isLocked:!1,lockedBy:null,lastModifiedAt:tc()}),console.log(`🔓 Force unlocked shape: ${s.id}`),AS(n,null).catch(h=>{console.warn("Failed to clear currently editing status on force unlock:",h)}))})});await Promise.all(i),console.log(`✅ Released ${r.docs.length} locks for user: ${n}`)}catch(e){console.error("Error force releasing user locks:",e)}},oq=()=>{ue.useEffect(()=>{console.log("🔄 Starting presence monitoring for lock cleanup");const n=_a(ya,"/sessions/global-canvas-v1"),t=B0(n,r=>{if(!r.exists())return;const i=r.val();Object.entries(i).forEach(([s,o])=>{const l=o;!l.isOnline&&l.lastSeen&&typeof l.lastSeen=="number"&&Date.now()-l.lastSeen>5e3&&(console.log(`👻 Detected offline user: ${l.displayName}, cleaning up locks`),sq(s).catch(h=>{console.error("Failed to cleanup locks for offline user:",h)}))})},r=>{console.error("❌ Presence monitoring error:",r)});return()=>{console.log("🔄 Stopping presence monitoring"),t()}},[])},aq=({width:n,height:e,listening:t})=>{const i=[];for(let o=0;o<=n/50;o++){const l=o*50;i.push(z.jsx(M2,{points:[l,0,l,e],stroke:"#f0f0f0",strokeWidth:.5,listening:!1},`v-${o}`))}const s=[];for(let o=0;o<=e/50;o++){const l=o*50;s.push(z.jsx(M2,{points:[0,l,n,l],stroke:"#f0f0f0",strokeWidth:.5,listening:!1},`h-${o}`))}return z.jsxs(Kd,{listening:t,children:[z.jsx(Vm,{x:0,y:0,width:n,height:e,fill:"white",listening:!1}),i,s,z.jsx(Vm,{x:0,y:0,width:n,height:e,stroke:"#cccccc",strokeWidth:2,fill:"transparent",listening:!1})]})},lq=En.memo(({shape:n})=>{const{shapes:e}=mr(),{user:t}=Qo(),r=n.isLocked&&n.lockedBy===(t==null?void 0:t.uid),i=n.isLocked&&n.lockedBy!==(t==null?void 0:t.uid),s=!i&&!!t,o=ue.useCallback(async()=>{if(!i&&t){if(r){console.log(`🔒 [${t.displayName}] Shape ${n.id.slice(-4)} already selected - no action needed`);return}const{updateShapeOptimistic:m}=mr.getState(),_=e.filter(w=>w.lockedBy===t.uid&&w.id!==n.id);console.log(`🎯 [${t.displayName}] Selecting shape ${n.id.slice(-4)}, releasing ${_.length} previous selections`),_.forEach(w=>{console.log(`🔓 [${t.displayName}] Releasing shape ${w.id.slice(-4)}`),m(w.id,{isLocked:!1,lockedBy:null,lockedByName:null,lockedByColor:null})}),console.log(`🔒 [${t.displayName}] Locking shape ${n.id.slice(-4)}`),m(n.id,{isLocked:!0,lockedBy:t.uid,lockedByName:t.displayName,lockedByColor:t.cursorColor}),_.length>0&&Promise.all(_.map(w=>O2(w.id,t.uid,t.displayName))),J5(n.id,t.uid,t.displayName,t.cursorColor)}},[n.id,r,i,t,e]),l=ue.useCallback(()=>{if(!r&&t){const{updateShapeOptimistic:m}=mr.getState(),_=e.filter(w=>w.lockedBy===t.uid&&w.id!==n.id);console.log(`🖱️ [${t.displayName}] Drag start on ${n.id.slice(-4)}, releasing ${_.length} other selections`),_.forEach(w=>{console.log(`🔓 [${t.displayName}] Drag-releasing shape ${w.id.slice(-4)}`),m(w.id,{isLocked:!1,lockedBy:null,lockedByName:null,lockedByColor:null}),O2(w.id,t.uid,t.displayName)}),m(n.id,{isLocked:!0,lockedBy:t.uid,lockedByName:t.displayName,lockedByColor:t.cursorColor}),J5(n.id,t.uid,t.displayName,t.cursorColor)}},[n.id,r,t,e]),c=ue.useCallback(m=>{let _=Math.round(m.target.x()),w=Math.round(m.target.y());if(n.type==="circle"&&(_=_-n.width/2,w=w-n.height/2),t){const{updateShapeOptimistic:S}=mr.getState();S(n.id,{x:_,y:w}),qx(n.id,{x:_,y:w},t.uid)}},[n.id,n.type,n.width,n.height,t]),h=ue.useCallback(m=>{const w=Math.round(m.x/1)*1,S=Math.round(m.y/1)*1;if(n.type==="circle"){const k=Math.min(n.width,n.height)/2;return{x:Math.max(k,Math.min(5e3-k,w)),y:Math.max(k,Math.min(5e3-k,S))}}return{x:Math.max(0,Math.min(4900,w)),y:Math.max(0,Math.min(4900,S))}},[n.type,n.width,n.height]),p=()=>{const m=r?(t==null?void 0:t.cursorColor)||"#0066ff":i?n.lockedByColor||"#ff6b6b":"transparent",_=r||i?2:0,w={fill:n.fill,stroke:m,strokeWidth:_,draggable:s,dragBoundFunc:s?h:void 0,onClick:o,onDragStart:l,onDragEnd:c};return n.type==="circle"?z.jsx(Ux,{x:n.x+n.width/2,y:n.y+n.height/2,radius:Math.min(n.width,n.height)/2,...w}):z.jsx(Vm,{x:n.x,y:n.y,width:n.width,height:n.height,...w})};return z.jsxs(z.Fragment,{children:[p(),n.text&&z.jsx(Bx,{x:n.x,y:n.y+n.height/2-7,width:n.width,text:n.text,fontSize:n.fontSize,fill:n.textColor,align:"center",verticalAlign:"middle",listening:!1})]})}),uq=({listening:n})=>{const{shapes:e}=mr();return z.jsx(Kd,{listening:n,children:e.map(t=>z.jsx(lq,{shape:t},t.id))})},cq=({listening:n})=>z.jsx(Kd,{listening:n}),hq=()=>{const{user:n}=Qo(),[e,t]=ue.useState({});ue.useEffect(()=>{if(!n)return;const i=_a(ya,"/sessions/global-canvas-v1"),s=B0(i,o=>{const l=o.val()||{},c={};Object.entries(l).forEach(([h,p])=>{p.isOnline&&p.cursorX!==void 0&&p.cursorY!==void 0&&(c[h]={x:p.cursorX,y:p.cursorY,name:p.displayName||"Anonymous",color:p.cursorColor||"#666"})}),t(c)},{onlyOnce:!1});return()=>s()},[n==null?void 0:n.uid]);const r=Object.entries(e);return r.length===0?z.jsx(Kd,{listening:!1}):z.jsx(Kd,{listening:!1,children:r.map(([i,s])=>z.jsx(dq,{cursor:s,isCurrentUser:i===(n==null?void 0:n.uid)},i))})},dq=({cursor:n,isCurrentUser:e=!1})=>{const{x:t,y:r,name:i,color:s}=n,o=[0,0,0,14,4,10,6,16,8,15,6,9,10,9];return z.jsxs(H5,{x:t,y:r,children:[e?z.jsx(M2,{points:o,fill:s,stroke:"white",strokeWidth:1,closed:!0}):z.jsx(Ux,{radius:6,fill:s,stroke:"white",strokeWidth:2}),z.jsxs(H5,{x:e?16:12,y:-8,children:[z.jsx(Vm,{width:i.length*6+6,height:16,fill:s,cornerRadius:2}),z.jsx(Bx,{text:i,fontSize:11,fontFamily:"Arial",fill:"white",x:3,y:2})]})]})},fq=[{name:"Grey",value:"#CCCCCC",shortcut:"4"},{name:"Red",value:"#ef4444",shortcut:"1"},{name:"Green",value:"#22c55e",shortcut:"2"},{name:"Blue",value:"#3b82f6",shortcut:"3"}],pq=({currentShapeType:n,onShapeTypeChange:e,currentColor:t,onColorChange:r})=>z.jsxs("div",{className:"absolute top-4 left-4 z-10 bg-white rounded-lg shadow-lg border border-gray-200 p-3",children:[z.jsx("div",{className:"flex gap-2 mb-3",children:z.jsx("div",{className:"text-xs text-gray-500 font-medium mb-1 w-full",children:"Shape"})}),z.jsxs("div",{className:"flex gap-2 mb-4",children:[z.jsx("button",{onClick:()=>e("rectangle"),className:`
            w-12 h-12 rounded-lg border-2 flex items-center justify-center transition-all duration-200
            ${n==="rectangle"?"border-blue-500 bg-blue-50 text-blue-600":"border-gray-300 bg-white text-gray-600 hover:border-gray-400 hover:bg-gray-50"}
          `,title:"Rectangle (R)",children:z.jsx("div",{className:"w-6 h-4 border-2 border-current rounded-sm"})}),z.jsx("button",{onClick:()=>e("circle"),className:`
            w-12 h-12 rounded-lg border-2 flex items-center justify-center transition-all duration-200
            ${n==="circle"?"border-blue-500 bg-blue-50 text-blue-600":"border-gray-300 bg-white text-gray-600 hover:border-gray-400 hover:bg-gray-50"}
          `,title:"Circle (C)",children:z.jsx("div",{className:"w-6 h-6 border-2 border-current rounded-full"})})]}),z.jsxs("div",{className:"border-t border-gray-200 pt-3",children:[z.jsx("div",{className:"text-xs text-gray-500 font-medium mb-2",children:"Color"}),z.jsx("div",{className:"flex gap-2",children:fq.map(i=>z.jsx("button",{onClick:()=>r(i.value),className:`
                w-8 h-8 rounded-lg border-2 transition-all duration-200 relative
                ${t===i.value?"border-gray-800 scale-110":"border-gray-300 hover:border-gray-400"}
              `,style:{backgroundColor:i.value},title:`${i.name} (${i.shortcut})`,children:t===i.value&&z.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:z.jsx("svg",{className:"w-4 h-4 text-white drop-shadow-sm",fill:"currentColor",viewBox:"0 0 20 20",children:z.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})},i.value))})]})]}),Vv=5e3,Uv=5e3,gq=({width:n,height:e})=>{const t=ue.useRef(null),[r,i]=ue.useState(!1),[s,o]=ue.useState(!1),{user:l}=Qo(),{updateCursor:c}=q$(l),{handleWheel:h,handleTouchStart:p,handleTouchMove:m}=Q$(t,o);iq(),oq();const _=ue.useCallback(async()=>{if(!l)return;const{shapes:$,deleteShape:J}=mr.getState(),ee=$.find(Z=>Z.lockedBy===l.uid);if(!ee){console.log("No shape selected for deletion");return}J(ee.id),console.log(`⚡ Instantly deleted: ${ee.id}`);try{await rq(ee.id),console.log(`🗑️ Deletion synced to Firestore: ${ee.id}`)}catch(Z){console.error("Deletion sync failed:",Z);const{addShape:ie}=mr.getState();ie(ee),console.log(`🔄 Restored shape after sync failure: ${ee.id}`)}},[l]);ue.useEffect(()=>{const $=Z=>{if((Z.key==="Delete"||Z.key==="Backspace")&&!Z.repeat){Z.preventDefault(),_();return}if(Z.code==="Space"&&!Z.repeat&&!r){Z.preventDefault(),Z.stopPropagation(),i(!0),document.body.style.overflow="hidden";const ie=t.current;ie&&(ie.find("Rect").forEach(_e=>_e.draggable(!1)),ie.draggable(!0)),console.log("⌨️ Space pressed - panning mode enabled")}},J=Z=>{if(Z.code==="Space"){Z.preventDefault(),Z.stopPropagation(),i(!1),document.body.style.overflow="auto";const ie=t.current;ie&&(ie.draggable(!1),ie.find("Rect").forEach(_e=>{const Tt=_e.id(),{shapes:dt}=mr.getState(),Ve=dt.find(te=>te.id===Tt),j=(Ve==null?void 0:Ve.isLocked)&&(Ve==null?void 0:Ve.lockedBy)!==(l==null?void 0:l.uid);_e.draggable(!j&&!!l)})),console.log("⌨️ Space released - panning mode disabled")}},ee=()=>{i(!1),document.body.style.overflow="auto";const Z=t.current;Z&&Z.draggable(!1),console.log("🪟 Window blur - reset panning state")};return window.addEventListener("keydown",$),window.addEventListener("keyup",J),window.addEventListener("blur",ee),()=>{document.body.style.overflow="auto",ce.current&&clearTimeout(ce.current),window.removeEventListener("keydown",$),window.removeEventListener("keyup",J),window.removeEventListener("blur",ee)}},[r,l,_]);const w=ue.useCallback($=>{const J=n-Vv,ee=e-Uv;return{x:Math.max(J,Math.min(0,$.x)),y:Math.max(ee,Math.min(0,$.y))}},[n,e]),[S,k]=ue.useState("rectangle"),[N,x]=ue.useState("#CCCCCC"),[R,E]=ue.useState(!1),[P,V]=ue.useState(null),[B,D]=ue.useState("rectangle"),[T,b]=ue.useState("#CCCCCC"),A=ue.useCallback($=>{console.log(`🔲 Shape button clicked: ${$}`),E(!0),k($),P||(D($),console.log(`🎯 Saved creation preference - shape: ${$}`)),console.log(`🔲 Shape mode updated to: ${$}`),setTimeout(()=>{E(!1),console.log(`✅ Shape creation ready for: ${$}`)},100)},[P]),O=ue.useCallback($=>{if(console.log(`🎨 [${l==null?void 0:l.displayName}] Color button clicked: ${$}`),E(!0),x($),P||(b($),console.log(`🎯 Saved creation preference - color: ${$}`)),console.log(`🎨 [${l==null?void 0:l.displayName}] My color mode updated to: ${$}`),l){const{shapes:J,updateShapeOptimistic:ee}=mr.getState();console.log(`🔍 [${l.displayName}] Total shapes: ${J.length}`),console.log(`🔍 [${l.displayName}] My UID: ${l.uid}`);const Z=J.filter(ie=>{var Tt;const _e=ie.lockedBy===l.uid;return console.log(`🔍 Shape ${ie.id.slice(-4)}: lockedBy=${(Tt=ie.lockedBy)==null?void 0:Tt.slice(-4)}, isMyShape=${_e}`),_e});console.log(`🔍 [${l.displayName}] Found ${Z.length} of MY selected shapes`),Z.length>0?(console.log(`🎨 [${l.displayName}] Updating MY ${Z.length} selected shapes to ${$}`),Z.forEach(ie=>{var _e;console.log(`🎨 [${l.displayName}] Changing MY shape ${ie.id.slice(-4)} to ${$}`),console.log(`🔒 [${l.displayName}] Shape ${ie.id.slice(-4)} locked by: ${(_e=ie.lockedBy)==null?void 0:_e.slice(-4)} (should be ${l.uid.slice(-4)})`),ee(ie.id,{fill:$,isLocked:!0,lockedBy:l.uid,lockedByName:l.displayName,lockedByColor:l.cursorColor})}),Promise.all(Z.map(ie=>(console.log(`🔥 [${l.displayName}] Firebase update for MY shape ${ie.id.slice(-4)}`),qx(ie.id,{fill:$},l.uid))))):console.log(`ℹ️ [${l.displayName}] No shapes selected by me - only updating my picker`)}setTimeout(()=>{E(!1),console.log(`✅ [${l==null?void 0:l.displayName}] Color creation ready for: ${$}`)},100)},[l,P]),{shapes:U}=mr();ue.useEffect(()=>{if(l){const $=U.filter(J=>J.lockedBy===l.uid);if($.length===1){const J=$[0];J.id!==P&&(V(J.id),J.fill!==N&&(x(J.fill),console.log(`🎯 I selected shape - My color picker updated to: ${J.fill}`)),J.type!==S&&(k(J.type),console.log(`🎯 I selected shape - My shape picker updated to: ${J.type}`)))}else $.length===0&&P&&(V(null),N!==T&&(x(T),console.log(`🔄 I deselected - My color picker reset to my preference: ${T}`)),S!==B&&(k(B),console.log(`🔄 I deselected - My shape picker reset to my preference: ${B}`)))}},[U,l,N,S,P,T,B]),ue.useEffect(()=>{const $=J=>{if(!(J.target instanceof HTMLInputElement||J.target instanceof HTMLTextAreaElement))switch(J.key.toLowerCase()){case"r":k("rectangle");break;case"c":k("circle");break;case"1":O("#ef4444");break;case"2":O("#22c55e");break;case"3":O("#3b82f6");break;case"4":O("#CCCCCC");break}};return window.addEventListener("keydown",$),()=>window.removeEventListener("keydown",$)},[O]);const F=ue.useRef(0),ce=ue.useRef(null),le=ue.useRef(new Set),Me=ue.useCallback(async $=>{if($.target!==t.current||r||!l)return;if(R){console.log("⏳ Waiting for state to settle before creating shape...");return}const{shapes:J,addShape:ee,updateShapeOptimistic:Z}=mr.getState(),ie=J.filter(De=>De.lockedBy===l.uid);if(ie.length>0){ie.forEach(De=>{Z(De.id,{isLocked:!1,lockedBy:null,lockedByName:null,lockedByColor:null})}),Promise.all(ie.map(De=>O2(De.id,l.uid,l.displayName))),console.log(`🔓 Deselected ${ie.length} shapes (no creation)`);return}const _e=Date.now();if(_e-F.current<100)return;F.current=_e,console.log(`🎯 Creating ${S} with color ${N}`);const dt=t.current.getRelativePointerPosition(),Ve=`temp-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,j=Math.max(0,Math.min(Vv-100,dt.x)),te=Math.max(0,Math.min(Uv-100,dt.y)),ve={id:Ve,type:S,x:j,y:te,width:100,height:100,fill:N,text:"",textColor:"#000000",fontSize:14,createdBy:l.uid,createdAt:new Date,lastModifiedBy:l.uid,lastModifiedAt:new Date,isLocked:!1,lockedBy:null,lockedByName:null,lockedByColor:null};ee(ve),le.current.add(Ve),console.log(`🚀 Created shape instantly: ${Ve} at (${j}, ${te})`),ce.current&&clearTimeout(ce.current),ce.current=setTimeout(async()=>{const De=Array.from(le.current);le.current.clear();const Ce=De.map(async Qe=>{const Kt=mr.getState().shapes.find(Ge=>Ge.id===Qe);if(Kt)try{const Ge=await tq(Kt.x,Kt.y,Kt.type,Kt.fill,l.uid,l.displayName),{updateShapeOptimistic:ur}=mr.getState();ur(Qe,{id:Ge})}catch(Ge){console.error(`Failed to sync shape ${Qe}:`,Ge);const{deleteShape:ur}=mr.getState();ur(Qe)}});await Promise.allSettled(Ce)},50)},[r,l,R]),be=ue.useCallback($=>{if(s||r)return;const J=K$($.evt,t);J&&l&&c(J.x,J.y)},[c,l,s,r]);return z.jsxs("div",{className:`relative overflow-hidden bg-white border border-gray-300 rounded-lg shadow-sm ${r?"cursor-grab":"cursor-default"}`,onWheel:$=>$.preventDefault(),onTouchMove:$=>$.preventDefault(),style:{touchAction:"none"},children:[z.jsx(pq,{currentShapeType:S,onShapeTypeChange:A,currentColor:N,onColorChange:O}),!1,z.jsxs(f$,{ref:t,width:n,height:e,draggable:!1,dragBoundFunc:r?w:void 0,onWheel:h,onTouchStart:p,onTouchMove:m,onClick:Me,onTap:Me,onMouseMove:be,children:[z.jsx(aq,{width:Vv,height:Uv,listening:!1}),z.jsx(uq,{listening:!r}),z.jsx(cq,{listening:!1}),z.jsx(hq,{})]}),z.jsxs("div",{className:"absolute top-2 right-2 text-xs text-gray-500 bg-white px-2 py-1 rounded shadow",children:["Scale: ",t.current?(t.current.scaleX()*100).toFixed(0):"100","%"]}),r&&z.jsx("div",{className:"absolute bottom-2 left-2 text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded shadow",children:"Space + Drag to Pan"})]})},mq=async()=>{try{console.log("🧹 Clearing all locks...");const n=ff(sr,"canvas/global-canvas-v1/shapes"),e=await PE(n),t=e.docs.map(async r=>{const i=ga(sr,"canvas/global-canvas-v1/shapes",r.id);await LR(i,{isLocked:!1,lockedBy:null}),console.log(`🔓 Cleared lock for shape: ${r.id}`)});return await Promise.all(t),console.log(`✅ Cleared ${e.docs.length} locks successfully!`),{success:!0,clearedCount:e.docs.length}}catch(n){return console.error("❌ Error clearing locks:",n),{success:!1,error:n}}},_q=async()=>{try{console.log("🗑️ Clearing all shapes...");const n=ff(sr,"canvas/global-canvas-v1/shapes"),e=await PE(n),t=e.docs.map(async r=>{const i=ga(sr,"canvas/global-canvas-v1/shapes",r.id);await FR(i),console.log(`🗑️ Deleted shape: ${r.id}`)});return await Promise.all(t),console.log(`✅ Deleted ${e.docs.length} shapes successfully!`),{success:!0,deletedCount:e.docs.length}}catch(n){return console.error("❌ Error clearing shapes:",n),{success:!1,error:n}}},yq=()=>{const{user:n,isAuthenticated:e}=Qo(),[t,r]=ue.useState(!1),[i,s]=ue.useState(!1),o=async()=>{try{await AD(ac)}catch(h){console.error("Error signing out:",h)}},l=async()=>{if(confirm("⚠️ This will delete ALL shapes permanently. Are you sure?")){s(!0);try{const h=await _q();h.success?alert(`✅ Successfully deleted ${h.deletedCount} shapes!`):alert(`❌ Failed to clear shapes: ${h.error}`)}catch(h){alert(`❌ Error: ${h}`)}s(!1),r(!1)}},c=async()=>{s(!0);try{const h=await mq();h.success?alert(`✅ Successfully cleared ${h.clearedCount} locks!`):alert(`❌ Failed to clear locks: ${h.error}`)}catch(h){alert(`❌ Error: ${h}`)}s(!1),r(!1)};return e?z.jsxs("header",{className:"bg-white border-b border-gray-200 px-4 py-3 flex justify-between items-center",children:[z.jsxs("div",{className:"flex items-center space-x-4",children:[z.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:"CollabCanvas"}),z.jsx("div",{className:"text-sm text-gray-500",children:"Real-Time Collaborative Design Tool"})]}),z.jsxs("div",{className:"flex items-center space-x-4",children:[z.jsxs("div",{className:"flex items-center space-x-2",children:[z.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:n==null?void 0:n.cursorColor}}),z.jsx("span",{className:"text-sm font-medium text-gray-700",children:n==null?void 0:n.displayName})]}),z.jsxs("div",{className:"relative",children:[z.jsx("button",{onClick:()=>r(!t),className:"text-xs text-gray-400 hover:text-red-600 px-2 py-1 rounded border border-gray-200 hover:border-red-300",title:"Admin Panel",children:"🛠️"}),t&&z.jsxs("div",{className:"absolute right-0 top-8 bg-white border border-gray-300 rounded shadow-lg p-3 z-50 min-w-[200px]",children:[z.jsx("div",{className:"text-xs font-medium text-gray-600 mb-2",children:"Admin Panel"}),z.jsx("button",{onClick:c,disabled:i,className:"w-full text-left text-xs text-blue-600 hover:text-blue-800 px-2 py-1 rounded hover:bg-blue-50 disabled:opacity-50",children:"🔓 Clear All Locks"}),z.jsx("button",{onClick:l,disabled:i,className:"w-full text-left text-xs text-red-600 hover:text-red-800 px-2 py-1 rounded hover:bg-red-50 disabled:opacity-50",children:"🗑️ Delete All Shapes"}),i&&z.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"Working..."})]})]}),z.jsx("button",{onClick:o,className:"text-sm text-gray-500 hover:text-gray-700 px-3 py-1 rounded border border-gray-300 hover:border-gray-400",children:"Sign Out"})]})]}):null},vq=()=>{const{setUser:n,setLoading:e,setError:t,clearUser:r}=Qo();return ue.useEffect(()=>{const i=xD(ac,async s=>{try{if(s){const o=z$(s);n(o,s),console.log("🔥 User authenticated:",o.displayName),await W$(o)}else{const{user:o}=Qo.getState();o&&await $$(o.uid),r(),console.log("🔥 User signed out")}}catch(o){console.error("Auth state change error:",o),t("Authentication error occurred")}finally{e(!1)}},s=>{console.error("Auth state observer error:",s),t("Failed to initialize authentication"),e(!1)});return()=>i()},[n,e,t,r]),Qo()},wq=({children:n,fallback:e})=>{const{isAuthenticated:t,isLoading:r,error:i}=vq();return r?z.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:z.jsx("div",{className:"bg-white rounded-lg shadow-md p-8",children:z.jsxs("div",{className:"text-center",children:[z.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),z.jsx("p",{className:"text-gray-600",children:"Checking authentication..."})]})})}):i?z.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:z.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 max-w-md",children:[z.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Authentication Error"}),z.jsx("p",{className:"text-gray-700 mb-4",children:"Firebase authentication error:"}),z.jsx("p",{className:"text-sm text-red-600 bg-red-50 p-3 rounded mb-4",children:i}),z.jsx("button",{onClick:()=>window.location.reload(),className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700",children:"Reload Page"})]})}):t?z.jsx(z.Fragment,{children:n}):z.jsx(z.Fragment,{children:e})};class Z5 extends ue.Component{constructor(t){super(t);Xn(this,"handleReload",()=>{window.location.reload()});Xn(this,"handleRetry",()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0})});this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){console.error("🚨 React Error Boundary caught an error:",t),console.error("Error Info:",r),this.setState({error:t,errorInfo:r})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:z.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center px-4",children:z.jsx("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6",children:z.jsxs("div",{className:"text-center",children:[z.jsx("div",{className:"text-6xl mb-4",children:"🚨"}),z.jsx("h1",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Something went wrong"}),z.jsx("p",{className:"text-gray-600 mb-6",children:"The canvas encountered an unexpected error. This shouldn't happen often."}),z.jsxs("div",{className:"space-y-3",children:[z.jsx("button",{onClick:this.handleRetry,className:"w-full bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors",children:"Try Again"}),z.jsx("button",{onClick:this.handleReload,className:"w-full bg-gray-200 text-gray-900 px-4 py-2 rounded-md hover:bg-gray-300 transition-colors",children:"Reload Page"})]}),!1]})})}):this.props.children}}const Eq=()=>{const[n,e]=ue.useState({isOnline:!0,isConnecting:!1,lastConnected:null});return ue.useEffect(()=>{const t=K9(),r=_a(t,".info/connected"),i=B0(r,s=>{const o=s.val()===!0,l=new Date;e(c=>({isOnline:o,isConnecting:!o&&c.isOnline,lastConnected:o?l:c.lastConnected})),console.log(o?"🟢 Firebase connected":"🔴 Firebase disconnected - showing reconnection banner")});return()=>i()},[]),n},Sq=()=>{const{isOnline:n,isConnecting:e}=Eq();return n&&!e?null:z.jsxs("div",{className:"fixed top-0 left-0 right-0 z-50 bg-amber-500 text-white px-4 py-2 text-center text-sm font-medium shadow-lg",children:[z.jsxs("div",{className:"flex items-center justify-center gap-2",children:[z.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),z.jsx("span",{children:e?"Reconnecting...":"Connection lost - trying to reconnect"})]}),z.jsx("div",{className:"text-xs mt-1 opacity-90",children:"Changes will sync when connection is restored"})]})},Cq=()=>{const{user:n}=Qo(),[e,t]=ue.useState({});ue.useEffect(()=>n?H$(s=>{const o=Object.entries(s).reduce((l,[c,h])=>(h.isOnline&&(l[c]=h),l),{});t(o)}):void 0,[n]);const r=Object.entries(e);return z.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[z.jsxs("h3",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2",children:["👥 Online Users",z.jsx("span",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full",children:r.length})]}),z.jsx("div",{className:"space-y-2",children:r.length===0?z.jsx("div",{className:"text-xs text-gray-500 italic",children:n?`Waiting for presence data... (Current user: ${n.displayName})`:"No users online"}):r.map(([i,s])=>z.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50",children:[z.jsx("div",{className:"w-3 h-3 rounded-full border border-white shadow-sm",style:{backgroundColor:s.cursorColor}}),z.jsxs("span",{className:"text-sm font-medium text-gray-900 truncate",children:[s.displayName,i===(n==null?void 0:n.uid)&&z.jsx("span",{className:"text-xs text-blue-600 font-medium ml-1",children:"(you)"})]}),s.currentlyEditing&&z.jsx("span",{className:"text-xs text-orange-600",children:"✏️"}),z.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full ml-auto"})]},i))})]})};function Tq(){const n=z.jsxs("div",{className:"container mx-auto px-4 py-8",children:[z.jsx("h1",{className:"text-4xl font-bold text-center text-gray-800 mb-8",children:"CollabCanvas MVP"}),z.jsxs("div",{className:"text-center mb-8",children:[z.jsx("p",{className:"text-lg text-gray-600 mb-2",children:"Real-Time Collaborative Design Tool"}),z.jsx("p",{className:"text-sm text-gray-500",children:"Please sign in to continue"})]}),z.jsx(cz,{})]});return z.jsx(Z5,{children:z.jsxs("div",{className:"min-h-screen bg-gray-50",children:[z.jsx(Sq,{}),z.jsx(wq,{fallback:n,children:z.jsxs("div",{className:"h-screen flex flex-col",children:[z.jsx(yq,{}),z.jsx("main",{className:"flex-1 p-4",children:z.jsxs("div",{className:"h-full flex",children:[z.jsx(Z5,{fallback:z.jsxs("div",{className:"flex-1 mr-4 bg-white rounded-lg border border-red-200 p-8 text-center",children:[z.jsx("div",{className:"text-4xl mb-4",children:"🎨"}),z.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Canvas Error"}),z.jsx("p",{className:"text-gray-600 mb-4",children:"The canvas encountered an error. Try refreshing the page."}),z.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Reload Canvas"})]}),children:z.jsx("div",{className:"flex-1 mr-4",children:z.jsx(gq,{width:1200,height:800})})}),z.jsxs("div",{className:"w-64 space-y-4",children:[z.jsx(Cq,{}),z.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[z.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Canvas Tools"}),z.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[z.jsxs("div",{children:["• ",z.jsx("strong",{children:"Click empty space"})," → Create rectangles"]}),z.jsxs("div",{children:["• ",z.jsx("strong",{children:"Click & drag shapes"})," → Move them"]}),z.jsxs("div",{children:["• ",z.jsx("strong",{children:"Click shapes"})," → Select/lock them"]}),z.jsxs("div",{children:["• ",z.jsx("strong",{children:"Trackpad scroll"})," → Pan canvas (Figma-style)"]}),z.jsxs("div",{children:["• ",z.jsx("strong",{children:"⌘/Ctrl + scroll"})," → Zoom (or pinch)"]}),z.jsxs("div",{children:["• ",z.jsx("strong",{children:"Mouse wheel"})," → Zoom"]}),z.jsxs("div",{children:["• ",z.jsx("strong",{children:"Space + drag"})," → Pan (power users)"]}),z.jsxs("div",{children:["• ",z.jsx("strong",{children:"Delete key"})," → Delete selected shape"]})]}),z.jsxs("div",{className:"mt-6",children:[z.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Progress:"}),z.jsxs("div",{className:"space-y-1 text-sm text-gray-500",children:[z.jsx("div",{children:"✅ Canvas & Figma-style Navigation"}),z.jsx("div",{children:"✅ Shape Creation & Real-time Sync"}),z.jsx("div",{children:"✅ Selection & Multiplayer Locking"}),z.jsx("div",{children:"✅ Drag & Drop with Constraints"}),z.jsx("div",{children:"✅ Shape Deletion (optimistic)"}),z.jsx("div",{children:"✅ Error Handling & Connection Status"}),z.jsx("div",{children:"✅ Multiplayer Cursors & Presence"})]})]}),!1]})]})]})})]})})]})})}Bv.createRoot(document.getElementById("root")).render(z.jsx(En.StrictMode,{children:z.jsx(Tq,{})}));
