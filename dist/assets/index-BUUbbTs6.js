var MA=Object.defineProperty;var OA=(n,e,t)=>e in n?MA(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var er=(n,e,t)=>OA(n,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var r4=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Wm(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var oI={exports:{}},Hm={},aI={exports:{}},je={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tf=Symbol.for("react.element"),LA=Symbol.for("react.portal"),FA=Symbol.for("react.fragment"),VA=Symbol.for("react.strict_mode"),UA=Symbol.for("react.profiler"),BA=Symbol.for("react.provider"),zA=Symbol.for("react.context"),jA=Symbol.for("react.forward_ref"),GA=Symbol.for("react.suspense"),WA=Symbol.for("react.memo"),HA=Symbol.for("react.lazy"),i4=Symbol.iterator;function $A(n){return n===null||typeof n!="object"?null:(n=i4&&n[i4]||n["@@iterator"],typeof n=="function"?n:null)}var lI={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},uI=Object.assign,cI={};function mc(n,e,t){this.props=n,this.context=e,this.refs=cI,this.updater=t||lI}mc.prototype.isReactComponent={};mc.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};mc.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function hI(){}hI.prototype=mc.prototype;function j2(n,e,t){this.props=n,this.context=e,this.refs=cI,this.updater=t||lI}var G2=j2.prototype=new hI;G2.constructor=j2;uI(G2,mc.prototype);G2.isPureReactComponent=!0;var s4=Array.isArray,dI=Object.prototype.hasOwnProperty,W2={current:null},fI={key:!0,ref:!0,__self:!0,__source:!0};function pI(n,e,t){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)dI.call(e,r)&&!fI.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=t;else if(1<l){for(var c=Array(l),h=0;h<l;h++)c[h]=arguments[h+2];i.children=c}if(n&&n.defaultProps)for(r in l=n.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:tf,type:n,key:s,ref:o,props:i,_owner:W2.current}}function qA(n,e){return{$$typeof:tf,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function H2(n){return typeof n=="object"&&n!==null&&n.$$typeof===tf}function KA(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var o4=/\/+/g;function Gy(n,e){return typeof n=="object"&&n!==null&&n.key!=null?KA(""+n.key):e.toString(36)}function cg(n,e,t,r,i){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case tf:case LA:o=!0}}if(o)return o=n,i=i(o),n=r===""?"."+Gy(o,0):r,s4(i)?(t="",n!=null&&(t=n.replace(o4,"$&/")+"/"),cg(i,e,t,"",function(h){return h})):i!=null&&(H2(i)&&(i=qA(i,t+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(o4,"$&/")+"/")+n)),e.push(i)),1;if(o=0,r=r===""?".":r+":",s4(n))for(var l=0;l<n.length;l++){s=n[l];var c=r+Gy(s,l);o+=cg(s,e,t,c,i)}else if(c=$A(n),typeof c=="function")for(n=c.call(n),l=0;!(s=n.next()).done;)s=s.value,c=r+Gy(s,l++),o+=cg(s,e,t,c,i);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Mp(n,e,t){if(n==null)return n;var r=[],i=0;return cg(n,r,"","",function(s){return e.call(t,s,i++)}),r}function QA(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Er={current:null},hg={transition:null},YA={ReactCurrentDispatcher:Er,ReactCurrentBatchConfig:hg,ReactCurrentOwner:W2};function gI(){throw Error("act(...) is not supported in production builds of React.")}je.Children={map:Mp,forEach:function(n,e,t){Mp(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Mp(n,function(){e++}),e},toArray:function(n){return Mp(n,function(e){return e})||[]},only:function(n){if(!H2(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};je.Component=mc;je.Fragment=FA;je.Profiler=UA;je.PureComponent=j2;je.StrictMode=VA;je.Suspense=GA;je.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=YA;je.act=gI;je.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=uI({},n.props),i=n.key,s=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=W2.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var l=n.type.defaultProps;for(c in e)dI.call(e,c)&&!fI.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=t;else if(1<c){l=Array(c);for(var h=0;h<c;h++)l[h]=arguments[h+2];r.children=l}return{$$typeof:tf,type:n.type,key:i,ref:s,props:r,_owner:o}};je.createContext=function(n){return n={$$typeof:zA,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:BA,_context:n},n.Consumer=n};je.createElement=pI;je.createFactory=function(n){var e=pI.bind(null,n);return e.type=n,e};je.createRef=function(){return{current:null}};je.forwardRef=function(n){return{$$typeof:jA,render:n}};je.isValidElement=H2;je.lazy=function(n){return{$$typeof:HA,_payload:{_status:-1,_result:n},_init:QA}};je.memo=function(n,e){return{$$typeof:WA,type:n,compare:e===void 0?null:e}};je.startTransition=function(n){var e=hg.transition;hg.transition={};try{n()}finally{hg.transition=e}};je.unstable_act=gI;je.useCallback=function(n,e){return Er.current.useCallback(n,e)};je.useContext=function(n){return Er.current.useContext(n)};je.useDebugValue=function(){};je.useDeferredValue=function(n){return Er.current.useDeferredValue(n)};je.useEffect=function(n,e){return Er.current.useEffect(n,e)};je.useId=function(){return Er.current.useId()};je.useImperativeHandle=function(n,e,t){return Er.current.useImperativeHandle(n,e,t)};je.useInsertionEffect=function(n,e){return Er.current.useInsertionEffect(n,e)};je.useLayoutEffect=function(n,e){return Er.current.useLayoutEffect(n,e)};je.useMemo=function(n,e){return Er.current.useMemo(n,e)};je.useReducer=function(n,e,t){return Er.current.useReducer(n,e,t)};je.useRef=function(n){return Er.current.useRef(n)};je.useState=function(n){return Er.current.useState(n)};je.useSyncExternalStore=function(n,e,t){return Er.current.useSyncExternalStore(n,e,t)};je.useTransition=function(){return Er.current.useTransition()};je.version="18.3.1";aI.exports=je;var ee=aI.exports;const Sn=Wm(ee);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var XA=ee,JA=Symbol.for("react.element"),ZA=Symbol.for("react.fragment"),e8=Object.prototype.hasOwnProperty,t8=XA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,n8={key:!0,ref:!0,__self:!0,__source:!0};function mI(n,e,t){var r,i={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)e8.call(e,r)&&!n8.hasOwnProperty(r)&&(i[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:JA,type:n,key:s,ref:o,props:i,_owner:t8.current}}Hm.Fragment=ZA;Hm.jsx=mI;Hm.jsxs=mI;oI.exports=Hm;var z=oI.exports,qv={},_I={exports:{}},qr={},yI={exports:{}},vI={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(Y,J){var X=Y.length;Y.push(J);e:for(;0<X;){var te=X-1>>>1,ie=Y[te];if(0<i(ie,J))Y[te]=J,Y[X]=ie,X=te;else break e}}function t(Y){return Y.length===0?null:Y[0]}function r(Y){if(Y.length===0)return null;var J=Y[0],X=Y.pop();if(X!==J){Y[0]=X;e:for(var te=0,ie=Y.length,se=ie>>>1;te<se;){var ft=2*(te+1)-1,ct=Y[ft],Qe=ft+1,j=Y[Qe];if(0>i(ct,X))Qe<ie&&0>i(j,ct)?(Y[te]=j,Y[Qe]=X,te=Qe):(Y[te]=ct,Y[ft]=X,te=ft);else if(Qe<ie&&0>i(j,X))Y[te]=j,Y[Qe]=X,te=Qe;else break e}}return J}function i(Y,J){var X=Y.sortIndex-J.sortIndex;return X!==0?X:Y.id-J.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var c=[],h=[],p=1,m=null,_=3,S=!1,E=!1,x=!1,M=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(Y){for(var J=t(h);J!==null;){if(J.callback===null)r(h);else if(J.startTime<=Y)r(h),J.sortIndex=J.expirationTime,e(c,J);else break;J=t(h)}}function k(Y){if(x=!1,v(Y),!E)if(t(c)!==null)E=!0,Te(D);else{var J=t(h);J!==null&&xe(k,J.startTime-Y)}}function D(Y,J){E=!1,x&&(x=!1,R(C),C=-1),S=!0;var X=_;try{for(v(J),m=t(c);m!==null&&(!(m.expirationTime>J)||Y&&!L());){var te=m.callback;if(typeof te=="function"){m.callback=null,_=m.priorityLevel;var ie=te(m.expirationTime<=J);J=n.unstable_now(),typeof ie=="function"?m.callback=ie:m===t(c)&&r(c),v(J)}else r(c);m=t(c)}if(m!==null)var se=!0;else{var ft=t(h);ft!==null&&xe(k,ft.startTime-J),se=!1}return se}finally{m=null,_=X,S=!1}}var O=!1,N=null,C=-1,b=5,A=-1;function L(){return!(n.unstable_now()-A<b)}function B(){if(N!==null){var Y=n.unstable_now();A=Y;var J=!0;try{J=N(!0,Y)}finally{J?V():(O=!1,N=null)}}else O=!1}var V;if(typeof P=="function")V=function(){P(B)};else if(typeof MessageChannel<"u"){var he=new MessageChannel,le=he.port2;he.port1.onmessage=B,V=function(){le.postMessage(null)}}else V=function(){M(B,0)};function Te(Y){N=Y,O||(O=!0,V())}function xe(Y,J){C=M(function(){Y(n.unstable_now())},J)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Y){Y.callback=null},n.unstable_continueExecution=function(){E||S||(E=!0,Te(D))},n.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<Y?Math.floor(1e3/Y):5},n.unstable_getCurrentPriorityLevel=function(){return _},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(Y){switch(_){case 1:case 2:case 3:var J=3;break;default:J=_}var X=_;_=J;try{return Y()}finally{_=X}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(Y,J){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var X=_;_=Y;try{return J()}finally{_=X}},n.unstable_scheduleCallback=function(Y,J,X){var te=n.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?te+X:te):X=te,Y){case 1:var ie=-1;break;case 2:ie=250;break;case 5:ie=1073741823;break;case 4:ie=1e4;break;default:ie=5e3}return ie=X+ie,Y={id:p++,callback:J,priorityLevel:Y,startTime:X,expirationTime:ie,sortIndex:-1},X>te?(Y.sortIndex=X,e(h,Y),t(c)===null&&Y===t(h)&&(x?(R(C),C=-1):x=!0,xe(k,X-te))):(Y.sortIndex=ie,e(c,Y),E||S||(E=!0,Te(D))),Y},n.unstable_shouldYield=L,n.unstable_wrapCallback=function(Y){var J=_;return function(){var X=_;_=J;try{return Y.apply(this,arguments)}finally{_=X}}}})(vI);yI.exports=vI;var $h=yI.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r8=ee,$r=$h;function oe(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var wI=new Set,gd={};function Sl(n,e){Gu(n,e),Gu(n+"Capture",e)}function Gu(n,e){for(gd[n]=e,n=0;n<e.length;n++)wI.add(e[n])}var $s=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Kv=Object.prototype.hasOwnProperty,i8=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,a4={},l4={};function s8(n){return Kv.call(l4,n)?!0:Kv.call(a4,n)?!1:i8.test(n)?l4[n]=!0:(a4[n]=!0,!1)}function o8(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function a8(n,e,t,r){if(e===null||typeof e>"u"||o8(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Sr(n,e,t,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var jn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){jn[n]=new Sr(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];jn[e]=new Sr(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){jn[n]=new Sr(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){jn[n]=new Sr(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){jn[n]=new Sr(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){jn[n]=new Sr(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){jn[n]=new Sr(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){jn[n]=new Sr(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){jn[n]=new Sr(n,5,!1,n.toLowerCase(),null,!1,!1)});var $2=/[\-:]([a-z])/g;function q2(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace($2,q2);jn[e]=new Sr(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace($2,q2);jn[e]=new Sr(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace($2,q2);jn[e]=new Sr(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){jn[n]=new Sr(n,1,!1,n.toLowerCase(),null,!1,!1)});jn.xlinkHref=new Sr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){jn[n]=new Sr(n,1,!1,n.toLowerCase(),null,!0,!0)});function K2(n,e,t,r){var i=jn.hasOwnProperty(e)?jn[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(a8(e,t,i,r)&&(t=null),r||i===null?s8(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,r=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var to=r8.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Op=Symbol.for("react.element"),gu=Symbol.for("react.portal"),mu=Symbol.for("react.fragment"),Q2=Symbol.for("react.strict_mode"),Qv=Symbol.for("react.profiler"),EI=Symbol.for("react.provider"),SI=Symbol.for("react.context"),Y2=Symbol.for("react.forward_ref"),Yv=Symbol.for("react.suspense"),Xv=Symbol.for("react.suspense_list"),X2=Symbol.for("react.memo"),Ro=Symbol.for("react.lazy"),CI=Symbol.for("react.offscreen"),u4=Symbol.iterator;function vh(n){return n===null||typeof n!="object"?null:(n=u4&&n[u4]||n["@@iterator"],typeof n=="function"?n:null)}var Ft=Object.assign,Wy;function Lh(n){if(Wy===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Wy=e&&e[1]||""}return`
`+Wy+n}var Hy=!1;function $y(n,e){if(!n||Hy)return"";Hy=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var r=h}Reflect.construct(n,[],e)}else{try{e.call()}catch(h){r=h}n.call(e.prototype)}else{try{throw Error()}catch(h){r=h}n()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var i=h.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var c=`
`+i[o].replace(" at new "," at ");return n.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",n.displayName)),c}while(1<=o&&0<=l);break}}}finally{Hy=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Lh(n):""}function l8(n){switch(n.tag){case 5:return Lh(n.type);case 16:return Lh("Lazy");case 13:return Lh("Suspense");case 19:return Lh("SuspenseList");case 0:case 2:case 15:return n=$y(n.type,!1),n;case 11:return n=$y(n.type.render,!1),n;case 1:return n=$y(n.type,!0),n;default:return""}}function Jv(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case mu:return"Fragment";case gu:return"Portal";case Qv:return"Profiler";case Q2:return"StrictMode";case Yv:return"Suspense";case Xv:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case SI:return(n.displayName||"Context")+".Consumer";case EI:return(n._context.displayName||"Context")+".Provider";case Y2:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case X2:return e=n.displayName||null,e!==null?e:Jv(n.type)||"Memo";case Ro:e=n._payload,n=n._init;try{return Jv(n(e))}catch{}}return null}function u8(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Jv(e);case 8:return e===Q2?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Jo(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function TI(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function c8(n){var e=TI(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Lp(n){n._valueTracker||(n._valueTracker=c8(n))}function II(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=TI(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function Og(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Zv(n,e){var t=e.checked;return Ft({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function c4(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=Jo(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function kI(n,e){e=e.checked,e!=null&&K2(n,"checked",e,!1)}function e1(n,e){kI(n,e);var t=Jo(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?t1(n,e.type,t):e.hasOwnProperty("defaultValue")&&t1(n,e.type,Jo(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function h4(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function t1(n,e,t){(e!=="number"||Og(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Fh=Array.isArray;function xu(n,e,t,r){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&r&&(n[t].defaultSelected=!0)}else{for(t=""+Jo(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,r&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function n1(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(oe(91));return Ft({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function d4(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(oe(92));if(Fh(t)){if(1<t.length)throw Error(oe(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Jo(t)}}function PI(n,e){var t=Jo(e.value),r=Jo(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function f4(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function RI(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function r1(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?RI(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Fp,xI=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Fp=Fp||document.createElement("div"),Fp.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Fp.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function md(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var qh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},h8=["Webkit","ms","Moz","O"];Object.keys(qh).forEach(function(n){h8.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),qh[e]=qh[n]})});function AI(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||qh.hasOwnProperty(n)&&qh[n]?(""+e).trim():e+"px"}function NI(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,i=AI(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,i):n[t]=i}}var d8=Ft({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function i1(n,e){if(e){if(d8[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(oe(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(oe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(oe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(oe(62))}}function s1(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var o1=null;function J2(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var a1=null,Au=null,Nu=null;function p4(n){if(n=sf(n)){if(typeof a1!="function")throw Error(oe(280));var e=n.stateNode;e&&(e=Ym(e),a1(n.stateNode,n.type,e))}}function bI(n){Au?Nu?Nu.push(n):Nu=[n]:Au=n}function DI(){if(Au){var n=Au,e=Nu;if(Nu=Au=null,p4(n),e)for(n=0;n<e.length;n++)p4(e[n])}}function MI(n,e){return n(e)}function OI(){}var qy=!1;function LI(n,e,t){if(qy)return n(e,t);qy=!0;try{return MI(n,e,t)}finally{qy=!1,(Au!==null||Nu!==null)&&(OI(),DI())}}function _d(n,e){var t=n.stateNode;if(t===null)return null;var r=Ym(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(oe(231,e,typeof t));return t}var l1=!1;if($s)try{var wh={};Object.defineProperty(wh,"passive",{get:function(){l1=!0}}),window.addEventListener("test",wh,wh),window.removeEventListener("test",wh,wh)}catch{l1=!1}function f8(n,e,t,r,i,s,o,l,c){var h=Array.prototype.slice.call(arguments,3);try{e.apply(t,h)}catch(p){this.onError(p)}}var Kh=!1,Lg=null,Fg=!1,u1=null,p8={onError:function(n){Kh=!0,Lg=n}};function g8(n,e,t,r,i,s,o,l,c){Kh=!1,Lg=null,f8.apply(p8,arguments)}function m8(n,e,t,r,i,s,o,l,c){if(g8.apply(this,arguments),Kh){if(Kh){var h=Lg;Kh=!1,Lg=null}else throw Error(oe(198));Fg||(Fg=!0,u1=h)}}function Cl(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function FI(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function g4(n){if(Cl(n)!==n)throw Error(oe(188))}function _8(n){var e=n.alternate;if(!e){if(e=Cl(n),e===null)throw Error(oe(188));return e!==n?null:n}for(var t=n,r=e;;){var i=t.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){t=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===t)return g4(i),n;if(s===r)return g4(i),e;s=s.sibling}throw Error(oe(188))}if(t.return!==r.return)t=i,r=s;else{for(var o=!1,l=i.child;l;){if(l===t){o=!0,t=i,r=s;break}if(l===r){o=!0,r=i,t=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===t){o=!0,t=s,r=i;break}if(l===r){o=!0,r=s,t=i;break}l=l.sibling}if(!o)throw Error(oe(189))}}if(t.alternate!==r)throw Error(oe(190))}if(t.tag!==3)throw Error(oe(188));return t.stateNode.current===t?n:e}function VI(n){return n=_8(n),n!==null?UI(n):null}function UI(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=UI(n);if(e!==null)return e;n=n.sibling}return null}var BI=$r.unstable_scheduleCallback,m4=$r.unstable_cancelCallback,y8=$r.unstable_shouldYield,v8=$r.unstable_requestPaint,qt=$r.unstable_now,w8=$r.unstable_getCurrentPriorityLevel,Z2=$r.unstable_ImmediatePriority,zI=$r.unstable_UserBlockingPriority,Vg=$r.unstable_NormalPriority,E8=$r.unstable_LowPriority,jI=$r.unstable_IdlePriority,$m=null,ss=null;function S8(n){if(ss&&typeof ss.onCommitFiberRoot=="function")try{ss.onCommitFiberRoot($m,n,void 0,(n.current.flags&128)===128)}catch{}}var Ai=Math.clz32?Math.clz32:I8,C8=Math.log,T8=Math.LN2;function I8(n){return n>>>=0,n===0?32:31-(C8(n)/T8|0)|0}var Vp=64,Up=4194304;function Vh(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Ug(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,i=n.suspendedLanes,s=n.pingedLanes,o=t&268435455;if(o!==0){var l=o&~i;l!==0?r=Vh(l):(s&=o,s!==0&&(r=Vh(s)))}else o=t&~i,o!==0?r=Vh(o):s!==0&&(r=Vh(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-Ai(e),i=1<<t,r|=n[t],e&=~i;return r}function k8(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function P8(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,i=n.expirationTimes,s=n.pendingLanes;0<s;){var o=31-Ai(s),l=1<<o,c=i[o];c===-1?(!(l&t)||l&r)&&(i[o]=k8(l,e)):c<=e&&(n.expiredLanes|=l),s&=~l}}function c1(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function GI(){var n=Vp;return Vp<<=1,!(Vp&4194240)&&(Vp=64),n}function Ky(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function nf(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Ai(e),n[e]=t}function R8(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-Ai(t),s=1<<i;e[i]=0,r[i]=-1,n[i]=-1,t&=~s}}function ew(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-Ai(t),i=1<<r;i&e|n[r]&e&&(n[r]|=e),t&=~i}}var ht=0;function WI(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var HI,tw,$I,qI,KI,h1=!1,Bp=[],Uo=null,Bo=null,zo=null,yd=new Map,vd=new Map,Ao=[],x8="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function _4(n,e){switch(n){case"focusin":case"focusout":Uo=null;break;case"dragenter":case"dragleave":Bo=null;break;case"mouseover":case"mouseout":zo=null;break;case"pointerover":case"pointerout":yd.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":vd.delete(e.pointerId)}}function Eh(n,e,t,r,i,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=sf(e),e!==null&&tw(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function A8(n,e,t,r,i){switch(e){case"focusin":return Uo=Eh(Uo,n,e,t,r,i),!0;case"dragenter":return Bo=Eh(Bo,n,e,t,r,i),!0;case"mouseover":return zo=Eh(zo,n,e,t,r,i),!0;case"pointerover":var s=i.pointerId;return yd.set(s,Eh(yd.get(s)||null,n,e,t,r,i)),!0;case"gotpointercapture":return s=i.pointerId,vd.set(s,Eh(vd.get(s)||null,n,e,t,r,i)),!0}return!1}function QI(n){var e=Ya(n.target);if(e!==null){var t=Cl(e);if(t!==null){if(e=t.tag,e===13){if(e=FI(t),e!==null){n.blockedOn=e,KI(n.priority,function(){$I(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function dg(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=d1(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);o1=r,t.target.dispatchEvent(r),o1=null}else return e=sf(t),e!==null&&tw(e),n.blockedOn=t,!1;e.shift()}return!0}function y4(n,e,t){dg(n)&&t.delete(e)}function N8(){h1=!1,Uo!==null&&dg(Uo)&&(Uo=null),Bo!==null&&dg(Bo)&&(Bo=null),zo!==null&&dg(zo)&&(zo=null),yd.forEach(y4),vd.forEach(y4)}function Sh(n,e){n.blockedOn===e&&(n.blockedOn=null,h1||(h1=!0,$r.unstable_scheduleCallback($r.unstable_NormalPriority,N8)))}function wd(n){function e(i){return Sh(i,n)}if(0<Bp.length){Sh(Bp[0],n);for(var t=1;t<Bp.length;t++){var r=Bp[t];r.blockedOn===n&&(r.blockedOn=null)}}for(Uo!==null&&Sh(Uo,n),Bo!==null&&Sh(Bo,n),zo!==null&&Sh(zo,n),yd.forEach(e),vd.forEach(e),t=0;t<Ao.length;t++)r=Ao[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<Ao.length&&(t=Ao[0],t.blockedOn===null);)QI(t),t.blockedOn===null&&Ao.shift()}var bu=to.ReactCurrentBatchConfig,Bg=!0;function b8(n,e,t,r){var i=ht,s=bu.transition;bu.transition=null;try{ht=1,nw(n,e,t,r)}finally{ht=i,bu.transition=s}}function D8(n,e,t,r){var i=ht,s=bu.transition;bu.transition=null;try{ht=4,nw(n,e,t,r)}finally{ht=i,bu.transition=s}}function nw(n,e,t,r){if(Bg){var i=d1(n,e,t,r);if(i===null)iv(n,e,r,zg,t),_4(n,r);else if(A8(i,n,e,t,r))r.stopPropagation();else if(_4(n,r),e&4&&-1<x8.indexOf(n)){for(;i!==null;){var s=sf(i);if(s!==null&&HI(s),s=d1(n,e,t,r),s===null&&iv(n,e,r,zg,t),s===i)break;i=s}i!==null&&r.stopPropagation()}else iv(n,e,r,null,t)}}var zg=null;function d1(n,e,t,r){if(zg=null,n=J2(r),n=Ya(n),n!==null)if(e=Cl(n),e===null)n=null;else if(t=e.tag,t===13){if(n=FI(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return zg=n,null}function YI(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(w8()){case Z2:return 1;case zI:return 4;case Vg:case E8:return 16;case jI:return 536870912;default:return 16}default:return 16}}var Oo=null,rw=null,fg=null;function XI(){if(fg)return fg;var n,e=rw,t=e.length,r,i="value"in Oo?Oo.value:Oo.textContent,s=i.length;for(n=0;n<t&&e[n]===i[n];n++);var o=t-n;for(r=1;r<=o&&e[t-r]===i[s-r];r++);return fg=i.slice(n,1<r?1-r:void 0)}function pg(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function zp(){return!0}function v4(){return!1}function Kr(n){function e(t,r,i,s,o){this._reactName=t,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in n)n.hasOwnProperty(l)&&(t=n[l],this[l]=t?t(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?zp:v4,this.isPropagationStopped=v4,this}return Ft(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=zp)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=zp)},persist:function(){},isPersistent:zp}),e}var _c={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},iw=Kr(_c),rf=Ft({},_c,{view:0,detail:0}),M8=Kr(rf),Qy,Yy,Ch,qm=Ft({},rf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sw,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Ch&&(Ch&&n.type==="mousemove"?(Qy=n.screenX-Ch.screenX,Yy=n.screenY-Ch.screenY):Yy=Qy=0,Ch=n),Qy)},movementY:function(n){return"movementY"in n?n.movementY:Yy}}),w4=Kr(qm),O8=Ft({},qm,{dataTransfer:0}),L8=Kr(O8),F8=Ft({},rf,{relatedTarget:0}),Xy=Kr(F8),V8=Ft({},_c,{animationName:0,elapsedTime:0,pseudoElement:0}),U8=Kr(V8),B8=Ft({},_c,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),z8=Kr(B8),j8=Ft({},_c,{data:0}),E4=Kr(j8),G8={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},W8={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},H8={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $8(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=H8[n])?!!e[n]:!1}function sw(){return $8}var q8=Ft({},rf,{key:function(n){if(n.key){var e=G8[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=pg(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?W8[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sw,charCode:function(n){return n.type==="keypress"?pg(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?pg(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),K8=Kr(q8),Q8=Ft({},qm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),S4=Kr(Q8),Y8=Ft({},rf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sw}),X8=Kr(Y8),J8=Ft({},_c,{propertyName:0,elapsedTime:0,pseudoElement:0}),Z8=Kr(J8),eN=Ft({},qm,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),tN=Kr(eN),nN=[9,13,27,32],ow=$s&&"CompositionEvent"in window,Qh=null;$s&&"documentMode"in document&&(Qh=document.documentMode);var rN=$s&&"TextEvent"in window&&!Qh,JI=$s&&(!ow||Qh&&8<Qh&&11>=Qh),C4=" ",T4=!1;function ZI(n,e){switch(n){case"keyup":return nN.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function e6(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var _u=!1;function iN(n,e){switch(n){case"compositionend":return e6(e);case"keypress":return e.which!==32?null:(T4=!0,C4);case"textInput":return n=e.data,n===C4&&T4?null:n;default:return null}}function sN(n,e){if(_u)return n==="compositionend"||!ow&&ZI(n,e)?(n=XI(),fg=rw=Oo=null,_u=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return JI&&e.locale!=="ko"?null:e.data;default:return null}}var oN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function I4(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!oN[n.type]:e==="textarea"}function t6(n,e,t,r){bI(r),e=jg(e,"onChange"),0<e.length&&(t=new iw("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var Yh=null,Ed=null;function aN(n){d6(n,0)}function Km(n){var e=wu(n);if(II(e))return n}function lN(n,e){if(n==="change")return e}var n6=!1;if($s){var Jy;if($s){var Zy="oninput"in document;if(!Zy){var k4=document.createElement("div");k4.setAttribute("oninput","return;"),Zy=typeof k4.oninput=="function"}Jy=Zy}else Jy=!1;n6=Jy&&(!document.documentMode||9<document.documentMode)}function P4(){Yh&&(Yh.detachEvent("onpropertychange",r6),Ed=Yh=null)}function r6(n){if(n.propertyName==="value"&&Km(Ed)){var e=[];t6(e,Ed,n,J2(n)),LI(aN,e)}}function uN(n,e,t){n==="focusin"?(P4(),Yh=e,Ed=t,Yh.attachEvent("onpropertychange",r6)):n==="focusout"&&P4()}function cN(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Km(Ed)}function hN(n,e){if(n==="click")return Km(e)}function dN(n,e){if(n==="input"||n==="change")return Km(e)}function fN(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Oi=typeof Object.is=="function"?Object.is:fN;function Sd(n,e){if(Oi(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var i=t[r];if(!Kv.call(e,i)||!Oi(n[i],e[i]))return!1}return!0}function R4(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function x4(n,e){var t=R4(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=R4(t)}}function i6(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?i6(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function s6(){for(var n=window,e=Og();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=Og(n.document)}return e}function aw(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function pN(n){var e=s6(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&i6(t.ownerDocument.documentElement,t)){if(r!==null&&aw(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!n.extend&&s>r&&(i=r,r=s,s=i),i=x4(t,s);var o=x4(t,r);i&&o&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),s>r?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var gN=$s&&"documentMode"in document&&11>=document.documentMode,yu=null,f1=null,Xh=null,p1=!1;function A4(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;p1||yu==null||yu!==Og(r)||(r=yu,"selectionStart"in r&&aw(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Xh&&Sd(Xh,r)||(Xh=r,r=jg(f1,"onSelect"),0<r.length&&(e=new iw("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=yu)))}function jp(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var vu={animationend:jp("Animation","AnimationEnd"),animationiteration:jp("Animation","AnimationIteration"),animationstart:jp("Animation","AnimationStart"),transitionend:jp("Transition","TransitionEnd")},ev={},o6={};$s&&(o6=document.createElement("div").style,"AnimationEvent"in window||(delete vu.animationend.animation,delete vu.animationiteration.animation,delete vu.animationstart.animation),"TransitionEvent"in window||delete vu.transitionend.transition);function Qm(n){if(ev[n])return ev[n];if(!vu[n])return n;var e=vu[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in o6)return ev[n]=e[t];return n}var a6=Qm("animationend"),l6=Qm("animationiteration"),u6=Qm("animationstart"),c6=Qm("transitionend"),h6=new Map,N4="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ca(n,e){h6.set(n,e),Sl(e,[n])}for(var tv=0;tv<N4.length;tv++){var nv=N4[tv],mN=nv.toLowerCase(),_N=nv[0].toUpperCase()+nv.slice(1);ca(mN,"on"+_N)}ca(a6,"onAnimationEnd");ca(l6,"onAnimationIteration");ca(u6,"onAnimationStart");ca("dblclick","onDoubleClick");ca("focusin","onFocus");ca("focusout","onBlur");ca(c6,"onTransitionEnd");Gu("onMouseEnter",["mouseout","mouseover"]);Gu("onMouseLeave",["mouseout","mouseover"]);Gu("onPointerEnter",["pointerout","pointerover"]);Gu("onPointerLeave",["pointerout","pointerover"]);Sl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Sl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Sl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Sl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Sl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Sl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Uh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),yN=new Set("cancel close invalid load scroll toggle".split(" ").concat(Uh));function b4(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,m8(r,e,void 0,n),n.currentTarget=null}function d6(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,h=l.currentTarget;if(l=l.listener,c!==s&&i.isPropagationStopped())break e;b4(i,l,h),s=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,h=l.currentTarget,l=l.listener,c!==s&&i.isPropagationStopped())break e;b4(i,l,h),s=c}}}if(Fg)throw n=u1,Fg=!1,u1=null,n}function kt(n,e){var t=e[v1];t===void 0&&(t=e[v1]=new Set);var r=n+"__bubble";t.has(r)||(f6(e,n,2,!1),t.add(r))}function rv(n,e,t){var r=0;e&&(r|=4),f6(t,n,r,e)}var Gp="_reactListening"+Math.random().toString(36).slice(2);function Cd(n){if(!n[Gp]){n[Gp]=!0,wI.forEach(function(t){t!=="selectionchange"&&(yN.has(t)||rv(t,!1,n),rv(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Gp]||(e[Gp]=!0,rv("selectionchange",!1,e))}}function f6(n,e,t,r){switch(YI(e)){case 1:var i=b8;break;case 4:i=D8;break;default:i=nw}t=i.bind(null,e,t,n),i=void 0,!l1||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function iv(n,e,t,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=Ya(l),o===null)return;if(c=o.tag,c===5||c===6){r=s=o;continue e}l=l.parentNode}}r=r.return}LI(function(){var h=s,p=J2(t),m=[];e:{var _=h6.get(n);if(_!==void 0){var S=iw,E=n;switch(n){case"keypress":if(pg(t)===0)break e;case"keydown":case"keyup":S=K8;break;case"focusin":E="focus",S=Xy;break;case"focusout":E="blur",S=Xy;break;case"beforeblur":case"afterblur":S=Xy;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":S=w4;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":S=L8;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":S=X8;break;case a6:case l6:case u6:S=U8;break;case c6:S=Z8;break;case"scroll":S=M8;break;case"wheel":S=tN;break;case"copy":case"cut":case"paste":S=z8;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":S=S4}var x=(e&4)!==0,M=!x&&n==="scroll",R=x?_!==null?_+"Capture":null:_;x=[];for(var P=h,v;P!==null;){v=P;var k=v.stateNode;if(v.tag===5&&k!==null&&(v=k,R!==null&&(k=_d(P,R),k!=null&&x.push(Td(P,k,v)))),M)break;P=P.return}0<x.length&&(_=new S(_,E,null,t,p),m.push({event:_,listeners:x}))}}if(!(e&7)){e:{if(_=n==="mouseover"||n==="pointerover",S=n==="mouseout"||n==="pointerout",_&&t!==o1&&(E=t.relatedTarget||t.fromElement)&&(Ya(E)||E[qs]))break e;if((S||_)&&(_=p.window===p?p:(_=p.ownerDocument)?_.defaultView||_.parentWindow:window,S?(E=t.relatedTarget||t.toElement,S=h,E=E?Ya(E):null,E!==null&&(M=Cl(E),E!==M||E.tag!==5&&E.tag!==6)&&(E=null)):(S=null,E=h),S!==E)){if(x=w4,k="onMouseLeave",R="onMouseEnter",P="mouse",(n==="pointerout"||n==="pointerover")&&(x=S4,k="onPointerLeave",R="onPointerEnter",P="pointer"),M=S==null?_:wu(S),v=E==null?_:wu(E),_=new x(k,P+"leave",S,t,p),_.target=M,_.relatedTarget=v,k=null,Ya(p)===h&&(x=new x(R,P+"enter",E,t,p),x.target=v,x.relatedTarget=M,k=x),M=k,S&&E)t:{for(x=S,R=E,P=0,v=x;v;v=ou(v))P++;for(v=0,k=R;k;k=ou(k))v++;for(;0<P-v;)x=ou(x),P--;for(;0<v-P;)R=ou(R),v--;for(;P--;){if(x===R||R!==null&&x===R.alternate)break t;x=ou(x),R=ou(R)}x=null}else x=null;S!==null&&D4(m,_,S,x,!1),E!==null&&M!==null&&D4(m,M,E,x,!0)}}e:{if(_=h?wu(h):window,S=_.nodeName&&_.nodeName.toLowerCase(),S==="select"||S==="input"&&_.type==="file")var D=lN;else if(I4(_))if(n6)D=dN;else{D=cN;var O=uN}else(S=_.nodeName)&&S.toLowerCase()==="input"&&(_.type==="checkbox"||_.type==="radio")&&(D=hN);if(D&&(D=D(n,h))){t6(m,D,t,p);break e}O&&O(n,_,h),n==="focusout"&&(O=_._wrapperState)&&O.controlled&&_.type==="number"&&t1(_,"number",_.value)}switch(O=h?wu(h):window,n){case"focusin":(I4(O)||O.contentEditable==="true")&&(yu=O,f1=h,Xh=null);break;case"focusout":Xh=f1=yu=null;break;case"mousedown":p1=!0;break;case"contextmenu":case"mouseup":case"dragend":p1=!1,A4(m,t,p);break;case"selectionchange":if(gN)break;case"keydown":case"keyup":A4(m,t,p)}var N;if(ow)e:{switch(n){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else _u?ZI(n,t)&&(C="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(C="onCompositionStart");C&&(JI&&t.locale!=="ko"&&(_u||C!=="onCompositionStart"?C==="onCompositionEnd"&&_u&&(N=XI()):(Oo=p,rw="value"in Oo?Oo.value:Oo.textContent,_u=!0)),O=jg(h,C),0<O.length&&(C=new E4(C,n,null,t,p),m.push({event:C,listeners:O}),N?C.data=N:(N=e6(t),N!==null&&(C.data=N)))),(N=rN?iN(n,t):sN(n,t))&&(h=jg(h,"onBeforeInput"),0<h.length&&(p=new E4("onBeforeInput","beforeinput",null,t,p),m.push({event:p,listeners:h}),p.data=N))}d6(m,e)})}function Td(n,e,t){return{instance:n,listener:e,currentTarget:t}}function jg(n,e){for(var t=e+"Capture",r=[];n!==null;){var i=n,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=_d(n,t),s!=null&&r.unshift(Td(n,s,i)),s=_d(n,e),s!=null&&r.push(Td(n,s,i))),n=n.return}return r}function ou(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function D4(n,e,t,r,i){for(var s=e._reactName,o=[];t!==null&&t!==r;){var l=t,c=l.alternate,h=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&h!==null&&(l=h,i?(c=_d(t,s),c!=null&&o.unshift(Td(t,c,l))):i||(c=_d(t,s),c!=null&&o.push(Td(t,c,l)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var vN=/\r\n?/g,wN=/\u0000|\uFFFD/g;function M4(n){return(typeof n=="string"?n:""+n).replace(vN,`
`).replace(wN,"")}function Wp(n,e,t){if(e=M4(e),M4(n)!==e&&t)throw Error(oe(425))}function Gg(){}var g1=null,m1=null;function _1(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var y1=typeof setTimeout=="function"?setTimeout:void 0,EN=typeof clearTimeout=="function"?clearTimeout:void 0,O4=typeof Promise=="function"?Promise:void 0,SN=typeof queueMicrotask=="function"?queueMicrotask:typeof O4<"u"?function(n){return O4.resolve(null).then(n).catch(CN)}:y1;function CN(n){setTimeout(function(){throw n})}function sv(n,e){var t=e,r=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(r===0){n.removeChild(i),wd(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=i}while(t);wd(e)}function jo(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function L4(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var yc=Math.random().toString(36).slice(2),ns="__reactFiber$"+yc,Id="__reactProps$"+yc,qs="__reactContainer$"+yc,v1="__reactEvents$"+yc,TN="__reactListeners$"+yc,IN="__reactHandles$"+yc;function Ya(n){var e=n[ns];if(e)return e;for(var t=n.parentNode;t;){if(e=t[qs]||t[ns]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=L4(n);n!==null;){if(t=n[ns])return t;n=L4(n)}return e}n=t,t=n.parentNode}return null}function sf(n){return n=n[ns]||n[qs],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function wu(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(oe(33))}function Ym(n){return n[Id]||null}var w1=[],Eu=-1;function ha(n){return{current:n}}function Pt(n){0>Eu||(n.current=w1[Eu],w1[Eu]=null,Eu--)}function Tt(n,e){Eu++,w1[Eu]=n.current,n.current=e}var Zo={},ur=ha(Zo),Lr=ha(!1),ol=Zo;function Wu(n,e){var t=n.type.contextTypes;if(!t)return Zo;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in t)i[s]=e[s];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function Fr(n){return n=n.childContextTypes,n!=null}function Wg(){Pt(Lr),Pt(ur)}function F4(n,e,t){if(ur.current!==Zo)throw Error(oe(168));Tt(ur,e),Tt(Lr,t)}function p6(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(oe(108,u8(n)||"Unknown",i));return Ft({},t,r)}function Hg(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Zo,ol=ur.current,Tt(ur,n),Tt(Lr,Lr.current),!0}function V4(n,e,t){var r=n.stateNode;if(!r)throw Error(oe(169));t?(n=p6(n,e,ol),r.__reactInternalMemoizedMergedChildContext=n,Pt(Lr),Pt(ur),Tt(ur,n)):Pt(Lr),Tt(Lr,t)}var Ds=null,Xm=!1,ov=!1;function g6(n){Ds===null?Ds=[n]:Ds.push(n)}function kN(n){Xm=!0,g6(n)}function da(){if(!ov&&Ds!==null){ov=!0;var n=0,e=ht;try{var t=Ds;for(ht=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}Ds=null,Xm=!1}catch(i){throw Ds!==null&&(Ds=Ds.slice(n+1)),BI(Z2,da),i}finally{ht=e,ov=!1}}return null}var Su=[],Cu=0,$g=null,qg=0,ii=[],si=0,al=null,Os=1,Ls="";function Ha(n,e){Su[Cu++]=qg,Su[Cu++]=$g,$g=n,qg=e}function m6(n,e,t){ii[si++]=Os,ii[si++]=Ls,ii[si++]=al,al=n;var r=Os;n=Ls;var i=32-Ai(r)-1;r&=~(1<<i),t+=1;var s=32-Ai(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Os=1<<32-Ai(e)+i|t<<i|r,Ls=s+n}else Os=1<<s|t<<i|r,Ls=n}function lw(n){n.return!==null&&(Ha(n,1),m6(n,1,0))}function uw(n){for(;n===$g;)$g=Su[--Cu],Su[Cu]=null,qg=Su[--Cu],Su[Cu]=null;for(;n===al;)al=ii[--si],ii[si]=null,Ls=ii[--si],ii[si]=null,Os=ii[--si],ii[si]=null}var Wr=null,jr=null,xt=!1,ki=null;function _6(n,e){var t=oi(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function U4(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Wr=n,jr=jo(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Wr=n,jr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=al!==null?{id:Os,overflow:Ls}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=oi(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Wr=n,jr=null,!0):!1;default:return!1}}function E1(n){return(n.mode&1)!==0&&(n.flags&128)===0}function S1(n){if(xt){var e=jr;if(e){var t=e;if(!U4(n,e)){if(E1(n))throw Error(oe(418));e=jo(t.nextSibling);var r=Wr;e&&U4(n,e)?_6(r,t):(n.flags=n.flags&-4097|2,xt=!1,Wr=n)}}else{if(E1(n))throw Error(oe(418));n.flags=n.flags&-4097|2,xt=!1,Wr=n}}}function B4(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Wr=n}function Hp(n){if(n!==Wr)return!1;if(!xt)return B4(n),xt=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!_1(n.type,n.memoizedProps)),e&&(e=jr)){if(E1(n))throw y6(),Error(oe(418));for(;e;)_6(n,e),e=jo(e.nextSibling)}if(B4(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(oe(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){jr=jo(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}jr=null}}else jr=Wr?jo(n.stateNode.nextSibling):null;return!0}function y6(){for(var n=jr;n;)n=jo(n.nextSibling)}function Hu(){jr=Wr=null,xt=!1}function cw(n){ki===null?ki=[n]:ki.push(n)}var PN=to.ReactCurrentBatchConfig;function Th(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(oe(309));var r=t.stateNode}if(!r)throw Error(oe(147,n));var i=r,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},e._stringRef=s,e)}if(typeof n!="string")throw Error(oe(284));if(!t._owner)throw Error(oe(290,n))}return n}function $p(n,e){throw n=Object.prototype.toString.call(e),Error(oe(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function z4(n){var e=n._init;return e(n._payload)}function v6(n){function e(R,P){if(n){var v=R.deletions;v===null?(R.deletions=[P],R.flags|=16):v.push(P)}}function t(R,P){if(!n)return null;for(;P!==null;)e(R,P),P=P.sibling;return null}function r(R,P){for(R=new Map;P!==null;)P.key!==null?R.set(P.key,P):R.set(P.index,P),P=P.sibling;return R}function i(R,P){return R=$o(R,P),R.index=0,R.sibling=null,R}function s(R,P,v){return R.index=v,n?(v=R.alternate,v!==null?(v=v.index,v<P?(R.flags|=2,P):v):(R.flags|=2,P)):(R.flags|=1048576,P)}function o(R){return n&&R.alternate===null&&(R.flags|=2),R}function l(R,P,v,k){return P===null||P.tag!==6?(P=fv(v,R.mode,k),P.return=R,P):(P=i(P,v),P.return=R,P)}function c(R,P,v,k){var D=v.type;return D===mu?p(R,P,v.props.children,k,v.key):P!==null&&(P.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===Ro&&z4(D)===P.type)?(k=i(P,v.props),k.ref=Th(R,P,v),k.return=R,k):(k=Eg(v.type,v.key,v.props,null,R.mode,k),k.ref=Th(R,P,v),k.return=R,k)}function h(R,P,v,k){return P===null||P.tag!==4||P.stateNode.containerInfo!==v.containerInfo||P.stateNode.implementation!==v.implementation?(P=pv(v,R.mode,k),P.return=R,P):(P=i(P,v.children||[]),P.return=R,P)}function p(R,P,v,k,D){return P===null||P.tag!==7?(P=il(v,R.mode,k,D),P.return=R,P):(P=i(P,v),P.return=R,P)}function m(R,P,v){if(typeof P=="string"&&P!==""||typeof P=="number")return P=fv(""+P,R.mode,v),P.return=R,P;if(typeof P=="object"&&P!==null){switch(P.$$typeof){case Op:return v=Eg(P.type,P.key,P.props,null,R.mode,v),v.ref=Th(R,null,P),v.return=R,v;case gu:return P=pv(P,R.mode,v),P.return=R,P;case Ro:var k=P._init;return m(R,k(P._payload),v)}if(Fh(P)||vh(P))return P=il(P,R.mode,v,null),P.return=R,P;$p(R,P)}return null}function _(R,P,v,k){var D=P!==null?P.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return D!==null?null:l(R,P,""+v,k);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Op:return v.key===D?c(R,P,v,k):null;case gu:return v.key===D?h(R,P,v,k):null;case Ro:return D=v._init,_(R,P,D(v._payload),k)}if(Fh(v)||vh(v))return D!==null?null:p(R,P,v,k,null);$p(R,v)}return null}function S(R,P,v,k,D){if(typeof k=="string"&&k!==""||typeof k=="number")return R=R.get(v)||null,l(P,R,""+k,D);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Op:return R=R.get(k.key===null?v:k.key)||null,c(P,R,k,D);case gu:return R=R.get(k.key===null?v:k.key)||null,h(P,R,k,D);case Ro:var O=k._init;return S(R,P,v,O(k._payload),D)}if(Fh(k)||vh(k))return R=R.get(v)||null,p(P,R,k,D,null);$p(P,k)}return null}function E(R,P,v,k){for(var D=null,O=null,N=P,C=P=0,b=null;N!==null&&C<v.length;C++){N.index>C?(b=N,N=null):b=N.sibling;var A=_(R,N,v[C],k);if(A===null){N===null&&(N=b);break}n&&N&&A.alternate===null&&e(R,N),P=s(A,P,C),O===null?D=A:O.sibling=A,O=A,N=b}if(C===v.length)return t(R,N),xt&&Ha(R,C),D;if(N===null){for(;C<v.length;C++)N=m(R,v[C],k),N!==null&&(P=s(N,P,C),O===null?D=N:O.sibling=N,O=N);return xt&&Ha(R,C),D}for(N=r(R,N);C<v.length;C++)b=S(N,R,C,v[C],k),b!==null&&(n&&b.alternate!==null&&N.delete(b.key===null?C:b.key),P=s(b,P,C),O===null?D=b:O.sibling=b,O=b);return n&&N.forEach(function(L){return e(R,L)}),xt&&Ha(R,C),D}function x(R,P,v,k){var D=vh(v);if(typeof D!="function")throw Error(oe(150));if(v=D.call(v),v==null)throw Error(oe(151));for(var O=D=null,N=P,C=P=0,b=null,A=v.next();N!==null&&!A.done;C++,A=v.next()){N.index>C?(b=N,N=null):b=N.sibling;var L=_(R,N,A.value,k);if(L===null){N===null&&(N=b);break}n&&N&&L.alternate===null&&e(R,N),P=s(L,P,C),O===null?D=L:O.sibling=L,O=L,N=b}if(A.done)return t(R,N),xt&&Ha(R,C),D;if(N===null){for(;!A.done;C++,A=v.next())A=m(R,A.value,k),A!==null&&(P=s(A,P,C),O===null?D=A:O.sibling=A,O=A);return xt&&Ha(R,C),D}for(N=r(R,N);!A.done;C++,A=v.next())A=S(N,R,C,A.value,k),A!==null&&(n&&A.alternate!==null&&N.delete(A.key===null?C:A.key),P=s(A,P,C),O===null?D=A:O.sibling=A,O=A);return n&&N.forEach(function(B){return e(R,B)}),xt&&Ha(R,C),D}function M(R,P,v,k){if(typeof v=="object"&&v!==null&&v.type===mu&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Op:e:{for(var D=v.key,O=P;O!==null;){if(O.key===D){if(D=v.type,D===mu){if(O.tag===7){t(R,O.sibling),P=i(O,v.props.children),P.return=R,R=P;break e}}else if(O.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===Ro&&z4(D)===O.type){t(R,O.sibling),P=i(O,v.props),P.ref=Th(R,O,v),P.return=R,R=P;break e}t(R,O);break}else e(R,O);O=O.sibling}v.type===mu?(P=il(v.props.children,R.mode,k,v.key),P.return=R,R=P):(k=Eg(v.type,v.key,v.props,null,R.mode,k),k.ref=Th(R,P,v),k.return=R,R=k)}return o(R);case gu:e:{for(O=v.key;P!==null;){if(P.key===O)if(P.tag===4&&P.stateNode.containerInfo===v.containerInfo&&P.stateNode.implementation===v.implementation){t(R,P.sibling),P=i(P,v.children||[]),P.return=R,R=P;break e}else{t(R,P);break}else e(R,P);P=P.sibling}P=pv(v,R.mode,k),P.return=R,R=P}return o(R);case Ro:return O=v._init,M(R,P,O(v._payload),k)}if(Fh(v))return E(R,P,v,k);if(vh(v))return x(R,P,v,k);$p(R,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,P!==null&&P.tag===6?(t(R,P.sibling),P=i(P,v),P.return=R,R=P):(t(R,P),P=fv(v,R.mode,k),P.return=R,R=P),o(R)):t(R,P)}return M}var $u=v6(!0),w6=v6(!1),Kg=ha(null),Qg=null,Tu=null,hw=null;function dw(){hw=Tu=Qg=null}function fw(n){var e=Kg.current;Pt(Kg),n._currentValue=e}function C1(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function Du(n,e){Qg=n,hw=Tu=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Dr=!0),n.firstContext=null)}function ci(n){var e=n._currentValue;if(hw!==n)if(n={context:n,memoizedValue:e,next:null},Tu===null){if(Qg===null)throw Error(oe(308));Tu=n,Qg.dependencies={lanes:0,firstContext:n}}else Tu=Tu.next=n;return e}var Xa=null;function pw(n){Xa===null?Xa=[n]:Xa.push(n)}function E6(n,e,t,r){var i=e.interleaved;return i===null?(t.next=t,pw(e)):(t.next=i.next,i.next=t),e.interleaved=t,Ks(n,r)}function Ks(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var xo=!1;function gw(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function S6(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function zs(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Go(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,tt&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Ks(n,t)}return i=r.interleaved,i===null?(e.next=e,pw(r)):(e.next=i.next,i.next=e),r.interleaved=e,Ks(n,t)}function gg(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,ew(n,t)}}function j4(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var i=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?i=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?i=s=e:s=s.next=e}else i=s=e;t={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Yg(n,e,t,r){var i=n.updateQueue;xo=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,h=c.next;c.next=null,o===null?s=h:o.next=h,o=c;var p=n.alternate;p!==null&&(p=p.updateQueue,l=p.lastBaseUpdate,l!==o&&(l===null?p.firstBaseUpdate=h:l.next=h,p.lastBaseUpdate=c))}if(s!==null){var m=i.baseState;o=0,p=h=c=null,l=s;do{var _=l.lane,S=l.eventTime;if((r&_)===_){p!==null&&(p=p.next={eventTime:S,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var E=n,x=l;switch(_=e,S=t,x.tag){case 1:if(E=x.payload,typeof E=="function"){m=E.call(S,m,_);break e}m=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=x.payload,_=typeof E=="function"?E.call(S,m,_):E,_==null)break e;m=Ft({},m,_);break e;case 2:xo=!0}}l.callback!==null&&l.lane!==0&&(n.flags|=64,_=i.effects,_===null?i.effects=[l]:_.push(l))}else S={eventTime:S,lane:_,tag:l.tag,payload:l.payload,callback:l.callback,next:null},p===null?(h=p=S,c=m):p=p.next=S,o|=_;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;_=l,l=_.next,_.next=null,i.lastBaseUpdate=_,i.shared.pending=null}}while(!0);if(p===null&&(c=m),i.baseState=c,i.firstBaseUpdate=h,i.lastBaseUpdate=p,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);ul|=o,n.lanes=o,n.memoizedState=m}}function G4(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],i=r.callback;if(i!==null){if(r.callback=null,r=t,typeof i!="function")throw Error(oe(191,i));i.call(r)}}}var of={},os=ha(of),kd=ha(of),Pd=ha(of);function Ja(n){if(n===of)throw Error(oe(174));return n}function mw(n,e){switch(Tt(Pd,e),Tt(kd,n),Tt(os,of),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:r1(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=r1(e,n)}Pt(os),Tt(os,e)}function qu(){Pt(os),Pt(kd),Pt(Pd)}function C6(n){Ja(Pd.current);var e=Ja(os.current),t=r1(e,n.type);e!==t&&(Tt(kd,n),Tt(os,t))}function _w(n){kd.current===n&&(Pt(os),Pt(kd))}var Dt=ha(0);function Xg(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var av=[];function yw(){for(var n=0;n<av.length;n++)av[n]._workInProgressVersionPrimary=null;av.length=0}var mg=to.ReactCurrentDispatcher,lv=to.ReactCurrentBatchConfig,ll=0,Lt=null,un=null,Cn=null,Jg=!1,Jh=!1,Rd=0,RN=0;function tr(){throw Error(oe(321))}function vw(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Oi(n[t],e[t]))return!1;return!0}function ww(n,e,t,r,i,s){if(ll=s,Lt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,mg.current=n===null||n.memoizedState===null?bN:DN,n=t(r,i),Jh){s=0;do{if(Jh=!1,Rd=0,25<=s)throw Error(oe(301));s+=1,Cn=un=null,e.updateQueue=null,mg.current=MN,n=t(r,i)}while(Jh)}if(mg.current=Zg,e=un!==null&&un.next!==null,ll=0,Cn=un=Lt=null,Jg=!1,e)throw Error(oe(300));return n}function Ew(){var n=Rd!==0;return Rd=0,n}function ts(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Cn===null?Lt.memoizedState=Cn=n:Cn=Cn.next=n,Cn}function hi(){if(un===null){var n=Lt.alternate;n=n!==null?n.memoizedState:null}else n=un.next;var e=Cn===null?Lt.memoizedState:Cn.next;if(e!==null)Cn=e,un=n;else{if(n===null)throw Error(oe(310));un=n,n={memoizedState:un.memoizedState,baseState:un.baseState,baseQueue:un.baseQueue,queue:un.queue,next:null},Cn===null?Lt.memoizedState=Cn=n:Cn=Cn.next=n}return Cn}function xd(n,e){return typeof e=="function"?e(n):e}function uv(n){var e=hi(),t=e.queue;if(t===null)throw Error(oe(311));t.lastRenderedReducer=n;var r=un,i=r.baseQueue,s=t.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,t.pending=null}if(i!==null){s=i.next,r=r.baseState;var l=o=null,c=null,h=s;do{var p=h.lane;if((ll&p)===p)c!==null&&(c=c.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:n(r,h.action);else{var m={lane:p,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};c===null?(l=c=m,o=r):c=c.next=m,Lt.lanes|=p,ul|=p}h=h.next}while(h!==null&&h!==s);c===null?o=r:c.next=l,Oi(r,e.memoizedState)||(Dr=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,t.lastRenderedState=r}if(n=t.interleaved,n!==null){i=n;do s=i.lane,Lt.lanes|=s,ul|=s,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function cv(n){var e=hi(),t=e.queue;if(t===null)throw Error(oe(311));t.lastRenderedReducer=n;var r=t.dispatch,i=t.pending,s=e.memoizedState;if(i!==null){t.pending=null;var o=i=i.next;do s=n(s,o.action),o=o.next;while(o!==i);Oi(s,e.memoizedState)||(Dr=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,r]}function T6(){}function I6(n,e){var t=Lt,r=hi(),i=e(),s=!Oi(r.memoizedState,i);if(s&&(r.memoizedState=i,Dr=!0),r=r.queue,Sw(R6.bind(null,t,r,n),[n]),r.getSnapshot!==e||s||Cn!==null&&Cn.memoizedState.tag&1){if(t.flags|=2048,Ad(9,P6.bind(null,t,r,i,e),void 0,null),Rn===null)throw Error(oe(349));ll&30||k6(t,e,i)}return i}function k6(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Lt.updateQueue,e===null?(e={lastEffect:null,stores:null},Lt.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function P6(n,e,t,r){e.value=t,e.getSnapshot=r,x6(e)&&A6(n)}function R6(n,e,t){return t(function(){x6(e)&&A6(n)})}function x6(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Oi(n,t)}catch{return!0}}function A6(n){var e=Ks(n,1);e!==null&&Ni(e,n,1,-1)}function W4(n){var e=ts();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xd,lastRenderedState:n},e.queue=n,n=n.dispatch=NN.bind(null,Lt,n),[e.memoizedState,n]}function Ad(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=Lt.updateQueue,e===null?(e={lastEffect:null,stores:null},Lt.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function N6(){return hi().memoizedState}function _g(n,e,t,r){var i=ts();Lt.flags|=n,i.memoizedState=Ad(1|e,t,void 0,r===void 0?null:r)}function Jm(n,e,t,r){var i=hi();r=r===void 0?null:r;var s=void 0;if(un!==null){var o=un.memoizedState;if(s=o.destroy,r!==null&&vw(r,o.deps)){i.memoizedState=Ad(e,t,s,r);return}}Lt.flags|=n,i.memoizedState=Ad(1|e,t,s,r)}function H4(n,e){return _g(8390656,8,n,e)}function Sw(n,e){return Jm(2048,8,n,e)}function b6(n,e){return Jm(4,2,n,e)}function D6(n,e){return Jm(4,4,n,e)}function M6(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function O6(n,e,t){return t=t!=null?t.concat([n]):null,Jm(4,4,M6.bind(null,e,n),t)}function Cw(){}function L6(n,e){var t=hi();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&vw(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function F6(n,e){var t=hi();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&vw(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function V6(n,e,t){return ll&21?(Oi(t,e)||(t=GI(),Lt.lanes|=t,ul|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Dr=!0),n.memoizedState=t)}function xN(n,e){var t=ht;ht=t!==0&&4>t?t:4,n(!0);var r=lv.transition;lv.transition={};try{n(!1),e()}finally{ht=t,lv.transition=r}}function U6(){return hi().memoizedState}function AN(n,e,t){var r=Ho(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},B6(n))z6(e,t);else if(t=E6(n,e,t,r),t!==null){var i=vr();Ni(t,n,r,i),j6(t,e,r)}}function NN(n,e,t){var r=Ho(n),i={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(B6(n))z6(e,i);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,l=s(o,t);if(i.hasEagerState=!0,i.eagerState=l,Oi(l,o)){var c=e.interleaved;c===null?(i.next=i,pw(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}t=E6(n,e,i,r),t!==null&&(i=vr(),Ni(t,n,r,i),j6(t,e,r))}}function B6(n){var e=n.alternate;return n===Lt||e!==null&&e===Lt}function z6(n,e){Jh=Jg=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function j6(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,ew(n,t)}}var Zg={readContext:ci,useCallback:tr,useContext:tr,useEffect:tr,useImperativeHandle:tr,useInsertionEffect:tr,useLayoutEffect:tr,useMemo:tr,useReducer:tr,useRef:tr,useState:tr,useDebugValue:tr,useDeferredValue:tr,useTransition:tr,useMutableSource:tr,useSyncExternalStore:tr,useId:tr,unstable_isNewReconciler:!1},bN={readContext:ci,useCallback:function(n,e){return ts().memoizedState=[n,e===void 0?null:e],n},useContext:ci,useEffect:H4,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,_g(4194308,4,M6.bind(null,e,n),t)},useLayoutEffect:function(n,e){return _g(4194308,4,n,e)},useInsertionEffect:function(n,e){return _g(4,2,n,e)},useMemo:function(n,e){var t=ts();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=ts();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=AN.bind(null,Lt,n),[r.memoizedState,n]},useRef:function(n){var e=ts();return n={current:n},e.memoizedState=n},useState:W4,useDebugValue:Cw,useDeferredValue:function(n){return ts().memoizedState=n},useTransition:function(){var n=W4(!1),e=n[0];return n=xN.bind(null,n[1]),ts().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=Lt,i=ts();if(xt){if(t===void 0)throw Error(oe(407));t=t()}else{if(t=e(),Rn===null)throw Error(oe(349));ll&30||k6(r,e,t)}i.memoizedState=t;var s={value:t,getSnapshot:e};return i.queue=s,H4(R6.bind(null,r,s,n),[n]),r.flags|=2048,Ad(9,P6.bind(null,r,s,t,e),void 0,null),t},useId:function(){var n=ts(),e=Rn.identifierPrefix;if(xt){var t=Ls,r=Os;t=(r&~(1<<32-Ai(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=Rd++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=RN++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},DN={readContext:ci,useCallback:L6,useContext:ci,useEffect:Sw,useImperativeHandle:O6,useInsertionEffect:b6,useLayoutEffect:D6,useMemo:F6,useReducer:uv,useRef:N6,useState:function(){return uv(xd)},useDebugValue:Cw,useDeferredValue:function(n){var e=hi();return V6(e,un.memoizedState,n)},useTransition:function(){var n=uv(xd)[0],e=hi().memoizedState;return[n,e]},useMutableSource:T6,useSyncExternalStore:I6,useId:U6,unstable_isNewReconciler:!1},MN={readContext:ci,useCallback:L6,useContext:ci,useEffect:Sw,useImperativeHandle:O6,useInsertionEffect:b6,useLayoutEffect:D6,useMemo:F6,useReducer:cv,useRef:N6,useState:function(){return cv(xd)},useDebugValue:Cw,useDeferredValue:function(n){var e=hi();return un===null?e.memoizedState=n:V6(e,un.memoizedState,n)},useTransition:function(){var n=cv(xd)[0],e=hi().memoizedState;return[n,e]},useMutableSource:T6,useSyncExternalStore:I6,useId:U6,unstable_isNewReconciler:!1};function Ti(n,e){if(n&&n.defaultProps){e=Ft({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function T1(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:Ft({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var Zm={isMounted:function(n){return(n=n._reactInternals)?Cl(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=vr(),i=Ho(n),s=zs(r,i);s.payload=e,t!=null&&(s.callback=t),e=Go(n,s,i),e!==null&&(Ni(e,n,i,r),gg(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=vr(),i=Ho(n),s=zs(r,i);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=Go(n,s,i),e!==null&&(Ni(e,n,i,r),gg(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=vr(),r=Ho(n),i=zs(t,r);i.tag=2,e!=null&&(i.callback=e),e=Go(n,i,r),e!==null&&(Ni(e,n,r,t),gg(e,n,r))}};function $4(n,e,t,r,i,s,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Sd(t,r)||!Sd(i,s):!0}function G6(n,e,t){var r=!1,i=Zo,s=e.contextType;return typeof s=="object"&&s!==null?s=ci(s):(i=Fr(e)?ol:ur.current,r=e.contextTypes,s=(r=r!=null)?Wu(n,i):Zo),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Zm,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=s),e}function q4(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&Zm.enqueueReplaceState(e,e.state,null)}function I1(n,e,t,r){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},gw(n);var s=e.contextType;typeof s=="object"&&s!==null?i.context=ci(s):(s=Fr(e)?ol:ur.current,i.context=Wu(n,s)),i.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(T1(n,e,s,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Zm.enqueueReplaceState(i,i.state,null),Yg(n,t,i,r),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function Ku(n,e){try{var t="",r=e;do t+=l8(r),r=r.return;while(r);var i=t}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:i,digest:null}}function hv(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function k1(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var ON=typeof WeakMap=="function"?WeakMap:Map;function W6(n,e,t){t=zs(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){tm||(tm=!0,L1=r),k1(n,e)},t}function H6(n,e,t){t=zs(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;t.payload=function(){return r(i)},t.callback=function(){k1(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){k1(n,e),typeof r!="function"&&(Wo===null?Wo=new Set([this]):Wo.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function K4(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new ON;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(t)||(i.add(t),n=QN.bind(null,n,e,t),e.then(n,n))}function Q4(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function Y4(n,e,t,r,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=zs(-1,1),e.tag=2,Go(t,e,1))),t.lanes|=1),n)}var LN=to.ReactCurrentOwner,Dr=!1;function _r(n,e,t,r){e.child=n===null?w6(e,null,t,r):$u(e,n.child,t,r)}function X4(n,e,t,r,i){t=t.render;var s=e.ref;return Du(e,i),r=ww(n,e,t,r,s,i),t=Ew(),n!==null&&!Dr?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Qs(n,e,i)):(xt&&t&&lw(e),e.flags|=1,_r(n,e,r,i),e.child)}function J4(n,e,t,r,i){if(n===null){var s=t.type;return typeof s=="function"&&!Nw(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,$6(n,e,s,r,i)):(n=Eg(t.type,null,r,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&i)){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:Sd,t(o,r)&&n.ref===e.ref)return Qs(n,e,i)}return e.flags|=1,n=$o(s,r),n.ref=e.ref,n.return=e,e.child=n}function $6(n,e,t,r,i){if(n!==null){var s=n.memoizedProps;if(Sd(s,r)&&n.ref===e.ref)if(Dr=!1,e.pendingProps=r=s,(n.lanes&i)!==0)n.flags&131072&&(Dr=!0);else return e.lanes=n.lanes,Qs(n,e,i)}return P1(n,e,t,r,i)}function q6(n,e,t){var r=e.pendingProps,i=r.children,s=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Tt(ku,zr),zr|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Tt(ku,zr),zr|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:t,Tt(ku,zr),zr|=r}else s!==null?(r=s.baseLanes|t,e.memoizedState=null):r=t,Tt(ku,zr),zr|=r;return _r(n,e,i,t),e.child}function K6(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function P1(n,e,t,r,i){var s=Fr(t)?ol:ur.current;return s=Wu(e,s),Du(e,i),t=ww(n,e,t,r,s,i),r=Ew(),n!==null&&!Dr?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Qs(n,e,i)):(xt&&r&&lw(e),e.flags|=1,_r(n,e,t,i),e.child)}function Z4(n,e,t,r,i){if(Fr(t)){var s=!0;Hg(e)}else s=!1;if(Du(e,i),e.stateNode===null)yg(n,e),G6(e,t,r),I1(e,t,r,i),r=!0;else if(n===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,h=t.contextType;typeof h=="object"&&h!==null?h=ci(h):(h=Fr(t)?ol:ur.current,h=Wu(e,h));var p=t.getDerivedStateFromProps,m=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==h)&&q4(e,o,r,h),xo=!1;var _=e.memoizedState;o.state=_,Yg(e,r,o,i),c=e.memoizedState,l!==r||_!==c||Lr.current||xo?(typeof p=="function"&&(T1(e,t,p,r),c=e.memoizedState),(l=xo||$4(e,t,l,r,_,c,h))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=h,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,S6(n,e),l=e.memoizedProps,h=e.type===e.elementType?l:Ti(e.type,l),o.props=h,m=e.pendingProps,_=o.context,c=t.contextType,typeof c=="object"&&c!==null?c=ci(c):(c=Fr(t)?ol:ur.current,c=Wu(e,c));var S=t.getDerivedStateFromProps;(p=typeof S=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==m||_!==c)&&q4(e,o,r,c),xo=!1,_=e.memoizedState,o.state=_,Yg(e,r,o,i);var E=e.memoizedState;l!==m||_!==E||Lr.current||xo?(typeof S=="function"&&(T1(e,t,S,r),E=e.memoizedState),(h=xo||$4(e,t,h,r,_,E,c)||!1)?(p||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,E,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,E,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===n.memoizedProps&&_===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&_===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=E),o.props=r,o.state=E,o.context=c,r=h):(typeof o.componentDidUpdate!="function"||l===n.memoizedProps&&_===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&_===n.memoizedState||(e.flags|=1024),r=!1)}return R1(n,e,t,r,s,i)}function R1(n,e,t,r,i,s){K6(n,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&V4(e,t,!1),Qs(n,e,s);r=e.stateNode,LN.current=e;var l=o&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&o?(e.child=$u(e,n.child,null,s),e.child=$u(e,null,l,s)):_r(n,e,l,s),e.memoizedState=r.state,i&&V4(e,t,!0),e.child}function Q6(n){var e=n.stateNode;e.pendingContext?F4(n,e.pendingContext,e.pendingContext!==e.context):e.context&&F4(n,e.context,!1),mw(n,e.containerInfo)}function eT(n,e,t,r,i){return Hu(),cw(i),e.flags|=256,_r(n,e,t,r),e.child}var x1={dehydrated:null,treeContext:null,retryLane:0};function A1(n){return{baseLanes:n,cachePool:null,transitions:null}}function Y6(n,e,t){var r=e.pendingProps,i=Dt.current,s=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=n!==null&&n.memoizedState===null?!1:(i&2)!==0),l?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),Tt(Dt,i&1),n===null)return S1(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,n=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=n0(o,r,0,null),n=il(n,r,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=A1(t),e.memoizedState=x1,n):Tw(e,o));if(i=n.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return FN(n,e,o,r,l,i,t);if(s){s=r.fallback,o=e.mode,i=n.child,l=i.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=$o(i,c),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=$o(l,s):(s=il(s,o,t,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=n.child.memoizedState,o=o===null?A1(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=n.childLanes&~t,e.memoizedState=x1,r}return s=n.child,n=s.sibling,r=$o(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function Tw(n,e){return e=n0({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function qp(n,e,t,r){return r!==null&&cw(r),$u(e,n.child,null,t),n=Tw(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function FN(n,e,t,r,i,s,o){if(t)return e.flags&256?(e.flags&=-257,r=hv(Error(oe(422))),qp(n,e,o,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=n0({mode:"visible",children:r.children},i,0,null),s=il(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&$u(e,n.child,null,o),e.child.memoizedState=A1(o),e.memoizedState=x1,s);if(!(e.mode&1))return qp(n,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error(oe(419)),r=hv(s,r,void 0),qp(n,e,o,r)}if(l=(o&n.childLanes)!==0,Dr||l){if(r=Rn,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Ks(n,i),Ni(r,n,i,-1))}return Aw(),r=hv(Error(oe(421))),qp(n,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=YN.bind(null,n),i._reactRetry=e,null):(n=s.treeContext,jr=jo(i.nextSibling),Wr=e,xt=!0,ki=null,n!==null&&(ii[si++]=Os,ii[si++]=Ls,ii[si++]=al,Os=n.id,Ls=n.overflow,al=e),e=Tw(e,r.children),e.flags|=4096,e)}function tT(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),C1(n.return,e,t)}function dv(n,e,t,r,i){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=t,s.tailMode=i)}function X6(n,e,t){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(_r(n,e,r.children,t),r=Dt.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&tT(n,t,e);else if(n.tag===19)tT(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(Tt(Dt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&Xg(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),dv(e,!1,i,t,s);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&Xg(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}dv(e,!0,t,null,s);break;case"together":dv(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function yg(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Qs(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),ul|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(oe(153));if(e.child!==null){for(n=e.child,t=$o(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=$o(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function VN(n,e,t){switch(e.tag){case 3:Q6(e),Hu();break;case 5:C6(e);break;case 1:Fr(e.type)&&Hg(e);break;case 4:mw(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Tt(Kg,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Tt(Dt,Dt.current&1),e.flags|=128,null):t&e.child.childLanes?Y6(n,e,t):(Tt(Dt,Dt.current&1),n=Qs(n,e,t),n!==null?n.sibling:null);Tt(Dt,Dt.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return X6(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Tt(Dt,Dt.current),r)break;return null;case 22:case 23:return e.lanes=0,q6(n,e,t)}return Qs(n,e,t)}var J6,N1,Z6,ek;J6=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};N1=function(){};Z6=function(n,e,t,r){var i=n.memoizedProps;if(i!==r){n=e.stateNode,Ja(os.current);var s=null;switch(t){case"input":i=Zv(n,i),r=Zv(n,r),s=[];break;case"select":i=Ft({},i,{value:void 0}),r=Ft({},r,{value:void 0}),s=[];break;case"textarea":i=n1(n,i),r=n1(n,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=Gg)}i1(t,r);var o;t=null;for(h in i)if(!r.hasOwnProperty(h)&&i.hasOwnProperty(h)&&i[h]!=null)if(h==="style"){var l=i[h];for(o in l)l.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(gd.hasOwnProperty(h)?s||(s=[]):(s=s||[]).push(h,null));for(h in r){var c=r[h];if(l=i!=null?i[h]:void 0,r.hasOwnProperty(h)&&c!==l&&(c!=null||l!=null))if(h==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(t||(t={}),t[o]=c[o])}else t||(s||(s=[]),s.push(h,t)),t=c;else h==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(h,c)):h==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(h,""+c):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(gd.hasOwnProperty(h)?(c!=null&&h==="onScroll"&&kt("scroll",n),s||l===c||(s=[])):(s=s||[]).push(h,c))}t&&(s=s||[]).push("style",t);var h=s;(e.updateQueue=h)&&(e.flags|=4)}};ek=function(n,e,t,r){t!==r&&(e.flags|=4)};function Ih(n,e){if(!xt)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function nr(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function UN(n,e,t){var r=e.pendingProps;switch(uw(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nr(e),null;case 1:return Fr(e.type)&&Wg(),nr(e),null;case 3:return r=e.stateNode,qu(),Pt(Lr),Pt(ur),yw(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(Hp(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ki!==null&&(U1(ki),ki=null))),N1(n,e),nr(e),null;case 5:_w(e);var i=Ja(Pd.current);if(t=e.type,n!==null&&e.stateNode!=null)Z6(n,e,t,r,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(oe(166));return nr(e),null}if(n=Ja(os.current),Hp(e)){r=e.stateNode,t=e.type;var s=e.memoizedProps;switch(r[ns]=e,r[Id]=s,n=(e.mode&1)!==0,t){case"dialog":kt("cancel",r),kt("close",r);break;case"iframe":case"object":case"embed":kt("load",r);break;case"video":case"audio":for(i=0;i<Uh.length;i++)kt(Uh[i],r);break;case"source":kt("error",r);break;case"img":case"image":case"link":kt("error",r),kt("load",r);break;case"details":kt("toggle",r);break;case"input":c4(r,s),kt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},kt("invalid",r);break;case"textarea":d4(r,s),kt("invalid",r)}i1(t,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&Wp(r.textContent,l,n),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&Wp(r.textContent,l,n),i=["children",""+l]):gd.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&kt("scroll",r)}switch(t){case"input":Lp(r),h4(r,s,!0);break;case"textarea":Lp(r),f4(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Gg)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=RI(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=o.createElement(t,{is:r.is}):(n=o.createElement(t),t==="select"&&(o=n,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):n=o.createElementNS(n,t),n[ns]=e,n[Id]=r,J6(n,e,!1,!1),e.stateNode=n;e:{switch(o=s1(t,r),t){case"dialog":kt("cancel",n),kt("close",n),i=r;break;case"iframe":case"object":case"embed":kt("load",n),i=r;break;case"video":case"audio":for(i=0;i<Uh.length;i++)kt(Uh[i],n);i=r;break;case"source":kt("error",n),i=r;break;case"img":case"image":case"link":kt("error",n),kt("load",n),i=r;break;case"details":kt("toggle",n),i=r;break;case"input":c4(n,r),i=Zv(n,r),kt("invalid",n);break;case"option":i=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},i=Ft({},r,{value:void 0}),kt("invalid",n);break;case"textarea":d4(n,r),i=n1(n,r),kt("invalid",n);break;default:i=r}i1(t,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?NI(n,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&xI(n,c)):s==="children"?typeof c=="string"?(t!=="textarea"||c!=="")&&md(n,c):typeof c=="number"&&md(n,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(gd.hasOwnProperty(s)?c!=null&&s==="onScroll"&&kt("scroll",n):c!=null&&K2(n,s,c,o))}switch(t){case"input":Lp(n),h4(n,r,!1);break;case"textarea":Lp(n),f4(n);break;case"option":r.value!=null&&n.setAttribute("value",""+Jo(r.value));break;case"select":n.multiple=!!r.multiple,s=r.value,s!=null?xu(n,!!r.multiple,s,!1):r.defaultValue!=null&&xu(n,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=Gg)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return nr(e),null;case 6:if(n&&e.stateNode!=null)ek(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(oe(166));if(t=Ja(Pd.current),Ja(os.current),Hp(e)){if(r=e.stateNode,t=e.memoizedProps,r[ns]=e,(s=r.nodeValue!==t)&&(n=Wr,n!==null))switch(n.tag){case 3:Wp(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Wp(r.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[ns]=e,e.stateNode=r}return nr(e),null;case 13:if(Pt(Dt),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(xt&&jr!==null&&e.mode&1&&!(e.flags&128))y6(),Hu(),e.flags|=98560,s=!1;else if(s=Hp(e),r!==null&&r.dehydrated!==null){if(n===null){if(!s)throw Error(oe(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(oe(317));s[ns]=e}else Hu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;nr(e),s=!1}else ki!==null&&(U1(ki),ki=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||Dt.current&1?cn===0&&(cn=3):Aw())),e.updateQueue!==null&&(e.flags|=4),nr(e),null);case 4:return qu(),N1(n,e),n===null&&Cd(e.stateNode.containerInfo),nr(e),null;case 10:return fw(e.type._context),nr(e),null;case 17:return Fr(e.type)&&Wg(),nr(e),null;case 19:if(Pt(Dt),s=e.memoizedState,s===null)return nr(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Ih(s,!1);else{if(cn!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=Xg(n),o!==null){for(e.flags|=128,Ih(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)s=t,n=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,n=o.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Tt(Dt,Dt.current&1|2),e.child}n=n.sibling}s.tail!==null&&qt()>Qu&&(e.flags|=128,r=!0,Ih(s,!1),e.lanes=4194304)}else{if(!r)if(n=Xg(o),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Ih(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!xt)return nr(e),null}else 2*qt()-s.renderingStartTime>Qu&&t!==1073741824&&(e.flags|=128,r=!0,Ih(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(t=s.last,t!==null?t.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=qt(),e.sibling=null,t=Dt.current,Tt(Dt,r?t&1|2:t&1),e):(nr(e),null);case 22:case 23:return xw(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?zr&1073741824&&(nr(e),e.subtreeFlags&6&&(e.flags|=8192)):nr(e),null;case 24:return null;case 25:return null}throw Error(oe(156,e.tag))}function BN(n,e){switch(uw(e),e.tag){case 1:return Fr(e.type)&&Wg(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return qu(),Pt(Lr),Pt(ur),yw(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return _w(e),null;case 13:if(Pt(Dt),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(oe(340));Hu()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Pt(Dt),null;case 4:return qu(),null;case 10:return fw(e.type._context),null;case 22:case 23:return xw(),null;case 24:return null;default:return null}}var Kp=!1,sr=!1,zN=typeof WeakSet=="function"?WeakSet:Set,me=null;function Iu(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){zt(n,e,r)}else t.current=null}function b1(n,e,t){try{t()}catch(r){zt(n,e,r)}}var nT=!1;function jN(n,e){if(g1=Bg,n=s6(),aw(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,l=-1,c=-1,h=0,p=0,m=n,_=null;t:for(;;){for(var S;m!==t||i!==0&&m.nodeType!==3||(l=o+i),m!==s||r!==0&&m.nodeType!==3||(c=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(S=m.firstChild)!==null;)_=m,m=S;for(;;){if(m===n)break t;if(_===t&&++h===i&&(l=o),_===s&&++p===r&&(c=o),(S=m.nextSibling)!==null)break;m=_,_=m.parentNode}m=S}t=l===-1||c===-1?null:{start:l,end:c}}else t=null}t=t||{start:0,end:0}}else t=null;for(m1={focusedElem:n,selectionRange:t},Bg=!1,me=e;me!==null;)if(e=me,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,me=n;else for(;me!==null;){e=me;try{var E=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var x=E.memoizedProps,M=E.memoizedState,R=e.stateNode,P=R.getSnapshotBeforeUpdate(e.elementType===e.type?x:Ti(e.type,x),M);R.__reactInternalSnapshotBeforeUpdate=P}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(oe(163))}}catch(k){zt(e,e.return,k)}if(n=e.sibling,n!==null){n.return=e.return,me=n;break}me=e.return}return E=nT,nT=!1,E}function Zh(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&n)===n){var s=i.destroy;i.destroy=void 0,s!==void 0&&b1(e,t,s)}i=i.next}while(i!==r)}}function e0(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function D1(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function tk(n){var e=n.alternate;e!==null&&(n.alternate=null,tk(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[ns],delete e[Id],delete e[v1],delete e[TN],delete e[IN])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function nk(n){return n.tag===5||n.tag===3||n.tag===4}function rT(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||nk(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function M1(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Gg));else if(r!==4&&(n=n.child,n!==null))for(M1(n,e,t),n=n.sibling;n!==null;)M1(n,e,t),n=n.sibling}function O1(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(O1(n,e,t),n=n.sibling;n!==null;)O1(n,e,t),n=n.sibling}var Vn=null,Ii=!1;function To(n,e,t){for(t=t.child;t!==null;)rk(n,e,t),t=t.sibling}function rk(n,e,t){if(ss&&typeof ss.onCommitFiberUnmount=="function")try{ss.onCommitFiberUnmount($m,t)}catch{}switch(t.tag){case 5:sr||Iu(t,e);case 6:var r=Vn,i=Ii;Vn=null,To(n,e,t),Vn=r,Ii=i,Vn!==null&&(Ii?(n=Vn,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):Vn.removeChild(t.stateNode));break;case 18:Vn!==null&&(Ii?(n=Vn,t=t.stateNode,n.nodeType===8?sv(n.parentNode,t):n.nodeType===1&&sv(n,t),wd(n)):sv(Vn,t.stateNode));break;case 4:r=Vn,i=Ii,Vn=t.stateNode.containerInfo,Ii=!0,To(n,e,t),Vn=r,Ii=i;break;case 0:case 11:case 14:case 15:if(!sr&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&b1(t,e,o),i=i.next}while(i!==r)}To(n,e,t);break;case 1:if(!sr&&(Iu(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(l){zt(t,e,l)}To(n,e,t);break;case 21:To(n,e,t);break;case 22:t.mode&1?(sr=(r=sr)||t.memoizedState!==null,To(n,e,t),sr=r):To(n,e,t);break;default:To(n,e,t)}}function iT(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new zN),e.forEach(function(r){var i=XN.bind(null,n,r);t.has(r)||(t.add(r),r.then(i,i))})}}function Si(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];try{var s=n,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Vn=l.stateNode,Ii=!1;break e;case 3:Vn=l.stateNode.containerInfo,Ii=!0;break e;case 4:Vn=l.stateNode.containerInfo,Ii=!0;break e}l=l.return}if(Vn===null)throw Error(oe(160));rk(s,o,i),Vn=null,Ii=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(h){zt(i,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ik(e,n),e=e.sibling}function ik(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Si(e,n),es(n),r&4){try{Zh(3,n,n.return),e0(3,n)}catch(x){zt(n,n.return,x)}try{Zh(5,n,n.return)}catch(x){zt(n,n.return,x)}}break;case 1:Si(e,n),es(n),r&512&&t!==null&&Iu(t,t.return);break;case 5:if(Si(e,n),es(n),r&512&&t!==null&&Iu(t,t.return),n.flags&32){var i=n.stateNode;try{md(i,"")}catch(x){zt(n,n.return,x)}}if(r&4&&(i=n.stateNode,i!=null)){var s=n.memoizedProps,o=t!==null?t.memoizedProps:s,l=n.type,c=n.updateQueue;if(n.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&kI(i,s),s1(l,o);var h=s1(l,s);for(o=0;o<c.length;o+=2){var p=c[o],m=c[o+1];p==="style"?NI(i,m):p==="dangerouslySetInnerHTML"?xI(i,m):p==="children"?md(i,m):K2(i,p,m,h)}switch(l){case"input":e1(i,s);break;case"textarea":PI(i,s);break;case"select":var _=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var S=s.value;S!=null?xu(i,!!s.multiple,S,!1):_!==!!s.multiple&&(s.defaultValue!=null?xu(i,!!s.multiple,s.defaultValue,!0):xu(i,!!s.multiple,s.multiple?[]:"",!1))}i[Id]=s}catch(x){zt(n,n.return,x)}}break;case 6:if(Si(e,n),es(n),r&4){if(n.stateNode===null)throw Error(oe(162));i=n.stateNode,s=n.memoizedProps;try{i.nodeValue=s}catch(x){zt(n,n.return,x)}}break;case 3:if(Si(e,n),es(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{wd(e.containerInfo)}catch(x){zt(n,n.return,x)}break;case 4:Si(e,n),es(n);break;case 13:Si(e,n),es(n),i=n.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Pw=qt())),r&4&&iT(n);break;case 22:if(p=t!==null&&t.memoizedState!==null,n.mode&1?(sr=(h=sr)||p,Si(e,n),sr=h):Si(e,n),es(n),r&8192){if(h=n.memoizedState!==null,(n.stateNode.isHidden=h)&&!p&&n.mode&1)for(me=n,p=n.child;p!==null;){for(m=me=p;me!==null;){switch(_=me,S=_.child,_.tag){case 0:case 11:case 14:case 15:Zh(4,_,_.return);break;case 1:Iu(_,_.return);var E=_.stateNode;if(typeof E.componentWillUnmount=="function"){r=_,t=_.return;try{e=r,E.props=e.memoizedProps,E.state=e.memoizedState,E.componentWillUnmount()}catch(x){zt(r,t,x)}}break;case 5:Iu(_,_.return);break;case 22:if(_.memoizedState!==null){oT(m);continue}}S!==null?(S.return=_,me=S):oT(m)}p=p.sibling}e:for(p=null,m=n;;){if(m.tag===5){if(p===null){p=m;try{i=m.stateNode,h?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=m.stateNode,c=m.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=AI("display",o))}catch(x){zt(n,n.return,x)}}}else if(m.tag===6){if(p===null)try{m.stateNode.nodeValue=h?"":m.memoizedProps}catch(x){zt(n,n.return,x)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===n)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===n)break e;for(;m.sibling===null;){if(m.return===null||m.return===n)break e;p===m&&(p=null),m=m.return}p===m&&(p=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Si(e,n),es(n),r&4&&iT(n);break;case 21:break;default:Si(e,n),es(n)}}function es(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(nk(t)){var r=t;break e}t=t.return}throw Error(oe(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(md(i,""),r.flags&=-33);var s=rT(n);O1(n,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,l=rT(n);M1(n,l,o);break;default:throw Error(oe(161))}}catch(c){zt(n,n.return,c)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function GN(n,e,t){me=n,sk(n)}function sk(n,e,t){for(var r=(n.mode&1)!==0;me!==null;){var i=me,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Kp;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||sr;l=Kp;var h=sr;if(Kp=o,(sr=c)&&!h)for(me=i;me!==null;)o=me,c=o.child,o.tag===22&&o.memoizedState!==null?aT(i):c!==null?(c.return=o,me=c):aT(i);for(;s!==null;)me=s,sk(s),s=s.sibling;me=i,Kp=l,sr=h}sT(n)}else i.subtreeFlags&8772&&s!==null?(s.return=i,me=s):sT(n)}}function sT(n){for(;me!==null;){var e=me;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:sr||e0(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!sr)if(t===null)r.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:Ti(e.type,t.memoizedProps);r.componentDidUpdate(i,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&G4(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}G4(e,o,t)}break;case 5:var l=e.stateNode;if(t===null&&e.flags&4){t=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&t.focus();break;case"img":c.src&&(t.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var p=h.memoizedState;if(p!==null){var m=p.dehydrated;m!==null&&wd(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(oe(163))}sr||e.flags&512&&D1(e)}catch(_){zt(e,e.return,_)}}if(e===n){me=null;break}if(t=e.sibling,t!==null){t.return=e.return,me=t;break}me=e.return}}function oT(n){for(;me!==null;){var e=me;if(e===n){me=null;break}var t=e.sibling;if(t!==null){t.return=e.return,me=t;break}me=e.return}}function aT(n){for(;me!==null;){var e=me;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{e0(4,e)}catch(c){zt(e,t,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(c){zt(e,i,c)}}var s=e.return;try{D1(e)}catch(c){zt(e,s,c)}break;case 5:var o=e.return;try{D1(e)}catch(c){zt(e,o,c)}}}catch(c){zt(e,e.return,c)}if(e===n){me=null;break}var l=e.sibling;if(l!==null){l.return=e.return,me=l;break}me=e.return}}var WN=Math.ceil,em=to.ReactCurrentDispatcher,Iw=to.ReactCurrentOwner,li=to.ReactCurrentBatchConfig,tt=0,Rn=null,en=null,Bn=0,zr=0,ku=ha(0),cn=0,Nd=null,ul=0,t0=0,kw=0,ed=null,br=null,Pw=0,Qu=1/0,bs=null,tm=!1,L1=null,Wo=null,Qp=!1,Lo=null,nm=0,td=0,F1=null,vg=-1,wg=0;function vr(){return tt&6?qt():vg!==-1?vg:vg=qt()}function Ho(n){return n.mode&1?tt&2&&Bn!==0?Bn&-Bn:PN.transition!==null?(wg===0&&(wg=GI()),wg):(n=ht,n!==0||(n=window.event,n=n===void 0?16:YI(n.type)),n):1}function Ni(n,e,t,r){if(50<td)throw td=0,F1=null,Error(oe(185));nf(n,t,r),(!(tt&2)||n!==Rn)&&(n===Rn&&(!(tt&2)&&(t0|=t),cn===4&&No(n,Bn)),Vr(n,r),t===1&&tt===0&&!(e.mode&1)&&(Qu=qt()+500,Xm&&da()))}function Vr(n,e){var t=n.callbackNode;P8(n,e);var r=Ug(n,n===Rn?Bn:0);if(r===0)t!==null&&m4(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&m4(t),e===1)n.tag===0?kN(lT.bind(null,n)):g6(lT.bind(null,n)),SN(function(){!(tt&6)&&da()}),t=null;else{switch(WI(r)){case 1:t=Z2;break;case 4:t=zI;break;case 16:t=Vg;break;case 536870912:t=jI;break;default:t=Vg}t=fk(t,ok.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function ok(n,e){if(vg=-1,wg=0,tt&6)throw Error(oe(327));var t=n.callbackNode;if(Mu()&&n.callbackNode!==t)return null;var r=Ug(n,n===Rn?Bn:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=rm(n,r);else{e=r;var i=tt;tt|=2;var s=lk();(Rn!==n||Bn!==e)&&(bs=null,Qu=qt()+500,rl(n,e));do try{qN();break}catch(l){ak(n,l)}while(!0);dw(),em.current=s,tt=i,en!==null?e=0:(Rn=null,Bn=0,e=cn)}if(e!==0){if(e===2&&(i=c1(n),i!==0&&(r=i,e=V1(n,i))),e===1)throw t=Nd,rl(n,0),No(n,r),Vr(n,qt()),t;if(e===6)No(n,r);else{if(i=n.current.alternate,!(r&30)&&!HN(i)&&(e=rm(n,r),e===2&&(s=c1(n),s!==0&&(r=s,e=V1(n,s))),e===1))throw t=Nd,rl(n,0),No(n,r),Vr(n,qt()),t;switch(n.finishedWork=i,n.finishedLanes=r,e){case 0:case 1:throw Error(oe(345));case 2:$a(n,br,bs);break;case 3:if(No(n,r),(r&130023424)===r&&(e=Pw+500-qt(),10<e)){if(Ug(n,0)!==0)break;if(i=n.suspendedLanes,(i&r)!==r){vr(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=y1($a.bind(null,n,br,bs),e);break}$a(n,br,bs);break;case 4:if(No(n,r),(r&4194240)===r)break;for(e=n.eventTimes,i=-1;0<r;){var o=31-Ai(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=qt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*WN(r/1960))-r,10<r){n.timeoutHandle=y1($a.bind(null,n,br,bs),r);break}$a(n,br,bs);break;case 5:$a(n,br,bs);break;default:throw Error(oe(329))}}}return Vr(n,qt()),n.callbackNode===t?ok.bind(null,n):null}function V1(n,e){var t=ed;return n.current.memoizedState.isDehydrated&&(rl(n,e).flags|=256),n=rm(n,e),n!==2&&(e=br,br=t,e!==null&&U1(e)),n}function U1(n){br===null?br=n:br.push.apply(br,n)}function HN(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var i=t[r],s=i.getSnapshot;i=i.value;try{if(!Oi(s(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function No(n,e){for(e&=~kw,e&=~t0,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Ai(e),r=1<<t;n[t]=-1,e&=~r}}function lT(n){if(tt&6)throw Error(oe(327));Mu();var e=Ug(n,0);if(!(e&1))return Vr(n,qt()),null;var t=rm(n,e);if(n.tag!==0&&t===2){var r=c1(n);r!==0&&(e=r,t=V1(n,r))}if(t===1)throw t=Nd,rl(n,0),No(n,e),Vr(n,qt()),t;if(t===6)throw Error(oe(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,$a(n,br,bs),Vr(n,qt()),null}function Rw(n,e){var t=tt;tt|=1;try{return n(e)}finally{tt=t,tt===0&&(Qu=qt()+500,Xm&&da())}}function cl(n){Lo!==null&&Lo.tag===0&&!(tt&6)&&Mu();var e=tt;tt|=1;var t=li.transition,r=ht;try{if(li.transition=null,ht=1,n)return n()}finally{ht=r,li.transition=t,tt=e,!(tt&6)&&da()}}function xw(){zr=ku.current,Pt(ku)}function rl(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,EN(t)),en!==null)for(t=en.return;t!==null;){var r=t;switch(uw(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Wg();break;case 3:qu(),Pt(Lr),Pt(ur),yw();break;case 5:_w(r);break;case 4:qu();break;case 13:Pt(Dt);break;case 19:Pt(Dt);break;case 10:fw(r.type._context);break;case 22:case 23:xw()}t=t.return}if(Rn=n,en=n=$o(n.current,null),Bn=zr=e,cn=0,Nd=null,kw=t0=ul=0,br=ed=null,Xa!==null){for(e=0;e<Xa.length;e++)if(t=Xa[e],r=t.interleaved,r!==null){t.interleaved=null;var i=r.next,s=t.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}t.pending=r}Xa=null}return n}function ak(n,e){do{var t=en;try{if(dw(),mg.current=Zg,Jg){for(var r=Lt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Jg=!1}if(ll=0,Cn=un=Lt=null,Jh=!1,Rd=0,Iw.current=null,t===null||t.return===null){cn=1,Nd=e,en=null;break}e:{var s=n,o=t.return,l=t,c=e;if(e=Bn,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var h=c,p=l,m=p.tag;if(!(p.mode&1)&&(m===0||m===11||m===15)){var _=p.alternate;_?(p.updateQueue=_.updateQueue,p.memoizedState=_.memoizedState,p.lanes=_.lanes):(p.updateQueue=null,p.memoizedState=null)}var S=Q4(o);if(S!==null){S.flags&=-257,Y4(S,o,l,s,e),S.mode&1&&K4(s,h,e),e=S,c=h;var E=e.updateQueue;if(E===null){var x=new Set;x.add(c),e.updateQueue=x}else E.add(c);break e}else{if(!(e&1)){K4(s,h,e),Aw();break e}c=Error(oe(426))}}else if(xt&&l.mode&1){var M=Q4(o);if(M!==null){!(M.flags&65536)&&(M.flags|=256),Y4(M,o,l,s,e),cw(Ku(c,l));break e}}s=c=Ku(c,l),cn!==4&&(cn=2),ed===null?ed=[s]:ed.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var R=W6(s,c,e);j4(s,R);break e;case 1:l=c;var P=s.type,v=s.stateNode;if(!(s.flags&128)&&(typeof P.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Wo===null||!Wo.has(v)))){s.flags|=65536,e&=-e,s.lanes|=e;var k=H6(s,l,e);j4(s,k);break e}}s=s.return}while(s!==null)}ck(t)}catch(D){e=D,en===t&&t!==null&&(en=t=t.return);continue}break}while(!0)}function lk(){var n=em.current;return em.current=Zg,n===null?Zg:n}function Aw(){(cn===0||cn===3||cn===2)&&(cn=4),Rn===null||!(ul&268435455)&&!(t0&268435455)||No(Rn,Bn)}function rm(n,e){var t=tt;tt|=2;var r=lk();(Rn!==n||Bn!==e)&&(bs=null,rl(n,e));do try{$N();break}catch(i){ak(n,i)}while(!0);if(dw(),tt=t,em.current=r,en!==null)throw Error(oe(261));return Rn=null,Bn=0,cn}function $N(){for(;en!==null;)uk(en)}function qN(){for(;en!==null&&!y8();)uk(en)}function uk(n){var e=dk(n.alternate,n,zr);n.memoizedProps=n.pendingProps,e===null?ck(n):en=e,Iw.current=null}function ck(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=BN(t,e),t!==null){t.flags&=32767,en=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{cn=6,en=null;return}}else if(t=UN(t,e,zr),t!==null){en=t;return}if(e=e.sibling,e!==null){en=e;return}en=e=n}while(e!==null);cn===0&&(cn=5)}function $a(n,e,t){var r=ht,i=li.transition;try{li.transition=null,ht=1,KN(n,e,t,r)}finally{li.transition=i,ht=r}return null}function KN(n,e,t,r){do Mu();while(Lo!==null);if(tt&6)throw Error(oe(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(oe(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(R8(n,s),n===Rn&&(en=Rn=null,Bn=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Qp||(Qp=!0,fk(Vg,function(){return Mu(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=li.transition,li.transition=null;var o=ht;ht=1;var l=tt;tt|=4,Iw.current=null,jN(n,t),ik(t,n),pN(m1),Bg=!!g1,m1=g1=null,n.current=t,GN(t),v8(),tt=l,ht=o,li.transition=s}else n.current=t;if(Qp&&(Qp=!1,Lo=n,nm=i),s=n.pendingLanes,s===0&&(Wo=null),S8(t.stateNode),Vr(n,qt()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],r(i.value,{componentStack:i.stack,digest:i.digest});if(tm)throw tm=!1,n=L1,L1=null,n;return nm&1&&n.tag!==0&&Mu(),s=n.pendingLanes,s&1?n===F1?td++:(td=0,F1=n):td=0,da(),null}function Mu(){if(Lo!==null){var n=WI(nm),e=li.transition,t=ht;try{if(li.transition=null,ht=16>n?16:n,Lo===null)var r=!1;else{if(n=Lo,Lo=null,nm=0,tt&6)throw Error(oe(331));var i=tt;for(tt|=4,me=n.current;me!==null;){var s=me,o=s.child;if(me.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var h=l[c];for(me=h;me!==null;){var p=me;switch(p.tag){case 0:case 11:case 15:Zh(8,p,s)}var m=p.child;if(m!==null)m.return=p,me=m;else for(;me!==null;){p=me;var _=p.sibling,S=p.return;if(tk(p),p===h){me=null;break}if(_!==null){_.return=S,me=_;break}me=S}}}var E=s.alternate;if(E!==null){var x=E.child;if(x!==null){E.child=null;do{var M=x.sibling;x.sibling=null,x=M}while(x!==null)}}me=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,me=o;else e:for(;me!==null;){if(s=me,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Zh(9,s,s.return)}var R=s.sibling;if(R!==null){R.return=s.return,me=R;break e}me=s.return}}var P=n.current;for(me=P;me!==null;){o=me;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,me=v;else e:for(o=P;me!==null;){if(l=me,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:e0(9,l)}}catch(D){zt(l,l.return,D)}if(l===o){me=null;break e}var k=l.sibling;if(k!==null){k.return=l.return,me=k;break e}me=l.return}}if(tt=i,da(),ss&&typeof ss.onPostCommitFiberRoot=="function")try{ss.onPostCommitFiberRoot($m,n)}catch{}r=!0}return r}finally{ht=t,li.transition=e}}return!1}function uT(n,e,t){e=Ku(t,e),e=W6(n,e,1),n=Go(n,e,1),e=vr(),n!==null&&(nf(n,1,e),Vr(n,e))}function zt(n,e,t){if(n.tag===3)uT(n,n,t);else for(;e!==null;){if(e.tag===3){uT(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Wo===null||!Wo.has(r))){n=Ku(t,n),n=H6(e,n,1),e=Go(e,n,1),n=vr(),e!==null&&(nf(e,1,n),Vr(e,n));break}}e=e.return}}function QN(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=vr(),n.pingedLanes|=n.suspendedLanes&t,Rn===n&&(Bn&t)===t&&(cn===4||cn===3&&(Bn&130023424)===Bn&&500>qt()-Pw?rl(n,0):kw|=t),Vr(n,e)}function hk(n,e){e===0&&(n.mode&1?(e=Up,Up<<=1,!(Up&130023424)&&(Up=4194304)):e=1);var t=vr();n=Ks(n,e),n!==null&&(nf(n,e,t),Vr(n,t))}function YN(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),hk(n,t)}function XN(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(oe(314))}r!==null&&r.delete(e),hk(n,t)}var dk;dk=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Lr.current)Dr=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Dr=!1,VN(n,e,t);Dr=!!(n.flags&131072)}else Dr=!1,xt&&e.flags&1048576&&m6(e,qg,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;yg(n,e),n=e.pendingProps;var i=Wu(e,ur.current);Du(e,t),i=ww(null,e,r,n,i,t);var s=Ew();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Fr(r)?(s=!0,Hg(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,gw(e),i.updater=Zm,e.stateNode=i,i._reactInternals=e,I1(e,r,n,t),e=R1(null,e,r,!0,s,t)):(e.tag=0,xt&&s&&lw(e),_r(null,e,i,t),e=e.child),e;case 16:r=e.elementType;e:{switch(yg(n,e),n=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=ZN(r),n=Ti(r,n),i){case 0:e=P1(null,e,r,n,t);break e;case 1:e=Z4(null,e,r,n,t);break e;case 11:e=X4(null,e,r,n,t);break e;case 14:e=J4(null,e,r,Ti(r.type,n),t);break e}throw Error(oe(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ti(r,i),P1(n,e,r,i,t);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ti(r,i),Z4(n,e,r,i,t);case 3:e:{if(Q6(e),n===null)throw Error(oe(387));r=e.pendingProps,s=e.memoizedState,i=s.element,S6(n,e),Yg(e,r,null,t);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Ku(Error(oe(423)),e),e=eT(n,e,r,t,i);break e}else if(r!==i){i=Ku(Error(oe(424)),e),e=eT(n,e,r,t,i);break e}else for(jr=jo(e.stateNode.containerInfo.firstChild),Wr=e,xt=!0,ki=null,t=w6(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Hu(),r===i){e=Qs(n,e,t);break e}_r(n,e,r,t)}e=e.child}return e;case 5:return C6(e),n===null&&S1(e),r=e.type,i=e.pendingProps,s=n!==null?n.memoizedProps:null,o=i.children,_1(r,i)?o=null:s!==null&&_1(r,s)&&(e.flags|=32),K6(n,e),_r(n,e,o,t),e.child;case 6:return n===null&&S1(e),null;case 13:return Y6(n,e,t);case 4:return mw(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=$u(e,null,r,t):_r(n,e,r,t),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ti(r,i),X4(n,e,r,i,t);case 7:return _r(n,e,e.pendingProps,t),e.child;case 8:return _r(n,e,e.pendingProps.children,t),e.child;case 12:return _r(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Tt(Kg,r._currentValue),r._currentValue=o,s!==null)if(Oi(s.value,o)){if(s.children===i.children&&!Lr.current){e=Qs(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(s.tag===1){c=zs(-1,t&-t),c.tag=2;var h=s.updateQueue;if(h!==null){h=h.shared;var p=h.pending;p===null?c.next=c:(c.next=p.next,p.next=c),h.pending=c}}s.lanes|=t,c=s.alternate,c!==null&&(c.lanes|=t),C1(s.return,t,e),l.lanes|=t;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(oe(341));o.lanes|=t,l=o.alternate,l!==null&&(l.lanes|=t),C1(o,t,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}_r(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Du(e,t),i=ci(i),r=r(i),e.flags|=1,_r(n,e,r,t),e.child;case 14:return r=e.type,i=Ti(r,e.pendingProps),i=Ti(r.type,i),J4(n,e,r,i,t);case 15:return $6(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ti(r,i),yg(n,e),e.tag=1,Fr(r)?(n=!0,Hg(e)):n=!1,Du(e,t),G6(e,r,i),I1(e,r,i,t),R1(null,e,r,!0,n,t);case 19:return X6(n,e,t);case 22:return q6(n,e,t)}throw Error(oe(156,e.tag))};function fk(n,e){return BI(n,e)}function JN(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function oi(n,e,t,r){return new JN(n,e,t,r)}function Nw(n){return n=n.prototype,!(!n||!n.isReactComponent)}function ZN(n){if(typeof n=="function")return Nw(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Y2)return 11;if(n===X2)return 14}return 2}function $o(n,e){var t=n.alternate;return t===null?(t=oi(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Eg(n,e,t,r,i,s){var o=2;if(r=n,typeof n=="function")Nw(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case mu:return il(t.children,i,s,e);case Q2:o=8,i|=8;break;case Qv:return n=oi(12,t,e,i|2),n.elementType=Qv,n.lanes=s,n;case Yv:return n=oi(13,t,e,i),n.elementType=Yv,n.lanes=s,n;case Xv:return n=oi(19,t,e,i),n.elementType=Xv,n.lanes=s,n;case CI:return n0(t,i,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case EI:o=10;break e;case SI:o=9;break e;case Y2:o=11;break e;case X2:o=14;break e;case Ro:o=16,r=null;break e}throw Error(oe(130,n==null?n:typeof n,""))}return e=oi(o,t,e,i),e.elementType=n,e.type=r,e.lanes=s,e}function il(n,e,t,r){return n=oi(7,n,r,e),n.lanes=t,n}function n0(n,e,t,r){return n=oi(22,n,r,e),n.elementType=CI,n.lanes=t,n.stateNode={isHidden:!1},n}function fv(n,e,t){return n=oi(6,n,null,e),n.lanes=t,n}function pv(n,e,t){return e=oi(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function e7(n,e,t,r,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ky(0),this.expirationTimes=Ky(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ky(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function bw(n,e,t,r,i,s,o,l,c){return n=new e7(n,e,t,l,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=oi(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},gw(s),n}function t7(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:gu,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function pk(n){if(!n)return Zo;n=n._reactInternals;e:{if(Cl(n)!==n||n.tag!==1)throw Error(oe(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Fr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(oe(171))}if(n.tag===1){var t=n.type;if(Fr(t))return p6(n,t,e)}return e}function gk(n,e,t,r,i,s,o,l,c){return n=bw(t,r,!0,n,i,s,o,l,c),n.context=pk(null),t=n.current,r=vr(),i=Ho(t),s=zs(r,i),s.callback=e??null,Go(t,s,i),n.current.lanes=i,nf(n,i,r),Vr(n,r),n}function r0(n,e,t,r){var i=e.current,s=vr(),o=Ho(i);return t=pk(t),e.context===null?e.context=t:e.pendingContext=t,e=zs(s,o),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=Go(i,e,o),n!==null&&(Ni(n,i,o,s),gg(n,i,o)),o}function im(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function cT(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function Dw(n,e){cT(n,e),(n=n.alternate)&&cT(n,e)}function n7(){return null}var mk=typeof reportError=="function"?reportError:function(n){console.error(n)};function Mw(n){this._internalRoot=n}i0.prototype.render=Mw.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(oe(409));r0(n,e,null,null)};i0.prototype.unmount=Mw.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;cl(function(){r0(null,n,null,null)}),e[qs]=null}};function i0(n){this._internalRoot=n}i0.prototype.unstable_scheduleHydration=function(n){if(n){var e=qI();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Ao.length&&e!==0&&e<Ao[t].priority;t++);Ao.splice(t,0,n),t===0&&QI(n)}};function Ow(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function s0(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function hT(){}function r7(n,e,t,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var h=im(o);s.call(h)}}var o=gk(e,r,n,0,null,!1,!1,"",hT);return n._reactRootContainer=o,n[qs]=o.current,Cd(n.nodeType===8?n.parentNode:n),cl(),o}for(;i=n.lastChild;)n.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var h=im(c);l.call(h)}}var c=bw(n,0,!1,null,null,!1,!1,"",hT);return n._reactRootContainer=c,n[qs]=c.current,Cd(n.nodeType===8?n.parentNode:n),cl(function(){r0(e,c,t,r)}),c}function o0(n,e,t,r,i){var s=t._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var c=im(o);l.call(c)}}r0(e,o,n,i)}else o=r7(t,e,n,i,r);return im(o)}HI=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Vh(e.pendingLanes);t!==0&&(ew(e,t|1),Vr(e,qt()),!(tt&6)&&(Qu=qt()+500,da()))}break;case 13:cl(function(){var r=Ks(n,1);if(r!==null){var i=vr();Ni(r,n,1,i)}}),Dw(n,1)}};tw=function(n){if(n.tag===13){var e=Ks(n,134217728);if(e!==null){var t=vr();Ni(e,n,134217728,t)}Dw(n,134217728)}};$I=function(n){if(n.tag===13){var e=Ho(n),t=Ks(n,e);if(t!==null){var r=vr();Ni(t,n,e,r)}Dw(n,e)}};qI=function(){return ht};KI=function(n,e){var t=ht;try{return ht=n,e()}finally{ht=t}};a1=function(n,e,t){switch(e){case"input":if(e1(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var i=Ym(r);if(!i)throw Error(oe(90));II(r),e1(r,i)}}}break;case"textarea":PI(n,t);break;case"select":e=t.value,e!=null&&xu(n,!!t.multiple,e,!1)}};MI=Rw;OI=cl;var i7={usingClientEntryPoint:!1,Events:[sf,wu,Ym,bI,DI,Rw]},kh={findFiberByHostInstance:Ya,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},s7={bundleType:kh.bundleType,version:kh.version,rendererPackageName:kh.rendererPackageName,rendererConfig:kh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:to.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=VI(n),n===null?null:n.stateNode},findFiberByHostInstance:kh.findFiberByHostInstance||n7,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Yp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yp.isDisabled&&Yp.supportsFiber)try{$m=Yp.inject(s7),ss=Yp}catch{}}qr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=i7;qr.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ow(e))throw Error(oe(200));return t7(n,e,null,t)};qr.createRoot=function(n,e){if(!Ow(n))throw Error(oe(299));var t=!1,r="",i=mk;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=bw(n,1,!1,null,null,t,!1,r,i),n[qs]=e.current,Cd(n.nodeType===8?n.parentNode:n),new Mw(e)};qr.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(oe(188)):(n=Object.keys(n).join(","),Error(oe(268,n)));return n=VI(e),n=n===null?null:n.stateNode,n};qr.flushSync=function(n){return cl(n)};qr.hydrate=function(n,e,t){if(!s0(e))throw Error(oe(200));return o0(null,n,e,!0,t)};qr.hydrateRoot=function(n,e,t){if(!Ow(n))throw Error(oe(405));var r=t!=null&&t.hydratedSources||null,i=!1,s="",o=mk;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=gk(e,null,n,1,t??null,i,!1,s,o),n[qs]=e.current,Cd(n),r)for(n=0;n<r.length;n++)t=r[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new i0(e)};qr.render=function(n,e,t){if(!s0(e))throw Error(oe(200));return o0(null,n,e,!1,t)};qr.unmountComponentAtNode=function(n){if(!s0(n))throw Error(oe(40));return n._reactRootContainer?(cl(function(){o0(null,null,n,!1,function(){n._reactRootContainer=null,n[qs]=null})}),!0):!1};qr.unstable_batchedUpdates=Rw;qr.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!s0(t))throw Error(oe(200));if(n==null||n._reactInternals===void 0)throw Error(oe(38));return o0(n,e,t,!1,r)};qr.version="18.3.1-next-f1338f8080-20240426";function _k(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(_k)}catch(n){console.error(n)}}_k(),_I.exports=qr;var o7=_I.exports,dT=o7;qv.createRoot=dT.createRoot,qv.hydrateRoot=dT.hydrateRoot;var fT={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yk={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ce=function(n,e){if(!n)throw vc(e)},vc=function(n){return new Error("Firebase Database ("+yk.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vk=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},a7=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],o=n[t++],l=n[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Lw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],o=i+1<n.length,l=o?n[i+1]:0,c=i+2<n.length,h=c?n[i+2]:0,p=s>>2,m=(s&3)<<4|l>>4;let _=(l&15)<<2|h>>6,S=h&63;c||(S=64,o||(_=64)),r.push(t[p],t[m],t[_],t[S])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(vk(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):a7(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],l=i<n.length?t[n.charAt(i)]:0;++i;const h=i<n.length?t[n.charAt(i)]:64;++i;const m=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||l==null||h==null||m==null)throw new l7;const _=s<<2|l>>4;if(r.push(_),h!==64){const S=l<<4&240|h>>2;if(r.push(S),m!==64){const E=h<<6&192|m;r.push(E)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class l7 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const wk=function(n){const e=vk(n);return Lw.encodeByteArray(e,!0)},sm=function(n){return wk(n).replace(/\./g,"")},om=function(n){try{return Lw.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u7(n){return Ek(void 0,n)}function Ek(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!c7(t)||(n[t]=Ek(n[t],e[t]));return n}function c7(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h7(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d7=()=>h7().__FIREBASE_DEFAULTS__,f7=()=>{if(typeof process>"u"||typeof fT>"u")return;const n=fT.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},p7=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&om(n[1]);return e&&JSON.parse(e)},a0=()=>{try{return d7()||f7()||p7()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Sk=n=>{var e,t;return(t=(e=a0())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Ck=n=>{const e=Sk(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Tk=()=>{var n;return(n=a0())===null||n===void 0?void 0:n.config},Ik=n=>{var e;return(e=a0())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kk(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[sm(JSON.stringify(t)),sm(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Fw(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(cr())}function g7(){var n;const e=(n=a0())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function m7(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function _7(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Pk(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function y7(){const n=cr();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function v7(){return yk.NODE_ADMIN===!0}function w7(){return!g7()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function E7(){try{return typeof indexedDB=="object"}catch{return!1}}function S7(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C7="FirebaseError";class no extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=C7,Object.setPrototypeOf(this,no.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,af.prototype.create)}}class af{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?T7(s,r):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new no(i,l,r)}}function T7(n,e){return n.replace(I7,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const I7=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bd(n){return JSON.parse(n)}function Pn(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rk=function(n){let e={},t={},r={},i="";try{const s=n.split(".");e=bd(om(s[0])||""),t=bd(om(s[1])||""),i=s[2],r=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:r,signature:i}},k7=function(n){const e=Rk(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},P7=function(n){const e=Rk(n).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hs(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Yu(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function am(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function lm(n,e,t){const r={};for(const i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=e.call(t,n[i],i,n));return r}function um(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],o=e[i];if(pT(s)&&pT(o)){if(!um(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function pT(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wc(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Bh(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function zh(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R7{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const r=this.W_;if(typeof e=="string")for(let m=0;m<16;m++)r[m]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let m=0;m<16;m++)r[m]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let m=16;m<80;m++){const _=r[m-3]^r[m-8]^r[m-14]^r[m-16];r[m]=(_<<1|_>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],l=this.chain_[3],c=this.chain_[4],h,p;for(let m=0;m<80;m++){m<40?m<20?(h=l^s&(o^l),p=1518500249):(h=s^o^l,p=1859775393):m<60?(h=s&o|l&(s|o),p=2400959708):(h=s^o^l,p=3395469782);const _=(i<<5|i>>>27)+h+c+p+r[m]&4294967295;c=l,l=o,o=(s<<30|s>>>2)&4294967295,s=i,i=_}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const r=t-this.blockSize;let i=0;const s=this.buf_;let o=this.inbuf_;for(;i<t;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<t;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<t;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=t&255,t/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}}function x7(n,e){const t=new A7(n,e);return t.subscribe.bind(t)}class A7{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");N7(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=gv),i.error===void 0&&(i.error=gv),i.complete===void 0&&(i.complete=gv);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function N7(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function gv(){}function Xu(n,e){return`${n} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b7=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);if(i>=55296&&i<=56319){const s=i-55296;r++,ce(r<n.length,"Surrogate pair missing trail surrogate.");const o=n.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):i<65536?(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},l0=function(n){let e=0;for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Et(n){return n&&n._delegate?n._delegate:n}class ea{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qa="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D7{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new rs;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(O7(e))try{this.getOrInitializeService({instanceIdentifier:qa})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=qa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=qa){return this.instances.has(e)}getOptions(e=qa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);r===l&&o.resolve(i)}return i}onInit(e,t){var r;const i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:M7(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=qa){return this.component?this.component.multipleInstances?e:qa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function M7(n){return n===qa?void 0:n}function O7(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L7{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new D7(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var He;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(He||(He={}));const F7={debug:He.DEBUG,verbose:He.VERBOSE,info:He.INFO,warn:He.WARN,error:He.ERROR,silent:He.SILENT},V7=He.INFO,U7={[He.DEBUG]:"log",[He.VERBOSE]:"log",[He.INFO]:"info",[He.WARN]:"warn",[He.ERROR]:"error"},B7=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=U7[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class u0{constructor(e){this.name=e,this._logLevel=V7,this._logHandler=B7,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in He))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?F7[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,He.DEBUG,...e),this._logHandler(this,He.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,He.VERBOSE,...e),this._logHandler(this,He.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,He.INFO,...e),this._logHandler(this,He.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,He.WARN,...e),this._logHandler(this,He.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,He.ERROR,...e),this._logHandler(this,He.ERROR,...e)}}const z7=(n,e)=>e.some(t=>n instanceof t);let gT,mT;function j7(){return gT||(gT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function G7(){return mT||(mT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const xk=new WeakMap,B1=new WeakMap,Ak=new WeakMap,mv=new WeakMap,Vw=new WeakMap;function W7(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(qo(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&xk.set(t,n)}).catch(()=>{}),Vw.set(e,n),e}function H7(n){if(B1.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});B1.set(n,e)}let z1={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return B1.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Ak.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return qo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function $7(n){z1=n(z1)}function q7(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(_v(this),e,...t);return Ak.set(r,e.sort?e.sort():[e]),qo(r)}:G7().includes(n)?function(...e){return n.apply(_v(this),e),qo(xk.get(this))}:function(...e){return qo(n.apply(_v(this),e))}}function K7(n){return typeof n=="function"?q7(n):(n instanceof IDBTransaction&&H7(n),z7(n,j7())?new Proxy(n,z1):n)}function qo(n){if(n instanceof IDBRequest)return W7(n);if(mv.has(n))return mv.get(n);const e=K7(n);return e!==n&&(mv.set(n,e),Vw.set(e,n)),e}const _v=n=>Vw.get(n);function Q7(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(n,e),l=qo(o);return r&&o.addEventListener("upgradeneeded",c=>{r(qo(o.result),c.oldVersion,c.newVersion,qo(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),l.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const Y7=["get","getKey","getAll","getAllKeys","count"],X7=["put","add","delete","clear"],yv=new Map;function _T(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(yv.get(e))return yv.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=X7.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Y7.includes(t)))return;const s=async function(o,...l){const c=this.transaction(o,i?"readwrite":"readonly");let h=c.store;return r&&(h=h.index(l.shift())),(await Promise.all([h[t](...l),i&&c.done]))[0]};return yv.set(e,s),s}$7(n=>({...n,get:(e,t,r)=>_T(e,t)||n.get(e,t,r),has:(e,t)=>!!_T(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J7{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Z7(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function Z7(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const j1="@firebase/app",yT="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ys=new u0("@firebase/app"),eb="@firebase/app-compat",tb="@firebase/analytics-compat",nb="@firebase/analytics",rb="@firebase/app-check-compat",ib="@firebase/app-check",sb="@firebase/auth",ob="@firebase/auth-compat",ab="@firebase/database",lb="@firebase/data-connect",ub="@firebase/database-compat",cb="@firebase/functions",hb="@firebase/functions-compat",db="@firebase/installations",fb="@firebase/installations-compat",pb="@firebase/messaging",gb="@firebase/messaging-compat",mb="@firebase/performance",_b="@firebase/performance-compat",yb="@firebase/remote-config",vb="@firebase/remote-config-compat",wb="@firebase/storage",Eb="@firebase/storage-compat",Sb="@firebase/firestore",Cb="@firebase/vertexai-preview",Tb="@firebase/firestore-compat",Ib="firebase",kb="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G1="[DEFAULT]",Pb={[j1]:"fire-core",[eb]:"fire-core-compat",[nb]:"fire-analytics",[tb]:"fire-analytics-compat",[ib]:"fire-app-check",[rb]:"fire-app-check-compat",[sb]:"fire-auth",[ob]:"fire-auth-compat",[ab]:"fire-rtdb",[lb]:"fire-data-connect",[ub]:"fire-rtdb-compat",[cb]:"fire-fn",[hb]:"fire-fn-compat",[db]:"fire-iid",[fb]:"fire-iid-compat",[pb]:"fire-fcm",[gb]:"fire-fcm-compat",[mb]:"fire-perf",[_b]:"fire-perf-compat",[yb]:"fire-rc",[vb]:"fire-rc-compat",[wb]:"fire-gcs",[Eb]:"fire-gcs-compat",[Sb]:"fire-fst",[Tb]:"fire-fst-compat",[Cb]:"fire-vertex","fire-js":"fire-js",[Ib]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cm=new Map,Rb=new Map,W1=new Map;function vT(n,e){try{n.container.addComponent(e)}catch(t){Ys.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function hl(n){const e=n.name;if(W1.has(e))return Ys.debug(`There were multiple attempts to register component ${e}.`),!1;W1.set(e,n);for(const t of cm.values())vT(t,n);for(const t of Rb.values())vT(t,n);return!0}function c0(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ri(n){return n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xb={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ko=new af("app","Firebase",xb);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ab{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ea("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ko.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tl=kb;function Nk(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:G1,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Ko.create("bad-app-name",{appName:String(i)});if(t||(t=Tk()),!t)throw Ko.create("no-options");const s=cm.get(i);if(s){if(um(t,s.options)&&um(r,s.config))return s;throw Ko.create("duplicate-app",{appName:i})}const o=new L7(i);for(const c of W1.values())o.addComponent(c);const l=new Ab(t,r,o);return cm.set(i,l),l}function Uw(n=G1){const e=cm.get(n);if(!e&&n===G1&&Tk())return Nk();if(!e)throw Ko.create("no-app",{appName:n});return e}function as(n,e,t){var r;let i=(r=Pb[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ys.warn(l.join(" "));return}hl(new ea(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nb="firebase-heartbeat-database",bb=1,Dd="firebase-heartbeat-store";let vv=null;function bk(){return vv||(vv=Q7(Nb,bb,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Dd)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ko.create("idb-open",{originalErrorMessage:n.message})})),vv}async function Db(n){try{const t=(await bk()).transaction(Dd),r=await t.objectStore(Dd).get(Dk(n));return await t.done,r}catch(e){if(e instanceof no)Ys.warn(e.message);else{const t=Ko.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ys.warn(t.message)}}}async function wT(n,e){try{const r=(await bk()).transaction(Dd,"readwrite");await r.objectStore(Dd).put(e,Dk(n)),await r.done}catch(t){if(t instanceof no)Ys.warn(t.message);else{const r=Ko.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Ys.warn(r.message)}}}function Dk(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mb=1024,Ob=30*24*60*60*1e3;class Lb{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Vb(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=ET();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=Ob}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Ys.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=ET(),{heartbeatsToSend:r,unsentEntries:i}=Fb(this._heartbeatsCache.heartbeats),s=sm(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return Ys.warn(t),""}}}function ET(){return new Date().toISOString().substring(0,10)}function Fb(n,e=Mb){const t=[];let r=n.slice();for(const i of n){const s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),ST(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),ST(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class Vb{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return E7()?S7().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Db(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return wT(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return wT(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function ST(n){return sm(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ub(n){hl(new ea("platform-logger",e=>new J7(e),"PRIVATE")),hl(new ea("heartbeat",e=>new Lb(e),"PRIVATE")),as(j1,yT,n),as(j1,yT,"esm2017"),as("fire-js","")}Ub("");function Bw(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function Mk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Bb=Mk,Ok=new af("auth","Firebase",Mk());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hm=new u0("@firebase/auth");function zb(n,...e){hm.logLevel<=He.WARN&&hm.warn(`Auth (${Tl}): ${n}`,...e)}function Sg(n,...e){hm.logLevel<=He.ERROR&&hm.error(`Auth (${Tl}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function di(n,...e){throw jw(n,...e)}function bi(n,...e){return jw(n,...e)}function zw(n,e,t){const r=Object.assign(Object.assign({},Bb()),{[e]:t});return new af("auth","Firebase",r).create(e,{appName:n.name})}function js(n){return zw(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function jb(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&di(n,"argument-error"),zw(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function jw(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Ok.create(n,...e)}function ke(n,e,...t){if(!n)throw jw(e,...t)}function Fs(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Sg(e),new Error(e)}function Xs(n,e){n||Fs(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H1(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function Gb(){return CT()==="http:"||CT()==="https:"}function CT(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wb(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Gb()||_7()||"connection"in navigator)?navigator.onLine:!0}function Hb(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lf{constructor(e,t){this.shortDelay=e,this.longDelay=t,Xs(t>e,"Short delay should be less than long delay!"),this.isMobile=Fw()||Pk()}get(){return Wb()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gw(n,e){Xs(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lk{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Fs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Fs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Fs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $b={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qb=new lf(3e4,6e4);function fa(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function pa(n,e,t,r,i={}){return Fk(n,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const l=wc(Object.assign({key:n.config.apiKey},o)).slice(1),c=await n._getAdditionalHeaders();c["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode);const h=Object.assign({method:e,headers:c},s);return m7()||(h.referrerPolicy="no-referrer"),Lk.fetch()(Vk(n,n.config.apiHost,t,l),h)})}async function Fk(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},$b),e);try{const i=new Qb(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Xp(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[c,h]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Xp(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Xp(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw Xp(n,"user-disabled",o);const p=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw zw(n,p,h);di(n,p)}}catch(i){if(i instanceof no)throw i;di(n,"network-request-failed",{message:String(i)})}}async function uf(n,e,t,r,i={}){const s=await pa(n,e,t,r,i);return"mfaPendingCredential"in s&&di(n,"multi-factor-auth-required",{_serverResponse:s}),s}function Vk(n,e,t,r){const i=`${e}${t}?${r}`;return n.config.emulator?Gw(n.config,i):`${n.config.apiScheme}://${i}`}function Kb(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Qb{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(bi(this.auth,"network-request-failed")),qb.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Xp(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=bi(n,e,r);return i.customData._tokenResponse=t,i}function TT(n){return n!==void 0&&n.enterprise!==void 0}class Yb{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Kb(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function Xb(n,e){return pa(n,"GET","/v2/recaptchaConfig",fa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jb(n,e){return pa(n,"POST","/v1/accounts:delete",e)}async function Uk(n,e){return pa(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nd(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Zb(n,e=!1){const t=Et(n),r=await t.getIdToken(e),i=Ww(r);ke(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:nd(wv(i.auth_time)),issuedAtTime:nd(wv(i.iat)),expirationTime:nd(wv(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function wv(n){return Number(n)*1e3}function Ww(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Sg("JWT malformed, contained fewer than 3 sections"),null;try{const i=om(t);return i?JSON.parse(i):(Sg("Failed to decode base64 JWT payload"),null)}catch(i){return Sg("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function IT(n){const e=Ww(n);return ke(e,"internal-error"),ke(typeof e.exp<"u","internal-error"),ke(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Md(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof no&&eD(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function eD({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tD{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $1{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=nd(this.lastLoginAt),this.creationTime=nd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dm(n){var e;const t=n.auth,r=await n.getIdToken(),i=await Md(n,Uk(t,{idToken:r}));ke(i==null?void 0:i.users.length,t,"internal-error");const s=i.users[0];n._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?Bk(s.providerUserInfo):[],l=rD(n.providerData,o),c=n.isAnonymous,h=!(n.email&&s.passwordHash)&&!(l!=null&&l.length),p=c?h:!1,m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new $1(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,m)}async function nD(n){const e=Et(n);await dm(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function rD(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Bk(n){return n.map(e=>{var{providerId:t}=e,r=Bw(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iD(n,e){const t=await Fk(n,{},async()=>{const r=wc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=Vk(n,i,"/v1/token",`key=${s}`),l=await n._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",Lk.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function sD(n,e){return pa(n,"POST","/v2/accounts:revokeToken",fa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ke(e.idToken,"internal-error"),ke(typeof e.idToken<"u","internal-error"),ke(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):IT(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ke(e.length!==0,"internal-error");const t=IT(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ke(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await iD(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new Ou;return r&&(ke(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(ke(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(ke(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ou,this.toJSON())}_performRefresh(){return Fs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Io(n,e){ke(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Vs{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=Bw(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new tD(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new $1(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Md(this,this.stsTokenManager.getToken(this.auth,e));return ke(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Zb(this,e)}reload(){return nD(this)}_assign(e){this!==e&&(ke(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Vs(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ke(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await dm(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ri(this.auth.app))return Promise.reject(js(this.auth));const e=await this.getIdToken();return await Md(this,Jb(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,l,c,h,p;const m=(r=t.displayName)!==null&&r!==void 0?r:void 0,_=(i=t.email)!==null&&i!==void 0?i:void 0,S=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,E=(o=t.photoURL)!==null&&o!==void 0?o:void 0,x=(l=t.tenantId)!==null&&l!==void 0?l:void 0,M=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,R=(h=t.createdAt)!==null&&h!==void 0?h:void 0,P=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:v,emailVerified:k,isAnonymous:D,providerData:O,stsTokenManager:N}=t;ke(v&&N,e,"internal-error");const C=Ou.fromJSON(this.name,N);ke(typeof v=="string",e,"internal-error"),Io(m,e.name),Io(_,e.name),ke(typeof k=="boolean",e,"internal-error"),ke(typeof D=="boolean",e,"internal-error"),Io(S,e.name),Io(E,e.name),Io(x,e.name),Io(M,e.name),Io(R,e.name),Io(P,e.name);const b=new Vs({uid:v,auth:e,email:_,emailVerified:k,displayName:m,isAnonymous:D,photoURL:E,phoneNumber:S,tenantId:x,stsTokenManager:C,createdAt:R,lastLoginAt:P});return O&&Array.isArray(O)&&(b.providerData=O.map(A=>Object.assign({},A))),M&&(b._redirectEventId=M),b}static async _fromIdTokenResponse(e,t,r=!1){const i=new Ou;i.updateFromServerResponse(t);const s=new Vs({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await dm(s),s}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];ke(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?Bk(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),l=new Ou;l.updateFromIdToken(r);const c=new Vs({uid:i.localId,auth:e,stsTokenManager:l,isAnonymous:o}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new $1(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(c,h),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kT=new Map;function Us(n){Xs(n instanceof Function,"Expected a class definition");let e=kT.get(n);return e?(Xs(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,kT.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zk{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}zk.type="NONE";const PT=zk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cg(n,e,t){return`firebase:${n}:${e}:${t}`}class Lu{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Cg(this.userKey,i.apiKey,s),this.fullPersistenceKey=Cg("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Vs._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Lu(Us(PT),e,r);const i=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=i[0]||Us(PT);const o=Cg(r,e.config.apiKey,e.name);let l=null;for(const h of t)try{const p=await h._get(o);if(p){const m=Vs._fromJSON(e,p);h!==s&&(l=m),s=h;break}}catch{}const c=i.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new Lu(s,e,r):(s=c[0],l&&await s._set(o,l.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new Lu(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RT(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Hk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(jk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(qk(e))return"Blackberry";if(Kk(e))return"Webos";if(Gk(e))return"Safari";if((e.includes("chrome/")||Wk(e))&&!e.includes("edge/"))return"Chrome";if($k(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function jk(n=cr()){return/firefox\//i.test(n)}function Gk(n=cr()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Wk(n=cr()){return/crios\//i.test(n)}function Hk(n=cr()){return/iemobile/i.test(n)}function $k(n=cr()){return/android/i.test(n)}function qk(n=cr()){return/blackberry/i.test(n)}function Kk(n=cr()){return/webos/i.test(n)}function Hw(n=cr()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function oD(n=cr()){var e;return Hw(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function aD(){return y7()&&document.documentMode===10}function Qk(n=cr()){return Hw(n)||$k(n)||Kk(n)||qk(n)||/windows phone/i.test(n)||Hk(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yk(n,e=[]){let t;switch(n){case"Browser":t=RT(cr());break;case"Worker":t=`${RT(cr())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Tl}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lD{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((o,l)=>{try{const c=e(s);o(c)}catch(c){l(c)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uD(n,e={}){return pa(n,"GET","/v2/passwordPolicy",fa(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cD=6;class hD{constructor(e){var t,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:cD,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dD{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new xT(this),this.idTokenSubscription=new xT(this),this.beforeStateQueue=new lD(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Ok,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Us(t)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await Lu.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Uk(this,{idToken:e}),r=await Vs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Ri(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,l=i==null?void 0:i._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ke(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await dm(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Hb()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ri(this.app))return Promise.reject(js(this));const t=e?Et(e):null;return t&&ke(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ke(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ri(this.app)?Promise.reject(js(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ri(this.app)?Promise.reject(js(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Us(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await uD(this),t=new hD(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new af("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await sD(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Us(e)||this._popupRedirectResolver;ke(t,this,"argument-error"),this.redirectPersistenceManager=await Lu.create(this,[Us(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(ke(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const c=e.addObserver(t,r,i);return()=>{o=!0,c()}}else{const c=e.addObserver(t);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ke(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Yk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&zb(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function ga(n){return Et(n)}class xT{constructor(e){this.auth=e,this.observer=null,this.addObserver=x7(t=>this.observer=t)}get next(){return ke(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let h0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function fD(n){h0=n}function Xk(n){return h0.loadJS(n)}function pD(){return h0.recaptchaEnterpriseScript}function gD(){return h0.gapiScript}function mD(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const _D="recaptcha-enterprise",yD="NO_RECAPTCHA";class vD{constructor(e){this.type=_D,this.auth=ga(e)}async verify(e="verify",t=!1){async function r(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,l)=>{Xb(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const h=new Yb(c);return s.tenantId==null?s._agentRecaptchaConfig=h:s._tenantRecaptchaConfigs[s.tenantId]=h,o(h.siteKey)}}).catch(c=>{l(c)})})}function i(s,o,l){const c=window.grecaptcha;TT(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(h=>{o(h)}).catch(()=>{o(yD)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(l=>{if(!t&&TT(window.grecaptcha))i(l,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=pD();c.length!==0&&(c+=l),Xk(c).then(()=>{i(l,s,o)}).catch(h=>{o(h)})}}).catch(l=>{o(l)})})}}async function AT(n,e,t,r=!1){const i=new vD(n);let s;try{s=await i.verify(t)}catch{s=await i.verify(t,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function q1(n,e,t,r){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await AT(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await AT(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wD(n,e){const t=c0(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(um(s,e??{}))return i;di(i,"already-initialized")}return t.initialize({options:e})}function ED(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Us);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Jk(n,e,t){const r=ga(n);ke(r._canInitEmulator,r,"emulator-config-failed"),ke(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(t!=null&&t.disableWarnings),s=Zk(e),{host:o,port:l}=SD(e),c=l===null?"":`:${l}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||CD()}function Zk(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function SD(n){const e=Zk(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:NT(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:NT(o)}}}function NT(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function CD(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $w{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Fs("not implemented")}_getIdTokenResponse(e){return Fs("not implemented")}_linkToIdToken(e,t){return Fs("not implemented")}_getReauthenticationResolver(e){return Fs("not implemented")}}async function TD(n,e){return pa(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ID(n,e){return uf(n,"POST","/v1/accounts:signInWithPassword",fa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kD(n,e){return uf(n,"POST","/v1/accounts:signInWithEmailLink",fa(n,e))}async function PD(n,e){return uf(n,"POST","/v1/accounts:signInWithEmailLink",fa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od extends $w{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Od(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Od(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return q1(e,t,"signInWithPassword",ID);case"emailLink":return kD(e,{email:this._email,oobCode:this._password});default:di(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return q1(e,r,"signUpPassword",TD);case"emailLink":return PD(e,{idToken:t,email:this._email,oobCode:this._password});default:di(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fu(n,e){return uf(n,"POST","/v1/accounts:signInWithIdp",fa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RD="http://localhost";class dl extends $w{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new dl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):di("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=Bw(t,["providerId","signInMethod"]);if(!r||!i)return null;const o=new dl(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Fu(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Fu(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Fu(e,t)}buildRequest(){const e={requestUri:RD,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=wc(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xD(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function AD(n){const e=Bh(zh(n)).link,t=e?Bh(zh(e)).deep_link_id:null,r=Bh(zh(n)).deep_link_id;return(r?Bh(zh(r)).link:null)||r||t||e||n}class qw{constructor(e){var t,r,i,s,o,l;const c=Bh(zh(e)),h=(t=c.apiKey)!==null&&t!==void 0?t:null,p=(r=c.oobCode)!==null&&r!==void 0?r:null,m=xD((i=c.mode)!==null&&i!==void 0?i:null);ke(h&&p&&m,"argument-error"),this.apiKey=h,this.operation=m,this.code=p,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const t=AD(e);try{return new qw(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ec{constructor(){this.providerId=Ec.PROVIDER_ID}static credential(e,t){return Od._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=qw.parseLink(t);return ke(r,"argument-error"),Od._fromEmailAndCode(e,r.code,r.tenantId)}}Ec.PROVIDER_ID="password";Ec.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ec.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cf extends Kw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo extends cf{constructor(){super("facebook.com")}static credential(e){return dl._fromParams({providerId:bo.PROVIDER_ID,signInMethod:bo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return bo.credentialFromTaggedObject(e)}static credentialFromError(e){return bo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return bo.credential(e.oauthAccessToken)}catch{return null}}}bo.FACEBOOK_SIGN_IN_METHOD="facebook.com";bo.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms extends cf{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return dl._fromParams({providerId:Ms.PROVIDER_ID,signInMethod:Ms.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ms.credentialFromTaggedObject(e)}static credentialFromError(e){return Ms.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Ms.credential(t,r)}catch{return null}}}Ms.GOOGLE_SIGN_IN_METHOD="google.com";Ms.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do extends cf{constructor(){super("github.com")}static credential(e){return dl._fromParams({providerId:Do.PROVIDER_ID,signInMethod:Do.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Do.credentialFromTaggedObject(e)}static credentialFromError(e){return Do.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Do.credential(e.oauthAccessToken)}catch{return null}}}Do.GITHUB_SIGN_IN_METHOD="github.com";Do.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mo extends cf{constructor(){super("twitter.com")}static credential(e,t){return dl._fromParams({providerId:Mo.PROVIDER_ID,signInMethod:Mo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Mo.credentialFromTaggedObject(e)}static credentialFromError(e){return Mo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Mo.credential(t,r)}catch{return null}}}Mo.TWITTER_SIGN_IN_METHOD="twitter.com";Mo.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ND(n,e){return uf(n,"POST","/v1/accounts:signUp",fa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await Vs._fromIdTokenResponse(e,r,i),o=bT(r);return new fl({user:s,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=bT(r);return new fl({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function bT(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fm extends no{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,fm.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new fm(e,t,r,i)}}function eP(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?fm._fromErrorAndOperation(n,s,e,r):s})}async function bD(n,e,t=!1){const r=await Md(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return fl._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DD(n,e,t=!1){const{auth:r}=n;if(Ri(r.app))return Promise.reject(js(r));const i="reauthenticate";try{const s=await Md(n,eP(r,i,e,n),t);ke(s.idToken,r,"internal-error");const o=Ww(s.idToken);ke(o,r,"internal-error");const{sub:l}=o;return ke(n.uid===l,r,"user-mismatch"),fl._forOperation(n,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&di(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tP(n,e,t=!1){if(Ri(n.app))return Promise.reject(js(n));const r="signIn",i=await eP(n,r,e),s=await fl._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}async function MD(n,e){return tP(ga(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nP(n){const e=ga(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function OD(n,e,t){if(Ri(n.app))return Promise.reject(js(n));const r=ga(n),o=await q1(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",ND).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&nP(n),c}),l=await fl._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(l.user),l}function LD(n,e,t){return Ri(n.app)?Promise.reject(js(n)):MD(Et(n),Ec.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&nP(n),r})}function FD(n,e,t,r){return Et(n).onIdTokenChanged(e,t,r)}function VD(n,e,t){return Et(n).beforeAuthStateChanged(e,t)}function UD(n,e,t,r){return Et(n).onAuthStateChanged(e,t,r)}function BD(n){return Et(n).signOut()}const pm="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rP{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(pm,"1"),this.storage.removeItem(pm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zD=1e3,jD=10;class iP extends rP{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Qk(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);aD()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,jD):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},zD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}iP.type="LOCAL";const GD=iP;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sP extends rP{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}sP.type="SESSION";const oP=sP;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WD(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d0{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new d0(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const l=Array.from(o).map(async h=>h(t.origin,s)),c=await WD(l);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:c})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}d0.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qw(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HD{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((l,c)=>{const h=Qw("",20);i.port1.start();const p=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(m){const _=m;if(_.data.eventId===h)switch(_.data.status){case"ack":clearTimeout(p),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(_.data.response);break;default:clearTimeout(p),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ls(){return window}function $D(n){ls().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aP(){return typeof ls().WorkerGlobalScope<"u"&&typeof ls().importScripts=="function"}async function qD(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function KD(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function QD(){return aP()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lP="firebaseLocalStorageDb",YD=1,gm="firebaseLocalStorage",uP="fbase_key";class hf{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function f0(n,e){return n.transaction([gm],e?"readwrite":"readonly").objectStore(gm)}function XD(){const n=indexedDB.deleteDatabase(lP);return new hf(n).toPromise()}function K1(){const n=indexedDB.open(lP,YD);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(gm,{keyPath:uP})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(gm)?e(r):(r.close(),await XD(),e(await K1()))})})}async function DT(n,e,t){const r=f0(n,!0).put({[uP]:e,value:t});return new hf(r).toPromise()}async function JD(n,e){const t=f0(n,!1).get(e),r=await new hf(t).toPromise();return r===void 0?null:r.value}function MT(n,e){const t=f0(n,!0).delete(e);return new hf(t).toPromise()}const ZD=800,eM=3;class cP{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await K1(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>eM)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return aP()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=d0._getInstance(QD()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await qD(),!this.activeServiceWorker)return;this.sender=new HD(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||KD()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await K1();return await DT(e,pm,"1"),await MT(e,pm),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>DT(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>JD(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>MT(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=f0(i,!1).getAll();return new hf(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),ZD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}cP.type="LOCAL";const tM=cP;new lf(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hP(n,e){return e?Us(e):(ke(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yw extends $w{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Fu(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Fu(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Fu(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function nM(n){return tP(n.auth,new Yw(n),n.bypassAuthState)}function rM(n){const{auth:e,user:t}=n;return ke(t,e,"internal-error"),DD(t,new Yw(n),n.bypassAuthState)}async function iM(n){const{auth:e,user:t}=n;return ke(t,e,"internal-error"),bD(t,new Yw(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dP{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return nM;case"linkViaPopup":case"linkViaRedirect":return iM;case"reauthViaPopup":case"reauthViaRedirect":return rM;default:di(this.auth,"internal-error")}}resolve(e){Xs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Xs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sM=new lf(2e3,1e4);async function oM(n,e,t){if(Ri(n.app))return Promise.reject(bi(n,"operation-not-supported-in-this-environment"));const r=ga(n);jb(n,e,Kw);const i=hP(r,t);return new Za(r,"signInViaPopup",e,i).executeNotNull()}class Za extends dP{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Za.currentPopupAction&&Za.currentPopupAction.cancel(),Za.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ke(e,this.auth,"internal-error"),e}async onExecution(){Xs(this.filter.length===1,"Popup operations only handle one event");const e=Qw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(bi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(bi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Za.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(bi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,sM.get())};e()}}Za.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aM="pendingRedirect",Tg=new Map;class lM extends dP{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Tg.get(this.auth._key());if(!e){try{const r=await uM(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Tg.set(this.auth._key(),e)}return this.bypassAuthState||Tg.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function uM(n,e){const t=dM(e),r=hM(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function cM(n,e){Tg.set(n._key(),e)}function hM(n){return Us(n._redirectPersistence)}function dM(n){return Cg(aM,n.config.apiKey,n.name)}async function fM(n,e,t=!1){if(Ri(n.app))return Promise.reject(js(n));const r=ga(n),i=hP(r,e),o=await new lM(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pM=10*60*1e3;class gM{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!mM(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!fP(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(bi(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=pM&&this.cachedEventUids.clear(),this.cachedEventUids.has(OT(e))}saveEventToCache(e){this.cachedEventUids.add(OT(e)),this.lastProcessedEventTime=Date.now()}}function OT(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function fP({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function mM(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return fP(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _M(n,e={}){return pa(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yM=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,vM=/^https?/;async function wM(n){if(n.config.emulator)return;const{authorizedDomains:e}=await _M(n);for(const t of e)try{if(EM(t))return}catch{}di(n,"unauthorized-domain")}function EM(n){const e=H1(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!vM.test(t))return!1;if(yM.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SM=new lf(3e4,6e4);function LT(){const n=ls().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function CM(n){return new Promise((e,t)=>{var r,i,s;function o(){LT(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{LT(),t(bi(n,"network-request-failed"))},timeout:SM.get()})}if(!((i=(r=ls().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=ls().gapi)===null||s===void 0)&&s.load)o();else{const l=mD("iframefcb");return ls()[l]=()=>{gapi.load?o():t(bi(n,"network-request-failed"))},Xk(`${gD()}?onload=${l}`).catch(c=>t(c))}}).catch(e=>{throw Ig=null,e})}let Ig=null;function TM(n){return Ig=Ig||CM(n),Ig}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IM=new lf(5e3,15e3),kM="__/auth/iframe",PM="emulator/auth/iframe",RM={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},xM=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function AM(n){const e=n.config;ke(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Gw(e,PM):`https://${n.config.authDomain}/${kM}`,r={apiKey:e.apiKey,appName:n.name,v:Tl},i=xM.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${wc(r).slice(1)}`}async function NM(n){const e=await TM(n),t=ls().gapi;return ke(t,n,"internal-error"),e.open({where:document.body,url:AM(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:RM,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=bi(n,"network-request-failed"),l=ls().setTimeout(()=>{s(o)},IM.get());function c(){ls().clearTimeout(l),i(r)}r.ping(c).then(c,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bM={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},DM=500,MM=600,OM="_blank",LM="http://localhost";class FT{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function FM(n,e,t,r=DM,i=MM){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},bM),{width:r.toString(),height:i.toString(),top:s,left:o}),h=cr().toLowerCase();t&&(l=Wk(h)?OM:t),jk(h)&&(e=e||LM,c.scrollbars="yes");const p=Object.entries(c).reduce((_,[S,E])=>`${_}${S}=${E},`,"");if(oD(h)&&l!=="_self")return VM(e||"",l),new FT(null);const m=window.open(e||"",l,p);ke(m,n,"popup-blocked");try{m.focus()}catch{}return new FT(m)}function VM(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UM="__/auth/handler",BM="emulator/auth/handler",zM=encodeURIComponent("fac");async function VT(n,e,t,r,i,s){ke(n.config.authDomain,n,"auth-domain-config-required"),ke(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Tl,eventId:i};if(e instanceof Kw){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",am(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,m]of Object.entries({}))o[p]=m}if(e instanceof cf){const p=e.getScopes().filter(m=>m!=="");p.length>0&&(o.scopes=p.join(","))}n.tenantId&&(o.tid=n.tenantId);const l=o;for(const p of Object.keys(l))l[p]===void 0&&delete l[p];const c=await n._getAppCheckToken(),h=c?`#${zM}=${encodeURIComponent(c)}`:"";return`${jM(n)}?${wc(l).slice(1)}${h}`}function jM({config:n}){return n.emulator?Gw(n,BM):`https://${n.authDomain}/${UM}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ev="webStorageSupport";class GM{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=oP,this._completeRedirectFn=fM,this._overrideRedirectResult=cM}async _openPopup(e,t,r,i){var s;Xs((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await VT(e,t,r,H1(),i);return FM(e,o,Qw())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await VT(e,t,r,H1(),i);return $D(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Xs(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await NM(e),r=new gM(e);return t.register("authEvent",i=>(ke(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ev,{type:Ev},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Ev];o!==void 0&&t(!!o),di(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=wM(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Qk()||Gk()||Hw()}}const WM=GM;var UT="@firebase/auth",BT="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HM{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ke(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $M(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function qM(n){hl(new ea("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;ke(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Yk(n)},h=new dD(r,i,s,c);return ED(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),hl(new ea("auth-internal",e=>{const t=ga(e.getProvider("auth").getImmediate());return(r=>new HM(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),as(UT,BT,$M(n)),as(UT,BT,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KM=5*60,QM=Ik("authIdTokenMaxAge")||KM;let zT=null;const YM=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>QM)return;const i=t==null?void 0:t.token;zT!==i&&(zT=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function XM(n=Uw()){const e=c0(n,"auth");if(e.isInitialized())return e.getImmediate();const t=wD(n,{popupRedirectResolver:WM,persistence:[tM,GD,oP]}),r=Ik("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=YM(s.toString());VD(t,o,()=>o(t.currentUser)),FD(t,l=>o(l))}}const i=Sk("auth");return i&&Jk(t,`http://${i}`),t}function JM(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}fD({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=bi("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",JM().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});qM("Browser");var ZM="firebase",eO="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */as(ZM,eO,"app");var jT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var sl,pP;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(N,C){function b(){}b.prototype=C.prototype,N.D=C.prototype,N.prototype=new b,N.prototype.constructor=N,N.C=function(A,L,B){for(var V=Array(arguments.length-2),he=2;he<arguments.length;he++)V[he-2]=arguments[he];return C.prototype[L].apply(A,V)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(N,C,b){b||(b=0);var A=Array(16);if(typeof C=="string")for(var L=0;16>L;++L)A[L]=C.charCodeAt(b++)|C.charCodeAt(b++)<<8|C.charCodeAt(b++)<<16|C.charCodeAt(b++)<<24;else for(L=0;16>L;++L)A[L]=C[b++]|C[b++]<<8|C[b++]<<16|C[b++]<<24;C=N.g[0],b=N.g[1],L=N.g[2];var B=N.g[3],V=C+(B^b&(L^B))+A[0]+3614090360&4294967295;C=b+(V<<7&4294967295|V>>>25),V=B+(L^C&(b^L))+A[1]+3905402710&4294967295,B=C+(V<<12&4294967295|V>>>20),V=L+(b^B&(C^b))+A[2]+606105819&4294967295,L=B+(V<<17&4294967295|V>>>15),V=b+(C^L&(B^C))+A[3]+3250441966&4294967295,b=L+(V<<22&4294967295|V>>>10),V=C+(B^b&(L^B))+A[4]+4118548399&4294967295,C=b+(V<<7&4294967295|V>>>25),V=B+(L^C&(b^L))+A[5]+1200080426&4294967295,B=C+(V<<12&4294967295|V>>>20),V=L+(b^B&(C^b))+A[6]+2821735955&4294967295,L=B+(V<<17&4294967295|V>>>15),V=b+(C^L&(B^C))+A[7]+4249261313&4294967295,b=L+(V<<22&4294967295|V>>>10),V=C+(B^b&(L^B))+A[8]+1770035416&4294967295,C=b+(V<<7&4294967295|V>>>25),V=B+(L^C&(b^L))+A[9]+2336552879&4294967295,B=C+(V<<12&4294967295|V>>>20),V=L+(b^B&(C^b))+A[10]+4294925233&4294967295,L=B+(V<<17&4294967295|V>>>15),V=b+(C^L&(B^C))+A[11]+2304563134&4294967295,b=L+(V<<22&4294967295|V>>>10),V=C+(B^b&(L^B))+A[12]+1804603682&4294967295,C=b+(V<<7&4294967295|V>>>25),V=B+(L^C&(b^L))+A[13]+4254626195&4294967295,B=C+(V<<12&4294967295|V>>>20),V=L+(b^B&(C^b))+A[14]+2792965006&4294967295,L=B+(V<<17&4294967295|V>>>15),V=b+(C^L&(B^C))+A[15]+1236535329&4294967295,b=L+(V<<22&4294967295|V>>>10),V=C+(L^B&(b^L))+A[1]+4129170786&4294967295,C=b+(V<<5&4294967295|V>>>27),V=B+(b^L&(C^b))+A[6]+3225465664&4294967295,B=C+(V<<9&4294967295|V>>>23),V=L+(C^b&(B^C))+A[11]+643717713&4294967295,L=B+(V<<14&4294967295|V>>>18),V=b+(B^C&(L^B))+A[0]+3921069994&4294967295,b=L+(V<<20&4294967295|V>>>12),V=C+(L^B&(b^L))+A[5]+3593408605&4294967295,C=b+(V<<5&4294967295|V>>>27),V=B+(b^L&(C^b))+A[10]+38016083&4294967295,B=C+(V<<9&4294967295|V>>>23),V=L+(C^b&(B^C))+A[15]+3634488961&4294967295,L=B+(V<<14&4294967295|V>>>18),V=b+(B^C&(L^B))+A[4]+3889429448&4294967295,b=L+(V<<20&4294967295|V>>>12),V=C+(L^B&(b^L))+A[9]+568446438&4294967295,C=b+(V<<5&4294967295|V>>>27),V=B+(b^L&(C^b))+A[14]+3275163606&4294967295,B=C+(V<<9&4294967295|V>>>23),V=L+(C^b&(B^C))+A[3]+4107603335&4294967295,L=B+(V<<14&4294967295|V>>>18),V=b+(B^C&(L^B))+A[8]+1163531501&4294967295,b=L+(V<<20&4294967295|V>>>12),V=C+(L^B&(b^L))+A[13]+2850285829&4294967295,C=b+(V<<5&4294967295|V>>>27),V=B+(b^L&(C^b))+A[2]+4243563512&4294967295,B=C+(V<<9&4294967295|V>>>23),V=L+(C^b&(B^C))+A[7]+1735328473&4294967295,L=B+(V<<14&4294967295|V>>>18),V=b+(B^C&(L^B))+A[12]+2368359562&4294967295,b=L+(V<<20&4294967295|V>>>12),V=C+(b^L^B)+A[5]+4294588738&4294967295,C=b+(V<<4&4294967295|V>>>28),V=B+(C^b^L)+A[8]+2272392833&4294967295,B=C+(V<<11&4294967295|V>>>21),V=L+(B^C^b)+A[11]+1839030562&4294967295,L=B+(V<<16&4294967295|V>>>16),V=b+(L^B^C)+A[14]+4259657740&4294967295,b=L+(V<<23&4294967295|V>>>9),V=C+(b^L^B)+A[1]+2763975236&4294967295,C=b+(V<<4&4294967295|V>>>28),V=B+(C^b^L)+A[4]+1272893353&4294967295,B=C+(V<<11&4294967295|V>>>21),V=L+(B^C^b)+A[7]+4139469664&4294967295,L=B+(V<<16&4294967295|V>>>16),V=b+(L^B^C)+A[10]+3200236656&4294967295,b=L+(V<<23&4294967295|V>>>9),V=C+(b^L^B)+A[13]+681279174&4294967295,C=b+(V<<4&4294967295|V>>>28),V=B+(C^b^L)+A[0]+3936430074&4294967295,B=C+(V<<11&4294967295|V>>>21),V=L+(B^C^b)+A[3]+3572445317&4294967295,L=B+(V<<16&4294967295|V>>>16),V=b+(L^B^C)+A[6]+76029189&4294967295,b=L+(V<<23&4294967295|V>>>9),V=C+(b^L^B)+A[9]+3654602809&4294967295,C=b+(V<<4&4294967295|V>>>28),V=B+(C^b^L)+A[12]+3873151461&4294967295,B=C+(V<<11&4294967295|V>>>21),V=L+(B^C^b)+A[15]+530742520&4294967295,L=B+(V<<16&4294967295|V>>>16),V=b+(L^B^C)+A[2]+3299628645&4294967295,b=L+(V<<23&4294967295|V>>>9),V=C+(L^(b|~B))+A[0]+4096336452&4294967295,C=b+(V<<6&4294967295|V>>>26),V=B+(b^(C|~L))+A[7]+1126891415&4294967295,B=C+(V<<10&4294967295|V>>>22),V=L+(C^(B|~b))+A[14]+2878612391&4294967295,L=B+(V<<15&4294967295|V>>>17),V=b+(B^(L|~C))+A[5]+4237533241&4294967295,b=L+(V<<21&4294967295|V>>>11),V=C+(L^(b|~B))+A[12]+1700485571&4294967295,C=b+(V<<6&4294967295|V>>>26),V=B+(b^(C|~L))+A[3]+2399980690&4294967295,B=C+(V<<10&4294967295|V>>>22),V=L+(C^(B|~b))+A[10]+4293915773&4294967295,L=B+(V<<15&4294967295|V>>>17),V=b+(B^(L|~C))+A[1]+2240044497&4294967295,b=L+(V<<21&4294967295|V>>>11),V=C+(L^(b|~B))+A[8]+1873313359&4294967295,C=b+(V<<6&4294967295|V>>>26),V=B+(b^(C|~L))+A[15]+4264355552&4294967295,B=C+(V<<10&4294967295|V>>>22),V=L+(C^(B|~b))+A[6]+2734768916&4294967295,L=B+(V<<15&4294967295|V>>>17),V=b+(B^(L|~C))+A[13]+1309151649&4294967295,b=L+(V<<21&4294967295|V>>>11),V=C+(L^(b|~B))+A[4]+4149444226&4294967295,C=b+(V<<6&4294967295|V>>>26),V=B+(b^(C|~L))+A[11]+3174756917&4294967295,B=C+(V<<10&4294967295|V>>>22),V=L+(C^(B|~b))+A[2]+718787259&4294967295,L=B+(V<<15&4294967295|V>>>17),V=b+(B^(L|~C))+A[9]+3951481745&4294967295,N.g[0]=N.g[0]+C&4294967295,N.g[1]=N.g[1]+(L+(V<<21&4294967295|V>>>11))&4294967295,N.g[2]=N.g[2]+L&4294967295,N.g[3]=N.g[3]+B&4294967295}r.prototype.u=function(N,C){C===void 0&&(C=N.length);for(var b=C-this.blockSize,A=this.B,L=this.h,B=0;B<C;){if(L==0)for(;B<=b;)i(this,N,B),B+=this.blockSize;if(typeof N=="string"){for(;B<C;)if(A[L++]=N.charCodeAt(B++),L==this.blockSize){i(this,A),L=0;break}}else for(;B<C;)if(A[L++]=N[B++],L==this.blockSize){i(this,A),L=0;break}}this.h=L,this.o+=C},r.prototype.v=function(){var N=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);N[0]=128;for(var C=1;C<N.length-8;++C)N[C]=0;var b=8*this.o;for(C=N.length-8;C<N.length;++C)N[C]=b&255,b/=256;for(this.u(N),N=Array(16),C=b=0;4>C;++C)for(var A=0;32>A;A+=8)N[b++]=this.g[C]>>>A&255;return N};function s(N,C){var b=l;return Object.prototype.hasOwnProperty.call(b,N)?b[N]:b[N]=C(N)}function o(N,C){this.h=C;for(var b=[],A=!0,L=N.length-1;0<=L;L--){var B=N[L]|0;A&&B==C||(b[L]=B,A=!1)}this.g=b}var l={};function c(N){return-128<=N&&128>N?s(N,function(C){return new o([C|0],0>C?-1:0)}):new o([N|0],0>N?-1:0)}function h(N){if(isNaN(N)||!isFinite(N))return m;if(0>N)return M(h(-N));for(var C=[],b=1,A=0;N>=b;A++)C[A]=N/b|0,b*=4294967296;return new o(C,0)}function p(N,C){if(N.length==0)throw Error("number format error: empty string");if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(N.charAt(0)=="-")return M(p(N.substring(1),C));if(0<=N.indexOf("-"))throw Error('number format error: interior "-" character');for(var b=h(Math.pow(C,8)),A=m,L=0;L<N.length;L+=8){var B=Math.min(8,N.length-L),V=parseInt(N.substring(L,L+B),C);8>B?(B=h(Math.pow(C,B)),A=A.j(B).add(h(V))):(A=A.j(b),A=A.add(h(V)))}return A}var m=c(0),_=c(1),S=c(16777216);n=o.prototype,n.m=function(){if(x(this))return-M(this).m();for(var N=0,C=1,b=0;b<this.g.length;b++){var A=this.i(b);N+=(0<=A?A:4294967296+A)*C,C*=4294967296}return N},n.toString=function(N){if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(E(this))return"0";if(x(this))return"-"+M(this).toString(N);for(var C=h(Math.pow(N,6)),b=this,A="";;){var L=k(b,C).g;b=R(b,L.j(C));var B=((0<b.g.length?b.g[0]:b.h)>>>0).toString(N);if(b=L,E(b))return B+A;for(;6>B.length;)B="0"+B;A=B+A}},n.i=function(N){return 0>N?0:N<this.g.length?this.g[N]:this.h};function E(N){if(N.h!=0)return!1;for(var C=0;C<N.g.length;C++)if(N.g[C]!=0)return!1;return!0}function x(N){return N.h==-1}n.l=function(N){return N=R(this,N),x(N)?-1:E(N)?0:1};function M(N){for(var C=N.g.length,b=[],A=0;A<C;A++)b[A]=~N.g[A];return new o(b,~N.h).add(_)}n.abs=function(){return x(this)?M(this):this},n.add=function(N){for(var C=Math.max(this.g.length,N.g.length),b=[],A=0,L=0;L<=C;L++){var B=A+(this.i(L)&65535)+(N.i(L)&65535),V=(B>>>16)+(this.i(L)>>>16)+(N.i(L)>>>16);A=V>>>16,B&=65535,V&=65535,b[L]=V<<16|B}return new o(b,b[b.length-1]&-2147483648?-1:0)};function R(N,C){return N.add(M(C))}n.j=function(N){if(E(this)||E(N))return m;if(x(this))return x(N)?M(this).j(M(N)):M(M(this).j(N));if(x(N))return M(this.j(M(N)));if(0>this.l(S)&&0>N.l(S))return h(this.m()*N.m());for(var C=this.g.length+N.g.length,b=[],A=0;A<2*C;A++)b[A]=0;for(A=0;A<this.g.length;A++)for(var L=0;L<N.g.length;L++){var B=this.i(A)>>>16,V=this.i(A)&65535,he=N.i(L)>>>16,le=N.i(L)&65535;b[2*A+2*L]+=V*le,P(b,2*A+2*L),b[2*A+2*L+1]+=B*le,P(b,2*A+2*L+1),b[2*A+2*L+1]+=V*he,P(b,2*A+2*L+1),b[2*A+2*L+2]+=B*he,P(b,2*A+2*L+2)}for(A=0;A<C;A++)b[A]=b[2*A+1]<<16|b[2*A];for(A=C;A<2*C;A++)b[A]=0;return new o(b,0)};function P(N,C){for(;(N[C]&65535)!=N[C];)N[C+1]+=N[C]>>>16,N[C]&=65535,C++}function v(N,C){this.g=N,this.h=C}function k(N,C){if(E(C))throw Error("division by zero");if(E(N))return new v(m,m);if(x(N))return C=k(M(N),C),new v(M(C.g),M(C.h));if(x(C))return C=k(N,M(C)),new v(M(C.g),C.h);if(30<N.g.length){if(x(N)||x(C))throw Error("slowDivide_ only works with positive integers.");for(var b=_,A=C;0>=A.l(N);)b=D(b),A=D(A);var L=O(b,1),B=O(A,1);for(A=O(A,2),b=O(b,2);!E(A);){var V=B.add(A);0>=V.l(N)&&(L=L.add(b),B=V),A=O(A,1),b=O(b,1)}return C=R(N,L.j(C)),new v(L,C)}for(L=m;0<=N.l(C);){for(b=Math.max(1,Math.floor(N.m()/C.m())),A=Math.ceil(Math.log(b)/Math.LN2),A=48>=A?1:Math.pow(2,A-48),B=h(b),V=B.j(C);x(V)||0<V.l(N);)b-=A,B=h(b),V=B.j(C);E(B)&&(B=_),L=L.add(B),N=R(N,V)}return new v(L,N)}n.A=function(N){return k(this,N).h},n.and=function(N){for(var C=Math.max(this.g.length,N.g.length),b=[],A=0;A<C;A++)b[A]=this.i(A)&N.i(A);return new o(b,this.h&N.h)},n.or=function(N){for(var C=Math.max(this.g.length,N.g.length),b=[],A=0;A<C;A++)b[A]=this.i(A)|N.i(A);return new o(b,this.h|N.h)},n.xor=function(N){for(var C=Math.max(this.g.length,N.g.length),b=[],A=0;A<C;A++)b[A]=this.i(A)^N.i(A);return new o(b,this.h^N.h)};function D(N){for(var C=N.g.length+1,b=[],A=0;A<C;A++)b[A]=N.i(A)<<1|N.i(A-1)>>>31;return new o(b,N.h)}function O(N,C){var b=C>>5;C%=32;for(var A=N.g.length-b,L=[],B=0;B<A;B++)L[B]=0<C?N.i(B+b)>>>C|N.i(B+b+1)<<32-C:N.i(B+b);return new o(L,N.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,pP=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=p,sl=o}).apply(typeof jT<"u"?jT:typeof self<"u"?self:typeof window<"u"?window:{});var Jp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var gP,jh,mP,kg,Q1,_P,yP,vP;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(d,w,I){return d==Array.prototype||d==Object.prototype||(d[w]=I.value),d};function t(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof Jp=="object"&&Jp];for(var w=0;w<d.length;++w){var I=d[w];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var r=t(this);function i(d,w){if(w)e:{var I=r;d=d.split(".");for(var F=0;F<d.length-1;F++){var H=d[F];if(!(H in I))break e;I=I[H]}d=d[d.length-1],F=I[d],w=w(F),w!=F&&w!=null&&e(I,d,{configurable:!0,writable:!0,value:w})}}function s(d,w){d instanceof String&&(d+="");var I=0,F=!1,H={next:function(){if(!F&&I<d.length){var K=I++;return{value:w(K,d[K]),done:!1}}return F=!0,{done:!0,value:void 0}}};return H[Symbol.iterator]=function(){return H},H}i("Array.prototype.values",function(d){return d||function(){return s(this,function(w,I){return I})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(d){var w=typeof d;return w=w!="object"?w:d?Array.isArray(d)?"array":w:"null",w=="array"||w=="object"&&typeof d.length=="number"}function h(d){var w=typeof d;return w=="object"&&d!=null||w=="function"}function p(d,w,I){return d.call.apply(d.bind,arguments)}function m(d,w,I){if(!d)throw Error();if(2<arguments.length){var F=Array.prototype.slice.call(arguments,2);return function(){var H=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(H,F),d.apply(w,H)}}return function(){return d.apply(w,arguments)}}function _(d,w,I){return _=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:m,_.apply(null,arguments)}function S(d,w){var I=Array.prototype.slice.call(arguments,1);return function(){var F=I.slice();return F.push.apply(F,arguments),d.apply(this,F)}}function E(d,w){function I(){}I.prototype=w.prototype,d.aa=w.prototype,d.prototype=new I,d.prototype.constructor=d,d.Qb=function(F,H,K){for(var ue=Array(arguments.length-2),Xe=2;Xe<arguments.length;Xe++)ue[Xe-2]=arguments[Xe];return w.prototype[H].apply(F,ue)}}function x(d){const w=d.length;if(0<w){const I=Array(w);for(let F=0;F<w;F++)I[F]=d[F];return I}return[]}function M(d,w){for(let I=1;I<arguments.length;I++){const F=arguments[I];if(c(F)){const H=d.length||0,K=F.length||0;d.length=H+K;for(let ue=0;ue<K;ue++)d[H+ue]=F[ue]}else d.push(F)}}class R{constructor(w,I){this.i=w,this.j=I,this.h=0,this.g=null}get(){let w;return 0<this.h?(this.h--,w=this.g,this.g=w.next,w.next=null):w=this.i(),w}}function P(d){return/^[\s\xa0]*$/.test(d)}function v(){var d=l.navigator;return d&&(d=d.userAgent)?d:""}function k(d){return k[" "](d),d}k[" "]=function(){};var D=v().indexOf("Gecko")!=-1&&!(v().toLowerCase().indexOf("webkit")!=-1&&v().indexOf("Edge")==-1)&&!(v().indexOf("Trident")!=-1||v().indexOf("MSIE")!=-1)&&v().indexOf("Edge")==-1;function O(d,w,I){for(const F in d)w.call(I,d[F],F,d)}function N(d,w){for(const I in d)w.call(void 0,d[I],I,d)}function C(d){const w={};for(const I in d)w[I]=d[I];return w}const b="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function A(d,w){let I,F;for(let H=1;H<arguments.length;H++){F=arguments[H];for(I in F)d[I]=F[I];for(let K=0;K<b.length;K++)I=b[K],Object.prototype.hasOwnProperty.call(F,I)&&(d[I]=F[I])}}function L(d){var w=1;d=d.split(":");const I=[];for(;0<w&&d.length;)I.push(d.shift()),w--;return d.length&&I.push(d.join(":")),I}function B(d){l.setTimeout(()=>{throw d},0)}function V(){var d=J;let w=null;return d.g&&(w=d.g,d.g=d.g.next,d.g||(d.h=null),w.next=null),w}class he{constructor(){this.h=this.g=null}add(w,I){const F=le.get();F.set(w,I),this.h?this.h.next=F:this.g=F,this.h=F}}var le=new R(()=>new Te,d=>d.reset());class Te{constructor(){this.next=this.g=this.h=null}set(w,I){this.h=w,this.g=I,this.next=null}reset(){this.next=this.g=this.h=null}}let xe,Y=!1,J=new he,X=()=>{const d=l.Promise.resolve(void 0);xe=()=>{d.then(te)}};var te=()=>{for(var d;d=V();){try{d.h.call(d.g)}catch(I){B(I)}var w=le;w.j(d),100>w.h&&(w.h++,d.next=w.g,w.g=d)}Y=!1};function ie(){this.s=this.s,this.C=this.C}ie.prototype.s=!1,ie.prototype.ma=function(){this.s||(this.s=!0,this.N())},ie.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function se(d,w){this.type=d,this.g=this.target=w,this.defaultPrevented=!1}se.prototype.h=function(){this.defaultPrevented=!0};var ft=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var d=!1,w=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const I=()=>{};l.addEventListener("test",I,w),l.removeEventListener("test",I,w)}catch{}return d}();function ct(d,w){if(se.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d){var I=this.type=d.type,F=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;if(this.target=d.target||d.srcElement,this.g=w,w=d.relatedTarget){if(D){e:{try{k(w.nodeName);var H=!0;break e}catch{}H=!1}H||(w=null)}}else I=="mouseover"?w=d.fromElement:I=="mouseout"&&(w=d.toElement);this.relatedTarget=w,F?(this.clientX=F.clientX!==void 0?F.clientX:F.pageX,this.clientY=F.clientY!==void 0?F.clientY:F.pageY,this.screenX=F.screenX||0,this.screenY=F.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=typeof d.pointerType=="string"?d.pointerType:Qe[d.pointerType]||"",this.state=d.state,this.i=d,d.defaultPrevented&&ct.aa.h.call(this)}}E(ct,se);var Qe={2:"touch",3:"pen",4:"mouse"};ct.prototype.h=function(){ct.aa.h.call(this);var d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var j="closure_listenable_"+(1e6*Math.random()|0),ne=0;function ye(d,w,I,F,H){this.listener=d,this.proxy=null,this.src=w,this.type=I,this.capture=!!F,this.ha=H,this.key=++ne,this.da=this.fa=!1}function Fe(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function Ce(d){this.src=d,this.g={},this.h=0}Ce.prototype.add=function(d,w,I,F,H){var K=d.toString();d=this.g[K],d||(d=this.g[K]=[],this.h++);var ue=ot(d,w,F,H);return-1<ue?(w=d[ue],I||(w.fa=!1)):(w=new ye(w,this.src,K,!!F,H),w.fa=I,d.push(w)),w};function Ze(d,w){var I=w.type;if(I in d.g){var F=d.g[I],H=Array.prototype.indexOf.call(F,w,void 0),K;(K=0<=H)&&Array.prototype.splice.call(F,H,1),K&&(Fe(w),d.g[I].length==0&&(delete d.g[I],d.h--))}}function ot(d,w,I,F){for(var H=0;H<d.length;++H){var K=d[H];if(!K.da&&K.listener==w&&K.capture==!!I&&K.ha==F)return H}return-1}var Ut="closure_lm_"+(1e6*Math.random()|0),et={};function Wn(d,w,I,F,H){if(Array.isArray(w)){for(var K=0;K<w.length;K++)Wn(d,w[K],I,F,H);return null}return I=Df(I),d&&d[j]?d.K(w,I,h(F)?!!F.capture:!1,H):Cr(d,w,I,!1,F,H)}function Cr(d,w,I,F,H,K){if(!w)throw Error("Invalid event type");var ue=h(H)?!!H.capture:!!H,Xe=Vc(d);if(Xe||(d[Ut]=Xe=new Ce(d)),I=Xe.add(w,I,F,ue,K),I.proxy)return I;if(F=Hn(),I.proxy=F,F.src=d,F.listener=I,d.addEventListener)ft||(H=ue),H===void 0&&(H=!1),d.addEventListener(w.toString(),F,H);else if(d.attachEvent)d.attachEvent(bf(w.toString()),F);else if(d.addListener&&d.removeListener)d.addListener(F);else throw Error("addEventListener and attachEvent are unavailable.");return I}function Hn(){function d(I){return w.call(d.src,d.listener,I)}const w=j_;return d}function Ui(d,w,I,F,H){if(Array.isArray(w))for(var K=0;K<w.length;K++)Ui(d,w[K],I,F,H);else F=h(F)?!!F.capture:!!F,I=Df(I),d&&d[j]?(d=d.i,w=String(w).toString(),w in d.g&&(K=d.g[w],I=ot(K,I,F,H),-1<I&&(Fe(K[I]),Array.prototype.splice.call(K,I,1),K.length==0&&(delete d.g[w],d.h--)))):d&&(d=Vc(d))&&(w=d.g[w.toString()],d=-1,w&&(d=ot(w,I,F,H)),(I=-1<d?w[d]:null)&&Ur(I))}function Ur(d){if(typeof d!="number"&&d&&!d.da){var w=d.src;if(w&&w[j])Ze(w.i,d);else{var I=d.type,F=d.proxy;w.removeEventListener?w.removeEventListener(I,F,d.capture):w.detachEvent?w.detachEvent(bf(I),F):w.addListener&&w.removeListener&&w.removeListener(F),(I=Vc(w))?(Ze(I,d),I.h==0&&(I.src=null,w[Ut]=null)):Fe(d)}}}function bf(d){return d in et?et[d]:et[d]="on"+d}function j_(d,w){if(d.da)d=!0;else{w=new ct(w,this);var I=d.listener,F=d.ha||d.src;d.fa&&Ur(d),d=I.call(F,w)}return d}function Vc(d){return d=d[Ut],d instanceof Ce?d:null}var ps="__closure_events_fn_"+(1e9*Math.random()>>>0);function Df(d){return typeof d=="function"?d:(d[ps]||(d[ps]=function(w){return d.handleEvent(w)}),d[ps])}function pn(){ie.call(this),this.i=new Ce(this),this.M=this,this.F=null}E(pn,ie),pn.prototype[j]=!0,pn.prototype.removeEventListener=function(d,w,I,F){Ui(this,d,w,I,F)};function An(d,w){var I,F=d.F;if(F)for(I=[];F;F=F.F)I.push(F);if(d=d.M,F=w.type||w,typeof w=="string")w=new se(w,d);else if(w instanceof se)w.target=w.target||d;else{var H=w;w=new se(F,d),A(w,H)}if(H=!0,I)for(var K=I.length-1;0<=K;K--){var ue=w.g=I[K];H=Vl(ue,F,!0,w)&&H}if(ue=w.g=d,H=Vl(ue,F,!0,w)&&H,H=Vl(ue,F,!1,w)&&H,I)for(K=0;K<I.length;K++)ue=w.g=I[K],H=Vl(ue,F,!1,w)&&H}pn.prototype.N=function(){if(pn.aa.N.call(this),this.i){var d=this.i,w;for(w in d.g){for(var I=d.g[w],F=0;F<I.length;F++)Fe(I[F]);delete d.g[w],d.h--}}this.F=null},pn.prototype.K=function(d,w,I,F){return this.i.add(String(d),w,!1,I,F)},pn.prototype.L=function(d,w,I,F){return this.i.add(String(d),w,!0,I,F)};function Vl(d,w,I,F){if(w=d.i.g[String(w)],!w)return!0;w=w.concat();for(var H=!0,K=0;K<w.length;++K){var ue=w[K];if(ue&&!ue.da&&ue.capture==I){var Xe=ue.listener,Wt=ue.ha||ue.src;ue.fa&&Ze(d.i,ue),H=Xe.call(Wt,F)!==!1&&H}}return H&&!F.defaultPrevented}function Mf(d,w,I){if(typeof d=="function")I&&(d=_(d,I));else if(d&&typeof d.handleEvent=="function")d=_(d.handleEvent,d);else throw Error("Invalid listener argument");return 2147483647<Number(w)?-1:l.setTimeout(d,w||0)}function Of(d){d.g=Mf(()=>{d.g=null,d.i&&(d.i=!1,Of(d))},d.l);const w=d.h;d.h=null,d.m.apply(null,w)}class G_ extends ie{constructor(w,I){super(),this.m=w,this.l=I,this.h=null,this.i=!1,this.g=null}j(w){this.h=arguments,this.g?this.i=!0:Of(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Pa(d){ie.call(this),this.h=d,this.g={}}E(Pa,ie);var Lf=[];function Ff(d){O(d.g,function(w,I){this.g.hasOwnProperty(I)&&Ur(w)},d),d.g={}}Pa.prototype.N=function(){Pa.aa.N.call(this),Ff(this)},Pa.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Uc=l.JSON.stringify,W_=l.JSON.parse,Vf=class{stringify(d){return l.JSON.stringify(d,void 0)}parse(d){return l.JSON.parse(d,void 0)}};function Bc(){}Bc.prototype.h=null;function Uf(d){return d.h||(d.h=d.i())}function Bf(){}var Ra={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function zc(){se.call(this,"d")}E(zc,se);function jc(){se.call(this,"c")}E(jc,se);var Bi={},Gc=null;function Ul(){return Gc=Gc||new pn}Bi.La="serverreachability";function Bl(d){se.call(this,Bi.La,d)}E(Bl,se);function uo(d){const w=Ul();An(w,new Bl(w))}Bi.STAT_EVENT="statevent";function Wc(d,w){se.call(this,Bi.STAT_EVENT,d),this.stat=w}E(Wc,se);function Nn(d){const w=Ul();An(w,new Wc(w,d))}Bi.Ma="timingevent";function zf(d,w){se.call(this,Bi.Ma,d),this.size=w}E(zf,se);function xa(d,w){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){d()},w)}function co(){this.g=!0}co.prototype.xa=function(){this.g=!1};function Hc(d,w,I,F,H,K){d.info(function(){if(d.g)if(K)for(var ue="",Xe=K.split("&"),Wt=0;Wt<Xe.length;Wt++){var Ge=Xe[Wt].split("=");if(1<Ge.length){var sn=Ge[0];Ge=Ge[1];var Xt=sn.split("_");ue=2<=Xt.length&&Xt[1]=="type"?ue+(sn+"="+Ge+"&"):ue+(sn+"=redacted&")}}else ue=null;else ue=K;return"XMLHTTP REQ ("+F+") [attempt "+H+"]: "+w+`
`+I+`
`+ue})}function H_(d,w,I,F,H,K,ue){d.info(function(){return"XMLHTTP RESP ("+F+") [ attempt "+H+"]: "+w+`
`+I+`
`+K+" "+ue})}function ho(d,w,I,F){d.info(function(){return"XMLHTTP TEXT ("+w+"): "+$_(d,I)+(F?" "+F:"")})}function zl(d,w){d.info(function(){return"TIMEOUT: "+w})}co.prototype.info=function(){};function $_(d,w){if(!d.g)return w;if(!w)return null;try{var I=JSON.parse(w);if(I){for(d=0;d<I.length;d++)if(Array.isArray(I[d])){var F=I[d];if(!(2>F.length)){var H=F[1];if(Array.isArray(H)&&!(1>H.length)){var K=H[0];if(K!="noop"&&K!="stop"&&K!="close")for(var ue=1;ue<H.length;ue++)H[ue]=""}}}}return Uc(I)}catch{return w}}var jl={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},jf={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},$c;function Gl(){}E(Gl,Bc),Gl.prototype.g=function(){return new XMLHttpRequest},Gl.prototype.i=function(){return{}},$c=new Gl;function zi(d,w,I,F){this.j=d,this.i=w,this.l=I,this.R=F||1,this.U=new Pa(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Gf}function Gf(){this.i=null,this.g="",this.h=!1}var Wf={},qc={};function Kc(d,w,I){d.L=1,d.v=$l(Tr(w)),d.m=I,d.P=!0,Hf(d,null)}function Hf(d,w){d.F=Date.now(),Wl(d),d.A=Tr(d.v);var I=d.A,F=d.R;Array.isArray(F)||(F=[String(F)]),qe(I.i,"t",F),d.C=0,I=d.j.J,d.h=new Gf,d.g=ih(d.j,I?w:null,!d.m),0<d.O&&(d.M=new G_(_(d.Y,d,d.g),d.O)),w=d.U,I=d.g,F=d.ca;var H="readystatechange";Array.isArray(H)||(H&&(Lf[0]=H.toString()),H=Lf);for(var K=0;K<H.length;K++){var ue=Wn(I,H[K],F||w.handleEvent,!1,w.h||w);if(!ue)break;w.g[ue.key]=ue}w=d.H?C(d.H):{},d.m?(d.u||(d.u="POST"),w["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.A,d.u,d.m,w)):(d.u="GET",d.g.ea(d.A,d.u,null,w)),uo(),Hc(d.i,d.u,d.A,d.l,d.R,d.m)}zi.prototype.ca=function(d){d=d.target;const w=this.M;w&&Kn(d)==3?w.j():this.Y(d)},zi.prototype.Y=function(d){try{if(d==this.g)e:{const Xt=Kn(this.g);var w=this.g.Ba();const qi=this.g.Z();if(!(3>Xt)&&(Xt!=3||this.g&&(this.h.h||this.g.oa()||Ma(this.g)))){this.J||Xt!=4||w==7||(w==8||0>=qi?uo(3):uo(2)),gs(this);var I=this.g.Z();this.X=I;t:if($f(this)){var F=Ma(this.g);d="";var H=F.length,K=Kn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){fi(this),ms(this);var ue="";break t}this.h.i=new l.TextDecoder}for(w=0;w<H;w++)this.h.h=!0,d+=this.h.i.decode(F[w],{stream:!(K&&w==H-1)});F.length=0,this.h.g+=d,this.C=0,ue=this.h.g}else ue=this.g.oa();if(this.o=I==200,H_(this.i,this.u,this.A,this.l,this.R,Xt,I),this.o){if(this.T&&!this.K){t:{if(this.g){var Xe,Wt=this.g;if((Xe=Wt.g?Wt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(Xe)){var Ge=Xe;break t}}Ge=null}if(I=Ge)ho(this.i,this.l,I,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Qc(this,I);else{this.o=!1,this.s=3,Nn(12),fi(this),ms(this);break e}}if(this.P){I=!0;let mn;for(;!this.J&&this.C<ue.length;)if(mn=q_(this,ue),mn==qc){Xt==4&&(this.s=4,Nn(14),I=!1),ho(this.i,this.l,null,"[Incomplete Response]");break}else if(mn==Wf){this.s=4,Nn(15),ho(this.i,this.l,ue,"[Invalid Chunk]"),I=!1;break}else ho(this.i,this.l,mn,null),Qc(this,mn);if($f(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Xt!=4||ue.length!=0||this.h.h||(this.s=1,Nn(16),I=!1),this.o=this.o&&I,!I)ho(this.i,this.l,ue,"[Invalid Chunked Response]"),fi(this),ms(this);else if(0<ue.length&&!this.W){this.W=!0;var sn=this.j;sn.g==this&&sn.ba&&!sn.M&&(sn.j.info("Great, no buffering proxy detected. Bytes received: "+ue.length),Cs(sn),sn.M=!0,Nn(11))}}else ho(this.i,this.l,ue,null),Qc(this,ue);Xt==4&&fi(this),this.o&&!this.J&&(Xt==4?nh(this.j,this):(this.o=!1,Wl(this)))}else Xl(this.g),I==400&&0<ue.indexOf("Unknown SID")?(this.s=3,Nn(12)):(this.s=0,Nn(13)),fi(this),ms(this)}}}catch{}finally{}};function $f(d){return d.g?d.u=="GET"&&d.L!=2&&d.j.Ca:!1}function q_(d,w){var I=d.C,F=w.indexOf(`
`,I);return F==-1?qc:(I=Number(w.substring(I,F)),isNaN(I)?Wf:(F+=1,F+I>w.length?qc:(w=w.slice(F,F+I),d.C=F+I,w)))}zi.prototype.cancel=function(){this.J=!0,fi(this)};function Wl(d){d.S=Date.now()+d.I,Hl(d,d.I)}function Hl(d,w){if(d.B!=null)throw Error("WatchDog timer not null");d.B=xa(_(d.ba,d),w)}function gs(d){d.B&&(l.clearTimeout(d.B),d.B=null)}zi.prototype.ba=function(){this.B=null;const d=Date.now();0<=d-this.S?(zl(this.i,this.A),this.L!=2&&(uo(),Nn(17)),fi(this),this.s=2,ms(this)):Hl(this,this.S-d)};function ms(d){d.j.G==0||d.J||nh(d.j,d)}function fi(d){gs(d);var w=d.M;w&&typeof w.ma=="function"&&w.ma(),d.M=null,Ff(d.U),d.g&&(w=d.g,d.g=null,w.abort(),w.ma())}function Qc(d,w){try{var I=d.j;if(I.G!=0&&(I.g==d||ut(I.h,d))){if(!d.K&&ut(I.h,d)&&I.G==3){try{var F=I.Da.g.parse(w)}catch{F=null}if(Array.isArray(F)&&F.length==3){var H=F;if(H[0]==0){e:if(!I.u){if(I.g)if(I.g.F+3e3<d.F)Oa(I),kr(I);else break e;gt(I),Nn(18)}}else I.za=H[1],0<I.za-I.T&&37500>H[2]&&I.F&&I.v==0&&!I.C&&(I.C=xa(_(I.Za,I),6e3));if(1>=pt(I.h)&&I.ca){try{I.ca()}catch{}I.ca=void 0}}else _i(I,11)}else if((d.K||I.g==d)&&Oa(I),!P(w))for(H=I.Da.g.parse(w),w=0;w<H.length;w++){let Ge=H[w];if(I.T=Ge[0],Ge=Ge[1],I.G==2)if(Ge[0]=="c"){I.K=Ge[1],I.ia=Ge[2];const sn=Ge[3];sn!=null&&(I.la=sn,I.j.info("VER="+I.la));const Xt=Ge[4];Xt!=null&&(I.Aa=Xt,I.j.info("SVER="+I.Aa));const qi=Ge[5];qi!=null&&typeof qi=="number"&&0<qi&&(F=1.5*qi,I.L=F,I.j.info("backChannelRequestTimeoutMs_="+F)),F=I;const mn=d.g;if(mn){const Mn=mn.g?mn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Mn){var K=F.h;K.g||Mn.indexOf("spdy")==-1&&Mn.indexOf("quic")==-1&&Mn.indexOf("h2")==-1||(K.j=K.l,K.g=new Set,K.h&&(Qr(K,K.h),K.h=null))}if(F.D){const yi=mn.g?mn.g.getResponseHeader("X-HTTP-Session-Id"):null;yi&&(F.ya=yi,_t(F.I,F.D,yi))}}I.G=3,I.l&&I.l.ua(),I.ba&&(I.R=Date.now()-d.F,I.j.info("Handshake RTT: "+I.R+"ms")),F=I;var ue=d;if(F.qa=La(F,F.J?F.ia:null,F.W),ue.K){rn(F.h,ue);var Xe=ue,Wt=F.L;Wt&&(Xe.I=Wt),Xe.B&&(gs(Xe),Wl(Xe)),F.g=ue}else pr(F);0<I.i.length&&Xr(I)}else Ge[0]!="stop"&&Ge[0]!="close"||_i(I,7);else I.G==3&&(Ge[0]=="stop"||Ge[0]=="close"?Ge[0]=="stop"?_i(I,7):mi(I):Ge[0]!="noop"&&I.l&&I.l.ta(Ge),I.v=0)}}uo(4)}catch{}}var Yc=class{constructor(d,w){this.g=d,this.map=w}};function _s(d){this.l=d||10,l.PerformanceNavigationTiming?(d=l.performance.getEntriesByType("navigation"),d=0<d.length&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function pi(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function pt(d){return d.h?1:d.g?d.g.size:0}function ut(d,w){return d.h?d.h==w:d.g?d.g.has(w):!1}function Qr(d,w){d.g?d.g.add(w):d.h=w}function rn(d,w){d.h&&d.h==w?d.h=null:d.g&&d.g.has(w)&&d.g.delete(w)}_s.prototype.cancel=function(){if(this.i=bn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function bn(d){if(d.h!=null)return d.i.concat(d.h.D);if(d.g!=null&&d.g.size!==0){let w=d.i;for(const I of d.g.values())w=w.concat(I.D);return w}return x(d.i)}function ys(d){if(d.V&&typeof d.V=="function")return d.V();if(typeof Map<"u"&&d instanceof Map||typeof Set<"u"&&d instanceof Set)return Array.from(d.values());if(typeof d=="string")return d.split("");if(c(d)){for(var w=[],I=d.length,F=0;F<I;F++)w.push(d[F]);return w}w=[],I=0;for(F in d)w[I++]=d[F];return w}function fo(d){if(d.na&&typeof d.na=="function")return d.na();if(!d.V||typeof d.V!="function"){if(typeof Map<"u"&&d instanceof Map)return Array.from(d.keys());if(!(typeof Set<"u"&&d instanceof Set)){if(c(d)||typeof d=="string"){var w=[];d=d.length;for(var I=0;I<d;I++)w.push(I);return w}w=[],I=0;for(const F in d)w[I++]=F;return w}}}function Dn(d,w){if(d.forEach&&typeof d.forEach=="function")d.forEach(w,void 0);else if(c(d)||typeof d=="string")Array.prototype.forEach.call(d,w,void 0);else for(var I=fo(d),F=ys(d),H=F.length,K=0;K<H;K++)w.call(void 0,F[K],I&&I[K],d)}var Aa=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function qf(d,w){if(d){d=d.split("&");for(var I=0;I<d.length;I++){var F=d[I].indexOf("="),H=null;if(0<=F){var K=d[I].substring(0,F);H=d[I].substring(F+1)}else K=d[I];w(K,H?decodeURIComponent(H.replace(/\+/g," ")):"")}}}function ji(d){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,d instanceof ji){this.h=d.h,Na(this,d.j),this.o=d.o,this.g=d.g,$n(this,d.s),this.l=d.l;var w=d.i,I=new vs;I.i=w.i,w.g&&(I.g=new Map(w.g),I.h=w.h),Kf(this,I),this.m=d.m}else d&&(w=String(d).match(Aa))?(this.h=!1,Na(this,w[1]||"",!0),this.o=Gi(w[2]||""),this.g=Gi(w[3]||"",!0),$n(this,w[4]),this.l=Gi(w[5]||"",!0),Kf(this,w[6]||"",!0),this.m=Gi(w[7]||"")):(this.h=!1,this.i=new vs(null,this.h))}ji.prototype.toString=function(){var d=[],w=this.j;w&&d.push(Wi(w,Da,!0),":");var I=this.g;return(I||w=="file")&&(d.push("//"),(w=this.o)&&d.push(Wi(w,Da,!0),"@"),d.push(encodeURIComponent(String(I)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),I=this.s,I!=null&&d.push(":",String(I))),(I=this.l)&&(this.g&&I.charAt(0)!="/"&&d.push("/"),d.push(Wi(I,I.charAt(0)=="/"?Q_:K_,!0))),(I=this.i.toString())&&d.push("?",I),(I=this.m)&&d.push("#",Wi(I,Qf)),d.join("")};function Tr(d){return new ji(d)}function Na(d,w,I){d.j=I?Gi(w,!0):w,d.j&&(d.j=d.j.replace(/:$/,""))}function $n(d,w){if(w){if(w=Number(w),isNaN(w)||0>w)throw Error("Bad port number "+w);d.s=w}else d.s=null}function Kf(d,w,I){w instanceof vs?(d.i=w,Jc(d.i,d.h)):(I||(w=Wi(w,Xc)),d.i=new vs(w,d.h))}function _t(d,w,I){d.i.set(w,I)}function $l(d){return _t(d,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),d}function Gi(d,w){return d?w?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function Wi(d,w,I){return typeof d=="string"?(d=encodeURI(d).replace(w,ba),I&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function ba(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var Da=/[#\/\?@]/g,K_=/[#\?:]/g,Q_=/[#\?]/g,Xc=/[#\?@]/g,Qf=/#/g;function vs(d,w){this.h=this.g=null,this.i=d||null,this.j=!!w}function Ir(d){d.g||(d.g=new Map,d.h=0,d.i&&qf(d.i,function(w,I){d.add(decodeURIComponent(w.replace(/\+/g," ")),I)}))}n=vs.prototype,n.add=function(d,w){Ir(this),this.i=null,d=ws(this,d);var I=this.g.get(d);return I||this.g.set(d,I=[]),I.push(w),this.h+=1,this};function Yf(d,w){Ir(d),w=ws(d,w),d.g.has(w)&&(d.i=null,d.h-=d.g.get(w).length,d.g.delete(w))}function ql(d,w){return Ir(d),w=ws(d,w),d.g.has(w)}n.forEach=function(d,w){Ir(this),this.g.forEach(function(I,F){I.forEach(function(H){d.call(w,H,F,this)},this)},this)},n.na=function(){Ir(this);const d=Array.from(this.g.values()),w=Array.from(this.g.keys()),I=[];for(let F=0;F<w.length;F++){const H=d[F];for(let K=0;K<H.length;K++)I.push(w[F])}return I},n.V=function(d){Ir(this);let w=[];if(typeof d=="string")ql(this,d)&&(w=w.concat(this.g.get(ws(this,d))));else{d=Array.from(this.g.values());for(let I=0;I<d.length;I++)w=w.concat(d[I])}return w},n.set=function(d,w){return Ir(this),this.i=null,d=ws(this,d),ql(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[w]),this.h+=1,this},n.get=function(d,w){return d?(d=this.V(d),0<d.length?String(d[0]):w):w};function qe(d,w,I){Yf(d,w),0<I.length&&(d.i=null,d.g.set(ws(d,w),x(I)),d.h+=I.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],w=Array.from(this.g.keys());for(var I=0;I<w.length;I++){var F=w[I];const K=encodeURIComponent(String(F)),ue=this.V(F);for(F=0;F<ue.length;F++){var H=K;ue[F]!==""&&(H+="="+encodeURIComponent(String(ue[F]))),d.push(H)}}return this.i=d.join("&")};function ws(d,w){return w=String(w),d.j&&(w=w.toLowerCase()),w}function Jc(d,w){w&&!d.j&&(Ir(d),d.i=null,d.g.forEach(function(I,F){var H=F.toLowerCase();F!=H&&(Yf(this,F),qe(this,H,I))},d)),d.j=w}function Xf(d,w){const I=new co;if(l.Image){const F=new Image;F.onload=S(Hi,I,"TestLoadImage: loaded",!0,w,F),F.onerror=S(Hi,I,"TestLoadImage: error",!1,w,F),F.onabort=S(Hi,I,"TestLoadImage: abort",!1,w,F),F.ontimeout=S(Hi,I,"TestLoadImage: timeout",!1,w,F),l.setTimeout(function(){F.ontimeout&&F.ontimeout()},1e4),F.src=d}else w(!1)}function Y_(d,w){const I=new co,F=new AbortController,H=setTimeout(()=>{F.abort(),Hi(I,"TestPingServer: timeout",!1,w)},1e4);fetch(d,{signal:F.signal}).then(K=>{clearTimeout(H),K.ok?Hi(I,"TestPingServer: ok",!0,w):Hi(I,"TestPingServer: server error",!1,w)}).catch(()=>{clearTimeout(H),Hi(I,"TestPingServer: error",!1,w)})}function Hi(d,w,I,F,H){try{H&&(H.onload=null,H.onerror=null,H.onabort=null,H.ontimeout=null),F(I)}catch{}}function Yt(){this.g=new Vf}function Zc(d,w,I){const F=I||"";try{Dn(d,function(H,K){let ue=H;h(H)&&(ue=Uc(H)),w.push(F+K+"="+encodeURIComponent(ue))})}catch(H){throw w.push(F+"type="+encodeURIComponent("_badmap")),H}}function Kl(d){this.l=d.Ub||null,this.j=d.eb||!1}E(Kl,Bc),Kl.prototype.g=function(){return new po(this.l,this.j)},Kl.prototype.i=function(d){return function(){return d}}({});function po(d,w){pn.call(this),this.D=d,this.o=w,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}E(po,pn),n=po.prototype,n.open=function(d,w){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=d,this.A=w,this.readyState=1,qn(this)},n.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const w={headers:this.u,method:this.B,credentials:this.m,cache:void 0};d&&(w.body=d),(this.D||l).fetch(new Request(this.A,w)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,$i(this)),this.readyState=0},n.Sa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,qn(this)),this.g&&(this.readyState=3,qn(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Jf(this)}else d.text().then(this.Ra.bind(this),this.ga.bind(this))};function Jf(d){d.j.read().then(d.Pa.bind(d)).catch(d.ga.bind(d))}n.Pa=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var w=d.value?d.value:new Uint8Array(0);(w=this.v.decode(w,{stream:!d.done}))&&(this.response=this.responseText+=w)}d.done?$i(this):qn(this),this.readyState==3&&Jf(this)}},n.Ra=function(d){this.g&&(this.response=this.responseText=d,$i(this))},n.Qa=function(d){this.g&&(this.response=d,$i(this))},n.ga=function(){this.g&&$i(this)};function $i(d){d.readyState=4,d.l=null,d.j=null,d.v=null,qn(d)}n.setRequestHeader=function(d,w){this.u.append(d,w)},n.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],w=this.h.entries();for(var I=w.next();!I.done;)I=I.value,d.push(I[0]+": "+I[1]),I=w.next();return d.join(`\r
`)};function qn(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(po.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function Zf(d){let w="";return O(d,function(I,F){w+=F,w+=":",w+=I,w+=`\r
`}),w}function eh(d,w,I){e:{for(F in I){var F=!1;break e}F=!0}F||(I=Zf(I),typeof d=="string"?I!=null&&encodeURIComponent(String(I)):_t(d,w,I))}function Ye(d){pn.call(this),this.headers=new Map,this.o=d||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}E(Ye,pn);var gi=/^https?$/i,Ql=["POST","PUT"];n=Ye.prototype,n.Ha=function(d){this.J=d},n.ea=function(d,w,I,F){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);w=w?w.toUpperCase():"GET",this.D=d,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():$c.g(),this.v=this.o?Uf(this.o):Uf($c),this.g.onreadystatechange=_(this.Ea,this);try{this.B=!0,this.g.open(w,String(d),!0),this.B=!1}catch(K){Yl(this,K);return}if(d=I||"",I=new Map(this.headers),F)if(Object.getPrototypeOf(F)===Object.prototype)for(var H in F)I.set(H,F[H]);else if(typeof F.keys=="function"&&typeof F.get=="function")for(const K of F.keys())I.set(K,F.get(K));else throw Error("Unknown input type for opt_headers: "+String(F));F=Array.from(I.keys()).find(K=>K.toLowerCase()=="content-type"),H=l.FormData&&d instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Ql,w,void 0))||F||H||I.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[K,ue]of I)this.g.setRequestHeader(K,ue);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Es(this),this.u=!0,this.g.send(d),this.u=!1}catch(K){Yl(this,K)}};function Yl(d,w){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=w,d.m=5,th(d),dr(d)}function th(d){d.A||(d.A=!0,An(d,"complete"),An(d,"error"))}n.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=d||7,An(this,"complete"),An(this,"abort"),dr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),dr(this,!0)),Ye.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?ep(this):this.bb())},n.bb=function(){ep(this)};function ep(d){if(d.h&&typeof o<"u"&&(!d.v[1]||Kn(d)!=4||d.Z()!=2)){if(d.u&&Kn(d)==4)Mf(d.Ea,0,d);else if(An(d,"readystatechange"),Kn(d)==4){d.h=!1;try{const ue=d.Z();e:switch(ue){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var w=!0;break e;default:w=!1}var I;if(!(I=w)){var F;if(F=ue===0){var H=String(d.D).match(Aa)[1]||null;!H&&l.self&&l.self.location&&(H=l.self.location.protocol.slice(0,-1)),F=!gi.test(H?H.toLowerCase():"")}I=F}if(I)An(d,"complete"),An(d,"success");else{d.m=6;try{var K=2<Kn(d)?d.g.statusText:""}catch{K=""}d.l=K+" ["+d.Z()+"]",th(d)}}finally{dr(d)}}}}function dr(d,w){if(d.g){Es(d);const I=d.g,F=d.v[0]?()=>{}:null;d.g=null,d.v=null,w||An(d,"ready");try{I.onreadystatechange=F}catch{}}}function Es(d){d.I&&(l.clearTimeout(d.I),d.I=null)}n.isActive=function(){return!!this.g};function Kn(d){return d.g?d.g.readyState:0}n.Z=function(){try{return 2<Kn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(d){if(this.g){var w=this.g.responseText;return d&&w.indexOf(d)==0&&(w=w.substring(d.length)),W_(w)}};function Ma(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.H){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function Xl(d){const w={};d=(d.g&&2<=Kn(d)&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let F=0;F<d.length;F++){if(P(d[F]))continue;var I=L(d[F]);const H=I[0];if(I=I[1],typeof I!="string")continue;I=I.trim();const K=w[H]||[];w[H]=K,K.push(I)}N(w,function(F){return F.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function gn(d,w,I){return I&&I.internalChannelParams&&I.internalChannelParams[d]||w}function fr(d){this.Aa=0,this.i=[],this.j=new co,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=gn("failFast",!1,d),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=gn("baseRetryDelayMs",5e3,d),this.cb=gn("retryDelaySeedMs",1e4,d),this.Wa=gn("forwardChannelMaxRetries",2,d),this.wa=gn("forwardChannelRequestTimeoutMs",2e4,d),this.pa=d&&d.xmlHttpFactory||void 0,this.Xa=d&&d.Tb||void 0,this.Ca=d&&d.useFetchStreams||!1,this.L=void 0,this.J=d&&d.supportsCrossDomainXhr||!1,this.K="",this.h=new _s(d&&d.concurrentRequestLimit),this.Da=new Yt,this.P=d&&d.fastHandshake||!1,this.O=d&&d.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=d&&d.Rb||!1,d&&d.xa&&this.j.xa(),d&&d.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&d&&d.detectBufferingProxy||!1,this.ja=void 0,d&&d.longPollingTimeout&&0<d.longPollingTimeout&&(this.ja=d.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=fr.prototype,n.la=8,n.G=1,n.connect=function(d,w,I,F){Nn(0),this.W=d,this.H=w||{},I&&F!==void 0&&(this.H.OSID=I,this.H.OAID=F),this.F=this.X,this.I=La(this,null,this.W),Xr(this)};function mi(d){if(Yr(d),d.G==3){var w=d.U++,I=Tr(d.I);if(_t(I,"SID",d.K),_t(I,"RID",w),_t(I,"TYPE","terminate"),Ss(d,I),w=new zi(d,d.j,w),w.L=2,w.v=$l(Tr(I)),I=!1,l.navigator&&l.navigator.sendBeacon)try{I=l.navigator.sendBeacon(w.v.toString(),"")}catch{}!I&&l.Image&&(new Image().src=w.v,I=!0),I||(w.g=ih(w.j,null),w.g.ea(w.v)),w.F=Date.now(),Wl(w)}rh(d)}function kr(d){d.g&&(Cs(d),d.g.cancel(),d.g=null)}function Yr(d){kr(d),d.u&&(l.clearTimeout(d.u),d.u=null),Oa(d),d.h.cancel(),d.s&&(typeof d.s=="number"&&l.clearTimeout(d.s),d.s=null)}function Xr(d){if(!pi(d.h)&&!d.s){d.s=!0;var w=d.Ga;xe||X(),Y||(xe(),Y=!0),J.add(w,d),d.B=0}}function tp(d,w){return pt(d.h)>=d.h.j-(d.s?1:0)?!1:d.s?(d.i=w.D.concat(d.i),!0):d.G==1||d.G==2||d.B>=(d.Va?0:d.Wa)?!1:(d.s=xa(_(d.Ga,d,w),Zl(d,d.B)),d.B++,!0)}n.Ga=function(d){if(this.s)if(this.s=null,this.G==1){if(!d){this.U=Math.floor(1e5*Math.random()),d=this.U++;const H=new zi(this,this.j,d);let K=this.o;if(this.S&&(K?(K=C(K),A(K,this.S)):K=this.S),this.m!==null||this.O||(H.H=K,K=null),this.P)e:{for(var w=0,I=0;I<this.i.length;I++){t:{var F=this.i[I];if("__data__"in F.map&&(F=F.map.__data__,typeof F=="string")){F=F.length;break t}F=void 0}if(F===void 0)break;if(w+=F,4096<w){w=I;break e}if(w===4096||I===this.i.length-1){w=I+1;break e}}w=1e3}else w=1e3;w=Qn(this,H,w),I=Tr(this.I),_t(I,"RID",d),_t(I,"CVER",22),this.D&&_t(I,"X-HTTP-Session-Id",this.D),Ss(this,I),K&&(this.O?w="headers="+encodeURIComponent(String(Zf(K)))+"&"+w:this.m&&eh(I,this.m,K)),Qr(this.h,H),this.Ua&&_t(I,"TYPE","init"),this.P?(_t(I,"$req",w),_t(I,"SID","null"),H.T=!0,Kc(H,I,null)):Kc(H,I,w),this.G=2}}else this.G==3&&(d?Jl(this,d):this.i.length==0||pi(this.h)||Jl(this))};function Jl(d,w){var I;w?I=w.l:I=d.U++;const F=Tr(d.I);_t(F,"SID",d.K),_t(F,"RID",I),_t(F,"AID",d.T),Ss(d,F),d.m&&d.o&&eh(F,d.m,d.o),I=new zi(d,d.j,I,d.B+1),d.m===null&&(I.H=d.o),w&&(d.i=w.D.concat(d.i)),w=Qn(d,I,1e3),I.I=Math.round(.5*d.wa)+Math.round(.5*d.wa*Math.random()),Qr(d.h,I),Kc(I,F,w)}function Ss(d,w){d.H&&O(d.H,function(I,F){_t(w,F,I)}),d.l&&Dn({},function(I,F){_t(w,F,I)})}function Qn(d,w,I){I=Math.min(d.i.length,I);var F=d.l?_(d.l.Na,d.l,d):null;e:{var H=d.i;let K=-1;for(;;){const ue=["count="+I];K==-1?0<I?(K=H[0].g,ue.push("ofs="+K)):K=0:ue.push("ofs="+K);let Xe=!0;for(let Wt=0;Wt<I;Wt++){let Ge=H[Wt].g;const sn=H[Wt].map;if(Ge-=K,0>Ge)K=Math.max(0,H[Wt].g-100),Xe=!1;else try{Zc(sn,ue,"req"+Ge+"_")}catch{F&&F(sn)}}if(Xe){F=ue.join("&");break e}}}return d=d.i.splice(0,I),w.D=d,F}function pr(d){if(!d.g&&!d.u){d.Y=1;var w=d.Fa;xe||X(),Y||(xe(),Y=!0),J.add(w,d),d.v=0}}function gt(d){return d.g||d.u||3<=d.v?!1:(d.Y++,d.u=xa(_(d.Fa,d),Zl(d,d.v)),d.v++,!0)}n.Fa=function(){if(this.u=null,Pr(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var d=2*this.R;this.j.info("BP detection timer enabled: "+d),this.A=xa(_(this.ab,this),d)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Nn(10),kr(this),Pr(this))};function Cs(d){d.A!=null&&(l.clearTimeout(d.A),d.A=null)}function Pr(d){d.g=new zi(d,d.j,"rpc",d.Y),d.m===null&&(d.g.H=d.o),d.g.O=0;var w=Tr(d.qa);_t(w,"RID","rpc"),_t(w,"SID",d.K),_t(w,"AID",d.T),_t(w,"CI",d.F?"0":"1"),!d.F&&d.ja&&_t(w,"TO",d.ja),_t(w,"TYPE","xmlhttp"),Ss(d,w),d.m&&d.o&&eh(w,d.m,d.o),d.L&&(d.g.I=d.L);var I=d.g;d=d.ia,I.L=1,I.v=$l(Tr(w)),I.m=null,I.P=!0,Hf(I,d)}n.Za=function(){this.C!=null&&(this.C=null,kr(this),gt(this),Nn(19))};function Oa(d){d.C!=null&&(l.clearTimeout(d.C),d.C=null)}function nh(d,w){var I=null;if(d.g==w){Oa(d),Cs(d),d.g=null;var F=2}else if(ut(d.h,w))I=w.D,rn(d.h,w),F=1;else return;if(d.G!=0){if(w.o)if(F==1){I=w.m?w.m.length:0,w=Date.now()-w.F;var H=d.B;F=Ul(),An(F,new zf(F,I)),Xr(d)}else pr(d);else if(H=w.s,H==3||H==0&&0<w.X||!(F==1&&tp(d,w)||F==2&&gt(d)))switch(I&&0<I.length&&(w=d.h,w.i=w.i.concat(I)),H){case 1:_i(d,5);break;case 4:_i(d,10);break;case 3:_i(d,6);break;default:_i(d,2)}}}function Zl(d,w){let I=d.Ta+Math.floor(Math.random()*d.cb);return d.isActive()||(I*=2),I*w}function _i(d,w){if(d.j.info("Error code "+w),w==2){var I=_(d.fb,d),F=d.Xa;const H=!F;F=new ji(F||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Na(F,"https"),$l(F),H?Xf(F.toString(),I):Y_(F.toString(),I)}else Nn(2);d.G=0,d.l&&d.l.sa(w),rh(d),Yr(d)}n.fb=function(d){d?(this.j.info("Successfully pinged google.com"),Nn(2)):(this.j.info("Failed to ping google.com"),Nn(1))};function rh(d){if(d.G=0,d.ka=[],d.l){const w=bn(d.h);(w.length!=0||d.i.length!=0)&&(M(d.ka,w),M(d.ka,d.i),d.h.i.length=0,x(d.i),d.i.length=0),d.l.ra()}}function La(d,w,I){var F=I instanceof ji?Tr(I):new ji(I);if(F.g!="")w&&(F.g=w+"."+F.g),$n(F,F.s);else{var H=l.location;F=H.protocol,w=w?w+"."+H.hostname:H.hostname,H=+H.port;var K=new ji(null);F&&Na(K,F),w&&(K.g=w),H&&$n(K,H),I&&(K.l=I),F=K}return I=d.D,w=d.ya,I&&w&&_t(F,I,w),_t(F,"VER",d.la),Ss(d,F),F}function ih(d,w,I){if(w&&!d.J)throw Error("Can't create secondary domain capable XhrIo object.");return w=d.Ca&&!d.pa?new Ye(new Kl({eb:I})):new Ye(d.pa),w.Ha(d.J),w}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ts(){}n=Ts.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function go(){}go.prototype.g=function(d,w){return new gr(d,w)};function gr(d,w){pn.call(this),this.g=new fr(w),this.l=d,this.h=w&&w.messageUrlParams||null,d=w&&w.messageHeaders||null,w&&w.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=w&&w.initMessageHeaders||null,w&&w.messageContentType&&(d?d["X-WebChannel-Content-Type"]=w.messageContentType:d={"X-WebChannel-Content-Type":w.messageContentType}),w&&w.va&&(d?d["X-WebChannel-Client-Profile"]=w.va:d={"X-WebChannel-Client-Profile":w.va}),this.g.S=d,(d=w&&w.Sb)&&!P(d)&&(this.g.m=d),this.v=w&&w.supportsCrossDomainXhr||!1,this.u=w&&w.sendRawJson||!1,(w=w&&w.httpSessionIdParam)&&!P(w)&&(this.g.D=w,d=this.h,d!==null&&w in d&&(d=this.h,w in d&&delete d[w])),this.j=new Jr(this)}E(gr,pn),gr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gr.prototype.close=function(){mi(this.g)},gr.prototype.o=function(d){var w=this.g;if(typeof d=="string"){var I={};I.__data__=d,d=I}else this.u&&(I={},I.__data__=Uc(d),d=I);w.i.push(new Yc(w.Ya++,d)),w.G==3&&Xr(w)},gr.prototype.N=function(){this.g.l=null,delete this.j,mi(this.g),delete this.g,gr.aa.N.call(this)};function Fa(d){zc.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var w=d.__sm__;if(w){e:{for(const I in w){d=I;break e}d=void 0}(this.i=d)&&(d=this.i,w=w!==null&&d in w?w[d]:void 0),this.data=w}else this.data=d}E(Fa,zc);function np(){jc.call(this),this.status=1}E(np,jc);function Jr(d){this.g=d}E(Jr,Ts),Jr.prototype.ua=function(){An(this.g,"a")},Jr.prototype.ta=function(d){An(this.g,new Fa(d))},Jr.prototype.sa=function(d){An(this.g,new np)},Jr.prototype.ra=function(){An(this.g,"b")},go.prototype.createWebChannel=go.prototype.g,gr.prototype.send=gr.prototype.o,gr.prototype.open=gr.prototype.m,gr.prototype.close=gr.prototype.close,vP=function(){return new go},yP=function(){return Ul()},_P=Bi,Q1={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},jl.NO_ERROR=0,jl.TIMEOUT=8,jl.HTTP_ERROR=6,kg=jl,jf.COMPLETE="complete",mP=jf,Bf.EventType=Ra,Ra.OPEN="a",Ra.CLOSE="b",Ra.ERROR="c",Ra.MESSAGE="d",pn.prototype.listen=pn.prototype.K,jh=Bf,Ye.prototype.listenOnce=Ye.prototype.L,Ye.prototype.getLastError=Ye.prototype.Ka,Ye.prototype.getLastErrorCode=Ye.prototype.Ba,Ye.prototype.getStatus=Ye.prototype.Z,Ye.prototype.getResponseJson=Ye.prototype.Oa,Ye.prototype.getResponseText=Ye.prototype.oa,Ye.prototype.send=Ye.prototype.ea,Ye.prototype.setWithCredentials=Ye.prototype.Ha,gP=Ye}).apply(typeof Jp<"u"?Jp:typeof self<"u"?self:typeof window<"u"?window:{});const GT="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ir.UNAUTHENTICATED=new ir(null),ir.GOOGLE_CREDENTIALS=new ir("google-credentials-uid"),ir.FIRST_PARTY=new ir("first-party-uid"),ir.MOCK_USER=new ir("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sc="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pl=new u0("@firebase/firestore");function Ph(){return pl.logLevel}function ve(n,...e){if(pl.logLevel<=He.DEBUG){const t=e.map(Xw);pl.debug(`Firestore (${Sc}): ${n}`,...t)}}function Js(n,...e){if(pl.logLevel<=He.ERROR){const t=e.map(Xw);pl.error(`Firestore (${Sc}): ${n}`,...t)}}function Ju(n,...e){if(pl.logLevel<=He.WARN){const t=e.map(Xw);pl.warn(`Firestore (${Sc}): ${n}`,...t)}}function Xw(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Se(n="Unexpected state"){const e=`FIRESTORE (${Sc}) INTERNAL ASSERTION FAILED: `+n;throw Js(e),new Error(e)}function nt(n,e){n||Se()}function Ae(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class fe extends no{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wP{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class tO{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ir.UNAUTHENTICATED))}shutdown(){}}class nO{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class rO{constructor(e){this.t=e,this.currentUser=ir.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){nt(this.o===void 0);let r=this.i;const i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve();let s=new Gs;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Gs,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},l=c=>{ve("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(ve("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Gs)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(ve("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(nt(typeof r.accessToken=="string"),new wP(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return nt(e===null||typeof e=="string"),new ir(e)}}class iO{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=ir.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class sO{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new iO(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(ir.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class oO{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class aO{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){nt(this.o===void 0);const r=s=>{s.error!=null&&ve("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,ve("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{ve("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):ve("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(nt(typeof t.token=="string"),this.R=t.token,new oO(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lO(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EP{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=lO(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}}function st(n,e){return n<e?-1:n>e?1:0}function Zu(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hn{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new fe(Z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new fe(Z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new fe(Z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new fe(Z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return hn.fromMillis(Date.now())}static fromDate(e){return hn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new hn(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?st(this.nanoseconds,e.nanoseconds):st(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ie{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ie(e)}static min(){return new Ie(new hn(0,0))}static max(){return new Ie(new hn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ld{constructor(e,t,r){t===void 0?t=0:t>e.length&&Se(),r===void 0?r=e.length-t:r>e.length-t&&Se(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Ld.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ld?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class wt extends Ld{construct(e,t,r){return new wt(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new fe(Z.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new wt(t)}static emptyPath(){return new wt([])}}const uO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Un extends Ld{construct(e,t,r){return new Un(e,t,r)}static isValidIdentifier(e){return uO.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Un.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Un(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new fe(Z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new fe(Z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new fe(Z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else l==="`"?(o=!o,i++):l!=="."||o?(r+=l,i++):(s(),i++)}if(s(),o)throw new fe(Z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Un(t)}static emptyPath(){return new Un([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e){this.path=e}static fromPath(e){return new we(wt.fromString(e))}static fromName(e){return new we(wt.fromString(e).popFirst(5))}static empty(){return new we(wt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&wt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return wt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new we(new wt(e.slice()))}}function cO(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Ie.fromTimestamp(r===1e9?new hn(t+1,0):new hn(t,r));return new ta(i,we.empty(),e)}function hO(n){return new ta(n.readTime,n.key,-1)}class ta{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new ta(Ie.min(),we.empty(),-1)}static max(){return new ta(Ie.max(),we.empty(),-1)}}function dO(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=we.comparator(n.documentKey,e.documentKey),t!==0?t:st(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fO="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class pO{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function df(n){if(n.code!==Z.FAILED_PRECONDITION||n.message!==fO)throw n;ve("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class re{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Se(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new re((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof re?t:re.resolve(t)}catch(t){return re.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):re.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):re.reject(t)}static resolve(e){return new re((t,r)=>{t(e)})}static reject(e){return new re((t,r)=>{r(e)})}static waitFor(e){return new re((t,r)=>{let i=0,s=0,o=!1;e.forEach(l=>{++i,l.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=re.resolve(!1);for(const r of e)t=t.next(i=>i?re.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new re((r,i)=>{const s=e.length,o=new Array(s);let l=0;for(let c=0;c<s;c++){const h=c;t(e[h]).next(p=>{o[h]=p,++l,l===s&&r(o)},p=>i(p))}})}static doWhile(e,t){return new re((r,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}}function gO(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function ff(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jw{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ie(r),this.se=r=>t.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Jw.oe=-1;function pf(n){return n==null}function mm(n){return n===0&&1/n==-1/0}function mO(n){return typeof n=="number"&&Number.isInteger(n)&&!mm(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WT(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Il(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function SP(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nn=class Y1{constructor(e,t){this.comparator=e,this.root=t||Qo.EMPTY}insert(e,t){return new Y1(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Qo.BLACK,null,null))}remove(e){return new Y1(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Qo.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Zp(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Zp(this.root,e,this.comparator,!1)}getReverseIterator(){return new Zp(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Zp(this.root,e,this.comparator,!0)}},Zp=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Qo=class As{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??As.RED,this.left=i??As.EMPTY,this.right=s??As.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new As(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return As.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return As.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,As.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,As.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Se();const e=this.left.check();if(e!==this.right.check())throw Se();return e+(this.isRed()?0:1)}};Qo.EMPTY=null,Qo.RED=!0,Qo.BLACK=!1;Qo.EMPTY=new class{constructor(){this.size=0}get key(){throw Se()}get value(){throw Se()}get color(){throw Se()}get left(){throw Se()}get right(){throw Se()}copy(e,t,r,i,s){return this}insert(e,t,r){return new Qo(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e){this.comparator=e,this.data=new nn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new HT(this.data.getIterator())}getIteratorFrom(e){return new HT(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof zn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new zn(this.comparator);return t.data=e,t}}class HT{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr{constructor(e){this.fields=e,e.sort(Un.comparator)}static empty(){return new Gr([])}unionWith(e){let t=new zn(Un.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Gr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Zu(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CP extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new CP("Invalid base64 string: "+s):s}}(e);return new Gn(t)}static fromUint8Array(e){const t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Gn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return st(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Gn.EMPTY_BYTE_STRING=new Gn("");const _O=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function na(n){if(nt(!!n),typeof n=="string"){let e=0;const t=_O.exec(n);if(nt(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:$t(n.seconds),nanos:$t(n.nanos)}}function $t(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function gl(n){return typeof n=="string"?Gn.fromBase64String(n):Gn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zw(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function eE(n){const e=n.mapValue.fields.__previous_value__;return Zw(e)?eE(e):e}function Fd(n){const e=na(n.mapValue.fields.__local_write_time__.timestampValue);return new hn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yO{constructor(e,t,r,i,s,o,l,c,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=h}}class Vd{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Vd("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Vd&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eg={mapValue:{}};function ml(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Zw(n)?4:wO(n)?9007199254740991:vO(n)?10:11:Se()}function cs(n,e){if(n===e)return!0;const t=ml(n);if(t!==ml(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Fd(n).isEqual(Fd(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=na(i.timestampValue),l=na(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return gl(i.bytesValue).isEqual(gl(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return $t(i.geoPointValue.latitude)===$t(s.geoPointValue.latitude)&&$t(i.geoPointValue.longitude)===$t(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return $t(i.integerValue)===$t(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=$t(i.doubleValue),l=$t(s.doubleValue);return o===l?mm(o)===mm(l):isNaN(o)&&isNaN(l)}return!1}(n,e);case 9:return Zu(n.arrayValue.values||[],e.arrayValue.values||[],cs);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},l=s.mapValue.fields||{};if(WT(o)!==WT(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!cs(o[c],l[c])))return!1;return!0}(n,e);default:return Se()}}function Ud(n,e){return(n.values||[]).find(t=>cs(t,e))!==void 0}function ec(n,e){if(n===e)return 0;const t=ml(n),r=ml(e);if(t!==r)return st(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return st(n.booleanValue,e.booleanValue);case 2:return function(s,o){const l=$t(s.integerValue||s.doubleValue),c=$t(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(n,e);case 3:return $T(n.timestampValue,e.timestampValue);case 4:return $T(Fd(n),Fd(e));case 5:return st(n.stringValue,e.stringValue);case 6:return function(s,o){const l=gl(s),c=gl(o);return l.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){const l=s.split("/"),c=o.split("/");for(let h=0;h<l.length&&h<c.length;h++){const p=st(l[h],c[h]);if(p!==0)return p}return st(l.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){const l=st($t(s.latitude),$t(o.latitude));return l!==0?l:st($t(s.longitude),$t(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return qT(n.arrayValue,e.arrayValue);case 10:return function(s,o){var l,c,h,p;const m=s.fields||{},_=o.fields||{},S=(l=m.value)===null||l===void 0?void 0:l.arrayValue,E=(c=_.value)===null||c===void 0?void 0:c.arrayValue,x=st(((h=S==null?void 0:S.values)===null||h===void 0?void 0:h.length)||0,((p=E==null?void 0:E.values)===null||p===void 0?void 0:p.length)||0);return x!==0?x:qT(S,E)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===eg.mapValue&&o===eg.mapValue)return 0;if(s===eg.mapValue)return 1;if(o===eg.mapValue)return-1;const l=s.fields||{},c=Object.keys(l),h=o.fields||{},p=Object.keys(h);c.sort(),p.sort();for(let m=0;m<c.length&&m<p.length;++m){const _=st(c[m],p[m]);if(_!==0)return _;const S=ec(l[c[m]],h[p[m]]);if(S!==0)return S}return st(c.length,p.length)}(n.mapValue,e.mapValue);default:throw Se()}}function $T(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return st(n,e);const t=na(n),r=na(e),i=st(t.seconds,r.seconds);return i!==0?i:st(t.nanos,r.nanos)}function qT(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=ec(t[i],r[i]);if(s)return s}return st(t.length,r.length)}function tc(n){return X1(n)}function X1(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=na(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return gl(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return we.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=X1(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${X1(t.fields[o])}`;return i+"}"}(n.mapValue):Se()}function KT(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function J1(n){return!!n&&"integerValue"in n}function tE(n){return!!n&&"arrayValue"in n}function QT(n){return!!n&&"nullValue"in n}function YT(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Pg(n){return!!n&&"mapValue"in n}function vO(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function rd(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Il(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=rd(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=rd(n.arrayValue.values[t]);return e}return Object.assign({},n)}function wO(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr{constructor(e){this.value=e}static empty(){return new yr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Pg(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=rd(t)}setAll(e){let t=Un.emptyPath(),r={},i=[];e.forEach((o,l)=>{if(!t.isImmediateParentOf(l)){const c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=l.popLast()}o?r[l.lastSegment()]=rd(o):i.push(l.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());Pg(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return cs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Pg(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Il(t,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new yr(rd(this.value))}}function TP(n){const e=[];return Il(n.fields,(t,r)=>{const i=new Un([t]);if(Pg(r)){const s=TP(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Gr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(e,t,r,i,s,o,l){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new In(e,0,Ie.min(),Ie.min(),Ie.min(),yr.empty(),0)}static newFoundDocument(e,t,r,i){return new In(e,1,t,Ie.min(),r,i,0)}static newNoDocument(e,t){return new In(e,2,t,Ie.min(),Ie.min(),yr.empty(),0)}static newUnknownDocument(e,t){return new In(e,3,t,Ie.min(),Ie.min(),yr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ie.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=yr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=yr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ie.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof In&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new In(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _m{constructor(e,t){this.position=e,this.inclusive=t}}function XT(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],o=n.position[i];if(s.field.isKeyField()?r=we.comparator(we.fromName(o.referenceValue),t.key):r=ec(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function JT(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!cs(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bd{constructor(e,t="asc"){this.field=e,this.dir=t}}function EO(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IP{}class tn extends IP{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new CO(e,t,r):t==="array-contains"?new kO(e,r):t==="in"?new PO(e,r):t==="not-in"?new RO(e,r):t==="array-contains-any"?new xO(e,r):new tn(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new TO(e,r):new IO(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(ec(t,this.value)):t!==null&&ml(this.value)===ml(t)&&this.matchesComparison(ec(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Se()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Li extends IP{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new Li(e,t)}matches(e){return kP(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function kP(n){return n.op==="and"}function PP(n){return SO(n)&&kP(n)}function SO(n){for(const e of n.filters)if(e instanceof Li)return!1;return!0}function Z1(n){if(n instanceof tn)return n.field.canonicalString()+n.op.toString()+tc(n.value);if(PP(n))return n.filters.map(e=>Z1(e)).join(",");{const e=n.filters.map(t=>Z1(t)).join(",");return`${n.op}(${e})`}}function RP(n,e){return n instanceof tn?function(r,i){return i instanceof tn&&r.op===i.op&&r.field.isEqual(i.field)&&cs(r.value,i.value)}(n,e):n instanceof Li?function(r,i){return i instanceof Li&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,l)=>s&&RP(o,i.filters[l]),!0):!1}(n,e):void Se()}function xP(n){return n instanceof tn?function(t){return`${t.field.canonicalString()} ${t.op} ${tc(t.value)}`}(n):n instanceof Li?function(t){return t.op.toString()+" {"+t.getFilters().map(xP).join(" ,")+"}"}(n):"Filter"}class CO extends tn{constructor(e,t,r){super(e,t,r),this.key=we.fromName(r.referenceValue)}matches(e){const t=we.comparator(e.key,this.key);return this.matchesComparison(t)}}class TO extends tn{constructor(e,t){super(e,"in",t),this.keys=AP("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class IO extends tn{constructor(e,t){super(e,"not-in",t),this.keys=AP("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function AP(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>we.fromName(r.referenceValue))}class kO extends tn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return tE(t)&&Ud(t.arrayValue,this.value)}}class PO extends tn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Ud(this.value.arrayValue,t)}}class RO extends tn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ud(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Ud(this.value.arrayValue,t)}}class xO extends tn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!tE(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Ud(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AO{constructor(e,t=null,r=[],i=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=l,this.ue=null}}function ZT(n,e=null,t=[],r=[],i=null,s=null,o=null){return new AO(n,e,t,r,i,s,o)}function nE(n){const e=Ae(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Z1(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),pf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>tc(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>tc(r)).join(",")),e.ue=t}return e.ue}function rE(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!EO(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!RP(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!JT(n.startAt,e.startAt)&&JT(n.endAt,e.endAt)}function e2(n){return we.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cc{constructor(e,t=null,r=[],i=[],s=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function NO(n,e,t,r,i,s,o,l){return new Cc(n,e,t,r,i,s,o,l)}function iE(n){return new Cc(n)}function e3(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function NP(n){return n.collectionGroup!==null}function id(n){const e=Ae(n);if(e.ce===null){e.ce=[];const t=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new zn(Un.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(h=>{h.isInequality()&&(l=l.add(h.field))})}),l})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Bd(s,r))}),t.has(Un.keyField().canonicalString())||e.ce.push(new Bd(Un.keyField(),r))}return e.ce}function us(n){const e=Ae(n);return e.le||(e.le=bO(e,id(n))),e.le}function bO(n,e){if(n.limitType==="F")return ZT(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Bd(i.field,s)});const t=n.endAt?new _m(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new _m(n.startAt.position,n.startAt.inclusive):null;return ZT(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function t2(n,e){const t=n.filters.concat([e]);return new Cc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function n2(n,e,t){return new Cc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function p0(n,e){return rE(us(n),us(e))&&n.limitType===e.limitType}function bP(n){return`${nE(us(n))}|lt:${n.limitType}`}function du(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>xP(i)).join(", ")}]`),pf(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>tc(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>tc(i)).join(",")),`Target(${r})`}(us(n))}; limitType=${n.limitType})`}function g0(n,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):we.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(const s of id(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,l,c){const h=XT(o,l,c);return o.inclusive?h<=0:h<0}(r.startAt,id(r),i)||r.endAt&&!function(o,l,c){const h=XT(o,l,c);return o.inclusive?h>=0:h>0}(r.endAt,id(r),i))}(n,e)}function DO(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function DP(n){return(e,t)=>{let r=!1;for(const i of id(n)){const s=MO(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function MO(n,e,t){const r=n.field.isKeyField()?we.comparator(e.key,t.key):function(s,o,l){const c=o.data.field(s),h=l.data.field(s);return c!==null&&h!==null?ec(c,h):Se()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Se()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tc{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Il(this.inner,(t,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return SP(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OO=new nn(we.comparator);function Zs(){return OO}const MP=new nn(we.comparator);function Gh(...n){let e=MP;for(const t of n)e=e.insert(t.key,t);return e}function OP(n){let e=MP;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function el(){return sd()}function LP(){return sd()}function sd(){return new Tc(n=>n.toString(),(n,e)=>n.isEqual(e))}const LO=new nn(we.comparator),FO=new zn(we.comparator);function $e(...n){let e=FO;for(const t of n)e=e.add(t);return e}const VO=new zn(st);function UO(){return VO}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sE(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:mm(e)?"-0":e}}function FP(n){return{integerValue:""+n}}function BO(n,e){return mO(e)?FP(e):sE(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m0{constructor(){this._=void 0}}function zO(n,e,t){return n instanceof zd?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Zw(s)&&(s=eE(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof jd?UP(n,e):n instanceof Gd?BP(n,e):function(i,s){const o=VP(i,s),l=t3(o)+t3(i.Pe);return J1(o)&&J1(i.Pe)?FP(l):sE(i.serializer,l)}(n,e)}function jO(n,e,t){return n instanceof jd?UP(n,e):n instanceof Gd?BP(n,e):t}function VP(n,e){return n instanceof ym?function(r){return J1(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class zd extends m0{}class jd extends m0{constructor(e){super(),this.elements=e}}function UP(n,e){const t=zP(e);for(const r of n.elements)t.some(i=>cs(i,r))||t.push(r);return{arrayValue:{values:t}}}class Gd extends m0{constructor(e){super(),this.elements=e}}function BP(n,e){let t=zP(e);for(const r of n.elements)t=t.filter(i=>!cs(i,r));return{arrayValue:{values:t}}}class ym extends m0{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function t3(n){return $t(n.integerValue||n.doubleValue)}function zP(n){return tE(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GO{constructor(e,t){this.field=e,this.transform=t}}function WO(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof jd&&i instanceof jd||r instanceof Gd&&i instanceof Gd?Zu(r.elements,i.elements,cs):r instanceof ym&&i instanceof ym?cs(r.Pe,i.Pe):r instanceof zd&&i instanceof zd}(n.transform,e.transform)}class HO{constructor(e,t){this.version=e,this.transformResults=t}}class or{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new or}static exists(e){return new or(void 0,e)}static updateTime(e){return new or(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Rg(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class _0{}function jP(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new y0(n.key,or.none()):new gf(n.key,n.data,or.none());{const t=n.data,r=yr.empty();let i=new zn(Un.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new ma(n.key,r,new Gr(i.toArray()),or.none())}}function $O(n,e,t){n instanceof gf?function(i,s,o){const l=i.value.clone(),c=r3(i.fieldTransforms,s,o.transformResults);l.setAll(c),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):n instanceof ma?function(i,s,o){if(!Rg(i.precondition,s))return void s.convertToUnknownDocument(o.version);const l=r3(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(GP(i)),c.setAll(l),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function od(n,e,t,r){return n instanceof gf?function(s,o,l,c){if(!Rg(s.precondition,o))return l;const h=s.value.clone(),p=i3(s.fieldTransforms,c,o);return h.setAll(p),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null}(n,e,t,r):n instanceof ma?function(s,o,l,c){if(!Rg(s.precondition,o))return l;const h=i3(s.fieldTransforms,c,o),p=o.data;return p.setAll(GP(s)),p.setAll(h),o.convertToFoundDocument(o.version,p).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(m=>m.field))}(n,e,t,r):function(s,o,l){return Rg(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(n,e,t)}function qO(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=VP(r.transform,i||null);s!=null&&(t===null&&(t=yr.empty()),t.set(r.field,s))}return t||null}function n3(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Zu(r,i,(s,o)=>WO(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class gf extends _0{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ma extends _0{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function GP(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function r3(n,e,t){const r=new Map;nt(n.length===t.length);for(let i=0;i<t.length;i++){const s=n[i],o=s.transform,l=e.data.field(s.field);r.set(s.field,jO(o,l,t[i]))}return r}function i3(n,e,t){const r=new Map;for(const i of n){const s=i.transform,o=t.data.field(i.field);r.set(i.field,zO(s,o,e))}return r}class y0 extends _0{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class WP extends _0{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KO{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&$O(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=od(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=od(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=LP();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=t.has(i.key)?null:l;const c=jP(o,l);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(Ie.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),$e())}isEqual(e){return this.batchId===e.batchId&&Zu(this.mutations,e.mutations,(t,r)=>n3(t,r))&&Zu(this.baseMutations,e.baseMutations,(t,r)=>n3(t,r))}}class oE{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){nt(e.mutations.length===r.length);let i=function(){return LO}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new oE(e,t,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QO{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YO{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Zt,Je;function HP(n){switch(n){default:return Se();case Z.CANCELLED:case Z.UNKNOWN:case Z.DEADLINE_EXCEEDED:case Z.RESOURCE_EXHAUSTED:case Z.INTERNAL:case Z.UNAVAILABLE:case Z.UNAUTHENTICATED:return!1;case Z.INVALID_ARGUMENT:case Z.NOT_FOUND:case Z.ALREADY_EXISTS:case Z.PERMISSION_DENIED:case Z.FAILED_PRECONDITION:case Z.ABORTED:case Z.OUT_OF_RANGE:case Z.UNIMPLEMENTED:case Z.DATA_LOSS:return!0}}function $P(n){if(n===void 0)return Js("GRPC error has no .code"),Z.UNKNOWN;switch(n){case Zt.OK:return Z.OK;case Zt.CANCELLED:return Z.CANCELLED;case Zt.UNKNOWN:return Z.UNKNOWN;case Zt.DEADLINE_EXCEEDED:return Z.DEADLINE_EXCEEDED;case Zt.RESOURCE_EXHAUSTED:return Z.RESOURCE_EXHAUSTED;case Zt.INTERNAL:return Z.INTERNAL;case Zt.UNAVAILABLE:return Z.UNAVAILABLE;case Zt.UNAUTHENTICATED:return Z.UNAUTHENTICATED;case Zt.INVALID_ARGUMENT:return Z.INVALID_ARGUMENT;case Zt.NOT_FOUND:return Z.NOT_FOUND;case Zt.ALREADY_EXISTS:return Z.ALREADY_EXISTS;case Zt.PERMISSION_DENIED:return Z.PERMISSION_DENIED;case Zt.FAILED_PRECONDITION:return Z.FAILED_PRECONDITION;case Zt.ABORTED:return Z.ABORTED;case Zt.OUT_OF_RANGE:return Z.OUT_OF_RANGE;case Zt.UNIMPLEMENTED:return Z.UNIMPLEMENTED;case Zt.DATA_LOSS:return Z.DATA_LOSS;default:return Se()}}(Je=Zt||(Zt={}))[Je.OK=0]="OK",Je[Je.CANCELLED=1]="CANCELLED",Je[Je.UNKNOWN=2]="UNKNOWN",Je[Je.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Je[Je.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Je[Je.NOT_FOUND=5]="NOT_FOUND",Je[Je.ALREADY_EXISTS=6]="ALREADY_EXISTS",Je[Je.PERMISSION_DENIED=7]="PERMISSION_DENIED",Je[Je.UNAUTHENTICATED=16]="UNAUTHENTICATED",Je[Je.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Je[Je.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Je[Je.ABORTED=10]="ABORTED",Je[Je.OUT_OF_RANGE=11]="OUT_OF_RANGE",Je[Je.UNIMPLEMENTED=12]="UNIMPLEMENTED",Je[Je.INTERNAL=13]="INTERNAL",Je[Je.UNAVAILABLE=14]="UNAVAILABLE",Je[Je.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XO(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JO=new sl([4294967295,4294967295],0);function s3(n){const e=XO().encode(n),t=new pP;return t.update(e),new Uint8Array(t.digest())}function o3(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new sl([t,r],0),new sl([i,s],0)]}class aE{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Wh(`Invalid padding: ${t}`);if(r<0)throw new Wh(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Wh(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Wh(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=sl.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(sl.fromNumber(r)));return i.compare(JO)===1&&(i=new sl([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=s3(e),[r,i]=o3(t);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new aE(s,i,t);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const t=s3(e),[r,i]=o3(t);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Wh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v0{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,mf.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new v0(Ie.min(),i,new nn(st),Zs(),$e())}}class mf{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new mf(r,t,$e(),$e(),$e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xg{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}}class qP{constructor(e,t){this.targetId=e,this.me=t}}class KP{constructor(e,t,r=Gn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class a3{constructor(){this.fe=0,this.ge=u3(),this.pe=Gn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=$e(),t=$e(),r=$e();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Se()}}),new mf(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=u3()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,nt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class ZO{constructor(e){this.Le=e,this.Be=new Map,this.ke=Zs(),this.qe=l3(),this.Qe=new nn(st)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:Se()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){const t=e.targetId,r=e.me.count,i=this.Je(t);if(i){const s=i.target;if(e2(s))if(r===0){const o=new we(s.path);this.Ue(t,o,In.newNoDocument(o,Ie.min()))}else nt(r===1);else{const o=this.Ye(t);if(o!==r){const l=this.Ze(e),c=l?this.Xe(l,e,o):1;if(c!==0){this.je(t);const h=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,h)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let o,l;try{o=gl(r).toUint8Array()}catch(c){if(c instanceof CP)return Ju("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new aE(o,i,s)}catch(c){return Ju(c instanceof Wh?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let i=0;return r.forEach(s=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.Ue(t,s,null),i++)}),i}rt(e){const t=new Map;this.Be.forEach((s,o)=>{const l=this.Je(o);if(l){if(s.current&&e2(l.target)){const c=new we(l.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,In.newNoDocument(c,e))}s.be&&(t.set(o,s.ve()),s.Ce())}});let r=$e();this.qe.forEach((s,o)=>{let l=!0;o.forEachWhile(c=>{const h=this.Je(c);return!h||h.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new v0(e,t,this.Qe,this.ke,r);return this.ke=Zs(),this.qe=l3(),this.Qe=new nn(st),i}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new a3,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new zn(st),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||ve("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new a3),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function l3(){return new nn(we.comparator)}function u3(){return new nn(we.comparator)}const eL={asc:"ASCENDING",desc:"DESCENDING"},tL={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},nL={and:"AND",or:"OR"};class rL{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function r2(n,e){return n.useProto3Json||pf(e)?e:{value:e}}function vm(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function QP(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function iL(n,e){return vm(n,e.toTimestamp())}function Hr(n){return nt(!!n),Ie.fromTimestamp(function(t){const r=na(t);return new hn(r.seconds,r.nanos)}(n))}function lE(n,e){return i2(n,e).canonicalString()}function i2(n,e){const t=function(i){return new wt(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function YP(n){const e=wt.fromString(n);return nt(nR(e)),e}function wm(n,e){return lE(n.databaseId,e.path)}function ad(n,e){const t=YP(e);if(t.get(1)!==n.databaseId.projectId)throw new fe(Z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new fe(Z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new we(JP(t))}function XP(n,e){return lE(n.databaseId,e)}function sL(n){const e=YP(n);return e.length===4?wt.emptyPath():JP(e)}function s2(n){return new wt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function JP(n){return nt(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function c3(n,e,t){return{name:wm(n,e),fields:t.value.mapValue.fields}}function oL(n,e){return"found"in e?function(r,i){nt(!!i.found),i.found.name,i.found.updateTime;const s=ad(r,i.found.name),o=Hr(i.found.updateTime),l=i.found.createTime?Hr(i.found.createTime):Ie.min(),c=new yr({mapValue:{fields:i.found.fields}});return In.newFoundDocument(s,o,l,c)}(n,e):"missing"in e?function(r,i){nt(!!i.missing),nt(!!i.readTime);const s=ad(r,i.missing),o=Hr(i.readTime);return In.newNoDocument(s,o)}(n,e):Se()}function aL(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:Se()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(h,p){return h.useProto3Json?(nt(p===void 0||typeof p=="string"),Gn.fromBase64String(p||"")):(nt(p===void 0||p instanceof Buffer||p instanceof Uint8Array),Gn.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(h){const p=h.code===void 0?Z.UNKNOWN:$P(h.code);return new fe(p,h.message||"")}(o);t=new KP(r,i,s,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=ad(n,r.document.name),s=Hr(r.document.updateTime),o=r.document.createTime?Hr(r.document.createTime):Ie.min(),l=new yr({mapValue:{fields:r.document.fields}}),c=In.newFoundDocument(i,s,o,l),h=r.targetIds||[],p=r.removedTargetIds||[];t=new xg(h,p,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=ad(n,r.document),s=r.readTime?Hr(r.readTime):Ie.min(),o=In.newNoDocument(i,s),l=r.removedTargetIds||[];t=new xg([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=ad(n,r.document),s=r.removedTargetIds||[];t=new xg([],s,i,null)}else{if(!("filter"in e))return Se();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new YO(i,s),l=r.targetId;t=new qP(l,o)}}return t}function ZP(n,e){let t;if(e instanceof gf)t={update:c3(n,e.key,e.value)};else if(e instanceof y0)t={delete:wm(n,e.key)};else if(e instanceof ma)t={update:c3(n,e.key,e.data),updateMask:mL(e.fieldMask)};else{if(!(e instanceof WP))return Se();t={verify:wm(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const l=o.transform;if(l instanceof zd)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof jd)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Gd)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof ym)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw Se()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:iL(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Se()}(n,e.precondition)),t}function lL(n,e){return n&&n.length>0?(nt(e!==void 0),n.map(t=>function(i,s){let o=i.updateTime?Hr(i.updateTime):Hr(s);return o.isEqual(Ie.min())&&(o=Hr(s)),new HO(o,i.transformResults||[])}(t,e))):[]}function uL(n,e){return{documents:[XP(n,e.path)]}}function cL(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=XP(n,i);const s=function(h){if(h.length!==0)return tR(Li.create(h,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const o=function(h){if(h.length!==0)return h.map(p=>function(_){return{field:fu(_.field),direction:fL(_.dir)}}(p))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=r2(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{_t:t,parent:i}}function hL(n){let e=sL(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){nt(r===1);const p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];t.where&&(s=function(m){const _=eR(m);return _ instanceof Li&&PP(_)?_.getFilters():[_]}(t.where));let o=[];t.orderBy&&(o=function(m){return m.map(_=>function(E){return new Bd(pu(E.field),function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(_))}(t.orderBy));let l=null;t.limit&&(l=function(m){let _;return _=typeof m=="object"?m.value:m,pf(_)?null:_}(t.limit));let c=null;t.startAt&&(c=function(m){const _=!!m.before,S=m.values||[];return new _m(S,_)}(t.startAt));let h=null;return t.endAt&&(h=function(m){const _=!m.before,S=m.values||[];return new _m(S,_)}(t.endAt)),NO(e,i,o,s,l,"F",c,h)}function dL(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Se()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function eR(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=pu(t.unaryFilter.field);return tn.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=pu(t.unaryFilter.field);return tn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=pu(t.unaryFilter.field);return tn.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=pu(t.unaryFilter.field);return tn.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Se()}}(n):n.fieldFilter!==void 0?function(t){return tn.create(pu(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Se()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Li.create(t.compositeFilter.filters.map(r=>eR(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Se()}}(t.compositeFilter.op))}(n):Se()}function fL(n){return eL[n]}function pL(n){return tL[n]}function gL(n){return nL[n]}function fu(n){return{fieldPath:n.canonicalString()}}function pu(n){return Un.fromServerFormat(n.fieldPath)}function tR(n){return n instanceof tn?function(t){if(t.op==="=="){if(YT(t.value))return{unaryFilter:{field:fu(t.field),op:"IS_NAN"}};if(QT(t.value))return{unaryFilter:{field:fu(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(YT(t.value))return{unaryFilter:{field:fu(t.field),op:"IS_NOT_NAN"}};if(QT(t.value))return{unaryFilter:{field:fu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:fu(t.field),op:pL(t.op),value:t.value}}}(n):n instanceof Li?function(t){const r=t.getFilters().map(i=>tR(i));return r.length===1?r[0]:{compositeFilter:{op:gL(t.op),filters:r}}}(n):Se()}function mL(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function nR(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fo{constructor(e,t,r,i,s=Ie.min(),o=Ie.min(),l=Gn.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Fo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Fo(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Fo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Fo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _L{constructor(e){this.ct=e}}function yL(n){const e=hL({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?n2(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vL{constructor(){this.un=new wL}addToCollectionParentIndex(e,t){return this.un.add(t),re.resolve()}getCollectionParents(e,t){return re.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return re.resolve()}deleteFieldIndex(e,t){return re.resolve()}deleteAllFieldIndexes(e){return re.resolve()}createTargetIndexes(e,t){return re.resolve()}getDocumentsMatchingTarget(e,t){return re.resolve(null)}getIndexType(e,t){return re.resolve(0)}getFieldIndexes(e,t){return re.resolve([])}getNextCollectionGroupToUpdate(e){return re.resolve(null)}getMinOffset(e,t){return re.resolve(ta.min())}getMinOffsetFromCollectionGroup(e,t){return re.resolve(ta.min())}updateCollectionGroup(e,t,r){return re.resolve()}updateIndexEntries(e,t){return re.resolve()}}class wL{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new zn(wt.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new zn(wt.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nc{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new nc(0)}static kn(){return new nc(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EL{constructor(){this.changes=new Tc(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,In.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?re.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SL{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CL{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&od(r.mutation,i,Gr.empty(),hn.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,$e()).next(()=>r))}getLocalViewOfDocuments(e,t,r=$e()){const i=el();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=Gh();return s.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=el();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,$e()))}populateOverlays(e,t,r){const i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,l)=>{t.set(o,l)})})}computeViews(e,t,r,i){let s=Zs();const o=sd(),l=function(){return sd()}();return t.forEach((c,h)=>{const p=r.get(h.key);i.has(h.key)&&(p===void 0||p.mutation instanceof ma)?s=s.insert(h.key,h):p!==void 0?(o.set(h.key,p.mutation.getFieldMask()),od(p.mutation,h,p.mutation.getFieldMask(),hn.now())):o.set(h.key,Gr.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((h,p)=>o.set(h,p)),t.forEach((h,p)=>{var m;return l.set(h,new SL(p,(m=o.get(h))!==null&&m!==void 0?m:null))}),l))}recalculateAndSaveOverlays(e,t){const r=sd();let i=new nn((o,l)=>o-l),s=$e();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const l of o)l.keys().forEach(c=>{const h=t.get(c);if(h===null)return;let p=r.get(c)||Gr.empty();p=l.applyToLocalView(h,p),r.set(c,p);const m=(i.get(l.batchId)||$e()).add(c);i=i.insert(l.batchId,m)})}).next(()=>{const o=[],l=i.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),h=c.key,p=c.value,m=LP();p.forEach(_=>{if(!s.has(_)){const S=jP(t.get(_),r.get(_));S!==null&&m.set(_,S),s=s.add(_)}}),o.push(this.documentOverlayCache.saveOverlays(e,h,m))}return re.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return we.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):NP(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):re.resolve(el());let l=-1,c=s;return o.next(h=>re.forEach(h,(p,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),s.get(p)?re.resolve():this.remoteDocumentCache.getEntry(e,p).next(_=>{c=c.insert(p,_)}))).next(()=>this.populateOverlays(e,h,s)).next(()=>this.computeViews(e,c,h,$e())).next(p=>({batchId:l,changes:OP(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new we(t)).next(r=>{let i=Gh();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let o=Gh();return this.indexManager.getCollectionParents(e,s).next(l=>re.forEach(l,c=>{const h=function(m,_){return new Cc(_,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,r,i).next(p=>{p.forEach((m,_)=>{o=o.insert(m,_)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((c,h)=>{const p=h.getKey();o.get(p)===null&&(o=o.insert(p,In.newInvalidDocument(p)))});let l=Gh();return o.forEach((c,h)=>{const p=s.get(c);p!==void 0&&od(p.mutation,h,Gr.empty(),hn.now()),g0(t,h)&&(l=l.insert(c,h))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TL{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return re.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Hr(i.createTime)}}(t)),re.resolve()}getNamedQuery(e,t){return re.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:yL(i.bundledQuery),readTime:Hr(i.readTime)}}(t)),re.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IL{constructor(){this.overlays=new nn(we.comparator),this.Ir=new Map}getOverlay(e,t){return re.resolve(this.overlays.get(t))}getOverlays(e,t){const r=el();return re.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),re.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),re.resolve()}getOverlaysForCollection(e,t,r){const i=el(),s=t.length+1,o=new we(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,h=c.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return re.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new nn((h,p)=>h-p);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>r){let p=s.get(h.largestBatchId);p===null&&(p=el(),s=s.insert(h.largestBatchId,p)),p.set(h.getKey(),h)}}const l=el(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((h,p)=>l.set(h,p)),!(l.size()>=i)););return re.resolve(l)}ht(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new QO(t,r));let s=this.Ir.get(t);s===void 0&&(s=$e(),this.Ir.set(t,s)),this.Ir.set(t,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kL{constructor(){this.sessionToken=Gn.EMPTY_BYTE_STRING}getSessionToken(e){return re.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,re.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uE{constructor(){this.Tr=new zn(En.Er),this.dr=new zn(En.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const r=new En(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new En(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){const t=new we(new wt([])),r=new En(t,e),i=new En(t,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new we(new wt([])),r=new En(t,e),i=new En(t,e+1);let s=$e();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new En(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class En{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return we.comparator(e.key,t.key)||st(e.wr,t.wr)}static Ar(e,t){return st(e.wr,t.wr)||we.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PL{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new zn(En.Er)}checkEmpty(e){return re.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new KO(s,t,r,i);this.mutationQueue.push(o);for(const l of i)this.br=this.br.add(new En(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return re.resolve(o)}lookupMutationBatch(e,t){return re.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.vr(r),s=i<0?0:i;return re.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return re.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return re.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new En(t,0),i=new En(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{const l=this.Dr(o.wr);s.push(l)}),re.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new zn(st);return t.forEach(i=>{const s=new En(i,0),o=new En(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],l=>{r=r.add(l.wr)})}),re.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;we.isDocumentKey(s)||(s=s.child(""));const o=new En(new we(s),0);let l=new zn(st);return this.br.forEachWhile(c=>{const h=c.key.path;return!!r.isPrefixOf(h)&&(h.length===i&&(l=l.add(c.wr)),!0)},o),re.resolve(this.Cr(l))}Cr(e){const t=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){nt(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return re.forEach(t.mutations,i=>{const s=new En(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){const r=new En(t,0),i=this.br.firstAfterOrEqual(r);return re.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,re.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RL{constructor(e){this.Mr=e,this.docs=function(){return new nn(we.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return re.resolve(r?r.document.mutableCopy():In.newInvalidDocument(t))}getEntries(e,t){let r=Zs();return t.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():In.newInvalidDocument(i))}),re.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Zs();const o=t.path,l=new we(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:h,value:{document:p}}=c.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||dO(hO(p),r)<=0||(i.has(p.key)||g0(t,p))&&(s=s.insert(p.key,p.mutableCopy()))}return re.resolve(s)}getAllFromCollectionGroup(e,t,r,i){Se()}Or(e,t){return re.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new xL(this)}getSize(e){return re.resolve(this.size)}}class xL extends EL{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),re.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AL{constructor(e){this.persistence=e,this.Nr=new Tc(t=>nE(t),rE),this.lastRemoteSnapshotVersion=Ie.min(),this.highestTargetId=0,this.Lr=0,this.Br=new uE,this.targetCount=0,this.kr=nc.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),re.resolve()}getLastRemoteSnapshotVersion(e){return re.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return re.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),re.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),re.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new nc(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,re.resolve()}updateTargetData(e,t){return this.Kn(t),re.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,re.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=t&&r.get(l.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),re.waitFor(s).next(()=>i)}getTargetCount(e){return re.resolve(this.targetCount)}getTargetData(e,t){const r=this.Nr.get(t)||null;return re.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),re.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),re.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),re.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Br.yr(t);return re.resolve(r)}containsKey(e,t){return re.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NL{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Jw(0),this.Kr=!1,this.Kr=!0,this.$r=new kL,this.referenceDelegate=e(this),this.Ur=new AL(this),this.indexManager=new vL,this.remoteDocumentCache=function(i){return new RL(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new _L(t),this.Gr=new TL(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new IL,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new PL(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){ve("MemoryPersistence","Starting transaction:",e);const i=new bL(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,t){return re.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}}class bL extends pO{constructor(e){super(),this.currentSequenceNumber=e}}class cE{constructor(e){this.persistence=e,this.Jr=new uE,this.Yr=null}static Zr(e){return new cE(e)}get Xr(){if(this.Yr)return this.Yr;throw Se()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),re.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),re.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),re.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return re.forEach(this.Xr,r=>{const i=we.fromPath(r);return this.ei(e,i).next(s=>{s||t.removeEntry(i,Ie.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return re.or([()=>re.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hE{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=$e(),i=$e();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new hE(e,t.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DL{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ML{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return w7()?8:gO(cr())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.Yi(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new DL;return this.Xi(e,t,o).next(l=>{if(s.result=l,this.zi)return this.es(e,t,o,l.size)})}).next(()=>s.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(Ph()<=He.DEBUG&&ve("QueryEngine","SDK will not create cache indexes for query:",du(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),re.resolve()):(Ph()<=He.DEBUG&&ve("QueryEngine","Query:",du(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Ph()<=He.DEBUG&&ve("QueryEngine","The SDK decides to create cache indexes for query:",du(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,us(t))):re.resolve())}Yi(e,t){if(e3(t))return re.resolve(null);let r=us(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=n2(t,null,"F"),r=us(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=$e(...s);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const h=this.ts(t,l);return this.ns(t,h,o,c.readTime)?this.Yi(e,n2(t,null,"F")):this.rs(e,h,t,c)}))})))}Zi(e,t,r,i){return e3(t)||i.isEqual(Ie.min())?re.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const o=this.ts(t,s);return this.ns(t,o,r,i)?re.resolve(null):(Ph()<=He.DEBUG&&ve("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),du(t)),this.rs(e,o,t,cO(i,-1)).next(l=>l))})}ts(e,t){let r=new zn(DP(e));return t.forEach((i,s)=>{g0(e,s)&&(r=r.add(s))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,t,r){return Ph()<=He.DEBUG&&ve("QueryEngine","Using full collection scan to execute query:",du(t)),this.Ji.getDocumentsMatchingQuery(e,t,ta.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OL{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new nn(st),this._s=new Tc(s=>nE(s),rE),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new CL(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function LL(n,e,t,r){return new OL(n,e,t,r)}async function rR(n,e){const t=Ae(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],l=[];let c=$e();for(const h of i){o.push(h.batchId);for(const p of h.mutations)c=c.add(p.key)}for(const h of s){l.push(h.batchId);for(const p of h.mutations)c=c.add(p.key)}return t.localDocuments.getDocuments(r,c).next(h=>({hs:h,removedBatchIds:o,addedBatchIds:l}))})})}function FL(n,e){const t=Ae(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,h,p){const m=h.batch,_=m.keys();let S=re.resolve();return _.forEach(E=>{S=S.next(()=>p.getEntry(c,E)).next(x=>{const M=h.docVersions.get(E);nt(M!==null),x.version.compareTo(M)<0&&(m.applyToRemoteDocument(x,h),x.isValidDocument()&&(x.setReadTime(h.commitVersion),p.addEntry(x)))})}),S.next(()=>l.mutationQueue.removeMutationBatch(c,m))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=$e();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(c=c.add(l.batch.mutations[h].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function iR(n){const e=Ae(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function VL(n,e){const t=Ae(n),r=e.snapshotVersion;let i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;const l=[];e.targetChanges.forEach((p,m)=>{const _=i.get(m);if(!_)return;l.push(t.Ur.removeMatchingKeys(s,p.removedDocuments,m).next(()=>t.Ur.addMatchingKeys(s,p.addedDocuments,m)));let S=_.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?S=S.withResumeToken(Gn.EMPTY_BYTE_STRING,Ie.min()).withLastLimboFreeSnapshotVersion(Ie.min()):p.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(p.resumeToken,r)),i=i.insert(m,S),function(x,M,R){return x.resumeToken.approximateByteSize()===0||M.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:R.addedDocuments.size+R.modifiedDocuments.size+R.removedDocuments.size>0}(_,S,p)&&l.push(t.Ur.updateTargetData(s,S))});let c=Zs(),h=$e();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(s,p))}),l.push(UL(s,o,e.documentUpdates).next(p=>{c=p.Ps,h=p.Is})),!r.isEqual(Ie.min())){const p=t.Ur.getLastRemoteSnapshotVersion(s).next(m=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));l.push(p)}return re.waitFor(l).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,h)).next(()=>c)}).then(s=>(t.os=i,s))}function UL(n,e,t){let r=$e(),i=$e();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=Zs();return t.forEach((l,c)=>{const h=s.get(l);c.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(l)),c.isNoDocument()&&c.version.isEqual(Ie.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!h.isValidDocument()||c.version.compareTo(h.version)>0||c.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):ve("LocalStore","Ignoring outdated watch update for ",l,". Current version:",h.version," Watch version:",c.version)}),{Ps:o,Is:i}})}function BL(n,e){const t=Ae(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function zL(n,e){const t=Ae(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(s=>s?(i=s,re.resolve(i)):t.Ur.allocateTargetId(r).next(o=>(i=new Fo(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}async function o2(n,e,t){const r=Ae(n),i=r.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!ff(o))throw o;ve("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function h3(n,e,t){const r=Ae(n);let i=Ie.min(),s=$e();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,h,p){const m=Ae(c),_=m._s.get(p);return _!==void 0?re.resolve(m.os.get(_)):m.Ur.getTargetData(h,p)}(r,o,us(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,l.targetId).next(c=>{s=c})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?i:Ie.min(),t?s:$e())).next(l=>(jL(r,DO(e),l),{documents:l,Ts:s})))}function jL(n,e,t){let r=n.us.get(e)||Ie.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.us.set(e,r)}class d3{constructor(){this.activeTargetIds=UO()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class GL{constructor(){this.so=new d3,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new d3,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WL{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f3{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){ve("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){ve("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tg=null;function Sv(){return tg===null?tg=function(){return 268435456+Math.round(2147483648*Math.random())}():tg++,"0x"+tg.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $L{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rr="WebChannelConnection";class qL extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(t,r,i,s,o){const l=Sv(),c=this.xo(t,r.toUriEncodedString());ve("RestConnection",`Sending RPC '${t}' ${l}:`,c,i);const h={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(h,s,o),this.No(t,c,h,i).then(p=>(ve("RestConnection",`Received RPC '${t}' ${l}: `,p),p),p=>{throw Ju("RestConnection",`RPC '${t}' ${l} failed with error: `,p,"url: ",c,"request:",i),p})}Lo(t,r,i,s,o,l){return this.Mo(t,r,i,s,o)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Sc}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}xo(t,r){const i=HL[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){const s=Sv();return new Promise((o,l)=>{const c=new gP;c.setWithCredentials(!0),c.listenOnce(mP.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case kg.NO_ERROR:const p=c.getResponseJson();ve(rr,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(p)),o(p);break;case kg.TIMEOUT:ve(rr,`RPC '${e}' ${s} timed out`),l(new fe(Z.DEADLINE_EXCEEDED,"Request time out"));break;case kg.HTTP_ERROR:const m=c.getStatus();if(ve(rr,`RPC '${e}' ${s} failed with status:`,m,"response text:",c.getResponseText()),m>0){let _=c.getResponseJson();Array.isArray(_)&&(_=_[0]);const S=_==null?void 0:_.error;if(S&&S.status&&S.message){const E=function(M){const R=M.toLowerCase().replace(/_/g,"-");return Object.values(Z).indexOf(R)>=0?R:Z.UNKNOWN}(S.status);l(new fe(E,S.message))}else l(new fe(Z.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new fe(Z.UNAVAILABLE,"Connection failed."));break;default:Se()}}finally{ve(rr,`RPC '${e}' ${s} completed.`)}});const h=JSON.stringify(i);ve(rr,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",h,r,15)})}Bo(e,t,r){const i=Sv(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=vP(),l=yP(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(c.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;const p=s.join("");ve(rr,`Creating RPC '${e}' stream ${i}: ${p}`,c);const m=o.createWebChannel(p,c);let _=!1,S=!1;const E=new $L({Io:M=>{S?ve(rr,`Not sending because RPC '${e}' stream ${i} is closed:`,M):(_||(ve(rr,`Opening RPC '${e}' stream ${i} transport.`),m.open(),_=!0),ve(rr,`RPC '${e}' stream ${i} sending:`,M),m.send(M))},To:()=>m.close()}),x=(M,R,P)=>{M.listen(R,v=>{try{P(v)}catch(k){setTimeout(()=>{throw k},0)}})};return x(m,jh.EventType.OPEN,()=>{S||(ve(rr,`RPC '${e}' stream ${i} transport opened.`),E.yo())}),x(m,jh.EventType.CLOSE,()=>{S||(S=!0,ve(rr,`RPC '${e}' stream ${i} transport closed`),E.So())}),x(m,jh.EventType.ERROR,M=>{S||(S=!0,Ju(rr,`RPC '${e}' stream ${i} transport errored:`,M),E.So(new fe(Z.UNAVAILABLE,"The operation could not be completed")))}),x(m,jh.EventType.MESSAGE,M=>{var R;if(!S){const P=M.data[0];nt(!!P);const v=P,k=v.error||((R=v[0])===null||R===void 0?void 0:R.error);if(k){ve(rr,`RPC '${e}' stream ${i} received error:`,k);const D=k.status;let O=function(b){const A=Zt[b];if(A!==void 0)return $P(A)}(D),N=k.message;O===void 0&&(O=Z.INTERNAL,N="Unknown error status: "+D+" with message "+k.message),S=!0,E.So(new fe(O,N)),m.close()}else ve(rr,`RPC '${e}' stream ${i} received:`,P),E.bo(P)}}),x(l,_P.STAT_EVENT,M=>{M.stat===Q1.PROXY?ve(rr,`RPC '${e}' stream ${i} detected buffering proxy`):M.stat===Q1.NOPROXY&&ve(rr,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{E.wo()},0),E}}function Cv(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w0(n){return new rL(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dE{constructor(e,t,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&ve("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sR{constructor(e,t,r,i,s,o,l,c){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new dE(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===Z.RESOURCE_EXHAUSTED?(Js(t.toString()),Js("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===Z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{const i=new fe(Z.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){const r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return ve("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(ve("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class KL extends sR{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=aL(this.serializer,e),r=function(s){if(!("targetChange"in s))return Ie.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Ie.min():o.readTime?Hr(o.readTime):Ie.min()}(e);return this.listener.d_(t,r)}A_(e){const t={};t.database=s2(this.serializer),t.addTarget=function(s,o){let l;const c=o.target;if(l=e2(c)?{documents:uL(s,c)}:{query:cL(s,c)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=QP(s,o.resumeToken);const h=r2(s,o.expectedCount);h!==null&&(l.expectedCount=h)}else if(o.snapshotVersion.compareTo(Ie.min())>0){l.readTime=vm(s,o.snapshotVersion.toTimestamp());const h=r2(s,o.expectedCount);h!==null&&(l.expectedCount=h)}return l}(this.serializer,e);const r=dL(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){const t={};t.database=s2(this.serializer),t.removeTarget=e,this.a_(t)}}class QL extends sR{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return nt(!!e.streamToken),this.lastStreamToken=e.streamToken,nt(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){nt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=lL(e.writeResults,e.commitTime),r=Hr(e.commitTime);return this.listener.g_(r,t)}p_(){const e={};e.database=s2(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>ZP(this.serializer,r))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YL extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new fe(Z.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,i2(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new fe(Z.UNKNOWN,s.toString())})}Lo(e,t,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,i2(t,r),i,o,l,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new fe(Z.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class XL{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Js(t),this.D_=!1):ve("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JL{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(async()=>{kl(this)&&(ve("RemoteStore","Restarting streams for network reachability change."),await async function(c){const h=Ae(c);h.L_.add(4),await _f(h),h.q_.set("Unknown"),h.L_.delete(4),await E0(h)}(this))})}),this.q_=new XL(r,i)}}async function E0(n){if(kl(n))for(const e of n.B_)await e(!0)}async function _f(n){for(const e of n.B_)await e(!1)}function oR(n,e){const t=Ae(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),mE(t)?gE(t):Ic(t).r_()&&pE(t,e))}function fE(n,e){const t=Ae(n),r=Ic(t);t.N_.delete(e),r.r_()&&aR(t,e),t.N_.size===0&&(r.r_()?r.o_():kl(t)&&t.q_.set("Unknown"))}function pE(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ie.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ic(n).A_(e)}function aR(n,e){n.Q_.xe(e),Ic(n).R_(e)}function gE(n){n.Q_=new ZO({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Ic(n).start(),n.q_.v_()}function mE(n){return kl(n)&&!Ic(n).n_()&&n.N_.size>0}function kl(n){return Ae(n).L_.size===0}function lR(n){n.Q_=void 0}async function ZL(n){n.q_.set("Online")}async function eF(n){n.N_.forEach((e,t)=>{pE(n,e)})}async function tF(n,e){lR(n),mE(n)?(n.q_.M_(e),gE(n)):n.q_.set("Unknown")}async function nF(n,e,t){if(n.q_.set("Online"),e instanceof KP&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const l of s.targetIds)i.N_.has(l)&&(await i.remoteSyncer.rejectListen(l,o),i.N_.delete(l),i.Q_.removeTarget(l))}(n,e)}catch(r){ve("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Em(n,r)}else if(e instanceof xg?n.Q_.Ke(e):e instanceof qP?n.Q_.He(e):n.Q_.We(e),!t.isEqual(Ie.min()))try{const r=await iR(n.localStore);t.compareTo(r)>=0&&await function(s,o){const l=s.Q_.rt(o);return l.targetChanges.forEach((c,h)=>{if(c.resumeToken.approximateByteSize()>0){const p=s.N_.get(h);p&&s.N_.set(h,p.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,h)=>{const p=s.N_.get(c);if(!p)return;s.N_.set(c,p.withResumeToken(Gn.EMPTY_BYTE_STRING,p.snapshotVersion)),aR(s,c);const m=new Fo(p.target,c,h,p.sequenceNumber);pE(s,m)}),s.remoteSyncer.applyRemoteEvent(l)}(n,t)}catch(r){ve("RemoteStore","Failed to raise snapshot:",r),await Em(n,r)}}async function Em(n,e,t){if(!ff(e))throw e;n.L_.add(1),await _f(n),n.q_.set("Offline"),t||(t=()=>iR(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{ve("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await E0(n)})}function uR(n,e){return e().catch(t=>Em(n,t,e))}async function S0(n){const e=Ae(n),t=ra(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;rF(e);)try{const i=await BL(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,iF(e,i)}catch(i){await Em(e,i)}cR(e)&&hR(e)}function rF(n){return kl(n)&&n.O_.length<10}function iF(n,e){n.O_.push(e);const t=ra(n);t.r_()&&t.V_&&t.m_(e.mutations)}function cR(n){return kl(n)&&!ra(n).n_()&&n.O_.length>0}function hR(n){ra(n).start()}async function sF(n){ra(n).p_()}async function oF(n){const e=ra(n);for(const t of n.O_)e.m_(t.mutations)}async function aF(n,e,t){const r=n.O_.shift(),i=oE.from(r,e,t);await uR(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await S0(n)}async function lF(n,e){e&&ra(n).V_&&await async function(r,i){if(function(o){return HP(o)&&o!==Z.ABORTED}(i.code)){const s=r.O_.shift();ra(r).s_(),await uR(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await S0(r)}}(n,e),cR(n)&&hR(n)}async function p3(n,e){const t=Ae(n);t.asyncQueue.verifyOperationInProgress(),ve("RemoteStore","RemoteStore received new credentials");const r=kl(t);t.L_.add(3),await _f(t),r&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await E0(t)}async function uF(n,e){const t=Ae(n);e?(t.L_.delete(2),await E0(t)):e||(t.L_.add(2),await _f(t),t.q_.set("Unknown"))}function Ic(n){return n.K_||(n.K_=function(t,r,i){const s=Ae(t);return s.w_(),new KL(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:ZL.bind(null,n),Ro:eF.bind(null,n),mo:tF.bind(null,n),d_:nF.bind(null,n)}),n.B_.push(async e=>{e?(n.K_.s_(),mE(n)?gE(n):n.q_.set("Unknown")):(await n.K_.stop(),lR(n))})),n.K_}function ra(n){return n.U_||(n.U_=function(t,r,i){const s=Ae(t);return s.w_(),new QL(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:sF.bind(null,n),mo:lF.bind(null,n),f_:oF.bind(null,n),g_:aF.bind(null,n)}),n.B_.push(async e=>{e?(n.U_.s_(),await S0(n)):(await n.U_.stop(),n.O_.length>0&&(ve("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))})),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _E{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Gs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const o=Date.now()+r,l=new _E(e,t,o,i,s);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new fe(Z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function yE(n,e){if(Js("AsyncQueue",`${e}: ${n}`),ff(n))return new fe(Z.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu{constructor(e){this.comparator=e?(t,r)=>e(t,r)||we.comparator(t.key,r.key):(t,r)=>we.comparator(t.key,r.key),this.keyedMap=Gh(),this.sortedSet=new nn(this.comparator)}static emptySet(e){return new Vu(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Vu)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Vu;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g3{constructor(){this.W_=new nn(we.comparator)}track(e){const t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Se():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}}class rc{constructor(e,t,r,i,s,o,l,c,h){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=h}static fromInitialDocuments(e,t,r,i,s){const o=[];return t.forEach(l=>{o.push({type:0,doc:l})}),new rc(e,t,Vu.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&p0(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cF{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class hF{constructor(){this.queries=m3(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){const i=Ae(t),s=i.queries;i.queries=m3(),s.forEach((o,l)=>{for(const c of l.j_)c.onError(r)})})(this,new fe(Z.ABORTED,"Firestore shutting down"))}}function m3(){return new Tc(n=>bP(n),p0)}async function dR(n,e){const t=Ae(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new cF,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await t.onListen(i,!0);break;case 1:s.z_=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const l=yE(o,`Initialization of query '${du(e.query)}' failed`);return void e.onError(l)}t.queries.set(i,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&vE(t)}async function fR(n,e){const t=Ae(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function dF(n,e){const t=Ae(n);let r=!1;for(const i of e){const s=i.query,o=t.queries.get(s);if(o){for(const l of o.j_)l.X_(i)&&(r=!0);o.z_=i}}r&&vE(t)}function fF(n,e,t){const r=Ae(n),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(t);r.queries.delete(e)}function vE(n){n.Y_.forEach(e=>{e.next()})}var a2,_3;(_3=a2||(a2={})).ea="default",_3.Cache="cache";class pR{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new rc(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=rc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==a2.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gR{constructor(e){this.key=e}}class mR{constructor(e){this.key=e}}class pF{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=$e(),this.mutatedKeys=$e(),this.Aa=DP(e),this.Ra=new Vu(this.Aa)}get Va(){return this.Ta}ma(e,t){const r=t?t.fa:new g3,i=t?t.Ra:this.Ra;let s=t?t.mutatedKeys:this.mutatedKeys,o=i,l=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,m)=>{const _=i.get(p),S=g0(this.query,m)?m:null,E=!!_&&this.mutatedKeys.has(_.key),x=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let M=!1;_&&S?_.data.isEqual(S.data)?E!==x&&(r.track({type:3,doc:S}),M=!0):this.ga(_,S)||(r.track({type:2,doc:S}),M=!0,(c&&this.Aa(S,c)>0||h&&this.Aa(S,h)<0)&&(l=!0)):!_&&S?(r.track({type:0,doc:S}),M=!0):_&&!S&&(r.track({type:1,doc:_}),M=!0,(c||h)&&(l=!0)),M&&(S?(o=o.add(S),s=x?s.add(p):s.delete(p)):(o=o.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const p=this.query.limitType==="F"?o.last():o.first();o=o.delete(p.key),s=s.delete(p.key),r.track({type:1,doc:p})}return{Ra:o,fa:r,ns:l,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((p,m)=>function(S,E){const x=M=>{switch(M){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Se()}};return x(S)-x(E)}(p.type,m.type)||this.Aa(p.doc,m.doc)),this.pa(r),i=i!=null&&i;const l=t&&!i?this.ya():[],c=this.da.size===0&&this.current&&!i?1:0,h=c!==this.Ea;return this.Ea=c,o.length!==0||h?{snapshot:new rc(this.query,e.Ra,s,o,e.mutatedKeys,c===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new g3,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=$e(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const t=[];return e.forEach(r=>{this.da.has(r)||t.push(new mR(r))}),this.da.forEach(r=>{e.has(r)||t.push(new gR(r))}),t}ba(e){this.Ta=e.Ts,this.da=$e();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return rc.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class gF{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class mF{constructor(e){this.key=e,this.va=!1}}class _F{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Tc(l=>bP(l),p0),this.Ma=new Map,this.xa=new Set,this.Oa=new nn(we.comparator),this.Na=new Map,this.La=new uE,this.Ba={},this.ka=new Map,this.qa=nc.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function yF(n,e,t=!0){const r=SR(n);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await _R(r,e,t,!0),i}async function vF(n,e){const t=SR(n);await _R(t,e,!0,!1)}async function _R(n,e,t,r){const i=await zL(n.localStore,us(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t);let l;return r&&(l=await wF(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&oR(n.remoteStore,i),l}async function wF(n,e,t,r,i){n.Ka=(m,_,S)=>async function(x,M,R,P){let v=M.view.ma(R);v.ns&&(v=await h3(x.localStore,M.query,!1).then(({documents:N})=>M.view.ma(N,v)));const k=P&&P.targetChanges.get(M.targetId),D=P&&P.targetMismatches.get(M.targetId)!=null,O=M.view.applyChanges(v,x.isPrimaryClient,k,D);return v3(x,M.targetId,O.wa),O.snapshot}(n,m,_,S);const s=await h3(n.localStore,e,!0),o=new pF(e,s.Ts),l=o.ma(s.documents),c=mf.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),h=o.applyChanges(l,n.isPrimaryClient,c);v3(n,t,h.wa);const p=new gF(e,t,o);return n.Fa.set(e,p),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),h.snapshot}async function EF(n,e,t){const r=Ae(n),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!p0(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await o2(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&fE(r.remoteStore,i.targetId),l2(r,i.targetId)}).catch(df)):(l2(r,i.targetId),await o2(r.localStore,i.targetId,!0))}async function SF(n,e){const t=Ae(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),fE(t.remoteStore,r.targetId))}async function CF(n,e,t){const r=AF(n);try{const i=await function(o,l){const c=Ae(o),h=hn.now(),p=l.reduce((S,E)=>S.add(E.key),$e());let m,_;return c.persistence.runTransaction("Locally write mutations","readwrite",S=>{let E=Zs(),x=$e();return c.cs.getEntries(S,p).next(M=>{E=M,E.forEach((R,P)=>{P.isValidDocument()||(x=x.add(R))})}).next(()=>c.localDocuments.getOverlayedDocuments(S,E)).next(M=>{m=M;const R=[];for(const P of l){const v=qO(P,m.get(P.key).overlayedDocument);v!=null&&R.push(new ma(P.key,v,TP(v.value.mapValue),or.exists(!0)))}return c.mutationQueue.addMutationBatch(S,h,R,l)}).next(M=>{_=M;const R=M.applyToLocalDocumentSet(m,x);return c.documentOverlayCache.saveOverlays(S,M.batchId,R)})}).then(()=>({batchId:_.batchId,changes:OP(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,l,c){let h=o.Ba[o.currentUser.toKey()];h||(h=new nn(st)),h=h.insert(l,c),o.Ba[o.currentUser.toKey()]=h}(r,i.batchId,t),await yf(r,i.changes),await S0(r.remoteStore)}catch(i){const s=yE(i,"Failed to persist write");t.reject(s)}}async function yR(n,e){const t=Ae(n);try{const r=await VL(t.localStore,e);e.targetChanges.forEach((i,s)=>{const o=t.Na.get(s);o&&(nt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?nt(o.va):i.removedDocuments.size>0&&(nt(o.va),o.va=!1))}),await yf(t,r,e)}catch(r){await df(r)}}function y3(n,e,t){const r=Ae(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Fa.forEach((s,o)=>{const l=o.view.Z_(e);l.snapshot&&i.push(l.snapshot)}),function(o,l){const c=Ae(o);c.onlineState=l;let h=!1;c.queries.forEach((p,m)=>{for(const _ of m.j_)_.Z_(l)&&(h=!0)}),h&&vE(c)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function TF(n,e,t){const r=Ae(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Na.get(e),s=i&&i.key;if(s){let o=new nn(we.comparator);o=o.insert(s,In.newNoDocument(s,Ie.min()));const l=$e().add(s),c=new v0(Ie.min(),new Map,new nn(st),o,l);await yR(r,c),r.Oa=r.Oa.remove(s),r.Na.delete(e),wE(r)}else await o2(r.localStore,e,!1).then(()=>l2(r,e,t)).catch(df)}async function IF(n,e){const t=Ae(n),r=e.batch.batchId;try{const i=await FL(t.localStore,e);wR(t,r,null),vR(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await yf(t,i)}catch(i){await df(i)}}async function kF(n,e,t){const r=Ae(n);try{const i=await function(o,l){const c=Ae(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let p;return c.mutationQueue.lookupMutationBatch(h,l).next(m=>(nt(m!==null),p=m.keys(),c.mutationQueue.removeMutationBatch(h,m))).next(()=>c.mutationQueue.performConsistencyCheck(h)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(h,p,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,p)).next(()=>c.localDocuments.getDocuments(h,p))})}(r.localStore,e);wR(r,e,t),vR(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await yf(r,i)}catch(i){await df(i)}}function vR(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function wR(n,e,t){const r=Ae(n);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function l2(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||ER(n,r)})}function ER(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(fE(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),wE(n))}function v3(n,e,t){for(const r of t)r instanceof gR?(n.La.addReference(r.key,e),PF(n,r)):r instanceof mR?(ve("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||ER(n,r.key)):Se()}function PF(n,e){const t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(ve("SyncEngine","New document in limbo: "+t),n.xa.add(r),wE(n))}function wE(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new we(wt.fromString(e)),r=n.qa.next();n.Na.set(r,new mF(t)),n.Oa=n.Oa.insert(t,r),oR(n.remoteStore,new Fo(us(iE(t.path)),r,"TargetPurposeLimboResolution",Jw.oe))}}async function yf(n,e,t){const r=Ae(n),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((l,c)=>{o.push(r.Ka(c,e,t).then(h=>{var p;if((h||t)&&r.isPrimaryClient){const m=h?!h.fromCache:(p=t==null?void 0:t.targetChanges.get(c.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(c.targetId,m?"current":"not-current")}if(h){i.push(h);const m=hE.Wi(c.targetId,h);s.push(m)}}))}),await Promise.all(o),r.Ca.d_(i),await async function(c,h){const p=Ae(c);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>re.forEach(h,_=>re.forEach(_.$i,S=>p.persistence.referenceDelegate.addReference(m,_.targetId,S)).next(()=>re.forEach(_.Ui,S=>p.persistence.referenceDelegate.removeReference(m,_.targetId,S)))))}catch(m){if(!ff(m))throw m;ve("LocalStore","Failed to update sequence numbers: "+m)}for(const m of h){const _=m.targetId;if(!m.fromCache){const S=p.os.get(_),E=S.snapshotVersion,x=S.withLastLimboFreeSnapshotVersion(E);p.os=p.os.insert(_,x)}}}(r.localStore,s))}async function RF(n,e){const t=Ae(n);if(!t.currentUser.isEqual(e)){ve("SyncEngine","User change. New user:",e.toKey());const r=await rR(t.localStore,e);t.currentUser=e,function(s,o){s.ka.forEach(l=>{l.forEach(c=>{c.reject(new fe(Z.CANCELLED,o))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await yf(t,r.hs)}}function xF(n,e){const t=Ae(n),r=t.Na.get(e);if(r&&r.va)return $e().add(r.key);{let i=$e();const s=t.Ma.get(e);if(!s)return i;for(const o of s){const l=t.Fa.get(o);i=i.unionWith(l.view.Va)}return i}}function SR(n){const e=Ae(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=yR.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=xF.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=TF.bind(null,e),e.Ca.d_=dF.bind(null,e.eventManager),e.Ca.$a=fF.bind(null,e.eventManager),e}function AF(n){const e=Ae(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=IF.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=kF.bind(null,e),e}class Sm{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=w0(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return LL(this.persistence,new ML,e.initialUser,this.serializer)}Ga(e){return new NL(cE.Zr,this.serializer)}Wa(e){return new GL}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Sm.provider={build:()=>new Sm};class u2{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>y3(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=RF.bind(null,this.syncEngine),await uF(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new hF}()}createDatastore(e){const t=w0(e.databaseInfo.databaseId),r=function(s){return new qL(s)}(e.databaseInfo);return function(s,o,l,c){return new YL(s,o,l,c)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,o,l){return new JL(r,i,s,o,l)}(this.localStore,this.datastore,e.asyncQueue,t=>y3(this.syncEngine,t,0),function(){return f3.D()?new f3:new WL}())}createSyncEngine(e,t){return function(i,s,o,l,c,h,p){const m=new _F(i,s,o,l,c,h);return p&&(m.Qa=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const s=Ae(i);ve("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await _f(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}u2.provider={build:()=>new u2};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CR{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Js("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NF{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new fe(Z.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(i,s){const o=Ae(i),l={documents:s.map(m=>wm(o.serializer,m))},c=await o.Lo("BatchGetDocuments",o.serializer.databaseId,wt.emptyPath(),l,s.length),h=new Map;c.forEach(m=>{const _=oL(o.serializer,m);h.set(_.key.toString(),_)});const p=[];return s.forEach(m=>{const _=h.get(m.toString());nt(!!_),p.push(_)}),p}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new y0(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{const i=we.fromPath(r);this.mutations.push(new WP(i,this.precondition(i)))}),await async function(r,i){const s=Ae(r),o={writes:i.map(l=>ZP(s.serializer,l))};await s.Mo("Commit",s.serializer.databaseId,wt.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Se();t=Ie.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new fe(Z.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Ie.min())?or.exists(!1):or.updateTime(t):or.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Ie.min()))throw new fe(Z.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return or.updateTime(t)}return or.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bF{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this._u=r.maxAttempts,this.t_=new dE(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new NF(this.datastore),t=this.cu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.lu(i)}))}).catch(r=>{this.lu(r)})})}cu(e){try{const t=this.updateFunction(e);return!pf(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!HP(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DF{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=ir.UNAUTHENTICATED,this.clientId=EP.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{ve("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ve("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Gs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=yE(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Tv(n,e){n.asyncQueue.verifyOperationInProgress(),ve("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await rR(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function w3(n,e){n.asyncQueue.verifyOperationInProgress();const t=await MF(n);ve("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>p3(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>p3(e.remoteStore,i)),n._onlineComponents=e}async function MF(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ve("FirestoreClient","Using user provided OfflineComponentProvider");try{await Tv(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===Z.FAILED_PRECONDITION||i.code===Z.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Ju("Error using user provided cache. Falling back to memory cache: "+t),await Tv(n,new Sm)}}else ve("FirestoreClient","Using default OfflineComponentProvider"),await Tv(n,new Sm);return n._offlineComponents}async function EE(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ve("FirestoreClient","Using user provided OnlineComponentProvider"),await w3(n,n._uninitializedComponentsProvider._online)):(ve("FirestoreClient","Using default OnlineComponentProvider"),await w3(n,new u2))),n._onlineComponents}function OF(n){return EE(n).then(e=>e.syncEngine)}function LF(n){return EE(n).then(e=>e.datastore)}async function c2(n){const e=await EE(n),t=e.eventManager;return t.onListen=yF.bind(null,e.syncEngine),t.onUnlisten=EF.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=vF.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=SF.bind(null,e.syncEngine),t}function FF(n,e,t={}){const r=new Gs;return n.asyncQueue.enqueueAndForget(async()=>function(s,o,l,c,h){const p=new CR({next:_=>{p.Za(),o.enqueueAndForget(()=>fR(s,m)),_.fromCache&&c.source==="server"?h.reject(new fe(Z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(_)},error:_=>h.reject(_)}),m=new pR(l,p,{includeMetadataChanges:!0,_a:!0});return dR(s,m)}(await c2(n),n.asyncQueue,e,t,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TR(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E3=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IR(n,e,t){if(!t)throw new fe(Z.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function VF(n,e,t,r){if(e===!0&&r===!0)throw new fe(Z.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function S3(n){if(!we.isDocumentKey(n))throw new fe(Z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function C3(n){if(we.isDocumentKey(n))throw new fe(Z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function C0(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Se()}function ui(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new fe(Z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=C0(n);throw new fe(Z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T3{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new fe(Z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new fe(Z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}VF("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=TR((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new fe(Z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new fe(Z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new fe(Z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class T0{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new T3({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new fe(Z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new fe(Z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new T3(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new tO;switch(r.type){case"firstParty":return new sO(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new fe(Z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=E3.get(t);r&&(ve("ComponentProvider","Removing Datastore"),E3.delete(t),r.terminate())}(this),Promise.resolve()}}function kR(n,e,t,r={}){var i;const s=(n=ui(n,T0))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Ju("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let l,c;if(typeof r.mockUserToken=="string")l=r.mockUserToken,c=ir.MOCK_USER;else{l=kk(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);const h=r.mockUserToken.sub||r.mockUserToken.user_id;if(!h)throw new fe(Z.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new ir(h)}n._authCredentials=new nO(new wP(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new _a(this.firestore,e,this._query)}}class ar{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Yo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ar(this.firestore,e,this._key)}}class Yo extends _a{constructor(e,t,r){super(e,t,iE(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ar(this.firestore,null,new we(e))}withConverter(e){return new Yo(this.firestore,e,this._path)}}function vf(n,e,...t){if(n=Et(n),IR("collection","path",e),n instanceof T0){const r=wt.fromString(e,...t);return C3(r),new Yo(n,null,r)}{if(!(n instanceof ar||n instanceof Yo))throw new fe(Z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(wt.fromString(e,...t));return C3(r),new Yo(n.firestore,null,r)}}function ya(n,e,...t){if(n=Et(n),arguments.length===1&&(e=EP.newId()),IR("doc","path",e),n instanceof T0){const r=wt.fromString(e,...t);return S3(r),new ar(n,null,new we(r))}{if(!(n instanceof ar||n instanceof Yo))throw new fe(Z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(wt.fromString(e,...t));return S3(r),new ar(n.firestore,n instanceof Yo?n.converter:null,new we(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I3{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new dE(this,"async_queue_retry"),this.Vu=()=>{const r=Cv();r&&ve("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const t=Cv();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=Cv();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new Gs;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!ff(e))throw e;ve("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(r);throw Js("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const i=_E.createAndSchedule(this,e,t,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&Se()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function k3(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}class ia extends T0{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new I3,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new I3(e),this._firestoreClient=void 0,await e}}}function UF(n,e){const t=typeof n=="object"?n:Uw(),r=typeof n=="string"?n:"(default)",i=c0(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=Ck("firestore");s&&kR(i,...s)}return i}function I0(n){if(n._terminated)throw new fe(Z.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||BF(n),n._firestoreClient}function BF(n){var e,t,r;const i=n._freezeSettings(),s=function(l,c,h,p){return new yO(l,c,h,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,TR(p.experimentalLongPollingOptions),p.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new DF(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l{constructor(e){this._byteString=e}static fromBase64String(e){try{return new _l(Gn.fromBase64String(e))}catch(t){throw new fe(Z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new _l(Gn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wf{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new fe(Z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Un(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k0{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SE{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new fe(Z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new fe(Z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return st(this._lat,e._lat)||st(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CE{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zF=/^__.*__$/;class jF{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new ma(e,this.data,this.fieldMask,t,this.fieldTransforms):new gf(e,this.data,t,this.fieldTransforms)}}class PR{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new ma(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function RR(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Se()}}class TE{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new TE(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Cm(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(RR(this.Cu)&&zF.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class GF{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||w0(e)}Qu(e,t,r,i=!1){return new TE({Cu:e,methodName:t,qu:r,path:Un.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function P0(n){const e=n._freezeSettings(),t=w0(n._databaseId);return new GF(n._databaseId,!!e.ignoreUndefinedProperties,t)}function xR(n,e,t,r,i,s={}){const o=n.Qu(s.merge||s.mergeFields?2:0,e,t,i);kE("Data must be an object, but it was:",o,r);const l=bR(r,o);let c,h;if(s.merge)c=new Gr(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){const p=[];for(const m of s.mergeFields){const _=h2(e,m,t);if(!o.contains(_))throw new fe(Z.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);MR(p,_)||p.push(_)}c=new Gr(p),h=o.fieldTransforms.filter(m=>c.covers(m.field))}else c=null,h=o.fieldTransforms;return new jF(new yr(l),c,h)}class R0 extends k0{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof R0}}class IE extends k0{_toFieldTransform(e){return new GO(e.path,new zd)}isEqual(e){return e instanceof IE}}function AR(n,e,t,r){const i=n.Qu(1,e,t);kE("Data must be an object, but it was:",i,r);const s=[],o=yr.empty();Il(r,(c,h)=>{const p=PE(e,c,t);h=Et(h);const m=i.Nu(p);if(h instanceof R0)s.push(p);else{const _=Ef(h,m);_!=null&&(s.push(p),o.set(p,_))}});const l=new Gr(s);return new PR(o,l,i.fieldTransforms)}function NR(n,e,t,r,i,s){const o=n.Qu(1,e,t),l=[h2(e,r,t)],c=[i];if(s.length%2!=0)throw new fe(Z.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<s.length;_+=2)l.push(h2(e,s[_])),c.push(s[_+1]);const h=[],p=yr.empty();for(let _=l.length-1;_>=0;--_)if(!MR(h,l[_])){const S=l[_];let E=c[_];E=Et(E);const x=o.Nu(S);if(E instanceof R0)h.push(S);else{const M=Ef(E,x);M!=null&&(h.push(S),p.set(S,M))}}const m=new Gr(h);return new PR(p,m,o.fieldTransforms)}function WF(n,e,t,r=!1){return Ef(t,n.Qu(r?4:3,e))}function Ef(n,e){if(DR(n=Et(n)))return kE("Unsupported field value:",e,n),bR(n,e);if(n instanceof k0)return function(r,i){if(!RR(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const l of r){let c=Ef(l,i.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=Et(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return BO(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=hn.fromDate(r);return{timestampValue:vm(i.serializer,s)}}if(r instanceof hn){const s=new hn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:vm(i.serializer,s)}}if(r instanceof SE)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof _l)return{bytesValue:QP(i.serializer,r._byteString)};if(r instanceof ar){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:lE(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof CE)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return sE(l.serializer,c)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${C0(r)}`)}(n,e)}function bR(n,e){const t={};return SP(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Il(n,(r,i)=>{const s=Ef(i,e.Mu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function DR(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof hn||n instanceof SE||n instanceof _l||n instanceof ar||n instanceof k0||n instanceof CE)}function kE(n,e,t){if(!DR(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const r=C0(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function h2(n,e,t){if((e=Et(e))instanceof wf)return e._internalPath;if(typeof e=="string")return PE(n,e);throw Cm("Field path arguments must be of type string or ",n,!1,void 0,t)}const HF=new RegExp("[~\\*/\\[\\]]");function PE(n,e,t){if(e.search(HF)>=0)throw Cm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new wf(...e.split("."))._internalPath}catch{throw Cm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Cm(n,e,t,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new fe(Z.INVALID_ARGUMENT,l+n+c)}function MR(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tm{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ar(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new $F(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(x0("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class $F extends Tm{data(){return super.data()}}function x0(n,e){return typeof e=="string"?PE(n,e):e instanceof wf?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OR(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new fe(Z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class RE{}class LR extends RE{}function FR(n,e,...t){let r=[];e instanceof RE&&r.push(e),r=r.concat(t),function(s){const o=s.filter(c=>c instanceof xE).length,l=s.filter(c=>c instanceof A0).length;if(o>1||o>0&&l>0)throw new fe(Z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class A0 extends LR{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new A0(e,t,r)}_apply(e){const t=this._parse(e);return VR(e._query,t),new _a(e.firestore,e.converter,t2(e._query,t))}_parse(e){const t=P0(e.firestore);return function(s,o,l,c,h,p,m){let _;if(h.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new fe(Z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){R3(m,p);const S=[];for(const E of m)S.push(P3(c,s,E));_={arrayValue:{values:S}}}else _=P3(c,s,m)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||R3(m,p),_=WF(l,o,m,p==="in"||p==="not-in");return tn.create(h,p,_)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function qF(n,e,t){const r=e,i=x0("where",n);return A0._create(i,r,t)}class xE extends RE{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new xE(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Li.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i;const l=s.getFlattenedFilters();for(const c of l)VR(o,c),o=t2(o,c)}(e._query,t),new _a(e.firestore,e.converter,t2(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class AE extends LR{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new AE(e,t)}_apply(e){const t=function(i,s,o){if(i.startAt!==null)throw new fe(Z.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new fe(Z.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Bd(s,o)}(e._query,this._field,this._direction);return new _a(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new Cc(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}function KF(n,e="asc"){const t=e,r=x0("orderBy",n);return AE._create(r,t)}function P3(n,e,t){if(typeof(t=Et(t))=="string"){if(t==="")throw new fe(Z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!NP(e)&&t.indexOf("/")!==-1)throw new fe(Z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(wt.fromString(t));if(!we.isDocumentKey(r))throw new fe(Z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return KT(n,new we(r))}if(t instanceof ar)return KT(n,t._key);throw new fe(Z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${C0(t)}.`)}function R3(n,e){if(!Array.isArray(n)||n.length===0)throw new fe(Z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function VR(n,e){const t=function(i,s){for(const o of i)for(const l of o.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new fe(Z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new fe(Z.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class UR{convertValue(e,t="none"){switch(ml(e)){case 0:return null;case 1:return e.booleanValue;case 2:return $t(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(gl(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Se()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Il(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;const s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>$t(o.doubleValue));return new CE(s)}convertGeoPoint(e){return new SE($t(e.latitude),$t(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=eE(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Fd(e));default:return null}}convertTimestamp(e){const t=na(e);return new hn(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=wt.fromString(e);nt(nR(r));const i=new Vd(r.get(1),r.get(3)),s=new we(r.popFirst(5));return i.isEqual(t)||Js(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BR(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class QF extends UR{constructor(e){super(),this.firestore=e}convertBytes(e){return new _l(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ar(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class NE extends Tm{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Ag(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(x0("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class Ag extends NE{data(e={}){return super.data(e)}}class zR{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Pu(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Ag(this._firestore,this._userDataWriter,r.key,r,new Pu(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new fe(Z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(l=>{const c=new Ag(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Pu(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const c=new Ag(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Pu(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let h=-1,p=-1;return l.type!==0&&(h=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),p=o.indexOf(l.doc.key)),{type:YF(l.type),doc:c,oldIndex:h,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function YF(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Se()}}class N0 extends UR{constructor(e){super(),this.firestore=e}convertBytes(e){return new _l(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ar(this.firestore,null,t)}}function bE(n){n=ui(n,_a);const e=ui(n.firestore,ia),t=I0(e),r=new N0(e);return OR(n._query),FF(t,n._query).then(i=>new zR(e,r,n,i))}function XF(n,e,t){n=ui(n,ar);const r=ui(n.firestore,ia),i=BR(n.converter,e,t);return DE(r,[xR(P0(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,or.none())])}function jR(n,e,t,...r){n=ui(n,ar);const i=ui(n.firestore,ia),s=P0(i);let o;return o=typeof(e=Et(e))=="string"||e instanceof wf?NR(s,"updateDoc",n._key,e,t,r):AR(s,"updateDoc",n._key,e),DE(i,[o.toMutation(n._key,or.exists(!0))])}function GR(n){return DE(ui(n.firestore,ia),[new y0(n._key,or.none())])}function JF(n,...e){var t,r,i;n=Et(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||k3(e[o])||(s=e[o],o++);const l={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(k3(e[o])){const m=e[o];e[o]=(t=m.next)===null||t===void 0?void 0:t.bind(m),e[o+1]=(r=m.error)===null||r===void 0?void 0:r.bind(m),e[o+2]=(i=m.complete)===null||i===void 0?void 0:i.bind(m)}let c,h,p;if(n instanceof ar)h=ui(n.firestore,ia),p=iE(n._key.path),c={next:m=>{e[o]&&e[o](ZF(h,n,m))},error:e[o+1],complete:e[o+2]};else{const m=ui(n,_a);h=ui(m.firestore,ia),p=m._query;const _=new N0(h);c={next:S=>{e[o]&&e[o](new zR(h,_,m,S))},error:e[o+1],complete:e[o+2]},OR(n._query)}return function(_,S,E,x){const M=new CR(x),R=new pR(S,M,E);return _.asyncQueue.enqueueAndForget(async()=>dR(await c2(_),R)),()=>{M.Za(),_.asyncQueue.enqueueAndForget(async()=>fR(await c2(_),R))}}(I0(h),p,l,c)}function DE(n,e){return function(r,i){const s=new Gs;return r.asyncQueue.enqueueAndForget(async()=>CF(await OF(r),i,s)),s.promise}(I0(n),e)}function ZF(n,e,t){const r=t.docs.get(e._key),i=new N0(n);return new NE(n,i,e._key,r,new Pu(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eV={maxAttempts:5};function Rh(n,e){if((n=Et(n)).firestore!==e)throw new fe(Z.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tV extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=P0(t)}get(t){const r=Rh(t,this._firestore),i=new QF(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return Se();const o=s[0];if(o.isFoundDocument())return new Tm(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new Tm(this._firestore,i,r._key,null,r.converter);throw Se()})}set(t,r,i){const s=Rh(t,this._firestore),o=BR(s.converter,r,i),l=xR(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,l),this}update(t,r,i,...s){const o=Rh(t,this._firestore);let l;return l=typeof(r=Et(r))=="string"||r instanceof wf?NR(this._dataReader,"Transaction.update",o._key,r,i,s):AR(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,l),this}delete(t){const r=Rh(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Rh(e,this._firestore),r=new N0(this._firestore);return super.get(e).then(i=>new NE(this._firestore,r,t._key,i._document,new Pu(!1,!1),t.converter))}}function ME(n,e,t){n=ui(n,ia);const r=Object.assign(Object.assign({},eV),t);return function(s){if(s.maxAttempts<1)throw new fe(Z.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,l){const c=new Gs;return s.asyncQueue.enqueueAndForget(async()=>{const h=await LF(s);new bF(s.asyncQueue,h,l,o,c).au()}),c.promise}(I0(n),i=>e(new tV(n,i)),r)}function ic(){return new IE("serverTimestamp")}(function(e,t=!0){(function(i){Sc=i})(Tl),hl(new ea("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),l=new ia(new rO(r.getProvider("auth-internal")),new aO(r.getProvider("app-check-internal")),function(h,p){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new fe(Z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Vd(h.options.projectId,p)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),as(GT,"4.7.3",e),as(GT,"4.7.3","esm2017")})();var x3={};const A3="@firebase/database",N3="1.0.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let WR="";function HR(n){WR=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nV{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Pn(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:bd(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rV{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return hs(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $R=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new nV(e)}}catch{}return new rV},tl=$R("localStorage"),iV=$R("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uu=new u0("@firebase/database"),sV=function(){let n=1;return function(){return n++}}(),qR=function(n){const e=b7(n),t=new R7;t.update(e);const r=t.digest();return Lw.encodeByteArray(r)},Sf=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Sf.apply(null,r):typeof r=="object"?e+=Pn(r):e+=r,e+=" "}return e};let ld=null,b3=!0;const oV=function(n,e){ce(!0,"Can't turn on custom loggers persistently."),Uu.logLevel=He.VERBOSE,ld=Uu.log.bind(Uu)},kn=function(...n){if(b3===!0&&(b3=!1,ld===null&&iV.get("logging_enabled")===!0&&oV()),ld){const e=Sf.apply(null,n);ld(e)}},Cf=function(n){return function(...e){kn(n,...e)}},d2=function(...n){const e="FIREBASE INTERNAL ERROR: "+Sf(...n);Uu.error(e)},eo=function(...n){const e=`FIREBASE FATAL ERROR: ${Sf(...n)}`;throw Uu.error(e),new Error(e)},wr=function(...n){const e="FIREBASE WARNING: "+Sf(...n);Uu.warn(e)},aV=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&wr("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},b0=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},lV=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},sc="[MIN_NAME]",yl="[MAX_NAME]",Pl=function(n,e){if(n===e)return 0;if(n===sc||e===yl)return-1;if(e===sc||n===yl)return 1;{const t=D3(n),r=D3(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},uV=function(n,e){return n===e?0:n<e?-1:1},xh=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+Pn(e))},OE=function(n){if(typeof n!="object"||n===null)return Pn(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=Pn(e[r]),t+=":",t+=OE(n[e[r]]);return t+="}",t},KR=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function xn(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const QR=function(n){ce(!b0(n),"Invalid JSON number");const e=11,t=52,r=(1<<e-1)-1;let i,s,o,l,c;n===0?(s=0,o=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(l=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=l+r,o=Math.round(n*Math.pow(2,t-l)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-r-t))));const h=[];for(c=t;c;c-=1)h.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)h.push(s%2?1:0),s=Math.floor(s/2);h.push(i?1:0),h.reverse();const p=h.join("");let m="";for(c=0;c<64;c+=8){let _=parseInt(p.substr(c,8),2).toString(16);_.length===1&&(_="0"+_),m=m+_}return m.toLowerCase()},cV=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},hV=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function dV(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");const r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}const fV=new RegExp("^-?(0*)\\d{1,10}$"),pV=-2147483648,gV=2147483647,D3=function(n){if(fV.test(n)){const e=Number(n);if(e>=pV&&e<=gV)return e}return null},kc=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw wr("Exception was thrown by user callback.",t),e},Math.floor(0))}},mV=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},ud=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _V{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){wr(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yV{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(kn("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',wr(e)}}class Ng{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Ng.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LE="5",YR="v",XR="s",JR="r",ZR="f",e9=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,t9="ls",n9="p",f2="ac",r9="websocket",i9="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s9{constructor(e,t,r,i,s=!1,o="",l=!1,c=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=l,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=tl.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&tl.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function vV(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function o9(n,e,t){ce(typeof e=="string","typeof type must == string"),ce(typeof t=="object","typeof params must == object");let r;if(e===r9)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===i9)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);vV(n)&&(t.ns=n.namespace);const i=[];return xn(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wV{constructor(){this.counters_={}}incrementCounter(e,t=1){hs(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return u7(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iv={},kv={};function FE(n){const e=n.toString();return Iv[e]||(Iv[e]=new wV),Iv[e]}function EV(n,e){const t=n.toString();return kv[t]||(kv[t]=e()),kv[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SV{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&kc(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M3="start",CV="close",TV="pLPCommand",IV="pRTLPCB",a9="id",l9="pw",u9="ser",kV="cb",PV="seg",RV="ts",xV="d",AV="dframe",c9=1870,h9=30,NV=c9-h9,bV=25e3,DV=3e4;class Ru{constructor(e,t,r,i,s,o,l){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=l,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Cf(e),this.stats_=FE(t),this.urlFn=c=>(this.appCheckToken&&(c[f2]=this.appCheckToken),o9(t,i9,c))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new SV(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(DV)),lV(()=>{if(this.isClosed_)return;this.scriptTagHolder=new VE((...s)=>{const[o,l,c,h,p]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===M3)this.id=l,this.password=c;else if(o===CV)l?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(l,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{const[o,l]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,l)},()=>{this.onClosed_()},this.urlFn);const r={};r[M3]="t",r[u9]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[kV]=this.scriptTagHolder.uniqueCallbackIdentifier),r[YR]=LE,this.transportSessionId&&(r[XR]=this.transportSessionId),this.lastSessionId&&(r[t9]=this.lastSessionId),this.applicationId&&(r[n9]=this.applicationId),this.appCheckToken&&(r[f2]=this.appCheckToken),typeof location<"u"&&location.hostname&&e9.test(location.hostname)&&(r[JR]=ZR);const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Ru.forceAllow_=!0}static forceDisallow(){Ru.forceDisallow_=!0}static isAvailable(){return Ru.forceAllow_?!0:!Ru.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!cV()&&!hV()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=Pn(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=wk(t),i=KR(r,NV);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const r={};r[AV]="t",r[a9]=e,r[l9]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=Pn(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class VE{constructor(e,t,r,i){this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=sV(),window[TV+this.uniqueCallbackIdentifier]=e,window[IV+this.uniqueCallbackIdentifier]=t,this.myIFrame=VE.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(l){kn("frame writing exception"),l.stack&&kn(l.stack),kn(l)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||kn("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[a9]=this.myID,e[l9]=this.myPW,e[u9]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+h9+r.length<=c9;){const o=this.pendingSegs.shift();r=r+"&"+PV+i+"="+o.seg+"&"+RV+i+"="+o.ts+"&"+xV+i+"="+o.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(bV)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{kn("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MV=16384,OV=45e3;let Im=null;typeof MozWebSocket<"u"?Im=MozWebSocket:typeof WebSocket<"u"&&(Im=WebSocket);class Pi{constructor(e,t,r,i,s,o,l){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Cf(this.connId),this.stats_=FE(t),this.connURL=Pi.connectionURL_(t,o,l,i,r),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,r,i,s){const o={};return o[YR]=LE,typeof location<"u"&&location.hostname&&e9.test(location.hostname)&&(o[JR]=ZR),t&&(o[XR]=t),r&&(o[t9]=r),i&&(o[f2]=i),s&&(o[n9]=s),o9(e,r9,o)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,tl.set("previous_websocket_failure",!0);try{let r;v7(),this.mySock=new Im(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){Pi.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(t);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&Im!==null&&!Pi.forceDisallow_}static previouslyFailed(){return tl.isInMemoryStorage||tl.get("previous_websocket_failure")===!0}markConnectionHealthy(){tl.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const r=bd(t);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(ce(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const r=this.extractFrameCount_(t);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const t=Pn(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=KR(t,MV);r.length>1&&this.sendString_(String(r.length));for(let i=0;i<r.length;i++)this.sendString_(r[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(OV))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Pi.responsesRequiredToBeHealthy=2;Pi.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wd{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Ru,Pi]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=Pi&&Pi.isAvailable();let r=t&&!Pi.previouslyFailed();if(e.webSocketOnly&&(t||wr("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[Pi];else{const i=this.transports_=[];for(const s of Wd.ALL_TRANSPORTS)s&&s.isAvailable()&&i.push(s);Wd.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Wd.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LV=6e4,FV=5e3,VV=10*1024,UV=100*1024,Pv="t",O3="d",BV="s",L3="r",zV="e",F3="o",V3="a",U3="n",B3="p",jV="h";class GV{constructor(e,t,r,i,s,o,l,c,h,p){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=l,this.onDisconnect_=c,this.onKill_=h,this.lastSessionId=p,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Cf("c:"+this.id+":"),this.transportManager_=new Wd(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=ud(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>UV?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>VV?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Pv in e){const t=e[Pv];t===V3?this.upgradeIfSecondaryHealthy_():t===L3?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===F3&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=xh("t",e),r=xh("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:B3,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:V3,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:U3,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=xh("t",e),r=xh("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=xh(Pv,e);if(O3 in e){const r=e[O3];if(t===jV){const i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===U3){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===BV?this.onConnectionShutdown_(r):t===L3?this.onReset_(r):t===zV?d2("Server Error: "+r):t===F3?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):d2("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),LE!==r&&wr("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),ud(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(LV))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):ud(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(FV))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:B3,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(tl.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d9{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f9{constructor(e){this.allowedEvents_=e,this.listeners_={},ce(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){ce(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class km extends f9{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Fw()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new km}getInitialEvent(e){return ce(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z3=32,j3=768;let dt=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function at(){return new dt("")}function Le(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function sa(n){return n.pieces_.length-n.pieceNum_}function vt(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new dt(n.pieces_,e)}function UE(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function WV(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function Hd(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function p9(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new dt(e,0)}function Mt(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof dt)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new dt(t,0)}function Ue(n){return n.pieceNum_>=n.pieces_.length}function Mr(n,e){const t=Le(n),r=Le(e);if(t===null)return e;if(t===r)return Mr(vt(n),vt(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function HV(n,e){const t=Hd(n,0),r=Hd(e,0);for(let i=0;i<t.length&&i<r.length;i++){const s=Pl(t[i],r[i]);if(s!==0)return s}return t.length===r.length?0:t.length<r.length?-1:1}function BE(n,e){if(sa(n)!==sa(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function ai(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(sa(n)>sa(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class $V{constructor(e,t){this.errorPrefix_=t,this.parts_=Hd(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=l0(this.parts_[r]);g9(this)}}function qV(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=l0(e),g9(n)}function KV(n){const e=n.parts_.pop();n.byteLength_-=l0(e),n.parts_.length>0&&(n.byteLength_-=1)}function g9(n){if(n.byteLength_>j3)throw new Error(n.errorPrefix_+"has a key path longer than "+j3+" bytes ("+n.byteLength_+").");if(n.parts_.length>z3)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+z3+") or object contains a cycle "+Ka(n))}function Ka(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zE extends f9{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new zE}getInitialEvent(e){return ce(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ah=1e3,QV=60*5*1e3,G3=30*1e3,YV=1.3,XV=3e4,JV="server_kill",W3=3;class Ws extends d9{constructor(e,t,r,i,s,o,l,c){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=r,this.onConnectStatus_=i,this.onServerInfoUpdate_=s,this.authTokenProvider_=o,this.appCheckTokenProvider_=l,this.authOverride_=c,this.id=Ws.nextPersistentConnectionId_++,this.log_=Cf("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ah,this.maxReconnectDelay_=QV,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");zE.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&km.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,r){const i=++this.requestNumber_,s={r:i,a:e,b:t};this.log_(Pn(s)),ce(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),r&&(this.requestCBHash_[i]=r)}get(e){this.initConnection_();const t=new rs,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const l=o.d;o.s==="ok"?t.resolve(l):t.reject(l)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),t.promise}listen(e,t,r,i){this.initConnection_();const s=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+s),this.listens.has(o)||this.listens.set(o,new Map),ce(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),ce(!this.listens.get(o).has(s),"listen() called twice for same path/queryId.");const l={onComplete:i,hashFn:t,query:e,tag:r};this.listens.get(o).set(s,l),this.connected_&&this.sendListen_(l)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(r)})}sendListen_(e){const t=e.query,r=t._path.toString(),i=t._queryIdentifier;this.log_("Listen on "+r+" for "+i);const s={p:r},o="q";e.tag&&(s.q=t._queryObject,s.t=e.tag),s.h=e.hashFn(),this.sendRequest(o,s,l=>{const c=l.d,h=l.s;Ws.warnOnListenWarnings_(c,t),(this.listens.get(r)&&this.listens.get(r).get(i))===e&&(this.log_("listen response",l),h!=="ok"&&this.removeListen_(r,i),e.onComplete&&e.onComplete(h,c))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&hs(e,"w")){const r=Yu(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const i='".indexOn": "'+t._queryParams.getIndex().toString()+'"',s=t._path.toString();wr(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||P7(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=G3)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=k7(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(t,r,i=>{const s=i.s,o=i.d||"error";this.authToken_===e&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,r=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,r)})}unlisten(e,t){const r=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+i),ce(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,i)&&this.connected_&&this.sendUnlisten_(r,i,e._queryObject,t)}sendUnlisten_(e,t,r,i){this.log_("Unlisten on "+e+" for "+t);const s={p:e},o="n";i&&(s.q=r,s.t=i),this.sendRequest(o,s)}onDisconnectPut(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:r})}onDisconnectMerge(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:r})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,r,i){const s={p:t,d:r};this.log_("onDisconnect "+e,s),this.sendRequest(e,s,o=>{i&&setTimeout(()=>{i(o.s,o.d)},Math.floor(0))})}put(e,t,r,i){this.putInternal("p",e,t,r,i)}merge(e,t,r,i){this.putInternal("m",e,t,r,i)}putInternal(e,t,r,i,s){this.initConnection_();const o={p:t,d:r};s!==void 0&&(o.h=s),this.outstandingPuts_.push({action:e,request:o,onComplete:i}),this.outstandingPutCount_++;const l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,r,s=>{this.log_(t+" response",s),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(s.s,s.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,r=>{if(r.s!=="ok"){const s=r.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Pn(e));const t=e.r,r=this.requestCBHash_[t];r&&(delete this.requestCBHash_[t],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):d2("Unrecognized action received from server: "+Pn(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){ce(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ah,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Ah,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>XV&&(this.reconnectDelay_=Ah),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*YV)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+Ws.nextConnectionId_++,s=this.lastSessionId;let o=!1,l=null;const c=function(){l?l.close():(o=!0,r())},h=function(m){ce(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(m)};this.realtime_={close:c,sendRequest:h};const p=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[m,_]=await Promise.all([this.authTokenProvider_.getToken(p),this.appCheckTokenProvider_.getToken(p)]);o?kn("getToken() completed but was canceled"):(kn("getToken() completed. Creating connection."),this.authToken_=m&&m.accessToken,this.appCheckToken_=_&&_.token,l=new GV(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,r,S=>{wr(S+" ("+this.repoInfo_.toString()+")"),this.interrupt(JV)},s))}catch(m){this.log_("Failed to get token: "+m),o||(this.repoInfo_.nodeAdmin&&wr(m),c())}}}interrupt(e){kn("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){kn("Resuming connection for reason: "+e),delete this.interruptReasons_[e],am(this.interruptReasons_)&&(this.reconnectDelay_=Ah,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let r;t?r=t.map(s=>OE(s)).join("$"):r="default";const i=this.removeListen_(e,r);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,t){const r=new dt(e).toString();let i;if(this.listens.has(r)){const s=this.listens.get(r);i=s.get(t),s.delete(t),s.size===0&&this.listens.delete(r)}else i=void 0;return i}onAuthRevoked_(e,t){kn("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=W3&&(this.reconnectDelay_=G3,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){kn("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=W3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+WR.replace(/\./g,"-")]=1,Fw()?e["framework.cordova"]=1:Pk()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=km.getInstance().currentlyOnline();return am(this.interruptReasons_)&&e}}Ws.nextPersistentConnectionId_=0;Ws.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Be{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Be(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D0{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new Be(sc,e),i=new Be(sc,t);return this.compare(r,i)!==0}minPost(){return Be.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ng;class m9 extends D0{static get __EMPTY_NODE(){return ng}static set __EMPTY_NODE(e){ng=e}compare(e,t){return Pl(e.name,t.name)}isDefinedOn(e){throw vc("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Be.MIN}maxPost(){return new Be(yl,ng)}makePost(e,t){return ce(typeof e=="string","KeyIndex indexValue must always be a string."),new Be(e,ng)}toString(){return".key"}}const Bu=new m9;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Tn{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??Tn.RED,this.left=i??Or.EMPTY_NODE,this.right=s??Or.EMPTY_NODE}copy(e,t,r,i,s){return new Tn(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return s<0?i=i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i=i.copy(null,t,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return Or.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let r,i;if(r=this,t(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),t(e,r.key)===0){if(r.right.isEmpty())return Or.EMPTY_NODE;i=r.right.min_(),r=r.copy(i.key,i.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Tn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Tn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Tn.RED=!0;Tn.BLACK=!1;class ZV{copy(e,t,r,i,s){return this}insert(e,t,r){return new Tn(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Or{constructor(e,t=Or.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Or(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Tn.BLACK,null,null))}remove(e){return new Or(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Tn.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new rg(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new rg(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new rg(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new rg(this.root_,null,this.comparator_,!0,e)}}Or.EMPTY_NODE=new ZV;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eU(n,e){return Pl(n.name,e.name)}function jE(n,e){return Pl(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let p2;function tU(n){p2=n}const _9=function(n){return typeof n=="number"?"number:"+QR(n):"string:"+n},y9=function(n){if(n.isLeafNode()){const e=n.val();ce(typeof e=="string"||typeof e=="number"||typeof e=="object"&&hs(e,".sv"),"Priority must be a string or number.")}else ce(n===p2||n.isEmpty(),"priority of unexpected type.");ce(n===p2||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let H3;class wn{constructor(e,t=wn.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,ce(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),y9(this.priorityNode_)}static set __childrenNodeConstructor(e){H3=e}static get __childrenNodeConstructor(){return H3}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new wn(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:wn.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Ue(e)?this:Le(e)===".priority"?this.priorityNode_:wn.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:wn.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const r=Le(e);return r===null?t:t.isEmpty()&&r!==".priority"?this:(ce(r!==".priority"||sa(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,wn.__childrenNodeConstructor.EMPTY_NODE.updateChild(vt(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+_9(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=QR(this.value_):e+=this.value_,this.lazyHash_=qR(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===wn.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof wn.__childrenNodeConstructor?-1:(ce(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,r=typeof this.value_,i=wn.VALUE_TYPE_ORDER.indexOf(t),s=wn.VALUE_TYPE_ORDER.indexOf(r);return ce(i>=0,"Unknown leaf type: "+t),ce(s>=0,"Unknown leaf type: "+r),i===s?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}wn.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let v9,w9;function nU(n){v9=n}function rU(n){w9=n}class iU extends D0{compare(e,t){const r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return s===0?Pl(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Be.MIN}maxPost(){return new Be(yl,new wn("[PRIORITY-POST]",w9))}makePost(e,t){const r=v9(e);return new Be(t,new wn("[PRIORITY-POST]",r))}toString(){return".priority"}}const Ot=new iU;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sU=Math.log(2);class oU{constructor(e){const t=s=>parseInt(Math.log(s)/sU,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Pm=function(n,e,t,r){n.sort(e);const i=function(c,h){const p=h-c;let m,_;if(p===0)return null;if(p===1)return m=n[c],_=t?t(m):m,new Tn(_,m.node,Tn.BLACK,null,null);{const S=parseInt(p/2,10)+c,E=i(c,S),x=i(S+1,h);return m=n[S],_=t?t(m):m,new Tn(_,m.node,Tn.BLACK,E,x)}},s=function(c){let h=null,p=null,m=n.length;const _=function(E,x){const M=m-E,R=m;m-=E;const P=i(M+1,R),v=n[M],k=t?t(v):v;S(new Tn(k,v.node,x,null,P))},S=function(E){h?(h.left=E,h=E):(p=E,h=E)};for(let E=0;E<c.count;++E){const x=c.nextBitIsOne(),M=Math.pow(2,c.count-(E+1));x?_(M,Tn.BLACK):(_(M,Tn.BLACK),_(M,Tn.RED))}return p},o=new oU(n.length),l=s(o);return new Or(r||e,l)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rv;const au={};class Bs{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return ce(au&&Ot,"ChildrenNode.ts has not been loaded"),Rv=Rv||new Bs({".priority":au},{".priority":Ot}),Rv}get(e){const t=Yu(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Or?t:null}hasIndex(e){return hs(this.indexSet_,e.toString())}addIndex(e,t){ce(e!==Bu,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const s=t.getIterator(Be.Wrap);let o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let l;i?l=Pm(r,e.getCompare()):l=au;const c=e.toString(),h=Object.assign({},this.indexSet_);h[c]=e;const p=Object.assign({},this.indexes_);return p[c]=l,new Bs(p,h)}addToIndexes(e,t){const r=lm(this.indexes_,(i,s)=>{const o=Yu(this.indexSet_,s);if(ce(o,"Missing index implementation for "+s),i===au)if(o.isDefinedOn(e.node)){const l=[],c=t.getIterator(Be.Wrap);let h=c.getNext();for(;h;)h.name!==e.name&&l.push(h),h=c.getNext();return l.push(e),Pm(l,o.getCompare())}else return au;else{const l=t.get(e.name);let c=i;return l&&(c=c.remove(new Be(e.name,l))),c.insert(e,e.node)}});return new Bs(r,this.indexSet_)}removeFromIndexes(e,t){const r=lm(this.indexes_,i=>{if(i===au)return i;{const s=t.get(e.name);return s?i.remove(new Be(e.name,s)):i}});return new Bs(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nh;class Pe{constructor(e,t,r){this.children_=e,this.priorityNode_=t,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&y9(this.priorityNode_),this.children_.isEmpty()&&ce(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Nh||(Nh=new Pe(new Or(jE),null,Bs.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Nh}updatePriority(e){return this.children_.isEmpty()?this:new Pe(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?Nh:t}}getChild(e){const t=Le(e);return t===null?this:this.getImmediateChild(t).getChild(vt(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(ce(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const r=new Be(e,t);let i,s;t.isEmpty()?(i=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,t),s=this.indexMap_.addToIndexes(r,this.children_));const o=i.isEmpty()?Nh:this.priorityNode_;return new Pe(i,o,s)}}updateChild(e,t){const r=Le(e);if(r===null)return t;{ce(Le(e)!==".priority"||sa(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(r).updateChild(vt(e),t);return this.updateImmediateChild(r,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let r=0,i=0,s=!0;if(this.forEachChild(Ot,(o,l)=>{t[o]=l.val(e),r++,s&&Pe.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):s=!1}),!e&&s&&i<2*r){const o=[];for(const l in t)o[l]=t[l];return o}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+_9(this.getPriority().val())+":"),this.forEachChild(Ot,(t,r)=>{const i=r.hash();i!==""&&(e+=":"+t+":"+i)}),this.lazyHash_=e===""?"":qR(e)}return this.lazyHash_}getPredecessorChildName(e,t,r){const i=this.resolveIndex_(r);if(i){const s=i.getPredecessorKey(new Be(e,t));return s?s.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const r=t.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Be(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const r=t.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Be(t,this.children_.get(t)):null}forEachChild(e,t){const r=this.resolveIndex_(e);return r?r.inorderTraversal(i=>t(i.name,i.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const r=this.resolveIndex_(t);if(r)return r.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,Be.Wrap);let s=i.peek();for(;s!=null&&t.compare(s,e)<0;)i.getNext(),s=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const r=this.resolveIndex_(t);if(r)return r.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,Be.Wrap);let s=i.peek();for(;s!=null&&t.compare(s,e)>0;)i.getNext(),s=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Tf?-1:0}withIndex(e){if(e===Bu||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new Pe(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Bu||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const r=this.getIterator(Ot),i=t.getIterator(Ot);let s=r.getNext(),o=i.getNext();for(;s&&o;){if(s.name!==o.name||!s.node.equals(o.node))return!1;s=r.getNext(),o=i.getNext()}return s===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===Bu?null:this.indexMap_.get(e.toString())}}Pe.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class aU extends Pe{constructor(){super(new Or(jE),Pe.EMPTY_NODE,Bs.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Pe.EMPTY_NODE}isEmpty(){return!1}}const Tf=new aU;Object.defineProperties(Be,{MIN:{value:new Be(sc,Pe.EMPTY_NODE)},MAX:{value:new Be(yl,Tf)}});m9.__EMPTY_NODE=Pe.EMPTY_NODE;wn.__childrenNodeConstructor=Pe;tU(Tf);rU(Tf);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lU=!0;function Kt(n,e=null){if(n===null)return Pe.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),ce(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new wn(t,Kt(e))}if(!(n instanceof Array)&&lU){const t=[];let r=!1;if(xn(n,(o,l)=>{if(o.substring(0,1)!=="."){const c=Kt(l);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),t.push(new Be(o,c)))}}),t.length===0)return Pe.EMPTY_NODE;const s=Pm(t,eU,o=>o.name,jE);if(r){const o=Pm(t,Ot.getCompare());return new Pe(s,Kt(e),new Bs({".priority":o},{".priority":Ot}))}else return new Pe(s,Kt(e),Bs.Default)}else{let t=Pe.EMPTY_NODE;return xn(n,(r,i)=>{if(hs(n,r)&&r.substring(0,1)!=="."){const s=Kt(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(Kt(e))}}nU(Kt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uU extends D0{constructor(e){super(),this.indexPath_=e,ce(!Ue(e)&&Le(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return s===0?Pl(e.name,t.name):s}makePost(e,t){const r=Kt(e),i=Pe.EMPTY_NODE.updateChild(this.indexPath_,r);return new Be(t,i)}maxPost(){const e=Pe.EMPTY_NODE.updateChild(this.indexPath_,Tf);return new Be(yl,e)}toString(){return Hd(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cU extends D0{compare(e,t){const r=e.node.compareTo(t.node);return r===0?Pl(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Be.MIN}maxPost(){return Be.MAX}makePost(e,t){const r=Kt(e);return new Be(t,r)}toString(){return".value"}}const hU=new cU;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E9(n){return{type:"value",snapshotNode:n}}function oc(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function $d(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function qd(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function dU(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GE{constructor(e){this.index_=e}updateChild(e,t,r,i,s,o){ce(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const l=e.getImmediateChild(t);return l.getChild(i).equals(r.getChild(i))&&l.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(t)?o.trackChildChange($d(t,l)):ce(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):l.isEmpty()?o.trackChildChange(oc(t,r)):o.trackChildChange(qd(t,r,l))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Ot,(i,s)=>{t.hasChild(i)||r.trackChildChange($d(i,s))}),t.isLeafNode()||t.forEachChild(Ot,(i,s)=>{if(e.hasChild(i)){const o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(qd(i,s,o))}else r.trackChildChange(oc(i,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?Pe.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kd{constructor(e){this.indexedFilter_=new GE(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Kd.getStartPost_(e),this.endPost_=Kd.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,s,o){return this.matches(new Be(t,r))||(r=Pe.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,s,o)}updateFullNode(e,t,r){t.isLeafNode()&&(t=Pe.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(Pe.EMPTY_NODE);const s=this;return t.forEachChild(Ot,(o,l)=>{s.matches(new Be(o,l))||(i=i.updateImmediateChild(o,Pe.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fU{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{const r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Kd(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,s,o){return this.rangedFilter_.matches(new Be(t,r))||(r=Pe.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,s,o):this.fullLimitUpdateChild_(e,t,r,s,o)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=Pe.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){i=Pe.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){const l=s.getNext();if(this.withinDirectionalStart(l))if(this.withinDirectionalEnd(l))i=i.updateImmediateChild(l.name,l.node),o++;else break;else continue}}else{i=t.withIndex(this.index_),i=i.updatePriority(Pe.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){const l=s.getNext();o<this.limit_&&this.withinDirectionalStart(l)&&this.withinDirectionalEnd(l)?o++:i=i.updateImmediateChild(l.name,Pe.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,s){let o;if(this.reverse_){const m=this.index_.getCompare();o=(_,S)=>m(S,_)}else o=this.index_.getCompare();const l=e;ce(l.numChildren()===this.limit_,"");const c=new Be(t,r),h=this.reverse_?l.getFirstChild(this.index_):l.getLastChild(this.index_),p=this.rangedFilter_.matches(c);if(l.hasChild(t)){const m=l.getImmediateChild(t);let _=i.getChildAfterChild(this.index_,h,this.reverse_);for(;_!=null&&(_.name===t||l.hasChild(_.name));)_=i.getChildAfterChild(this.index_,_,this.reverse_);const S=_==null?1:o(_,c);if(p&&!r.isEmpty()&&S>=0)return s!=null&&s.trackChildChange(qd(t,r,m)),l.updateImmediateChild(t,r);{s!=null&&s.trackChildChange($d(t,m));const x=l.updateImmediateChild(t,Pe.EMPTY_NODE);return _!=null&&this.rangedFilter_.matches(_)?(s!=null&&s.trackChildChange(oc(_.name,_.node)),x.updateImmediateChild(_.name,_.node)):x}}else return r.isEmpty()?e:p&&o(h,c)>=0?(s!=null&&(s.trackChildChange($d(h.name,h.node)),s.trackChildChange(oc(t,r))),l.updateImmediateChild(t,r).updateImmediateChild(h.name,Pe.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ot}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return ce(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return ce(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:sc}hasEnd(){return this.endSet_}getIndexEndValue(){return ce(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return ce(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:yl}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return ce(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ot}copy(){const e=new M0;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function pU(n){return n.loadsAllData()?new GE(n.getIndex()):n.hasLimit()?new fU(n):new Kd(n)}function $3(n){const e={};if(n.isDefault())return e;let t;if(n.index_===Ot?t="$priority":n.index_===hU?t="$value":n.index_===Bu?t="$key":(ce(n.index_ instanceof uU,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=Pn(t),n.startSet_){const r=n.startAfterSet_?"startAfter":"startAt";e[r]=Pn(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+Pn(n.indexStartName_))}if(n.endSet_){const r=n.endBeforeSet_?"endBefore":"endAt";e[r]=Pn(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+Pn(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function q3(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==Ot&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rm extends d9{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Cf("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(ce(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const o=Rm.getListenId_(e,r),l={};this.listens_[o]=l;const c=$3(e._queryParams);this.restRequest_(s+".json",c,(h,p)=>{let m=p;if(h===404&&(m=null,h=null),h===null&&this.onDataUpdate_(s,m,!1,r),Yu(this.listens_,o)===l){let _;h?h===401?_="permission_denied":_="rest_error:"+h:_="ok",i(_,null)}})}unlisten(e,t){const r=Rm.getListenId_(e,t);delete this.listens_[r]}get(e){const t=$3(e._queryParams),r=e._path.toString(),i=new rs;return this.restRequest_(r+".json",t,(s,o)=>{let l=o;s===404&&(l=null,s=null),s===null?(this.onDataUpdate_(r,l,!1,null),i.resolve(l)):i.reject(new Error(l))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+wc(t);this.log_("Sending REST request for "+o);const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(r&&l.readyState===4){this.log_("REST Response for "+o+" received. status:",l.status,"response:",l.responseText);let c=null;if(l.status>=200&&l.status<300){try{c=bd(l.responseText)}catch{wr("Failed to parse JSON response for "+o+": "+l.responseText)}r(null,c)}else l.status!==401&&l.status!==404&&wr("Got unsuccessful REST response for "+o+" Status: "+l.status),r(l.status);r=null}},l.open("GET",o,!0),l.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gU{constructor(){this.rootNode_=Pe.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xm(){return{value:null,children:new Map}}function Pc(n,e,t){if(Ue(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const r=Le(e);n.children.has(r)||n.children.set(r,xm());const i=n.children.get(r);e=vt(e),Pc(i,e,t)}}function g2(n,e){if(Ue(e))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{const t=n.value;return n.value=null,t.forEachChild(Ot,(r,i)=>{Pc(n,new dt(r),i)}),g2(n,e)}}else if(n.children.size>0){const t=Le(e);return e=vt(e),n.children.has(t)&&g2(n.children.get(t),e)&&n.children.delete(t),n.children.size===0}else return!0}function m2(n,e,t){n.value!==null?t(e,n.value):mU(n,(r,i)=>{const s=new dt(e.toString()+"/"+r);m2(i,s,t)})}function mU(n,e){n.children.forEach((t,r)=>{e(r,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _U{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&xn(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K3=10*1e3,yU=30*1e3,vU=5*60*1e3;class wU{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new _U(e);const r=K3+(yU-K3)*Math.random();ud(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;xn(e,(i,s)=>{s>0&&hs(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),ud(this.reportStats_.bind(this),Math.floor(Math.random()*2*vU))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xi;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(xi||(xi={}));function WE(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function HE(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function $E(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Am{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=xi.ACK_USER_WRITE,this.source=WE()}operationForChild(e){if(Ue(this.path)){if(this.affectedTree.value!=null)return ce(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new dt(e));return new Am(at(),t,this.revert)}}else return ce(Le(this.path)===e,"operationForChild called for unrelated child."),new Am(vt(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qd{constructor(e,t){this.source=e,this.path=t,this.type=xi.LISTEN_COMPLETE}operationForChild(e){return Ue(this.path)?new Qd(this.source,at()):new Qd(this.source,vt(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vl{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=xi.OVERWRITE}operationForChild(e){return Ue(this.path)?new vl(this.source,at(),this.snap.getImmediateChild(e)):new vl(this.source,vt(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ac{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=xi.MERGE}operationForChild(e){if(Ue(this.path)){const t=this.children.subtree(new dt(e));return t.isEmpty()?null:t.value?new vl(this.source,at(),t.value):new ac(this.source,at(),t)}else return ce(Le(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new ac(this.source,vt(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wl{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Ue(e))return this.isFullyInitialized()&&!this.filtered_;const t=Le(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EU{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function SU(n,e,t,r){const i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(dU(o.childName,o.snapshotNode))}),bh(n,i,"child_removed",e,r,t),bh(n,i,"child_added",e,r,t),bh(n,i,"child_moved",s,r,t),bh(n,i,"child_changed",e,r,t),bh(n,i,"value",e,r,t),i}function bh(n,e,t,r,i,s){const o=r.filter(l=>l.type===t);o.sort((l,c)=>TU(n,l,c)),o.forEach(l=>{const c=CU(n,l,s);i.forEach(h=>{h.respondsTo(l.type)&&e.push(h.createEvent(c,n.query_))})})}function CU(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function TU(n,e,t){if(e.childName==null||t.childName==null)throw vc("Should only compare child_ events.");const r=new Be(e.childName,e.snapshotNode),i=new Be(t.childName,t.snapshotNode);return n.index_.compare(r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O0(n,e){return{eventCache:n,serverCache:e}}function cd(n,e,t,r){return O0(new wl(e,t,r),n.serverCache)}function S9(n,e,t,r){return O0(n.eventCache,new wl(e,t,r))}function _2(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function El(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xv;const IU=()=>(xv||(xv=new Or(uV)),xv);class Ct{constructor(e,t=IU()){this.value=e,this.children=t}static fromObject(e){let t=new Ct(null);return xn(e,(r,i)=>{t=t.set(new dt(r),i)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:at(),value:this.value};if(Ue(e))return null;{const r=Le(e),i=this.children.get(r);if(i!==null){const s=i.findRootMostMatchingPathAndValue(vt(e),t);return s!=null?{path:Mt(new dt(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Ue(e))return this;{const t=Le(e),r=this.children.get(t);return r!==null?r.subtree(vt(e)):new Ct(null)}}set(e,t){if(Ue(e))return new Ct(t,this.children);{const r=Le(e),s=(this.children.get(r)||new Ct(null)).set(vt(e),t),o=this.children.insert(r,s);return new Ct(this.value,o)}}remove(e){if(Ue(e))return this.children.isEmpty()?new Ct(null):new Ct(null,this.children);{const t=Le(e),r=this.children.get(t);if(r){const i=r.remove(vt(e));let s;return i.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,i),this.value===null&&s.isEmpty()?new Ct(null):new Ct(this.value,s)}else return this}}get(e){if(Ue(e))return this.value;{const t=Le(e),r=this.children.get(t);return r?r.get(vt(e)):null}}setTree(e,t){if(Ue(e))return t;{const r=Le(e),s=(this.children.get(r)||new Ct(null)).setTree(vt(e),t);let o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new Ct(this.value,o)}}fold(e){return this.fold_(at(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Mt(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,at(),t)}findOnPath_(e,t,r){const i=this.value?r(t,this.value):!1;if(i)return i;if(Ue(e))return null;{const s=Le(e),o=this.children.get(s);return o?o.findOnPath_(vt(e),Mt(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,at(),t)}foreachOnPath_(e,t,r){if(Ue(e))return this;{this.value&&r(t,this.value);const i=Le(e),s=this.children.get(i);return s?s.foreachOnPath_(vt(e),Mt(t,i),r):new Ct(null)}}foreach(e){this.foreach_(at(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(Mt(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di{constructor(e){this.writeTree_=e}static empty(){return new Di(new Ct(null))}}function hd(n,e,t){if(Ue(e))return new Di(new Ct(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){const i=r.path;let s=r.value;const o=Mr(i,e);return s=s.updateChild(o,t),new Di(n.writeTree_.set(i,s))}else{const i=new Ct(t),s=n.writeTree_.setTree(e,i);return new Di(s)}}}function y2(n,e,t){let r=n;return xn(t,(i,s)=>{r=hd(r,Mt(e,i),s)}),r}function Q3(n,e){if(Ue(e))return Di.empty();{const t=n.writeTree_.setTree(e,new Ct(null));return new Di(t)}}function v2(n,e){return Rl(n,e)!=null}function Rl(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(Mr(t.path,e)):null}function Y3(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(Ot,(r,i)=>{e.push(new Be(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new Be(r,i.value))}),e}function Xo(n,e){if(Ue(e))return n;{const t=Rl(n,e);return t!=null?new Di(new Ct(t)):new Di(n.writeTree_.subtree(e))}}function w2(n){return n.writeTree_.isEmpty()}function lc(n,e){return C9(at(),n.writeTree_,e)}function C9(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(ce(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):t=C9(Mt(n,i),s,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(Mt(n,".priority"),r)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qE(n,e){return P9(e,n)}function kU(n,e,t,r,i){ce(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=hd(n.visibleWrites,e,t)),n.lastWriteId=r}function PU(n,e,t,r){ce(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=y2(n.visibleWrites,e,t),n.lastWriteId=r}function RU(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}function xU(n,e){const t=n.allWrites.findIndex(l=>l.writeId===e);ce(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){const l=n.allWrites[o];l.visible&&(o>=t&&AU(l,r.path)?i=!1:ai(r.path,l.path)&&(s=!0)),o--}if(i){if(s)return NU(n),!0;if(r.snap)n.visibleWrites=Q3(n.visibleWrites,r.path);else{const l=r.children;xn(l,c=>{n.visibleWrites=Q3(n.visibleWrites,Mt(r.path,c))})}return!0}else return!1}function AU(n,e){if(n.snap)return ai(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&ai(Mt(n.path,t),e))return!0;return!1}function NU(n){n.visibleWrites=T9(n.allWrites,bU,at()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function bU(n){return n.visible}function T9(n,e,t){let r=Di.empty();for(let i=0;i<n.length;++i){const s=n[i];if(e(s)){const o=s.path;let l;if(s.snap)ai(t,o)?(l=Mr(t,o),r=hd(r,l,s.snap)):ai(o,t)&&(l=Mr(o,t),r=hd(r,at(),s.snap.getChild(l)));else if(s.children){if(ai(t,o))l=Mr(t,o),r=y2(r,l,s.children);else if(ai(o,t))if(l=Mr(o,t),Ue(l))r=y2(r,at(),s.children);else{const c=Yu(s.children,Le(l));if(c){const h=c.getChild(vt(l));r=hd(r,at(),h)}}}else throw vc("WriteRecord should have .snap or .children")}}return r}function I9(n,e,t,r,i){if(!r&&!i){const s=Rl(n.visibleWrites,e);if(s!=null)return s;{const o=Xo(n.visibleWrites,e);if(w2(o))return t;if(t==null&&!v2(o,at()))return null;{const l=t||Pe.EMPTY_NODE;return lc(o,l)}}}else{const s=Xo(n.visibleWrites,e);if(!i&&w2(s))return t;if(!i&&t==null&&!v2(s,at()))return null;{const o=function(h){return(h.visible||i)&&(!r||!~r.indexOf(h.writeId))&&(ai(h.path,e)||ai(e,h.path))},l=T9(n.allWrites,o,e),c=t||Pe.EMPTY_NODE;return lc(l,c)}}}function DU(n,e,t){let r=Pe.EMPTY_NODE;const i=Rl(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Ot,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){const s=Xo(n.visibleWrites,e);return t.forEachChild(Ot,(o,l)=>{const c=lc(Xo(s,new dt(o)),l);r=r.updateImmediateChild(o,c)}),Y3(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{const s=Xo(n.visibleWrites,e);return Y3(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function MU(n,e,t,r,i){ce(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=Mt(e,t);if(v2(n.visibleWrites,s))return null;{const o=Xo(n.visibleWrites,s);return w2(o)?i.getChild(t):lc(o,i.getChild(t))}}function OU(n,e,t,r){const i=Mt(e,t),s=Rl(n.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(t)){const o=Xo(n.visibleWrites,i);return lc(o,r.getNode().getImmediateChild(t))}else return null}function LU(n,e){return Rl(n.visibleWrites,e)}function FU(n,e,t,r,i,s,o){let l;const c=Xo(n.visibleWrites,e),h=Rl(c,at());if(h!=null)l=h;else if(t!=null)l=lc(c,t);else return[];if(l=l.withIndex(o),!l.isEmpty()&&!l.isLeafNode()){const p=[],m=o.getCompare(),_=s?l.getReverseIteratorFrom(r,o):l.getIteratorFrom(r,o);let S=_.getNext();for(;S&&p.length<i;)m(S,r)!==0&&p.push(S),S=_.getNext();return p}else return[]}function VU(){return{visibleWrites:Di.empty(),allWrites:[],lastWriteId:-1}}function Nm(n,e,t,r){return I9(n.writeTree,n.treePath,e,t,r)}function KE(n,e){return DU(n.writeTree,n.treePath,e)}function X3(n,e,t,r){return MU(n.writeTree,n.treePath,e,t,r)}function bm(n,e){return LU(n.writeTree,Mt(n.treePath,e))}function UU(n,e,t,r,i,s){return FU(n.writeTree,n.treePath,e,t,r,i,s)}function QE(n,e,t){return OU(n.writeTree,n.treePath,e,t)}function k9(n,e){return P9(Mt(n.treePath,e),n.writeTree)}function P9(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BU{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;ce(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),ce(r!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const s=i.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(r,qd(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(r,$d(r,i.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(r,oc(r,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(r,qd(r,e.snapshotNode,i.oldSnap));else throw vc("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zU{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}}const R9=new zU;class YE{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new wl(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return QE(this.writes_,e,r)}}getChildAfterChild(e,t,r){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:El(this.viewCache_),s=UU(this.writes_,i,t,1,r,e);return s.length===0?null:s[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jU(n){return{filter:n}}function GU(n,e){ce(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),ce(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function WU(n,e,t,r,i){const s=new BU;let o,l;if(t.type===xi.OVERWRITE){const h=t;h.source.fromUser?o=E2(n,e,h.path,h.snap,r,i,s):(ce(h.source.fromServer,"Unknown source."),l=h.source.tagged||e.serverCache.isFiltered()&&!Ue(h.path),o=Dm(n,e,h.path,h.snap,r,i,l,s))}else if(t.type===xi.MERGE){const h=t;h.source.fromUser?o=$U(n,e,h.path,h.children,r,i,s):(ce(h.source.fromServer,"Unknown source."),l=h.source.tagged||e.serverCache.isFiltered(),o=S2(n,e,h.path,h.children,r,i,l,s))}else if(t.type===xi.ACK_USER_WRITE){const h=t;h.revert?o=QU(n,e,h.path,r,i,s):o=qU(n,e,h.path,h.affectedTree,r,i,s)}else if(t.type===xi.LISTEN_COMPLETE)o=KU(n,e,t.path,r,s);else throw vc("Unknown operation type: "+t.type);const c=s.getChanges();return HU(e,o,c),{viewCache:o,changes:c}}function HU(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=_2(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(E9(_2(e)))}}function x9(n,e,t,r,i,s){const o=e.eventCache;if(bm(r,t)!=null)return e;{let l,c;if(Ue(t))if(ce(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const h=El(e),p=h instanceof Pe?h:Pe.EMPTY_NODE,m=KE(r,p);l=n.filter.updateFullNode(e.eventCache.getNode(),m,s)}else{const h=Nm(r,El(e));l=n.filter.updateFullNode(e.eventCache.getNode(),h,s)}else{const h=Le(t);if(h===".priority"){ce(sa(t)===1,"Can't have a priority with additional path components");const p=o.getNode();c=e.serverCache.getNode();const m=X3(r,t,p,c);m!=null?l=n.filter.updatePriority(p,m):l=o.getNode()}else{const p=vt(t);let m;if(o.isCompleteForChild(h)){c=e.serverCache.getNode();const _=X3(r,t,o.getNode(),c);_!=null?m=o.getNode().getImmediateChild(h).updateChild(p,_):m=o.getNode().getImmediateChild(h)}else m=QE(r,h,e.serverCache);m!=null?l=n.filter.updateChild(o.getNode(),h,m,p,i,s):l=o.getNode()}}return cd(e,l,o.isFullyInitialized()||Ue(t),n.filter.filtersNodes())}}function Dm(n,e,t,r,i,s,o,l){const c=e.serverCache;let h;const p=o?n.filter:n.filter.getIndexedFilter();if(Ue(t))h=p.updateFullNode(c.getNode(),r,null);else if(p.filtersNodes()&&!c.isFiltered()){const S=c.getNode().updateChild(t,r);h=p.updateFullNode(c.getNode(),S,null)}else{const S=Le(t);if(!c.isCompleteForPath(t)&&sa(t)>1)return e;const E=vt(t),M=c.getNode().getImmediateChild(S).updateChild(E,r);S===".priority"?h=p.updatePriority(c.getNode(),M):h=p.updateChild(c.getNode(),S,M,E,R9,null)}const m=S9(e,h,c.isFullyInitialized()||Ue(t),p.filtersNodes()),_=new YE(i,m,s);return x9(n,m,t,i,_,l)}function E2(n,e,t,r,i,s,o){const l=e.eventCache;let c,h;const p=new YE(i,e,s);if(Ue(t))h=n.filter.updateFullNode(e.eventCache.getNode(),r,o),c=cd(e,h,!0,n.filter.filtersNodes());else{const m=Le(t);if(m===".priority")h=n.filter.updatePriority(e.eventCache.getNode(),r),c=cd(e,h,l.isFullyInitialized(),l.isFiltered());else{const _=vt(t),S=l.getNode().getImmediateChild(m);let E;if(Ue(_))E=r;else{const x=p.getCompleteChild(m);x!=null?UE(_)===".priority"&&x.getChild(p9(_)).isEmpty()?E=x:E=x.updateChild(_,r):E=Pe.EMPTY_NODE}if(S.equals(E))c=e;else{const x=n.filter.updateChild(l.getNode(),m,E,_,p,o);c=cd(e,x,l.isFullyInitialized(),n.filter.filtersNodes())}}}return c}function J3(n,e){return n.eventCache.isCompleteForChild(e)}function $U(n,e,t,r,i,s,o){let l=e;return r.foreach((c,h)=>{const p=Mt(t,c);J3(e,Le(p))&&(l=E2(n,l,p,h,i,s,o))}),r.foreach((c,h)=>{const p=Mt(t,c);J3(e,Le(p))||(l=E2(n,l,p,h,i,s,o))}),l}function Z3(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function S2(n,e,t,r,i,s,o,l){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,h;Ue(t)?h=r:h=new Ct(null).setTree(t,r);const p=e.serverCache.getNode();return h.children.inorderTraversal((m,_)=>{if(p.hasChild(m)){const S=e.serverCache.getNode().getImmediateChild(m),E=Z3(n,S,_);c=Dm(n,c,new dt(m),E,i,s,o,l)}}),h.children.inorderTraversal((m,_)=>{const S=!e.serverCache.isCompleteForChild(m)&&_.value===null;if(!p.hasChild(m)&&!S){const E=e.serverCache.getNode().getImmediateChild(m),x=Z3(n,E,_);c=Dm(n,c,new dt(m),x,i,s,o,l)}}),c}function qU(n,e,t,r,i,s,o){if(bm(i,t)!=null)return e;const l=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(Ue(t)&&c.isFullyInitialized()||c.isCompleteForPath(t))return Dm(n,e,t,c.getNode().getChild(t),i,s,l,o);if(Ue(t)){let h=new Ct(null);return c.getNode().forEachChild(Bu,(p,m)=>{h=h.set(new dt(p),m)}),S2(n,e,t,h,i,s,l,o)}else return e}else{let h=new Ct(null);return r.foreach((p,m)=>{const _=Mt(t,p);c.isCompleteForPath(_)&&(h=h.set(p,c.getNode().getChild(_)))}),S2(n,e,t,h,i,s,l,o)}}function KU(n,e,t,r,i){const s=e.serverCache,o=S9(e,s.getNode(),s.isFullyInitialized()||Ue(t),s.isFiltered());return x9(n,o,t,r,R9,i)}function QU(n,e,t,r,i,s){let o;if(bm(r,t)!=null)return e;{const l=new YE(r,e,i),c=e.eventCache.getNode();let h;if(Ue(t)||Le(t)===".priority"){let p;if(e.serverCache.isFullyInitialized())p=Nm(r,El(e));else{const m=e.serverCache.getNode();ce(m instanceof Pe,"serverChildren would be complete if leaf node"),p=KE(r,m)}p=p,h=n.filter.updateFullNode(c,p,s)}else{const p=Le(t);let m=QE(r,p,e.serverCache);m==null&&e.serverCache.isCompleteForChild(p)&&(m=c.getImmediateChild(p)),m!=null?h=n.filter.updateChild(c,p,m,vt(t),l,s):e.eventCache.getNode().hasChild(p)?h=n.filter.updateChild(c,p,Pe.EMPTY_NODE,vt(t),l,s):h=c,h.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Nm(r,El(e)),o.isLeafNode()&&(h=n.filter.updateFullNode(h,o,s)))}return o=e.serverCache.isFullyInitialized()||bm(r,at())!=null,cd(e,h,o,n.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YU{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new GE(r.getIndex()),s=pU(r);this.processor_=jU(s);const o=t.serverCache,l=t.eventCache,c=i.updateFullNode(Pe.EMPTY_NODE,o.getNode(),null),h=s.updateFullNode(Pe.EMPTY_NODE,l.getNode(),null),p=new wl(c,o.isFullyInitialized(),i.filtersNodes()),m=new wl(h,l.isFullyInitialized(),s.filtersNodes());this.viewCache_=O0(m,p),this.eventGenerator_=new EU(this.query_)}get query(){return this.query_}}function XU(n){return n.viewCache_.serverCache.getNode()}function JU(n,e){const t=El(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!Ue(e)&&!t.getImmediateChild(Le(e)).isEmpty())?t.getChild(e):null}function e5(n){return n.eventRegistrations_.length===0}function ZU(n,e){n.eventRegistrations_.push(e)}function t5(n,e,t){const r=[];if(t){ce(e==null,"A cancel should cancel all event registrations.");const i=n.query._path;n.eventRegistrations_.forEach(s=>{const o=s.createCancelEvent(t,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<n.eventRegistrations_.length;++s){const o=n.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(s+1));break}}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function n5(n,e,t,r){e.type===xi.MERGE&&e.source.queryId!==null&&(ce(El(n.viewCache_),"We should always have a full cache before handling merges"),ce(_2(n.viewCache_),"Missing event cache, even though we have a server cache"));const i=n.viewCache_,s=WU(n.processor_,i,e,t,r);return GU(n.processor_,s.viewCache),ce(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,A9(n,s.changes,s.viewCache.eventCache.getNode(),null)}function eB(n,e){const t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(Ot,(s,o)=>{r.push(oc(s,o))}),t.isFullyInitialized()&&r.push(E9(t.getNode())),A9(n,r,t.getNode(),e)}function A9(n,e,t,r){const i=r?[r]:n.eventRegistrations_;return SU(n.eventGenerator_,e,t,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Mm;class tB{constructor(){this.views=new Map}}function nB(n){ce(!Mm,"__referenceConstructor has already been defined"),Mm=n}function rB(){return ce(Mm,"Reference.ts has not been loaded"),Mm}function iB(n){return n.views.size===0}function XE(n,e,t,r){const i=e.source.queryId;if(i!==null){const s=n.views.get(i);return ce(s!=null,"SyncTree gave us an op for an invalid query."),n5(s,e,t,r)}else{let s=[];for(const o of n.views.values())s=s.concat(n5(o,e,t,r));return s}}function sB(n,e,t,r,i){const s=e._queryIdentifier,o=n.views.get(s);if(!o){let l=Nm(t,i?r:null),c=!1;l?c=!0:r instanceof Pe?(l=KE(t,r),c=!1):(l=Pe.EMPTY_NODE,c=!1);const h=O0(new wl(l,c,!1),new wl(r,i,!1));return new YU(e,h)}return o}function oB(n,e,t,r,i,s){const o=sB(n,e,r,i,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),ZU(o,t),eB(o,t)}function aB(n,e,t,r){const i=e._queryIdentifier,s=[];let o=[];const l=oa(n);if(i==="default")for(const[c,h]of n.views.entries())o=o.concat(t5(h,t,r)),e5(h)&&(n.views.delete(c),h.query._queryParams.loadsAllData()||s.push(h.query));else{const c=n.views.get(i);c&&(o=o.concat(t5(c,t,r)),e5(c)&&(n.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return l&&!oa(n)&&s.push(new(rB())(e._repo,e._path)),{removed:s,events:o}}function N9(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function zu(n,e){let t=null;for(const r of n.views.values())t=t||JU(r,e);return t}function b9(n,e){if(e._queryParams.loadsAllData())return L0(n);{const r=e._queryIdentifier;return n.views.get(r)}}function D9(n,e){return b9(n,e)!=null}function oa(n){return L0(n)!=null}function L0(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Om;function lB(n){ce(!Om,"__referenceConstructor has already been defined"),Om=n}function uB(){return ce(Om,"Reference.ts has not been loaded"),Om}let cB=1;class r5{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Ct(null),this.pendingWriteTree_=VU(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function M9(n,e,t,r,i){return kU(n.pendingWriteTree_,e,t,r,i),i?Rc(n,new vl(WE(),e,t)):[]}function hB(n,e,t,r){PU(n.pendingWriteTree_,e,t,r);const i=Ct.fromObject(t);return Rc(n,new ac(WE(),e,i))}function Vo(n,e,t=!1){const r=RU(n.pendingWriteTree_,e);if(xU(n.pendingWriteTree_,e)){let s=new Ct(null);return r.snap!=null?s=s.set(at(),!0):xn(r.children,o=>{s=s.set(new dt(o),!0)}),Rc(n,new Am(r.path,s,t))}else return[]}function F0(n,e,t){return Rc(n,new vl(HE(),e,t))}function dB(n,e,t){const r=Ct.fromObject(t);return Rc(n,new ac(HE(),e,r))}function fB(n,e){return Rc(n,new Qd(HE(),e))}function pB(n,e,t){const r=ZE(n,t);if(r){const i=eS(r),s=i.path,o=i.queryId,l=Mr(s,e),c=new Qd($E(o),l);return tS(n,s,c)}else return[]}function C2(n,e,t,r,i=!1){const s=e._path,o=n.syncPointTree_.get(s);let l=[];if(o&&(e._queryIdentifier==="default"||D9(o,e))){const c=aB(o,e,t,r);iB(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));const h=c.removed;if(l=c.events,!i){const p=h.findIndex(_=>_._queryParams.loadsAllData())!==-1,m=n.syncPointTree_.findOnPath(s,(_,S)=>oa(S));if(p&&!m){const _=n.syncPointTree_.subtree(s);if(!_.isEmpty()){const S=_B(_);for(let E=0;E<S.length;++E){const x=S[E],M=x.query,R=F9(n,x);n.listenProvider_.startListening(dd(M),Lm(n,M),R.hashFn,R.onComplete)}}}!m&&h.length>0&&!r&&(p?n.listenProvider_.stopListening(dd(e),null):h.forEach(_=>{const S=n.queryToTagMap.get(V0(_));n.listenProvider_.stopListening(dd(_),S)}))}yB(n,h)}return l}function gB(n,e,t,r){const i=ZE(n,r);if(i!=null){const s=eS(i),o=s.path,l=s.queryId,c=Mr(o,e),h=new vl($E(l),c,t);return tS(n,o,h)}else return[]}function mB(n,e,t,r){const i=ZE(n,r);if(i){const s=eS(i),o=s.path,l=s.queryId,c=Mr(o,e),h=Ct.fromObject(t),p=new ac($E(l),c,h);return tS(n,o,p)}else return[]}function i5(n,e,t,r=!1){const i=e._path;let s=null,o=!1;n.syncPointTree_.foreachOnPath(i,(_,S)=>{const E=Mr(_,i);s=s||zu(S,E),o=o||oa(S)});let l=n.syncPointTree_.get(i);l?(o=o||oa(l),s=s||zu(l,at())):(l=new tB,n.syncPointTree_=n.syncPointTree_.set(i,l));let c;s!=null?c=!0:(c=!1,s=Pe.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((S,E)=>{const x=zu(E,at());x&&(s=s.updateImmediateChild(S,x))}));const h=D9(l,e);if(!h&&!e._queryParams.loadsAllData()){const _=V0(e);ce(!n.queryToTagMap.has(_),"View does not exist, but we have a tag");const S=vB();n.queryToTagMap.set(_,S),n.tagToQueryMap.set(S,_)}const p=qE(n.pendingWriteTree_,i);let m=oB(l,e,t,p,s,c);if(!h&&!o&&!r){const _=b9(l,e);m=m.concat(wB(n,e,_))}return m}function JE(n,e,t){const i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,l)=>{const c=Mr(o,e),h=zu(l,c);if(h)return h});return I9(i,e,s,t,!0)}function Rc(n,e){return O9(e,n.syncPointTree_,null,qE(n.pendingWriteTree_,at()))}function O9(n,e,t,r){if(Ue(n.path))return L9(n,e,t,r);{const i=e.get(at());t==null&&i!=null&&(t=zu(i,at()));let s=[];const o=Le(n.path),l=n.operationForChild(o),c=e.children.get(o);if(c&&l){const h=t?t.getImmediateChild(o):null,p=k9(r,o);s=s.concat(O9(l,c,h,p))}return i&&(s=s.concat(XE(i,n,r,t))),s}}function L9(n,e,t,r){const i=e.get(at());t==null&&i!=null&&(t=zu(i,at()));let s=[];return e.children.inorderTraversal((o,l)=>{const c=t?t.getImmediateChild(o):null,h=k9(r,o),p=n.operationForChild(o);p&&(s=s.concat(L9(p,l,c,h)))}),i&&(s=s.concat(XE(i,n,r,t))),s}function F9(n,e){const t=e.query,r=Lm(n,t);return{hashFn:()=>(XU(e)||Pe.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?pB(n,t._path,r):fB(n,t._path);{const s=dV(i,t);return C2(n,t,null,s)}}}}function Lm(n,e){const t=V0(e);return n.queryToTagMap.get(t)}function V0(n){return n._path.toString()+"$"+n._queryIdentifier}function ZE(n,e){return n.tagToQueryMap.get(e)}function eS(n){const e=n.indexOf("$");return ce(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new dt(n.substr(0,e))}}function tS(n,e,t){const r=n.syncPointTree_.get(e);ce(r,"Missing sync point for query tag that we're tracking");const i=qE(n.pendingWriteTree_,e);return XE(r,t,i,null)}function _B(n){return n.fold((e,t,r)=>{if(t&&oa(t))return[L0(t)];{let i=[];return t&&(i=N9(t)),xn(r,(s,o)=>{i=i.concat(o)}),i}})}function dd(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(uB())(n._repo,n._path):n}function yB(n,e){for(let t=0;t<e.length;++t){const r=e[t];if(!r._queryParams.loadsAllData()){const i=V0(r),s=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(s)}}}function vB(){return cB++}function wB(n,e,t){const r=e._path,i=Lm(n,e),s=F9(n,t),o=n.listenProvider_.startListening(dd(e),i,s.hashFn,s.onComplete),l=n.syncPointTree_.subtree(r);if(i)ce(!oa(l.value),"If we're adding a query, it shouldn't be shadowed");else{const c=l.fold((h,p,m)=>{if(!Ue(h)&&p&&oa(p))return[L0(p).query];{let _=[];return p&&(_=_.concat(N9(p).map(S=>S.query))),xn(m,(S,E)=>{_=_.concat(E)}),_}});for(let h=0;h<c.length;++h){const p=c[h];n.listenProvider_.stopListening(dd(p),Lm(n,p))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nS{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new nS(t)}node(){return this.node_}}class rS{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Mt(this.path_,e);return new rS(this.syncTree_,t)}node(){return JE(this.syncTree_,this.path_)}}const EB=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},s5=function(n,e,t){if(!n||typeof n!="object")return n;if(ce(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return SB(n[".sv"],e,t);if(typeof n[".sv"]=="object")return CB(n[".sv"],e);ce(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},SB=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:ce(!1,"Unexpected server value: "+n)}},CB=function(n,e,t){n.hasOwnProperty("increment")||ce(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;typeof r!="number"&&ce(!1,"Unexpected increment value: "+r);const i=e.node();if(ce(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return typeof o!="number"?r:o+r},V9=function(n,e,t,r){return iS(e,new rS(t,n),r)},U9=function(n,e,t){return iS(n,new nS(e),t)};function iS(n,e,t){const r=n.getPriority().val(),i=s5(r,e.getImmediateChild(".priority"),t);let s;if(n.isLeafNode()){const o=n,l=s5(o.getValue(),e,t);return l!==o.getValue()||i!==o.getPriority().val()?new wn(l,Kt(i)):n}else{const o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new wn(i))),o.forEachChild(Ot,(l,c)=>{const h=iS(c,e.getImmediateChild(l),t);h!==c&&(s=s.updateImmediateChild(l,h))}),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function oS(n,e){let t=e instanceof dt?e:new dt(e),r=n,i=Le(t);for(;i!==null;){const s=Yu(r.node.children,i)||{children:{},childCount:0};r=new sS(i,r,s),t=vt(t),i=Le(t)}return r}function xc(n){return n.node.value}function B9(n,e){n.node.value=e,T2(n)}function z9(n){return n.node.childCount>0}function TB(n){return xc(n)===void 0&&!z9(n)}function U0(n,e){xn(n.node.children,(t,r)=>{e(new sS(t,n,r))})}function j9(n,e,t,r){t&&e(n),U0(n,i=>{j9(i,e,!0)})}function IB(n,e,t){let r=n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function If(n){return new dt(n.parent===null?n.name:If(n.parent)+"/"+n.name)}function T2(n){n.parent!==null&&kB(n.parent,n.name,n)}function kB(n,e,t){const r=TB(t),i=hs(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,T2(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,T2(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PB=/[\[\].#$\/\u0000-\u001F\u007F]/,RB=/[\[\].#$\u0000-\u001F\u007F]/,Av=10*1024*1024,aS=function(n){return typeof n=="string"&&n.length!==0&&!PB.test(n)},G9=function(n){return typeof n=="string"&&n.length!==0&&!RB.test(n)},xB=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),G9(n)},W9=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!b0(n)||n&&typeof n=="object"&&hs(n,".sv")},I2=function(n,e,t,r){B0(Xu(n,"value"),e,t)},B0=function(n,e,t){const r=t instanceof dt?new $V(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Ka(r));if(typeof e=="function")throw new Error(n+"contains a function "+Ka(r)+" with contents = "+e.toString());if(b0(e))throw new Error(n+"contains "+e.toString()+" "+Ka(r));if(typeof e=="string"&&e.length>Av/3&&l0(e)>Av)throw new Error(n+"contains a string greater than "+Av+" utf8 bytes "+Ka(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(xn(e,(o,l)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!aS(o)))throw new Error(n+" contains an invalid key ("+o+") "+Ka(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);qV(r,o),B0(n,l,r),KV(r)}),i&&s)throw new Error(n+' contains ".value" child '+Ka(r)+" in addition to actual children.")}},AB=function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];const s=Hd(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!aS(s[o]))throw new Error(n+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(HV);let i=null;for(t=0;t<e.length;t++){if(r=e[t],i!==null&&ai(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},H9=function(n,e,t,r){const i=Xu(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const s=[];xn(e,(o,l)=>{const c=new dt(o);if(B0(i,l,Mt(t,c)),UE(c)===".priority"&&!W9(l))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(c)}),AB(i,s)},NB=function(n,e,t){if(b0(e))throw new Error(Xu(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!W9(e))throw new Error(Xu(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},lS=function(n,e,t,r){if(!G9(t))throw new Error(Xu(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},bB=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),lS(n,e,t)},nl=function(n,e){if(Le(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},DB=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!aS(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!xB(t))throw new Error(Xu(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MB{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function z0(n,e){let t=null;for(let r=0;r<e.length;r++){const i=e[r],s=i.getPath();t!==null&&!BE(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)}function $9(n,e,t){z0(n,t),q9(n,r=>BE(r,e))}function Fi(n,e,t){z0(n,t),q9(n,r=>ai(r,e)||ai(e,r))}function q9(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const i=n.eventLists_[r];if(i){const s=i.path;e(s)?(OB(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function OB(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const r=t.getEventRunner();ld&&kn("event: "+t.toString()),kc(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LB="repo_interrupt",FB=25;class VB{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new MB,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=xm(),this.transactionQueueTree_=new sS,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function UB(n,e,t){if(n.stats_=FE(n.repoInfo_),n.forceRestClient_||mV())n.server_=new Rm(n.repoInfo_,(r,i,s,o)=>{o5(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>a5(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Pn(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new Ws(n.repoInfo_,e,(r,i,s,o)=>{o5(n,r,i,s,o)},r=>{a5(n,r)},r=>{zB(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=EV(n.repoInfo_,()=>new wU(n.stats_,n.server_)),n.infoData_=new gU,n.infoSyncTree_=new r5({startListening:(r,i,s,o)=>{let l=[];const c=n.infoData_.getNode(r._path);return c.isEmpty()||(l=F0(n.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),l},stopListening:()=>{}}),uS(n,"connected",!1),n.serverSyncTree_=new r5({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(l,c)=>{const h=o(l,c);Fi(n.eventQueue_,r._path,h)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function BB(n){const t=n.infoData_.getNode(new dt(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function j0(n){return EB({timestamp:BB(n)})}function o5(n,e,t,r,i){n.dataUpdateCount++;const s=new dt(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){const c=lm(t,h=>Kt(h));o=mB(n.serverSyncTree_,s,c,i)}else{const c=Kt(t);o=gB(n.serverSyncTree_,s,c,i)}else if(r){const c=lm(t,h=>Kt(h));o=dB(n.serverSyncTree_,s,c)}else{const c=Kt(t);o=F0(n.serverSyncTree_,s,c)}let l=s;o.length>0&&(l=uc(n,s)),Fi(n.eventQueue_,l,o)}function a5(n,e){uS(n,"connected",e),e===!1&&WB(n)}function zB(n,e){xn(e,(t,r)=>{uS(n,t,r)})}function uS(n,e,t){const r=new dt("/.info/"+e),i=Kt(t);n.infoData_.updateSnapshot(r,i);const s=F0(n.infoSyncTree_,r,i);Fi(n.eventQueue_,r,s)}function cS(n){return n.nextWriteId_++}function jB(n,e,t,r,i){G0(n,"set",{path:e.toString(),value:t,priority:r});const s=j0(n),o=Kt(t,r),l=JE(n.serverSyncTree_,e),c=U9(o,l,s),h=cS(n),p=M9(n.serverSyncTree_,e,c,h,!0);z0(n.eventQueue_,p),n.server_.put(e.toString(),o.val(!0),(_,S)=>{const E=_==="ok";E||wr("set at "+e+" failed: "+_);const x=Vo(n.serverSyncTree_,h,!E);Fi(n.eventQueue_,e,x),aa(n,i,_,S)});const m=dS(n,e);uc(n,m),Fi(n.eventQueue_,m,[])}function GB(n,e,t,r){G0(n,"update",{path:e.toString(),value:t});let i=!0;const s=j0(n),o={};if(xn(t,(l,c)=>{i=!1,o[l]=V9(Mt(e,l),Kt(c),n.serverSyncTree_,s)}),i)kn("update() called with empty data.  Don't do anything."),aa(n,r,"ok",void 0);else{const l=cS(n),c=hB(n.serverSyncTree_,e,o,l);z0(n.eventQueue_,c),n.server_.merge(e.toString(),t,(h,p)=>{const m=h==="ok";m||wr("update at "+e+" failed: "+h);const _=Vo(n.serverSyncTree_,l,!m),S=_.length>0?uc(n,e):e;Fi(n.eventQueue_,S,_),aa(n,r,h,p)}),xn(t,h=>{const p=dS(n,Mt(e,h));uc(n,p)}),Fi(n.eventQueue_,e,[])}}function WB(n){G0(n,"onDisconnectEvents");const e=j0(n),t=xm();m2(n.onDisconnect_,at(),(i,s)=>{const o=V9(i,s,n.serverSyncTree_,e);Pc(t,i,o)});let r=[];m2(t,at(),(i,s)=>{r=r.concat(F0(n.serverSyncTree_,i,s));const o=dS(n,i);uc(n,o)}),n.onDisconnect_=xm(),Fi(n.eventQueue_,at(),r)}function HB(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&g2(n.onDisconnect_,e),aa(n,t,r,i)})}function l5(n,e,t,r){const i=Kt(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&Pc(n.onDisconnect_,e,i),aa(n,r,s,o)})}function $B(n,e,t,r,i){const s=Kt(t,r);n.server_.onDisconnectPut(e.toString(),s.val(!0),(o,l)=>{o==="ok"&&Pc(n.onDisconnect_,e,s),aa(n,i,o,l)})}function qB(n,e,t,r){if(am(t)){kn("onDisconnect().update() called with empty data.  Don't do anything."),aa(n,r,"ok",void 0);return}n.server_.onDisconnectMerge(e.toString(),t,(i,s)=>{i==="ok"&&xn(t,(o,l)=>{const c=Kt(l);Pc(n.onDisconnect_,Mt(e,o),c)}),aa(n,r,i,s)})}function KB(n,e,t){let r;Le(e._path)===".info"?r=i5(n.infoSyncTree_,e,t):r=i5(n.serverSyncTree_,e,t),$9(n.eventQueue_,e._path,r)}function u5(n,e,t){let r;Le(e._path)===".info"?r=C2(n.infoSyncTree_,e,t):r=C2(n.serverSyncTree_,e,t),$9(n.eventQueue_,e._path,r)}function QB(n){n.persistentConnection_&&n.persistentConnection_.interrupt(LB)}function G0(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),kn(t,...e)}function aa(n,e,t,r){e&&kc(()=>{if(t==="ok")e(null);else{const i=(t||"error").toUpperCase();let s=i;r&&(s+=": "+r);const o=new Error(s);o.code=i,e(o)}})}function K9(n,e,t){return JE(n.serverSyncTree_,e,t)||Pe.EMPTY_NODE}function hS(n,e=n.transactionQueueTree_){if(e||W0(n,e),xc(e)){const t=Y9(n,e);ce(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&YB(n,If(e),t)}else z9(e)&&U0(e,t=>{hS(n,t)})}function YB(n,e,t){const r=t.map(h=>h.currentWriteId),i=K9(n,e,r);let s=i;const o=i.hash();for(let h=0;h<t.length;h++){const p=t[h];ce(p.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),p.status=1,p.retryCount++;const m=Mr(e,p.path);s=s.updateChild(m,p.currentOutputSnapshotRaw)}const l=s.val(!0),c=e;n.server_.put(c.toString(),l,h=>{G0(n,"transaction put response",{path:c.toString(),status:h});let p=[];if(h==="ok"){const m=[];for(let _=0;_<t.length;_++)t[_].status=2,p=p.concat(Vo(n.serverSyncTree_,t[_].currentWriteId)),t[_].onComplete&&m.push(()=>t[_].onComplete(null,!0,t[_].currentOutputSnapshotResolved)),t[_].unwatcher();W0(n,oS(n.transactionQueueTree_,e)),hS(n,n.transactionQueueTree_),Fi(n.eventQueue_,e,p);for(let _=0;_<m.length;_++)kc(m[_])}else{if(h==="datastale")for(let m=0;m<t.length;m++)t[m].status===3?t[m].status=4:t[m].status=0;else{wr("transaction at "+c.toString()+" failed: "+h);for(let m=0;m<t.length;m++)t[m].status=4,t[m].abortReason=h}uc(n,e)}},o)}function uc(n,e){const t=Q9(n,e),r=If(t),i=Y9(n,t);return XB(n,i,r),r}function XB(n,e,t){if(e.length===0)return;const r=[];let i=[];const o=e.filter(l=>l.status===0).map(l=>l.currentWriteId);for(let l=0;l<e.length;l++){const c=e[l],h=Mr(t,c.path);let p=!1,m;if(ce(h!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)p=!0,m=c.abortReason,i=i.concat(Vo(n.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=FB)p=!0,m="maxretry",i=i.concat(Vo(n.serverSyncTree_,c.currentWriteId,!0));else{const _=K9(n,c.path,o);c.currentInputSnapshot=_;const S=e[l].update(_.val());if(S!==void 0){B0("transaction failed: Data returned ",S,c.path);let E=Kt(S);typeof S=="object"&&S!=null&&hs(S,".priority")||(E=E.updatePriority(_.getPriority()));const M=c.currentWriteId,R=j0(n),P=U9(E,_,R);c.currentOutputSnapshotRaw=E,c.currentOutputSnapshotResolved=P,c.currentWriteId=cS(n),o.splice(o.indexOf(M),1),i=i.concat(M9(n.serverSyncTree_,c.path,P,c.currentWriteId,c.applyLocally)),i=i.concat(Vo(n.serverSyncTree_,M,!0))}else p=!0,m="nodata",i=i.concat(Vo(n.serverSyncTree_,c.currentWriteId,!0))}Fi(n.eventQueue_,t,i),i=[],p&&(e[l].status=2,function(_){setTimeout(_,Math.floor(0))}(e[l].unwatcher),e[l].onComplete&&(m==="nodata"?r.push(()=>e[l].onComplete(null,!1,e[l].currentInputSnapshot)):r.push(()=>e[l].onComplete(new Error(m),!1,null))))}W0(n,n.transactionQueueTree_);for(let l=0;l<r.length;l++)kc(r[l]);hS(n,n.transactionQueueTree_)}function Q9(n,e){let t,r=n.transactionQueueTree_;for(t=Le(e);t!==null&&xc(r)===void 0;)r=oS(r,t),e=vt(e),t=Le(e);return r}function Y9(n,e){const t=[];return X9(n,e,t),t.sort((r,i)=>r.order-i.order),t}function X9(n,e,t){const r=xc(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);U0(e,i=>{X9(n,i,t)})}function W0(n,e){const t=xc(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,B9(e,t.length>0?t:void 0)}U0(e,r=>{W0(n,r)})}function dS(n,e){const t=If(Q9(n,e)),r=oS(n.transactionQueueTree_,e);return IB(r,i=>{Nv(n,i)}),Nv(n,r),j9(r,i=>{Nv(n,i)}),t}function Nv(n,e){const t=xc(e);if(t){const r=[];let i=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(ce(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(ce(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(Vo(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?B9(e,void 0):t.length=s+1,Fi(n.eventQueue_,If(e),i);for(let o=0;o<r.length;o++)kc(r[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JB(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function ZB(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):wr(`Invalid query segment '${t}' in query '${n}'`)}return e}const c5=function(n,e){const t=ez(n),r=t.namespace;t.domain==="firebase.com"&&eo(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&eo("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||aV();const i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new s9(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new dt(t.pathString)}},ez=function(n){let e="",t="",r="",i="",s="",o=!0,l="https",c=443;if(typeof n=="string"){let h=n.indexOf("//");h>=0&&(l=n.substring(0,h-1),n=n.substring(h+2));let p=n.indexOf("/");p===-1&&(p=n.length);let m=n.indexOf("?");m===-1&&(m=n.length),e=n.substring(0,Math.min(p,m)),p<m&&(i=JB(n.substring(p,m)));const _=ZB(n.substring(Math.min(n.length,m)));h=e.indexOf(":"),h>=0?(o=l==="https"||l==="wss",c=parseInt(e.substring(h+1),10)):h=e.length;const S=e.slice(0,h);if(S.toLowerCase()==="localhost")t="localhost";else if(S.split(".").length<=2)t=S;else{const E=e.indexOf(".");r=e.substring(0,E).toLowerCase(),t=e.substring(E+1),s=r}"ns"in _&&(s=_.ns)}return{host:e,port:c,domain:t,subdomain:r,secure:o,scheme:l,pathString:i,namespace:s}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tz{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Pn(this.snapshot.exportVal())}}class nz{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rz{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return ce(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J9{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new rs;return HB(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){nl("OnDisconnect.remove",this._path);const e=new rs;return l5(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){nl("OnDisconnect.set",this._path),I2("OnDisconnect.set",e,this._path);const t=new rs;return l5(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){nl("OnDisconnect.setWithPriority",this._path),I2("OnDisconnect.setWithPriority",e,this._path),NB("OnDisconnect.setWithPriority",t);const r=new rs;return $B(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){nl("OnDisconnect.update",this._path),H9("OnDisconnect.update",e,this._path);const t=new rs;return qB(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H0{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return Ue(this._path)?null:UE(this._path)}get ref(){return new ro(this._repo,this._path)}get _queryIdentifier(){const e=q3(this._queryParams),t=OE(e);return t==="{}"?"default":t}get _queryObject(){return q3(this._queryParams)}isEqual(e){if(e=Et(e),!(e instanceof H0))return!1;const t=this._repo===e._repo,r=BE(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+WV(this._path)}}class ro extends H0{constructor(e,t){super(e,t,new M0,!1)}get parent(){const e=p9(this._path);return e===null?null:new ro(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class Yd{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new dt(e),r=Fm(this.ref,e);return new Yd(this._node.getChild(t),r,Ot)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new Yd(i,Fm(this.ref,r),Ot)))}hasChild(e){const t=new dt(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function io(n,e){return n=Et(n),n._checkNotDeleted("ref"),e!==void 0?Fm(n._root,e):n._root}function Fm(n,e){return n=Et(n),Le(n._path)===null?bB("child","path",e):lS("child","path",e),new ro(n._repo,Mt(n._path,e))}function Z9(n){return n=Et(n),new J9(n._repo,n._path)}function iz(n){return nl("remove",n._path),$0(n,null)}function $0(n,e){n=Et(n),nl("set",n._path),I2("set",e,n._path);const t=new rs;return jB(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function ex(n,e){H9("update",e,n._path);const t=new rs;return GB(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}class fS{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const r=t._queryParams.getIndex();return new tz("value",this,new Yd(e.snapshotNode,new ro(t._repo,t._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new nz(this,e,t):null}matches(e){return e instanceof fS?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function sz(n,e,t,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){const c=t,h=(p,m)=>{u5(n._repo,n,l),c(p,m)};h.userCallback=t.userCallback,h.context=t.context,t=h}const o=new rz(t,s||void 0),l=new fS(o);return KB(n._repo,n,l),()=>u5(n._repo,n,l)}function kf(n,e,t,r){return sz(n,"value",e,t,r)}nB(ro);lB(ro);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oz="FIREBASE_DATABASE_EMULATOR_HOST",k2={};let az=!1;function lz(n,e,t,r){n.repoInfo_=new s9(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}function tx(n,e,t,r,i){let s=r||n.options.databaseURL;s===void 0&&(n.options.projectId||eo("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),kn("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=c5(s,i),l=o.repoInfo,c;typeof process<"u"&&x3&&(c=x3[oz]),c?(s=`http://${c}?ns=${l.namespace}`,o=c5(s,i),l=o.repoInfo):o.repoInfo.secure;const h=new yV(n.name,n.options,e);DB("Invalid Firebase Database URL",o),Ue(o.path)||eo("Database URL must point to the root of a Firebase Database (not including a child path).");const p=cz(l,n,h,new _V(n.name,t));return new nx(p,n)}function uz(n,e){const t=k2[e];(!t||t[n.key]!==n)&&eo(`Database ${e}(${n.repoInfo_}) has already been deleted.`),QB(n),delete t[n.key]}function cz(n,e,t,r){let i=k2[e.name];i||(i={},k2[e.name]=i);let s=i[n.toURLString()];return s&&eo("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new VB(n,az,t,r),i[n.toURLString()]=s,s}class nx{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(UB(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ro(this._repo,at())),this._rootInternal}_delete(){return this._rootInternal!==null&&(uz(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&eo("Cannot call "+e+" on a deleted database.")}}function pS(n=Uw(),e){const t=c0(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const r=Ck("database");r&&gS(t,...r)}return t}function gS(n,e,t,r={}){n=Et(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&eo("Cannot call useEmulator() after instance has already been initialized.");const i=n._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&eo('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Ng(Ng.OWNER);else if(r.mockUserToken){const o=typeof r.mockUserToken=="string"?r.mockUserToken:kk(r.mockUserToken,n.app.options.projectId);s=new Ng(o)}lz(i,e,t,s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hz(n){HR(Tl),hl(new ea("database",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return tx(r,i,s,t)},"PUBLIC").setMultipleInstances(!0)),as(A3,N3,n),as(A3,N3,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dz={".sv":"timestamp"};function mS(){return dz}Ws.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};Ws.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};hz();const fz=Object.freeze(Object.defineProperty({__proto__:null,DataSnapshot:Yd,Database:nx,OnDisconnect:J9,_QueryImpl:H0,_QueryParams:M0,_ReferenceImpl:ro,_repoManagerDatabaseFromApp:tx,_setSDKVersion:HR,_validatePathString:lS,_validateWritablePath:nl,child:Fm,connectDatabaseEmulator:gS,getDatabase:pS,onDisconnect:Z9,onValue:kf,ref:io,remove:iz,serverTimestamp:mS,set:$0,update:ex},Symbol.toStringTag,{value:"Module"}));console.log(" [BUILD DEBUG] Starting Firebase module import...");console.log(" [BUILD DEBUG] Firebase imports completed, reading config...");const bg={apiKey:"AIzaSyDQZvIf-wol_S9nLsAHlFNfyBSxViW8xWc",authDomain:"collabcanvas-d5bce.firebaseapp.com",projectId:"collabcanvas-d5bce",storageBucket:"collabcanvas-d5bce.firebasestorage.app",messagingSenderId:"484501248859",appId:"1:484501248859:web:026a6bbbaa8652239b587e",databaseURL:"https://collabcanvas-d5bce-default-rtdb.firebaseio.com"};console.log(" [BUILD DEBUG] Firebase config created:",{hasApiKey:!!bg.apiKey,hasProjectId:!!bg.projectId,hasDatabaseURL:!!bg.databaseURL,environment:"production"});console.log(" [BUILD DEBUG] About to initialize Firebase app...");const _S=Nk(bg);console.log(" [BUILD DEBUG] Firebase app initialized successfully");console.log(" [BUILD DEBUG] About to initialize Auth...");const cc=XM(_S);console.log(" [BUILD DEBUG] Auth initialized successfully");console.log(" [BUILD DEBUG] About to initialize Firestore...");const lr=UF(_S);console.log(" [BUILD DEBUG] Firestore initialized successfully");console.log(" [BUILD DEBUG] About to initialize Realtime Database...");const va=pS(_S);console.log(" [BUILD DEBUG] Realtime Database initialized successfully");console.log(" [BUILD DEBUG] Checking emulator configuration...");const pz=!0;console.log(" [BUILD DEBUG] Emulator mode:",pz);{console.log(" Using Firebase Emulators (FREE - no quota usage)"),console.log(" [BUILD DEBUG] About to connect to Auth emulator...");try{Jk(cc,"http://127.0.0.1:9099",{disableWarnings:!0}),console.log(" Auth Emulator connected")}catch(n){console.log("Auth emulator already connected",n)}console.log(" [BUILD DEBUG] About to connect to Firestore emulator...");try{kR(lr,"127.0.0.1",8080),console.log(" Firestore Emulator connected (FREE)")}catch(n){console.log("Firestore emulator already connected",n)}console.log(" [BUILD DEBUG] About to connect to Database emulator...");try{gS(va,"127.0.0.1",9e3),console.log(" Realtime Database Emulator connected (FREE)")}catch(n){console.log("Realtime Database emulator already connected",n)}}console.log(" [BUILD DEBUG] Firebase module initialization complete!");const P2=n=>{const e=(n==null?void 0:n.code)||"unknown",t={"auth/user-not-found":"No account found with this email address. Please check your email or create a new account.","auth/wrong-password":"Incorrect password. Please try again or reset your password.","auth/invalid-email":"Please enter a valid email address.","auth/user-disabled":"This account has been disabled. Please contact support.","auth/too-many-requests":"Too many failed attempts. Please try again later.","auth/invalid-credential":"Invalid email or password. Please check your credentials and try again.","auth/email-already-in-use":"An account with this email already exists. Try logging in instead.","auth/weak-password":"Password should be at least 6 characters long.","auth/operation-not-allowed":"Email/password accounts are not enabled. Please contact support.","auth/popup-closed-by-user":"Sign-in was cancelled. Please try again.","auth/popup-blocked":"Pop-up was blocked by your browser. Please allow pop-ups and try again.","auth/cancelled-popup-request":"Sign-in was cancelled. Please try again.","auth/account-exists-with-different-credential":"An account already exists with this email using a different sign-in method.","auth/network-request-failed":"Network error. Please check your internet connection and try again.","auth/timeout":"Request timed out. Please check your connection and try again.","auth/internal-error":"Something went wrong. Please try again.",unknown:"An unexpected error occurred. Please try again."};return t[e]||t.unknown},R2=n=>["auth/network-request-failed","auth/timeout","auth/too-many-requests","auth/internal-error","auth/popup-blocked"].includes(n==null?void 0:n.code),x2=n=>{const e=n==null?void 0:n.code;return{"auth/user-not-found":"Create Account","auth/email-already-in-use":"Sign In Instead","auth/popup-blocked":"Enable Pop-ups","auth/weak-password":"Use Stronger Password"}[e]||void 0},gz=({onSuccess:n,onSwitchToRegister:e})=>{const[t,r]=ee.useState(""),[i,s]=ee.useState(""),[o,l]=ee.useState(!1),[c,h]=ee.useState(null),p=async _=>{_.preventDefault(),l(!0),h(null);try{await LD(cc,t,i),n==null||n()}catch(S){h({message:P2(S),action:x2(S),retryable:R2(S)})}finally{l(!1)}},m=async()=>{l(!0),h(null);try{const _=new Ms;await oM(cc,_),n==null||n()}catch(_){h({message:P2(_),action:x2(_),retryable:R2(_)})}finally{l(!1)}};return z.jsxs("div",{className:"max-w-md mx-auto bg-white rounded-lg shadow-md p-6",children:[z.jsx("h2",{className:"text-2xl font-bold mb-6 text-center text-gray-800",children:"Sign In"}),c&&z.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:z.jsxs("div",{className:"flex items-start gap-3",children:[z.jsx("div",{className:"text-red-500 text-lg",children:""}),z.jsxs("div",{className:"flex-1",children:[z.jsx("div",{className:"text-red-800 font-medium text-sm mb-1",children:"Sign In Error"}),z.jsx("div",{className:"text-red-700 text-sm",children:c.message}),c.action&&z.jsx("button",{onClick:()=>{c.action==="Create Account"&&(e==null||e()),h(null)},className:"mt-2 text-sm text-red-600 hover:text-red-800 underline",children:c.action}),c.retryable&&z.jsx("button",{onClick:()=>h(null),className:"mt-2 ml-2 text-sm text-red-600 hover:text-red-800 underline",children:"Try Again"})]})]})}),z.jsxs("form",{onSubmit:p,className:"space-y-4",children:[z.jsxs("div",{children:[z.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),z.jsx("input",{id:"email",type:"email",value:t,onChange:_=>r(_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:o})]}),z.jsxs("div",{children:[z.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),z.jsx("input",{id:"password",type:"password",value:i,onChange:_=>s(_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:o})]}),z.jsx("button",{type:"submit",disabled:o,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 disabled:opacity-50",children:o?"Signing In...":"Sign In"})]}),z.jsx("div",{className:"my-4 text-center text-gray-500",children:"or"}),z.jsx("button",{onClick:m,disabled:o,className:"w-full bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700 disabled:opacity-50",children:"Sign in with Google"}),z.jsx("div",{className:"mt-4 text-center",children:z.jsx("button",{onClick:e,className:"text-blue-600 hover:underline text-sm",children:"Need an account? Sign up"})})]})},mz=({onSuccess:n,onSwitchToLogin:e})=>{const[t,r]=ee.useState(""),[i,s]=ee.useState(""),[o,l]=ee.useState(""),[c,h]=ee.useState(!1),[p,m]=ee.useState(null),_=async S=>{if(S.preventDefault(),h(!0),m(null),i!==o){m({message:"Passwords do not match"}),h(!1);return}if(i.length<6){m({message:"Password must be at least 6 characters"}),h(!1);return}try{await OD(cc,t,i),n==null||n()}catch(E){m({message:P2(E),action:x2(E),retryable:R2(E)})}finally{h(!1)}};return z.jsxs("div",{className:"max-w-md mx-auto bg-white rounded-lg shadow-md p-6",children:[z.jsx("h2",{className:"text-2xl font-bold mb-6 text-center text-gray-800",children:"Create Account"}),p&&z.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:z.jsxs("div",{className:"flex items-start gap-3",children:[z.jsx("div",{className:"text-red-500 text-lg",children:""}),z.jsxs("div",{className:"flex-1",children:[z.jsx("div",{className:"text-red-800 font-medium text-sm mb-1",children:"Registration Error"}),z.jsx("div",{className:"text-red-700 text-sm",children:p.message}),p.action&&z.jsx("button",{onClick:()=>{p.action==="Sign In Instead"&&(e==null||e()),m(null)},className:"mt-2 text-sm text-red-600 hover:text-red-800 underline",children:p.action}),p.retryable&&z.jsx("button",{onClick:()=>m(null),className:"mt-2 ml-2 text-sm text-red-600 hover:text-red-800 underline",children:"Try Again"})]})]})}),z.jsxs("form",{onSubmit:_,className:"space-y-4",children:[z.jsxs("div",{children:[z.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),z.jsx("input",{id:"email",type:"email",value:t,onChange:S=>r(S.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:c})]}),z.jsxs("div",{children:[z.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),z.jsx("input",{id:"password",type:"password",value:i,onChange:S=>s(S.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:c,minLength:6})]}),z.jsxs("div",{children:[z.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password"}),z.jsx("input",{id:"confirmPassword",type:"password",value:o,onChange:S=>l(S.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:c})]}),z.jsx("button",{type:"submit",disabled:c,className:"w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 disabled:opacity-50",children:c?"Creating Account...":"Create Account"})]}),z.jsx("div",{className:"mt-4 text-center",children:z.jsx("button",{onClick:e,className:"text-blue-600 hover:underline text-sm",children:"Already have an account? Sign in"})})]})},_z=({onAuthSuccess:n})=>{const[e,t]=ee.useState(!0),r=()=>{n==null||n()},i=()=>t(!0),s=()=>t(!1);return z.jsx("div",{className:"w-full max-w-md mx-auto",children:e?z.jsx(gz,{onSuccess:r,onSwitchToRegister:s}):z.jsx(mz,{onSuccess:r,onSwitchToLogin:i})})};var rx={exports:{}},q0={},Vm={},Oe={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n._registerNode=n.Konva=n.glob=void 0;const e=Math.PI/180;function t(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}n.glob=typeof r4<"u"?r4:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},n.Konva={_global:n.glob,version:"9.3.22",isBrowser:t(),isUnminified:/param/.test((function(i){}).toString()),dblClickWindow:400,getAngle(i){return n.Konva.angleDeg?i*e:i},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return n.Konva.DD.isDragging},isTransforming(){var i;return(i=n.Konva.Transformer)===null||i===void 0?void 0:i.isTransforming()},isDragReady(){return!!n.Konva.DD.node},releaseCanvasOnDestroy:!0,document:n.glob.document,_injectGlobal(i){n.glob.Konva=i}};const r=i=>{n.Konva[i.prototype.getClassName()]=i};n._registerNode=r,n.Konva._injectGlobal(n.Konva)})(Oe);var Vt={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Util=n.Transform=void 0;const e=Oe;class t{constructor(k=[1,0,0,1,0,0]){this.dirty=!1,this.m=k&&k.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new t(this.m)}copyInto(k){k.m[0]=this.m[0],k.m[1]=this.m[1],k.m[2]=this.m[2],k.m[3]=this.m[3],k.m[4]=this.m[4],k.m[5]=this.m[5]}point(k){const D=this.m;return{x:D[0]*k.x+D[2]*k.y+D[4],y:D[1]*k.x+D[3]*k.y+D[5]}}translate(k,D){return this.m[4]+=this.m[0]*k+this.m[2]*D,this.m[5]+=this.m[1]*k+this.m[3]*D,this}scale(k,D){return this.m[0]*=k,this.m[1]*=k,this.m[2]*=D,this.m[3]*=D,this}rotate(k){const D=Math.cos(k),O=Math.sin(k),N=this.m[0]*D+this.m[2]*O,C=this.m[1]*D+this.m[3]*O,b=this.m[0]*-O+this.m[2]*D,A=this.m[1]*-O+this.m[3]*D;return this.m[0]=N,this.m[1]=C,this.m[2]=b,this.m[3]=A,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(k,D){const O=this.m[0]+this.m[2]*D,N=this.m[1]+this.m[3]*D,C=this.m[2]+this.m[0]*k,b=this.m[3]+this.m[1]*k;return this.m[0]=O,this.m[1]=N,this.m[2]=C,this.m[3]=b,this}multiply(k){const D=this.m[0]*k.m[0]+this.m[2]*k.m[1],O=this.m[1]*k.m[0]+this.m[3]*k.m[1],N=this.m[0]*k.m[2]+this.m[2]*k.m[3],C=this.m[1]*k.m[2]+this.m[3]*k.m[3],b=this.m[0]*k.m[4]+this.m[2]*k.m[5]+this.m[4],A=this.m[1]*k.m[4]+this.m[3]*k.m[5]+this.m[5];return this.m[0]=D,this.m[1]=O,this.m[2]=N,this.m[3]=C,this.m[4]=b,this.m[5]=A,this}invert(){const k=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),D=this.m[3]*k,O=-this.m[1]*k,N=-this.m[2]*k,C=this.m[0]*k,b=k*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),A=k*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=D,this.m[1]=O,this.m[2]=N,this.m[3]=C,this.m[4]=b,this.m[5]=A,this}getMatrix(){return this.m}decompose(){const k=this.m[0],D=this.m[1],O=this.m[2],N=this.m[3],C=this.m[4],b=this.m[5],A=k*N-D*O,L={x:C,y:b,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(k!=0||D!=0){const B=Math.sqrt(k*k+D*D);L.rotation=D>0?Math.acos(k/B):-Math.acos(k/B),L.scaleX=B,L.scaleY=A/B,L.skewX=(k*O+D*N)/A,L.skewY=0}else if(O!=0||N!=0){const B=Math.sqrt(O*O+N*N);L.rotation=Math.PI/2-(N>0?Math.acos(-O/B):-Math.acos(O/B)),L.scaleX=A/B,L.scaleY=B,L.skewX=0,L.skewY=(k*O+D*N)/A}return L.rotation=n.Util._getRotation(L.rotation),L}}n.Transform=t;const r="[object Array]",i="[object Number]",s="[object String]",o="[object Boolean]",l=Math.PI/180,c=180/Math.PI,h="#",p="",m="0",_="Konva warning: ",S="Konva error: ",E="rgb(",x={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},M=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let R=[];const P=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(v){setTimeout(v,60)};n.Util={_isElement(v){return!!(v&&v.nodeType==1)},_isFunction(v){return!!(v&&v.constructor&&v.call&&v.apply)},_isPlainObject(v){return!!v&&v.constructor===Object},_isArray(v){return Object.prototype.toString.call(v)===r},_isNumber(v){return Object.prototype.toString.call(v)===i&&!isNaN(v)&&isFinite(v)},_isString(v){return Object.prototype.toString.call(v)===s},_isBoolean(v){return Object.prototype.toString.call(v)===o},isObject(v){return v instanceof Object},isValidSelector(v){if(typeof v!="string")return!1;const k=v[0];return k==="#"||k==="."||k===k.toUpperCase()},_sign(v){return v===0||v>0?1:-1},requestAnimFrame(v){R.push(v),R.length===1&&P(function(){const k=R;R=[],k.forEach(function(D){D()})})},createCanvasElement(){const v=document.createElement("canvas");try{v.style=v.style||{}}catch{}return v},createImageElement(){return document.createElement("img")},_isInDocument(v){for(;v=v.parentNode;)if(v==document)return!0;return!1},_urlToImage(v,k){const D=n.Util.createImageElement();D.onload=function(){k(D)},D.src=v},_rgbToHex(v,k,D){return((1<<24)+(v<<16)+(k<<8)+D).toString(16).slice(1)},_hexToRgb(v){v=v.replace(h,p);const k=parseInt(v,16);return{r:k>>16&255,g:k>>8&255,b:k&255}},getRandomColor(){let v=(Math.random()*16777215<<0).toString(16);for(;v.length<6;)v=m+v;return h+v},getRGB(v){let k;return v in x?(k=x[v],{r:k[0],g:k[1],b:k[2]}):v[0]===h?this._hexToRgb(v.substring(1)):v.substr(0,4)===E?(k=M.exec(v.replace(/ /g,"")),{r:parseInt(k[1],10),g:parseInt(k[2],10),b:parseInt(k[3],10)}):{r:0,g:0,b:0}},colorToRGBA(v){return v=v||"black",n.Util._namedColorToRBA(v)||n.Util._hex3ColorToRGBA(v)||n.Util._hex4ColorToRGBA(v)||n.Util._hex6ColorToRGBA(v)||n.Util._hex8ColorToRGBA(v)||n.Util._rgbColorToRGBA(v)||n.Util._rgbaColorToRGBA(v)||n.Util._hslColorToRGBA(v)},_namedColorToRBA(v){const k=x[v.toLowerCase()];return k?{r:k[0],g:k[1],b:k[2],a:1}:null},_rgbColorToRGBA(v){if(v.indexOf("rgb(")===0){v=v.match(/rgb\(([^)]+)\)/)[1];const k=v.split(/ *, */).map(Number);return{r:k[0],g:k[1],b:k[2],a:1}}},_rgbaColorToRGBA(v){if(v.indexOf("rgba(")===0){v=v.match(/rgba\(([^)]+)\)/)[1];const k=v.split(/ *, */).map((D,O)=>D.slice(-1)==="%"?O===3?parseInt(D)/100:parseInt(D)/100*255:Number(D));return{r:k[0],g:k[1],b:k[2],a:k[3]}}},_hex8ColorToRGBA(v){if(v[0]==="#"&&v.length===9)return{r:parseInt(v.slice(1,3),16),g:parseInt(v.slice(3,5),16),b:parseInt(v.slice(5,7),16),a:parseInt(v.slice(7,9),16)/255}},_hex6ColorToRGBA(v){if(v[0]==="#"&&v.length===7)return{r:parseInt(v.slice(1,3),16),g:parseInt(v.slice(3,5),16),b:parseInt(v.slice(5,7),16),a:1}},_hex4ColorToRGBA(v){if(v[0]==="#"&&v.length===5)return{r:parseInt(v[1]+v[1],16),g:parseInt(v[2]+v[2],16),b:parseInt(v[3]+v[3],16),a:parseInt(v[4]+v[4],16)/255}},_hex3ColorToRGBA(v){if(v[0]==="#"&&v.length===4)return{r:parseInt(v[1]+v[1],16),g:parseInt(v[2]+v[2],16),b:parseInt(v[3]+v[3],16),a:1}},_hslColorToRGBA(v){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(v)){const[k,...D]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(v),O=Number(D[0])/360,N=Number(D[1])/100,C=Number(D[2])/100;let b,A,L;if(N===0)return L=C*255,{r:Math.round(L),g:Math.round(L),b:Math.round(L),a:1};C<.5?b=C*(1+N):b=C+N-C*N;const B=2*C-b,V=[0,0,0];for(let he=0;he<3;he++)A=O+1/3*-(he-1),A<0&&A++,A>1&&A--,6*A<1?L=B+(b-B)*6*A:2*A<1?L=b:3*A<2?L=B+(b-B)*(2/3-A)*6:L=B,V[he]=L*255;return{r:Math.round(V[0]),g:Math.round(V[1]),b:Math.round(V[2]),a:1}}},haveIntersection(v,k){return!(k.x>v.x+v.width||k.x+k.width<v.x||k.y>v.y+v.height||k.y+k.height<v.y)},cloneObject(v){const k={};for(const D in v)this._isPlainObject(v[D])?k[D]=this.cloneObject(v[D]):this._isArray(v[D])?k[D]=this.cloneArray(v[D]):k[D]=v[D];return k},cloneArray(v){return v.slice(0)},degToRad(v){return v*l},radToDeg(v){return v*c},_degToRad(v){return n.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),n.Util.degToRad(v)},_radToDeg(v){return n.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),n.Util.radToDeg(v)},_getRotation(v){return e.Konva.angleDeg?n.Util.radToDeg(v):v},_capitalize(v){return v.charAt(0).toUpperCase()+v.slice(1)},throw(v){throw new Error(S+v)},error(v){console.error(S+v)},warn(v){e.Konva.showWarnings&&console.warn(_+v)},each(v,k){for(const D in v)k(D,v[D])},_inRange(v,k,D){return k<=v&&v<D},_getProjectionToSegment(v,k,D,O,N,C){let b,A,L;const B=(v-D)*(v-D)+(k-O)*(k-O);if(B==0)b=v,A=k,L=(N-D)*(N-D)+(C-O)*(C-O);else{const V=((N-v)*(D-v)+(C-k)*(O-k))/B;V<0?(b=v,A=k,L=(v-N)*(v-N)+(k-C)*(k-C)):V>1?(b=D,A=O,L=(D-N)*(D-N)+(O-C)*(O-C)):(b=v+V*(D-v),A=k+V*(O-k),L=(b-N)*(b-N)+(A-C)*(A-C))}return[b,A,L]},_getProjectionToLine(v,k,D){const O=n.Util.cloneObject(v);let N=Number.MAX_VALUE;return k.forEach(function(C,b){if(!D&&b===k.length-1)return;const A=k[(b+1)%k.length],L=n.Util._getProjectionToSegment(C.x,C.y,A.x,A.y,v.x,v.y),B=L[0],V=L[1],he=L[2];he<N&&(O.x=B,O.y=V,N=he)}),O},_prepareArrayForTween(v,k,D){const O=[],N=[];if(v.length>k.length){const b=k;k=v,v=b}for(let b=0;b<v.length;b+=2)O.push({x:v[b],y:v[b+1]});for(let b=0;b<k.length;b+=2)N.push({x:k[b],y:k[b+1]});const C=[];return N.forEach(function(b){const A=n.Util._getProjectionToLine(b,O,D);C.push(A.x),C.push(A.y)}),C},_prepareToStringify(v){let k;v.visitedByCircularReferenceRemoval=!0;for(const D in v)if(v.hasOwnProperty(D)&&v[D]&&typeof v[D]=="object"){if(k=Object.getOwnPropertyDescriptor(v,D),v[D].visitedByCircularReferenceRemoval||n.Util._isElement(v[D]))if(k.configurable)delete v[D];else return null;else if(n.Util._prepareToStringify(v[D])===null)if(k.configurable)delete v[D];else return null}return delete v.visitedByCircularReferenceRemoval,v},_assign(v,k){for(const D in k)v[D]=k[D];return v},_getFirstPointerId(v){return v.touches?v.changedTouches[0].identifier:v.pointerId||999},releaseCanvas(...v){e.Konva.releaseCanvasOnDestroy&&v.forEach(k=>{k.width=0,k.height=0})},drawRoundedRectPath(v,k,D,O){let N=0,C=0,b=0,A=0;typeof O=="number"?N=C=b=A=Math.min(O,k/2,D/2):(N=Math.min(O[0]||0,k/2,D/2),C=Math.min(O[1]||0,k/2,D/2),A=Math.min(O[2]||0,k/2,D/2),b=Math.min(O[3]||0,k/2,D/2)),v.moveTo(N,0),v.lineTo(k-C,0),v.arc(k-C,C,C,Math.PI*3/2,0,!1),v.lineTo(k,D-A),v.arc(k-A,D-A,A,0,Math.PI/2,!1),v.lineTo(b,D),v.arc(b,D-b,b,Math.PI/2,Math.PI,!1),v.lineTo(0,N),v.arc(N,N,N,Math.PI,Math.PI*3/2,!1)}}})(Vt);var At={},Mi={},Hs={};Object.defineProperty(Hs,"__esModule",{value:!0});Hs.HitContext=Hs.SceneContext=Hs.Context=void 0;const ix=Vt,yz=Oe;function vz(n){const e=[],t=n.length,r=ix.Util;for(let i=0;i<t;i++){let s=n[i];r._isNumber(s)?s=Math.round(s*1e3)/1e3:r._isString(s)||(s=s+""),e.push(s)}return e}const h5=",",wz="(",Ez=")",Sz="([",Cz="])",Tz=";",Iz="()",kz="=",d5=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],Pz=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],Rz=100;class K0{constructor(e){this.canvas=e,yz.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(e){e.fillEnabled()&&this._fill(e)}_fill(e){}strokeShape(e){e.hasStroke()&&this._stroke(e)}_stroke(e){}fillStrokeShape(e){e.attrs.fillAfterStrokeEnabled?(this.strokeShape(e),this.fillShape(e)):(this.fillShape(e),this.strokeShape(e))}getTrace(e,t){let r=this.traceArr,i=r.length,s="",o,l,c,h;for(o=0;o<i;o++)l=r[o],c=l.method,c?(h=l.args,s+=c,e?s+=Iz:ix.Util._isArray(h[0])?s+=Sz+h.join(h5)+Cz:(t&&(h=h.map(p=>typeof p=="number"?Math.floor(p):p)),s+=wz+h.join(h5)+Ez)):(s+=l.property,e||(s+=kz+l.val)),s+=Tz;return s}clearTrace(){this.traceArr=[]}_trace(e){let t=this.traceArr,r;t.push(e),r=t.length,r>=Rz&&t.shift()}reset(){const e=this.getCanvas().getPixelRatio();this.setTransform(1*e,0,0,1*e,0,0)}getCanvas(){return this.canvas}clear(e){const t=this.getCanvas();e?this.clearRect(e.x||0,e.y||0,e.width||0,e.height||0):this.clearRect(0,0,t.getWidth()/t.pixelRatio,t.getHeight()/t.pixelRatio)}_applyLineCap(e){const t=e.attrs.lineCap;t&&this.setAttr("lineCap",t)}_applyOpacity(e){const t=e.getAbsoluteOpacity();t!==1&&this.setAttr("globalAlpha",t)}_applyLineJoin(e){const t=e.attrs.lineJoin;t&&this.setAttr("lineJoin",t)}setAttr(e,t){this._context[e]=t}arc(e,t,r,i,s,o){this._context.arc(e,t,r,i,s,o)}arcTo(e,t,r,i,s){this._context.arcTo(e,t,r,i,s)}beginPath(){this._context.beginPath()}bezierCurveTo(e,t,r,i,s,o){this._context.bezierCurveTo(e,t,r,i,s,o)}clearRect(e,t,r,i){this._context.clearRect(e,t,r,i)}clip(...e){this._context.clip.apply(this._context,e)}closePath(){this._context.closePath()}createImageData(e,t){const r=arguments;if(r.length===2)return this._context.createImageData(e,t);if(r.length===1)return this._context.createImageData(e)}createLinearGradient(e,t,r,i){return this._context.createLinearGradient(e,t,r,i)}createPattern(e,t){return this._context.createPattern(e,t)}createRadialGradient(e,t,r,i,s,o){return this._context.createRadialGradient(e,t,r,i,s,o)}drawImage(e,t,r,i,s,o,l,c,h){const p=arguments,m=this._context;p.length===3?m.drawImage(e,t,r):p.length===5?m.drawImage(e,t,r,i,s):p.length===9&&m.drawImage(e,t,r,i,s,o,l,c,h)}ellipse(e,t,r,i,s,o,l,c){this._context.ellipse(e,t,r,i,s,o,l,c)}isPointInPath(e,t,r,i){return r?this._context.isPointInPath(r,e,t,i):this._context.isPointInPath(e,t,i)}fill(...e){this._context.fill.apply(this._context,e)}fillRect(e,t,r,i){this._context.fillRect(e,t,r,i)}strokeRect(e,t,r,i){this._context.strokeRect(e,t,r,i)}fillText(e,t,r,i){i?this._context.fillText(e,t,r,i):this._context.fillText(e,t,r)}measureText(e){return this._context.measureText(e)}getImageData(e,t,r,i){return this._context.getImageData(e,t,r,i)}lineTo(e,t){this._context.lineTo(e,t)}moveTo(e,t){this._context.moveTo(e,t)}rect(e,t,r,i){this._context.rect(e,t,r,i)}roundRect(e,t,r,i,s){this._context.roundRect(e,t,r,i,s)}putImageData(e,t,r){this._context.putImageData(e,t,r)}quadraticCurveTo(e,t,r,i){this._context.quadraticCurveTo(e,t,r,i)}restore(){this._context.restore()}rotate(e){this._context.rotate(e)}save(){this._context.save()}scale(e,t){this._context.scale(e,t)}setLineDash(e){this._context.setLineDash?this._context.setLineDash(e):"mozDash"in this._context?this._context.mozDash=e:"webkitLineDash"in this._context&&(this._context.webkitLineDash=e)}getLineDash(){return this._context.getLineDash()}setTransform(e,t,r,i,s,o){this._context.setTransform(e,t,r,i,s,o)}stroke(e){e?this._context.stroke(e):this._context.stroke()}strokeText(e,t,r,i){this._context.strokeText(e,t,r,i)}transform(e,t,r,i,s,o){this._context.transform(e,t,r,i,s,o)}translate(e,t){this._context.translate(e,t)}_enableTrace(){let e=this,t=d5.length,r=this.setAttr,i,s;const o=function(l){let c=e[l],h;e[l]=function(){return s=vz(Array.prototype.slice.call(arguments,0)),h=c.apply(e,arguments),e._trace({method:l,args:s}),h}};for(i=0;i<t;i++)o(d5[i]);e.setAttr=function(){r.apply(e,arguments);const l=arguments[0];let c=arguments[1];(l==="shadowOffsetX"||l==="shadowOffsetY"||l==="shadowBlur")&&(c=c/this.canvas.getPixelRatio()),e._trace({property:l,val:c})}}_applyGlobalCompositeOperation(e){const t=e.attrs.globalCompositeOperation;!t||t==="source-over"||this.setAttr("globalCompositeOperation",t)}}Hs.Context=K0;Pz.forEach(function(n){Object.defineProperty(K0.prototype,n,{get(){return this._context[n]},set(e){this._context[n]=e}})});class xz extends K0{constructor(e,{willReadFrequently:t=!1}={}){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:t})}_fillColor(e){const t=e.fill();this.setAttr("fillStyle",t),e._fillFunc(this)}_fillPattern(e){this.setAttr("fillStyle",e._getFillPattern()),e._fillFunc(this)}_fillLinearGradient(e){const t=e._getLinearGradient();t&&(this.setAttr("fillStyle",t),e._fillFunc(this))}_fillRadialGradient(e){const t=e._getRadialGradient();t&&(this.setAttr("fillStyle",t),e._fillFunc(this))}_fill(e){const t=e.fill(),r=e.getFillPriority();if(t&&r==="color"){this._fillColor(e);return}const i=e.getFillPatternImage();if(i&&r==="pattern"){this._fillPattern(e);return}const s=e.getFillLinearGradientColorStops();if(s&&r==="linear-gradient"){this._fillLinearGradient(e);return}const o=e.getFillRadialGradientColorStops();if(o&&r==="radial-gradient"){this._fillRadialGradient(e);return}t?this._fillColor(e):i?this._fillPattern(e):s?this._fillLinearGradient(e):o&&this._fillRadialGradient(e)}_strokeLinearGradient(e){const t=e.getStrokeLinearGradientStartPoint(),r=e.getStrokeLinearGradientEndPoint(),i=e.getStrokeLinearGradientColorStops(),s=this.createLinearGradient(t.x,t.y,r.x,r.y);if(i){for(let o=0;o<i.length;o+=2)s.addColorStop(i[o],i[o+1]);this.setAttr("strokeStyle",s)}}_stroke(e){const t=e.dash(),r=e.getStrokeScaleEnabled();if(e.hasStroke()){if(!r){this.save();const s=this.getCanvas().getPixelRatio();this.setTransform(s,0,0,s,0,0)}this._applyLineCap(e),t&&e.dashEnabled()&&(this.setLineDash(t),this.setAttr("lineDashOffset",e.dashOffset())),this.setAttr("lineWidth",e.strokeWidth()),e.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),e.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(e):this.setAttr("strokeStyle",e.stroke()),e._strokeFunc(this),r||this.restore()}}_applyShadow(e){var t,r,i;const s=(t=e.getShadowRGBA())!==null&&t!==void 0?t:"black",o=(r=e.getShadowBlur())!==null&&r!==void 0?r:5,l=(i=e.getShadowOffset())!==null&&i!==void 0?i:{x:0,y:0},c=e.getAbsoluteScale(),h=this.canvas.getPixelRatio(),p=c.x*h,m=c.y*h;this.setAttr("shadowColor",s),this.setAttr("shadowBlur",o*Math.min(Math.abs(p),Math.abs(m))),this.setAttr("shadowOffsetX",l.x*p),this.setAttr("shadowOffsetY",l.y*m)}}Hs.SceneContext=xz;class Az extends K0{constructor(e){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:!0})}_fill(e){this.save(),this.setAttr("fillStyle",e.colorKey),e._fillFuncHit(this),this.restore()}strokeShape(e){e.hasHitStroke()&&this._stroke(e)}_stroke(e){if(e.hasHitStroke()){const t=e.getStrokeScaleEnabled();if(!t){this.save();const s=this.getCanvas().getPixelRatio();this.setTransform(s,0,0,s,0,0)}this._applyLineCap(e);const r=e.hitStrokeWidth(),i=r==="auto"?e.strokeWidth():r;this.setAttr("lineWidth",i),this.setAttr("strokeStyle",e.colorKey),e._strokeFuncHit(this),t||this.restore()}}}Hs.HitContext=Az;Object.defineProperty(Mi,"__esModule",{value:!0});Mi.HitCanvas=Mi.SceneCanvas=Mi.Canvas=void 0;const Um=Vt,sx=Hs,ox=Oe;let ig;function Nz(){if(ig)return ig;const n=Um.Util.createCanvasElement(),e=n.getContext("2d");return ig=function(){const t=ox.Konva._global.devicePixelRatio||1,r=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return t/r}(),Um.Util.releaseCanvas(n),ig}let yS=class{constructor(e){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const r=(e||{}).pixelRatio||ox.Konva.pixelRatio||Nz();this.pixelRatio=r,this._canvas=Um.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(e){const t=this.pixelRatio;this.pixelRatio=e,this.setSize(this.getWidth()/t,this.getHeight()/t)}setWidth(e){this.width=this._canvas.width=e*this.pixelRatio,this._canvas.style.width=e+"px";const t=this.pixelRatio;this.getContext()._context.scale(t,t)}setHeight(e){this.height=this._canvas.height=e*this.pixelRatio,this._canvas.style.height=e+"px";const t=this.pixelRatio;this.getContext()._context.scale(t,t)}getWidth(){return this.width}getHeight(){return this.height}setSize(e,t){this.setWidth(e||0),this.setHeight(t||0)}toDataURL(e,t){try{return this._canvas.toDataURL(e,t)}catch{try{return this._canvas.toDataURL()}catch(i){return Um.Util.error("Unable to get data URL. "+i.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};Mi.Canvas=yS;class bz extends yS{constructor(e={width:0,height:0,willReadFrequently:!1}){super(e),this.context=new sx.SceneContext(this,{willReadFrequently:e.willReadFrequently}),this.setSize(e.width,e.height)}}Mi.SceneCanvas=bz;class Dz extends yS{constructor(e={width:0,height:0}){super(e),this.hitCanvas=!0,this.context=new sx.HitContext(this),this.setSize(e.width,e.height)}}Mi.HitCanvas=Dz;var Q0={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.DD=void 0;const e=Oe,t=Vt;n.DD={get isDragging(){let r=!1;return n.DD._dragElements.forEach(i=>{i.dragStatus==="dragging"&&(r=!0)}),r},justDragged:!1,get node(){let r;return n.DD._dragElements.forEach(i=>{r=i.node}),r},_dragElements:new Map,_drag(r){const i=[];n.DD._dragElements.forEach((s,o)=>{const{node:l}=s,c=l.getStage();c.setPointersPositions(r),s.pointerId===void 0&&(s.pointerId=t.Util._getFirstPointerId(r));const h=c._changedPointerPositions.find(p=>p.id===s.pointerId);if(h){if(s.dragStatus!=="dragging"){const p=l.dragDistance();if(Math.max(Math.abs(h.x-s.startPointerPos.x),Math.abs(h.y-s.startPointerPos.y))<p||(l.startDrag({evt:r}),!l.isDragging()))return}l._setDragPosition(r,s),i.push(l)}}),i.forEach(s=>{s.fire("dragmove",{type:"dragmove",target:s,evt:r},!0)})},_endDragBefore(r){const i=[];n.DD._dragElements.forEach(s=>{const{node:o}=s,l=o.getStage();if(r&&l.setPointersPositions(r),!l._changedPointerPositions.find(p=>p.id===s.pointerId))return;(s.dragStatus==="dragging"||s.dragStatus==="stopped")&&(n.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,s.dragStatus="stopped");const h=s.node.getLayer()||s.node instanceof e.Konva.Stage&&s.node;h&&i.indexOf(h)===-1&&i.push(h)}),i.forEach(s=>{s.draw()})},_endDragAfter(r){n.DD._dragElements.forEach((i,s)=>{i.dragStatus==="stopped"&&i.node.fire("dragend",{type:"dragend",target:i.node,evt:r},!0),i.dragStatus!=="dragging"&&n.DD._dragElements.delete(s)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",n.DD._endDragBefore,!0),window.addEventListener("touchend",n.DD._endDragBefore,!0),window.addEventListener("touchcancel",n.DD._endDragBefore,!0),window.addEventListener("mousemove",n.DD._drag),window.addEventListener("touchmove",n.DD._drag),window.addEventListener("mouseup",n.DD._endDragAfter,!1),window.addEventListener("touchend",n.DD._endDragAfter,!1),window.addEventListener("touchcancel",n.DD._endDragAfter,!1))})(Q0);var ze={},Re={};Object.defineProperty(Re,"__esModule",{value:!0});Re.RGBComponent=Mz;Re.alphaComponent=Oz;Re.getNumberValidator=Lz;Re.getNumberOrArrayOfNumbersValidator=Fz;Re.getNumberOrAutoValidator=Vz;Re.getStringValidator=Uz;Re.getStringOrGradientValidator=Bz;Re.getFunctionValidator=zz;Re.getNumberArrayValidator=jz;Re.getBooleanValidator=Gz;Re.getComponentValidator=Wz;const so=Oe,jt=Vt;function oo(n){return jt.Util._isString(n)?'"'+n+'"':Object.prototype.toString.call(n)==="[object Number]"||jt.Util._isBoolean(n)?n:Object.prototype.toString.call(n)}function Mz(n){return n>255?255:n<0?0:Math.round(n)}function Oz(n){return n>1?1:n<1e-4?1e-4:n}function Lz(){if(so.Konva.isUnminified)return function(n,e){return jt.Util._isNumber(n)||jt.Util.warn(oo(n)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),n}}function Fz(n){if(so.Konva.isUnminified)return function(e,t){let r=jt.Util._isNumber(e),i=jt.Util._isArray(e)&&e.length==n;return!r&&!i&&jt.Util.warn(oo(e)+' is a not valid value for "'+t+'" attribute. The value should be a number or Array<number>('+n+")"),e}}function Vz(){if(so.Konva.isUnminified)return function(n,e){return jt.Util._isNumber(n)||n==="auto"||jt.Util.warn(oo(n)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),n}}function Uz(){if(so.Konva.isUnminified)return function(n,e){return jt.Util._isString(n)||jt.Util.warn(oo(n)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),n}}function Bz(){if(so.Konva.isUnminified)return function(n,e){const t=jt.Util._isString(n),r=Object.prototype.toString.call(n)==="[object CanvasGradient]"||n&&n.addColorStop;return t||r||jt.Util.warn(oo(n)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),n}}function zz(){if(so.Konva.isUnminified)return function(n,e){return jt.Util._isFunction(n)||jt.Util.warn(oo(n)+' is a not valid value for "'+e+'" attribute. The value should be a function.'),n}}function jz(){if(so.Konva.isUnminified)return function(n,e){const t=Int8Array?Object.getPrototypeOf(Int8Array):null;return t&&n instanceof t||(jt.Util._isArray(n)?n.forEach(function(r){jt.Util._isNumber(r)||jt.Util.warn('"'+e+'" attribute has non numeric element '+r+". Make sure that all elements are numbers.")}):jt.Util.warn(oo(n)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.')),n}}function Gz(){if(so.Konva.isUnminified)return function(n,e){return n===!0||n===!1||jt.Util.warn(oo(n)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),n}}function Wz(n){if(so.Konva.isUnminified)return function(e,t){return e==null||jt.Util.isObject(e)||jt.Util.warn(oo(e)+' is a not valid value for "'+t+'" attribute. The value should be an object with properties '+n),e}}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Factory=void 0;const e=Vt,t=Re,r="get",i="set";n.Factory={addGetterSetter(s,o,l,c,h){n.Factory.addGetter(s,o,l),n.Factory.addSetter(s,o,c,h),n.Factory.addOverloadedGetterSetter(s,o)},addGetter(s,o,l){const c=r+e.Util._capitalize(o);s.prototype[c]=s.prototype[c]||function(){const h=this.attrs[o];return h===void 0?l:h}},addSetter(s,o,l,c){const h=i+e.Util._capitalize(o);s.prototype[h]||n.Factory.overWriteSetter(s,o,l,c)},overWriteSetter(s,o,l,c){const h=i+e.Util._capitalize(o);s.prototype[h]=function(p){return l&&p!==void 0&&p!==null&&(p=l.call(this,p,o)),this._setAttr(o,p),c&&c.call(this),this}},addComponentsGetterSetter(s,o,l,c,h){const p=l.length,m=e.Util._capitalize,_=r+m(o),S=i+m(o);s.prototype[_]=function(){const x={};for(let M=0;M<p;M++){const R=l[M];x[R]=this.getAttr(o+m(R))}return x};const E=(0,t.getComponentValidator)(l);s.prototype[S]=function(x){const M=this.attrs[o];c&&(x=c.call(this,x,o)),E&&E.call(this,x,o);for(const R in x)x.hasOwnProperty(R)&&this._setAttr(o+m(R),x[R]);return x||l.forEach(R=>{this._setAttr(o+m(R),void 0)}),this._fireChangeEvent(o,M,x),h&&h.call(this),this},n.Factory.addOverloadedGetterSetter(s,o)},addOverloadedGetterSetter(s,o){const l=e.Util._capitalize(o),c=i+l,h=r+l;s.prototype[o]=function(){return arguments.length?(this[c](arguments[0]),this):this[h]()}},addDeprecatedGetterSetter(s,o,l,c){e.Util.error("Adding deprecated "+o);const h=r+e.Util._capitalize(o),p=o+" property is deprecated and will be removed soon. Look at Konva change log for more information.";s.prototype[h]=function(){e.Util.error(p);const m=this.attrs[o];return m===void 0?l:m},n.Factory.addSetter(s,o,c,function(){e.Util.error(p)}),n.Factory.addOverloadedGetterSetter(s,o)},backCompat(s,o){e.Util.each(o,function(l,c){const h=s.prototype[c],p=r+e.Util._capitalize(l),m=i+e.Util._capitalize(l);function _(){h.apply(this,arguments),e.Util.error('"'+l+'" method is deprecated and will be removed soon. Use ""'+c+'" instead.')}s.prototype[l]=_,s.prototype[p]=_,s.prototype[m]=_})},afterSetFilter(){this._filterUpToDate=!1}}})(ze);Object.defineProperty(At,"__esModule",{value:!0});At.Node=void 0;const lu=Mi,ri=Q0,Pf=ze,ko=Oe,We=Vt,Qt=Re,Dg="absoluteOpacity",sg="allEventListeners",Ns="absoluteTransform",f5="absoluteScale",Wa="canvas",Hz="Change",$z="children",qz="konva",A2="listening",Kz="mouseenter",Qz="mouseleave",Yz="pointerenter",Xz="pointerleave",Jz="touchenter",Zz="touchleave",p5="set",g5="Shape",Mg=" ",m5="stage",Po="transform",ej="Stage",N2="visible",tj=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(Mg);let nj=1;class Ne{constructor(e){this._id=nj++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(e),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(e){(e===Po||e===Ns)&&this._cache.get(e)?this._cache.get(e).dirty=!0:e?this._cache.delete(e):this._cache.clear()}_getCache(e,t){let r=this._cache.get(e);return(r===void 0||(e===Po||e===Ns)&&r.dirty===!0)&&(r=t.call(this),this._cache.set(e,r)),r}_calculate(e,t,r){if(!this._attachedDepsListeners.get(e)){const i=t.map(s=>s+"Change.konva").join(Mg);this.on(i,()=>{this._clearCache(e)}),this._attachedDepsListeners.set(e,!0)}return this._getCache(e,r)}_getCanvasCache(){return this._cache.get(Wa)}_clearSelfAndDescendantCache(e){this._clearCache(e),e===Ns&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(Wa)){const{scene:e,filter:t,hit:r,buffer:i}=this._cache.get(Wa);We.Util.releaseCanvas(e,t,r,i),this._cache.delete(Wa)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(e){const t=e||{};let r={};(t.x===void 0||t.y===void 0||t.width===void 0||t.height===void 0)&&(r=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let i=Math.ceil(t.width||r.width),s=Math.ceil(t.height||r.height),o=t.pixelRatio,l=t.x===void 0?Math.floor(r.x):t.x,c=t.y===void 0?Math.floor(r.y):t.y,h=t.offset||0,p=t.drawBorder||!1,m=t.hitCanvasPixelRatio||1;if(!i||!s){We.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const _=Math.abs(Math.round(r.x)-l)>.5?1:0,S=Math.abs(Math.round(r.y)-c)>.5?1:0;i+=h*2+_,s+=h*2+S,l-=h,c-=h;const E=new lu.SceneCanvas({pixelRatio:o,width:i,height:s}),x=new lu.SceneCanvas({pixelRatio:o,width:0,height:0,willReadFrequently:!0}),M=new lu.HitCanvas({pixelRatio:m,width:i,height:s}),R=E.getContext(),P=M.getContext(),v=new lu.SceneCanvas({width:E.width/E.pixelRatio+Math.abs(l),height:E.height/E.pixelRatio+Math.abs(c),pixelRatio:E.pixelRatio}),k=v.getContext();return M.isCache=!0,E.isCache=!0,this._cache.delete(Wa),this._filterUpToDate=!1,t.imageSmoothingEnabled===!1&&(E.getContext()._context.imageSmoothingEnabled=!1,x.getContext()._context.imageSmoothingEnabled=!1),R.save(),P.save(),k.save(),R.translate(-l,-c),P.translate(-l,-c),k.translate(-l,-c),v.x=l,v.y=c,this._isUnderCache=!0,this._clearSelfAndDescendantCache(Dg),this._clearSelfAndDescendantCache(f5),this.drawScene(E,this,v),this.drawHit(M,this),this._isUnderCache=!1,R.restore(),P.restore(),p&&(R.save(),R.beginPath(),R.rect(0,0,i,s),R.closePath(),R.setAttr("strokeStyle","red"),R.setAttr("lineWidth",5),R.stroke(),R.restore()),this._cache.set(Wa,{scene:E,filter:x,hit:M,buffer:v,x:l,y:c}),this._requestDraw(),this}isCached(){return this._cache.has(Wa)}getClientRect(e){throw new Error('abstract "getClientRect" method call')}_transformedRect(e,t){const r=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}];let i=1/0,s=1/0,o=-1/0,l=-1/0;const c=this.getAbsoluteTransform(t);return r.forEach(function(h){const p=c.point(h);i===void 0&&(i=o=p.x,s=l=p.y),i=Math.min(i,p.x),s=Math.min(s,p.y),o=Math.max(o,p.x),l=Math.max(l,p.y)}),{x:i,y:s,width:o-i,height:l-s}}_drawCachedSceneCanvas(e){e.save(),e._applyOpacity(this),e._applyGlobalCompositeOperation(this);const t=this._getCanvasCache();e.translate(t.x,t.y);const r=this._getCachedSceneCanvas(),i=r.pixelRatio;e.drawImage(r._canvas,0,0,r.width/i,r.height/i),e.restore()}_drawCachedHitCanvas(e){const t=this._getCanvasCache(),r=t.hit;e.save(),e.translate(t.x,t.y),e.drawImage(r._canvas,0,0,r.width/r.pixelRatio,r.height/r.pixelRatio),e.restore()}_getCachedSceneCanvas(){let e=this.filters(),t=this._getCanvasCache(),r=t.scene,i=t.filter,s=i.getContext(),o,l,c,h;if(e){if(!this._filterUpToDate){const p=r.pixelRatio;i.setSize(r.width/r.pixelRatio,r.height/r.pixelRatio);try{for(o=e.length,s.clear(),s.drawImage(r._canvas,0,0,r.getWidth()/p,r.getHeight()/p),l=s.getImageData(0,0,i.getWidth(),i.getHeight()),c=0;c<o;c++){if(h=e[c],typeof h!="function"){We.Util.error("Filter should be type of function, but got "+typeof h+" instead. Please check correct filters");continue}h.call(this,l),s.putImageData(l,0,0)}}catch(m){We.Util.error("Unable to apply filter. "+m.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return i}return r}on(e,t){if(this._cache&&this._cache.delete(sg),arguments.length===3)return this._delegate.apply(this,arguments);const r=e.split(Mg);for(let i=0;i<r.length;i++){const o=r[i].split("."),l=o[0],c=o[1]||"";this.eventListeners[l]||(this.eventListeners[l]=[]),this.eventListeners[l].push({name:c,handler:t})}return this}off(e,t){let r=(e||"").split(Mg),i=r.length,s,o,l,c,h,p;if(this._cache&&this._cache.delete(sg),!e)for(o in this.eventListeners)this._off(o);for(s=0;s<i;s++)if(l=r[s],c=l.split("."),h=c[0],p=c[1],h)this.eventListeners[h]&&this._off(h,p,t);else for(o in this.eventListeners)this._off(o,p,t);return this}dispatchEvent(e){const t={target:this,type:e.type,evt:e};return this.fire(e.type,t),this}addEventListener(e,t){return this.on(e,function(r){t.call(this,r.evt)}),this}removeEventListener(e){return this.off(e),this}_delegate(e,t,r){const i=this;this.on(e,function(s){const o=s.target.findAncestors(t,!0,i);for(let l=0;l<o.length;l++)s=We.Util.cloneObject(s),s.currentTarget=o[l],r.call(o[l],s)})}remove(){return this.isDragging()&&this.stopDrag(),ri.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Ns),this._clearSelfAndDescendantCache(Dg),this._clearSelfAndDescendantCache(f5),this._clearSelfAndDescendantCache(m5),this._clearSelfAndDescendantCache(N2),this._clearSelfAndDescendantCache(A2)}_remove(){this._clearCaches();const e=this.getParent();e&&e.children&&(e.children.splice(this.index,1),e._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(e){const t="get"+We.Util._capitalize(e);return We.Util._isFunction(this[t])?this[t]():this.attrs[e]}getAncestors(){let e=this.getParent(),t=[];for(;e;)t.push(e),e=e.getParent();return t}getAttrs(){return this.attrs||{}}setAttrs(e){return this._batchTransformChanges(()=>{let t,r;if(!e)return this;for(t in e)t!==$z&&(r=p5+We.Util._capitalize(t),We.Util._isFunction(this[r])?this[r](e[t]):this._setAttr(t,e[t]))}),this}isListening(){return this._getCache(A2,this._isListening)}_isListening(e){if(!this.listening())return!1;const r=this.getParent();return r&&r!==e&&this!==e?r._isListening(e):!0}isVisible(){return this._getCache(N2,this._isVisible)}_isVisible(e){if(!this.visible())return!1;const r=this.getParent();return r&&r!==e&&this!==e?r._isVisible(e):!0}shouldDrawHit(e,t=!1){if(e)return this._isVisible(e)&&this._isListening(e);const r=this.getLayer();let i=!1;ri.DD._dragElements.forEach(o=>{o.dragStatus==="dragging"&&(o.node.nodeType==="Stage"||o.node.getLayer()===r)&&(i=!0)});const s=!t&&!ko.Konva.hitOnDragEnabled&&(i||ko.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!s}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let e=this.getDepth(),t=this,r=0,i,s,o,l;function c(p){for(i=[],s=p.length,o=0;o<s;o++)l=p[o],r++,l.nodeType!==g5&&(i=i.concat(l.getChildren().slice())),l._id===t._id&&(o=s);i.length>0&&i[0].getDepth()<=e&&c(i)}const h=this.getStage();return t.nodeType!==ej&&h&&c(h.getChildren()),r}getDepth(){let e=0,t=this.parent;for(;t;)e++,t=t.parent;return e}_batchTransformChanges(e){this._batchingTransformChange=!0,e(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(Po),this._clearSelfAndDescendantCache(Ns)),this._needClearTransformCache=!1}setPosition(e){return this._batchTransformChanges(()=>{this.x(e.x),this.y(e.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const e=this.getStage();if(!e)return null;const t=e.getPointerPosition();if(!t)return null;const r=this.getAbsoluteTransform().copy();return r.invert(),r.point(t)}getAbsolutePosition(e){let t=!1,r=this.parent;for(;r;){if(r.isCached()){t=!0;break}r=r.parent}t&&!e&&(e=!0);const i=this.getAbsoluteTransform(e).getMatrix(),s=new We.Transform,o=this.offset();return s.m=i.slice(),s.translate(o.x,o.y),s.getTranslation()}setAbsolutePosition(e){const{x:t,y:r,...i}=this._clearTransform();this.attrs.x=t,this.attrs.y=r,this._clearCache(Po);const s=this._getAbsoluteTransform().copy();return s.invert(),s.translate(e.x,e.y),e={x:this.attrs.x+s.getTranslation().x,y:this.attrs.y+s.getTranslation().y},this._setTransform(i),this.setPosition({x:e.x,y:e.y}),this._clearCache(Po),this._clearSelfAndDescendantCache(Ns),this}_setTransform(e){let t;for(t in e)this.attrs[t]=e[t]}_clearTransform(){const e={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,e}move(e){let t=e.x,r=e.y,i=this.x(),s=this.y();return t!==void 0&&(i+=t),r!==void 0&&(s+=r),this.setPosition({x:i,y:s}),this}_eachAncestorReverse(e,t){let r=[],i=this.getParent(),s,o;if(!(t&&t._id===this._id)){for(r.unshift(this);i&&(!t||i._id!==t._id);)r.unshift(i),i=i.parent;for(s=r.length,o=0;o<s;o++)e(r[o])}}rotate(e){return this.rotation(this.rotation()+e),this}moveToTop(){if(!this.parent)return We.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const e=this.index,t=this.parent.getChildren().length;return e<t-1?(this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return We.Util.warn("Node has no parent. moveUp function is ignored."),!1;const e=this.index,t=this.parent.getChildren().length;return e<t-1?(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return We.Util.warn("Node has no parent. moveDown function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return We.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(e){if(!this.parent)return We.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(e<0||e>=this.parent.children.length)&&We.Util.warn("Unexpected value "+e+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const t=this.index;return this.parent.children.splice(t,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(Dg,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let e=this.opacity();const t=this.getParent();return t&&!t._isUnderCache&&(e*=t.getAbsoluteOpacity()),e}moveTo(e){return this.getParent()!==e&&(this._remove(),e.add(this)),this}toObject(){let e=this.getAttrs(),t,r,i,s,o;const l={attrs:{},className:this.getClassName()};for(t in e)r=e[t],o=We.Util.isObject(r)&&!We.Util._isPlainObject(r)&&!We.Util._isArray(r),!o&&(i=typeof this[t]=="function"&&this[t],delete e[t],s=i?i.call(this):null,e[t]=r,s!==r&&(l.attrs[t]=r));return We.Util._prepareToStringify(l)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(e,t,r){const i=[];t&&this._isMatch(e)&&i.push(this);let s=this.parent;for(;s;){if(s===r)return i;s._isMatch(e)&&i.push(s),s=s.parent}return i}isAncestorOf(e){return!1}findAncestor(e,t,r){return this.findAncestors(e,t,r)[0]}_isMatch(e){if(!e)return!1;if(typeof e=="function")return e(this);let t=e.replace(/ /g,"").split(","),r=t.length,i,s;for(i=0;i<r;i++)if(s=t[i],We.Util.isValidSelector(s)||(We.Util.warn('Selector "'+s+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),We.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),We.Util.warn("Konva is awesome, right?")),s.charAt(0)==="#"){if(this.id()===s.slice(1))return!0}else if(s.charAt(0)==="."){if(this.hasName(s.slice(1)))return!0}else if(this.className===s||this.nodeType===s)return!0;return!1}getLayer(){const e=this.getParent();return e?e.getLayer():null}getStage(){return this._getCache(m5,this._getStage)}_getStage(){const e=this.getParent();return e?e.getStage():null}fire(e,t={},r){return t.target=t.target||this,r?this._fireAndBubble(e,t):this._fire(e,t),this}getAbsoluteTransform(e){return e?this._getAbsoluteTransform(e):this._getCache(Ns,this._getAbsoluteTransform)}_getAbsoluteTransform(e){let t;if(e)return t=new We.Transform,this._eachAncestorReverse(function(r){const i=r.transformsEnabled();i==="all"?t.multiply(r.getTransform()):i==="position"&&t.translate(r.x()-r.offsetX(),r.y()-r.offsetY())},e),t;{t=this._cache.get(Ns)||new We.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(t):t.reset();const r=this.transformsEnabled();if(r==="all")t.multiply(this.getTransform());else if(r==="position"){const i=this.attrs.x||0,s=this.attrs.y||0,o=this.attrs.offsetX||0,l=this.attrs.offsetY||0;t.translate(i-o,s-l)}return t.dirty=!1,t}}getAbsoluteScale(e){let t=this;for(;t;)t._isUnderCache&&(e=t),t=t.getParent();const i=this.getAbsoluteTransform(e).decompose();return{x:i.scaleX,y:i.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(Po,this._getTransform)}_getTransform(){var e,t;const r=this._cache.get(Po)||new We.Transform;r.reset();const i=this.x(),s=this.y(),o=ko.Konva.getAngle(this.rotation()),l=(e=this.attrs.scaleX)!==null&&e!==void 0?e:1,c=(t=this.attrs.scaleY)!==null&&t!==void 0?t:1,h=this.attrs.skewX||0,p=this.attrs.skewY||0,m=this.attrs.offsetX||0,_=this.attrs.offsetY||0;return(i!==0||s!==0)&&r.translate(i,s),o!==0&&r.rotate(o),(h!==0||p!==0)&&r.skew(h,p),(l!==1||c!==1)&&r.scale(l,c),(m!==0||_!==0)&&r.translate(-1*m,-1*_),r.dirty=!1,r}clone(e){let t=We.Util.cloneObject(this.attrs),r,i,s,o,l;for(r in e)t[r]=e[r];const c=new this.constructor(t);for(r in this.eventListeners)for(i=this.eventListeners[r],s=i.length,o=0;o<s;o++)l=i[o],l.name.indexOf(qz)<0&&(c.eventListeners[r]||(c.eventListeners[r]=[]),c.eventListeners[r].push(l));return c}_toKonvaCanvas(e){e=e||{};const t=this.getClientRect(),r=this.getStage(),i=e.x!==void 0?e.x:Math.floor(t.x),s=e.y!==void 0?e.y:Math.floor(t.y),o=e.pixelRatio||1,l=new lu.SceneCanvas({width:e.width||Math.ceil(t.width)||(r?r.width():0),height:e.height||Math.ceil(t.height)||(r?r.height():0),pixelRatio:o}),c=l.getContext(),h=new lu.SceneCanvas({width:l.width/l.pixelRatio+Math.abs(i),height:l.height/l.pixelRatio+Math.abs(s),pixelRatio:l.pixelRatio});return e.imageSmoothingEnabled===!1&&(c._context.imageSmoothingEnabled=!1),c.save(),(i||s)&&c.translate(-1*i,-1*s),this.drawScene(l,void 0,h),c.restore(),l}toCanvas(e){return this._toKonvaCanvas(e)._canvas}toDataURL(e){e=e||{};const t=e.mimeType||null,r=e.quality||null,i=this._toKonvaCanvas(e).toDataURL(t,r);return e.callback&&e.callback(i),i}toImage(e){return new Promise((t,r)=>{try{const i=e==null?void 0:e.callback;i&&delete e.callback,We.Util._urlToImage(this.toDataURL(e),function(s){t(s),i==null||i(s)})}catch(i){r(i)}})}toBlob(e){return new Promise((t,r)=>{try{const i=e==null?void 0:e.callback;i&&delete e.callback,this.toCanvas(e).toBlob(s=>{t(s),i==null||i(s)},e==null?void 0:e.mimeType,e==null?void 0:e.quality)}catch(i){r(i)}})}setSize(e){return this.width(e.width),this.height(e.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():ko.Konva.dragDistance}_off(e,t,r){let i=this.eventListeners[e],s,o,l;for(s=0;s<i.length;s++)if(o=i[s].name,l=i[s].handler,(o!=="konva"||t==="konva")&&(!t||o===t)&&(!r||r===l)){if(i.splice(s,1),i.length===0){delete this.eventListeners[e];break}s--}}_fireChangeEvent(e,t,r){this._fire(e+Hz,{oldVal:t,newVal:r})}addName(e){if(!this.hasName(e)){const t=this.name(),r=t?t+" "+e:e;this.name(r)}return this}hasName(e){if(!e)return!1;const t=this.name();return t?(t||"").split(/\s/g).indexOf(e)!==-1:!1}removeName(e){const t=(this.name()||"").split(/\s/g),r=t.indexOf(e);return r!==-1&&(t.splice(r,1),this.name(t.join(" "))),this}setAttr(e,t){const r=this[p5+We.Util._capitalize(e)];return We.Util._isFunction(r)?r.call(this,t):this._setAttr(e,t),this}_requestDraw(){if(ko.Konva.autoDrawEnabled){const e=this.getLayer()||this.getStage();e==null||e.batchDraw()}}_setAttr(e,t){const r=this.attrs[e];r===t&&!We.Util.isObject(t)||(t==null?delete this.attrs[e]:this.attrs[e]=t,this._shouldFireChangeEvents&&this._fireChangeEvent(e,r,t),this._requestDraw())}_setComponentAttr(e,t,r){let i;r!==void 0&&(i=this.attrs[e],i||(this.attrs[e]=this.getAttr(e)),this.attrs[e][t]=r,this._fireChangeEvent(e,i,r))}_fireAndBubble(e,t,r){t&&this.nodeType===g5&&(t.target=this);const i=[Kz,Qz,Yz,Xz,Jz,Zz];if(!(i.indexOf(e)!==-1&&(r&&(this===r||this.isAncestorOf&&this.isAncestorOf(r))||this.nodeType==="Stage"&&!r))){this._fire(e,t);const o=i.indexOf(e)!==-1&&r&&r.isAncestorOf&&r.isAncestorOf(this)&&!r.isAncestorOf(this.parent);(t&&!t.cancelBubble||!t)&&this.parent&&this.parent.isListening()&&!o&&(r&&r.parent?this._fireAndBubble.call(this.parent,e,t,r):this._fireAndBubble.call(this.parent,e,t))}}_getProtoListeners(e){var t,r,i;const s=(t=this._cache.get(sg))!==null&&t!==void 0?t:{};let o=s==null?void 0:s[e];if(o===void 0){o=[];let l=Object.getPrototypeOf(this);for(;l;){const c=(i=(r=l.eventListeners)===null||r===void 0?void 0:r[e])!==null&&i!==void 0?i:[];o.push(...c),l=Object.getPrototypeOf(l)}s[e]=o,this._cache.set(sg,s)}return o}_fire(e,t){t=t||{},t.currentTarget=this,t.type=e;const r=this._getProtoListeners(e);if(r)for(let s=0;s<r.length;s++)r[s].handler.call(this,t);const i=this.eventListeners[e];if(i)for(let s=0;s<i.length;s++)i[s].handler.call(this,t)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(e){const t=e?e.pointerId:void 0,r=this.getStage(),i=this.getAbsolutePosition();if(!r)return;const s=r._getPointerById(t)||r._changedPointerPositions[0]||i;ri.DD._dragElements.set(this._id,{node:this,startPointerPos:s,offset:{x:s.x-i.x,y:s.y-i.y},dragStatus:"ready",pointerId:t})}startDrag(e,t=!0){ri.DD._dragElements.has(this._id)||this._createDragElement(e);const r=ri.DD._dragElements.get(this._id);r.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:e&&e.evt},t)}_setDragPosition(e,t){const r=this.getStage()._getPointerById(t.pointerId);if(!r)return;let i={x:r.x-t.offset.x,y:r.y-t.offset.y};const s=this.dragBoundFunc();if(s!==void 0){const o=s.call(this,i,e);o?i=o:We.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==i.x||this._lastPos.y!==i.y)&&(this.setAbsolutePosition(i),this._requestDraw()),this._lastPos=i}stopDrag(e){const t=ri.DD._dragElements.get(this._id);t&&(t.dragStatus="stopped"),ri.DD._endDragBefore(e),ri.DD._endDragAfter(e)}setDraggable(e){this._setAttr("draggable",e),this._dragChange()}isDragging(){const e=ri.DD._dragElements.get(this._id);return e?e.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(e){if(!(!(e.evt.button!==void 0)||ko.Konva.dragButtons.indexOf(e.evt.button)>=0)||this.isDragging())return;let i=!1;ri.DD._dragElements.forEach(s=>{this.isAncestorOf(s.node)&&(i=!0)}),i||this._createDragElement(e)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const t=ri.DD._dragElements.get(this._id),r=t&&t.dragStatus==="dragging",i=t&&t.dragStatus==="ready";r?this.stopDrag():i&&ri.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(e={x:0,y:0}){const t=this.getStage();if(!t)return!1;const r={x:-e.x,y:-e.y,width:t.width()+2*e.x,height:t.height()+2*e.y};return We.Util.haveIntersection(r,this.getClientRect())}static create(e,t){return We.Util._isString(e)&&(e=JSON.parse(e)),this._createNode(e,t)}static _createNode(e,t){let r=Ne.prototype.getClassName.call(e),i=e.children,s,o,l;t&&(e.attrs.container=t),ko.Konva[r]||(We.Util.warn('Can not find a node with class name "'+r+'". Fallback to "Shape".'),r="Shape");const c=ko.Konva[r];if(s=new c(e.attrs),i)for(o=i.length,l=0;l<o;l++)s.add(Ne._createNode(i[l]));return s}}At.Node=Ne;Ne.prototype.nodeType="Node";Ne.prototype._attrsAffectingSize=[];Ne.prototype.eventListeners={};Ne.prototype.on.call(Ne.prototype,tj,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(Po),this._clearSelfAndDescendantCache(Ns)});Ne.prototype.on.call(Ne.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(N2)});Ne.prototype.on.call(Ne.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(A2)});Ne.prototype.on.call(Ne.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(Dg)});const St=Pf.Factory.addGetterSetter;St(Ne,"zIndex");St(Ne,"absolutePosition");St(Ne,"position");St(Ne,"x",0,(0,Qt.getNumberValidator)());St(Ne,"y",0,(0,Qt.getNumberValidator)());St(Ne,"globalCompositeOperation","source-over",(0,Qt.getStringValidator)());St(Ne,"opacity",1,(0,Qt.getNumberValidator)());St(Ne,"name","",(0,Qt.getStringValidator)());St(Ne,"id","",(0,Qt.getStringValidator)());St(Ne,"rotation",0,(0,Qt.getNumberValidator)());Pf.Factory.addComponentsGetterSetter(Ne,"scale",["x","y"]);St(Ne,"scaleX",1,(0,Qt.getNumberValidator)());St(Ne,"scaleY",1,(0,Qt.getNumberValidator)());Pf.Factory.addComponentsGetterSetter(Ne,"skew",["x","y"]);St(Ne,"skewX",0,(0,Qt.getNumberValidator)());St(Ne,"skewY",0,(0,Qt.getNumberValidator)());Pf.Factory.addComponentsGetterSetter(Ne,"offset",["x","y"]);St(Ne,"offsetX",0,(0,Qt.getNumberValidator)());St(Ne,"offsetY",0,(0,Qt.getNumberValidator)());St(Ne,"dragDistance",void 0,(0,Qt.getNumberValidator)());St(Ne,"width",0,(0,Qt.getNumberValidator)());St(Ne,"height",0,(0,Qt.getNumberValidator)());St(Ne,"listening",!0,(0,Qt.getBooleanValidator)());St(Ne,"preventDefault",!0,(0,Qt.getBooleanValidator)());St(Ne,"filters",void 0,function(n){return this._filterUpToDate=!1,n});St(Ne,"visible",!0,(0,Qt.getBooleanValidator)());St(Ne,"transformsEnabled","all",(0,Qt.getStringValidator)());St(Ne,"size");St(Ne,"dragBoundFunc");St(Ne,"draggable",!1,(0,Qt.getBooleanValidator)());Pf.Factory.backCompat(Ne,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var xl={};Object.defineProperty(xl,"__esModule",{value:!0});xl.Container=void 0;const Ac=ze,bv=At,Y0=Re;class Al extends bv.Node{constructor(){super(...arguments),this.children=[]}getChildren(e){const t=this.children||[];return e?t.filter(e):t}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.destroy()}),this.children=[],this._requestDraw(),this}add(...e){if(e.length===0)return this;if(e.length>1){for(let r=0;r<e.length;r++)this.add(e[r]);return this}const t=e[0];return t.getParent()?(t.moveTo(this),this):(this._validateAdd(t),t.index=this.getChildren().length,t.parent=this,t._clearCaches(),this.getChildren().push(t),this._fire("add",{child:t}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(e){return this._generalFind(e,!1)}findOne(e){const t=this._generalFind(e,!0);return t.length>0?t[0]:void 0}_generalFind(e,t){const r=[];return this._descendants(i=>{const s=i._isMatch(e);return s&&r.push(i),!!(s&&t)}),r}_descendants(e){let t=!1;const r=this.getChildren();for(const i of r){if(t=e(i),t)return!0;if(i.hasChildren()&&(t=i._descendants(e),t))return!0}return!1}toObject(){const e=bv.Node.prototype.toObject.call(this);return e.children=[],this.getChildren().forEach(t=>{e.children.push(t.toObject())}),e}isAncestorOf(e){let t=e.getParent();for(;t;){if(t._id===this._id)return!0;t=t.getParent()}return!1}clone(e){const t=bv.Node.prototype.clone.call(this,e);return this.getChildren().forEach(function(r){t.add(r.clone())}),t}getAllIntersections(e){const t=[];return this.find("Shape").forEach(r=>{r.isVisible()&&r.intersects(e)&&t.push(r)}),t}_clearSelfAndDescendantCache(e){var t;super._clearSelfAndDescendantCache(e),!this.isCached()&&((t=this.children)===null||t===void 0||t.forEach(function(r){r._clearSelfAndDescendantCache(e)}))}_setChildrenIndices(){var e;(e=this.children)===null||e===void 0||e.forEach(function(t,r){t.index=r}),this._requestDraw()}drawScene(e,t,r){const i=this.getLayer(),s=e||i&&i.getCanvas(),o=s&&s.getContext(),l=this._getCanvasCache(),c=l&&l.scene,h=s&&s.isCache;if(!this.isVisible()&&!h)return this;if(c){o.save();const p=this.getAbsoluteTransform(t).getMatrix();o.transform(p[0],p[1],p[2],p[3],p[4],p[5]),this._drawCachedSceneCanvas(o),o.restore()}else this._drawChildren("drawScene",s,t,r);return this}drawHit(e,t){if(!this.shouldDrawHit(t))return this;const r=this.getLayer(),i=e||r&&r.hitCanvas,s=i&&i.getContext(),o=this._getCanvasCache();if(o&&o.hit){s.save();const c=this.getAbsoluteTransform(t).getMatrix();s.transform(c[0],c[1],c[2],c[3],c[4],c[5]),this._drawCachedHitCanvas(s),s.restore()}else this._drawChildren("drawHit",i,t);return this}_drawChildren(e,t,r,i){var s;const o=t&&t.getContext(),l=this.clipWidth(),c=this.clipHeight(),h=this.clipFunc(),p=typeof l=="number"&&typeof c=="number"||h,m=r===this;if(p){o.save();const S=this.getAbsoluteTransform(r);let E=S.getMatrix();o.transform(E[0],E[1],E[2],E[3],E[4],E[5]),o.beginPath();let x;if(h)x=h.call(this,o,this);else{const M=this.clipX(),R=this.clipY();o.rect(M||0,R||0,l,c)}o.clip.apply(o,x),E=S.copy().invert().getMatrix(),o.transform(E[0],E[1],E[2],E[3],E[4],E[5])}const _=!m&&this.globalCompositeOperation()!=="source-over"&&e==="drawScene";_&&(o.save(),o._applyGlobalCompositeOperation(this)),(s=this.children)===null||s===void 0||s.forEach(function(S){S[e](t,r,i)}),_&&o.restore(),p&&o.restore()}getClientRect(e={}){var t;const r=e.skipTransform,i=e.relativeTo;let s,o,l,c,h={x:1/0,y:1/0,width:0,height:0};const p=this;(t=this.children)===null||t===void 0||t.forEach(function(S){if(!S.visible())return;const E=S.getClientRect({relativeTo:p,skipShadow:e.skipShadow,skipStroke:e.skipStroke});E.width===0&&E.height===0||(s===void 0?(s=E.x,o=E.y,l=E.x+E.width,c=E.y+E.height):(s=Math.min(s,E.x),o=Math.min(o,E.y),l=Math.max(l,E.x+E.width),c=Math.max(c,E.y+E.height)))});const m=this.find("Shape");let _=!1;for(let S=0;S<m.length;S++)if(m[S]._isVisible(this)){_=!0;break}return _&&s!==void 0?h={x:s,y:o,width:l-s,height:c-o}:h={x:0,y:0,width:0,height:0},r?h:this._transformedRect(h,i)}}xl.Container=Al;Ac.Factory.addComponentsGetterSetter(Al,"clip",["x","y","width","height"]);Ac.Factory.addGetterSetter(Al,"clipX",void 0,(0,Y0.getNumberValidator)());Ac.Factory.addGetterSetter(Al,"clipY",void 0,(0,Y0.getNumberValidator)());Ac.Factory.addGetterSetter(Al,"clipWidth",void 0,(0,Y0.getNumberValidator)());Ac.Factory.addGetterSetter(Al,"clipHeight",void 0,(0,Y0.getNumberValidator)());Ac.Factory.addGetterSetter(Al,"clipFunc");var ax={},wa={};Object.defineProperty(wa,"__esModule",{value:!0});wa.getCapturedShape=ij;wa.createEvent=vS;wa.hasPointerCapture=sj;wa.setPointerCapture=oj;wa.releaseCapture=ux;const rj=Oe,Xd=new Map,lx=rj.Konva._global.PointerEvent!==void 0;function ij(n){return Xd.get(n)}function vS(n){return{evt:n,pointerId:n.pointerId}}function sj(n,e){return Xd.get(n)===e}function oj(n,e){ux(n),e.getStage()&&(Xd.set(n,e),lx&&e._fire("gotpointercapture",vS(new PointerEvent("gotpointercapture"))))}function ux(n,e){const t=Xd.get(n);if(!t)return;const r=t.getStage();r&&r.content,Xd.delete(n),lx&&t._fire("lostpointercapture",vS(new PointerEvent("lostpointercapture")))}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Stage=n.stages=void 0;const e=Vt,t=ze,r=xl,i=Oe,s=Mi,o=Q0,l=Oe,c=wa,h="Stage",p="string",m="px",_="mouseout",S="mouseleave",E="mouseover",x="mouseenter",M="mousemove",R="mousedown",P="mouseup",v="pointermove",k="pointerdown",D="pointerup",O="pointercancel",N="lostpointercapture",C="pointerout",b="pointerleave",A="pointerover",L="pointerenter",B="contextmenu",V="touchstart",he="touchend",le="touchmove",Te="touchcancel",xe="wheel",Y=5,J=[[x,"_pointerenter"],[R,"_pointerdown"],[M,"_pointermove"],[P,"_pointerup"],[S,"_pointerleave"],[V,"_pointerdown"],[le,"_pointermove"],[he,"_pointerup"],[Te,"_pointercancel"],[E,"_pointerover"],[xe,"_wheel"],[B,"_contextmenu"],[k,"_pointerdown"],[v,"_pointermove"],[D,"_pointerup"],[O,"_pointercancel"],[b,"_pointerleave"],[N,"_lostpointercapture"]],X={mouse:{[C]:_,[b]:S,[A]:E,[L]:x,[v]:M,[k]:R,[D]:P,[O]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[C]:"touchout",[b]:"touchleave",[A]:"touchover",[L]:"touchenter",[v]:le,[k]:V,[D]:he,[O]:Te,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[C]:C,[b]:b,[A]:A,[L]:L,[v]:v,[k]:k,[D]:D,[O]:O,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},te=Qe=>Qe.indexOf("pointer")>=0?"pointer":Qe.indexOf("touch")>=0?"touch":"mouse",ie=Qe=>{const j=te(Qe);if(j==="pointer")return i.Konva.pointerEventsEnabled&&X.pointer;if(j==="touch")return X.touch;if(j==="mouse")return X.mouse};function se(Qe={}){return(Qe.clipFunc||Qe.clipWidth||Qe.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),Qe}const ft="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";n.stages=[];class ct extends r.Container{constructor(j){super(se(j)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),n.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{se(this.attrs)}),this._checkVisibility()}_validateAdd(j){const ne=j.getType()==="Layer",ye=j.getType()==="FastLayer";ne||ye||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const j=this.visible()?"":"none";this.content.style.display=j}setContainer(j){if(typeof j===p){let ne;if(j.charAt(0)==="."){const ye=j.slice(1);j=document.getElementsByClassName(ye)[0]}else j.charAt(0)!=="#"?ne=j:ne=j.slice(1),j=document.getElementById(ne);if(!j)throw"Can not find container in document with id "+ne}return this._setAttr("container",j),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),j.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const j=this.children,ne=j.length;for(let ye=0;ye<ne;ye++)j[ye].clear();return this}clone(j){return j||(j={}),j.container=typeof document<"u"&&document.createElement("div"),r.Container.prototype.clone.call(this,j)}destroy(){super.destroy();const j=this.content;j&&e.Util._isInDocument(j)&&this.container().removeChild(j);const ne=n.stages.indexOf(this);return ne>-1&&n.stages.splice(ne,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const j=this._pointerPositions[0]||this._changedPointerPositions[0];return j?{x:j.x,y:j.y}:(e.Util.warn(ft),null)}_getPointerById(j){return this._pointerPositions.find(ne=>ne.id===j)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(j){j=j||{},j.x=j.x||0,j.y=j.y||0,j.width=j.width||this.width(),j.height=j.height||this.height();const ne=new s.SceneCanvas({width:j.width,height:j.height,pixelRatio:j.pixelRatio||1}),ye=ne.getContext()._context,Fe=this.children;return(j.x||j.y)&&ye.translate(-1*j.x,-1*j.y),Fe.forEach(function(Ce){if(!Ce.isVisible())return;const Ze=Ce._toKonvaCanvas(j);ye.drawImage(Ze._canvas,j.x,j.y,Ze.getWidth()/Ze.getPixelRatio(),Ze.getHeight()/Ze.getPixelRatio())}),ne}getIntersection(j){if(!j)return null;const ne=this.children,ye=ne.length,Fe=ye-1;for(let Ce=Fe;Ce>=0;Ce--){const Ze=ne[Ce].getIntersection(j);if(Ze)return Ze}return null}_resizeDOM(){const j=this.width(),ne=this.height();this.content&&(this.content.style.width=j+m,this.content.style.height=ne+m),this.bufferCanvas.setSize(j,ne),this.bufferHitCanvas.setSize(j,ne),this.children.forEach(ye=>{ye.setSize({width:j,height:ne}),ye.draw()})}add(j,...ne){if(arguments.length>1){for(let Fe=0;Fe<arguments.length;Fe++)this.add(arguments[Fe]);return this}super.add(j);const ye=this.children.length;return ye>Y&&e.Util.warn("The stage has "+ye+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),j.setSize({width:this.width(),height:this.height()}),j.draw(),i.Konva.isBrowser&&this.content.appendChild(j.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(j){return c.hasPointerCapture(j,this)}setPointerCapture(j){c.setPointerCapture(j,this)}releaseCapture(j){c.releaseCapture(j,this)}getLayers(){return this.children}_bindContentEvents(){i.Konva.isBrowser&&J.forEach(([j,ne])=>{this.content.addEventListener(j,ye=>{this[ne](ye)},{passive:!1})})}_pointerenter(j){this.setPointersPositions(j);const ne=ie(j.type);ne&&this._fire(ne.pointerenter,{evt:j,target:this,currentTarget:this})}_pointerover(j){this.setPointersPositions(j);const ne=ie(j.type);ne&&this._fire(ne.pointerover,{evt:j,target:this,currentTarget:this})}_getTargetShape(j){let ne=this[j+"targetShape"];return ne&&!ne.getStage()&&(ne=null),ne}_pointerleave(j){const ne=ie(j.type),ye=te(j.type);if(!ne)return;this.setPointersPositions(j);const Fe=this._getTargetShape(ye),Ce=!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled;Fe&&Ce?(Fe._fireAndBubble(ne.pointerout,{evt:j}),Fe._fireAndBubble(ne.pointerleave,{evt:j}),this._fire(ne.pointerleave,{evt:j,target:this,currentTarget:this}),this[ye+"targetShape"]=null):Ce&&(this._fire(ne.pointerleave,{evt:j,target:this,currentTarget:this}),this._fire(ne.pointerout,{evt:j,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(j){const ne=ie(j.type),ye=te(j.type);if(!ne)return;this.setPointersPositions(j);let Fe=!1;this._changedPointerPositions.forEach(Ce=>{const Ze=this.getIntersection(Ce);if(o.DD.justDragged=!1,i.Konva["_"+ye+"ListenClick"]=!0,!Ze||!Ze.isListening()){this[ye+"ClickStartShape"]=void 0;return}i.Konva.capturePointerEventsEnabled&&Ze.setPointerCapture(Ce.id),this[ye+"ClickStartShape"]=Ze,Ze._fireAndBubble(ne.pointerdown,{evt:j,pointerId:Ce.id}),Fe=!0;const ot=j.type.indexOf("touch")>=0;Ze.preventDefault()&&j.cancelable&&ot&&j.preventDefault()}),Fe||this._fire(ne.pointerdown,{evt:j,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(j){const ne=ie(j.type),ye=te(j.type);if(!ne||(i.Konva.isDragging()&&o.DD.node.preventDefault()&&j.cancelable&&j.preventDefault(),this.setPointersPositions(j),!(!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled)))return;const Ce={};let Ze=!1;const ot=this._getTargetShape(ye);this._changedPointerPositions.forEach(Ut=>{const et=c.getCapturedShape(Ut.id)||this.getIntersection(Ut),Wn=Ut.id,Cr={evt:j,pointerId:Wn},Hn=ot!==et;if(Hn&&ot&&(ot._fireAndBubble(ne.pointerout,{...Cr},et),ot._fireAndBubble(ne.pointerleave,{...Cr},et)),et){if(Ce[et._id])return;Ce[et._id]=!0}et&&et.isListening()?(Ze=!0,Hn&&(et._fireAndBubble(ne.pointerover,{...Cr},ot),et._fireAndBubble(ne.pointerenter,{...Cr},ot),this[ye+"targetShape"]=et),et._fireAndBubble(ne.pointermove,{...Cr})):ot&&(this._fire(ne.pointerover,{evt:j,target:this,currentTarget:this,pointerId:Wn}),this[ye+"targetShape"]=null)}),Ze||this._fire(ne.pointermove,{evt:j,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(j){const ne=ie(j.type),ye=te(j.type);if(!ne)return;this.setPointersPositions(j);const Fe=this[ye+"ClickStartShape"],Ce=this[ye+"ClickEndShape"],Ze={};let ot=!1;this._changedPointerPositions.forEach(Ut=>{const et=c.getCapturedShape(Ut.id)||this.getIntersection(Ut);if(et){if(et.releaseCapture(Ut.id),Ze[et._id])return;Ze[et._id]=!0}const Wn=Ut.id,Cr={evt:j,pointerId:Wn};let Hn=!1;i.Konva["_"+ye+"InDblClickWindow"]?(Hn=!0,clearTimeout(this[ye+"DblTimeout"])):o.DD.justDragged||(i.Konva["_"+ye+"InDblClickWindow"]=!0,clearTimeout(this[ye+"DblTimeout"])),this[ye+"DblTimeout"]=setTimeout(function(){i.Konva["_"+ye+"InDblClickWindow"]=!1},i.Konva.dblClickWindow),et&&et.isListening()?(ot=!0,this[ye+"ClickEndShape"]=et,et._fireAndBubble(ne.pointerup,{...Cr}),i.Konva["_"+ye+"ListenClick"]&&Fe&&Fe===et&&(et._fireAndBubble(ne.pointerclick,{...Cr}),Hn&&Ce&&Ce===et&&et._fireAndBubble(ne.pointerdblclick,{...Cr}))):(this[ye+"ClickEndShape"]=null,i.Konva["_"+ye+"ListenClick"]&&this._fire(ne.pointerclick,{evt:j,target:this,currentTarget:this,pointerId:Wn}),Hn&&this._fire(ne.pointerdblclick,{evt:j,target:this,currentTarget:this,pointerId:Wn}))}),ot||this._fire(ne.pointerup,{evt:j,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),i.Konva["_"+ye+"ListenClick"]=!1,j.cancelable&&ye!=="touch"&&ye!=="pointer"&&j.preventDefault()}_contextmenu(j){this.setPointersPositions(j);const ne=this.getIntersection(this.getPointerPosition());ne&&ne.isListening()?ne._fireAndBubble(B,{evt:j}):this._fire(B,{evt:j,target:this,currentTarget:this})}_wheel(j){this.setPointersPositions(j);const ne=this.getIntersection(this.getPointerPosition());ne&&ne.isListening()?ne._fireAndBubble(xe,{evt:j}):this._fire(xe,{evt:j,target:this,currentTarget:this})}_pointercancel(j){this.setPointersPositions(j);const ne=c.getCapturedShape(j.pointerId)||this.getIntersection(this.getPointerPosition());ne&&ne._fireAndBubble(D,c.createEvent(j)),c.releaseCapture(j.pointerId)}_lostpointercapture(j){c.releaseCapture(j.pointerId)}setPointersPositions(j){const ne=this._getContentPosition();let ye=null,Fe=null;j=j||window.event,j.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(j.touches,Ce=>{this._pointerPositions.push({id:Ce.identifier,x:(Ce.clientX-ne.left)/ne.scaleX,y:(Ce.clientY-ne.top)/ne.scaleY})}),Array.prototype.forEach.call(j.changedTouches||j.touches,Ce=>{this._changedPointerPositions.push({id:Ce.identifier,x:(Ce.clientX-ne.left)/ne.scaleX,y:(Ce.clientY-ne.top)/ne.scaleY})})):(ye=(j.clientX-ne.left)/ne.scaleX,Fe=(j.clientY-ne.top)/ne.scaleY,this.pointerPos={x:ye,y:Fe},this._pointerPositions=[{x:ye,y:Fe,id:e.Util._getFirstPointerId(j)}],this._changedPointerPositions=[{x:ye,y:Fe,id:e.Util._getFirstPointerId(j)}])}_setPointerPosition(j){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(j)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const j=this.content.getBoundingClientRect();return{top:j.top,left:j.left,scaleX:j.width/this.content.clientWidth||1,scaleY:j.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new s.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new s.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!i.Konva.isBrowser)return;const j=this.container();if(!j)throw"Stage has no container. A container is required.";j.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),j.appendChild(this.content),this._resizeDOM()}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(j){j.batchDraw()}),this}}n.Stage=ct,ct.prototype.nodeType=h,(0,l._registerNode)(ct),t.Factory.addGetterSetter(ct,"container"),i.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{n.stages.forEach(Qe=>{Qe.batchDraw()})})})(ax);var Rf={},dn={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Shape=n.shapes=void 0;const e=Oe,t=Vt,r=ze,i=At,s=Re,o=Oe,l=wa,c="hasShadow",h="shadowRGBA",p="patternImage",m="linearGradient",_="radialGradient";let S;function E(){return S||(S=t.Util.createCanvasElement().getContext("2d"),S)}n.shapes={};function x(b){const A=this.attrs.fillRule;A?b.fill(A):b.fill()}function M(b){b.stroke()}function R(b){const A=this.attrs.fillRule;A?b.fill(A):b.fill()}function P(b){b.stroke()}function v(){this._clearCache(c)}function k(){this._clearCache(h)}function D(){this._clearCache(p)}function O(){this._clearCache(m)}function N(){this._clearCache(_)}class C extends i.Node{constructor(A){super(A);let L;for(;L=t.Util.getRandomColor(),!(L&&!(L in n.shapes)););this.colorKey=L,n.shapes[L]=this}getContext(){return t.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return t.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(c,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(p,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const L=E().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(L&&L.setTransform){const B=new t.Transform;B.translate(this.fillPatternX(),this.fillPatternY()),B.rotate(e.Konva.getAngle(this.fillPatternRotation())),B.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),B.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const V=B.getMatrix(),he=typeof DOMMatrix>"u"?{a:V[0],b:V[1],c:V[2],d:V[3],e:V[4],f:V[5]}:new DOMMatrix(V);L.setTransform(he)}return L}}_getLinearGradient(){return this._getCache(m,this.__getLinearGradient)}__getLinearGradient(){const A=this.fillLinearGradientColorStops();if(A){const L=E(),B=this.fillLinearGradientStartPoint(),V=this.fillLinearGradientEndPoint(),he=L.createLinearGradient(B.x,B.y,V.x,V.y);for(let le=0;le<A.length;le+=2)he.addColorStop(A[le],A[le+1]);return he}}_getRadialGradient(){return this._getCache(_,this.__getRadialGradient)}__getRadialGradient(){const A=this.fillRadialGradientColorStops();if(A){const L=E(),B=this.fillRadialGradientStartPoint(),V=this.fillRadialGradientEndPoint(),he=L.createRadialGradient(B.x,B.y,this.fillRadialGradientStartRadius(),V.x,V.y,this.fillRadialGradientEndRadius());for(let le=0;le<A.length;le+=2)he.addColorStop(A[le],A[le+1]);return he}}getShadowRGBA(){return this._getCache(h,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const A=t.Util.colorToRGBA(this.shadowColor());if(A)return"rgba("+A.r+","+A.g+","+A.b+","+A.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const A=this.hitStrokeWidth();return A==="auto"?this.hasStroke():this.strokeEnabled()&&!!A}intersects(A){const L=this.getStage();if(!L)return!1;const B=L.bufferHitCanvas;return B.getContext().clear(),this.drawHit(B,void 0,!0),B.context.getImageData(Math.round(A.x),Math.round(A.y),1,1).data[3]>0}destroy(){return i.Node.prototype.destroy.call(this),delete n.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(A){var L;if(!((L=this.attrs.perfectDrawEnabled)!==null&&L!==void 0?L:!0))return!1;const V=A||this.hasFill(),he=this.hasStroke(),le=this.getAbsoluteOpacity()!==1;if(V&&he&&le)return!0;const Te=this.hasShadow(),xe=this.shadowForStrokeEnabled();return!!(V&&he&&Te&&xe)}setStrokeHitEnabled(A){t.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),A?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const A=this.size();return{x:this._centroid?-A.width/2:0,y:this._centroid?-A.height/2:0,width:A.width,height:A.height}}getClientRect(A={}){let L=!1,B=this.getParent();for(;B;){if(B.isCached()){L=!0;break}B=B.getParent()}const V=A.skipTransform,he=A.relativeTo||L&&this.getStage()||void 0,le=this.getSelfRect(),xe=!A.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,Y=le.width+xe,J=le.height+xe,X=!A.skipShadow&&this.hasShadow(),te=X?this.shadowOffsetX():0,ie=X?this.shadowOffsetY():0,se=Y+Math.abs(te),ft=J+Math.abs(ie),ct=X&&this.shadowBlur()||0,Qe=se+ct*2,j=ft+ct*2,ne={width:Qe,height:j,x:-(xe/2+ct)+Math.min(te,0)+le.x,y:-(xe/2+ct)+Math.min(ie,0)+le.y};return V?ne:this._transformedRect(ne,he)}drawScene(A,L,B){const V=this.getLayer(),he=A||V.getCanvas(),le=he.getContext(),Te=this._getCanvasCache(),xe=this.getSceneFunc(),Y=this.hasShadow();let J;const X=L===this;if(!this.isVisible()&&!X)return this;if(Te){le.save();const te=this.getAbsoluteTransform(L).getMatrix();return le.transform(te[0],te[1],te[2],te[3],te[4],te[5]),this._drawCachedSceneCanvas(le),le.restore(),this}if(!xe)return this;if(le.save(),this._useBufferCanvas()){J=this.getStage();const te=B||J.bufferCanvas,ie=te.getContext();ie.clear(),ie.save(),ie._applyLineJoin(this);const se=this.getAbsoluteTransform(L).getMatrix();ie.transform(se[0],se[1],se[2],se[3],se[4],se[5]),xe.call(this,ie,this),ie.restore();const ft=te.pixelRatio;Y&&le._applyShadow(this),le._applyOpacity(this),le._applyGlobalCompositeOperation(this),le.drawImage(te._canvas,te.x||0,te.y||0,te.width/ft,te.height/ft)}else{if(le._applyLineJoin(this),!X){const te=this.getAbsoluteTransform(L).getMatrix();le.transform(te[0],te[1],te[2],te[3],te[4],te[5]),le._applyOpacity(this),le._applyGlobalCompositeOperation(this)}Y&&le._applyShadow(this),xe.call(this,le,this)}return le.restore(),this}drawHit(A,L,B=!1){if(!this.shouldDrawHit(L,B))return this;const V=this.getLayer(),he=A||V.hitCanvas,le=he&&he.getContext(),Te=this.hitFunc()||this.sceneFunc(),xe=this._getCanvasCache(),Y=xe&&xe.hit;if(this.colorKey||t.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),Y){le.save();const X=this.getAbsoluteTransform(L).getMatrix();return le.transform(X[0],X[1],X[2],X[3],X[4],X[5]),this._drawCachedHitCanvas(le),le.restore(),this}if(!Te)return this;if(le.save(),le._applyLineJoin(this),!(this===L)){const X=this.getAbsoluteTransform(L).getMatrix();le.transform(X[0],X[1],X[2],X[3],X[4],X[5])}return Te.call(this,le,this),le.restore(),this}drawHitFromCache(A=0){const L=this._getCanvasCache(),B=this._getCachedSceneCanvas(),V=L.hit,he=V.getContext(),le=V.getWidth(),Te=V.getHeight();he.clear(),he.drawImage(B._canvas,0,0,le,Te);try{const xe=he.getImageData(0,0,le,Te),Y=xe.data,J=Y.length,X=t.Util._hexToRgb(this.colorKey);for(let te=0;te<J;te+=4)Y[te+3]>A?(Y[te]=X.r,Y[te+1]=X.g,Y[te+2]=X.b,Y[te+3]=255):Y[te+3]=0;he.putImageData(xe,0,0)}catch(xe){t.Util.error("Unable to draw hit graph from cached scene canvas. "+xe.message)}return this}hasPointerCapture(A){return l.hasPointerCapture(A,this)}setPointerCapture(A){l.setPointerCapture(A,this)}releaseCapture(A){l.releaseCapture(A,this)}}n.Shape=C,C.prototype._fillFunc=x,C.prototype._strokeFunc=M,C.prototype._fillFuncHit=R,C.prototype._strokeFuncHit=P,C.prototype._centroid=!1,C.prototype.nodeType="Shape",(0,o._registerNode)(C),C.prototype.eventListeners={},C.prototype.on.call(C.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",v),C.prototype.on.call(C.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",k),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",D),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",O),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",N),r.Factory.addGetterSetter(C,"stroke",void 0,(0,s.getStringOrGradientValidator)()),r.Factory.addGetterSetter(C,"strokeWidth",2,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillAfterStrokeEnabled",!1),r.Factory.addGetterSetter(C,"hitStrokeWidth","auto",(0,s.getNumberOrAutoValidator)()),r.Factory.addGetterSetter(C,"strokeHitEnabled",!0,(0,s.getBooleanValidator)()),r.Factory.addGetterSetter(C,"perfectDrawEnabled",!0,(0,s.getBooleanValidator)()),r.Factory.addGetterSetter(C,"shadowForStrokeEnabled",!0,(0,s.getBooleanValidator)()),r.Factory.addGetterSetter(C,"lineJoin"),r.Factory.addGetterSetter(C,"lineCap"),r.Factory.addGetterSetter(C,"sceneFunc"),r.Factory.addGetterSetter(C,"hitFunc"),r.Factory.addGetterSetter(C,"dash"),r.Factory.addGetterSetter(C,"dashOffset",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"shadowColor",void 0,(0,s.getStringValidator)()),r.Factory.addGetterSetter(C,"shadowBlur",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"shadowOpacity",1,(0,s.getNumberValidator)()),r.Factory.addComponentsGetterSetter(C,"shadowOffset",["x","y"]),r.Factory.addGetterSetter(C,"shadowOffsetX",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"shadowOffsetY",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillPatternImage"),r.Factory.addGetterSetter(C,"fill",void 0,(0,s.getStringOrGradientValidator)()),r.Factory.addGetterSetter(C,"fillPatternX",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillPatternY",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillLinearGradientColorStops"),r.Factory.addGetterSetter(C,"strokeLinearGradientColorStops"),r.Factory.addGetterSetter(C,"fillRadialGradientStartRadius",0),r.Factory.addGetterSetter(C,"fillRadialGradientEndRadius",0),r.Factory.addGetterSetter(C,"fillRadialGradientColorStops"),r.Factory.addGetterSetter(C,"fillPatternRepeat","repeat"),r.Factory.addGetterSetter(C,"fillEnabled",!0),r.Factory.addGetterSetter(C,"strokeEnabled",!0),r.Factory.addGetterSetter(C,"shadowEnabled",!0),r.Factory.addGetterSetter(C,"dashEnabled",!0),r.Factory.addGetterSetter(C,"strokeScaleEnabled",!0),r.Factory.addGetterSetter(C,"fillPriority","color"),r.Factory.addComponentsGetterSetter(C,"fillPatternOffset",["x","y"]),r.Factory.addGetterSetter(C,"fillPatternOffsetX",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillPatternOffsetY",0,(0,s.getNumberValidator)()),r.Factory.addComponentsGetterSetter(C,"fillPatternScale",["x","y"]),r.Factory.addGetterSetter(C,"fillPatternScaleX",1,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillPatternScaleY",1,(0,s.getNumberValidator)()),r.Factory.addComponentsGetterSetter(C,"fillLinearGradientStartPoint",["x","y"]),r.Factory.addComponentsGetterSetter(C,"strokeLinearGradientStartPoint",["x","y"]),r.Factory.addGetterSetter(C,"fillLinearGradientStartPointX",0),r.Factory.addGetterSetter(C,"strokeLinearGradientStartPointX",0),r.Factory.addGetterSetter(C,"fillLinearGradientStartPointY",0),r.Factory.addGetterSetter(C,"strokeLinearGradientStartPointY",0),r.Factory.addComponentsGetterSetter(C,"fillLinearGradientEndPoint",["x","y"]),r.Factory.addComponentsGetterSetter(C,"strokeLinearGradientEndPoint",["x","y"]),r.Factory.addGetterSetter(C,"fillLinearGradientEndPointX",0),r.Factory.addGetterSetter(C,"strokeLinearGradientEndPointX",0),r.Factory.addGetterSetter(C,"fillLinearGradientEndPointY",0),r.Factory.addGetterSetter(C,"strokeLinearGradientEndPointY",0),r.Factory.addComponentsGetterSetter(C,"fillRadialGradientStartPoint",["x","y"]),r.Factory.addGetterSetter(C,"fillRadialGradientStartPointX",0),r.Factory.addGetterSetter(C,"fillRadialGradientStartPointY",0),r.Factory.addComponentsGetterSetter(C,"fillRadialGradientEndPoint",["x","y"]),r.Factory.addGetterSetter(C,"fillRadialGradientEndPointX",0),r.Factory.addGetterSetter(C,"fillRadialGradientEndPointY",0),r.Factory.addGetterSetter(C,"fillPatternRotation",0),r.Factory.addGetterSetter(C,"fillRule",void 0,(0,s.getStringValidator)()),r.Factory.backCompat(C,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(dn);Object.defineProperty(Rf,"__esModule",{value:!0});Rf.Layer=void 0;const xs=Vt,Dv=xl,uu=At,wS=ze,_5=Mi,aj=Re,lj=dn,uj=Oe,cj="#",hj="beforeDraw",dj="draw",cx=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],fj=cx.length;let Nc=class extends Dv.Container{constructor(e){super(e),this.canvas=new _5.SceneCanvas,this.hitCanvas=new _5.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(e){return this.getContext().clear(e),this.getHitCanvas().getContext().clear(e),this}setZIndex(e){super.setZIndex(e);const t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),e<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[e+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){uu.Node.prototype.moveToTop.call(this);const e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!uu.Node.prototype.moveUp.call(this))return!1;const t=this.getStage();return!t||!t.content?!1:(t.content.removeChild(this.getNativeCanvasElement()),this.index<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[this.index+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(uu.Node.prototype.moveDown.call(this)){const e=this.getStage();if(e){const t=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),t[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(uu.Node.prototype.moveToBottom.call(this)){const e=this.getStage();if(e){const t=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),t[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const e=this.getNativeCanvasElement();return uu.Node.prototype.remove.call(this),e&&e.parentNode&&xs.Util._isInDocument(e)&&e.parentNode.removeChild(e),this}getStage(){return this.parent}setSize({width:e,height:t}){return this.canvas.setSize(e,t),this.hitCanvas.setSize(e,t),this._setSmoothEnabled(),this}_validateAdd(e){const t=e.getType();t!=="Group"&&t!=="Shape"&&xs.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(e){return e=e||{},e.width=e.width||this.getWidth(),e.height=e.height||this.getHeight(),e.x=e.x!==void 0?e.x:this.x(),e.y=e.y!==void 0?e.y:this.y(),uu.Node.prototype._toKonvaCanvas.call(this,e)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){xs.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){xs.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,xs.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(e){if(!this.isListening()||!this.isVisible())return null;let t=1,r=!1;for(;;){for(let i=0;i<fj;i++){const s=cx[i],o=this._getIntersection({x:e.x+s.x*t,y:e.y+s.y*t}),l=o.shape;if(l)return l;if(r=!!o.antialiased,!o.antialiased)break}if(r)t+=1;else return null}}_getIntersection(e){const t=this.hitCanvas.pixelRatio,r=this.hitCanvas.context.getImageData(Math.round(e.x*t),Math.round(e.y*t),1,1).data,i=r[3];if(i===255){const s=xs.Util._rgbToHex(r[0],r[1],r[2]),o=lj.shapes[cj+s];return o?{shape:o}:{antialiased:!0}}else if(i>0)return{antialiased:!0};return{}}drawScene(e,t,r){const i=this.getLayer(),s=e||i&&i.getCanvas();return this._fire(hj,{node:this}),this.clearBeforeDraw()&&s.getContext().clear(),Dv.Container.prototype.drawScene.call(this,s,t,r),this._fire(dj,{node:this}),this}drawHit(e,t){const r=this.getLayer(),i=e||r&&r.hitCanvas;return r&&r.clearBeforeDraw()&&r.getHitCanvas().getContext().clear(),Dv.Container.prototype.drawHit.call(this,i,t),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(e){xs.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(e)}getHitGraphEnabled(e){return xs.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const e=this.parent;!!this.hitCanvas._canvas.parentNode?e.content.removeChild(this.hitCanvas._canvas):e.content.appendChild(this.hitCanvas._canvas)}destroy(){return xs.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};Rf.Layer=Nc;Nc.prototype.nodeType="Layer";(0,uj._registerNode)(Nc);wS.Factory.addGetterSetter(Nc,"imageSmoothingEnabled",!0);wS.Factory.addGetterSetter(Nc,"clearBeforeDraw",!0);wS.Factory.addGetterSetter(Nc,"hitGraphEnabled",!0,(0,aj.getBooleanValidator)());var X0={};Object.defineProperty(X0,"__esModule",{value:!0});X0.FastLayer=void 0;const pj=Vt,gj=Rf,mj=Oe;class ES extends gj.Layer{constructor(e){super(e),this.listening(!1),pj.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}X0.FastLayer=ES;ES.prototype.nodeType="FastLayer";(0,mj._registerNode)(ES);var bc={};Object.defineProperty(bc,"__esModule",{value:!0});bc.Group=void 0;const _j=Vt,yj=xl,vj=Oe;let SS=class extends yj.Container{_validateAdd(e){const t=e.getType();t!=="Group"&&t!=="Shape"&&_j.Util.throw("You may only add groups and shapes to groups.")}};bc.Group=SS;SS.prototype.nodeType="Group";(0,vj._registerNode)(SS);var Dc={};Object.defineProperty(Dc,"__esModule",{value:!0});Dc.Animation=void 0;const Mv=Oe,y5=Vt,Ov=function(){return Mv.glob.performance&&Mv.glob.performance.now?function(){return Mv.glob.performance.now()}:function(){return new Date().getTime()}}();class is{constructor(e,t){this.id=is.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:Ov(),frameRate:0},this.func=e,this.setLayers(t)}setLayers(e){let t=[];return e&&(t=Array.isArray(e)?e:[e]),this.layers=t,this}getLayers(){return this.layers}addLayer(e){const t=this.layers,r=t.length;for(let i=0;i<r;i++)if(t[i]._id===e._id)return!1;return this.layers.push(e),!0}isRunning(){const t=is.animations,r=t.length;for(let i=0;i<r;i++)if(t[i].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=Ov(),is._addAnimation(this),this}stop(){return is._removeAnimation(this),this}_updateFrameObject(e){this.frame.timeDiff=e-this.frame.lastTime,this.frame.lastTime=e,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(e){this.animations.push(e),this._handleAnimation()}static _removeAnimation(e){const t=e.id,r=this.animations,i=r.length;for(let s=0;s<i;s++)if(r[s].id===t){this.animations.splice(s,1);break}}static _runFrames(){const e={},t=this.animations;for(let r=0;r<t.length;r++){const i=t[r],s=i.layers,o=i.func;i._updateFrameObject(Ov());const l=s.length;let c;if(o?c=o.call(i,i.frame)!==!1:c=!0,!!c)for(let h=0;h<l;h++){const p=s[h];p._id!==void 0&&(e[p._id]=p)}}for(const r in e)e.hasOwnProperty(r)&&e[r].batchDraw()}static _animationLoop(){const e=is;e.animations.length?(e._runFrames(),y5.Util.requestAnimFrame(e._animationLoop)):e.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,y5.Util.requestAnimFrame(this._animationLoop))}}Dc.Animation=is;is.animations=[];is.animIdCounter=0;is.animRunning=!1;var hx={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Easings=n.Tween=void 0;const e=Vt,t=Dc,r=At,i=Oe,s={node:1,duration:1,easing:1,onFinish:1,yoyo:1},o=1,l=2,c=3,h=["fill","stroke","shadowColor"];let p=0;class m{constructor(E,x,M,R,P,v,k){this.prop=E,this.propFunc=x,this.begin=R,this._pos=R,this.duration=v,this._change=0,this.prevPos=0,this.yoyo=k,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=M,this._change=P-this.begin,this.pause()}fire(E){const x=this[E];x&&x()}setTime(E){E>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():E<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=E,this.update())}getTime(){return this._time}setPosition(E){this.prevPos=this._pos,this.propFunc(E),this._pos=E}getPosition(E){return E===void 0&&(E=this._time),this.func(E,this.begin,this._change,this.duration)}play(){this.state=l,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=c,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(E){this.pause(),this._time=E,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const E=this.getTimer()-this._startTime;this.state===l?this.setTime(E):this.state===c&&this.setTime(this.duration-E)}pause(){this.state=o,this.fire("onPause")}getTimer(){return new Date().getTime()}}class _{constructor(E){const x=this,M=E.node,R=M._id,P=E.easing||n.Easings.Linear,v=!!E.yoyo;let k,D;typeof E.duration>"u"?k=.3:E.duration===0?k=.001:k=E.duration,this.node=M,this._id=p++;const O=M.getLayer()||(M instanceof i.Konva.Stage?M.getLayers():null);O||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new t.Animation(function(){x.tween.onEnterFrame()},O),this.tween=new m(D,function(N){x._tweenFunc(N)},P,0,1,k*1e3,v),this._addListeners(),_.attrs[R]||(_.attrs[R]={}),_.attrs[R][this._id]||(_.attrs[R][this._id]={}),_.tweens[R]||(_.tweens[R]={});for(D in E)s[D]===void 0&&this._addAttr(D,E[D]);this.reset(),this.onFinish=E.onFinish,this.onReset=E.onReset,this.onUpdate=E.onUpdate}_addAttr(E,x){const M=this.node,R=M._id;let P,v,k,D,O;const N=_.tweens[R][E];N&&delete _.attrs[R][N][E];let C=M.getAttr(E);if(e.Util._isArray(x))if(P=[],v=Math.max(x.length,C.length),E==="points"&&x.length!==C.length&&(x.length>C.length?(D=C,C=e.Util._prepareArrayForTween(C,x,M.closed())):(k=x,x=e.Util._prepareArrayForTween(x,C,M.closed()))),E.indexOf("fill")===0)for(let b=0;b<v;b++)if(b%2===0)P.push(x[b]-C[b]);else{const A=e.Util.colorToRGBA(C[b]);O=e.Util.colorToRGBA(x[b]),C[b]=A,P.push({r:O.r-A.r,g:O.g-A.g,b:O.b-A.b,a:O.a-A.a})}else for(let b=0;b<v;b++)P.push(x[b]-C[b]);else h.indexOf(E)!==-1?(C=e.Util.colorToRGBA(C),O=e.Util.colorToRGBA(x),P={r:O.r-C.r,g:O.g-C.g,b:O.b-C.b,a:O.a-C.a}):P=x-C;_.attrs[R][this._id][E]={start:C,diff:P,end:x,trueEnd:k,trueStart:D},_.tweens[R][E]=this._id}_tweenFunc(E){const x=this.node,M=_.attrs[x._id][this._id];let R,P,v,k,D,O,N,C;for(R in M){if(P=M[R],v=P.start,k=P.diff,C=P.end,e.Util._isArray(v))if(D=[],N=Math.max(v.length,C.length),R.indexOf("fill")===0)for(O=0;O<N;O++)O%2===0?D.push((v[O]||0)+k[O]*E):D.push("rgba("+Math.round(v[O].r+k[O].r*E)+","+Math.round(v[O].g+k[O].g*E)+","+Math.round(v[O].b+k[O].b*E)+","+(v[O].a+k[O].a*E)+")");else for(O=0;O<N;O++)D.push((v[O]||0)+k[O]*E);else h.indexOf(R)!==-1?D="rgba("+Math.round(v.r+k.r*E)+","+Math.round(v.g+k.g*E)+","+Math.round(v.b+k.b*E)+","+(v.a+k.a*E)+")":D=v+k*E;x.setAttr(R,D)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const E=this.node,x=_.attrs[E._id][this._id];x.points&&x.points.trueEnd&&E.setAttr("points",x.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const E=this.node,x=_.attrs[E._id][this._id];x.points&&x.points.trueStart&&E.points(x.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(E){return this.tween.seek(E*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const E=this.node._id,x=this._id,M=_.tweens[E];this.pause(),this.anim&&this.anim.stop();for(const R in M)delete _.tweens[E][R];delete _.attrs[E][x],_.tweens[E]&&(Object.keys(_.tweens[E]).length===0&&delete _.tweens[E],Object.keys(_.attrs[E]).length===0&&delete _.attrs[E])}}n.Tween=_,_.attrs={},_.tweens={},r.Node.prototype.to=function(S){const E=S.onFinish;S.node=this,S.onFinish=function(){this.destroy(),E&&E()},new _(S).play()},n.Easings={BackEaseIn(S,E,x,M){return x*(S/=M)*S*((1.70158+1)*S-1.70158)+E},BackEaseOut(S,E,x,M){return x*((S=S/M-1)*S*((1.70158+1)*S+1.70158)+1)+E},BackEaseInOut(S,E,x,M){let R=1.70158;return(S/=M/2)<1?x/2*(S*S*(((R*=1.525)+1)*S-R))+E:x/2*((S-=2)*S*(((R*=1.525)+1)*S+R)+2)+E},ElasticEaseIn(S,E,x,M,R,P){let v=0;return S===0?E:(S/=M)===1?E+x:(P||(P=M*.3),!R||R<Math.abs(x)?(R=x,v=P/4):v=P/(2*Math.PI)*Math.asin(x/R),-(R*Math.pow(2,10*(S-=1))*Math.sin((S*M-v)*(2*Math.PI)/P))+E)},ElasticEaseOut(S,E,x,M,R,P){let v=0;return S===0?E:(S/=M)===1?E+x:(P||(P=M*.3),!R||R<Math.abs(x)?(R=x,v=P/4):v=P/(2*Math.PI)*Math.asin(x/R),R*Math.pow(2,-10*S)*Math.sin((S*M-v)*(2*Math.PI)/P)+x+E)},ElasticEaseInOut(S,E,x,M,R,P){let v=0;return S===0?E:(S/=M/2)===2?E+x:(P||(P=M*(.3*1.5)),!R||R<Math.abs(x)?(R=x,v=P/4):v=P/(2*Math.PI)*Math.asin(x/R),S<1?-.5*(R*Math.pow(2,10*(S-=1))*Math.sin((S*M-v)*(2*Math.PI)/P))+E:R*Math.pow(2,-10*(S-=1))*Math.sin((S*M-v)*(2*Math.PI)/P)*.5+x+E)},BounceEaseOut(S,E,x,M){return(S/=M)<1/2.75?x*(7.5625*S*S)+E:S<2/2.75?x*(7.5625*(S-=1.5/2.75)*S+.75)+E:S<2.5/2.75?x*(7.5625*(S-=2.25/2.75)*S+.9375)+E:x*(7.5625*(S-=2.625/2.75)*S+.984375)+E},BounceEaseIn(S,E,x,M){return x-n.Easings.BounceEaseOut(M-S,0,x,M)+E},BounceEaseInOut(S,E,x,M){return S<M/2?n.Easings.BounceEaseIn(S*2,0,x,M)*.5+E:n.Easings.BounceEaseOut(S*2-M,0,x,M)*.5+x*.5+E},EaseIn(S,E,x,M){return x*(S/=M)*S+E},EaseOut(S,E,x,M){return-x*(S/=M)*(S-2)+E},EaseInOut(S,E,x,M){return(S/=M/2)<1?x/2*S*S+E:-x/2*(--S*(S-2)-1)+E},StrongEaseIn(S,E,x,M){return x*(S/=M)*S*S*S*S+E},StrongEaseOut(S,E,x,M){return x*((S=S/M-1)*S*S*S*S+1)+E},StrongEaseInOut(S,E,x,M){return(S/=M/2)<1?x/2*S*S*S*S*S+E:x/2*((S-=2)*S*S*S*S+2)+E},Linear(S,E,x,M){return x*S/M+E}}})(hx);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Konva=void 0;const e=Oe,t=Vt,r=At,i=xl,s=ax,o=Rf,l=X0,c=bc,h=Q0,p=dn,m=Dc,_=hx,S=Hs,E=Mi;n.Konva=t.Util._assign(e.Konva,{Util:t.Util,Transform:t.Transform,Node:r.Node,Container:i.Container,Stage:s.Stage,stages:s.stages,Layer:o.Layer,FastLayer:l.FastLayer,Group:c.Group,DD:h.DD,Shape:p.Shape,shapes:p.shapes,Animation:m.Animation,Tween:_.Tween,Easings:_.Easings,Context:S.Context,Canvas:E.Canvas}),n.default=n.Konva})(Vm);var J0={};Object.defineProperty(J0,"__esModule",{value:!0});J0.Arc=void 0;const Z0=ze,wj=dn,v5=Oe,e_=Re,Ej=Oe;class ao extends wj.Shape{_sceneFunc(e){const t=v5.Konva.getAngle(this.angle()),r=this.clockwise();e.beginPath(),e.arc(0,0,this.outerRadius(),0,t,r),e.arc(0,0,this.innerRadius(),t,0,!r),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}getSelfRect(){const e=this.innerRadius(),t=this.outerRadius(),r=this.clockwise(),i=v5.Konva.getAngle(r?360-this.angle():this.angle()),s=Math.cos(Math.min(i,Math.PI)),o=1,l=Math.sin(Math.min(Math.max(Math.PI,i),3*Math.PI/2)),c=Math.sin(Math.min(i,Math.PI/2)),h=s*(s>0?e:t),p=o*t,m=l*(l>0?e:t),_=c*(c>0?t:e);return{x:h,y:r?-1*_:m,width:p-h,height:_-m}}}J0.Arc=ao;ao.prototype._centroid=!0;ao.prototype.className="Arc";ao.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];(0,Ej._registerNode)(ao);Z0.Factory.addGetterSetter(ao,"innerRadius",0,(0,e_.getNumberValidator)());Z0.Factory.addGetterSetter(ao,"outerRadius",0,(0,e_.getNumberValidator)());Z0.Factory.addGetterSetter(ao,"angle",0,(0,e_.getNumberValidator)());Z0.Factory.addGetterSetter(ao,"clockwise",!1,(0,e_.getBooleanValidator)());var t_={},xf={};Object.defineProperty(xf,"__esModule",{value:!0});xf.Line=void 0;const n_=ze,Sj=Oe,Cj=dn,dx=Re;function b2(n,e,t,r,i,s,o){const l=Math.sqrt(Math.pow(t-n,2)+Math.pow(r-e,2)),c=Math.sqrt(Math.pow(i-t,2)+Math.pow(s-r,2)),h=o*l/(l+c),p=o*c/(l+c),m=t-h*(i-n),_=r-h*(s-e),S=t+p*(i-n),E=r+p*(s-e);return[m,_,S,E]}function w5(n,e){const t=n.length,r=[];for(let i=2;i<t-2;i+=2){const s=b2(n[i-2],n[i-1],n[i],n[i+1],n[i+2],n[i+3],e);isNaN(s[0])||(r.push(s[0]),r.push(s[1]),r.push(n[i]),r.push(n[i+1]),r.push(s[2]),r.push(s[3]))}return r}let Ea=class extends Cj.Shape{constructor(e){super(e),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(e){const t=this.points(),r=t.length,i=this.tension(),s=this.closed(),o=this.bezier();if(!r)return;let l=0;if(e.beginPath(),e.moveTo(t[0],t[1]),i!==0&&r>4){const c=this.getTensionPoints(),h=c.length;for(l=s?0:4,s||e.quadraticCurveTo(c[0],c[1],c[2],c[3]);l<h-2;)e.bezierCurveTo(c[l++],c[l++],c[l++],c[l++],c[l++],c[l++]);s||e.quadraticCurveTo(c[h-2],c[h-1],t[r-2],t[r-1])}else if(o)for(l=2;l<r;)e.bezierCurveTo(t[l++],t[l++],t[l++],t[l++],t[l++],t[l++]);else for(l=2;l<r;l+=2)e.lineTo(t[l],t[l+1]);s?(e.closePath(),e.fillStrokeShape(this)):e.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():w5(this.points(),this.tension())}_getTensionPointsClosed(){const e=this.points(),t=e.length,r=this.tension(),i=b2(e[t-2],e[t-1],e[0],e[1],e[2],e[3],r),s=b2(e[t-4],e[t-3],e[t-2],e[t-1],e[0],e[1],r),o=w5(e,r);return[i[2],i[3]].concat(o).concat([s[0],s[1],e[t-2],e[t-1],s[2],s[3],i[0],i[1],e[0],e[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let e=this.points();if(e.length<4)return{x:e[0]||0,y:e[1]||0,width:0,height:0};this.tension()!==0?e=[e[0],e[1],...this._getTensionPoints(),e[e.length-2],e[e.length-1]]:e=this.points();let t=e[0],r=e[0],i=e[1],s=e[1],o,l;for(let c=0;c<e.length/2;c++)o=e[c*2],l=e[c*2+1],t=Math.min(t,o),r=Math.max(r,o),i=Math.min(i,l),s=Math.max(s,l);return{x:t,y:i,width:r-t,height:s-i}}};xf.Line=Ea;Ea.prototype.className="Line";Ea.prototype._attrsAffectingSize=["points","bezier","tension"];(0,Sj._registerNode)(Ea);n_.Factory.addGetterSetter(Ea,"closed",!1);n_.Factory.addGetterSetter(Ea,"bezier",!1);n_.Factory.addGetterSetter(Ea,"tension",0,(0,dx.getNumberValidator)());n_.Factory.addGetterSetter(Ea,"points",[],(0,dx.getNumberArrayValidator)());var Mc={},fx={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.t2length=n.getQuadraticArcLength=n.getCubicArcLength=n.binomialCoefficients=n.cValues=n.tValues=void 0,n.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],n.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],n.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(o,l,c)=>{let h,p;const _=c/2;h=0;for(let S=0;S<20;S++)p=_*n.tValues[20][S]+_,h+=n.cValues[20][S]*r(o,l,p);return _*h};n.getCubicArcLength=e;const t=(o,l,c)=>{c===void 0&&(c=1);const h=o[0]-2*o[1]+o[2],p=l[0]-2*l[1]+l[2],m=2*o[1]-2*o[0],_=2*l[1]-2*l[0],S=4*(h*h+p*p),E=4*(h*m+p*_),x=m*m+_*_;if(S===0)return c*Math.sqrt(Math.pow(o[2]-o[0],2)+Math.pow(l[2]-l[0],2));const M=E/(2*S),R=x/S,P=c+M,v=R-M*M,k=P*P+v>0?Math.sqrt(P*P+v):0,D=M*M+v>0?Math.sqrt(M*M+v):0,O=M+Math.sqrt(M*M+v)!==0?v*Math.log(Math.abs((P+k)/(M+D))):0;return Math.sqrt(S)/2*(P*k-M*D+O)};n.getQuadraticArcLength=t;function r(o,l,c){const h=i(1,c,o),p=i(1,c,l),m=h*h+p*p;return Math.sqrt(m)}const i=(o,l,c)=>{const h=c.length-1;let p,m;if(h===0)return 0;if(o===0){m=0;for(let _=0;_<=h;_++)m+=n.binomialCoefficients[h][_]*Math.pow(1-l,h-_)*Math.pow(l,_)*c[_];return m}else{p=new Array(h);for(let _=0;_<h;_++)p[_]=h*(c[_+1]-c[_]);return i(o-1,l,p)}},s=(o,l,c)=>{let h=1,p=o/l,m=(o-c(p))/l,_=0;for(;h>.001;){const S=c(p+m),E=Math.abs(o-S)/l;if(E<h)h=E,p+=m;else{const x=c(p-m),M=Math.abs(o-x)/l;M<h?(h=M,p-=m):m/=2}if(_++,_>500)break}return p};n.t2length=s})(fx);Object.defineProperty(Mc,"__esModule",{value:!0});Mc.Path=void 0;const Tj=ze,Ij=Oe,kj=dn,cu=fx;class ln extends kj.Shape{constructor(e){super(e),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=ln.parsePathData(this.data()),this.pathLength=ln.getPathLength(this.dataArray)}_sceneFunc(e){const t=this.dataArray;e.beginPath();let r=!1;for(let i=0;i<t.length;i++){const s=t[i].command,o=t[i].points;switch(s){case"L":e.lineTo(o[0],o[1]);break;case"M":e.moveTo(o[0],o[1]);break;case"C":e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]);break;case"Q":e.quadraticCurveTo(o[0],o[1],o[2],o[3]);break;case"A":const l=o[0],c=o[1],h=o[2],p=o[3],m=o[4],_=o[5],S=o[6],E=o[7],x=h>p?h:p,M=h>p?1:h/p,R=h>p?p/h:1;e.translate(l,c),e.rotate(S),e.scale(M,R),e.arc(0,0,x,m,m+_,1-E),e.scale(1/M,1/R),e.rotate(-S),e.translate(-l,-c);break;case"z":r=!0,e.closePath();break}}!r&&!this.hasFill()?e.strokeShape(this):e.fillStrokeShape(this)}getSelfRect(){let e=[];this.dataArray.forEach(function(c){if(c.command==="A"){const h=c.points[4],p=c.points[5],m=c.points[4]+p;let _=Math.PI/180;if(Math.abs(h-m)<_&&(_=Math.abs(h-m)),p<0)for(let S=h-_;S>m;S-=_){const E=ln.getPointOnEllipticalArc(c.points[0],c.points[1],c.points[2],c.points[3],S,0);e.push(E.x,E.y)}else for(let S=h+_;S<m;S+=_){const E=ln.getPointOnEllipticalArc(c.points[0],c.points[1],c.points[2],c.points[3],S,0);e.push(E.x,E.y)}}else if(c.command==="C")for(let h=0;h<=1;h+=.01){const p=ln.getPointOnCubicBezier(h,c.start.x,c.start.y,c.points[0],c.points[1],c.points[2],c.points[3],c.points[4],c.points[5]);e.push(p.x,p.y)}else e=e.concat(c.points)});let t=e[0],r=e[0],i=e[1],s=e[1],o,l;for(let c=0;c<e.length/2;c++)o=e[c*2],l=e[c*2+1],isNaN(o)||(t=Math.min(t,o),r=Math.max(r,o)),isNaN(l)||(i=Math.min(i,l),s=Math.max(s,l));return{x:t,y:i,width:r-t,height:s-i}}getLength(){return this.pathLength}getPointAtLength(e){return ln.getPointAtLengthOfDataArray(e,this.dataArray)}static getLineLength(e,t,r,i){return Math.sqrt((r-e)*(r-e)+(i-t)*(i-t))}static getPathLength(e){let t=0;for(let r=0;r<e.length;++r)t+=e[r].pathLength;return t}static getPointAtLengthOfDataArray(e,t){let r,i=0,s=t.length;if(!s)return null;for(;i<s&&e>t[i].pathLength;)e-=t[i].pathLength,++i;if(i===s)return r=t[i-1].points.slice(-2),{x:r[0],y:r[1]};if(e<.01)return t[i].command==="M"?(r=t[i].points.slice(0,2),{x:r[0],y:r[1]}):{x:t[i].start.x,y:t[i].start.y};const o=t[i],l=o.points;switch(o.command){case"L":return ln.getPointOnLine(e,o.start.x,o.start.y,l[0],l[1]);case"C":return ln.getPointOnCubicBezier((0,cu.t2length)(e,ln.getPathLength(t),x=>(0,cu.getCubicArcLength)([o.start.x,l[0],l[2],l[4]],[o.start.y,l[1],l[3],l[5]],x)),o.start.x,o.start.y,l[0],l[1],l[2],l[3],l[4],l[5]);case"Q":return ln.getPointOnQuadraticBezier((0,cu.t2length)(e,ln.getPathLength(t),x=>(0,cu.getQuadraticArcLength)([o.start.x,l[0],l[2]],[o.start.y,l[1],l[3]],x)),o.start.x,o.start.y,l[0],l[1],l[2],l[3]);case"A":const c=l[0],h=l[1],p=l[2],m=l[3],_=l[5],S=l[6];let E=l[4];return E+=_*e/o.pathLength,ln.getPointOnEllipticalArc(c,h,p,m,E,S)}return null}static getPointOnLine(e,t,r,i,s,o,l){o=o??t,l=l??r;const c=this.getLineLength(t,r,i,s);if(c<1e-10)return{x:t,y:r};if(i===t)return{x:o,y:l+(s>r?e:-e)};const h=(s-r)/(i-t),p=Math.sqrt(e*e/(1+h*h))*(i<t?-1:1),m=h*p;if(Math.abs(l-r-h*(o-t))<1e-10)return{x:o+p,y:l+m};const _=((o-t)*(i-t)+(l-r)*(s-r))/(c*c),S=t+_*(i-t),E=r+_*(s-r),x=this.getLineLength(o,l,S,E),M=Math.sqrt(e*e-x*x),R=Math.sqrt(M*M/(1+h*h))*(i<t?-1:1),P=h*R;return{x:S+R,y:E+P}}static getPointOnCubicBezier(e,t,r,i,s,o,l,c,h){function p(M){return M*M*M}function m(M){return 3*M*M*(1-M)}function _(M){return 3*M*(1-M)*(1-M)}function S(M){return(1-M)*(1-M)*(1-M)}const E=c*p(e)+o*m(e)+i*_(e)+t*S(e),x=h*p(e)+l*m(e)+s*_(e)+r*S(e);return{x:E,y:x}}static getPointOnQuadraticBezier(e,t,r,i,s,o,l){function c(S){return S*S}function h(S){return 2*S*(1-S)}function p(S){return(1-S)*(1-S)}const m=o*c(e)+i*h(e)+t*p(e),_=l*c(e)+s*h(e)+r*p(e);return{x:m,y:_}}static getPointOnEllipticalArc(e,t,r,i,s,o){const l=Math.cos(o),c=Math.sin(o),h={x:r*Math.cos(s),y:i*Math.sin(s)};return{x:e+(h.x*l-h.y*c),y:t+(h.x*c+h.y*l)}}static parsePathData(e){if(!e)return[];let t=e;const r=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];t=t.replace(new RegExp(" ","g"),",");for(let m=0;m<r.length;m++)t=t.replace(new RegExp(r[m],"g"),"|"+r[m]);const i=t.split("|"),s=[],o=[];let l=0,c=0;const h=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let p;for(let m=1;m<i.length;m++){let _=i[m],S=_.charAt(0);for(_=_.slice(1),o.length=0;p=h.exec(_);)o.push(p[0]);const E=[];for(let x=0,M=o.length;x<M;x++){if(o[x]==="00"){E.push(0,0);continue}const R=parseFloat(o[x]);isNaN(R)?E.push(0):E.push(R)}for(;E.length>0&&!isNaN(E[0]);){let x="",M=[];const R=l,P=c;let v,k,D,O,N,C,b,A,L,B;switch(S){case"l":l+=E.shift(),c+=E.shift(),x="L",M.push(l,c);break;case"L":l=E.shift(),c=E.shift(),M.push(l,c);break;case"m":const V=E.shift(),he=E.shift();if(l+=V,c+=he,x="M",s.length>2&&s[s.length-1].command==="z"){for(let le=s.length-2;le>=0;le--)if(s[le].command==="M"){l=s[le].points[0]+V,c=s[le].points[1]+he;break}}M.push(l,c),S="l";break;case"M":l=E.shift(),c=E.shift(),x="M",M.push(l,c),S="L";break;case"h":l+=E.shift(),x="L",M.push(l,c);break;case"H":l=E.shift(),x="L",M.push(l,c);break;case"v":c+=E.shift(),x="L",M.push(l,c);break;case"V":c=E.shift(),x="L",M.push(l,c);break;case"C":M.push(E.shift(),E.shift(),E.shift(),E.shift()),l=E.shift(),c=E.shift(),M.push(l,c);break;case"c":M.push(l+E.shift(),c+E.shift(),l+E.shift(),c+E.shift()),l+=E.shift(),c+=E.shift(),x="C",M.push(l,c);break;case"S":k=l,D=c,v=s[s.length-1],v.command==="C"&&(k=l+(l-v.points[2]),D=c+(c-v.points[3])),M.push(k,D,E.shift(),E.shift()),l=E.shift(),c=E.shift(),x="C",M.push(l,c);break;case"s":k=l,D=c,v=s[s.length-1],v.command==="C"&&(k=l+(l-v.points[2]),D=c+(c-v.points[3])),M.push(k,D,l+E.shift(),c+E.shift()),l+=E.shift(),c+=E.shift(),x="C",M.push(l,c);break;case"Q":M.push(E.shift(),E.shift()),l=E.shift(),c=E.shift(),M.push(l,c);break;case"q":M.push(l+E.shift(),c+E.shift()),l+=E.shift(),c+=E.shift(),x="Q",M.push(l,c);break;case"T":k=l,D=c,v=s[s.length-1],v.command==="Q"&&(k=l+(l-v.points[0]),D=c+(c-v.points[1])),l=E.shift(),c=E.shift(),x="Q",M.push(k,D,l,c);break;case"t":k=l,D=c,v=s[s.length-1],v.command==="Q"&&(k=l+(l-v.points[0]),D=c+(c-v.points[1])),l+=E.shift(),c+=E.shift(),x="Q",M.push(k,D,l,c);break;case"A":O=E.shift(),N=E.shift(),C=E.shift(),b=E.shift(),A=E.shift(),L=l,B=c,l=E.shift(),c=E.shift(),x="A",M=this.convertEndpointToCenterParameterization(L,B,l,c,b,A,O,N,C);break;case"a":O=E.shift(),N=E.shift(),C=E.shift(),b=E.shift(),A=E.shift(),L=l,B=c,l+=E.shift(),c+=E.shift(),x="A",M=this.convertEndpointToCenterParameterization(L,B,l,c,b,A,O,N,C);break}s.push({command:x||S,points:M,start:{x:R,y:P},pathLength:this.calcLength(R,P,x||S,M)})}(S==="z"||S==="Z")&&s.push({command:"z",points:[],start:void 0,pathLength:0})}return s}static calcLength(e,t,r,i){let s,o,l,c;const h=ln;switch(r){case"L":return h.getLineLength(e,t,i[0],i[1]);case"C":return(0,cu.getCubicArcLength)([e,i[0],i[2],i[4]],[t,i[1],i[3],i[5]],1);case"Q":return(0,cu.getQuadraticArcLength)([e,i[0],i[2]],[t,i[1],i[3]],1);case"A":s=0;const p=i[4],m=i[5],_=i[4]+m;let S=Math.PI/180;if(Math.abs(p-_)<S&&(S=Math.abs(p-_)),o=h.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],p,0),m<0)for(c=p-S;c>_;c-=S)l=h.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],c,0),s+=h.getLineLength(o.x,o.y,l.x,l.y),o=l;else for(c=p+S;c<_;c+=S)l=h.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],c,0),s+=h.getLineLength(o.x,o.y,l.x,l.y),o=l;return l=h.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],_,0),s+=h.getLineLength(o.x,o.y,l.x,l.y),s}return 0}static convertEndpointToCenterParameterization(e,t,r,i,s,o,l,c,h){const p=h*(Math.PI/180),m=Math.cos(p)*(e-r)/2+Math.sin(p)*(t-i)/2,_=-1*Math.sin(p)*(e-r)/2+Math.cos(p)*(t-i)/2,S=m*m/(l*l)+_*_/(c*c);S>1&&(l*=Math.sqrt(S),c*=Math.sqrt(S));let E=Math.sqrt((l*l*(c*c)-l*l*(_*_)-c*c*(m*m))/(l*l*(_*_)+c*c*(m*m)));s===o&&(E*=-1),isNaN(E)&&(E=0);const x=E*l*_/c,M=E*-c*m/l,R=(e+r)/2+Math.cos(p)*x-Math.sin(p)*M,P=(t+i)/2+Math.sin(p)*x+Math.cos(p)*M,v=function(A){return Math.sqrt(A[0]*A[0]+A[1]*A[1])},k=function(A,L){return(A[0]*L[0]+A[1]*L[1])/(v(A)*v(L))},D=function(A,L){return(A[0]*L[1]<A[1]*L[0]?-1:1)*Math.acos(k(A,L))},O=D([1,0],[(m-x)/l,(_-M)/c]),N=[(m-x)/l,(_-M)/c],C=[(-1*m-x)/l,(-1*_-M)/c];let b=D(N,C);return k(N,C)<=-1&&(b=Math.PI),k(N,C)>=1&&(b=0),o===0&&b>0&&(b=b-2*Math.PI),o===1&&b<0&&(b=b+2*Math.PI),[R,P,l,c,O,b,p,o]}}Mc.Path=ln;ln.prototype.className="Path";ln.prototype._attrsAffectingSize=["data"];(0,Ij._registerNode)(ln);Tj.Factory.addGetterSetter(ln,"data");Object.defineProperty(t_,"__esModule",{value:!0});t_.Arrow=void 0;const r_=ze,Pj=xf,px=Re,Rj=Oe,E5=Mc;class Nl extends Pj.Line{_sceneFunc(e){super._sceneFunc(e);const t=Math.PI*2,r=this.points();let i=r;const s=this.tension()!==0&&r.length>4;s&&(i=this.getTensionPoints());const o=this.pointerLength(),l=r.length;let c,h;if(s){const _=[i[i.length-4],i[i.length-3],i[i.length-2],i[i.length-1],r[l-2],r[l-1]],S=E5.Path.calcLength(i[i.length-4],i[i.length-3],"C",_),E=E5.Path.getPointOnQuadraticBezier(Math.min(1,1-o/S),_[0],_[1],_[2],_[3],_[4],_[5]);c=r[l-2]-E.x,h=r[l-1]-E.y}else c=r[l-2]-r[l-4],h=r[l-1]-r[l-3];const p=(Math.atan2(h,c)+t)%t,m=this.pointerWidth();this.pointerAtEnding()&&(e.save(),e.beginPath(),e.translate(r[l-2],r[l-1]),e.rotate(p),e.moveTo(0,0),e.lineTo(-o,m/2),e.lineTo(-o,-m/2),e.closePath(),e.restore(),this.__fillStroke(e)),this.pointerAtBeginning()&&(e.save(),e.beginPath(),e.translate(r[0],r[1]),s?(c=(i[0]+i[2])/2-r[0],h=(i[1]+i[3])/2-r[1]):(c=r[2]-r[0],h=r[3]-r[1]),e.rotate((Math.atan2(-h,-c)+t)%t),e.moveTo(0,0),e.lineTo(-o,m/2),e.lineTo(-o,-m/2),e.closePath(),e.restore(),this.__fillStroke(e))}__fillStroke(e){const t=this.dashEnabled();t&&(this.attrs.dashEnabled=!1,e.setLineDash([])),e.fillStrokeShape(this),t&&(this.attrs.dashEnabled=!0)}getSelfRect(){const e=super.getSelfRect(),t=this.pointerWidth()/2;return{x:e.x,y:e.y-t,width:e.width,height:e.height+t*2}}}t_.Arrow=Nl;Nl.prototype.className="Arrow";(0,Rj._registerNode)(Nl);r_.Factory.addGetterSetter(Nl,"pointerLength",10,(0,px.getNumberValidator)());r_.Factory.addGetterSetter(Nl,"pointerWidth",10,(0,px.getNumberValidator)());r_.Factory.addGetterSetter(Nl,"pointerAtBeginning",!1);r_.Factory.addGetterSetter(Nl,"pointerAtEnding",!0);var i_={};Object.defineProperty(i_,"__esModule",{value:!0});i_.Circle=void 0;const xj=ze,Aj=dn,Nj=Re,bj=Oe;let Oc=class extends Aj.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius()!==e/2&&this.radius(e/2)}setHeight(e){this.radius()!==e/2&&this.radius(e/2)}};i_.Circle=Oc;Oc.prototype._centroid=!0;Oc.prototype.className="Circle";Oc.prototype._attrsAffectingSize=["radius"];(0,bj._registerNode)(Oc);xj.Factory.addGetterSetter(Oc,"radius",0,(0,Nj.getNumberValidator)());var s_={};Object.defineProperty(s_,"__esModule",{value:!0});s_.Ellipse=void 0;const CS=ze,Dj=dn,gx=Re,Mj=Oe;class Sa extends Dj.Shape{_sceneFunc(e){const t=this.radiusX(),r=this.radiusY();e.beginPath(),e.save(),t!==r&&e.scale(1,r/t),e.arc(0,0,t,0,Math.PI*2,!1),e.restore(),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(e){this.radiusX(e/2)}setHeight(e){this.radiusY(e/2)}}s_.Ellipse=Sa;Sa.prototype.className="Ellipse";Sa.prototype._centroid=!0;Sa.prototype._attrsAffectingSize=["radiusX","radiusY"];(0,Mj._registerNode)(Sa);CS.Factory.addComponentsGetterSetter(Sa,"radius",["x","y"]);CS.Factory.addGetterSetter(Sa,"radiusX",0,(0,gx.getNumberValidator)());CS.Factory.addGetterSetter(Sa,"radiusY",0,(0,gx.getNumberValidator)());var o_={};Object.defineProperty(o_,"__esModule",{value:!0});o_.Image=void 0;const Lv=Vt,bl=ze,Oj=dn,Lj=Oe,Af=Re;let ds=class mx extends Oj.Shape{constructor(e){super(e),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",t=>{this._removeImageLoad(t.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const e=this.image();e&&e.complete||e&&e.readyState===4||e&&e.addEventListener&&e.addEventListener("load",this._loadListener)}_removeImageLoad(e){e&&e.removeEventListener&&e.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const e=!!this.cornerRadius(),t=this.hasShadow();return e&&t?!0:super._useBufferCanvas(!0)}_sceneFunc(e){const t=this.getWidth(),r=this.getHeight(),i=this.cornerRadius(),s=this.attrs.image;let o;if(s){const l=this.attrs.cropWidth,c=this.attrs.cropHeight;l&&c?o=[s,this.cropX(),this.cropY(),l,c,0,0,t,r]:o=[s,0,0,t,r]}(this.hasFill()||this.hasStroke()||i)&&(e.beginPath(),i?Lv.Util.drawRoundedRectPath(e,t,r,i):e.rect(0,0,t,r),e.closePath(),e.fillStrokeShape(this)),s&&(i&&e.clip(),e.drawImage.apply(e,o))}_hitFunc(e){const t=this.width(),r=this.height(),i=this.cornerRadius();e.beginPath(),i?Lv.Util.drawRoundedRectPath(e,t,r,i):e.rect(0,0,t,r),e.closePath(),e.fillStrokeShape(this)}getWidth(){var e,t;return(e=this.attrs.width)!==null&&e!==void 0?e:(t=this.image())===null||t===void 0?void 0:t.width}getHeight(){var e,t;return(e=this.attrs.height)!==null&&e!==void 0?e:(t=this.image())===null||t===void 0?void 0:t.height}static fromURL(e,t,r=null){const i=Lv.Util.createImageElement();i.onload=function(){const s=new mx({image:i});t(s)},i.onerror=r,i.crossOrigin="Anonymous",i.src=e}};o_.Image=ds;ds.prototype.className="Image";(0,Lj._registerNode)(ds);bl.Factory.addGetterSetter(ds,"cornerRadius",0,(0,Af.getNumberOrArrayOfNumbersValidator)(4));bl.Factory.addGetterSetter(ds,"image");bl.Factory.addComponentsGetterSetter(ds,"crop",["x","y","width","height"]);bl.Factory.addGetterSetter(ds,"cropX",0,(0,Af.getNumberValidator)());bl.Factory.addGetterSetter(ds,"cropY",0,(0,Af.getNumberValidator)());bl.Factory.addGetterSetter(ds,"cropWidth",0,(0,Af.getNumberValidator)());bl.Factory.addGetterSetter(ds,"cropHeight",0,(0,Af.getNumberValidator)());var hc={};Object.defineProperty(hc,"__esModule",{value:!0});hc.Tag=hc.Label=void 0;const a_=ze,Fj=dn,Vj=bc,TS=Re,_x=Oe,yx=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],Uj="Change.konva",Bj="none",D2="up",M2="right",O2="down",L2="left",zj=yx.length;class IS extends Vj.Group{constructor(e){super(e),this.on("add.konva",function(t){this._addListeners(t.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(e){let t=this,r;const i=function(){t._sync()};for(r=0;r<zj;r++)e.on(yx[r]+Uj,i)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let e=this.getText(),t=this.getTag(),r,i,s,o,l,c,h;if(e&&t){switch(r=e.width(),i=e.height(),s=t.pointerDirection(),o=t.pointerWidth(),h=t.pointerHeight(),l=0,c=0,s){case D2:l=r/2,c=-1*h;break;case M2:l=r+o,c=i/2;break;case O2:l=r/2,c=i+h;break;case L2:l=-1*o,c=i/2;break}t.setAttrs({x:-1*l,y:-1*c,width:r,height:i}),e.setAttrs({x:-1*l,y:-1*c})}}}hc.Label=IS;IS.prototype.className="Label";(0,_x._registerNode)(IS);class Dl extends Fj.Shape{_sceneFunc(e){const t=this.width(),r=this.height(),i=this.pointerDirection(),s=this.pointerWidth(),o=this.pointerHeight(),l=this.cornerRadius();let c=0,h=0,p=0,m=0;typeof l=="number"?c=h=p=m=Math.min(l,t/2,r/2):(c=Math.min(l[0]||0,t/2,r/2),h=Math.min(l[1]||0,t/2,r/2),m=Math.min(l[2]||0,t/2,r/2),p=Math.min(l[3]||0,t/2,r/2)),e.beginPath(),e.moveTo(c,0),i===D2&&(e.lineTo((t-s)/2,0),e.lineTo(t/2,-1*o),e.lineTo((t+s)/2,0)),e.lineTo(t-h,0),e.arc(t-h,h,h,Math.PI*3/2,0,!1),i===M2&&(e.lineTo(t,(r-o)/2),e.lineTo(t+s,r/2),e.lineTo(t,(r+o)/2)),e.lineTo(t,r-m),e.arc(t-m,r-m,m,0,Math.PI/2,!1),i===O2&&(e.lineTo((t+s)/2,r),e.lineTo(t/2,r+o),e.lineTo((t-s)/2,r)),e.lineTo(p,r),e.arc(p,r-p,p,Math.PI/2,Math.PI,!1),i===L2&&(e.lineTo(0,(r+o)/2),e.lineTo(-1*s,r/2),e.lineTo(0,(r-o)/2)),e.lineTo(0,c),e.arc(c,c,c,Math.PI,Math.PI*3/2,!1),e.closePath(),e.fillStrokeShape(this)}getSelfRect(){let e=0,t=0,r=this.pointerWidth(),i=this.pointerHeight(),s=this.pointerDirection(),o=this.width(),l=this.height();return s===D2?(t-=i,l+=i):s===O2?l+=i:s===L2?(e-=r*1.5,o+=r):s===M2&&(o+=r*1.5),{x:e,y:t,width:o,height:l}}}hc.Tag=Dl;Dl.prototype.className="Tag";(0,_x._registerNode)(Dl);a_.Factory.addGetterSetter(Dl,"pointerDirection",Bj);a_.Factory.addGetterSetter(Dl,"pointerWidth",0,(0,TS.getNumberValidator)());a_.Factory.addGetterSetter(Dl,"pointerHeight",0,(0,TS.getNumberValidator)());a_.Factory.addGetterSetter(Dl,"cornerRadius",0,(0,TS.getNumberOrArrayOfNumbersValidator)(4));var Nf={};Object.defineProperty(Nf,"__esModule",{value:!0});Nf.Rect=void 0;const jj=ze,Gj=dn,Wj=Oe,Hj=Vt,$j=Re;let l_=class extends Gj.Shape{_sceneFunc(e){const t=this.cornerRadius(),r=this.width(),i=this.height();e.beginPath(),t?Hj.Util.drawRoundedRectPath(e,r,i,t):e.rect(0,0,r,i),e.closePath(),e.fillStrokeShape(this)}};Nf.Rect=l_;l_.prototype.className="Rect";(0,Wj._registerNode)(l_);jj.Factory.addGetterSetter(l_,"cornerRadius",0,(0,$j.getNumberOrArrayOfNumbersValidator)(4));var u_={};Object.defineProperty(u_,"__esModule",{value:!0});u_.RegularPolygon=void 0;const vx=ze,qj=dn,wx=Re,Kj=Oe;class Ml extends qj.Shape{_sceneFunc(e){const t=this._getPoints();e.beginPath(),e.moveTo(t[0].x,t[0].y);for(let r=1;r<t.length;r++)e.lineTo(t[r].x,t[r].y);e.closePath(),e.fillStrokeShape(this)}_getPoints(){const e=this.attrs.sides,t=this.attrs.radius||0,r=[];for(let i=0;i<e;i++)r.push({x:t*Math.sin(i*2*Math.PI/e),y:-1*t*Math.cos(i*2*Math.PI/e)});return r}getSelfRect(){const e=this._getPoints();let t=e[0].x,r=e[0].y,i=e[0].x,s=e[0].y;return e.forEach(o=>{t=Math.min(t,o.x),r=Math.max(r,o.x),i=Math.min(i,o.y),s=Math.max(s,o.y)}),{x:t,y:i,width:r-t,height:s-i}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}u_.RegularPolygon=Ml;Ml.prototype.className="RegularPolygon";Ml.prototype._centroid=!0;Ml.prototype._attrsAffectingSize=["radius"];(0,Kj._registerNode)(Ml);vx.Factory.addGetterSetter(Ml,"radius",0,(0,wx.getNumberValidator)());vx.Factory.addGetterSetter(Ml,"sides",0,(0,wx.getNumberValidator)());var c_={};Object.defineProperty(c_,"__esModule",{value:!0});c_.Ring=void 0;const Ex=ze,Qj=dn,Sx=Re,Yj=Oe,S5=Math.PI*2;class Ol extends Qj.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.innerRadius(),0,S5,!1),e.moveTo(this.outerRadius(),0),e.arc(0,0,this.outerRadius(),S5,0,!0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}c_.Ring=Ol;Ol.prototype.className="Ring";Ol.prototype._centroid=!0;Ol.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,Yj._registerNode)(Ol);Ex.Factory.addGetterSetter(Ol,"innerRadius",0,(0,Sx.getNumberValidator)());Ex.Factory.addGetterSetter(Ol,"outerRadius",0,(0,Sx.getNumberValidator)());var h_={};Object.defineProperty(h_,"__esModule",{value:!0});h_.Sprite=void 0;const Ll=ze,Xj=dn,Jj=Dc,Cx=Re,Zj=Oe;class fs extends Xj.Shape{constructor(e){super(e),this._updated=!0,this.anim=new Jj.Animation(()=>{const t=this._updated;return this._updated=!1,t}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(e){const t=this.animation(),r=this.frameIndex(),i=r*4,s=this.animations()[t],o=this.frameOffsets(),l=s[i+0],c=s[i+1],h=s[i+2],p=s[i+3],m=this.image();if((this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,h,p),e.closePath(),e.fillStrokeShape(this)),m)if(o){const _=o[t],S=r*2;e.drawImage(m,l,c,h,p,_[S+0],_[S+1],h,p)}else e.drawImage(m,l,c,h,p,0,0,h,p)}_hitFunc(e){const t=this.animation(),r=this.frameIndex(),i=r*4,s=this.animations()[t],o=this.frameOffsets(),l=s[i+2],c=s[i+3];if(e.beginPath(),o){const h=o[t],p=r*2;e.rect(h[p+0],h[p+1],l,c)}else e.rect(0,0,l,c);e.closePath(),e.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const e=this;this.interval=setInterval(function(){e._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const e=this.getLayer();this.anim.setLayers(e),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const e=this.frameIndex(),t=this.animation(),r=this.animations(),i=r[t],s=i.length/4;e<s-1?this.frameIndex(e+1):this.frameIndex(0)}}h_.Sprite=fs;fs.prototype.className="Sprite";(0,Zj._registerNode)(fs);Ll.Factory.addGetterSetter(fs,"animation");Ll.Factory.addGetterSetter(fs,"animations");Ll.Factory.addGetterSetter(fs,"frameOffsets");Ll.Factory.addGetterSetter(fs,"image");Ll.Factory.addGetterSetter(fs,"frameIndex",0,(0,Cx.getNumberValidator)());Ll.Factory.addGetterSetter(fs,"frameRate",17,(0,Cx.getNumberValidator)());Ll.Factory.backCompat(fs,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var d_={};Object.defineProperty(d_,"__esModule",{value:!0});d_.Star=void 0;const kS=ze,eG=dn,PS=Re,tG=Oe;class Ca extends eG.Shape{_sceneFunc(e){const t=this.innerRadius(),r=this.outerRadius(),i=this.numPoints();e.beginPath(),e.moveTo(0,0-r);for(let s=1;s<i*2;s++){const o=s%2===0?r:t,l=o*Math.sin(s*Math.PI/i),c=-1*o*Math.cos(s*Math.PI/i);e.lineTo(l,c)}e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}d_.Star=Ca;Ca.prototype.className="Star";Ca.prototype._centroid=!0;Ca.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,tG._registerNode)(Ca);kS.Factory.addGetterSetter(Ca,"numPoints",5,(0,PS.getNumberValidator)());kS.Factory.addGetterSetter(Ca,"innerRadius",0,(0,PS.getNumberValidator)());kS.Factory.addGetterSetter(Ca,"outerRadius",0,(0,PS.getNumberValidator)());var Lc={};Object.defineProperty(Lc,"__esModule",{value:!0});Lc.Text=void 0;Lc.stringToArray=Qa;const F2=Vt,hr=ze,nG=dn,Fv=Oe,Ta=Re,rG=Oe;function Qa(n){return[...n].reduce((e,t,r,i)=>{if(new RegExp("\\p{Emoji}","u").test(t)){const s=i[r+1];s&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(s)?(e.push(t+s),i[r+1]=""):e.push(t)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(t+(i[r+1]||""))?e.push(t+i[r+1]):r>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(t)?e[e.length-1]+=t:t&&e.push(t);return e},[])}const hu="auto",iG="center",Tx="inherit",Dh="justify",sG="Change.konva",oG="2d",C5="-",Ix="left",aG="text",lG="Text",uG="top",cG="bottom",T5="middle",kx="normal",hG="px ",og=" ",dG="right",I5="rtl",fG="word",pG="char",k5="none",Vv="",Px=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],gG=Px.length;function mG(n){return n.split(",").map(e=>{e=e.trim();const t=e.indexOf(" ")>=0,r=e.indexOf('"')>=0||e.indexOf("'")>=0;return t&&!r&&(e=`"${e}"`),e}).join(", ")}let ag;function Uv(){return ag||(ag=F2.Util.createCanvasElement().getContext(oG),ag)}function _G(n){n.fillText(this._partialText,this._partialTextX,this._partialTextY)}function yG(n){n.setAttr("miterLimit",2),n.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function vG(n){return n=n||{},!n.fillLinearGradientColorStops&&!n.fillRadialGradientColorStops&&!n.fillPatternImage&&(n.fill=n.fill||"black"),n}let Gt=class extends nG.Shape{constructor(e){super(vG(e)),this._partialTextX=0,this._partialTextY=0;for(let t=0;t<gG;t++)this.on(Px[t]+sG,this._setTextData);this._setTextData()}_sceneFunc(e){const t=this.textArr,r=t.length;if(!this.text())return;let i=this.padding(),s=this.fontSize(),o=this.lineHeight()*s,l=this.verticalAlign(),c=this.direction(),h=0,p=this.align(),m=this.getWidth(),_=this.letterSpacing(),S=this.fill(),E=this.textDecoration(),x=E.indexOf("underline")!==-1,M=E.indexOf("line-through")!==-1,R;c=c===Tx?e.direction:c;let P=o/2,v=T5;if(Fv.Konva._fixTextRendering){const k=this.measureSize("M");v="alphabetic",P=(k.fontBoundingBoxAscent-k.fontBoundingBoxDescent)/2+o/2}for(c===I5&&e.setAttr("direction",c),e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",v),e.setAttr("textAlign",Ix),l===T5?h=(this.getHeight()-r*o-i*2)/2:l===cG&&(h=this.getHeight()-r*o-i*2),e.translate(i,h+i),R=0;R<r;R++){let k=0,D=0;const O=t[R],N=O.text,C=O.width,b=O.lastInParagraph;if(e.save(),p===dG?k+=m-C-i*2:p===iG&&(k+=(m-C-i*2)/2),x){e.save(),e.beginPath();const A=Fv.Konva._fixTextRendering?Math.round(s/4):Math.round(s/2),L=k,B=P+D+A;e.moveTo(L,B);const V=p===Dh&&!b?m-i*2:C;e.lineTo(L+Math.round(V),B),e.lineWidth=s/15;const he=this._getLinearGradient();e.strokeStyle=he||S,e.stroke(),e.restore()}if(M){e.save(),e.beginPath();const A=Fv.Konva._fixTextRendering?-Math.round(s/4):0;e.moveTo(k,P+D+A);const L=p===Dh&&!b?m-i*2:C;e.lineTo(k+Math.round(L),P+D+A),e.lineWidth=s/15;const B=this._getLinearGradient();e.strokeStyle=B||S,e.stroke(),e.restore()}if(c!==I5&&(_!==0||p===Dh)){const A=N.split(" ").length-1,L=Qa(N);for(let B=0;B<L.length;B++){const V=L[B];V===" "&&!b&&p===Dh&&(k+=(m-i*2-C)/A),this._partialTextX=k,this._partialTextY=P+D,this._partialText=V,e.fillStrokeShape(this),k+=this.measureSize(V).width+_}}else _!==0&&e.setAttr("letterSpacing",`${_}px`),this._partialTextX=k,this._partialTextY=P+D,this._partialText=N,e.fillStrokeShape(this);e.restore(),r>1&&(P+=o)}}_hitFunc(e){const t=this.getWidth(),r=this.getHeight();e.beginPath(),e.rect(0,0,t,r),e.closePath(),e.fillStrokeShape(this)}setText(e){const t=F2.Util._isString(e)?e:e==null?"":e+"";return this._setAttr(aG,t),this}getWidth(){return this.attrs.width===hu||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===hu||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return F2.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(e){var t,r,i,s,o,l,c,h,p,m,_;let S=Uv(),E=this.fontSize(),x;S.save(),S.font=this._getContextFont(),x=S.measureText(e),S.restore();const M=E/100;return{actualBoundingBoxAscent:(t=x.actualBoundingBoxAscent)!==null&&t!==void 0?t:71.58203125*M,actualBoundingBoxDescent:(r=x.actualBoundingBoxDescent)!==null&&r!==void 0?r:0,actualBoundingBoxLeft:(i=x.actualBoundingBoxLeft)!==null&&i!==void 0?i:-7.421875*M,actualBoundingBoxRight:(s=x.actualBoundingBoxRight)!==null&&s!==void 0?s:75.732421875*M,alphabeticBaseline:(o=x.alphabeticBaseline)!==null&&o!==void 0?o:0,emHeightAscent:(l=x.emHeightAscent)!==null&&l!==void 0?l:100*M,emHeightDescent:(c=x.emHeightDescent)!==null&&c!==void 0?c:-20*M,fontBoundingBoxAscent:(h=x.fontBoundingBoxAscent)!==null&&h!==void 0?h:91*M,fontBoundingBoxDescent:(p=x.fontBoundingBoxDescent)!==null&&p!==void 0?p:21*M,hangingBaseline:(m=x.hangingBaseline)!==null&&m!==void 0?m:72.80000305175781*M,ideographicBaseline:(_=x.ideographicBaseline)!==null&&_!==void 0?_:-21*M,width:x.width,height:E}}_getContextFont(){return this.fontStyle()+og+this.fontVariant()+og+(this.fontSize()+hG)+mG(this.fontFamily())}_addTextLine(e){this.align()===Dh&&(e=e.trim());const r=this._getTextWidth(e);return this.textArr.push({text:e,width:r,lastInParagraph:!1})}_getTextWidth(e){const t=this.letterSpacing(),r=e.length;return Uv().measureText(e).width+t*r}_setTextData(){let e=this.text().split(`
`),t=+this.fontSize(),r=0,i=this.lineHeight()*t,s=this.attrs.width,o=this.attrs.height,l=s!==hu&&s!==void 0,c=o!==hu&&o!==void 0,h=this.padding(),p=s-h*2,m=o-h*2,_=0,S=this.wrap(),E=S!==k5,x=S!==pG&&E,M=this.ellipsis();this.textArr=[],Uv().font=this._getContextFont();const R=M?this._getTextWidth(Vv):0;for(let P=0,v=e.length;P<v;++P){let k=e[P],D=this._getTextWidth(k);if(l&&D>p)for(;k.length>0;){let O=0,N=Qa(k).length,C="",b=0;for(;O<N;){const A=O+N>>>1,L=Qa(k),B=L.slice(0,A+1).join(""),V=this._getTextWidth(B);(M&&c&&_+i>m?V+R:V)<=p?(O=A+1,C=B,b=V):N=A}if(C){if(x){const B=Qa(k),V=Qa(C),he=B[V.length],le=he===og||he===C5;let Te;if(le&&b<=p)Te=V.length;else{const xe=V.lastIndexOf(og),Y=V.lastIndexOf(C5);Te=Math.max(xe,Y)+1}Te>0&&(O=Te,C=B.slice(0,O).join(""),b=this._getTextWidth(C))}if(C=C.trimRight(),this._addTextLine(C),r=Math.max(r,b),_+=i,this._shouldHandleEllipsis(_)){this._tryToAddEllipsisToLastLine();break}if(k=Qa(k).slice(O).join("").trimLeft(),k.length>0&&(D=this._getTextWidth(k),D<=p)){this._addTextLine(k),_+=i,r=Math.max(r,D);break}}else break}else this._addTextLine(k),_+=i,r=Math.max(r,D),this._shouldHandleEllipsis(_)&&P<v-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),c&&_+i>m)break}this.textHeight=t,this.textWidth=r}_shouldHandleEllipsis(e){const t=+this.fontSize(),r=this.lineHeight()*t,i=this.attrs.height,s=i!==hu&&i!==void 0,o=this.padding(),l=i-o*2;return!(this.wrap()!==k5)||s&&e+r>l}_tryToAddEllipsisToLastLine(){const e=this.attrs.width,t=e!==hu&&e!==void 0,r=this.padding(),i=e-r*2,s=this.ellipsis(),o=this.textArr[this.textArr.length-1];!o||!s||(t&&(this._getTextWidth(o.text+Vv)<i||(o.text=o.text.slice(0,o.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(o.text+Vv))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const e=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,t=this.hasShadow();return e&&t?!0:super._useBufferCanvas()}};Lc.Text=Gt;Gt.prototype._fillFunc=_G;Gt.prototype._strokeFunc=yG;Gt.prototype.className=lG;Gt.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];(0,rG._registerNode)(Gt);hr.Factory.overWriteSetter(Gt,"width",(0,Ta.getNumberOrAutoValidator)());hr.Factory.overWriteSetter(Gt,"height",(0,Ta.getNumberOrAutoValidator)());hr.Factory.addGetterSetter(Gt,"direction",Tx);hr.Factory.addGetterSetter(Gt,"fontFamily","Arial");hr.Factory.addGetterSetter(Gt,"fontSize",12,(0,Ta.getNumberValidator)());hr.Factory.addGetterSetter(Gt,"fontStyle",kx);hr.Factory.addGetterSetter(Gt,"fontVariant",kx);hr.Factory.addGetterSetter(Gt,"padding",0,(0,Ta.getNumberValidator)());hr.Factory.addGetterSetter(Gt,"align",Ix);hr.Factory.addGetterSetter(Gt,"verticalAlign",uG);hr.Factory.addGetterSetter(Gt,"lineHeight",1,(0,Ta.getNumberValidator)());hr.Factory.addGetterSetter(Gt,"wrap",fG);hr.Factory.addGetterSetter(Gt,"ellipsis",!1,(0,Ta.getBooleanValidator)());hr.Factory.addGetterSetter(Gt,"letterSpacing",0,(0,Ta.getNumberValidator)());hr.Factory.addGetterSetter(Gt,"text","",(0,Ta.getStringValidator)());hr.Factory.addGetterSetter(Gt,"textDecoration","");var f_={};Object.defineProperty(f_,"__esModule",{value:!0});f_.TextPath=void 0;const Bv=Vt,Vi=ze,wG=dn,Mh=Mc,zv=Lc,Rx=Re,EG=Oe,SG="",xx="normal";function Ax(n){n.fillText(this.partialText,0,0)}function Nx(n){n.strokeText(this.partialText,0,0)}class fn extends wG.Shape{constructor(e){super(e),this.dummyCanvas=Bv.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return Mh.Path.getPathLength(this.dataArray)}_getPointAtLength(e){if(!this.attrs.data)return null;const t=this.pathLength;return e-1>t?null:Mh.Path.getPointAtLengthOfDataArray(e,this.dataArray)}_readDataAttribute(){this.dataArray=Mh.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(e){e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",this.textBaseline()),e.setAttr("textAlign","left"),e.save();const t=this.textDecoration(),r=this.fill(),i=this.fontSize(),s=this.glyphInfo;t==="underline"&&e.beginPath();for(let o=0;o<s.length;o++){e.save();const l=s[o].p0;e.translate(l.x,l.y),e.rotate(s[o].rotation),this.partialText=s[o].text,e.fillStrokeShape(this),t==="underline"&&(o===0&&e.moveTo(0,i/2+1),e.lineTo(i,i/2+1)),e.restore()}t==="underline"&&(e.strokeStyle=r,e.lineWidth=i/20,e.stroke()),e.restore()}_hitFunc(e){e.beginPath();const t=this.glyphInfo;if(t.length>=1){const r=t[0].p0;e.moveTo(r.x,r.y)}for(let r=0;r<t.length;r++){const i=t[r].p1;e.lineTo(i.x,i.y)}e.setAttr("lineWidth",this.fontSize()),e.setAttr("strokeStyle",this.colorKey),e.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return Bv.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(e){return zv.Text.prototype.setText.call(this,e)}_getContextFont(){return zv.Text.prototype._getContextFont.call(this)}_getTextSize(e){const r=this.dummyCanvas.getContext("2d");r.save(),r.font=this._getContextFont();const i=r.measureText(e);return r.restore(),{width:i.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:e,height:t}=this._getTextSize(this.attrs.text);if(this.textWidth=e,this.textHeight=t,this.glyphInfo=[],!this.attrs.data)return null;const r=this.letterSpacing(),i=this.align(),s=this.kerningFunc(),o=Math.max(this.textWidth+((this.attrs.text||"").length-1)*r,0);let l=0;i==="center"&&(l=Math.max(0,this.pathLength/2-o/2)),i==="right"&&(l=Math.max(0,this.pathLength-o));const c=(0,zv.stringToArray)(this.text());let h=l;for(let p=0;p<c.length;p++){const m=this._getPointAtLength(h);if(!m)return;let _=this._getTextSize(c[p]).width+r;if(c[p]===" "&&i==="justify"){const P=this.text().split(" ").length-1;_+=(this.pathLength-o)/P}const S=this._getPointAtLength(h+_);if(!S)return;const E=Mh.Path.getLineLength(m.x,m.y,S.x,S.y);let x=0;if(s)try{x=s(c[p-1],c[p])*this.fontSize()}catch{x=0}m.x+=x,S.x+=x,this.textWidth+=x;const M=Mh.Path.getPointOnLine(x+E/2,m.x,m.y,S.x,S.y),R=Math.atan2(S.y-m.y,S.x-m.x);this.glyphInfo.push({transposeX:M.x,transposeY:M.y,text:c[p],rotation:R,p0:m,p1:S}),h+=_}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const e=[];this.glyphInfo.forEach(function(h){e.push(h.p0.x),e.push(h.p0.y),e.push(h.p1.x),e.push(h.p1.y)});let t=e[0]||0,r=e[0]||0,i=e[1]||0,s=e[1]||0,o,l;for(let h=0;h<e.length/2;h++)o=e[h*2],l=e[h*2+1],t=Math.min(t,o),r=Math.max(r,o),i=Math.min(i,l),s=Math.max(s,l);const c=this.fontSize();return{x:t-c/2,y:i-c/2,width:r-t+c,height:s-i+c}}destroy(){return Bv.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}f_.TextPath=fn;fn.prototype._fillFunc=Ax;fn.prototype._strokeFunc=Nx;fn.prototype._fillFuncHit=Ax;fn.prototype._strokeFuncHit=Nx;fn.prototype.className="TextPath";fn.prototype._attrsAffectingSize=["text","fontSize","data"];(0,EG._registerNode)(fn);Vi.Factory.addGetterSetter(fn,"data");Vi.Factory.addGetterSetter(fn,"fontFamily","Arial");Vi.Factory.addGetterSetter(fn,"fontSize",12,(0,Rx.getNumberValidator)());Vi.Factory.addGetterSetter(fn,"fontStyle",xx);Vi.Factory.addGetterSetter(fn,"align","left");Vi.Factory.addGetterSetter(fn,"letterSpacing",0,(0,Rx.getNumberValidator)());Vi.Factory.addGetterSetter(fn,"textBaseline","middle");Vi.Factory.addGetterSetter(fn,"fontVariant",xx);Vi.Factory.addGetterSetter(fn,"text",SG);Vi.Factory.addGetterSetter(fn,"textDecoration","");Vi.Factory.addGetterSetter(fn,"kerningFunc",void 0);var p_={};Object.defineProperty(p_,"__esModule",{value:!0});p_.Transformer=void 0;const mt=Vt,lt=ze,P5=At,CG=dn,TG=Nf,R5=bc,Ci=Oe,Ia=Re,IG=Oe,bx="tr-konva",kG=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(n=>n+`.${bx}`).join(" "),x5="nodesRect",PG=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],RG={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},xG="ontouchstart"in Ci.Konva._global;function AG(n,e,t){if(n==="rotater")return t;e+=mt.Util.degToRad(RG[n]||0);const r=(mt.Util.radToDeg(e)%360+360)%360;return mt.Util._inRange(r,315+22.5,360)||mt.Util._inRange(r,0,22.5)?"ns-resize":mt.Util._inRange(r,45-22.5,45+22.5)?"nesw-resize":mt.Util._inRange(r,90-22.5,90+22.5)?"ew-resize":mt.Util._inRange(r,135-22.5,135+22.5)?"nwse-resize":mt.Util._inRange(r,180-22.5,180+22.5)?"ns-resize":mt.Util._inRange(r,225-22.5,225+22.5)?"nesw-resize":mt.Util._inRange(r,270-22.5,270+22.5)?"ew-resize":mt.Util._inRange(r,315-22.5,315+22.5)?"nwse-resize":(mt.Util.error("Transformer has unknown angle for cursor detection: "+r),"pointer")}const Bm=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function NG(n){return{x:n.x+n.width/2*Math.cos(n.rotation)+n.height/2*Math.sin(-n.rotation),y:n.y+n.height/2*Math.cos(n.rotation)+n.width/2*Math.sin(n.rotation)}}function Dx(n,e,t){const r=t.x+(n.x-t.x)*Math.cos(e)-(n.y-t.y)*Math.sin(e),i=t.y+(n.x-t.x)*Math.sin(e)+(n.y-t.y)*Math.cos(e);return{...n,rotation:n.rotation+e,x:r,y:i}}function bG(n,e){const t=NG(n);return Dx(n,e,t)}function DG(n,e,t){let r=e;for(let i=0;i<n.length;i++){const s=Ci.Konva.getAngle(n[i]),o=Math.abs(s-e)%(Math.PI*2);Math.min(o,Math.PI*2-o)<t&&(r=s)}return r}let V2=0,Ke=class extends R5.Group{constructor(e){super(e),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(kG,this.update),this.getNode()&&this.update()}attachTo(e){return this.setNode(e),this}setNode(e){return mt.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([e])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return bx+this._id}setNodes(e=[]){this._nodes&&this._nodes.length&&this.detach();const t=e.filter(i=>i.isAncestorOf(this)?(mt.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=e=t,e.length===1&&this.useSingleNodeRotation()?this.rotation(e[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(i=>{const s=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(i._attrsAffectingSize.length){const o=i._attrsAffectingSize.map(l=>l+"Change."+this._getEventNamespace()).join(" ");i.on(o,s)}i.on(PG.map(o=>o+`.${this._getEventNamespace()}`).join(" "),s),i.on(`absoluteTransformChange.${this._getEventNamespace()}`,s),this._proxyDrag(i)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(e){let t;e.on(`dragstart.${this._getEventNamespace()}`,r=>{t=e.getAbsolutePosition(),!this.isDragging()&&e!==this.findOne(".back")&&this.startDrag(r,!1)}),e.on(`dragmove.${this._getEventNamespace()}`,r=>{if(!t)return;const i=e.getAbsolutePosition(),s=i.x-t.x,o=i.y-t.y;this.nodes().forEach(l=>{if(l===e||l.isDragging())return;const c=l.getAbsolutePosition();l.setAbsolutePosition({x:c.x+s,y:c.y+o}),l.startDrag(r)}),t=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(e=>{e.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(x5),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(x5,this.__getNodeRect)}__getNodeShape(e,t=this.rotation(),r){const i=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),s=e.getAbsoluteScale(r),o=e.getAbsolutePosition(r),l=i.x*s.x-e.offsetX()*s.x,c=i.y*s.y-e.offsetY()*s.y,h=(Ci.Konva.getAngle(e.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),p={x:o.x+l*Math.cos(h)+c*Math.sin(-h),y:o.y+c*Math.cos(h)+l*Math.sin(h),width:i.width*s.x,height:i.height*s.y,rotation:h};return Dx(p,-Ci.Konva.getAngle(t),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const t=[];this.nodes().map(h=>{const p=h.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),m=[{x:p.x,y:p.y},{x:p.x+p.width,y:p.y},{x:p.x+p.width,y:p.y+p.height},{x:p.x,y:p.y+p.height}],_=h.getAbsoluteTransform();m.forEach(function(S){const E=_.point(S);t.push(E)})});const r=new mt.Transform;r.rotate(-Ci.Konva.getAngle(this.rotation()));let i=1/0,s=1/0,o=-1/0,l=-1/0;t.forEach(function(h){const p=r.point(h);i===void 0&&(i=o=p.x,s=l=p.y),i=Math.min(i,p.x),s=Math.min(s,p.y),o=Math.max(o,p.x),l=Math.max(l,p.y)}),r.invert();const c=r.point({x:i,y:s});return{x:c.x,y:c.y,width:o-i,height:l-s,rotation:Ci.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),Bm.forEach(e=>{this._createAnchor(e)}),this._createAnchor("rotater")}_createAnchor(e){const t=new TG.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:e+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:xG?10:"auto"}),r=this;t.on("mousedown touchstart",function(i){r._handleMouseDown(i)}),t.on("dragstart",i=>{t.stopDrag(),i.cancelBubble=!0}),t.on("dragend",i=>{i.cancelBubble=!0}),t.on("mouseenter",()=>{const i=Ci.Konva.getAngle(this.rotation()),s=this.rotateAnchorCursor(),o=AG(e,i,s);t.getStage().content&&(t.getStage().content.style.cursor=o),this._cursorChange=!0}),t.on("mouseout",()=>{t.getStage().content&&(t.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(t)}_createBack(){const e=new CG.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(t,r){const i=r.getParent(),s=i.padding();t.beginPath(),t.rect(-s,-s,r.width()+s*2,r.height()+s*2),t.moveTo(r.width()/2,-s),i.rotateEnabled()&&i.rotateLineVisible()&&t.lineTo(r.width()/2,-i.rotateAnchorOffset()*mt.Util._sign(r.height())-s),t.fillStrokeShape(r)},hitFunc:(t,r)=>{if(!this.shouldOverdrawWholeArea())return;const i=this.padding();t.beginPath(),t.rect(-i,-i,r.width()+i*2,r.height()+i*2),t.fillStrokeShape(r)}});this.add(e),this._proxyDrag(e),e.on("dragstart",t=>{t.cancelBubble=!0}),e.on("dragmove",t=>{t.cancelBubble=!0}),e.on("dragend",t=>{t.cancelBubble=!0}),this.on("dragmove",t=>{this.update()})}_handleMouseDown(e){if(this._transforming)return;this._movingAnchorName=e.target.name().split(" ")[0];const t=this._getNodeRect(),r=t.width,i=t.height,s=Math.sqrt(Math.pow(r,2)+Math.pow(i,2));this.sin=Math.abs(i/s),this.cos=Math.abs(r/s),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const o=e.target.getAbsolutePosition(),l=e.target.getStage().getPointerPosition();this._anchorDragOffset={x:l.x-o.x,y:l.y-o.y},V2++,this._fire("transformstart",{evt:e.evt,target:this.getNode()}),this._nodes.forEach(c=>{c._fire("transformstart",{evt:e.evt,target:c})})}_handleMouseMove(e){let t,r,i;const s=this.findOne("."+this._movingAnchorName),o=s.getStage();o.setPointersPositions(e);const l=o.getPointerPosition();let c={x:l.x-this._anchorDragOffset.x,y:l.y-this._anchorDragOffset.y};const h=s.getAbsolutePosition();this.anchorDragBoundFunc()&&(c=this.anchorDragBoundFunc()(h,c,e)),s.setAbsolutePosition(c);const p=s.getAbsolutePosition();if(h.x===p.x&&h.y===p.y)return;if(this._movingAnchorName==="rotater"){const P=this._getNodeRect();t=s.x()-P.width/2,r=-s.y()+P.height/2;let v=Math.atan2(-r,t)+Math.PI/2;P.height<0&&(v-=Math.PI);const D=Ci.Konva.getAngle(this.rotation())+v,O=Ci.Konva.getAngle(this.rotationSnapTolerance()),C=DG(this.rotationSnaps(),D,O)-P.rotation,b=bG(P,C);this._fitNodesInto(b,e);return}const m=this.shiftBehavior();let _;m==="inverted"?_=this.keepRatio()&&!e.shiftKey:m==="none"?_=this.keepRatio():_=this.keepRatio()||e.shiftKey;let S=this.centeredScaling()||e.altKey;if(this._movingAnchorName==="top-left"){if(_){const P=S?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};i=Math.sqrt(Math.pow(P.x-s.x(),2)+Math.pow(P.y-s.y(),2));const v=this.findOne(".top-left").x()>P.x?-1:1,k=this.findOne(".top-left").y()>P.y?-1:1;t=i*this.cos*v,r=i*this.sin*k,this.findOne(".top-left").x(P.x-t),this.findOne(".top-left").y(P.y-r)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(s.y());else if(this._movingAnchorName==="top-right"){if(_){const P=S?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};i=Math.sqrt(Math.pow(s.x()-P.x,2)+Math.pow(P.y-s.y(),2));const v=this.findOne(".top-right").x()<P.x?-1:1,k=this.findOne(".top-right").y()>P.y?-1:1;t=i*this.cos*v,r=i*this.sin*k,this.findOne(".top-right").x(P.x+t),this.findOne(".top-right").y(P.y-r)}var E=s.position();this.findOne(".top-left").y(E.y),this.findOne(".bottom-right").x(E.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(s.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(s.x());else if(this._movingAnchorName==="bottom-left"){if(_){const P=S?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};i=Math.sqrt(Math.pow(P.x-s.x(),2)+Math.pow(s.y()-P.y,2));const v=P.x<s.x()?-1:1,k=s.y()<P.y?-1:1;t=i*this.cos*v,r=i*this.sin*k,s.x(P.x-t),s.y(P.y+r)}E=s.position(),this.findOne(".top-left").x(E.x),this.findOne(".bottom-right").y(E.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(s.y());else if(this._movingAnchorName==="bottom-right"){if(_){const P=S?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};i=Math.sqrt(Math.pow(s.x()-P.x,2)+Math.pow(s.y()-P.y,2));const v=this.findOne(".bottom-right").x()<P.x?-1:1,k=this.findOne(".bottom-right").y()<P.y?-1:1;t=i*this.cos*v,r=i*this.sin*k,this.findOne(".bottom-right").x(P.x+t),this.findOne(".bottom-right").y(P.y+r)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(S=this.centeredScaling()||e.altKey,S){const P=this.findOne(".top-left"),v=this.findOne(".bottom-right"),k=P.x(),D=P.y(),O=this.getWidth()-v.x(),N=this.getHeight()-v.y();v.move({x:-k,y:-D}),P.move({x:O,y:N})}const x=this.findOne(".top-left").getAbsolutePosition();t=x.x,r=x.y;const M=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),R=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:t,y:r,width:M,height:R,rotation:Ci.Konva.getAngle(this.rotation())},e)}_handleMouseUp(e){this._removeEvents(e)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(e){var t;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const r=this.getNode();V2--,this._fire("transformend",{evt:e,target:r}),(t=this.getLayer())===null||t===void 0||t.batchDraw(),r&&this._nodes.forEach(i=>{var s;i._fire("transformend",{evt:e,target:i}),(s=i.getLayer())===null||s===void 0||s.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(e,t){const r=this._getNodeRect(),i=1;if(mt.Util._inRange(e.width,-this.padding()*2-i,i)){this.update();return}if(mt.Util._inRange(e.height,-this.padding()*2-i,i)){this.update();return}const s=new mt.Transform;if(s.rotate(Ci.Konva.getAngle(this.rotation())),this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("left")>=0){const _=s.point({x:-this.padding()*2,y:0});e.x+=_.x,e.y+=_.y,e.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=_.x,this._anchorDragOffset.y-=_.y}else if(this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("right")>=0){const _=s.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=_.x,this._anchorDragOffset.y-=_.y,e.width+=this.padding()*2}if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("top")>=0){const _=s.point({x:0,y:-this.padding()*2});e.x+=_.x,e.y+=_.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=_.x,this._anchorDragOffset.y-=_.y,e.height+=this.padding()*2}else if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const _=s.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=_.x,this._anchorDragOffset.y-=_.y,e.height+=this.padding()*2}if(this.boundBoxFunc()){const _=this.boundBoxFunc()(r,e);_?e=_:mt.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const o=1e7,l=new mt.Transform;l.translate(r.x,r.y),l.rotate(r.rotation),l.scale(r.width/o,r.height/o);const c=new mt.Transform,h=e.width/o,p=e.height/o;this.flipEnabled()===!1?(c.translate(e.x,e.y),c.rotate(e.rotation),c.translate(e.width<0?e.width:0,e.height<0?e.height:0),c.scale(Math.abs(h),Math.abs(p))):(c.translate(e.x,e.y),c.rotate(e.rotation),c.scale(h,p));const m=c.multiply(l.invert());this._nodes.forEach(_=>{var S;const E=_.getParent().getAbsoluteTransform(),x=_.getTransform().copy();x.translate(_.offsetX(),_.offsetY());const M=new mt.Transform;M.multiply(E.copy().invert()).multiply(m).multiply(E).multiply(x);const R=M.decompose();_.setAttrs(R),(S=_.getLayer())===null||S===void 0||S.batchDraw()}),this.rotation(mt.Util._getRotation(e.rotation)),this._nodes.forEach(_=>{this._fire("transform",{evt:t,target:_}),_._fire("transform",{evt:t,target:_})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(e,t){this.findOne(e).setAttrs(t)}update(){var e;const t=this._getNodeRect();this.rotation(mt.Util._getRotation(t.rotation));const r=t.width,i=t.height,s=this.enabledAnchors(),o=this.resizeEnabled(),l=this.padding(),c=this.anchorSize(),h=this.find("._anchor");h.forEach(m=>{m.setAttrs({width:c,height:c,offsetX:c/2,offsetY:c/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:c/2+l,offsetY:c/2+l,visible:o&&s.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:r/2,y:0,offsetY:c/2+l,visible:o&&s.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:r,y:0,offsetX:c/2-l,offsetY:c/2+l,visible:o&&s.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:i/2,offsetX:c/2+l,visible:o&&s.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:r,y:i/2,offsetX:c/2-l,visible:o&&s.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:i,offsetX:c/2+l,offsetY:c/2-l,visible:o&&s.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:r/2,y:i,offsetY:c/2-l,visible:o&&s.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:r,y:i,offsetX:c/2-l,offsetY:c/2-l,visible:o&&s.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:r/2,y:-this.rotateAnchorOffset()*mt.Util._sign(i)-l,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:r,height:i,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const p=this.anchorStyleFunc();p&&h.forEach(m=>{p(m)}),(e=this.getLayer())===null||e===void 0||e.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const e=this.findOne("."+this._movingAnchorName);e&&e.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),R5.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return P5.Node.prototype.toObject.call(this)}clone(e){return P5.Node.prototype.clone.call(this,e)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};p_.Transformer=Ke;Ke.isTransforming=()=>V2>0;function MG(n){return n instanceof Array||mt.Util.warn("enabledAnchors value should be an array"),n instanceof Array&&n.forEach(function(e){Bm.indexOf(e)===-1&&mt.Util.warn("Unknown anchor name: "+e+". Available names are: "+Bm.join(", "))}),n||[]}Ke.prototype.className="Transformer";(0,IG._registerNode)(Ke);lt.Factory.addGetterSetter(Ke,"enabledAnchors",Bm,MG);lt.Factory.addGetterSetter(Ke,"flipEnabled",!0,(0,Ia.getBooleanValidator)());lt.Factory.addGetterSetter(Ke,"resizeEnabled",!0);lt.Factory.addGetterSetter(Ke,"anchorSize",10,(0,Ia.getNumberValidator)());lt.Factory.addGetterSetter(Ke,"rotateEnabled",!0);lt.Factory.addGetterSetter(Ke,"rotateLineVisible",!0);lt.Factory.addGetterSetter(Ke,"rotationSnaps",[]);lt.Factory.addGetterSetter(Ke,"rotateAnchorOffset",50,(0,Ia.getNumberValidator)());lt.Factory.addGetterSetter(Ke,"rotateAnchorCursor","crosshair");lt.Factory.addGetterSetter(Ke,"rotationSnapTolerance",5,(0,Ia.getNumberValidator)());lt.Factory.addGetterSetter(Ke,"borderEnabled",!0);lt.Factory.addGetterSetter(Ke,"anchorStroke","rgb(0, 161, 255)");lt.Factory.addGetterSetter(Ke,"anchorStrokeWidth",1,(0,Ia.getNumberValidator)());lt.Factory.addGetterSetter(Ke,"anchorFill","white");lt.Factory.addGetterSetter(Ke,"anchorCornerRadius",0,(0,Ia.getNumberValidator)());lt.Factory.addGetterSetter(Ke,"borderStroke","rgb(0, 161, 255)");lt.Factory.addGetterSetter(Ke,"borderStrokeWidth",1,(0,Ia.getNumberValidator)());lt.Factory.addGetterSetter(Ke,"borderDash");lt.Factory.addGetterSetter(Ke,"keepRatio",!0);lt.Factory.addGetterSetter(Ke,"shiftBehavior","default");lt.Factory.addGetterSetter(Ke,"centeredScaling",!1);lt.Factory.addGetterSetter(Ke,"ignoreStroke",!1);lt.Factory.addGetterSetter(Ke,"padding",0,(0,Ia.getNumberValidator)());lt.Factory.addGetterSetter(Ke,"nodes");lt.Factory.addGetterSetter(Ke,"node");lt.Factory.addGetterSetter(Ke,"boundBoxFunc");lt.Factory.addGetterSetter(Ke,"anchorDragBoundFunc");lt.Factory.addGetterSetter(Ke,"anchorStyleFunc");lt.Factory.addGetterSetter(Ke,"shouldOverdrawWholeArea",!1);lt.Factory.addGetterSetter(Ke,"useSingleNodeRotation",!0);lt.Factory.backCompat(Ke,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var g_={};Object.defineProperty(g_,"__esModule",{value:!0});g_.Wedge=void 0;const m_=ze,OG=dn,LG=Oe,Mx=Re,FG=Oe;class lo extends OG.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.radius(),0,LG.Konva.getAngle(this.angle()),this.clockwise()),e.lineTo(0,0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}g_.Wedge=lo;lo.prototype.className="Wedge";lo.prototype._centroid=!0;lo.prototype._attrsAffectingSize=["radius"];(0,FG._registerNode)(lo);m_.Factory.addGetterSetter(lo,"radius",0,(0,Mx.getNumberValidator)());m_.Factory.addGetterSetter(lo,"angle",0,(0,Mx.getNumberValidator)());m_.Factory.addGetterSetter(lo,"clockwise",!1);m_.Factory.backCompat(lo,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var __={};Object.defineProperty(__,"__esModule",{value:!0});__.Blur=void 0;const A5=ze,VG=At,UG=Re;function N5(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const BG=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],zG=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function jG(n,e){const t=n.data,r=n.width,i=n.height;let s,o,l,c,h,p,m,_,S,E,x,M,R,P,v,k,D,O,N,C;const b=e+e+1,A=r-1,L=i-1,B=e+1,V=B*(B+1)/2,he=new N5,le=BG[e],Te=zG[e];let xe=null,Y=he,J=null,X=null;for(let te=1;te<b;te++)Y=Y.next=new N5,te===B&&(xe=Y);Y.next=he,l=o=0;for(let te=0;te<i;te++){M=R=P=v=c=h=p=m=0,_=B*(k=t[o]),S=B*(D=t[o+1]),E=B*(O=t[o+2]),x=B*(N=t[o+3]),c+=V*k,h+=V*D,p+=V*O,m+=V*N,Y=he;for(let ie=0;ie<B;ie++)Y.r=k,Y.g=D,Y.b=O,Y.a=N,Y=Y.next;for(let ie=1;ie<B;ie++)s=o+((A<ie?A:ie)<<2),c+=(Y.r=k=t[s])*(C=B-ie),h+=(Y.g=D=t[s+1])*C,p+=(Y.b=O=t[s+2])*C,m+=(Y.a=N=t[s+3])*C,M+=k,R+=D,P+=O,v+=N,Y=Y.next;J=he,X=xe;for(let ie=0;ie<r;ie++)t[o+3]=N=m*le>>Te,N!==0?(N=255/N,t[o]=(c*le>>Te)*N,t[o+1]=(h*le>>Te)*N,t[o+2]=(p*le>>Te)*N):t[o]=t[o+1]=t[o+2]=0,c-=_,h-=S,p-=E,m-=x,_-=J.r,S-=J.g,E-=J.b,x-=J.a,s=l+((s=ie+e+1)<A?s:A)<<2,M+=J.r=t[s],R+=J.g=t[s+1],P+=J.b=t[s+2],v+=J.a=t[s+3],c+=M,h+=R,p+=P,m+=v,J=J.next,_+=k=X.r,S+=D=X.g,E+=O=X.b,x+=N=X.a,M-=k,R-=D,P-=O,v-=N,X=X.next,o+=4;l+=r}for(let te=0;te<r;te++){R=P=v=M=h=p=m=c=0,o=te<<2,_=B*(k=t[o]),S=B*(D=t[o+1]),E=B*(O=t[o+2]),x=B*(N=t[o+3]),c+=V*k,h+=V*D,p+=V*O,m+=V*N,Y=he;for(let se=0;se<B;se++)Y.r=k,Y.g=D,Y.b=O,Y.a=N,Y=Y.next;let ie=r;for(let se=1;se<=e;se++)o=ie+te<<2,c+=(Y.r=k=t[o])*(C=B-se),h+=(Y.g=D=t[o+1])*C,p+=(Y.b=O=t[o+2])*C,m+=(Y.a=N=t[o+3])*C,M+=k,R+=D,P+=O,v+=N,Y=Y.next,se<L&&(ie+=r);o=te,J=he,X=xe;for(let se=0;se<i;se++)s=o<<2,t[s+3]=N=m*le>>Te,N>0?(N=255/N,t[s]=(c*le>>Te)*N,t[s+1]=(h*le>>Te)*N,t[s+2]=(p*le>>Te)*N):t[s]=t[s+1]=t[s+2]=0,c-=_,h-=S,p-=E,m-=x,_-=J.r,S-=J.g,E-=J.b,x-=J.a,s=te+((s=se+B)<L?s:L)*r<<2,c+=M+=J.r=t[s],h+=R+=J.g=t[s+1],p+=P+=J.b=t[s+2],m+=v+=J.a=t[s+3],J=J.next,_+=k=X.r,S+=D=X.g,E+=O=X.b,x+=N=X.a,M-=k,R-=D,P-=O,v-=N,X=X.next,o+=r}}const GG=function(e){const t=Math.round(this.blurRadius());t>0&&jG(e,t)};__.Blur=GG;A5.Factory.addGetterSetter(VG.Node,"blurRadius",0,(0,UG.getNumberValidator)(),A5.Factory.afterSetFilter);var y_={};Object.defineProperty(y_,"__esModule",{value:!0});y_.Brighten=void 0;const b5=ze,WG=At,HG=Re,$G=function(n){const e=this.brightness()*255,t=n.data,r=t.length;for(let i=0;i<r;i+=4)t[i]+=e,t[i+1]+=e,t[i+2]+=e};y_.Brighten=$G;b5.Factory.addGetterSetter(WG.Node,"brightness",0,(0,HG.getNumberValidator)(),b5.Factory.afterSetFilter);var v_={};Object.defineProperty(v_,"__esModule",{value:!0});v_.Contrast=void 0;const D5=ze,qG=At,KG=Re,QG=function(n){const e=Math.pow((this.contrast()+100)/100,2),t=n.data,r=t.length;let i=150,s=150,o=150;for(let l=0;l<r;l+=4)i=t[l],s=t[l+1],o=t[l+2],i/=255,i-=.5,i*=e,i+=.5,i*=255,s/=255,s-=.5,s*=e,s+=.5,s*=255,o/=255,o-=.5,o*=e,o+=.5,o*=255,i=i<0?0:i>255?255:i,s=s<0?0:s>255?255:s,o=o<0?0:o>255?255:o,t[l]=i,t[l+1]=s,t[l+2]=o};v_.Contrast=QG;D5.Factory.addGetterSetter(qG.Node,"contrast",0,(0,KG.getNumberValidator)(),D5.Factory.afterSetFilter);var w_={};Object.defineProperty(w_,"__esModule",{value:!0});w_.Emboss=void 0;const la=ze,E_=At,YG=Vt,Ox=Re,XG=function(n){const e=this.embossStrength()*10,t=this.embossWhiteLevel()*255,r=this.embossDirection(),i=this.embossBlend(),s=n.data,o=n.width,l=n.height,c=o*4;let h=0,p=0,m=l;switch(r){case"top-left":h=-1,p=-1;break;case"top":h=-1,p=0;break;case"top-right":h=-1,p=1;break;case"right":h=0,p=1;break;case"bottom-right":h=1,p=1;break;case"bottom":h=1,p=0;break;case"bottom-left":h=1,p=-1;break;case"left":h=0,p=-1;break;default:YG.Util.error("Unknown emboss direction: "+r)}do{const _=(m-1)*c;let S=h;m+S<1&&(S=0),m+S>l&&(S=0);const E=(m-1+S)*o*4;let x=o;do{const M=_+(x-1)*4;let R=p;x+R<1&&(R=0),x+R>o&&(R=0);const P=E+(x-1+R)*4,v=s[M]-s[P],k=s[M+1]-s[P+1],D=s[M+2]-s[P+2];let O=v;const N=O>0?O:-O,C=k>0?k:-k,b=D>0?D:-D;if(C>N&&(O=k),b>N&&(O=D),O*=e,i){const A=s[M]+O,L=s[M+1]+O,B=s[M+2]+O;s[M]=A>255?255:A<0?0:A,s[M+1]=L>255?255:L<0?0:L,s[M+2]=B>255?255:B<0?0:B}else{let A=t-O;A<0?A=0:A>255&&(A=255),s[M]=s[M+1]=s[M+2]=A}}while(--x)}while(--m)};w_.Emboss=XG;la.Factory.addGetterSetter(E_.Node,"embossStrength",.5,(0,Ox.getNumberValidator)(),la.Factory.afterSetFilter);la.Factory.addGetterSetter(E_.Node,"embossWhiteLevel",.5,(0,Ox.getNumberValidator)(),la.Factory.afterSetFilter);la.Factory.addGetterSetter(E_.Node,"embossDirection","top-left",void 0,la.Factory.afterSetFilter);la.Factory.addGetterSetter(E_.Node,"embossBlend",!1,void 0,la.Factory.afterSetFilter);var S_={};Object.defineProperty(S_,"__esModule",{value:!0});S_.Enhance=void 0;const M5=ze,JG=At,ZG=Re;function jv(n,e,t,r,i){const s=t-e,o=i-r;if(s===0)return r+o/2;if(o===0)return r;let l=(n-e)/s;return l=o*l+r,l}const eW=function(n){const e=n.data,t=e.length;let r=e[0],i=r,s,o=e[1],l=o,c,h=e[2],p=h,m;const _=this.enhance();if(_===0)return;for(let v=0;v<t;v+=4)s=e[v+0],s<r?r=s:s>i&&(i=s),c=e[v+1],c<o?o=c:c>l&&(l=c),m=e[v+2],m<h?h=m:m>p&&(p=m);i===r&&(i=255,r=0),l===o&&(l=255,o=0),p===h&&(p=255,h=0);let S,E,x,M,R,P;if(_>0)S=i+_*(255-i),E=r-_*(r-0),x=l+_*(255-l),M=o-_*(o-0),R=p+_*(255-p),P=h-_*(h-0);else{const v=(i+r)*.5;S=i+_*(i-v),E=r+_*(r-v);const k=(l+o)*.5;x=l+_*(l-k),M=o+_*(o-k);const D=(p+h)*.5;R=p+_*(p-D),P=h+_*(h-D)}for(let v=0;v<t;v+=4)e[v+0]=jv(e[v+0],r,i,E,S),e[v+1]=jv(e[v+1],o,l,M,x),e[v+2]=jv(e[v+2],h,p,P,R)};S_.Enhance=eW;M5.Factory.addGetterSetter(JG.Node,"enhance",0,(0,ZG.getNumberValidator)(),M5.Factory.afterSetFilter);var C_={};Object.defineProperty(C_,"__esModule",{value:!0});C_.Grayscale=void 0;const tW=function(n){const e=n.data,t=e.length;for(let r=0;r<t;r+=4){const i=.34*e[r]+.5*e[r+1]+.16*e[r+2];e[r]=i,e[r+1]=i,e[r+2]=i}};C_.Grayscale=tW;var T_={};Object.defineProperty(T_,"__esModule",{value:!0});T_.HSL=void 0;const dc=ze,RS=At,xS=Re;dc.Factory.addGetterSetter(RS.Node,"hue",0,(0,xS.getNumberValidator)(),dc.Factory.afterSetFilter);dc.Factory.addGetterSetter(RS.Node,"saturation",0,(0,xS.getNumberValidator)(),dc.Factory.afterSetFilter);dc.Factory.addGetterSetter(RS.Node,"luminance",0,(0,xS.getNumberValidator)(),dc.Factory.afterSetFilter);const nW=function(n){const e=n.data,t=e.length,r=1,i=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,o=this.luminance()*127,l=r*i*Math.cos(s*Math.PI/180),c=r*i*Math.sin(s*Math.PI/180),h=.299*r+.701*l+.167*c,p=.587*r-.587*l+.33*c,m=.114*r-.114*l-.497*c,_=.299*r-.299*l-.328*c,S=.587*r+.413*l+.035*c,E=.114*r-.114*l+.293*c,x=.299*r-.3*l+1.25*c,M=.587*r-.586*l-1.05*c,R=.114*r+.886*l-.2*c;let P,v,k,D;for(let O=0;O<t;O+=4)P=e[O+0],v=e[O+1],k=e[O+2],D=e[O+3],e[O+0]=h*P+p*v+m*k+o,e[O+1]=_*P+S*v+E*k+o,e[O+2]=x*P+M*v+R*k+o,e[O+3]=D};T_.HSL=nW;var I_={};Object.defineProperty(I_,"__esModule",{value:!0});I_.HSV=void 0;const fc=ze,AS=At,NS=Re,rW=function(n){const e=n.data,t=e.length,r=Math.pow(2,this.value()),i=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,o=r*i*Math.cos(s*Math.PI/180),l=r*i*Math.sin(s*Math.PI/180),c=.299*r+.701*o+.167*l,h=.587*r-.587*o+.33*l,p=.114*r-.114*o-.497*l,m=.299*r-.299*o-.328*l,_=.587*r+.413*o+.035*l,S=.114*r-.114*o+.293*l,E=.299*r-.3*o+1.25*l,x=.587*r-.586*o-1.05*l,M=.114*r+.886*o-.2*l;for(let R=0;R<t;R+=4){const P=e[R+0],v=e[R+1],k=e[R+2],D=e[R+3];e[R+0]=c*P+h*v+p*k,e[R+1]=m*P+_*v+S*k,e[R+2]=E*P+x*v+M*k,e[R+3]=D}};I_.HSV=rW;fc.Factory.addGetterSetter(AS.Node,"hue",0,(0,NS.getNumberValidator)(),fc.Factory.afterSetFilter);fc.Factory.addGetterSetter(AS.Node,"saturation",0,(0,NS.getNumberValidator)(),fc.Factory.afterSetFilter);fc.Factory.addGetterSetter(AS.Node,"value",0,(0,NS.getNumberValidator)(),fc.Factory.afterSetFilter);var k_={};Object.defineProperty(k_,"__esModule",{value:!0});k_.Invert=void 0;const iW=function(n){const e=n.data,t=e.length;for(let r=0;r<t;r+=4)e[r]=255-e[r],e[r+1]=255-e[r+1],e[r+2]=255-e[r+2]};k_.Invert=iW;var P_={};Object.defineProperty(P_,"__esModule",{value:!0});P_.Kaleidoscope=void 0;const zm=ze,Lx=At,O5=Vt,Fx=Re,sW=function(n,e,t){const r=n.data,i=e.data,s=n.width,o=n.height,l=t.polarCenterX||s/2,c=t.polarCenterY||o/2;let h=Math.sqrt(l*l+c*c),p=s-l,m=o-c;const _=Math.sqrt(p*p+m*m);h=_>h?_:h;const S=o,E=s,x=360/E*Math.PI/180;for(let M=0;M<E;M+=1){const R=Math.sin(M*x),P=Math.cos(M*x);for(let v=0;v<S;v+=1){p=Math.floor(l+h*v/S*P),m=Math.floor(c+h*v/S*R);let k=(m*s+p)*4;const D=r[k+0],O=r[k+1],N=r[k+2],C=r[k+3];k=(M+v*s)*4,i[k+0]=D,i[k+1]=O,i[k+2]=N,i[k+3]=C}}},oW=function(n,e,t){const r=n.data,i=e.data,s=n.width,o=n.height,l=t.polarCenterX||s/2,c=t.polarCenterY||o/2;let h=Math.sqrt(l*l+c*c),p=s-l,m=o-c;const _=Math.sqrt(p*p+m*m);h=_>h?_:h;const S=o,E=s,x=0;let M,R;for(p=0;p<s;p+=1)for(m=0;m<o;m+=1){const P=p-l,v=m-c,k=Math.sqrt(P*P+v*v)*S/h;let D=(Math.atan2(v,P)*180/Math.PI+360+x)%360;D=D*E/360,M=Math.floor(D),R=Math.floor(k);let O=(R*s+M)*4;const N=r[O+0],C=r[O+1],b=r[O+2],A=r[O+3];O=(m*s+p)*4,i[O+0]=N,i[O+1]=C,i[O+2]=b,i[O+3]=A}},aW=function(n){const e=n.width,t=n.height;let r,i,s,o,l,c,h,p,m,_,S=Math.round(this.kaleidoscopePower());const E=Math.round(this.kaleidoscopeAngle()),x=Math.floor(e*(E%360)/360);if(S<1)return;const M=O5.Util.createCanvasElement();M.width=e,M.height=t;const R=M.getContext("2d").getImageData(0,0,e,t);O5.Util.releaseCanvas(M),sW(n,R,{polarCenterX:e/2,polarCenterY:t/2});let P=e/Math.pow(2,S);for(;P<=8;)P=P*2,S-=1;P=Math.ceil(P);let v=P,k=0,D=v,O=1;for(x+P>e&&(k=v,D=0,O=-1),i=0;i<t;i+=1)for(r=k;r!==D;r+=O)s=Math.round(r+x)%e,m=(e*i+s)*4,l=R.data[m+0],c=R.data[m+1],h=R.data[m+2],p=R.data[m+3],_=(e*i+r)*4,R.data[_+0]=l,R.data[_+1]=c,R.data[_+2]=h,R.data[_+3]=p;for(i=0;i<t;i+=1)for(v=Math.floor(P),o=0;o<S;o+=1){for(r=0;r<v+1;r+=1)m=(e*i+r)*4,l=R.data[m+0],c=R.data[m+1],h=R.data[m+2],p=R.data[m+3],_=(e*i+v*2-r-1)*4,R.data[_+0]=l,R.data[_+1]=c,R.data[_+2]=h,R.data[_+3]=p;v*=2}oW(R,n,{})};P_.Kaleidoscope=aW;zm.Factory.addGetterSetter(Lx.Node,"kaleidoscopePower",2,(0,Fx.getNumberValidator)(),zm.Factory.afterSetFilter);zm.Factory.addGetterSetter(Lx.Node,"kaleidoscopeAngle",0,(0,Fx.getNumberValidator)(),zm.Factory.afterSetFilter);var R_={};Object.defineProperty(R_,"__esModule",{value:!0});R_.Mask=void 0;const L5=ze,lW=At,uW=Re;function lg(n,e,t){let r=(t*n.width+e)*4;const i=[];return i.push(n.data[r++],n.data[r++],n.data[r++],n.data[r++]),i}function Oh(n,e){return Math.sqrt(Math.pow(n[0]-e[0],2)+Math.pow(n[1]-e[1],2)+Math.pow(n[2]-e[2],2))}function cW(n){const e=[0,0,0];for(let t=0;t<n.length;t++)e[0]+=n[t][0],e[1]+=n[t][1],e[2]+=n[t][2];return e[0]/=n.length,e[1]/=n.length,e[2]/=n.length,e}function hW(n,e){const t=lg(n,0,0),r=lg(n,n.width-1,0),i=lg(n,0,n.height-1),s=lg(n,n.width-1,n.height-1),o=e||10;if(Oh(t,r)<o&&Oh(r,s)<o&&Oh(s,i)<o&&Oh(i,t)<o){const l=cW([r,t,s,i]),c=[];for(let h=0;h<n.width*n.height;h++){const p=Oh(l,[n.data[h*4],n.data[h*4+1],n.data[h*4+2]]);c[h]=p<o?0:255}return c}}function dW(n,e){for(let t=0;t<n.width*n.height;t++)n.data[4*t+3]=e[t]}function fW(n,e,t){const r=[1,1,1,1,0,1,1,1,1],i=Math.round(Math.sqrt(r.length)),s=Math.floor(i/2),o=[];for(let l=0;l<t;l++)for(let c=0;c<e;c++){const h=l*e+c;let p=0;for(let m=0;m<i;m++)for(let _=0;_<i;_++){const S=l+m-s,E=c+_-s;if(S>=0&&S<t&&E>=0&&E<e){const x=S*e+E,M=r[m*i+_];p+=n[x]*M}}o[h]=p===255*8?255:0}return o}function pW(n,e,t){const r=[1,1,1,1,1,1,1,1,1],i=Math.round(Math.sqrt(r.length)),s=Math.floor(i/2),o=[];for(let l=0;l<t;l++)for(let c=0;c<e;c++){const h=l*e+c;let p=0;for(let m=0;m<i;m++)for(let _=0;_<i;_++){const S=l+m-s,E=c+_-s;if(S>=0&&S<t&&E>=0&&E<e){const x=S*e+E,M=r[m*i+_];p+=n[x]*M}}o[h]=p>=255*4?255:0}return o}function gW(n,e,t){const r=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],i=Math.round(Math.sqrt(r.length)),s=Math.floor(i/2),o=[];for(let l=0;l<t;l++)for(let c=0;c<e;c++){const h=l*e+c;let p=0;for(let m=0;m<i;m++)for(let _=0;_<i;_++){const S=l+m-s,E=c+_-s;if(S>=0&&S<t&&E>=0&&E<e){const x=S*e+E,M=r[m*i+_];p+=n[x]*M}}o[h]=p}return o}const mW=function(n){const e=this.threshold();let t=hW(n,e);return t&&(t=fW(t,n.width,n.height),t=pW(t,n.width,n.height),t=gW(t,n.width,n.height),dW(n,t)),n};R_.Mask=mW;L5.Factory.addGetterSetter(lW.Node,"threshold",0,(0,uW.getNumberValidator)(),L5.Factory.afterSetFilter);var x_={};Object.defineProperty(x_,"__esModule",{value:!0});x_.Noise=void 0;const F5=ze,_W=At,yW=Re,vW=function(n){const e=this.noise()*255,t=n.data,r=t.length,i=e/2;for(let s=0;s<r;s+=4)t[s+0]+=i-2*i*Math.random(),t[s+1]+=i-2*i*Math.random(),t[s+2]+=i-2*i*Math.random()};x_.Noise=vW;F5.Factory.addGetterSetter(_W.Node,"noise",.2,(0,yW.getNumberValidator)(),F5.Factory.afterSetFilter);var A_={};Object.defineProperty(A_,"__esModule",{value:!0});A_.Pixelate=void 0;const V5=ze,wW=Vt,EW=At,SW=Re,CW=function(n){let e=Math.ceil(this.pixelSize()),t=n.width,r=n.height,i=Math.ceil(t/e),s=Math.ceil(r/e),o=n.data;if(e<=0){wW.Util.error("pixelSize value can not be <= 0");return}for(let l=0;l<i;l+=1)for(let c=0;c<s;c+=1){let h=0,p=0,m=0,_=0;const S=l*e,E=S+e,x=c*e,M=x+e;let R=0;for(let P=S;P<E;P+=1)if(!(P>=t))for(let v=x;v<M;v+=1){if(v>=r)continue;const k=(t*v+P)*4;h+=o[k+0],p+=o[k+1],m+=o[k+2],_+=o[k+3],R+=1}h=h/R,p=p/R,m=m/R,_=_/R;for(let P=S;P<E;P+=1)if(!(P>=t))for(let v=x;v<M;v+=1){if(v>=r)continue;const k=(t*v+P)*4;o[k+0]=h,o[k+1]=p,o[k+2]=m,o[k+3]=_}}};A_.Pixelate=CW;V5.Factory.addGetterSetter(EW.Node,"pixelSize",8,(0,SW.getNumberValidator)(),V5.Factory.afterSetFilter);var N_={};Object.defineProperty(N_,"__esModule",{value:!0});N_.Posterize=void 0;const U5=ze,TW=At,IW=Re,kW=function(n){const e=Math.round(this.levels()*254)+1,t=n.data,r=t.length,i=255/e;for(let s=0;s<r;s+=1)t[s]=Math.floor(t[s]/i)*i};N_.Posterize=kW;U5.Factory.addGetterSetter(TW.Node,"levels",.5,(0,IW.getNumberValidator)(),U5.Factory.afterSetFilter);var b_={};Object.defineProperty(b_,"__esModule",{value:!0});b_.RGB=void 0;const jm=ze,bS=At,PW=Re,RW=function(n){const e=n.data,t=e.length,r=this.red(),i=this.green(),s=this.blue();for(let o=0;o<t;o+=4){const l=(.34*e[o]+.5*e[o+1]+.16*e[o+2])/255;e[o]=l*r,e[o+1]=l*i,e[o+2]=l*s,e[o+3]=e[o+3]}};b_.RGB=RW;jm.Factory.addGetterSetter(bS.Node,"red",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)});jm.Factory.addGetterSetter(bS.Node,"green",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)});jm.Factory.addGetterSetter(bS.Node,"blue",0,PW.RGBComponent,jm.Factory.afterSetFilter);var D_={};Object.defineProperty(D_,"__esModule",{value:!0});D_.RGBA=void 0;const Jd=ze,M_=At,xW=Re,AW=function(n){const e=n.data,t=e.length,r=this.red(),i=this.green(),s=this.blue(),o=this.alpha();for(let l=0;l<t;l+=4){const c=1-o;e[l]=r*o+e[l]*c,e[l+1]=i*o+e[l+1]*c,e[l+2]=s*o+e[l+2]*c}};D_.RGBA=AW;Jd.Factory.addGetterSetter(M_.Node,"red",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)});Jd.Factory.addGetterSetter(M_.Node,"green",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)});Jd.Factory.addGetterSetter(M_.Node,"blue",0,xW.RGBComponent,Jd.Factory.afterSetFilter);Jd.Factory.addGetterSetter(M_.Node,"alpha",1,function(n){return this._filterUpToDate=!1,n>1?1:n<0?0:n});var O_={};Object.defineProperty(O_,"__esModule",{value:!0});O_.Sepia=void 0;const NW=function(n){const e=n.data,t=e.length;for(let r=0;r<t;r+=4){const i=e[r+0],s=e[r+1],o=e[r+2];e[r+0]=Math.min(255,i*.393+s*.769+o*.189),e[r+1]=Math.min(255,i*.349+s*.686+o*.168),e[r+2]=Math.min(255,i*.272+s*.534+o*.131)}};O_.Sepia=NW;var L_={};Object.defineProperty(L_,"__esModule",{value:!0});L_.Solarize=void 0;const bW=function(n){const e=n.data,t=n.width,r=n.height,i=t*4;let s=r;do{const o=(s-1)*i;let l=t;do{const c=o+(l-1)*4;let h=e[c],p=e[c+1],m=e[c+2];h>127&&(h=255-h),p>127&&(p=255-p),m>127&&(m=255-m),e[c]=h,e[c+1]=p,e[c+2]=m}while(--l)}while(--s)};L_.Solarize=bW;var F_={};Object.defineProperty(F_,"__esModule",{value:!0});F_.Threshold=void 0;const B5=ze,DW=At,MW=Re,OW=function(n){const e=this.threshold()*255,t=n.data,r=t.length;for(let i=0;i<r;i+=1)t[i]=t[i]<e?0:255};F_.Threshold=OW;B5.Factory.addGetterSetter(DW.Node,"threshold",.5,(0,MW.getNumberValidator)(),B5.Factory.afterSetFilter);Object.defineProperty(q0,"__esModule",{value:!0});q0.Konva=void 0;const z5=Vm,LW=J0,FW=t_,VW=i_,UW=s_,BW=o_,j5=hc,zW=xf,jW=Mc,GW=Nf,WW=u_,HW=c_,$W=h_,qW=d_,KW=Lc,QW=f_,YW=p_,XW=g_,JW=__,ZW=y_,eH=v_,tH=w_,nH=S_,rH=C_,iH=T_,sH=I_,oH=k_,aH=P_,lH=R_,uH=x_,cH=A_,hH=N_,dH=b_,fH=D_,pH=O_,gH=L_,mH=F_;q0.Konva=z5.Konva.Util._assign(z5.Konva,{Arc:LW.Arc,Arrow:FW.Arrow,Circle:VW.Circle,Ellipse:UW.Ellipse,Image:BW.Image,Label:j5.Label,Tag:j5.Tag,Line:zW.Line,Path:jW.Path,Rect:GW.Rect,RegularPolygon:WW.RegularPolygon,Ring:HW.Ring,Sprite:$W.Sprite,Star:qW.Star,Text:KW.Text,TextPath:QW.TextPath,Transformer:YW.Transformer,Wedge:XW.Wedge,Filters:{Blur:JW.Blur,Brighten:ZW.Brighten,Contrast:eH.Contrast,Emboss:tH.Emboss,Enhance:nH.Enhance,Grayscale:rH.Grayscale,HSL:iH.HSL,HSV:sH.HSV,Invert:oH.Invert,Kaleidoscope:aH.Kaleidoscope,Mask:lH.Mask,Noise:uH.Noise,Pixelate:cH.Pixelate,Posterize:hH.Posterize,RGB:dH.RGB,RGBA:fH.RGBA,Sepia:pH.Sepia,Solarize:gH.Solarize,Threshold:mH.Threshold}});var _H=rx.exports;Object.defineProperty(_H,"__esModule",{value:!0});const yH=q0;rx.exports=yH.Konva;var U2={exports:{}};(function(n,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;var t=Vm;Object.defineProperty(e,"Konva",{enumerable:!0,get:function(){return t.Konva}});const r=Vm;n.exports=r.Konva})(U2,U2.exports);var vH=U2.exports;const Zd=Wm(vH);var Vx={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wH=function(e){var t={},r=ee,i=$h,s=Object.assign;function o(a){for(var u="https://reactjs.org/docs/error-decoder.html?invariant="+a,f=1;f<arguments.length;f++)u+="&args[]="+encodeURIComponent(arguments[f]);return"Minified React error #"+a+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var l=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,c=Symbol.for("react.element"),h=Symbol.for("react.portal"),p=Symbol.for("react.fragment"),m=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),E=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),k=Symbol.for("react.offscreen"),D=Symbol.iterator;function O(a){return a===null||typeof a!="object"?null:(a=D&&a[D]||a["@@iterator"],typeof a=="function"?a:null)}function N(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case p:return"Fragment";case h:return"Portal";case _:return"Profiler";case m:return"StrictMode";case M:return"Suspense";case R:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case E:return(a.displayName||"Context")+".Consumer";case S:return(a._context.displayName||"Context")+".Provider";case x:var u=a.render;return a=a.displayName,a||(a=u.displayName||u.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case P:return u=a.displayName||null,u!==null?u:N(a.type)||"Memo";case v:u=a._payload,a=a._init;try{return N(a(u))}catch{}}return null}function C(a){var u=a.type;switch(a.tag){case 24:return"Cache";case 9:return(u.displayName||"Context")+".Consumer";case 10:return(u._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=u.render,a=a.displayName||a.name||"",u.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return u;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return N(u);case 8:return u===m?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u}return null}function b(a){var u=a,f=a;if(a.alternate)for(;u.return;)u=u.return;else{a=u;do u=a,u.flags&4098&&(f=u.return),a=u.return;while(a)}return u.tag===3?f:null}function A(a){if(b(a)!==a)throw Error(o(188))}function L(a){var u=a.alternate;if(!u){if(u=b(a),u===null)throw Error(o(188));return u!==a?null:a}for(var f=a,g=u;;){var y=f.return;if(y===null)break;var T=y.alternate;if(T===null){if(g=y.return,g!==null){f=g;continue}break}if(y.child===T.child){for(T=y.child;T;){if(T===f)return A(y),a;if(T===g)return A(y),u;T=T.sibling}throw Error(o(188))}if(f.return!==g.return)f=y,g=T;else{for(var U=!1,G=y.child;G;){if(G===f){U=!0,f=y,g=T;break}if(G===g){U=!0,g=y,f=T;break}G=G.sibling}if(!U){for(G=T.child;G;){if(G===f){U=!0,f=T,g=y;break}if(G===g){U=!0,g=T,f=y;break}G=G.sibling}if(!U)throw Error(o(189))}}if(f.alternate!==g)throw Error(o(190))}if(f.tag!==3)throw Error(o(188));return f.stateNode.current===f?a:u}function B(a){return a=L(a),a!==null?V(a):null}function V(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var u=V(a);if(u!==null)return u;a=a.sibling}return null}function he(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){if(a.tag!==4){var u=he(a);if(u!==null)return u}a=a.sibling}return null}var le=Array.isArray,Te=e.getPublicInstance,xe=e.getRootHostContext,Y=e.getChildHostContext,J=e.prepareForCommit,X=e.resetAfterCommit,te=e.createInstance,ie=e.appendInitialChild,se=e.finalizeInitialChildren,ft=e.prepareUpdate,ct=e.shouldSetTextContent,Qe=e.createTextInstance,j=e.scheduleTimeout,ne=e.cancelTimeout,ye=e.noTimeout,Fe=e.isPrimaryRenderer,Ce=e.supportsMutation,Ze=e.supportsPersistence,ot=e.supportsHydration,Ut=e.getInstanceFromNode,et=e.preparePortalMount,Wn=e.getCurrentEventPriority,Cr=e.detachDeletedInstance,Hn=e.supportsMicrotasks,Ui=e.scheduleMicrotask,Ur=e.supportsTestSelectors,bf=e.findFiberRoot,j_=e.getBoundingRect,Vc=e.getTextContent,ps=e.isHiddenSubtree,Df=e.matchAccessibilityRole,pn=e.setFocusIfFocusable,An=e.setupIntersectionObserver,Vl=e.appendChild,Mf=e.appendChildToContainer,Of=e.commitTextUpdate,G_=e.commitMount,Pa=e.commitUpdate,Lf=e.insertBefore,Ff=e.insertInContainerBefore,Uc=e.removeChild,W_=e.removeChildFromContainer,Vf=e.resetTextContent,Bc=e.hideInstance,Uf=e.hideTextInstance,Bf=e.unhideInstance,Ra=e.unhideTextInstance,zc=e.clearContainer,jc=e.cloneInstance,Bi=e.createContainerChildSet,Gc=e.appendChildToContainerChildSet,Ul=e.finalizeContainerChildren,Bl=e.replaceContainerChildren,uo=e.cloneHiddenInstance,Wc=e.cloneHiddenTextInstance,Nn=e.canHydrateInstance,zf=e.canHydrateTextInstance,xa=e.canHydrateSuspenseInstance,co=e.isSuspenseInstancePending,Hc=e.isSuspenseInstanceFallback,H_=e.getSuspenseInstanceFallbackErrorDetails,ho=e.registerSuspenseInstanceRetry,zl=e.getNextHydratableSibling,$_=e.getFirstHydratableChild,jl=e.getFirstHydratableChildWithinContainer,jf=e.getFirstHydratableChildWithinSuspenseInstance,$c=e.hydrateInstance,Gl=e.hydrateTextInstance,zi=e.hydrateSuspenseInstance,Gf=e.getNextHydratableInstanceAfterSuspenseInstance,Wf=e.commitHydratedContainer,qc=e.commitHydratedSuspenseInstance,Kc=e.clearSuspenseBoundary,Hf=e.clearSuspenseBoundaryFromContainer,$f=e.shouldDeleteUnhydratedTailInstances,q_=e.didNotMatchHydratedContainerTextInstance,Wl=e.didNotMatchHydratedTextInstance,Hl;function gs(a){if(Hl===void 0)try{throw Error()}catch(f){var u=f.stack.trim().match(/\n( *(at )?)/);Hl=u&&u[1]||""}return`
`+Hl+a}var ms=!1;function fi(a,u){if(!a||ms)return"";ms=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(u)if(u=function(){throw Error()},Object.defineProperty(u.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(u,[])}catch(ae){var g=ae}Reflect.construct(a,[],u)}else{try{u.call()}catch(ae){g=ae}a.call(u.prototype)}else{try{throw Error()}catch(ae){g=ae}a()}}catch(ae){if(ae&&g&&typeof ae.stack=="string"){for(var y=ae.stack.split(`
`),T=g.stack.split(`
`),U=y.length-1,G=T.length-1;1<=U&&0<=G&&y[U]!==T[G];)G--;for(;1<=U&&0<=G;U--,G--)if(y[U]!==T[G]){if(U!==1||G!==1)do if(U--,G--,0>G||y[U]!==T[G]){var q=`
`+y[U].replace(" at new "," at ");return a.displayName&&q.includes("<anonymous>")&&(q=q.replace("<anonymous>",a.displayName)),q}while(1<=U&&0<=G);break}}}finally{ms=!1,Error.prepareStackTrace=f}return(a=a?a.displayName||a.name:"")?gs(a):""}var Qc=Object.prototype.hasOwnProperty,Yc=[],_s=-1;function pi(a){return{current:a}}function pt(a){0>_s||(a.current=Yc[_s],Yc[_s]=null,_s--)}function ut(a,u){_s++,Yc[_s]=a.current,a.current=u}var Qr={},rn=pi(Qr),bn=pi(!1),ys=Qr;function fo(a,u){var f=a.type.contextTypes;if(!f)return Qr;var g=a.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===u)return g.__reactInternalMemoizedMaskedChildContext;var y={},T;for(T in f)y[T]=u[T];return g&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=u,a.__reactInternalMemoizedMaskedChildContext=y),y}function Dn(a){return a=a.childContextTypes,a!=null}function Aa(){pt(bn),pt(rn)}function qf(a,u,f){if(rn.current!==Qr)throw Error(o(168));ut(rn,u),ut(bn,f)}function ji(a,u,f){var g=a.stateNode;if(u=u.childContextTypes,typeof g.getChildContext!="function")return f;g=g.getChildContext();for(var y in g)if(!(y in u))throw Error(o(108,C(a)||"Unknown",y));return s({},f,g)}function Tr(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Qr,ys=rn.current,ut(rn,a),ut(bn,bn.current),!0}function Na(a,u,f){var g=a.stateNode;if(!g)throw Error(o(169));f?(a=ji(a,u,ys),g.__reactInternalMemoizedMergedChildContext=a,pt(bn),pt(rn),ut(rn,a)):pt(bn),ut(bn,f)}var $n=Math.clz32?Math.clz32:$l,Kf=Math.log,_t=Math.LN2;function $l(a){return a>>>=0,a===0?32:31-(Kf(a)/_t|0)|0}var Gi=64,Wi=4194304;function ba(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function Da(a,u){var f=a.pendingLanes;if(f===0)return 0;var g=0,y=a.suspendedLanes,T=a.pingedLanes,U=f&268435455;if(U!==0){var G=U&~y;G!==0?g=ba(G):(T&=U,T!==0&&(g=ba(T)))}else U=f&~y,U!==0?g=ba(U):T!==0&&(g=ba(T));if(g===0)return 0;if(u!==0&&u!==g&&!(u&y)&&(y=g&-g,T=u&-u,y>=T||y===16&&(T&4194240)!==0))return u;if(g&4&&(g|=f&16),u=a.entangledLanes,u!==0)for(a=a.entanglements,u&=g;0<u;)f=31-$n(u),y=1<<f,g|=a[f],u&=~y;return g}function K_(a,u){switch(a){case 1:case 2:case 4:return u+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Q_(a,u){for(var f=a.suspendedLanes,g=a.pingedLanes,y=a.expirationTimes,T=a.pendingLanes;0<T;){var U=31-$n(T),G=1<<U,q=y[U];q===-1?(!(G&f)||G&g)&&(y[U]=K_(G,u)):q<=u&&(a.expiredLanes|=G),T&=~G}}function Xc(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function Qf(){var a=Gi;return Gi<<=1,!(Gi&4194240)&&(Gi=64),a}function vs(a){for(var u=[],f=0;31>f;f++)u.push(a);return u}function Ir(a,u,f){a.pendingLanes|=u,u!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,u=31-$n(u),a[u]=f}function Yf(a,u){var f=a.pendingLanes&~u;a.pendingLanes=u,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=u,a.mutableReadLanes&=u,a.entangledLanes&=u,u=a.entanglements;var g=a.eventTimes;for(a=a.expirationTimes;0<f;){var y=31-$n(f),T=1<<y;u[y]=0,g[y]=-1,a[y]=-1,f&=~T}}function ql(a,u){var f=a.entangledLanes|=u;for(a=a.entanglements;f;){var g=31-$n(f),y=1<<g;y&u|a[g]&u&&(a[g]|=u),f&=~y}}var qe=0;function ws(a){return a&=-a,1<a?4<a?a&268435455?16:536870912:4:1}var Jc=i.unstable_scheduleCallback,Xf=i.unstable_cancelCallback,Y_=i.unstable_shouldYield,Hi=i.unstable_requestPaint,Yt=i.unstable_now,Zc=i.unstable_ImmediatePriority,Kl=i.unstable_UserBlockingPriority,po=i.unstable_NormalPriority,Jf=i.unstable_IdlePriority,$i=null,qn=null;function Zf(a){if(qn&&typeof qn.onCommitFiberRoot=="function")try{qn.onCommitFiberRoot($i,a,void 0,(a.current.flags&128)===128)}catch{}}function eh(a,u){return a===u&&(a!==0||1/a===1/u)||a!==a&&u!==u}var Ye=typeof Object.is=="function"?Object.is:eh,gi=null,Ql=!1,Yl=!1;function th(a){gi===null?gi=[a]:gi.push(a)}function ep(a){Ql=!0,th(a)}function dr(){if(!Yl&&gi!==null){Yl=!0;var a=0,u=qe;try{var f=gi;for(qe=1;a<f.length;a++){var g=f[a];do g=g(!0);while(g!==null)}gi=null,Ql=!1}catch(y){throw gi!==null&&(gi=gi.slice(a+1)),Jc(Zc,dr),y}finally{qe=u,Yl=!1}}return null}var Es=[],Kn=0,Ma=null,Xl=0,gn=[],fr=0,mi=null,kr=1,Yr="";function Xr(a,u){Es[Kn++]=Xl,Es[Kn++]=Ma,Ma=a,Xl=u}function tp(a,u,f){gn[fr++]=kr,gn[fr++]=Yr,gn[fr++]=mi,mi=a;var g=kr;a=Yr;var y=32-$n(g)-1;g&=~(1<<y),f+=1;var T=32-$n(u)+y;if(30<T){var U=y-y%5;T=(g&(1<<U)-1).toString(32),g>>=U,y-=U,kr=1<<32-$n(u)+y|f<<y|g,Yr=T+a}else kr=1<<T|f<<y|g,Yr=a}function Jl(a){a.return!==null&&(Xr(a,1),tp(a,1,0))}function Ss(a){for(;a===Ma;)Ma=Es[--Kn],Es[Kn]=null,Xl=Es[--Kn],Es[Kn]=null;for(;a===mi;)mi=gn[--fr],gn[fr]=null,Yr=gn[--fr],gn[fr]=null,kr=gn[--fr],gn[fr]=null}var Qn=null,pr=null,gt=!1,Cs=!1,Pr=null;function Oa(a,u){var f=ni(5,null,null,0);f.elementType="DELETED",f.stateNode=u,f.return=a,u=a.deletions,u===null?(a.deletions=[f],a.flags|=16):u.push(f)}function nh(a,u){switch(a.tag){case 5:return u=Nn(u,a.type,a.pendingProps),u!==null?(a.stateNode=u,Qn=a,pr=$_(u),!0):!1;case 6:return u=zf(u,a.pendingProps),u!==null?(a.stateNode=u,Qn=a,pr=null,!0):!1;case 13:if(u=xa(u),u!==null){var f=mi!==null?{id:kr,overflow:Yr}:null;return a.memoizedState={dehydrated:u,treeContext:f,retryLane:1073741824},f=ni(18,null,null,0),f.stateNode=u,f.return=a,a.child=f,Qn=a,pr=null,!0}return!1;default:return!1}}function Zl(a){return(a.mode&1)!==0&&(a.flags&128)===0}function _i(a){if(gt){var u=pr;if(u){var f=u;if(!nh(a,u)){if(Zl(a))throw Error(o(418));u=zl(f);var g=Qn;u&&nh(a,u)?Oa(g,f):(a.flags=a.flags&-4097|2,gt=!1,Qn=a)}}else{if(Zl(a))throw Error(o(418));a.flags=a.flags&-4097|2,gt=!1,Qn=a}}}function rh(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;Qn=a}function La(a){if(!ot||a!==Qn)return!1;if(!gt)return rh(a),gt=!0,!1;if(a.tag!==3&&(a.tag!==5||$f(a.type)&&!ct(a.type,a.memoizedProps))){var u=pr;if(u){if(Zl(a))throw ih(),Error(o(418));for(;u;)Oa(a,u),u=zl(u)}}if(rh(a),a.tag===13){if(!ot)throw Error(o(316));if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(o(317));pr=Gf(a)}else pr=Qn?zl(a.stateNode):null;return!0}function ih(){for(var a=pr;a;)a=zl(a)}function Ts(){ot&&(pr=Qn=null,Cs=gt=!1)}function go(a){Pr===null?Pr=[a]:Pr.push(a)}var gr=l.ReactCurrentBatchConfig;function Fa(a,u){if(Ye(a,u))return!0;if(typeof a!="object"||a===null||typeof u!="object"||u===null)return!1;var f=Object.keys(a),g=Object.keys(u);if(f.length!==g.length)return!1;for(g=0;g<f.length;g++){var y=f[g];if(!Qc.call(u,y)||!Ye(a[y],u[y]))return!1}return!0}function np(a){switch(a.tag){case 5:return gs(a.type);case 16:return gs("Lazy");case 13:return gs("Suspense");case 19:return gs("SuspenseList");case 0:case 2:case 15:return a=fi(a.type,!1),a;case 11:return a=fi(a.type.render,!1),a;case 1:return a=fi(a.type,!0),a;default:return""}}function Jr(a,u,f){if(a=f.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(f._owner){if(f=f._owner,f){if(f.tag!==1)throw Error(o(309));var g=f.stateNode}if(!g)throw Error(o(147,a));var y=g,T=""+a;return u!==null&&u.ref!==null&&typeof u.ref=="function"&&u.ref._stringRef===T?u.ref:(u=function(U){var G=y.refs;U===null?delete G[T]:G[T]=U},u._stringRef=T,u)}if(typeof a!="string")throw Error(o(284));if(!f._owner)throw Error(o(290,a))}return a}function d(a,u){throw a=Object.prototype.toString.call(u),Error(o(31,a==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":a))}function w(a){var u=a._init;return u(a._payload)}function I(a){function u($,W){if(a){var Q=$.deletions;Q===null?($.deletions=[W],$.flags|=16):Q.push(W)}}function f($,W){if(!a)return null;for(;W!==null;)u($,W),W=W.sibling;return null}function g($,W){for($=new Map;W!==null;)W.key!==null?$.set(W.key,W):$.set(W.index,W),W=W.sibling;return $}function y($,W){return $=So($,W),$.index=0,$.sibling=null,$}function T($,W,Q){return $.index=Q,a?(Q=$.alternate,Q!==null?(Q=Q.index,Q<W?($.flags|=2,W):Q):($.flags|=2,W)):($.flags|=1048576,W)}function U($){return a&&$.alternate===null&&($.flags|=2),$}function G($,W,Q,pe){return W===null||W.tag!==6?(W=zy(Q,$.mode,pe),W.return=$,W):(W=y(W,Q),W.return=$,W)}function q($,W,Q,pe){var Ee=Q.type;return Ee===p?_e($,W,Q.props.children,pe,Q.key):W!==null&&(W.elementType===Ee||typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===v&&w(Ee)===W.type)?(pe=y(W,Q.props),pe.ref=Jr($,W,Q),pe.return=$,pe):(pe=Np(Q.type,Q.key,Q.props,null,$.mode,pe),pe.ref=Jr($,W,Q),pe.return=$,pe)}function ae($,W,Q,pe){return W===null||W.tag!==4||W.stateNode.containerInfo!==Q.containerInfo||W.stateNode.implementation!==Q.implementation?(W=jy(Q,$.mode,pe),W.return=$,W):(W=y(W,Q.children||[]),W.return=$,W)}function _e($,W,Q,pe,Ee){return W===null||W.tag!==7?(W=Ga(Q,$.mode,pe,Ee),W.return=$,W):(W=y(W,Q),W.return=$,W)}function be($,W,Q){if(typeof W=="string"&&W!==""||typeof W=="number")return W=zy(""+W,$.mode,Q),W.return=$,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case c:return Q=Np(W.type,W.key,W.props,null,$.mode,Q),Q.ref=Jr($,null,W),Q.return=$,Q;case h:return W=jy(W,$.mode,Q),W.return=$,W;case v:var pe=W._init;return be($,pe(W._payload),Q)}if(le(W)||O(W))return W=Ga(W,$.mode,Q,null),W.return=$,W;d($,W)}return null}function de($,W,Q,pe){var Ee=W!==null?W.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number")return Ee!==null?null:G($,W,""+Q,pe);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case c:return Q.key===Ee?q($,W,Q,pe):null;case h:return Q.key===Ee?ae($,W,Q,pe):null;case v:return Ee=Q._init,de($,W,Ee(Q._payload),pe)}if(le(Q)||O(Q))return Ee!==null?null:_e($,W,Q,pe,null);d($,Q)}return null}function It($,W,Q,pe,Ee){if(typeof pe=="string"&&pe!==""||typeof pe=="number")return $=$.get(Q)||null,G(W,$,""+pe,Ee);if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case c:return $=$.get(pe.key===null?Q:pe.key)||null,q(W,$,pe,Ee);case h:return $=$.get(pe.key===null?Q:pe.key)||null,ae(W,$,pe,Ee);case v:var Me=pe._init;return It($,W,Q,Me(pe._payload),Ee)}if(le(pe)||O(pe))return $=$.get(Q)||null,_e(W,$,pe,Ee,null);d(W,pe)}return null}function yt($,W,Q,pe){for(var Ee=null,Me=null,De=W,rt=W=0,vn=null;De!==null&&rt<Q.length;rt++){De.index>rt?(vn=De,De=null):vn=De.sibling;var it=de($,De,Q[rt],pe);if(it===null){De===null&&(De=vn);break}a&&De&&it.alternate===null&&u($,De),W=T(it,W,rt),Me===null?Ee=it:Me.sibling=it,Me=it,De=vn}if(rt===Q.length)return f($,De),gt&&Xr($,rt),Ee;if(De===null){for(;rt<Q.length;rt++)De=be($,Q[rt],pe),De!==null&&(W=T(De,W,rt),Me===null?Ee=De:Me.sibling=De,Me=De);return gt&&Xr($,rt),Ee}for(De=g($,De);rt<Q.length;rt++)vn=It(De,$,rt,Q[rt],pe),vn!==null&&(a&&vn.alternate!==null&&De.delete(vn.key===null?rt:vn.key),W=T(vn,W,rt),Me===null?Ee=vn:Me.sibling=vn,Me=vn);return a&&De.forEach(function(Co){return u($,Co)}),gt&&Xr($,rt),Ee}function Nr($,W,Q,pe){var Ee=O(Q);if(typeof Ee!="function")throw Error(o(150));if(Q=Ee.call(Q),Q==null)throw Error(o(151));for(var Me=Ee=null,De=W,rt=W=0,vn=null,it=Q.next();De!==null&&!it.done;rt++,it=Q.next()){De.index>rt?(vn=De,De=null):vn=De.sibling;var Co=de($,De,it.value,pe);if(Co===null){De===null&&(De=vn);break}a&&De&&Co.alternate===null&&u($,De),W=T(Co,W,rt),Me===null?Ee=Co:Me.sibling=Co,Me=Co,De=vn}if(it.done)return f($,De),gt&&Xr($,rt),Ee;if(De===null){for(;!it.done;rt++,it=Q.next())it=be($,it.value,pe),it!==null&&(W=T(it,W,rt),Me===null?Ee=it:Me.sibling=it,Me=it);return gt&&Xr($,rt),Ee}for(De=g($,De);!it.done;rt++,it=Q.next())it=It(De,$,rt,it.value,pe),it!==null&&(a&&it.alternate!==null&&De.delete(it.key===null?rt:it.key),W=T(it,W,rt),Me===null?Ee=it:Me.sibling=it,Me=it);return a&&De.forEach(function(DA){return u($,DA)}),gt&&Xr($,rt),Ee}function Rs($,W,Q,pe){if(typeof Q=="object"&&Q!==null&&Q.type===p&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case c:e:{for(var Ee=Q.key,Me=W;Me!==null;){if(Me.key===Ee){if(Ee=Q.type,Ee===p){if(Me.tag===7){f($,Me.sibling),W=y(Me,Q.props.children),W.return=$,$=W;break e}}else if(Me.elementType===Ee||typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===v&&w(Ee)===Me.type){f($,Me.sibling),W=y(Me,Q.props),W.ref=Jr($,Me,Q),W.return=$,$=W;break e}f($,Me);break}else u($,Me);Me=Me.sibling}Q.type===p?(W=Ga(Q.props.children,$.mode,pe,Q.key),W.return=$,$=W):(pe=Np(Q.type,Q.key,Q.props,null,$.mode,pe),pe.ref=Jr($,W,Q),pe.return=$,$=pe)}return U($);case h:e:{for(Me=Q.key;W!==null;){if(W.key===Me)if(W.tag===4&&W.stateNode.containerInfo===Q.containerInfo&&W.stateNode.implementation===Q.implementation){f($,W.sibling),W=y(W,Q.children||[]),W.return=$,$=W;break e}else{f($,W);break}else u($,W);W=W.sibling}W=jy(Q,$.mode,pe),W.return=$,$=W}return U($);case v:return Me=Q._init,Rs($,W,Me(Q._payload),pe)}if(le(Q))return yt($,W,Q,pe);if(O(Q))return Nr($,W,Q,pe);d($,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"?(Q=""+Q,W!==null&&W.tag===6?(f($,W.sibling),W=y(W,Q),W.return=$,$=W):(f($,W),W=zy(Q,$.mode,pe),W.return=$,$=W),U($)):f($,W)}return Rs}var F=I(!0),H=I(!1),K=pi(null),ue=null,Xe=null,Wt=null;function Ge(){Wt=Xe=ue=null}function sn(a,u,f){Fe?(ut(K,u._currentValue),u._currentValue=f):(ut(K,u._currentValue2),u._currentValue2=f)}function Xt(a){var u=K.current;pt(K),Fe?a._currentValue=u:a._currentValue2=u}function qi(a,u,f){for(;a!==null;){var g=a.alternate;if((a.childLanes&u)!==u?(a.childLanes|=u,g!==null&&(g.childLanes|=u)):g!==null&&(g.childLanes&u)!==u&&(g.childLanes|=u),a===f)break;a=a.return}}function mn(a,u){ue=a,Wt=Xe=null,a=a.dependencies,a!==null&&a.firstContext!==null&&(a.lanes&u&&(Rr=!0),a.firstContext=null)}function Mn(a){var u=Fe?a._currentValue:a._currentValue2;if(Wt!==a)if(a={context:a,memoizedValue:u,next:null},Xe===null){if(ue===null)throw Error(o(308));Xe=a,ue.dependencies={lanes:0,firstContext:a}}else Xe=Xe.next=a;return u}var yi=null;function X_(a){yi===null?yi=[a]:yi.push(a)}function VS(a,u,f,g){var y=u.interleaved;return y===null?(f.next=f,X_(u)):(f.next=y.next,y.next=f),u.interleaved=f,Ki(a,g)}function Ki(a,u){a.lanes|=u;var f=a.alternate;for(f!==null&&(f.lanes|=u),f=a,a=a.return;a!==null;)a.childLanes|=u,f=a.alternate,f!==null&&(f.childLanes|=u),f=a,a=a.return;return f.tag===3?f.stateNode:null}var mo=!1;function J_(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function US(a,u){a=a.updateQueue,u.updateQueue===a&&(u.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function Is(a,u){return{eventTime:a,lane:u,tag:0,payload:null,callback:null,next:null}}function _o(a,u,f){var g=a.updateQueue;if(g===null)return null;if(g=g.shared,Ve&2){var y=g.pending;return y===null?u.next=u:(u.next=y.next,y.next=u),g.pending=u,Ki(a,f)}return y=g.interleaved,y===null?(u.next=u,X_(g)):(u.next=y.next,y.next=u),g.interleaved=u,Ki(a,f)}function rp(a,u,f){if(u=u.updateQueue,u!==null&&(u=u.shared,(f&4194240)!==0)){var g=u.lanes;g&=a.pendingLanes,f|=g,u.lanes=f,ql(a,f)}}function BS(a,u){var f=a.updateQueue,g=a.alternate;if(g!==null&&(g=g.updateQueue,f===g)){var y=null,T=null;if(f=f.firstBaseUpdate,f!==null){do{var U={eventTime:f.eventTime,lane:f.lane,tag:f.tag,payload:f.payload,callback:f.callback,next:null};T===null?y=T=U:T=T.next=U,f=f.next}while(f!==null);T===null?y=T=u:T=T.next=u}else y=T=u;f={baseState:g.baseState,firstBaseUpdate:y,lastBaseUpdate:T,shared:g.shared,effects:g.effects},a.updateQueue=f;return}a=f.lastBaseUpdate,a===null?f.firstBaseUpdate=u:a.next=u,f.lastBaseUpdate=u}function ip(a,u,f,g){var y=a.updateQueue;mo=!1;var T=y.firstBaseUpdate,U=y.lastBaseUpdate,G=y.shared.pending;if(G!==null){y.shared.pending=null;var q=G,ae=q.next;q.next=null,U===null?T=ae:U.next=ae,U=q;var _e=a.alternate;_e!==null&&(_e=_e.updateQueue,G=_e.lastBaseUpdate,G!==U&&(G===null?_e.firstBaseUpdate=ae:G.next=ae,_e.lastBaseUpdate=q))}if(T!==null){var be=y.baseState;U=0,_e=ae=q=null,G=T;do{var de=G.lane,It=G.eventTime;if((g&de)===de){_e!==null&&(_e=_e.next={eventTime:It,lane:0,tag:G.tag,payload:G.payload,callback:G.callback,next:null});e:{var yt=a,Nr=G;switch(de=u,It=f,Nr.tag){case 1:if(yt=Nr.payload,typeof yt=="function"){be=yt.call(It,be,de);break e}be=yt;break e;case 3:yt.flags=yt.flags&-65537|128;case 0:if(yt=Nr.payload,de=typeof yt=="function"?yt.call(It,be,de):yt,de==null)break e;be=s({},be,de);break e;case 2:mo=!0}}G.callback!==null&&G.lane!==0&&(a.flags|=64,de=y.effects,de===null?y.effects=[G]:de.push(G))}else It={eventTime:It,lane:de,tag:G.tag,payload:G.payload,callback:G.callback,next:null},_e===null?(ae=_e=It,q=be):_e=_e.next=It,U|=de;if(G=G.next,G===null){if(G=y.shared.pending,G===null)break;de=G,G=de.next,de.next=null,y.lastBaseUpdate=de,y.shared.pending=null}}while(!0);if(_e===null&&(q=be),y.baseState=q,y.firstBaseUpdate=ae,y.lastBaseUpdate=_e,u=y.shared.interleaved,u!==null){y=u;do U|=y.lane,y=y.next;while(y!==u)}else T===null&&(y.shared.lanes=0);Ua|=U,a.lanes=U,a.memoizedState=be}}function zS(a,u,f){if(a=u.effects,u.effects=null,a!==null)for(u=0;u<a.length;u++){var g=a[u],y=g.callback;if(y!==null){if(g.callback=null,g=f,typeof y!="function")throw Error(o(191,y));y.call(g)}}}var sh={},Zr=pi(sh),oh=pi(sh),eu=pi(sh);function Qi(a){if(a===sh)throw Error(o(174));return a}function Z_(a,u){ut(eu,u),ut(oh,a),ut(Zr,sh),a=xe(u),pt(Zr),ut(Zr,a)}function tu(){pt(Zr),pt(oh),pt(eu)}function jS(a){var u=Qi(eu.current),f=Qi(Zr.current);u=Y(f,a.type,u),f!==u&&(ut(oh,a),ut(Zr,u))}function ey(a){oh.current===a&&(pt(Zr),pt(oh))}var Nt=pi(0);function sp(a){for(var u=a;u!==null;){if(u.tag===13){var f=u.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||co(f)||Hc(f)))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if(u.flags&128)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===a)break;for(;u.sibling===null;){if(u.return===null||u.return===a)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var ty=[];function ny(){for(var a=0;a<ty.length;a++){var u=ty[a];Fe?u._workInProgressVersionPrimary=null:u._workInProgressVersionSecondary=null}ty.length=0}var op=l.ReactCurrentDispatcher,ry=l.ReactCurrentBatchConfig,Va=0,bt=null,on=null,_n=null,ap=!1,ah=!1,lh=0,iA=0;function Yn(){throw Error(o(321))}function iy(a,u){if(u===null)return!1;for(var f=0;f<u.length&&f<a.length;f++)if(!Ye(a[f],u[f]))return!1;return!0}function sy(a,u,f,g,y,T){if(Va=T,bt=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,op.current=a===null||a.memoizedState===null?lA:uA,a=f(g,y),ah){T=0;do{if(ah=!1,lh=0,25<=T)throw Error(o(301));T+=1,_n=on=null,u.updateQueue=null,op.current=cA,a=f(g,y)}while(ah)}if(op.current=cp,u=on!==null&&on.next!==null,Va=0,_n=on=bt=null,ap=!1,u)throw Error(o(300));return a}function oy(){var a=lh!==0;return lh=0,a}function Yi(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _n===null?bt.memoizedState=_n=a:_n=_n.next=a,_n}function ei(){if(on===null){var a=bt.alternate;a=a!==null?a.memoizedState:null}else a=on.next;var u=_n===null?bt.memoizedState:_n.next;if(u!==null)_n=u,on=a;else{if(a===null)throw Error(o(310));on=a,a={memoizedState:on.memoizedState,baseState:on.baseState,baseQueue:on.baseQueue,queue:on.queue,next:null},_n===null?bt.memoizedState=_n=a:_n=_n.next=a}return _n}function uh(a,u){return typeof u=="function"?u(a):u}function ay(a){var u=ei(),f=u.queue;if(f===null)throw Error(o(311));f.lastRenderedReducer=a;var g=on,y=g.baseQueue,T=f.pending;if(T!==null){if(y!==null){var U=y.next;y.next=T.next,T.next=U}g.baseQueue=y=T,f.pending=null}if(y!==null){T=y.next,g=g.baseState;var G=U=null,q=null,ae=T;do{var _e=ae.lane;if((Va&_e)===_e)q!==null&&(q=q.next={lane:0,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null}),g=ae.hasEagerState?ae.eagerState:a(g,ae.action);else{var be={lane:_e,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null};q===null?(G=q=be,U=g):q=q.next=be,bt.lanes|=_e,Ua|=_e}ae=ae.next}while(ae!==null&&ae!==T);q===null?U=g:q.next=G,Ye(g,u.memoizedState)||(Rr=!0),u.memoizedState=g,u.baseState=U,u.baseQueue=q,f.lastRenderedState=g}if(a=f.interleaved,a!==null){y=a;do T=y.lane,bt.lanes|=T,Ua|=T,y=y.next;while(y!==a)}else y===null&&(f.lanes=0);return[u.memoizedState,f.dispatch]}function ly(a){var u=ei(),f=u.queue;if(f===null)throw Error(o(311));f.lastRenderedReducer=a;var g=f.dispatch,y=f.pending,T=u.memoizedState;if(y!==null){f.pending=null;var U=y=y.next;do T=a(T,U.action),U=U.next;while(U!==y);Ye(T,u.memoizedState)||(Rr=!0),u.memoizedState=T,u.baseQueue===null&&(u.baseState=T),f.lastRenderedState=T}return[T,g]}function GS(){}function WS(a,u){var f=bt,g=ei(),y=u(),T=!Ye(g.memoizedState,y);if(T&&(g.memoizedState=y,Rr=!0),g=g.queue,uy(qS.bind(null,f,g,a),[a]),g.getSnapshot!==u||T||_n!==null&&_n.memoizedState.tag&1){if(f.flags|=2048,ch(9,$S.bind(null,f,g,y,u),void 0,null),yn===null)throw Error(o(349));Va&30||HS(f,u,y)}return y}function HS(a,u,f){a.flags|=16384,a={getSnapshot:u,value:f},u=bt.updateQueue,u===null?(u={lastEffect:null,stores:null},bt.updateQueue=u,u.stores=[a]):(f=u.stores,f===null?u.stores=[a]:f.push(a))}function $S(a,u,f,g){u.value=f,u.getSnapshot=g,KS(u)&&QS(a)}function qS(a,u,f){return f(function(){KS(u)&&QS(a)})}function KS(a){var u=a.getSnapshot;a=a.value;try{var f=u();return!Ye(a,f)}catch{return!0}}function QS(a){var u=Ki(a,1);u!==null&&ti(u,a,1,-1)}function YS(a){var u=Yi();return typeof a=="function"&&(a=a()),u.memoizedState=u.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:uh,lastRenderedState:a},u.queue=a,a=a.dispatch=aA.bind(null,bt,a),[u.memoizedState,a]}function ch(a,u,f,g){return a={tag:a,create:u,destroy:f,deps:g,next:null},u=bt.updateQueue,u===null?(u={lastEffect:null,stores:null},bt.updateQueue=u,u.lastEffect=a.next=a):(f=u.lastEffect,f===null?u.lastEffect=a.next=a:(g=f.next,f.next=a,a.next=g,u.lastEffect=a)),a}function XS(){return ei().memoizedState}function lp(a,u,f,g){var y=Yi();bt.flags|=a,y.memoizedState=ch(1|u,f,void 0,g===void 0?null:g)}function up(a,u,f,g){var y=ei();g=g===void 0?null:g;var T=void 0;if(on!==null){var U=on.memoizedState;if(T=U.destroy,g!==null&&iy(g,U.deps)){y.memoizedState=ch(u,f,T,g);return}}bt.flags|=a,y.memoizedState=ch(1|u,f,T,g)}function JS(a,u){return lp(8390656,8,a,u)}function uy(a,u){return up(2048,8,a,u)}function ZS(a,u){return up(4,2,a,u)}function eC(a,u){return up(4,4,a,u)}function tC(a,u){if(typeof u=="function")return a=a(),u(a),function(){u(null)};if(u!=null)return a=a(),u.current=a,function(){u.current=null}}function nC(a,u,f){return f=f!=null?f.concat([a]):null,up(4,4,tC.bind(null,u,a),f)}function cy(){}function rC(a,u){var f=ei();u=u===void 0?null:u;var g=f.memoizedState;return g!==null&&u!==null&&iy(u,g[1])?g[0]:(f.memoizedState=[a,u],a)}function iC(a,u){var f=ei();u=u===void 0?null:u;var g=f.memoizedState;return g!==null&&u!==null&&iy(u,g[1])?g[0]:(a=a(),f.memoizedState=[a,u],a)}function sC(a,u,f){return Va&21?(Ye(f,u)||(f=Qf(),bt.lanes|=f,Ua|=f,a.baseState=!0),u):(a.baseState&&(a.baseState=!1,Rr=!0),a.memoizedState=f)}function sA(a,u){var f=qe;qe=f!==0&&4>f?f:4,a(!0);var g=ry.transition;ry.transition={};try{a(!1),u()}finally{qe=f,ry.transition=g}}function oC(){return ei().memoizedState}function oA(a,u,f){var g=wo(a);if(f={lane:g,action:f,hasEagerState:!1,eagerState:null,next:null},aC(a))lC(u,f);else if(f=VS(a,u,f,g),f!==null){var y=Zn();ti(f,a,g,y),uC(f,u,g)}}function aA(a,u,f){var g=wo(a),y={lane:g,action:f,hasEagerState:!1,eagerState:null,next:null};if(aC(a))lC(u,y);else{var T=a.alternate;if(a.lanes===0&&(T===null||T.lanes===0)&&(T=u.lastRenderedReducer,T!==null))try{var U=u.lastRenderedState,G=T(U,f);if(y.hasEagerState=!0,y.eagerState=G,Ye(G,U)){var q=u.interleaved;q===null?(y.next=y,X_(u)):(y.next=q.next,q.next=y),u.interleaved=y;return}}catch{}finally{}f=VS(a,u,y,g),f!==null&&(y=Zn(),ti(f,a,g,y),uC(f,u,g))}}function aC(a){var u=a.alternate;return a===bt||u!==null&&u===bt}function lC(a,u){ah=ap=!0;var f=a.pending;f===null?u.next=u:(u.next=f.next,f.next=u),a.pending=u}function uC(a,u,f){if(f&4194240){var g=u.lanes;g&=a.pendingLanes,f|=g,u.lanes=f,ql(a,f)}}var cp={readContext:Mn,useCallback:Yn,useContext:Yn,useEffect:Yn,useImperativeHandle:Yn,useInsertionEffect:Yn,useLayoutEffect:Yn,useMemo:Yn,useReducer:Yn,useRef:Yn,useState:Yn,useDebugValue:Yn,useDeferredValue:Yn,useTransition:Yn,useMutableSource:Yn,useSyncExternalStore:Yn,useId:Yn,unstable_isNewReconciler:!1},lA={readContext:Mn,useCallback:function(a,u){return Yi().memoizedState=[a,u===void 0?null:u],a},useContext:Mn,useEffect:JS,useImperativeHandle:function(a,u,f){return f=f!=null?f.concat([a]):null,lp(4194308,4,tC.bind(null,u,a),f)},useLayoutEffect:function(a,u){return lp(4194308,4,a,u)},useInsertionEffect:function(a,u){return lp(4,2,a,u)},useMemo:function(a,u){var f=Yi();return u=u===void 0?null:u,a=a(),f.memoizedState=[a,u],a},useReducer:function(a,u,f){var g=Yi();return u=f!==void 0?f(u):u,g.memoizedState=g.baseState=u,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:u},g.queue=a,a=a.dispatch=oA.bind(null,bt,a),[g.memoizedState,a]},useRef:function(a){var u=Yi();return a={current:a},u.memoizedState=a},useState:YS,useDebugValue:cy,useDeferredValue:function(a){return Yi().memoizedState=a},useTransition:function(){var a=YS(!1),u=a[0];return a=sA.bind(null,a[1]),Yi().memoizedState=a,[u,a]},useMutableSource:function(){},useSyncExternalStore:function(a,u,f){var g=bt,y=Yi();if(gt){if(f===void 0)throw Error(o(407));f=f()}else{if(f=u(),yn===null)throw Error(o(349));Va&30||HS(g,u,f)}y.memoizedState=f;var T={value:f,getSnapshot:u};return y.queue=T,JS(qS.bind(null,g,T,a),[a]),g.flags|=2048,ch(9,$S.bind(null,g,T,f,u),void 0,null),f},useId:function(){var a=Yi(),u=yn.identifierPrefix;if(gt){var f=Yr,g=kr;f=(g&~(1<<32-$n(g)-1)).toString(32)+f,u=":"+u+"R"+f,f=lh++,0<f&&(u+="H"+f.toString(32)),u+=":"}else f=iA++,u=":"+u+"r"+f.toString(32)+":";return a.memoizedState=u},unstable_isNewReconciler:!1},uA={readContext:Mn,useCallback:rC,useContext:Mn,useEffect:uy,useImperativeHandle:nC,useInsertionEffect:ZS,useLayoutEffect:eC,useMemo:iC,useReducer:ay,useRef:XS,useState:function(){return ay(uh)},useDebugValue:cy,useDeferredValue:function(a){var u=ei();return sC(u,on.memoizedState,a)},useTransition:function(){var a=ay(uh)[0],u=ei().memoizedState;return[a,u]},useMutableSource:GS,useSyncExternalStore:WS,useId:oC,unstable_isNewReconciler:!1},cA={readContext:Mn,useCallback:rC,useContext:Mn,useEffect:uy,useImperativeHandle:nC,useInsertionEffect:ZS,useLayoutEffect:eC,useMemo:iC,useReducer:ly,useRef:XS,useState:function(){return ly(uh)},useDebugValue:cy,useDeferredValue:function(a){var u=ei();return on===null?u.memoizedState=a:sC(u,on.memoizedState,a)},useTransition:function(){var a=ly(uh)[0],u=ei().memoizedState;return[a,u]},useMutableSource:GS,useSyncExternalStore:WS,useId:oC,unstable_isNewReconciler:!1};function vi(a,u){if(a&&a.defaultProps){u=s({},u),a=a.defaultProps;for(var f in a)u[f]===void 0&&(u[f]=a[f]);return u}return u}function hy(a,u,f,g){u=a.memoizedState,f=f(g,u),f=f==null?u:s({},u,f),a.memoizedState=f,a.lanes===0&&(a.updateQueue.baseState=f)}var hp={isMounted:function(a){return(a=a._reactInternals)?b(a)===a:!1},enqueueSetState:function(a,u,f){a=a._reactInternals;var g=Zn(),y=wo(a),T=Is(g,y);T.payload=u,f!=null&&(T.callback=f),u=_o(a,T,y),u!==null&&(ti(u,a,y,g),rp(u,a,y))},enqueueReplaceState:function(a,u,f){a=a._reactInternals;var g=Zn(),y=wo(a),T=Is(g,y);T.tag=1,T.payload=u,f!=null&&(T.callback=f),u=_o(a,T,y),u!==null&&(ti(u,a,y,g),rp(u,a,y))},enqueueForceUpdate:function(a,u){a=a._reactInternals;var f=Zn(),g=wo(a),y=Is(f,g);y.tag=2,u!=null&&(y.callback=u),u=_o(a,y,g),u!==null&&(ti(u,a,g,f),rp(u,a,g))}};function cC(a,u,f,g,y,T,U){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(g,T,U):u.prototype&&u.prototype.isPureReactComponent?!Fa(f,g)||!Fa(y,T):!0}function hC(a,u,f){var g=!1,y=Qr,T=u.contextType;return typeof T=="object"&&T!==null?T=Mn(T):(y=Dn(u)?ys:rn.current,g=u.contextTypes,T=(g=g!=null)?fo(a,y):Qr),u=new u(f,T),a.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,u.updater=hp,a.stateNode=u,u._reactInternals=a,g&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=y,a.__reactInternalMemoizedMaskedChildContext=T),u}function dC(a,u,f,g){a=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(f,g),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(f,g),u.state!==a&&hp.enqueueReplaceState(u,u.state,null)}function dy(a,u,f,g){var y=a.stateNode;y.props=f,y.state=a.memoizedState,y.refs={},J_(a);var T=u.contextType;typeof T=="object"&&T!==null?y.context=Mn(T):(T=Dn(u)?ys:rn.current,y.context=fo(a,T)),y.state=a.memoizedState,T=u.getDerivedStateFromProps,typeof T=="function"&&(hy(a,u,T,f),y.state=a.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(u=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),u!==y.state&&hp.enqueueReplaceState(y,y.state,null),ip(a,f,y,g),y.state=a.memoizedState),typeof y.componentDidMount=="function"&&(a.flags|=4194308)}function nu(a,u){try{var f="",g=u;do f+=np(g),g=g.return;while(g);var y=f}catch(T){y=`
Error generating stack: `+T.message+`
`+T.stack}return{value:a,source:u,stack:y,digest:null}}function fy(a,u,f){return{value:a,source:null,stack:f??null,digest:u??null}}function py(a,u){try{console.error(u.value)}catch(f){setTimeout(function(){throw f})}}var hA=typeof WeakMap=="function"?WeakMap:Map;function fC(a,u,f){f=Is(-1,f),f.tag=3,f.payload={element:null};var g=u.value;return f.callback=function(){Ip||(Ip=!0,My=g),py(a,u)},f}function pC(a,u,f){f=Is(-1,f),f.tag=3;var g=a.type.getDerivedStateFromError;if(typeof g=="function"){var y=u.value;f.payload=function(){return g(y)},f.callback=function(){py(a,u)}}var T=a.stateNode;return T!==null&&typeof T.componentDidCatch=="function"&&(f.callback=function(){py(a,u),typeof g!="function"&&(yo===null?yo=new Set([this]):yo.add(this));var U=u.stack;this.componentDidCatch(u.value,{componentStack:U!==null?U:""})}),f}function gC(a,u,f){var g=a.pingCache;if(g===null){g=a.pingCache=new hA;var y=new Set;g.set(u,y)}else y=g.get(u),y===void 0&&(y=new Set,g.set(u,y));y.has(f)||(y.add(f),a=IA.bind(null,a,u,f),u.then(a,a))}function mC(a){do{var u;if((u=a.tag===13)&&(u=a.memoizedState,u=u!==null?u.dehydrated!==null:!0),u)return a;a=a.return}while(a!==null);return null}function _C(a,u,f,g,y){return a.mode&1?(a.flags|=65536,a.lanes=y,a):(a===u?a.flags|=65536:(a.flags|=128,f.flags|=131072,f.flags&=-52805,f.tag===1&&(f.alternate===null?f.tag=17:(u=Is(-1,1),u.tag=2,_o(f,u,1))),f.lanes|=1),a)}var dA=l.ReactCurrentOwner,Rr=!1;function mr(a,u,f,g){u.child=a===null?H(u,null,f,g):F(u,a.child,f,g)}function yC(a,u,f,g,y){f=f.render;var T=u.ref;return mn(u,y),g=sy(a,u,f,g,T,y),f=oy(),a!==null&&!Rr?(u.updateQueue=a.updateQueue,u.flags&=-2053,a.lanes&=~y,ks(a,u,y)):(gt&&f&&Jl(u),u.flags|=1,mr(a,u,g,y),u.child)}function vC(a,u,f,g,y){if(a===null){var T=f.type;return typeof T=="function"&&!By(T)&&T.defaultProps===void 0&&f.compare===null&&f.defaultProps===void 0?(u.tag=15,u.type=T,wC(a,u,T,g,y)):(a=Np(f.type,null,g,u,u.mode,y),a.ref=u.ref,a.return=u,u.child=a)}if(T=a.child,!(a.lanes&y)){var U=T.memoizedProps;if(f=f.compare,f=f!==null?f:Fa,f(U,g)&&a.ref===u.ref)return ks(a,u,y)}return u.flags|=1,a=So(T,g),a.ref=u.ref,a.return=u,u.child=a}function wC(a,u,f,g,y){if(a!==null){var T=a.memoizedProps;if(Fa(T,g)&&a.ref===u.ref)if(Rr=!1,u.pendingProps=g=T,(a.lanes&y)!==0)a.flags&131072&&(Rr=!0);else return u.lanes=a.lanes,ks(a,u,y)}return gy(a,u,f,g,y)}function EC(a,u,f){var g=u.pendingProps,y=g.children,T=a!==null?a.memoizedState:null;if(g.mode==="hidden")if(!(u.mode&1))u.memoizedState={baseLanes:0,cachePool:null,transitions:null},ut(iu,Br),Br|=f;else{if(!(f&1073741824))return a=T!==null?T.baseLanes|f:f,u.lanes=u.childLanes=1073741824,u.memoizedState={baseLanes:a,cachePool:null,transitions:null},u.updateQueue=null,ut(iu,Br),Br|=a,null;u.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=T!==null?T.baseLanes:f,ut(iu,Br),Br|=g}else T!==null?(g=T.baseLanes|f,u.memoizedState=null):g=f,ut(iu,Br),Br|=g;return mr(a,u,y,f),u.child}function SC(a,u){var f=u.ref;(a===null&&f!==null||a!==null&&a.ref!==f)&&(u.flags|=512,u.flags|=2097152)}function gy(a,u,f,g,y){var T=Dn(f)?ys:rn.current;return T=fo(u,T),mn(u,y),f=sy(a,u,f,g,T,y),g=oy(),a!==null&&!Rr?(u.updateQueue=a.updateQueue,u.flags&=-2053,a.lanes&=~y,ks(a,u,y)):(gt&&g&&Jl(u),u.flags|=1,mr(a,u,f,y),u.child)}function CC(a,u,f,g,y){if(Dn(f)){var T=!0;Tr(u)}else T=!1;if(mn(u,y),u.stateNode===null)fp(a,u),hC(u,f,g),dy(u,f,g,y),g=!0;else if(a===null){var U=u.stateNode,G=u.memoizedProps;U.props=G;var q=U.context,ae=f.contextType;typeof ae=="object"&&ae!==null?ae=Mn(ae):(ae=Dn(f)?ys:rn.current,ae=fo(u,ae));var _e=f.getDerivedStateFromProps,be=typeof _e=="function"||typeof U.getSnapshotBeforeUpdate=="function";be||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(G!==g||q!==ae)&&dC(u,U,g,ae),mo=!1;var de=u.memoizedState;U.state=de,ip(u,g,U,y),q=u.memoizedState,G!==g||de!==q||bn.current||mo?(typeof _e=="function"&&(hy(u,f,_e,g),q=u.memoizedState),(G=mo||cC(u,f,G,g,de,q,ae))?(be||typeof U.UNSAFE_componentWillMount!="function"&&typeof U.componentWillMount!="function"||(typeof U.componentWillMount=="function"&&U.componentWillMount(),typeof U.UNSAFE_componentWillMount=="function"&&U.UNSAFE_componentWillMount()),typeof U.componentDidMount=="function"&&(u.flags|=4194308)):(typeof U.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=g,u.memoizedState=q),U.props=g,U.state=q,U.context=ae,g=G):(typeof U.componentDidMount=="function"&&(u.flags|=4194308),g=!1)}else{U=u.stateNode,US(a,u),G=u.memoizedProps,ae=u.type===u.elementType?G:vi(u.type,G),U.props=ae,be=u.pendingProps,de=U.context,q=f.contextType,typeof q=="object"&&q!==null?q=Mn(q):(q=Dn(f)?ys:rn.current,q=fo(u,q));var It=f.getDerivedStateFromProps;(_e=typeof It=="function"||typeof U.getSnapshotBeforeUpdate=="function")||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(G!==be||de!==q)&&dC(u,U,g,q),mo=!1,de=u.memoizedState,U.state=de,ip(u,g,U,y);var yt=u.memoizedState;G!==be||de!==yt||bn.current||mo?(typeof It=="function"&&(hy(u,f,It,g),yt=u.memoizedState),(ae=mo||cC(u,f,ae,g,de,yt,q)||!1)?(_e||typeof U.UNSAFE_componentWillUpdate!="function"&&typeof U.componentWillUpdate!="function"||(typeof U.componentWillUpdate=="function"&&U.componentWillUpdate(g,yt,q),typeof U.UNSAFE_componentWillUpdate=="function"&&U.UNSAFE_componentWillUpdate(g,yt,q)),typeof U.componentDidUpdate=="function"&&(u.flags|=4),typeof U.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof U.componentDidUpdate!="function"||G===a.memoizedProps&&de===a.memoizedState||(u.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||G===a.memoizedProps&&de===a.memoizedState||(u.flags|=1024),u.memoizedProps=g,u.memoizedState=yt),U.props=g,U.state=yt,U.context=q,g=ae):(typeof U.componentDidUpdate!="function"||G===a.memoizedProps&&de===a.memoizedState||(u.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||G===a.memoizedProps&&de===a.memoizedState||(u.flags|=1024),g=!1)}return my(a,u,f,g,T,y)}function my(a,u,f,g,y,T){SC(a,u);var U=(u.flags&128)!==0;if(!g&&!U)return y&&Na(u,f,!1),ks(a,u,T);g=u.stateNode,dA.current=u;var G=U&&typeof f.getDerivedStateFromError!="function"?null:g.render();return u.flags|=1,a!==null&&U?(u.child=F(u,a.child,null,T),u.child=F(u,null,G,T)):mr(a,u,G,T),u.memoizedState=g.state,y&&Na(u,f,!0),u.child}function TC(a){var u=a.stateNode;u.pendingContext?qf(a,u.pendingContext,u.pendingContext!==u.context):u.context&&qf(a,u.context,!1),Z_(a,u.containerInfo)}function IC(a,u,f,g,y){return Ts(),go(y),u.flags|=256,mr(a,u,f,g),u.child}var _y={dehydrated:null,treeContext:null,retryLane:0};function yy(a){return{baseLanes:a,cachePool:null,transitions:null}}function kC(a,u,f){var g=u.pendingProps,y=Nt.current,T=!1,U=(u.flags&128)!==0,G;if((G=U)||(G=a!==null&&a.memoizedState===null?!1:(y&2)!==0),G?(T=!0,u.flags&=-129):(a===null||a.memoizedState!==null)&&(y|=1),ut(Nt,y&1),a===null)return _i(u),a=u.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?(u.mode&1?Hc(a)?u.lanes=8:u.lanes=1073741824:u.lanes=1,null):(U=g.children,a=g.fallback,T?(g=u.mode,T=u.child,U={mode:"hidden",children:U},!(g&1)&&T!==null?(T.childLanes=0,T.pendingProps=U):T=bp(U,g,0,null),a=Ga(a,g,f,null),T.return=u,a.return=u,T.sibling=a,u.child=T,u.child.memoizedState=yy(f),u.memoizedState=_y,a):vy(u,U));if(y=a.memoizedState,y!==null&&(G=y.dehydrated,G!==null))return fA(a,u,U,g,G,y,f);if(T){T=g.fallback,U=u.mode,y=a.child,G=y.sibling;var q={mode:"hidden",children:g.children};return!(U&1)&&u.child!==y?(g=u.child,g.childLanes=0,g.pendingProps=q,u.deletions=null):(g=So(y,q),g.subtreeFlags=y.subtreeFlags&14680064),G!==null?T=So(G,T):(T=Ga(T,U,f,null),T.flags|=2),T.return=u,g.return=u,g.sibling=T,u.child=g,g=T,T=u.child,U=a.child.memoizedState,U=U===null?yy(f):{baseLanes:U.baseLanes|f,cachePool:null,transitions:U.transitions},T.memoizedState=U,T.childLanes=a.childLanes&~f,u.memoizedState=_y,g}return T=a.child,a=T.sibling,g=So(T,{mode:"visible",children:g.children}),!(u.mode&1)&&(g.lanes=f),g.return=u,g.sibling=null,a!==null&&(f=u.deletions,f===null?(u.deletions=[a],u.flags|=16):f.push(a)),u.child=g,u.memoizedState=null,g}function vy(a,u){return u=bp({mode:"visible",children:u},a.mode,0,null),u.return=a,a.child=u}function dp(a,u,f,g){return g!==null&&go(g),F(u,a.child,null,f),a=vy(u,u.pendingProps.children),a.flags|=2,u.memoizedState=null,a}function fA(a,u,f,g,y,T,U){if(f)return u.flags&256?(u.flags&=-257,g=fy(Error(o(422))),dp(a,u,U,g)):u.memoizedState!==null?(u.child=a.child,u.flags|=128,null):(T=g.fallback,y=u.mode,g=bp({mode:"visible",children:g.children},y,0,null),T=Ga(T,y,U,null),T.flags|=2,g.return=u,T.return=u,g.sibling=T,u.child=g,u.mode&1&&F(u,a.child,null,U),u.child.memoizedState=yy(U),u.memoizedState=_y,T);if(!(u.mode&1))return dp(a,u,U,null);if(Hc(y))return g=H_(y).digest,T=Error(o(419)),g=fy(T,g,void 0),dp(a,u,U,g);if(f=(U&a.childLanes)!==0,Rr||f){if(g=yn,g!==null){switch(U&-U){case 4:y=2;break;case 16:y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:y=32;break;case 536870912:y=268435456;break;default:y=0}y=y&(g.suspendedLanes|U)?0:y,y!==0&&y!==T.retryLane&&(T.retryLane=y,Ki(a,y),ti(g,a,y,-1))}return Uy(),g=fy(Error(o(421))),dp(a,u,U,g)}return co(y)?(u.flags|=128,u.child=a.child,u=kA.bind(null,a),ho(y,u),null):(a=T.treeContext,ot&&(pr=jf(y),Qn=u,gt=!0,Pr=null,Cs=!1,a!==null&&(gn[fr++]=kr,gn[fr++]=Yr,gn[fr++]=mi,kr=a.id,Yr=a.overflow,mi=u)),u=vy(u,g.children),u.flags|=4096,u)}function PC(a,u,f){a.lanes|=u;var g=a.alternate;g!==null&&(g.lanes|=u),qi(a.return,u,f)}function wy(a,u,f,g,y){var T=a.memoizedState;T===null?a.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:g,tail:f,tailMode:y}:(T.isBackwards=u,T.rendering=null,T.renderingStartTime=0,T.last=g,T.tail=f,T.tailMode=y)}function RC(a,u,f){var g=u.pendingProps,y=g.revealOrder,T=g.tail;if(mr(a,u,g.children,f),g=Nt.current,g&2)g=g&1|2,u.flags|=128;else{if(a!==null&&a.flags&128)e:for(a=u.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&PC(a,f,u);else if(a.tag===19)PC(a,f,u);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===u)break e;for(;a.sibling===null;){if(a.return===null||a.return===u)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}g&=1}if(ut(Nt,g),!(u.mode&1))u.memoizedState=null;else switch(y){case"forwards":for(f=u.child,y=null;f!==null;)a=f.alternate,a!==null&&sp(a)===null&&(y=f),f=f.sibling;f=y,f===null?(y=u.child,u.child=null):(y=f.sibling,f.sibling=null),wy(u,!1,y,f,T);break;case"backwards":for(f=null,y=u.child,u.child=null;y!==null;){if(a=y.alternate,a!==null&&sp(a)===null){u.child=y;break}a=y.sibling,y.sibling=f,f=y,y=a}wy(u,!0,f,null,T);break;case"together":wy(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function fp(a,u){!(u.mode&1)&&a!==null&&(a.alternate=null,u.alternate=null,u.flags|=2)}function ks(a,u,f){if(a!==null&&(u.dependencies=a.dependencies),Ua|=u.lanes,!(f&u.childLanes))return null;if(a!==null&&u.child!==a.child)throw Error(o(153));if(u.child!==null){for(a=u.child,f=So(a,a.pendingProps),u.child=f,f.return=u;a.sibling!==null;)a=a.sibling,f=f.sibling=So(a,a.pendingProps),f.return=u;f.sibling=null}return u.child}function pA(a,u,f){switch(u.tag){case 3:TC(u),Ts();break;case 5:jS(u);break;case 1:Dn(u.type)&&Tr(u);break;case 4:Z_(u,u.stateNode.containerInfo);break;case 10:sn(u,u.type._context,u.memoizedProps.value);break;case 13:var g=u.memoizedState;if(g!==null)return g.dehydrated!==null?(ut(Nt,Nt.current&1),u.flags|=128,null):f&u.child.childLanes?kC(a,u,f):(ut(Nt,Nt.current&1),a=ks(a,u,f),a!==null?a.sibling:null);ut(Nt,Nt.current&1);break;case 19:if(g=(f&u.childLanes)!==0,a.flags&128){if(g)return RC(a,u,f);u.flags|=128}var y=u.memoizedState;if(y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),ut(Nt,Nt.current),g)break;return null;case 22:case 23:return u.lanes=0,EC(a,u,f)}return ks(a,u,f)}function Xi(a){a.flags|=4}function xC(a,u){if(a!==null&&a.child===u.child)return!0;if(u.flags&16)return!1;for(a=u.child;a!==null;){if(a.flags&12854||a.subtreeFlags&12854)return!1;a=a.sibling}return!0}var hh,dh,pp,gp;if(Ce)hh=function(a,u){for(var f=u.child;f!==null;){if(f.tag===5||f.tag===6)ie(a,f.stateNode);else if(f.tag!==4&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===u)break;for(;f.sibling===null;){if(f.return===null||f.return===u)return;f=f.return}f.sibling.return=f.return,f=f.sibling}},dh=function(){},pp=function(a,u,f,g,y){if(a=a.memoizedProps,a!==g){var T=u.stateNode,U=Qi(Zr.current);f=ft(T,f,a,g,y,U),(u.updateQueue=f)&&Xi(u)}},gp=function(a,u,f,g){f!==g&&Xi(u)};else if(Ze){hh=function(a,u,f,g){for(var y=u.child;y!==null;){if(y.tag===5){var T=y.stateNode;f&&g&&(T=uo(T,y.type,y.memoizedProps,y)),ie(a,T)}else if(y.tag===6)T=y.stateNode,f&&g&&(T=Wc(T,y.memoizedProps,y)),ie(a,T);else if(y.tag!==4){if(y.tag===22&&y.memoizedState!==null)T=y.child,T!==null&&(T.return=y),hh(a,y,!0,!0);else if(y.child!==null){y.child.return=y,y=y.child;continue}}if(y===u)break;for(;y.sibling===null;){if(y.return===null||y.return===u)return;y=y.return}y.sibling.return=y.return,y=y.sibling}};var AC=function(a,u,f,g){for(var y=u.child;y!==null;){if(y.tag===5){var T=y.stateNode;f&&g&&(T=uo(T,y.type,y.memoizedProps,y)),Gc(a,T)}else if(y.tag===6)T=y.stateNode,f&&g&&(T=Wc(T,y.memoizedProps,y)),Gc(a,T);else if(y.tag!==4){if(y.tag===22&&y.memoizedState!==null)T=y.child,T!==null&&(T.return=y),AC(a,y,!0,!0);else if(y.child!==null){y.child.return=y,y=y.child;continue}}if(y===u)break;for(;y.sibling===null;){if(y.return===null||y.return===u)return;y=y.return}y.sibling.return=y.return,y=y.sibling}};dh=function(a,u){var f=u.stateNode;if(!xC(a,u)){a=f.containerInfo;var g=Bi(a);AC(g,u,!1,!1),f.pendingChildren=g,Xi(u),Ul(a,g)}},pp=function(a,u,f,g,y){var T=a.stateNode,U=a.memoizedProps;if((a=xC(a,u))&&U===g)u.stateNode=T;else{var G=u.stateNode,q=Qi(Zr.current),ae=null;U!==g&&(ae=ft(G,f,U,g,y,q)),a&&ae===null?u.stateNode=T:(T=jc(T,ae,f,U,g,u,a,G),se(T,f,g,y,q)&&Xi(u),u.stateNode=T,a?Xi(u):hh(T,u,!1,!1))}},gp=function(a,u,f,g){f!==g?(a=Qi(eu.current),f=Qi(Zr.current),u.stateNode=Qe(g,a,f,u),Xi(u)):u.stateNode=a.stateNode}}else dh=function(){},pp=function(){},gp=function(){};function fh(a,u){if(!gt)switch(a.tailMode){case"hidden":u=a.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?a.tail=null:f.sibling=null;break;case"collapsed":f=a.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?u||a.tail===null?a.tail=null:a.tail.sibling=null:g.sibling=null}}function Xn(a){var u=a.alternate!==null&&a.alternate.child===a.child,f=0,g=0;if(u)for(var y=a.child;y!==null;)f|=y.lanes|y.childLanes,g|=y.subtreeFlags&14680064,g|=y.flags&14680064,y.return=a,y=y.sibling;else for(y=a.child;y!==null;)f|=y.lanes|y.childLanes,g|=y.subtreeFlags,g|=y.flags,y.return=a,y=y.sibling;return a.subtreeFlags|=g,a.childLanes=f,u}function gA(a,u,f){var g=u.pendingProps;switch(Ss(u),u.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xn(u),null;case 1:return Dn(u.type)&&Aa(),Xn(u),null;case 3:return f=u.stateNode,tu(),pt(bn),pt(rn),ny(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(a===null||a.child===null)&&(La(u)?Xi(u):a===null||a.memoizedState.isDehydrated&&!(u.flags&256)||(u.flags|=1024,Pr!==null&&(Fy(Pr),Pr=null))),dh(a,u),Xn(u),null;case 5:ey(u),f=Qi(eu.current);var y=u.type;if(a!==null&&u.stateNode!=null)pp(a,u,y,g,f),a.ref!==u.ref&&(u.flags|=512,u.flags|=2097152);else{if(!g){if(u.stateNode===null)throw Error(o(166));return Xn(u),null}if(a=Qi(Zr.current),La(u)){if(!ot)throw Error(o(175));a=$c(u.stateNode,u.type,u.memoizedProps,f,a,u,!Cs),u.updateQueue=a,a!==null&&Xi(u)}else{var T=te(y,g,f,a,u);hh(T,u,!1,!1),u.stateNode=T,se(T,y,g,f,a)&&Xi(u)}u.ref!==null&&(u.flags|=512,u.flags|=2097152)}return Xn(u),null;case 6:if(a&&u.stateNode!=null)gp(a,u,a.memoizedProps,g);else{if(typeof g!="string"&&u.stateNode===null)throw Error(o(166));if(a=Qi(eu.current),f=Qi(Zr.current),La(u)){if(!ot)throw Error(o(176));if(a=u.stateNode,f=u.memoizedProps,(g=Gl(a,f,u,!Cs))&&(y=Qn,y!==null))switch(y.tag){case 3:q_(y.stateNode.containerInfo,a,f,(y.mode&1)!==0);break;case 5:Wl(y.type,y.memoizedProps,y.stateNode,a,f,(y.mode&1)!==0)}g&&Xi(u)}else u.stateNode=Qe(g,a,f,u)}return Xn(u),null;case 13:if(pt(Nt),g=u.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(gt&&pr!==null&&u.mode&1&&!(u.flags&128))ih(),Ts(),u.flags|=98560,y=!1;else if(y=La(u),g!==null&&g.dehydrated!==null){if(a===null){if(!y)throw Error(o(318));if(!ot)throw Error(o(344));if(y=u.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(o(317));zi(y,u)}else Ts(),!(u.flags&128)&&(u.memoizedState=null),u.flags|=4;Xn(u),y=!1}else Pr!==null&&(Fy(Pr),Pr=null),y=!0;if(!y)return u.flags&65536?u:null}return u.flags&128?(u.lanes=f,u):(f=g!==null,f!==(a!==null&&a.memoizedState!==null)&&f&&(u.child.flags|=8192,u.mode&1&&(a===null||Nt.current&1?an===0&&(an=3):Uy())),u.updateQueue!==null&&(u.flags|=4),Xn(u),null);case 4:return tu(),dh(a,u),a===null&&et(u.stateNode.containerInfo),Xn(u),null;case 10:return Xt(u.type._context),Xn(u),null;case 17:return Dn(u.type)&&Aa(),Xn(u),null;case 19:if(pt(Nt),y=u.memoizedState,y===null)return Xn(u),null;if(g=(u.flags&128)!==0,T=y.rendering,T===null)if(g)fh(y,!1);else{if(an!==0||a!==null&&a.flags&128)for(a=u.child;a!==null;){if(T=sp(a),T!==null){for(u.flags|=128,fh(y,!1),a=T.updateQueue,a!==null&&(u.updateQueue=a,u.flags|=4),u.subtreeFlags=0,a=f,f=u.child;f!==null;)g=f,y=a,g.flags&=14680066,T=g.alternate,T===null?(g.childLanes=0,g.lanes=y,g.child=null,g.subtreeFlags=0,g.memoizedProps=null,g.memoizedState=null,g.updateQueue=null,g.dependencies=null,g.stateNode=null):(g.childLanes=T.childLanes,g.lanes=T.lanes,g.child=T.child,g.subtreeFlags=0,g.deletions=null,g.memoizedProps=T.memoizedProps,g.memoizedState=T.memoizedState,g.updateQueue=T.updateQueue,g.type=T.type,y=T.dependencies,g.dependencies=y===null?null:{lanes:y.lanes,firstContext:y.firstContext}),f=f.sibling;return ut(Nt,Nt.current&1|2),u.child}a=a.sibling}y.tail!==null&&Yt()>Dy&&(u.flags|=128,g=!0,fh(y,!1),u.lanes=4194304)}else{if(!g)if(a=sp(T),a!==null){if(u.flags|=128,g=!0,a=a.updateQueue,a!==null&&(u.updateQueue=a,u.flags|=4),fh(y,!0),y.tail===null&&y.tailMode==="hidden"&&!T.alternate&&!gt)return Xn(u),null}else 2*Yt()-y.renderingStartTime>Dy&&f!==1073741824&&(u.flags|=128,g=!0,fh(y,!1),u.lanes=4194304);y.isBackwards?(T.sibling=u.child,u.child=T):(a=y.last,a!==null?a.sibling=T:u.child=T,y.last=T)}return y.tail!==null?(u=y.tail,y.rendering=u,y.tail=u.sibling,y.renderingStartTime=Yt(),u.sibling=null,a=Nt.current,ut(Nt,g?a&1|2:a&1),u):(Xn(u),null);case 22:case 23:return Vy(),f=u.memoizedState!==null,a!==null&&a.memoizedState!==null!==f&&(u.flags|=8192),f&&u.mode&1?Br&1073741824&&(Xn(u),Ce&&u.subtreeFlags&6&&(u.flags|=8192)):Xn(u),null;case 24:return null;case 25:return null}throw Error(o(156,u.tag))}function mA(a,u){switch(Ss(u),u.tag){case 1:return Dn(u.type)&&Aa(),a=u.flags,a&65536?(u.flags=a&-65537|128,u):null;case 3:return tu(),pt(bn),pt(rn),ny(),a=u.flags,a&65536&&!(a&128)?(u.flags=a&-65537|128,u):null;case 5:return ey(u),null;case 13:if(pt(Nt),a=u.memoizedState,a!==null&&a.dehydrated!==null){if(u.alternate===null)throw Error(o(340));Ts()}return a=u.flags,a&65536?(u.flags=a&-65537|128,u):null;case 19:return pt(Nt),null;case 4:return tu(),null;case 10:return Xt(u.type._context),null;case 22:case 23:return Vy(),null;case 24:return null;default:return null}}var mp=!1,Jn=!1,_A=typeof WeakSet=="function"?WeakSet:Set,ge=null;function ru(a,u){var f=a.ref;if(f!==null)if(typeof f=="function")try{f(null)}catch(g){Rt(a,u,g)}else f.current=null}function Ey(a,u,f){try{f()}catch(g){Rt(a,u,g)}}var NC=!1;function yA(a,u){for(J(a.containerInfo),ge=u;ge!==null;)if(a=ge,u=a.child,(a.subtreeFlags&1028)!==0&&u!==null)u.return=a,ge=u;else for(;ge!==null;){a=ge;try{var f=a.alternate;if(a.flags&1024)switch(a.tag){case 0:case 11:case 15:break;case 1:if(f!==null){var g=f.memoizedProps,y=f.memoizedState,T=a.stateNode,U=T.getSnapshotBeforeUpdate(a.elementType===a.type?g:vi(a.type,g),y);T.__reactInternalSnapshotBeforeUpdate=U}break;case 3:Ce&&zc(a.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(G){Rt(a,a.return,G)}if(u=a.sibling,u!==null){u.return=a.return,ge=u;break}ge=a.return}return f=NC,NC=!1,f}function ph(a,u,f){var g=u.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var y=g=g.next;do{if((y.tag&a)===a){var T=y.destroy;y.destroy=void 0,T!==void 0&&Ey(u,f,T)}y=y.next}while(y!==g)}}function _p(a,u){if(u=u.updateQueue,u=u!==null?u.lastEffect:null,u!==null){var f=u=u.next;do{if((f.tag&a)===a){var g=f.create;f.destroy=g()}f=f.next}while(f!==u)}}function Sy(a){var u=a.ref;if(u!==null){var f=a.stateNode;switch(a.tag){case 5:a=Te(f);break;default:a=f}typeof u=="function"?u(a):u.current=a}}function bC(a){var u=a.alternate;u!==null&&(a.alternate=null,bC(u)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(u=a.stateNode,u!==null&&Cr(u)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function DC(a){return a.tag===5||a.tag===3||a.tag===4}function MC(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||DC(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Cy(a,u,f){var g=a.tag;if(g===5||g===6)a=a.stateNode,u?Ff(f,a,u):Mf(f,a);else if(g!==4&&(a=a.child,a!==null))for(Cy(a,u,f),a=a.sibling;a!==null;)Cy(a,u,f),a=a.sibling}function Ty(a,u,f){var g=a.tag;if(g===5||g===6)a=a.stateNode,u?Lf(f,a,u):Vl(f,a);else if(g!==4&&(a=a.child,a!==null))for(Ty(a,u,f),a=a.sibling;a!==null;)Ty(a,u,f),a=a.sibling}var On=null,wi=!1;function Ji(a,u,f){for(f=f.child;f!==null;)Iy(a,u,f),f=f.sibling}function Iy(a,u,f){if(qn&&typeof qn.onCommitFiberUnmount=="function")try{qn.onCommitFiberUnmount($i,f)}catch{}switch(f.tag){case 5:Jn||ru(f,u);case 6:if(Ce){var g=On,y=wi;On=null,Ji(a,u,f),On=g,wi=y,On!==null&&(wi?W_(On,f.stateNode):Uc(On,f.stateNode))}else Ji(a,u,f);break;case 18:Ce&&On!==null&&(wi?Hf(On,f.stateNode):Kc(On,f.stateNode));break;case 4:Ce?(g=On,y=wi,On=f.stateNode.containerInfo,wi=!0,Ji(a,u,f),On=g,wi=y):(Ze&&(g=f.stateNode.containerInfo,y=Bi(g),Bl(g,y)),Ji(a,u,f));break;case 0:case 11:case 14:case 15:if(!Jn&&(g=f.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){y=g=g.next;do{var T=y,U=T.destroy;T=T.tag,U!==void 0&&(T&2||T&4)&&Ey(f,u,U),y=y.next}while(y!==g)}Ji(a,u,f);break;case 1:if(!Jn&&(ru(f,u),g=f.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=f.memoizedProps,g.state=f.memoizedState,g.componentWillUnmount()}catch(G){Rt(f,u,G)}Ji(a,u,f);break;case 21:Ji(a,u,f);break;case 22:f.mode&1?(Jn=(g=Jn)||f.memoizedState!==null,Ji(a,u,f),Jn=g):Ji(a,u,f);break;default:Ji(a,u,f)}}function OC(a){var u=a.updateQueue;if(u!==null){a.updateQueue=null;var f=a.stateNode;f===null&&(f=a.stateNode=new _A),u.forEach(function(g){var y=PA.bind(null,a,g);f.has(g)||(f.add(g),g.then(y,y))})}}function Ei(a,u){var f=u.deletions;if(f!==null)for(var g=0;g<f.length;g++){var y=f[g];try{var T=a,U=u;if(Ce){var G=U;e:for(;G!==null;){switch(G.tag){case 5:On=G.stateNode,wi=!1;break e;case 3:On=G.stateNode.containerInfo,wi=!0;break e;case 4:On=G.stateNode.containerInfo,wi=!0;break e}G=G.return}if(On===null)throw Error(o(160));Iy(T,U,y),On=null,wi=!1}else Iy(T,U,y);var q=y.alternate;q!==null&&(q.return=null),y.return=null}catch(ae){Rt(y,u,ae)}}if(u.subtreeFlags&12854)for(u=u.child;u!==null;)LC(u,a),u=u.sibling}function LC(a,u){var f=a.alternate,g=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(Ei(u,a),Zi(a),g&4){try{ph(3,a,a.return),_p(3,a)}catch(de){Rt(a,a.return,de)}try{ph(5,a,a.return)}catch(de){Rt(a,a.return,de)}}break;case 1:Ei(u,a),Zi(a),g&512&&f!==null&&ru(f,f.return);break;case 5:if(Ei(u,a),Zi(a),g&512&&f!==null&&ru(f,f.return),Ce){if(a.flags&32){var y=a.stateNode;try{Vf(y)}catch(de){Rt(a,a.return,de)}}if(g&4&&(y=a.stateNode,y!=null)){var T=a.memoizedProps;if(f=f!==null?f.memoizedProps:T,g=a.type,u=a.updateQueue,a.updateQueue=null,u!==null)try{Pa(y,u,g,f,T,a)}catch(de){Rt(a,a.return,de)}}}break;case 6:if(Ei(u,a),Zi(a),g&4&&Ce){if(a.stateNode===null)throw Error(o(162));y=a.stateNode,T=a.memoizedProps,f=f!==null?f.memoizedProps:T;try{Of(y,f,T)}catch(de){Rt(a,a.return,de)}}break;case 3:if(Ei(u,a),Zi(a),g&4){if(Ce&&ot&&f!==null&&f.memoizedState.isDehydrated)try{Wf(u.containerInfo)}catch(de){Rt(a,a.return,de)}if(Ze){y=u.containerInfo,T=u.pendingChildren;try{Bl(y,T)}catch(de){Rt(a,a.return,de)}}}break;case 4:if(Ei(u,a),Zi(a),g&4&&Ze){T=a.stateNode,y=T.containerInfo,T=T.pendingChildren;try{Bl(y,T)}catch(de){Rt(a,a.return,de)}}break;case 13:Ei(u,a),Zi(a),y=a.child,y.flags&8192&&(T=y.memoizedState!==null,y.stateNode.isHidden=T,!T||y.alternate!==null&&y.alternate.memoizedState!==null||(by=Yt())),g&4&&OC(a);break;case 22:var U=f!==null&&f.memoizedState!==null;if(a.mode&1?(Jn=(f=Jn)||U,Ei(u,a),Jn=f):Ei(u,a),Zi(a),g&8192){if(f=a.memoizedState!==null,(a.stateNode.isHidden=f)&&!U&&a.mode&1)for(ge=a,g=a.child;g!==null;){for(u=ge=g;ge!==null;){U=ge;var G=U.child;switch(U.tag){case 0:case 11:case 14:case 15:ph(4,U,U.return);break;case 1:ru(U,U.return);var q=U.stateNode;if(typeof q.componentWillUnmount=="function"){var ae=U,_e=U.return;try{var be=ae;q.props=be.memoizedProps,q.state=be.memoizedState,q.componentWillUnmount()}catch(de){Rt(ae,_e,de)}}break;case 5:ru(U,U.return);break;case 22:if(U.memoizedState!==null){UC(u);continue}}G!==null?(G.return=U,ge=G):UC(u)}g=g.sibling}if(Ce){e:if(g=null,Ce)for(u=a;;){if(u.tag===5){if(g===null){g=u;try{y=u.stateNode,f?Bc(y):Bf(u.stateNode,u.memoizedProps)}catch(de){Rt(a,a.return,de)}}}else if(u.tag===6){if(g===null)try{T=u.stateNode,f?Uf(T):Ra(T,u.memoizedProps)}catch(de){Rt(a,a.return,de)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===a)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===a)break e;for(;u.sibling===null;){if(u.return===null||u.return===a)break e;g===u&&(g=null),u=u.return}g===u&&(g=null),u.sibling.return=u.return,u=u.sibling}}}break;case 19:Ei(u,a),Zi(a),g&4&&OC(a);break;case 21:break;default:Ei(u,a),Zi(a)}}function Zi(a){var u=a.flags;if(u&2){try{if(Ce){e:{for(var f=a.return;f!==null;){if(DC(f)){var g=f;break e}f=f.return}throw Error(o(160))}switch(g.tag){case 5:var y=g.stateNode;g.flags&32&&(Vf(y),g.flags&=-33);var T=MC(a);Ty(a,T,y);break;case 3:case 4:var U=g.stateNode.containerInfo,G=MC(a);Cy(a,G,U);break;default:throw Error(o(161))}}}catch(q){Rt(a,a.return,q)}a.flags&=-3}u&4096&&(a.flags&=-4097)}function vA(a,u,f){ge=a,FC(a)}function FC(a,u,f){for(var g=(a.mode&1)!==0;ge!==null;){var y=ge,T=y.child;if(y.tag===22&&g){var U=y.memoizedState!==null||mp;if(!U){var G=y.alternate,q=G!==null&&G.memoizedState!==null||Jn;G=mp;var ae=Jn;if(mp=U,(Jn=q)&&!ae)for(ge=y;ge!==null;)U=ge,q=U.child,U.tag===22&&U.memoizedState!==null?BC(y):q!==null?(q.return=U,ge=q):BC(y);for(;T!==null;)ge=T,FC(T),T=T.sibling;ge=y,mp=G,Jn=ae}VC(a)}else y.subtreeFlags&8772&&T!==null?(T.return=y,ge=T):VC(a)}}function VC(a){for(;ge!==null;){var u=ge;if(u.flags&8772){var f=u.alternate;try{if(u.flags&8772)switch(u.tag){case 0:case 11:case 15:Jn||_p(5,u);break;case 1:var g=u.stateNode;if(u.flags&4&&!Jn)if(f===null)g.componentDidMount();else{var y=u.elementType===u.type?f.memoizedProps:vi(u.type,f.memoizedProps);g.componentDidUpdate(y,f.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var T=u.updateQueue;T!==null&&zS(u,T,g);break;case 3:var U=u.updateQueue;if(U!==null){if(f=null,u.child!==null)switch(u.child.tag){case 5:f=Te(u.child.stateNode);break;case 1:f=u.child.stateNode}zS(u,U,f)}break;case 5:var G=u.stateNode;f===null&&u.flags&4&&G_(G,u.type,u.memoizedProps,u);break;case 6:break;case 4:break;case 12:break;case 13:if(ot&&u.memoizedState===null){var q=u.alternate;if(q!==null){var ae=q.memoizedState;if(ae!==null){var _e=ae.dehydrated;_e!==null&&qc(_e)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(o(163))}Jn||u.flags&512&&Sy(u)}catch(be){Rt(u,u.return,be)}}if(u===a){ge=null;break}if(f=u.sibling,f!==null){f.return=u.return,ge=f;break}ge=u.return}}function UC(a){for(;ge!==null;){var u=ge;if(u===a){ge=null;break}var f=u.sibling;if(f!==null){f.return=u.return,ge=f;break}ge=u.return}}function BC(a){for(;ge!==null;){var u=ge;try{switch(u.tag){case 0:case 11:case 15:var f=u.return;try{_p(4,u)}catch(q){Rt(u,f,q)}break;case 1:var g=u.stateNode;if(typeof g.componentDidMount=="function"){var y=u.return;try{g.componentDidMount()}catch(q){Rt(u,y,q)}}var T=u.return;try{Sy(u)}catch(q){Rt(u,T,q)}break;case 5:var U=u.return;try{Sy(u)}catch(q){Rt(u,U,q)}}}catch(q){Rt(u,u.return,q)}if(u===a){ge=null;break}var G=u.sibling;if(G!==null){G.return=u.return,ge=G;break}ge=u.return}}var yp=0,vp=1,wp=2,Ep=3,Sp=4;if(typeof Symbol=="function"&&Symbol.for){var gh=Symbol.for;yp=gh("selector.component"),vp=gh("selector.has_pseudo_class"),wp=gh("selector.role"),Ep=gh("selector.test_id"),Sp=gh("selector.text")}function ky(a){var u=Ut(a);if(u!=null){if(typeof u.memoizedProps["data-testname"]!="string")throw Error(o(364));return u}if(a=bf(a),a===null)throw Error(o(362));return a.stateNode.current}function Py(a,u){switch(u.$$typeof){case yp:if(a.type===u.value)return!0;break;case vp:e:{u=u.value,a=[a,0];for(var f=0;f<a.length;){var g=a[f++],y=a[f++],T=u[y];if(g.tag!==5||!ps(g)){for(;T!=null&&Py(g,T);)y++,T=u[y];if(y===u.length){u=!0;break e}else for(g=g.child;g!==null;)a.push(g,y),g=g.sibling}}u=!1}return u;case wp:if(a.tag===5&&Df(a.stateNode,u.value))return!0;break;case Sp:if((a.tag===5||a.tag===6)&&(a=Vc(a),a!==null&&0<=a.indexOf(u.value)))return!0;break;case Ep:if(a.tag===5&&(a=a.memoizedProps["data-testname"],typeof a=="string"&&a.toLowerCase()===u.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function Ry(a){switch(a.$$typeof){case yp:return"<"+(N(a.value)||"Unknown")+">";case vp:return":has("+(Ry(a)||"")+")";case wp:return'[role="'+a.value+'"]';case Sp:return'"'+a.value+'"';case Ep:return'[data-testname="'+a.value+'"]';default:throw Error(o(365))}}function zC(a,u){var f=[];a=[a,0];for(var g=0;g<a.length;){var y=a[g++],T=a[g++],U=u[T];if(y.tag!==5||!ps(y)){for(;U!=null&&Py(y,U);)T++,U=u[T];if(T===u.length)f.push(y);else for(y=y.child;y!==null;)a.push(y,T),y=y.sibling}}return f}function xy(a,u){if(!Ur)throw Error(o(363));a=ky(a),a=zC(a,u),u=[],a=Array.from(a);for(var f=0;f<a.length;){var g=a[f++];if(g.tag===5)ps(g)||u.push(g.stateNode);else for(g=g.child;g!==null;)a.push(g),g=g.sibling}return u}var wA=Math.ceil,Cp=l.ReactCurrentDispatcher,Ay=l.ReactCurrentOwner,Ht=l.ReactCurrentBatchConfig,Ve=0,yn=null,Jt=null,Ln=0,Br=0,iu=pi(0),an=0,mh=null,Ua=0,Tp=0,Ny=0,_h=null,xr=null,by=0,Dy=1/0,Ps=null;function su(){Dy=Yt()+500}var Ip=!1,My=null,yo=null,kp=!1,vo=null,Pp=0,yh=0,Oy=null,Rp=-1,xp=0;function Zn(){return Ve&6?Yt():Rp!==-1?Rp:Rp=Yt()}function wo(a){return a.mode&1?Ve&2&&Ln!==0?Ln&-Ln:gr.transition!==null?(xp===0&&(xp=Qf()),xp):(a=qe,a!==0?a:Wn()):1}function ti(a,u,f,g){if(50<yh)throw yh=0,Oy=null,Error(o(185));Ir(a,f,g),(!(Ve&2)||a!==yn)&&(a===yn&&(!(Ve&2)&&(Tp|=f),an===4&&Eo(a,Ln)),Ar(a,g),f===1&&Ve===0&&!(u.mode&1)&&(su(),Ql&&dr()))}function Ar(a,u){var f=a.callbackNode;Q_(a,u);var g=Da(a,a===yn?Ln:0);if(g===0)f!==null&&Xf(f),a.callbackNode=null,a.callbackPriority=0;else if(u=g&-g,a.callbackPriority!==u){if(f!=null&&Xf(f),u===1)a.tag===0?ep(GC.bind(null,a)):th(GC.bind(null,a)),Hn?Ui(function(){!(Ve&6)&&dr()}):Jc(Zc,dr),f=null;else{switch(ws(g)){case 1:f=Zc;break;case 4:f=Kl;break;case 16:f=po;break;case 536870912:f=Jf;break;default:f=po}f=JC(f,jC.bind(null,a))}a.callbackPriority=u,a.callbackNode=f}}function jC(a,u){if(Rp=-1,xp=0,Ve&6)throw Error(o(327));var f=a.callbackNode;if(ja()&&a.callbackNode!==f)return null;var g=Da(a,a===yn?Ln:0);if(g===0)return null;if(g&30||g&a.expiredLanes||u)u=Ap(a,g);else{u=g;var y=Ve;Ve|=2;var T=$C();(yn!==a||Ln!==u)&&(Ps=null,su(),Ba(a,u));do try{CA();break}catch(G){HC(a,G)}while(!0);Ge(),Cp.current=T,Ve=y,Jt!==null?u=0:(yn=null,Ln=0,u=an)}if(u!==0){if(u===2&&(y=Xc(a),y!==0&&(g=y,u=Ly(a,y))),u===1)throw f=mh,Ba(a,0),Eo(a,g),Ar(a,Yt()),f;if(u===6)Eo(a,g);else{if(y=a.current.alternate,!(g&30)&&!EA(y)&&(u=Ap(a,g),u===2&&(T=Xc(a),T!==0&&(g=T,u=Ly(a,T))),u===1))throw f=mh,Ba(a,0),Eo(a,g),Ar(a,Yt()),f;switch(a.finishedWork=y,a.finishedLanes=g,u){case 0:case 1:throw Error(o(345));case 2:za(a,xr,Ps);break;case 3:if(Eo(a,g),(g&130023424)===g&&(u=by+500-Yt(),10<u)){if(Da(a,0)!==0)break;if(y=a.suspendedLanes,(y&g)!==g){Zn(),a.pingedLanes|=a.suspendedLanes&y;break}a.timeoutHandle=j(za.bind(null,a,xr,Ps),u);break}za(a,xr,Ps);break;case 4:if(Eo(a,g),(g&4194240)===g)break;for(u=a.eventTimes,y=-1;0<g;){var U=31-$n(g);T=1<<U,U=u[U],U>y&&(y=U),g&=~T}if(g=y,g=Yt()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*wA(g/1960))-g,10<g){a.timeoutHandle=j(za.bind(null,a,xr,Ps),g);break}za(a,xr,Ps);break;case 5:za(a,xr,Ps);break;default:throw Error(o(329))}}}return Ar(a,Yt()),a.callbackNode===f?jC.bind(null,a):null}function Ly(a,u){var f=_h;return a.current.memoizedState.isDehydrated&&(Ba(a,u).flags|=256),a=Ap(a,u),a!==2&&(u=xr,xr=f,u!==null&&Fy(u)),a}function Fy(a){xr===null?xr=a:xr.push.apply(xr,a)}function EA(a){for(var u=a;;){if(u.flags&16384){var f=u.updateQueue;if(f!==null&&(f=f.stores,f!==null))for(var g=0;g<f.length;g++){var y=f[g],T=y.getSnapshot;y=y.value;try{if(!Ye(T(),y))return!1}catch{return!1}}}if(f=u.child,u.subtreeFlags&16384&&f!==null)f.return=u,u=f;else{if(u===a)break;for(;u.sibling===null;){if(u.return===null||u.return===a)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Eo(a,u){for(u&=~Ny,u&=~Tp,a.suspendedLanes|=u,a.pingedLanes&=~u,a=a.expirationTimes;0<u;){var f=31-$n(u),g=1<<f;a[f]=-1,u&=~g}}function GC(a){if(Ve&6)throw Error(o(327));ja();var u=Da(a,0);if(!(u&1))return Ar(a,Yt()),null;var f=Ap(a,u);if(a.tag!==0&&f===2){var g=Xc(a);g!==0&&(u=g,f=Ly(a,g))}if(f===1)throw f=mh,Ba(a,0),Eo(a,u),Ar(a,Yt()),f;if(f===6)throw Error(o(345));return a.finishedWork=a.current.alternate,a.finishedLanes=u,za(a,xr,Ps),Ar(a,Yt()),null}function WC(a){vo!==null&&vo.tag===0&&!(Ve&6)&&ja();var u=Ve;Ve|=1;var f=Ht.transition,g=qe;try{if(Ht.transition=null,qe=1,a)return a()}finally{qe=g,Ht.transition=f,Ve=u,!(Ve&6)&&dr()}}function Vy(){Br=iu.current,pt(iu)}function Ba(a,u){a.finishedWork=null,a.finishedLanes=0;var f=a.timeoutHandle;if(f!==ye&&(a.timeoutHandle=ye,ne(f)),Jt!==null)for(f=Jt.return;f!==null;){var g=f;switch(Ss(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&Aa();break;case 3:tu(),pt(bn),pt(rn),ny();break;case 5:ey(g);break;case 4:tu();break;case 13:pt(Nt);break;case 19:pt(Nt);break;case 10:Xt(g.type._context);break;case 22:case 23:Vy()}f=f.return}if(yn=a,Jt=a=So(a.current,null),Ln=Br=u,an=0,mh=null,Ny=Tp=Ua=0,xr=_h=null,yi!==null){for(u=0;u<yi.length;u++)if(f=yi[u],g=f.interleaved,g!==null){f.interleaved=null;var y=g.next,T=f.pending;if(T!==null){var U=T.next;T.next=y,g.next=U}f.pending=g}yi=null}return a}function HC(a,u){do{var f=Jt;try{if(Ge(),op.current=cp,ap){for(var g=bt.memoizedState;g!==null;){var y=g.queue;y!==null&&(y.pending=null),g=g.next}ap=!1}if(Va=0,_n=on=bt=null,ah=!1,lh=0,Ay.current=null,f===null||f.return===null){an=1,mh=u,Jt=null;break}e:{var T=a,U=f.return,G=f,q=u;if(u=Ln,G.flags|=32768,q!==null&&typeof q=="object"&&typeof q.then=="function"){var ae=q,_e=G,be=_e.tag;if(!(_e.mode&1)&&(be===0||be===11||be===15)){var de=_e.alternate;de?(_e.updateQueue=de.updateQueue,_e.memoizedState=de.memoizedState,_e.lanes=de.lanes):(_e.updateQueue=null,_e.memoizedState=null)}var It=mC(U);if(It!==null){It.flags&=-257,_C(It,U,G,T,u),It.mode&1&&gC(T,ae,u),u=It,q=ae;var yt=u.updateQueue;if(yt===null){var Nr=new Set;Nr.add(q),u.updateQueue=Nr}else yt.add(q);break e}else{if(!(u&1)){gC(T,ae,u),Uy();break e}q=Error(o(426))}}else if(gt&&G.mode&1){var Rs=mC(U);if(Rs!==null){!(Rs.flags&65536)&&(Rs.flags|=256),_C(Rs,U,G,T,u),go(nu(q,G));break e}}T=q=nu(q,G),an!==4&&(an=2),_h===null?_h=[T]:_h.push(T),T=U;do{switch(T.tag){case 3:T.flags|=65536,u&=-u,T.lanes|=u;var $=fC(T,q,u);BS(T,$);break e;case 1:G=q;var W=T.type,Q=T.stateNode;if(!(T.flags&128)&&(typeof W.getDerivedStateFromError=="function"||Q!==null&&typeof Q.componentDidCatch=="function"&&(yo===null||!yo.has(Q)))){T.flags|=65536,u&=-u,T.lanes|=u;var pe=pC(T,G,u);BS(T,pe);break e}}T=T.return}while(T!==null)}KC(f)}catch(Ee){u=Ee,Jt===f&&f!==null&&(Jt=f=f.return);continue}break}while(!0)}function $C(){var a=Cp.current;return Cp.current=cp,a===null?cp:a}function Uy(){(an===0||an===3||an===2)&&(an=4),yn===null||!(Ua&268435455)&&!(Tp&268435455)||Eo(yn,Ln)}function Ap(a,u){var f=Ve;Ve|=2;var g=$C();(yn!==a||Ln!==u)&&(Ps=null,Ba(a,u));do try{SA();break}catch(y){HC(a,y)}while(!0);if(Ge(),Ve=f,Cp.current=g,Jt!==null)throw Error(o(261));return yn=null,Ln=0,an}function SA(){for(;Jt!==null;)qC(Jt)}function CA(){for(;Jt!==null&&!Y_();)qC(Jt)}function qC(a){var u=XC(a.alternate,a,Br);a.memoizedProps=a.pendingProps,u===null?KC(a):Jt=u,Ay.current=null}function KC(a){var u=a;do{var f=u.alternate;if(a=u.return,u.flags&32768){if(f=mA(f,u),f!==null){f.flags&=32767,Jt=f;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{an=6,Jt=null;return}}else if(f=gA(f,u,Br),f!==null){Jt=f;return}if(u=u.sibling,u!==null){Jt=u;return}Jt=u=a}while(u!==null);an===0&&(an=5)}function za(a,u,f){var g=qe,y=Ht.transition;try{Ht.transition=null,qe=1,TA(a,u,f,g)}finally{Ht.transition=y,qe=g}return null}function TA(a,u,f,g){do ja();while(vo!==null);if(Ve&6)throw Error(o(327));f=a.finishedWork;var y=a.finishedLanes;if(f===null)return null;if(a.finishedWork=null,a.finishedLanes=0,f===a.current)throw Error(o(177));a.callbackNode=null,a.callbackPriority=0;var T=f.lanes|f.childLanes;if(Yf(a,T),a===yn&&(Jt=yn=null,Ln=0),!(f.subtreeFlags&2064)&&!(f.flags&2064)||kp||(kp=!0,JC(po,function(){return ja(),null})),T=(f.flags&15990)!==0,f.subtreeFlags&15990||T){T=Ht.transition,Ht.transition=null;var U=qe;qe=1;var G=Ve;Ve|=4,Ay.current=null,yA(a,f),LC(f,a),X(a.containerInfo),a.current=f,vA(f),Hi(),Ve=G,qe=U,Ht.transition=T}else a.current=f;if(kp&&(kp=!1,vo=a,Pp=y),T=a.pendingLanes,T===0&&(yo=null),Zf(f.stateNode),Ar(a,Yt()),u!==null)for(g=a.onRecoverableError,f=0;f<u.length;f++)y=u[f],g(y.value,{componentStack:y.stack,digest:y.digest});if(Ip)throw Ip=!1,a=My,My=null,a;return Pp&1&&a.tag!==0&&ja(),T=a.pendingLanes,T&1?a===Oy?yh++:(yh=0,Oy=a):yh=0,dr(),null}function ja(){if(vo!==null){var a=ws(Pp),u=Ht.transition,f=qe;try{if(Ht.transition=null,qe=16>a?16:a,vo===null)var g=!1;else{if(a=vo,vo=null,Pp=0,Ve&6)throw Error(o(331));var y=Ve;for(Ve|=4,ge=a.current;ge!==null;){var T=ge,U=T.child;if(ge.flags&16){var G=T.deletions;if(G!==null){for(var q=0;q<G.length;q++){var ae=G[q];for(ge=ae;ge!==null;){var _e=ge;switch(_e.tag){case 0:case 11:case 15:ph(8,_e,T)}var be=_e.child;if(be!==null)be.return=_e,ge=be;else for(;ge!==null;){_e=ge;var de=_e.sibling,It=_e.return;if(bC(_e),_e===ae){ge=null;break}if(de!==null){de.return=It,ge=de;break}ge=It}}}var yt=T.alternate;if(yt!==null){var Nr=yt.child;if(Nr!==null){yt.child=null;do{var Rs=Nr.sibling;Nr.sibling=null,Nr=Rs}while(Nr!==null)}}ge=T}}if(T.subtreeFlags&2064&&U!==null)U.return=T,ge=U;else e:for(;ge!==null;){if(T=ge,T.flags&2048)switch(T.tag){case 0:case 11:case 15:ph(9,T,T.return)}var $=T.sibling;if($!==null){$.return=T.return,ge=$;break e}ge=T.return}}var W=a.current;for(ge=W;ge!==null;){U=ge;var Q=U.child;if(U.subtreeFlags&2064&&Q!==null)Q.return=U,ge=Q;else e:for(U=W;ge!==null;){if(G=ge,G.flags&2048)try{switch(G.tag){case 0:case 11:case 15:_p(9,G)}}catch(Ee){Rt(G,G.return,Ee)}if(G===U){ge=null;break e}var pe=G.sibling;if(pe!==null){pe.return=G.return,ge=pe;break e}ge=G.return}}if(Ve=y,dr(),qn&&typeof qn.onPostCommitFiberRoot=="function")try{qn.onPostCommitFiberRoot($i,a)}catch{}g=!0}return g}finally{qe=f,Ht.transition=u}}return!1}function QC(a,u,f){u=nu(f,u),u=fC(a,u,1),a=_o(a,u,1),u=Zn(),a!==null&&(Ir(a,1,u),Ar(a,u))}function Rt(a,u,f){if(a.tag===3)QC(a,a,f);else for(;u!==null;){if(u.tag===3){QC(u,a,f);break}else if(u.tag===1){var g=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(yo===null||!yo.has(g))){a=nu(f,a),a=pC(u,a,1),u=_o(u,a,1),a=Zn(),u!==null&&(Ir(u,1,a),Ar(u,a));break}}u=u.return}}function IA(a,u,f){var g=a.pingCache;g!==null&&g.delete(u),u=Zn(),a.pingedLanes|=a.suspendedLanes&f,yn===a&&(Ln&f)===f&&(an===4||an===3&&(Ln&130023424)===Ln&&500>Yt()-by?Ba(a,0):Ny|=f),Ar(a,u)}function YC(a,u){u===0&&(a.mode&1?(u=Wi,Wi<<=1,!(Wi&130023424)&&(Wi=4194304)):u=1);var f=Zn();a=Ki(a,u),a!==null&&(Ir(a,u,f),Ar(a,f))}function kA(a){var u=a.memoizedState,f=0;u!==null&&(f=u.retryLane),YC(a,f)}function PA(a,u){var f=0;switch(a.tag){case 13:var g=a.stateNode,y=a.memoizedState;y!==null&&(f=y.retryLane);break;case 19:g=a.stateNode;break;default:throw Error(o(314))}g!==null&&g.delete(u),YC(a,f)}var XC;XC=function(a,u,f){if(a!==null)if(a.memoizedProps!==u.pendingProps||bn.current)Rr=!0;else{if(!(a.lanes&f)&&!(u.flags&128))return Rr=!1,pA(a,u,f);Rr=!!(a.flags&131072)}else Rr=!1,gt&&u.flags&1048576&&tp(u,Xl,u.index);switch(u.lanes=0,u.tag){case 2:var g=u.type;fp(a,u),a=u.pendingProps;var y=fo(u,rn.current);mn(u,f),y=sy(null,u,g,a,y,f);var T=oy();return u.flags|=1,typeof y=="object"&&y!==null&&typeof y.render=="function"&&y.$$typeof===void 0?(u.tag=1,u.memoizedState=null,u.updateQueue=null,Dn(g)?(T=!0,Tr(u)):T=!1,u.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,J_(u),y.updater=hp,u.stateNode=y,y._reactInternals=u,dy(u,g,a,f),u=my(null,u,g,!0,T,f)):(u.tag=0,gt&&T&&Jl(u),mr(null,u,y,f),u=u.child),u;case 16:g=u.elementType;e:{switch(fp(a,u),a=u.pendingProps,y=g._init,g=y(g._payload),u.type=g,y=u.tag=xA(g),a=vi(g,a),y){case 0:u=gy(null,u,g,a,f);break e;case 1:u=CC(null,u,g,a,f);break e;case 11:u=yC(null,u,g,a,f);break e;case 14:u=vC(null,u,g,vi(g.type,a),f);break e}throw Error(o(306,g,""))}return u;case 0:return g=u.type,y=u.pendingProps,y=u.elementType===g?y:vi(g,y),gy(a,u,g,y,f);case 1:return g=u.type,y=u.pendingProps,y=u.elementType===g?y:vi(g,y),CC(a,u,g,y,f);case 3:e:{if(TC(u),a===null)throw Error(o(387));g=u.pendingProps,T=u.memoizedState,y=T.element,US(a,u),ip(u,g,null,f);var U=u.memoizedState;if(g=U.element,ot&&T.isDehydrated)if(T={element:g,isDehydrated:!1,cache:U.cache,pendingSuspenseBoundaries:U.pendingSuspenseBoundaries,transitions:U.transitions},u.updateQueue.baseState=T,u.memoizedState=T,u.flags&256){y=nu(Error(o(423)),u),u=IC(a,u,g,f,y);break e}else if(g!==y){y=nu(Error(o(424)),u),u=IC(a,u,g,f,y);break e}else for(ot&&(pr=jl(u.stateNode.containerInfo),Qn=u,gt=!0,Pr=null,Cs=!1),f=H(u,null,g,f),u.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(Ts(),g===y){u=ks(a,u,f);break e}mr(a,u,g,f)}u=u.child}return u;case 5:return jS(u),a===null&&_i(u),g=u.type,y=u.pendingProps,T=a!==null?a.memoizedProps:null,U=y.children,ct(g,y)?U=null:T!==null&&ct(g,T)&&(u.flags|=32),SC(a,u),mr(a,u,U,f),u.child;case 6:return a===null&&_i(u),null;case 13:return kC(a,u,f);case 4:return Z_(u,u.stateNode.containerInfo),g=u.pendingProps,a===null?u.child=F(u,null,g,f):mr(a,u,g,f),u.child;case 11:return g=u.type,y=u.pendingProps,y=u.elementType===g?y:vi(g,y),yC(a,u,g,y,f);case 7:return mr(a,u,u.pendingProps,f),u.child;case 8:return mr(a,u,u.pendingProps.children,f),u.child;case 12:return mr(a,u,u.pendingProps.children,f),u.child;case 10:e:{if(g=u.type._context,y=u.pendingProps,T=u.memoizedProps,U=y.value,sn(u,g,U),T!==null)if(Ye(T.value,U)){if(T.children===y.children&&!bn.current){u=ks(a,u,f);break e}}else for(T=u.child,T!==null&&(T.return=u);T!==null;){var G=T.dependencies;if(G!==null){U=T.child;for(var q=G.firstContext;q!==null;){if(q.context===g){if(T.tag===1){q=Is(-1,f&-f),q.tag=2;var ae=T.updateQueue;if(ae!==null){ae=ae.shared;var _e=ae.pending;_e===null?q.next=q:(q.next=_e.next,_e.next=q),ae.pending=q}}T.lanes|=f,q=T.alternate,q!==null&&(q.lanes|=f),qi(T.return,f,u),G.lanes|=f;break}q=q.next}}else if(T.tag===10)U=T.type===u.type?null:T.child;else if(T.tag===18){if(U=T.return,U===null)throw Error(o(341));U.lanes|=f,G=U.alternate,G!==null&&(G.lanes|=f),qi(U,f,u),U=T.sibling}else U=T.child;if(U!==null)U.return=T;else for(U=T;U!==null;){if(U===u){U=null;break}if(T=U.sibling,T!==null){T.return=U.return,U=T;break}U=U.return}T=U}mr(a,u,y.children,f),u=u.child}return u;case 9:return y=u.type,g=u.pendingProps.children,mn(u,f),y=Mn(y),g=g(y),u.flags|=1,mr(a,u,g,f),u.child;case 14:return g=u.type,y=vi(g,u.pendingProps),y=vi(g.type,y),vC(a,u,g,y,f);case 15:return wC(a,u,u.type,u.pendingProps,f);case 17:return g=u.type,y=u.pendingProps,y=u.elementType===g?y:vi(g,y),fp(a,u),u.tag=1,Dn(g)?(a=!0,Tr(u)):a=!1,mn(u,f),hC(u,g,y),dy(u,g,y,f),my(null,u,g,!0,a,f);case 19:return RC(a,u,f);case 22:return EC(a,u,f)}throw Error(o(156,u.tag))};function JC(a,u){return Jc(a,u)}function RA(a,u,f,g){this.tag=a,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ni(a,u,f,g){return new RA(a,u,f,g)}function By(a){return a=a.prototype,!(!a||!a.isReactComponent)}function xA(a){if(typeof a=="function")return By(a)?1:0;if(a!=null){if(a=a.$$typeof,a===x)return 11;if(a===P)return 14}return 2}function So(a,u){var f=a.alternate;return f===null?(f=ni(a.tag,u,a.key,a.mode),f.elementType=a.elementType,f.type=a.type,f.stateNode=a.stateNode,f.alternate=a,a.alternate=f):(f.pendingProps=u,f.type=a.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=a.flags&14680064,f.childLanes=a.childLanes,f.lanes=a.lanes,f.child=a.child,f.memoizedProps=a.memoizedProps,f.memoizedState=a.memoizedState,f.updateQueue=a.updateQueue,u=a.dependencies,f.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},f.sibling=a.sibling,f.index=a.index,f.ref=a.ref,f}function Np(a,u,f,g,y,T){var U=2;if(g=a,typeof a=="function")By(a)&&(U=1);else if(typeof a=="string")U=5;else e:switch(a){case p:return Ga(f.children,y,T,u);case m:U=8,y|=8;break;case _:return a=ni(12,f,u,y|2),a.elementType=_,a.lanes=T,a;case M:return a=ni(13,f,u,y),a.elementType=M,a.lanes=T,a;case R:return a=ni(19,f,u,y),a.elementType=R,a.lanes=T,a;case k:return bp(f,y,T,u);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case S:U=10;break e;case E:U=9;break e;case x:U=11;break e;case P:U=14;break e;case v:U=16,g=null;break e}throw Error(o(130,a==null?a:typeof a,""))}return u=ni(U,f,u,y),u.elementType=a,u.type=g,u.lanes=T,u}function Ga(a,u,f,g){return a=ni(7,a,g,u),a.lanes=f,a}function bp(a,u,f,g){return a=ni(22,a,g,u),a.elementType=k,a.lanes=f,a.stateNode={isHidden:!1},a}function zy(a,u,f){return a=ni(6,a,null,u),a.lanes=f,a}function jy(a,u,f){return u=ni(4,a.children!==null?a.children:[],a.key,u),u.lanes=f,u.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},u}function AA(a,u,f,g,y){this.tag=u,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=ye,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vs(0),this.expirationTimes=vs(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vs(0),this.identifierPrefix=g,this.onRecoverableError=y,ot&&(this.mutableSourceEagerHydrationData=null)}function ZC(a,u,f,g,y,T,U,G,q){return a=new AA(a,u,f,G,q),u===1?(u=1,T===!0&&(u|=8)):u=0,T=ni(3,null,null,u),a.current=T,T.stateNode=a,T.memoizedState={element:g,isDehydrated:f,cache:null,transitions:null,pendingSuspenseBoundaries:null},J_(T),a}function e4(a){if(!a)return Qr;a=a._reactInternals;e:{if(b(a)!==a||a.tag!==1)throw Error(o(170));var u=a;do{switch(u.tag){case 3:u=u.stateNode.context;break e;case 1:if(Dn(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break e}}u=u.return}while(u!==null);throw Error(o(171))}if(a.tag===1){var f=a.type;if(Dn(f))return ji(a,f,u)}return u}function t4(a){var u=a._reactInternals;if(u===void 0)throw typeof a.render=="function"?Error(o(188)):(a=Object.keys(a).join(","),Error(o(268,a)));return a=B(u),a===null?null:a.stateNode}function n4(a,u){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var f=a.retryLane;a.retryLane=f!==0&&f<u?f:u}}function Dp(a,u){n4(a,u),(a=a.alternate)&&n4(a,u)}function NA(a){return a=B(a),a===null?null:a.stateNode}function bA(){return null}return t.attemptContinuousHydration=function(a){if(a.tag===13){var u=Ki(a,134217728);if(u!==null){var f=Zn();ti(u,a,134217728,f)}Dp(a,134217728)}},t.attemptDiscreteHydration=function(a){if(a.tag===13){var u=Ki(a,1);if(u!==null){var f=Zn();ti(u,a,1,f)}Dp(a,1)}},t.attemptHydrationAtCurrentPriority=function(a){if(a.tag===13){var u=wo(a),f=Ki(a,u);if(f!==null){var g=Zn();ti(f,a,u,g)}Dp(a,u)}},t.attemptSynchronousHydration=function(a){switch(a.tag){case 3:var u=a.stateNode;if(u.current.memoizedState.isDehydrated){var f=ba(u.pendingLanes);f!==0&&(ql(u,f|1),Ar(u,Yt()),!(Ve&6)&&(su(),dr()))}break;case 13:WC(function(){var g=Ki(a,1);if(g!==null){var y=Zn();ti(g,a,1,y)}}),Dp(a,1)}},t.batchedUpdates=function(a,u){var f=Ve;Ve|=1;try{return a(u)}finally{Ve=f,Ve===0&&(su(),Ql&&dr())}},t.createComponentSelector=function(a){return{$$typeof:yp,value:a}},t.createContainer=function(a,u,f,g,y,T,U){return ZC(a,u,!1,null,f,g,y,T,U)},t.createHasPseudoClassSelector=function(a){return{$$typeof:vp,value:a}},t.createHydrationContainer=function(a,u,f,g,y,T,U,G,q){return a=ZC(f,g,!0,a,y,T,U,G,q),a.context=e4(null),f=a.current,g=Zn(),y=wo(f),T=Is(g,y),T.callback=u??null,_o(f,T,y),a.current.lanes=y,Ir(a,y,g),Ar(a,g),a},t.createPortal=function(a,u,f){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:h,key:g==null?null:""+g,children:a,containerInfo:u,implementation:f}},t.createRoleSelector=function(a){return{$$typeof:wp,value:a}},t.createTestNameSelector=function(a){return{$$typeof:Ep,value:a}},t.createTextSelector=function(a){return{$$typeof:Sp,value:a}},t.deferredUpdates=function(a){var u=qe,f=Ht.transition;try{return Ht.transition=null,qe=16,a()}finally{qe=u,Ht.transition=f}},t.discreteUpdates=function(a,u,f,g,y){var T=qe,U=Ht.transition;try{return Ht.transition=null,qe=1,a(u,f,g,y)}finally{qe=T,Ht.transition=U,Ve===0&&su()}},t.findAllNodes=xy,t.findBoundingRects=function(a,u){if(!Ur)throw Error(o(363));u=xy(a,u),a=[];for(var f=0;f<u.length;f++)a.push(j_(u[f]));for(u=a.length-1;0<u;u--){f=a[u];for(var g=f.x,y=g+f.width,T=f.y,U=T+f.height,G=u-1;0<=G;G--)if(u!==G){var q=a[G],ae=q.x,_e=ae+q.width,be=q.y,de=be+q.height;if(g>=ae&&T>=be&&y<=_e&&U<=de){a.splice(u,1);break}else if(g!==ae||f.width!==q.width||de<T||be>U){if(!(T!==be||f.height!==q.height||_e<g||ae>y)){ae>g&&(q.width+=ae-g,q.x=g),_e<y&&(q.width=y-ae),a.splice(u,1);break}}else{be>T&&(q.height+=be-T,q.y=T),de<U&&(q.height=U-be),a.splice(u,1);break}}}return a},t.findHostInstance=t4,t.findHostInstanceWithNoPortals=function(a){return a=L(a),a=a!==null?he(a):null,a===null?null:a.stateNode},t.findHostInstanceWithWarning=function(a){return t4(a)},t.flushControlled=function(a){var u=Ve;Ve|=1;var f=Ht.transition,g=qe;try{Ht.transition=null,qe=1,a()}finally{qe=g,Ht.transition=f,Ve=u,Ve===0&&(su(),dr())}},t.flushPassiveEffects=ja,t.flushSync=WC,t.focusWithin=function(a,u){if(!Ur)throw Error(o(363));for(a=ky(a),u=zC(a,u),u=Array.from(u),a=0;a<u.length;){var f=u[a++];if(!ps(f)){if(f.tag===5&&pn(f.stateNode))return!0;for(f=f.child;f!==null;)u.push(f),f=f.sibling}}return!1},t.getCurrentUpdatePriority=function(){return qe},t.getFindAllNodesFailureDescription=function(a,u){if(!Ur)throw Error(o(363));var f=0,g=[];a=[ky(a),0];for(var y=0;y<a.length;){var T=a[y++],U=a[y++],G=u[U];if((T.tag!==5||!ps(T))&&(Py(T,G)&&(g.push(Ry(G)),U++,U>f&&(f=U)),U<u.length))for(T=T.child;T!==null;)a.push(T,U),T=T.sibling}if(f<u.length){for(a=[];f<u.length;f++)a.push(Ry(u[f]));return`findAllNodes was able to match part of the selector:
  `+(g.join(" > ")+`

No matching component was found for:
  `)+a.join(" > ")}return null},t.getPublicRootInstance=function(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return Te(a.child.stateNode);default:return a.child.stateNode}},t.injectIntoDevTools=function(a){if(a={bundleType:a.bundleType,version:a.version,rendererPackageName:a.rendererPackageName,rendererConfig:a.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:l.ReactCurrentDispatcher,findHostInstanceByFiber:NA,findFiberByHostInstance:a.findFiberByHostInstance||bA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")a=!1;else{var u=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(u.isDisabled||!u.supportsFiber)a=!0;else{try{$i=u.inject(a),qn=u}catch{}a=!!u.checkDCE}}return a},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(a,u,f,g){if(!Ur)throw Error(o(363));a=xy(a,u);var y=An(a,f,g).disconnect;return{disconnect:function(){y()}}},t.registerMutableSourceForHydration=function(a,u){var f=u._getVersion;f=f(u._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[u,f]:a.mutableSourceEagerHydrationData.push(u,f)},t.runWithPriority=function(a,u){var f=qe;try{return qe=a,u()}finally{qe=f}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(a,u,f,g){var y=u.current,T=Zn(),U=wo(y);return f=e4(f),u.context===null?u.context=f:u.pendingContext=f,u=Is(T,U),u.payload={element:a},g=g===void 0?null:g,g!==null&&(u.callback=g),a=_o(y,u,U),a!==null&&(ti(a,y,U,T),rp(a,y,U)),U},t};Vx.exports=wH;var EH=Vx.exports;const SH=Wm(EH);var Ux={exports:{}},Fl={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Fl.ConcurrentRoot=1;Fl.ContinuousEventPriority=4;Fl.DefaultEventPriority=16;Fl.DiscreteEventPriority=1;Fl.IdleEventPriority=536870912;Fl.LegacyRoot=0;Ux.exports=Fl;var Bx=Ux.exports;const G5={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let W5=!1,H5=!1;const DS=".react-konva-event",CH=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,TH=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,IH={};function V_(n,e,t=IH){if(!W5&&"zIndex"in e&&(console.warn(TH),W5=!0),!H5&&e.draggable){var r=e.x!==void 0||e.y!==void 0,i=e.onDragEnd||e.onDragMove;r&&!i&&(console.warn(CH),H5=!0)}for(var s in t)if(!G5[s]){var o=s.slice(0,2)==="on",l=t[s]!==e[s];if(o&&l){var c=s.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),n.off(c,t[s])}var h=!e.hasOwnProperty(s);h&&n.setAttr(s,void 0)}var p=e._useStrictMode,m={},_=!1;const S={};for(var s in e)if(!G5[s]){var o=s.slice(0,2)==="on",E=t[s]!==e[s];if(o&&E){var c=s.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),e[s]&&(S[c]=e[s])}!o&&(e[s]!==t[s]||p&&e[s]!==n.getAttr(s))&&(_=!0,m[s]=e[s])}_&&(n.setAttrs(m),ka(n));for(var c in S)n.on(c+DS,S[c])}function ka(n){if(!Oe.Konva.autoDrawEnabled){var e=n.getLayer()||n.getStage();e&&e.batchDraw()}}const zx={},kH={};Zd.Node.prototype._applyProps=V_;function PH(n,e){if(typeof e=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${e}`);return}n.add(e),ka(n)}function RH(n,e,t){let r=Zd[n];r||(console.error(`Konva has no node with the type ${n}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${n}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),r=Zd.Group);const i={},s={};for(var o in e){var l=o.slice(0,2)==="on";l?s[o]=e[o]:i[o]=e[o]}const c=new r(i);return V_(c,s),c}function xH(n,e,t){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${n}"`)}function AH(n,e,t){return!1}function NH(n){return n}function bH(){return null}function DH(){return null}function MH(n,e,t,r){return kH}function OH(){}function LH(n){}function FH(n,e){return!1}function VH(){return zx}function UH(){return zx}const BH=setTimeout,zH=clearTimeout,jH=-1;function GH(n,e){return!1}const WH=!1,HH=!0,$H=!0;function qH(n,e){e.parent===n?e.moveToTop():n.add(e),ka(n)}function KH(n,e){e.parent===n?e.moveToTop():n.add(e),ka(n)}function jx(n,e,t){e._remove(),n.add(e),e.setZIndex(t.getZIndex()),ka(n)}function QH(n,e,t){jx(n,e,t)}function YH(n,e){e.destroy(),e.off(DS),ka(n)}function XH(n,e){e.destroy(),e.off(DS),ka(n)}function JH(n,e,t){console.error(`Text components are not yet supported in ReactKonva. You text is: "${t}"`)}function ZH(n,e,t){}function e$(n,e,t,r,i){V_(n,i,r)}function t$(n){n.hide(),ka(n)}function n$(n){}function r$(n,e){(e.visible==null||e.visible)&&n.show()}function i$(n,e){}function s$(n){}function o$(){}const a$=()=>Bx.DefaultEventPriority,l$=Object.freeze(Object.defineProperty({__proto__:null,appendChild:qH,appendChildToContainer:KH,appendInitialChild:PH,cancelTimeout:zH,clearContainer:s$,commitMount:ZH,commitTextUpdate:JH,commitUpdate:e$,createInstance:RH,createTextInstance:xH,detachDeletedInstance:o$,finalizeInitialChildren:AH,getChildHostContext:UH,getCurrentEventPriority:a$,getPublicInstance:NH,getRootHostContext:VH,hideInstance:t$,hideTextInstance:n$,idlePriority:$h.unstable_IdlePriority,insertBefore:jx,insertInContainerBefore:QH,isPrimaryRenderer:WH,noTimeout:jH,now:$h.unstable_now,prepareForCommit:bH,preparePortalMount:DH,prepareUpdate:MH,removeChild:YH,removeChildFromContainer:XH,resetAfterCommit:OH,resetTextContent:LH,run:$h.unstable_runWithPriority,scheduleTimeout:BH,shouldDeprioritizeSubtree:FH,shouldSetTextContent:GH,supportsMutation:$H,unhideInstance:r$,unhideTextInstance:i$,warnsIfNotActing:HH},Symbol.toStringTag,{value:"Module"}));var u$=Object.defineProperty,c$=Object.defineProperties,h$=Object.getOwnPropertyDescriptors,$5=Object.getOwnPropertySymbols,d$=Object.prototype.hasOwnProperty,f$=Object.prototype.propertyIsEnumerable,q5=(n,e,t)=>e in n?u$(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,K5=(n,e)=>{for(var t in e||(e={}))d$.call(e,t)&&q5(n,t,e[t]);if($5)for(var t of $5(e))f$.call(e,t)&&q5(n,t,e[t]);return n},p$=(n,e)=>c$(n,h$(e)),Q5,Y5;typeof window<"u"&&((Q5=window.document)!=null&&Q5.createElement||((Y5=window.navigator)==null?void 0:Y5.product)==="ReactNative")?ee.useLayoutEffect:ee.useEffect;function Gx(n,e,t){if(!n)return;if(t(n)===!0)return n;let r=n.child;for(;r;){const i=Gx(r,e,t);if(i)return i;r=r.sibling}}function Wx(n){try{return Object.defineProperties(n,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return n}}const X5=console.error;console.error=function(){const n=[...arguments].join("");if(n!=null&&n.startsWith("Warning:")&&n.includes("useContext")){console.error=X5;return}return X5.apply(this,arguments)};const MS=Wx(ee.createContext(null));class Hx extends ee.Component{render(){return ee.createElement(MS.Provider,{value:this._reactInternals},this.props.children)}}function g$(){const n=ee.useContext(MS);if(n===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=ee.useId();return ee.useMemo(()=>{for(const r of[n,n==null?void 0:n.alternate]){if(!r)continue;const i=Gx(r,!1,s=>{let o=s.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(i)return i}},[n,e])}function m$(){const n=g$(),[e]=ee.useState(()=>new Map);e.clear();let t=n;for(;t;){if(t.type&&typeof t.type=="object"){const i=t.type._context===void 0&&t.type.Provider===t.type?t.type:t.type._context;i&&i!==MS&&!e.has(i)&&e.set(i,ee.useContext(Wx(i)))}t=t.return}return e}function _$(){const n=m$();return ee.useMemo(()=>Array.from(n.keys()).reduce((e,t)=>r=>ee.createElement(e,null,ee.createElement(t.Provider,p$(K5({},r),{value:n.get(t)}))),e=>ee.createElement(Hx,K5({},e))),[n])}function y$(n){const e=Sn.useRef({});return Sn.useLayoutEffect(()=>{e.current=n}),Sn.useLayoutEffect(()=>()=>{e.current={}},[]),e.current}const v$=n=>{const e=Sn.useRef(null),t=Sn.useRef(null),r=Sn.useRef(null),i=y$(n),s=_$(),o=l=>{const{forwardedRef:c}=n;c&&(typeof c=="function"?c(l):c.current=l)};return Sn.useLayoutEffect(()=>(t.current=new Zd.Stage({width:n.width,height:n.height,container:e.current}),o(t.current),r.current=Hh.createContainer(t.current,Bx.LegacyRoot,!1,null),Hh.updateContainer(Sn.createElement(s,{},n.children),r.current),()=>{Zd.isBrowser&&(o(null),Hh.updateContainer(null,r.current,null),t.current.destroy())}),[]),Sn.useLayoutEffect(()=>{o(t.current),V_(t.current,n,i),Hh.updateContainer(Sn.createElement(s,{},n.children),r.current,null)}),Sn.createElement("div",{ref:e,id:n.id,accessKey:n.accessKey,className:n.className,role:n.role,style:n.style,tabIndex:n.tabIndex,title:n.title})},ef="Layer",J5="Group",pc="Rect",$x="Circle",B2="Line",qx="Text",w$="Transformer",Hh=SH(l$);Hh.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:Sn.version,rendererPackageName:"react-konva"});const E$=Sn.forwardRef((n,e)=>Sn.createElement(Hx,{},Sn.createElement(v$,{...n,forwardedRef:e}))),S$={},Z5=n=>{let e;const t=new Set,r=(p,m)=>{const _=typeof p=="function"?p(e):p;if(!Object.is(_,e)){const S=e;e=m??(typeof _!="object"||_===null)?_:Object.assign({},e,_),t.forEach(E=>E(e,S))}},i=()=>e,c={setState:r,getState:i,getInitialState:()=>h,subscribe:p=>(t.add(p),()=>t.delete(p)),destroy:()=>{(S$?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},h=e=n(r,i,c);return c},C$=n=>n?Z5(n):Z5;var Kx={exports:{}},Qx={},Yx={exports:{}},Xx={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gc=ee;function T$(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var I$=typeof Object.is=="function"?Object.is:T$,k$=gc.useState,P$=gc.useEffect,R$=gc.useLayoutEffect,x$=gc.useDebugValue;function A$(n,e){var t=e(),r=k$({inst:{value:t,getSnapshot:e}}),i=r[0].inst,s=r[1];return R$(function(){i.value=t,i.getSnapshot=e,Gv(i)&&s({inst:i})},[n,t,e]),P$(function(){return Gv(i)&&s({inst:i}),n(function(){Gv(i)&&s({inst:i})})},[n]),x$(t),t}function Gv(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!I$(n,t)}catch{return!0}}function N$(n,e){return e()}var b$=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?N$:A$;Xx.useSyncExternalStore=gc.useSyncExternalStore!==void 0?gc.useSyncExternalStore:b$;Yx.exports=Xx;var D$=Yx.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var U_=ee,M$=D$;function O$(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var L$=typeof Object.is=="function"?Object.is:O$,F$=M$.useSyncExternalStore,V$=U_.useRef,U$=U_.useEffect,B$=U_.useMemo,z$=U_.useDebugValue;Qx.useSyncExternalStoreWithSelector=function(n,e,t,r,i){var s=V$(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=B$(function(){function c(S){if(!h){if(h=!0,p=S,S=r(S),i!==void 0&&o.hasValue){var E=o.value;if(i(E,S))return m=E}return m=S}if(E=m,L$(p,S))return E;var x=r(S);return i!==void 0&&i(E,x)?(p=S,E):(p=S,m=x)}var h=!1,p,m,_=t===void 0?null:t;return[function(){return c(e())},_===null?void 0:function(){return c(_())}]},[e,t,r,i]);var l=F$(n,s[0],s[1]);return U$(function(){o.hasValue=!0,o.value=l},[l]),z$(l),l};Kx.exports=Qx;var j$=Kx.exports;const G$=Wm(j$),Jx={},{useDebugValue:W$}=Sn,{useSyncExternalStoreWithSelector:H$}=G$;let eI=!1;const $$=n=>n;function q$(n,e=$$,t){(Jx?"production":void 0)!=="production"&&t&&!eI&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),eI=!0);const r=H$(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return W$(r),r}const tI=n=>{(Jx?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?C$(n):n,t=(r,i)=>q$(e,r,i);return Object.assign(t,e),t},Zx=n=>n?tI(n):tI,nI=2e3,Bt=Zx(n=>({shapes:[],optimisticUpdates:new Map,addShape:e=>n(t=>({shapes:[...t.shapes,e]})),updateShape:(e,t)=>n(r=>({shapes:r.shapes.map(i=>i.id===e?{...i,...t}:i)})),updateShapeOptimistic:(e,t)=>n(r=>{const i=new Map(r.optimisticUpdates);i.set(e,{timestamp:Date.now(),updates:t});const s=Date.now();for(const[o,l]of i.entries())s-l.timestamp>nI&&i.delete(o);return{shapes:r.shapes.map(o=>o.id===e?{...o,...t}:o),optimisticUpdates:i}}),deleteShape:e=>n(t=>({shapes:t.shapes.filter(r=>r.id!==e)})),setShapes:e=>n(t=>{const r=Date.now();return{shapes:e.map(s=>{const o=t.optimisticUpdates.get(s.id);return o&&r-o.timestamp<nI?{...s,...o.updates}:s})}})})),K$=n=>{const e=["#4477AA","#EE6677","#228833","#CCBB44","#66CCEE","#AA3377","#BBBBBB","#EE99AA","#009988","#997700","#6699CC","#994455"];let t=0;for(let r=0;r<n.length;r++)t=n.charCodeAt(r)+((t<<5)-t);return e[Math.abs(t)%e.length]},ua=Zx(n=>({user:null,firebaseUser:null,isAuthenticated:!1,isLoading:!0,error:null,setUser:(e,t)=>n({user:e,firebaseUser:t,isAuthenticated:!!e,error:null}),setLoading:e=>n({isLoading:e}),setError:e=>n({error:e,isLoading:!1}),clearUser:()=>n({user:null,firebaseUser:null,isAuthenticated:!1,isLoading:!1})})),Q$=n=>{var t;const e=n.displayName||((t=n.email)==null?void 0:t.split("@")[0])||"Anonymous User";return{uid:n.uid,displayName:e.length>20?e.substring(0,20):e,email:n.email||"",cursorColor:K$(n.uid)}},Y$="modulepreload",X$=function(n){return"/"+n},rI={},eA=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(t.map(c=>{if(c=X$(c),c in rI)return;rI[c]=!0;const h=c.endsWith(".css"),p=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${p}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":Y$,h||(m.as="script"),m.crossOrigin="",m.href=c,l&&m.setAttribute("nonce",l),document.head.appendChild(m),h)return new Promise((_,S)=>{m.addEventListener("load",_),m.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})};class J${constructor(){er(this,"frameCount",0);er(this,"lastTime",performance.now());er(this,"fps",0);er(this,"isRunning",!1);er(this,"animationId");er(this,"fpsHistory",[]);er(this,"maxHistorySize",60);er(this,"firestoreReads",0);er(this,"firestoreWrites",0);er(this,"rtdbUpdates",0);er(this,"lastFirebaseLogTime",performance.now());er(this,"animate",()=>{if(!this.isRunning)return;const e=performance.now();if(this.frameCount++,e-this.lastTime>=1e3){if(this.fps=Math.round(this.frameCount*1e3/(e-this.lastTime)),this.frameCount=0,this.lastTime=e,this.fpsHistory.push(this.fps),this.fpsHistory.length>this.maxHistorySize&&this.fpsHistory.shift(),this.updateTitle(),this.fps<30){console.warn(` Low FPS detected: ${this.fps} fps`);const t=this.fpsHistory.slice(-5),r=t.reduce((i,s)=>i+s,0)/t.length;r<25&&console.warn(` Consistently low FPS: ${r.toFixed(1)} fps average`)}e-this.lastFirebaseLogTime>=5e3&&(this.logFirebaseStats(),this.lastFirebaseLogTime=e)}this.animationId=requestAnimationFrame(this.animate)})}start(){this.isRunning||(this.isRunning=!0,this.lastTime=performance.now(),this.frameCount=0,console.log(" Performance monitoring started"),this.animate())}updateTitle(){}logFirebaseStats(){const e=(performance.now()-this.lastFirebaseLogTime)/1e3;console.log(` Firebase Operations (last ${e.toFixed(1)}s):`,{"Firestore Reads":this.firestoreReads,"Firestore Writes":this.firestoreWrites,"Realtime DB Updates":this.rtdbUpdates,"Read Rate":`${(this.firestoreReads/e).toFixed(1)}/s`,"Write Rate":`${(this.firestoreWrites/e).toFixed(1)}/s`,"RTDB Rate":`${(this.rtdbUpdates/e).toFixed(1)}/s`}),this.detectRateLimiting(),Math.floor(performance.now()/15e3)!==Math.floor(this.lastFirebaseLogTime/15e3)&&this.logMemoryUsage(),this.firestoreReads=0,this.firestoreWrites=0,this.rtdbUpdates=0}logFirestoreRead(e,t=1){}logFirestoreWrite(e,t=1){}logRTDBUpdate(e){}getStats(){const e=this.fpsHistory.length>0?this.fpsHistory.reduce((t,r)=>t+r,0)/this.fpsHistory.length:this.fps;return{currentFps:this.fps,averageFps:Math.round(e*10)/10,minFps:this.fpsHistory.length>0?Math.min(...this.fpsHistory):this.fps,maxFps:this.fpsHistory.length>0?Math.max(...this.fpsHistory):this.fps,firestoreReads:this.firestoreReads,firestoreWrites:this.firestoreWrites,rtdbUpdates:this.rtdbUpdates,isHealthy:e>30,performanceGrade:this.getPerformanceGrade(e)}}getPerformanceGrade(e){return e>=50?"A":e>=40?"B":e>=30?"C":e>=20?"D":"F"}logMemoryUsage(){}detectRateLimiting(){const e=this.firestoreWrites/5,t=this.firestoreReads/5;e>5&&console.warn(` High Firestore write rate: ${e.toFixed(1)}/s - Consider batching`),t>10&&console.warn(` High Firestore read rate: ${t.toFixed(1)}/s - Check for polling`)}stop(){this.isRunning=!1,this.animationId&&cancelAnimationFrame(this.animationId),document.title="CollabCanvas",console.log(" Performance monitoring stopped")}}const OS=new J$,Z$=(n,e)=>OS.logFirestoreRead(n,e),LS=(n,e)=>OS.logFirestoreWrite(n,e),FS=n=>OS.logRTDBUpdate(n);class Fc{static async withRetry(e,t={}){const r={...this.DEFAULT_RETRY_OPTIONS,...t};let i;for(let s=0;s<=r.maxRetries;s++)try{return await e()}catch(o){if(i=o,this.isNonRetryableError(o))throw o;if(s<r.maxRetries){const l=Math.min(r.initialDelayMs*Math.pow(r.backoffMultiplier,s),r.maxDelayMs);console.log(`Operation failed (attempt ${s+1}/${r.maxRetries+1}), retrying in ${l}ms...`),await this.delay(l)}}throw i}static isNonRetryableError(e){const t=e==null?void 0:e.code;return["auth/invalid-user-token","auth/user-disabled","permission-denied","invalid-argument"].includes(t)}static delay(e){return new Promise(t=>setTimeout(t,e))}}er(Fc,"DEFAULT_RETRY_OPTIONS",{maxRetries:3,initialDelayMs:1e3,maxDelayMs:1e4,backoffMultiplier:2});const tA=async n=>Fc.withRetry(async()=>{FS("initializePresence"),console.log(` Initializing presence for ${n.displayName}`);const e=io(va,`/sessions/global-canvas-v1/${n.uid}`),t={userId:n.uid,displayName:n.displayName||"Anonymous",email:n.email||"",cursorColor:n.cursorColor,cursorX:300,cursorY:200,lastSeen:mS(),isOnline:!0,currentlyEditing:null};await $0(e,t),await Z9(e).remove(),console.log(` Presence initialized for ${n.displayName} with auto-cleanup`)},{maxRetries:3}),z2=async(n,e,t,r=null)=>{try{FS("updateCursorPosition");const i=io(va,`/sessions/global-canvas-v1/${n}`),s={cursorX:e,cursorY:t,lastSeen:mS(),isOnline:!0};r!==void 0&&(s.currentlyEditing=r),await ex(i,s)}catch(i){console.error(" Failed to update cursor position:",i)}},B_=async(n,e)=>{FS("updateCurrentlyEditing");try{const t=io(va,`/sessions/global-canvas-v1/${n}/currentlyEditing`);await $0(t,e),console.log(` User ${n} now editing: ${e||"nothing"}`)}catch(t){console.error(" Failed to update currently editing:",t)}},nA=n=>{console.log(" Subscribing to presence updates...");const e=io(va,"/sessions/global-canvas-v1"),t=kf(e,r=>{const i=r.val()||{};console.log(" Presence update received:",Object.keys(i).length,"users"),n(i)},r=>{console.error(" Presence subscription error:",r)});return()=>{console.log(" Unsubscribing from presence updates"),t()}},eq=async n=>Fc.withRetry(async()=>{const{remove:e}=await eA(async()=>{const{remove:r}=await Promise.resolve().then(()=>fz);return{remove:r}},void 0),t=io(va,`/sessions/global-canvas-v1/${n}`);await e(t),console.log(` Presence removed for user: ${n}`)},{maxRetries:2}),tq=Object.freeze(Object.defineProperty({__proto__:null,cleanupPresence:eq,initializePresence:tA,subscribeToPresence:nA,updateCurrentlyEditing:B_,updateCursorPosition:z2},Symbol.toStringTag,{value:"Module"})),nq=n=>{const e=ee.useRef(0),t=ee.useRef({x:300,y:200}),r=ee.useRef(null),i=ee.useRef(null),s=ee.useRef(!1);ee.useEffect(()=>{n&&!s.current&&(z2(n.uid,300,200),s.current=!0)},[n]);const o=ee.useCallback((c,h)=>{if(!n)return;const p=Date.now(),m=t.current;if(Math.sqrt(Math.pow(c-m.x,2)+Math.pow(h-m.y,2))<5&&p-e.current<1e3)return;r.current&&(clearTimeout(r.current),r.current=null),i.current&&(clearTimeout(i.current),i.current=null);const S=p-e.current;S>=50?(l(n,c,h),e.current=p,t.current={x:c,y:h}):r.current=setTimeout(()=>{l(n,c,h),e.current=Date.now(),t.current={x:c,y:h}},50-S),i.current=setTimeout(()=>{},2e3)},[n]),l=ee.useCallback((c,h,p)=>{z2(c.uid,h,p)},[]);return{updateCursor:o}},rq=(n,e)=>{if(!e.current)return null;const t=e.current,r=t.container();if(!r)return null;const i=r.getBoundingClientRect(),s=n.clientX-i.left,o=n.clientY-i.top,c=t.getAbsoluteTransform().copy().invert().point({x:s,y:o});return{x:Math.round(c.x),y:Math.round(c.y)}},iq=(n,e)=>{const t=ee.useRef({x:0,y:0,time:0}),r=ee.useCallback(h=>{h.evt.preventDefault(),h.evt.stopPropagation();const p=n.current;if(!p)return;e==null||e(!0);const{deltaX:m,deltaY:_,ctrlKey:S,metaKey:E}=h.evt,x=Math.abs(_)<50;S||E?i(h,p,_):x&&(Math.abs(m)>0||Math.abs(_)>0)?s(p,m,_):i(h,p,_),setTimeout(()=>e==null?void 0:e(!1),50)},[n,e]),i=ee.useCallback((h,p,m)=>{const _=p.getPointerPosition();if(!_)return;const S=p.scaleX(),E=1+Math.abs(m)*.02,x=m>0?S/E:S*E,M=Math.max(.01,Math.min(100,x)),R={x:(_.x-p.x())/S,y:(_.y-p.y())/S};p.scale({x:M,y:M});const P={x:_.x-R.x*M,y:_.y-R.y*M},v=o(P,p,M);p.position(v)},[]),s=ee.useCallback((h,p,m)=>{const _=h.position(),S=Date.now(),E={x:_.x-p,y:_.y-m},x=h.scaleX(),M=o(E,h,x);h.position(M),t.current={x:p,y:m,time:S}},[]),o=ee.useCallback((h,p,m)=>{const _=p.width(),S=p.height(),E=5e3*m,x=5e3*m,M=Math.min(_,S)*.1;return{x:Math.max(_-E-M,Math.min(M,h.x)),y:Math.max(S-x-M,Math.min(M,h.y))}},[]),l=ee.useCallback(h=>{},[]),c=ee.useCallback(h=>{h.evt.preventDefault()},[]);return{handleWheel:r,handleTouchStart:l,handleTouchMove:c}};var Fn=[];for(var Wv=0;Wv<256;++Wv)Fn.push((Wv+256).toString(16).slice(1));function sq(n,e=0){return(Fn[n[e+0]]+Fn[n[e+1]]+Fn[n[e+2]]+Fn[n[e+3]]+"-"+Fn[n[e+4]]+Fn[n[e+5]]+"-"+Fn[n[e+6]]+Fn[n[e+7]]+"-"+Fn[n[e+8]]+Fn[n[e+9]]+"-"+Fn[n[e+10]]+Fn[n[e+11]]+Fn[n[e+12]]+Fn[n[e+13]]+Fn[n[e+14]]+Fn[n[e+15]]).toLowerCase()}var ug,oq=new Uint8Array(16);function aq(){if(!ug&&(ug=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ug))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ug(oq)}var lq=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const iI={randomUUID:lq};function uq(n,e,t){if(iI.randomUUID&&!n)return iI.randomUUID();n=n||{};var r=n.random||(n.rng||aq)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,sq(r)}const z_="canvas/global-canvas-v1/shapes",rA=async(n,e,t,r,i,s)=>Fc.withRetry(async()=>{LS("createShape");const o=uq(),l=vf(lr,z_),c={type:t,x:n,y:e,width:100,height:100,fill:r,text:"",textColor:"#000000",fontSize:14,createdBy:i,createdAt:ic(),lastModifiedBy:i,lastModifiedAt:ic(),isLocked:!1,lockedBy:null};return await XF(ya(l,o),c),console.log(` Shape created by ${s}:`,o),o},{maxRetries:2}),cq=(n,e)=>{try{const t=vf(lr,z_),r=FR(t,KF("createdAt","asc"));return JF(r,s=>{Z$("subscribeToShapes",s.size);const o=[];s.forEach(l=>{l.exists()&&o.push({id:l.id,...l.data()})}),console.log(` Shapes synced: ${o.length} total`),n(o)},s=>{console.error("Error subscribing to shapes:",s),e==null||e(s)})}catch(t){throw console.error("Error setting up shapes subscription:",t),t}},fd=async(n,e,t)=>Fc.withRetry(async()=>{LS("updateShape");const r=ya(lr,z_,n),i={...e,lastModifiedBy:t,lastModifiedAt:ic()};await jR(r,i),console.log(" Shape updated:",n)},{maxRetries:2}),hq=async n=>Fc.withRetry(async()=>{LS("deleteShape");const e=ya(lr,z_,n);await GR(e),console.log(" Shape deleted:",n)},{maxRetries:2}),dq=()=>{const{setShapes:n}=Bt();ee.useEffect(()=>{console.log(" Setting up shape sync...");const e=cq(t=>{n(t),console.log(` Loaded ${t.length} shapes from Firestore:`),t.forEach(r=>{console.log(`   Shape ${r.id}: (${r.x}, ${r.y}) locked: ${r.isLocked}`)})},t=>{console.error(" Shape sync error:",t)});return()=>{console.log(" Cleaning up shape sync..."),e==null||e()}},[n])},Gm="canvas/global-canvas-v1/shapes",pd=async(n,e,t,r)=>{try{const i=ya(lr,Gm,n);return await ME(lr,async o=>{const l=await o.get(i);if(!l.exists())throw new Error("Shape not found");const c=l.data();return c.isLocked&&c.lockedBy!==e?{success:!1,alreadyLocked:!0,lockedBy:c.lockedBy}:(o.update(i,{isLocked:!0,lockedBy:e,lockedByName:t,lockedByColor:r,lastModifiedBy:e,lastModifiedAt:ic()}),console.log(` Lock acquired by ${t} for shape:`,n),setTimeout(()=>{B_(e,n).catch(h=>{console.warn("Failed to update currently editing status:",h)})},0),{success:!0})})}catch(i){return console.error("Error acquiring lock:",i),{success:!1,error:i instanceof Error?i.message:"Unknown error"}}},ju=async(n,e,t,r)=>{try{const i=ya(lr,Gm,n);return await ME(lr,async o=>{const l=await o.get(i);if(!l.exists())throw new Error("Shape not found");if(l.data().lockedBy!==e)return console.warn("Cannot release lock not owned by user"),{success:!1,error:"Lock not owned by user"};const h={isLocked:!1,lockedBy:null,lockedByName:null,lockedByColor:null,lastModifiedBy:e,lastModifiedAt:ic()};return o.update(i,h),console.log(` Lock released by ${t} for shape:`,n,r?`with position (${r.x}, ${r.y})`:"without position update"),setTimeout(()=>{B_(e,null).catch(p=>{console.warn("Failed to clear currently editing status:",p)})},0),{success:!0}})}catch(i){return console.error("Error releasing lock:",i),{success:!1,error:i instanceof Error?i.message:"Unknown error"}}},fq=async n=>{try{console.log(` Force releasing all locks for user: ${n}`);const e=vf(lr,Gm),t=FR(e,qF("lockedBy","==",n)),r=await bE(t),i=r.docs.map(async s=>{const o=ya(lr,Gm,s.id);return ME(lr,async l=>{const c=await l.get(o);c.exists()&&c.data().lockedBy===n&&(l.update(o,{isLocked:!1,lockedBy:null,lastModifiedAt:ic()}),console.log(` Force unlocked shape: ${s.id}`),B_(n,null).catch(h=>{console.warn("Failed to clear currently editing status on force unlock:",h)}))})});await Promise.all(i),console.log(` Released ${r.docs.length} locks for user: ${n}`)}catch(e){console.error("Error force releasing user locks:",e)}},pq=()=>{ee.useEffect(()=>{console.log(" Starting presence monitoring for lock cleanup");const n=io(va,"/sessions/global-canvas-v1");let e=new Set;const r=kf(n,i=>{const s=i.val()||{},o=new Set(Object.keys(s));e.forEach(l=>{o.has(l)||(console.log(` User disconnected: ${l}, cleaning up locks`),fq(l).catch(c=>{console.error("Failed to cleanup locks for disconnected user:",c)}))}),e=o},i=>{console.error(" Presence monitoring error:",i)});return()=>{console.log(" Stopping presence monitoring"),r()}},[])},gq=({width:n,height:e,listening:t})=>{const i=[];for(let o=0;o<=n/50;o++){const l=o*50;i.push(z.jsx(B2,{points:[l,0,l,e],stroke:"#f0f0f0",strokeWidth:.5,listening:!1},`v-${o}`))}const s=[];for(let o=0;o<=e/50;o++){const l=o*50;s.push(z.jsx(B2,{points:[0,l,n,l],stroke:"#f0f0f0",strokeWidth:.5,listening:!1},`h-${o}`))}return z.jsxs(ef,{listening:t,children:[z.jsx(pc,{x:0,y:0,width:n,height:e,fill:"white",listening:!1}),i,s,z.jsx(pc,{x:0,y:0,width:n,height:e,stroke:"#cccccc",strokeWidth:2,fill:"transparent",listening:!1})]})},mq=Sn.memo(({shape:n,isSelected:e,onSelect:t,shapeRef:r})=>{const{shapes:i}=Bt(),{user:s}=ua(),o=n.isLocked&&n.lockedBy===(s==null?void 0:s.uid),l=n.isLocked&&n.lockedBy!==(s==null?void 0:s.uid),c=!l&&!!s,h=ee.useCallback(async R=>{var P;if(!l&&s){const v=((P=R.evt)==null?void 0:P.shiftKey)||!1;t(R);const{updateShapeOptimistic:k}=Bt.getState(),D=i.filter(O=>O.lockedBy===s.uid&&O.id!==n.id);if(v)o?(k(n.id,{isLocked:!1,lockedBy:null,lockedByName:null,lockedByColor:null}),ju(n.id,s.uid,s.displayName)):(k(n.id,{isLocked:!0,lockedBy:s.uid,lockedByName:s.displayName,lockedByColor:s.cursorColor}),pd(n.id,s.uid,s.displayName,s.cursorColor));else{if(o&&D.length===0)return;D.forEach(O=>{k(O.id,{isLocked:!1,lockedBy:null,lockedByName:null,lockedByColor:null})}),k(n.id,{isLocked:!0,lockedBy:s.uid,lockedByName:s.displayName,lockedByColor:s.cursorColor}),D.length>0&&Promise.all(D.map(O=>ju(O.id,s.uid,s.displayName))),o||pd(n.id,s.uid,s.displayName,s.cursorColor)}}},[n.id,o,l,s,i,t]),p=ee.useRef(new Map),m=ee.useCallback(R=>{const{shapes:P}=Bt.getState(),v=P.filter(D=>D.lockedBy===(s==null?void 0:s.uid));if(v.length>1&&o){console.log(" Multi-select drag starting with",v.length,"shapes"),p.current.clear();const D=R.target.getLayer();v.forEach(O=>{const N=D==null?void 0:D.findOne(`#${O.id}`);N&&p.current.set(O.id,{startX:N.x(),startY:N.y()})})}else if(p.current.clear(),t({evt:{shiftKey:!1}}),!o&&s){const{updateShapeOptimistic:D}=Bt.getState();v.forEach(O=>{O.id!==n.id&&(D(O.id,{isLocked:!1,lockedBy:null,lockedByName:null,lockedByColor:null}),ju(O.id,s.uid,s.displayName))}),D(n.id,{isLocked:!0,lockedBy:s.uid,lockedByName:s.displayName,lockedByColor:s.cursorColor}),pd(n.id,s.uid,s.displayName,s.cursorColor)}},[n.id,o,s,t]),_=ee.useCallback(R=>{if(p.current.size<=1)return;const P=p.current.get(n.id);if(!P)return;const v=R.target.x()-P.startX,k=R.target.y()-P.startY,D=R.target.getLayer();p.current.forEach((O,N)=>{if(N!==n.id){const C=D==null?void 0:D.findOne(`#${N}`);C&&(C.x(O.startX+v),C.y(O.startY+k))}}),D==null||D.batchDraw()},[n.id]),S=ee.useCallback(R=>{if(!s)return;const{updateShapeOptimistic:P,shapes:v}=Bt.getState();if(p.current.size>1){console.log(` Saving positions for ${p.current.size} shapes`);const k=R.target.getLayer();p.current.forEach((D,O)=>{const N=v.find(L=>L.id===O);if(!N)return;const C=k==null?void 0:k.findOne(`#${O}`);if(!C)return;let b=Math.round(C.x()),A=Math.round(C.y());N.type==="circle"&&(b=b-N.width/2,A=A-N.height/2),P(O,{x:b,y:A}),fd(O,{x:b,y:A},s.uid)}),p.current.clear()}else{let k=Math.round(R.target.x()),D=Math.round(R.target.y());n.type==="circle"&&(k=k-n.width/2,D=D-n.height/2),P(n.id,{x:k,y:D}),fd(n.id,{x:k,y:D},s.uid)}},[n.id,n.type,n.width,n.height,s]),E=ee.useCallback(R=>{const P=r.current;if(!P||!s)return;const v=P.scaleX(),k=P.scaleY();let D=Math.max(20,Math.round(P.width()*v)),O=Math.max(20,Math.round(P.height()*k)),N=Math.round(P.x()),C=Math.round(P.y());if(P.scaleX(1),P.scaleY(1),n.type==="circle"&&(N=N-D/2,C=C-O/2),n.type==="circle"){const A=Math.min(D,O)/2;N=Math.max(-D/2+A,Math.min(5e3-D/2-A,N)),C=Math.max(-O/2+A,Math.min(5e3-O/2-A,C))}else N+D>5e3&&(D=5e3-N),C+O>5e3&&(O=5e3-C),N<0&&(D=D+N,N=0),C<0&&(O=O+C,C=0);const{updateShapeOptimistic:b}=Bt.getState();b(n.id,{x:N,y:C,width:D,height:O}),fd(n.id,{x:N,y:C,width:D,height:O},s.uid)},[n.id,n.type,s,r]),x=ee.useCallback(R=>{const{shapes:P}=Bt.getState(),v=P.find(b=>b.id===n.id);if(!v)return R;const k=1;let D=Math.round(R.x/k)*k,O=Math.round(R.y/k)*k;if(P.filter(b=>b.lockedBy===(s==null?void 0:s.uid)).length>1&&p.current.size>1){const b=p.current.get(n.id);if(!b)return{x:D,y:O};const A=D-b.startX,L=O-b.startY;let B=A,V=L;return p.current.forEach((he,le)=>{const Te=P.find(se=>se.id===le);if(!Te)return;const xe=he.startX+A,Y=he.startY+L;let J,X,te,ie;if(Te.type==="circle"){const se=Math.min(Te.width,Te.height)/2;J=se,X=5e3-se,te=se,ie=5e3-se}else J=0,X=5e3-Te.width,te=0,ie=5e3-Te.height;if(xe<J){const se=J-he.startX;B=Math.max(B,se)}else if(xe>X){const se=X-he.startX;B=Math.min(B,se)}if(Y<te){const se=te-he.startY;V=Math.max(V,se)}else if(Y>ie){const se=ie-he.startY;V=Math.min(V,se)}}),{x:b.startX+B,y:b.startY+V}}if(v.type==="circle"){const b=Math.min(v.width,v.height)/2;return{x:Math.max(b,Math.min(5e3-b,D)),y:Math.max(b,Math.min(5e3-b,O))}}return{x:Math.max(0,Math.min(5e3-v.width,D)),y:Math.max(0,Math.min(5e3-v.height,O))}},[n.id,s]),M=()=>{const R=o?(s==null?void 0:s.cursorColor)||"#0066ff":l?n.lockedByColor||"#ff6b6b":"transparent",P=o||l?2:0,v={fill:n.fill,stroke:R,strokeWidth:P,strokeScaleEnabled:!1,draggable:c,dragBoundFunc:c?x:void 0,onClick:h,onDragStart:m,onDragMove:_,onDragEnd:S,onTransformEnd:E,ref:r.callback||r};return n.type==="circle"?z.jsx($x,{id:n.id,x:n.x+n.width/2,y:n.y+n.height/2,radius:Math.min(n.width,n.height)/2,...v}):z.jsx(pc,{id:n.id,x:n.x,y:n.y,width:n.width,height:n.height,...v})};return z.jsxs(z.Fragment,{children:[M(),n.text&&z.jsx(qx,{x:n.x,y:n.y+n.height/2-7,width:n.width,text:n.text,fontSize:n.fontSize,fill:n.textColor,align:"center",verticalAlign:"middle",listening:!1})]})}),_q=({listening:n,isDragSelectingRef:e})=>{const{shapes:t}=Bt(),{user:r}=ua(),[i,s]=ee.useState([]),[o,l]=ee.useState(!1),c=ee.useRef(null),h=ee.useRef({}),[p,m]=ee.useState({visible:!1,x1:0,y1:0,x2:0,y2:0}),_=ee.useRef(!1);ee.useEffect(()=>{const D=N=>{N.shiftKey&&!o&&l(!0)},O=N=>{!N.shiftKey&&o&&l(!1)};return window.addEventListener("keydown",D),window.addEventListener("keyup",O),window.addEventListener("blur",()=>l(!1)),()=>{window.removeEventListener("keydown",D),window.removeEventListener("keyup",O),window.removeEventListener("blur",()=>l(!1))}},[o]),ee.useEffect(()=>{const D=c.current;D&&D.keepRatio(o)},[o]),ee.useEffect(()=>{var O,N,C;const D=c.current;if(D)if(i.length>0){const b=D.getLayer(),A=i.map(L=>b==null?void 0:b.findOne(`#${L}`)).filter(L=>L!=null);A.length>0?(D.nodes(A),(O=D.getLayer())==null||O.batchDraw()):(D.nodes([]),(N=D.getLayer())==null||N.batchDraw())}else D.nodes([]),(C=D.getLayer())==null||C.batchDraw()},[i,t]);const S=ee.useMemo(()=>r?t.filter(D=>D.lockedBy===r.uid).map(D=>D.id):[],[t,r]);ee.useEffect(()=>{(S.length!==i.length||!S.every(D=>i.includes(D)))&&s(S)},[S,i]);const E=ee.useCallback(D=>{var B;if(!(((B=D.evt)==null?void 0:B.shiftKey)||!1))return;const N=D.target.name&&D.target.name()==="background-rect",C=D.target.getType();if(!(C==="Stage"||C==="Layer"||N))return;const L=D.target.getStage().getRelativePointerPosition();L&&(_.current=!0,e&&(e.current=!0),m({visible:!0,x1:L.x,y1:L.y,x2:L.x,y2:L.y}))},[e]),x=ee.useRef(0),M=ee.useCallback(D=>{if(!_.current)return;const O=performance.now();if(O-x.current<16)return;x.current=O;const C=D.target.getStage().getRelativePointerPosition();C&&m(b=>({...b,x2:C.x,y2:C.y}))},[]),R=ee.useCallback(()=>{if(!_.current){e&&(e.current=!1);return}_.current=!1;const D={x:Math.min(p.x1,p.x2),y:Math.min(p.y1,p.y2),width:Math.abs(p.x2-p.x1),height:Math.abs(p.y2-p.y1)},O=[];if(t.forEach(N=>{const C={x:N.x,y:N.y,width:N.width,height:N.height};!(D.x>C.x+C.width||D.x+D.width<C.x||D.y>C.y+C.height||D.y+D.height<C.y)&&O.push(N.id)}),O.length>0&&r){const{updateShapeOptimistic:N}=Bt.getState(),C=t.filter(A=>A.lockedBy===r.uid&&!O.includes(A.id));C.forEach(A=>{N(A.id,{isLocked:!1,lockedBy:null,lockedByName:null,lockedByColor:null})}),C.length>0&&Promise.all(C.map(A=>ju(A.id,r.uid,r.displayName)));const b=O.filter(A=>{const L=t.find(B=>B.id===A);return L&&!L.isLocked});b.forEach(A=>{N(A,{isLocked:!0,lockedBy:r.uid,lockedByName:r.displayName,lockedByColor:r.cursorColor})}),b.length>0&&Promise.all(b.map(A=>pd(A,r.uid,r.displayName,r.cursorColor))),s(O)}m(N=>({...N,visible:!1}))},[p,t,r]),P=ee.useCallback(D=>{if(e&&e.current)return;const O=D.target.name&&D.target.name()==="background-rect";if(D.target===D.target.getStage()||O){if(r&&i.length>0){const{updateShapeOptimistic:C}=Bt.getState();i.forEach(b=>{C(b,{isLocked:!1,lockedBy:null,lockedByName:null,lockedByColor:null})}),Promise.all(i.map(b=>ju(b,r.uid,r.displayName))),D.cancelBubble=!0,D.evt&&D.evt.stopPropagation()}s([])}},[r,i,e]),v=ee.useCallback((D,O)=>{s(O?N=>N.includes(D)?N.filter(C=>C!==D):[...N,D]:[D])},[]);ee.useEffect(()=>{const D=O=>{if((O.metaKey||O.ctrlKey)&&O.key==="a"){if(O.preventDefault(),!r)return;const{updateShapeOptimistic:N}=Bt.getState();t.forEach(b=>{(!b.isLocked||b.lockedBy===r.uid)&&N(b.id,{isLocked:!0,lockedBy:r.uid,lockedByName:r.displayName,lockedByColor:r.cursorColor})});const C=t.filter(b=>!b.isLocked||b.lockedBy===r.uid).map(b=>pd(b.id,r.uid,r.displayName,r.cursorColor));Promise.all(C)}};return window.addEventListener("keydown",D),()=>window.removeEventListener("keydown",D)},[t,r]);const k=ee.useMemo(()=>({x:Math.min(p.x1,p.x2),y:Math.min(p.y1,p.y2),width:Math.abs(p.x2-p.x1),height:Math.abs(p.y2-p.y1)}),[p]);return z.jsxs(ef,{listening:n,children:[z.jsx(pc,{name:"background-rect",x:0,y:0,width:5e3,height:5e3,fill:"transparent",listening:n,onClick:P,onTap:P,onMouseDown:E,onMouseMove:M,onMouseUp:R}),t.map(D=>{const O=N=>{N&&(h.current[D.id]=N)};return z.jsx(mq,{shape:D,isSelected:i.includes(D.id),onSelect:N=>{var C;return v(D.id,((C=N.evt)==null?void 0:C.shiftKey)||!1)},shapeRef:{current:null,callback:O}},D.id)}),p.visible&&z.jsx(pc,{x:k.x,y:k.y,width:k.width,height:k.height,fill:"rgba(0, 102, 255, 0.1)",stroke:(r==null?void 0:r.cursorColor)||"#0066ff",strokeWidth:1,dash:[4,4],listening:!1}),z.jsx(w$,{ref:c,flipEnabled:!1,boundBoxFunc:(D,O)=>Math.abs(O.width)<20||Math.abs(O.height)<20?D:O,enabledAnchors:["top-left","top-right","bottom-left","bottom-right","top-center","middle-right","bottom-center","middle-left"],keepRatio:!1,anchorSize:8,anchorStroke:(r==null?void 0:r.cursorColor)||"#0066ff",anchorFill:"white",anchorStrokeWidth:2,borderStroke:(r==null?void 0:r.cursorColor)||"#0066ff",borderStrokeWidth:3,borderEnabled:!0,ignoreStroke:!0,rotateEnabled:!1})]})},yq=({listening:n})=>z.jsx(ef,{listening:n}),vq=()=>{const{user:n}=ua(),[e,t]=ee.useState({});ee.useEffect(()=>{if(!n)return;const i=io(va,"/sessions/global-canvas-v1"),s=kf(i,o=>{const l=o.val()||{},c={};Object.entries(l).forEach(([h,p])=>{p.isOnline&&p.cursorX!==void 0&&p.cursorY!==void 0&&(c[h]={x:p.cursorX,y:p.cursorY,name:p.displayName||"Anonymous",color:p.cursorColor||"#666"})}),t(c)},{onlyOnce:!1});return()=>s()},[n==null?void 0:n.uid]);const r=Object.entries(e);return r.length===0?z.jsx(ef,{listening:!1}):z.jsx(ef,{listening:!1,children:r.map(([i,s])=>z.jsx(wq,{cursor:s,isCurrentUser:i===(n==null?void 0:n.uid)},i))})},wq=({cursor:n,isCurrentUser:e=!1})=>{const{x:t,y:r,name:i,color:s}=n,o=[0,0,0,14,4,10,6,16,8,15,6,9,10,9];return z.jsxs(J5,{x:t,y:r,children:[e?z.jsx(B2,{points:o,fill:s,stroke:"white",strokeWidth:1,closed:!0}):z.jsx($x,{radius:6,fill:s,stroke:"white",strokeWidth:2}),z.jsxs(J5,{x:e?16:12,y:-8,children:[z.jsx(pc,{width:i.length*6+6,height:16,fill:s,cornerRadius:2}),z.jsx(qx,{text:i,fontSize:11,fontFamily:"Arial",fill:"white",x:3,y:2})]})]})},Eq=[{name:"Grey",value:"#CCCCCC",shortcut:"4"},{name:"Red",value:"#ef4444",shortcut:"1"},{name:"Green",value:"#22c55e",shortcut:"2"},{name:"Blue",value:"#3b82f6",shortcut:"3"}],Sq=({currentShapeType:n,onShapeTypeChange:e,currentColor:t,onColorChange:r})=>z.jsxs("div",{className:"absolute top-4 left-4 z-10 bg-white rounded-lg shadow-lg border border-gray-200 p-3",children:[z.jsx("div",{className:"flex gap-2 mb-3",children:z.jsx("div",{className:"text-xs text-gray-500 font-medium mb-1 w-full",children:"Shape"})}),z.jsxs("div",{className:"flex gap-2 mb-4",children:[z.jsx("button",{onClick:()=>e("rectangle"),className:`
            w-12 h-12 rounded-lg border-2 flex items-center justify-center transition-all duration-200
            ${n==="rectangle"?"border-blue-500 bg-blue-50 text-blue-600":"border-gray-300 bg-white text-gray-600 hover:border-gray-400 hover:bg-gray-50"}
          `,title:"Rectangle (R)",children:z.jsx("div",{className:"w-6 h-4 border-2 border-current rounded-sm"})}),z.jsx("button",{onClick:()=>e("circle"),className:`
            w-12 h-12 rounded-lg border-2 flex items-center justify-center transition-all duration-200
            ${n==="circle"?"border-blue-500 bg-blue-50 text-blue-600":"border-gray-300 bg-white text-gray-600 hover:border-gray-400 hover:bg-gray-50"}
          `,title:"Circle (C)",children:z.jsx("div",{className:"w-6 h-6 border-2 border-current rounded-full"})})]}),z.jsxs("div",{className:"border-t border-gray-200 pt-3",children:[z.jsx("div",{className:"text-xs text-gray-500 font-medium mb-2",children:"Color"}),z.jsx("div",{className:"flex gap-2",children:Eq.map(i=>z.jsx("button",{onClick:()=>r(i.value),className:`
                w-8 h-8 rounded-lg border-2 transition-all duration-200 relative
                ${t===i.value?"border-gray-800 scale-110":"border-gray-300 hover:border-gray-400"}
              `,style:{backgroundColor:i.value},title:`${i.name} (${i.shortcut})`,children:t===i.value&&z.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:z.jsx("svg",{className:"w-4 h-4 text-white drop-shadow-sm",fill:"currentColor",viewBox:"0 0 20 20",children:z.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})},i.value))})]})]}),Hv=5e3,$v=5e3,Cq=({width:n,height:e})=>{const t=ee.useRef(null),[r,i]=ee.useState(!1),[s,o]=ee.useState(!1),{user:l}=ua(),{updateCursor:c}=nq(l),{handleWheel:h,handleTouchStart:p,handleTouchMove:m}=iq(t,o);dq(),pq();const _=ee.useCallback(async()=>{if(!l)return;const{shapes:J,deleteShape:X}=Bt.getState(),te=J.filter(se=>se.lockedBy===l.uid);if(te.length===0){console.log("No shapes selected for deletion");return}console.log(` Deleting ${te.length} selected shapes`),te.forEach(se=>{X(se.id),console.log(` Instantly deleted: ${se.id}`)});const ie=te.map(async se=>{try{await hq(se.id),console.log(` Deletion synced to Firestore: ${se.id}`)}catch(ft){console.error(`Deletion sync failed for ${se.id}:`,ft);const{addShape:ct}=Bt.getState();ct(se),console.log(` Restored shape after sync failure: ${se.id}`)}});await Promise.all(ie)},[l]);ee.useEffect(()=>{const J=ie=>{if((ie.key==="Delete"||ie.key==="Backspace")&&!ie.repeat){ie.preventDefault(),_();return}if(ie.code==="Space"&&!ie.repeat&&!r){ie.preventDefault(),ie.stopPropagation(),i(!0),document.body.style.overflow="hidden";const se=t.current;se&&(se.find("Rect").forEach(ft=>ft.draggable(!1)),se.draggable(!0)),console.log(" Space pressed - panning mode enabled")}},X=ie=>{if(ie.code==="Space"){ie.preventDefault(),ie.stopPropagation(),i(!1),document.body.style.overflow="auto";const se=t.current;se&&(se.draggable(!1),se.find("Rect").forEach(ft=>{const ct=ft.id(),{shapes:Qe}=Bt.getState(),j=Qe.find(ye=>ye.id===ct),ne=(j==null?void 0:j.isLocked)&&(j==null?void 0:j.lockedBy)!==(l==null?void 0:l.uid);ft.draggable(!ne&&!!l)})),console.log(" Space released - panning mode disabled")}},te=()=>{i(!1),document.body.style.overflow="auto";const ie=t.current;ie&&ie.draggable(!1),console.log(" Window blur - reset panning state")};return window.addEventListener("keydown",J),window.addEventListener("keyup",X),window.addEventListener("blur",te),()=>{document.body.style.overflow="auto",he.current&&clearTimeout(he.current),window.removeEventListener("keydown",J),window.removeEventListener("keyup",X),window.removeEventListener("blur",te)}},[r,l,_]);const S=ee.useCallback(J=>{const X=n-Hv,te=e-$v;return{x:Math.max(X,Math.min(0,J.x)),y:Math.max(te,Math.min(0,J.y))}},[n,e]),[E,x]=ee.useState("rectangle"),[M,R]=ee.useState("#CCCCCC"),[P,v]=ee.useState(!1),[k,D]=ee.useState(null),[O,N]=ee.useState("rectangle"),[C,b]=ee.useState("#CCCCCC"),A=ee.useCallback(J=>{if(v(!0),x(J),k||N(J),l){const{shapes:X,updateShapeOptimistic:te}=Bt.getState(),ie=X.filter(se=>se.lockedBy===l.uid);ie.length>0&&(ie.forEach(se=>{te(se.id,{type:J,isLocked:!0,lockedBy:l.uid,lockedByName:l.displayName,lockedByColor:l.cursorColor})}),Promise.all(ie.map(se=>fd(se.id,{type:J},l.uid))))}setTimeout(()=>v(!1),100)},[k,l]),L=ee.useCallback(J=>{if(v(!0),R(J),k||b(J),l){const{shapes:X,updateShapeOptimistic:te}=Bt.getState(),ie=X.filter(se=>se.lockedBy===l.uid);ie.length>0&&(ie.forEach(se=>{te(se.id,{fill:J,isLocked:!0,lockedBy:l.uid,lockedByName:l.displayName,lockedByColor:l.cursorColor})}),Promise.all(ie.map(se=>fd(se.id,{fill:J},l.uid))),b(J))}setTimeout(()=>{v(!1)},100)},[l,k]),{shapes:B}=Bt();ee.useEffect(()=>{if(l){const J=B.filter(X=>X.lockedBy===l.uid);if(J.length===1){const X=J[0];X.id!==k&&(D(X.id),X.fill!==M&&R(X.fill),X.type!==E&&x(X.type))}else J.length===0&&k&&(D(null),M!==C&&R(C),E!==O&&x(O))}},[B,l,M,E,k,C,O]),ee.useEffect(()=>{const J=X=>{if(!(X.target instanceof HTMLInputElement||X.target instanceof HTMLTextAreaElement))switch(X.key.toLowerCase()){case"r":A("rectangle");break;case"c":A("circle");break;case"1":L("#CCCCCC");break;case"2":L("#ef4444");break;case"3":L("#22c55e");break;case"4":L("#3b82f6");break}};return window.addEventListener("keydown",J),()=>window.removeEventListener("keydown",J)},[L,A]);const V=ee.useRef(0),he=ee.useRef(null),le=ee.useRef(new Set),Te=ee.useRef(!1),xe=ee.useCallback(async J=>{if(Te.current){Te.current=!1;return}const X=J.target.getType(),te=J.target.name?J.target.name():"";if(!(X==="Stage"||te==="background-rect")||r||!l||P)return;const{shapes:se,addShape:ft,updateShapeOptimistic:ct}=Bt.getState(),Qe=se.filter(Ut=>Ut.lockedBy===l.uid);if(Qe.length>0){Qe.forEach(Ut=>{ct(Ut.id,{isLocked:!1,lockedBy:null,lockedByName:null,lockedByColor:null})}),Promise.all(Qe.map(Ut=>ju(Ut.id,l.uid,l.displayName))),console.log(` Deselected ${Qe.length} shapes (no creation)`);return}const j=Date.now();if(j-V.current<100)return;V.current=j;const ye=t.current.getRelativePointerPosition(),Fe=`temp-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,Ce=Math.max(0,Math.min(Hv-100,ye.x)),Ze=Math.max(0,Math.min($v-100,ye.y)),ot={id:Fe,type:O,x:Ce,y:Ze,width:100,height:100,fill:C,text:"",textColor:"#000000",fontSize:14,createdBy:l.uid,createdAt:new Date,lastModifiedBy:l.uid,lastModifiedAt:new Date,isLocked:!1,lockedBy:null,lockedByName:null,lockedByColor:null};ft(ot),le.current.add(Fe),console.log(` Created shape instantly: ${Fe} at (${Ce}, ${Ze})`),he.current&&clearTimeout(he.current),he.current=setTimeout(async()=>{const Ut=Array.from(le.current);le.current.clear();const et=Ut.map(async Wn=>{const Hn=Bt.getState().shapes.find(Ui=>Ui.id===Wn);if(Hn)try{const Ui=await rA(Hn.x,Hn.y,Hn.type,Hn.fill,l.uid,l.displayName),{updateShapeOptimistic:Ur}=Bt.getState();Ur(Wn,{id:Ui})}catch(Ui){console.error(`Failed to sync shape ${Wn}:`,Ui);const{deleteShape:Ur}=Bt.getState();Ur(Wn)}});await Promise.allSettled(et)},50)},[r,l,P]),Y=ee.useCallback(J=>{if(s||r)return;const X=rq(J.evt,t);X&&l&&c(X.x,X.y)},[c,l,s,r]);return z.jsxs("div",{className:`relative overflow-hidden bg-white border border-gray-300 rounded-lg shadow-sm ${r?"cursor-grab":"cursor-default"}`,onWheel:J=>J.preventDefault(),onTouchMove:J=>J.preventDefault(),style:{touchAction:"none"},children:[z.jsx(Sq,{currentShapeType:E,onShapeTypeChange:A,currentColor:M,onColorChange:L}),!1,z.jsxs(E$,{ref:t,width:n,height:e,draggable:!1,dragBoundFunc:r?S:void 0,onWheel:h,onTouchStart:p,onTouchMove:m,onClick:xe,onTap:xe,onMouseMove:Y,children:[z.jsx(gq,{width:Hv,height:$v,listening:!1}),z.jsx(_q,{listening:!0,isDragSelectingRef:Te}),z.jsx(yq,{listening:!1}),z.jsx(vq,{})]}),z.jsxs("div",{className:"absolute top-2 right-2 text-xs text-gray-500 bg-white px-2 py-1 rounded shadow",children:["Scale: ",t.current?(t.current.scaleX()*100).toFixed(0):"100","%"]}),r&&z.jsx("div",{className:"absolute bottom-2 left-2 text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded shadow",children:"Space + Drag to Pan"})]})},Tq=async()=>{try{console.log(" Clearing all locks...");const n=vf(lr,"canvas/global-canvas-v1/shapes"),e=await bE(n),t=e.docs.map(async r=>{const i=ya(lr,"canvas/global-canvas-v1/shapes",r.id);await jR(i,{isLocked:!1,lockedBy:null}),console.log(` Cleared lock for shape: ${r.id}`)});return await Promise.all(t),console.log(` Cleared ${e.docs.length} locks successfully!`),{success:!0,clearedCount:e.docs.length}}catch(n){return console.error(" Error clearing locks:",n),{success:!1,error:n}}},Iq=async()=>{try{console.log(" Clearing all shapes...");const n=vf(lr,"canvas/global-canvas-v1/shapes"),e=await bE(n),t=e.docs.map(async r=>{const i=ya(lr,"canvas/global-canvas-v1/shapes",r.id);await GR(i),console.log(` Deleted shape: ${r.id}`)});return await Promise.all(t),console.log(` Deleted ${e.docs.length} shapes successfully!`),{success:!0,deletedCount:e.docs.length}}catch(n){return console.error(" Error clearing shapes:",n),{success:!1,error:n}}},kq=()=>{const{user:n,isAuthenticated:e}=ua(),[t,r]=ee.useState(!1),[i,s]=ee.useState(!1),[o,l]=ee.useState(10),[c,h]=ee.useState(!1),p=async()=>{try{if(n){const{cleanupPresence:E}=await eA(async()=>{const{cleanupPresence:x}=await Promise.resolve().then(()=>tq);return{cleanupPresence:x}},void 0);await E(n.uid),console.log(" Presence cleaned up before logout")}await BD(cc),console.log(" User signed out successfully")}catch(E){console.error("Error signing out:",E)}},m=async()=>{if(confirm(" This will delete ALL shapes permanently. Are you sure?")){s(!0);try{const E=await Iq();E.success?alert(` Successfully deleted ${E.deletedCount} shapes!`):alert(` Failed to clear shapes: ${E.error}`)}catch(E){alert(` Error: ${E}`)}s(!1),r(!1)}},_=async()=>{s(!0);try{const E=await Tq();E.success?alert(` Successfully cleared ${E.clearedCount} locks!`):alert(` Failed to clear locks: ${E.error}`)}catch(E){alert(` Error: ${E}`)}s(!1),r(!1)},S=async()=>{if(!(!n||c)){h(!0),console.log(` Creating ${o} random shapes...`);try{const E=["rectangle","circle"],x=["#4477AA","#EE6677","#228833","#CCBB44","#66CCEE","#AA3377"],M=[];for(let R=0;R<o;R++){const P=Math.random()*4800+100,v=Math.random()*4800+100,k=E[Math.floor(Math.random()*E.length)],D=x[Math.floor(Math.random()*x.length)];M.push(rA(P,v,k,D,n.uid,n.displayName))}await Promise.all(M),console.log(` Created ${o} shapes successfully`),alert(` Created ${o} shapes!`)}catch(E){console.error("Failed to create shapes:",E),alert(" Failed to create shapes. Check console for details.")}finally{h(!1),r(!1)}}};return e?z.jsxs("header",{className:"bg-white border-b border-gray-200 px-4 py-3 flex justify-between items-center",children:[z.jsxs("div",{className:"flex items-center space-x-4",children:[z.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:"CollabCanvas"}),z.jsx("div",{className:"text-sm text-gray-500",children:"Real-Time Collaborative Design Tool"})]}),z.jsxs("div",{className:"flex items-center space-x-4",children:[z.jsxs("div",{className:"flex items-center space-x-2",children:[z.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:n==null?void 0:n.cursorColor}}),z.jsx("span",{className:"text-sm font-medium text-gray-700",children:n==null?void 0:n.displayName})]}),z.jsxs("div",{className:"relative",children:[z.jsx("button",{onClick:()=>r(!t),className:"text-xs text-gray-400 hover:text-red-600 px-2 py-1 rounded border border-gray-200 hover:border-red-300",title:"Admin Panel",children:""}),t&&z.jsxs("div",{className:"absolute right-0 top-8 bg-white border border-gray-300 rounded shadow-lg p-3 z-50 min-w-[250px]",children:[z.jsx("div",{className:"text-xs font-medium text-gray-600 mb-3",children:" Admin Panel"}),z.jsxs("div",{className:"mb-3 pb-3 border-b border-gray-200",children:[z.jsx("div",{className:"text-xs font-medium text-gray-700 mb-2",children:"Create Random Shapes"}),z.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[z.jsx("input",{type:"number",min:"1",max:"500",value:o,onChange:E=>l(parseInt(E.target.value)||1),className:"w-16 px-2 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",disabled:c}),z.jsx("button",{onClick:S,disabled:c,className:"flex-1 text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:c?"Creating...":" Create"})]}),z.jsx("div",{className:"text-[10px] text-gray-500",children:"Random rects & circles"})]}),z.jsx("button",{onClick:_,disabled:i||c,className:"w-full text-left text-xs text-blue-600 hover:text-blue-800 px-2 py-1 rounded hover:bg-blue-50 disabled:opacity-50 mb-1",children:" Clear All Locks"}),z.jsx("button",{onClick:m,disabled:i||c,className:"w-full text-left text-xs text-red-600 hover:text-red-800 px-2 py-1 rounded hover:bg-red-50 disabled:opacity-50",children:" Delete All Shapes"}),(i||c)&&z.jsx("div",{className:"text-xs text-gray-500 mt-2 text-center",children:"Working..."})]})]}),z.jsx("button",{onClick:p,className:"text-sm text-gray-500 hover:text-gray-700 px-3 py-1 rounded border border-gray-300 hover:border-gray-400",children:"Sign Out"})]})]}):null},Pq=()=>{const{setUser:n,setLoading:e,setError:t,clearUser:r}=ua();return ee.useEffect(()=>{const i=UD(cc,async s=>{try{if(s){const o=Q$(s);n(o,s),console.log(" User authenticated:",o.displayName),await tA(o)}else r(),console.log(" User signed out")}catch(o){console.error("Auth state change error:",o),t("Authentication error occurred")}finally{e(!1)}},s=>{console.error("Auth state observer error:",s),t("Failed to initialize authentication"),e(!1)});return()=>i()},[n,e,t,r]),ua()},Rq=({children:n,fallback:e})=>{const{isAuthenticated:t,isLoading:r,error:i}=Pq();return r?z.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:z.jsx("div",{className:"bg-white rounded-lg shadow-md p-8",children:z.jsxs("div",{className:"text-center",children:[z.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),z.jsx("p",{className:"text-gray-600",children:"Checking authentication..."})]})})}):i?z.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:z.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 max-w-md",children:[z.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Authentication Error"}),z.jsx("p",{className:"text-gray-700 mb-4",children:"Firebase authentication error:"}),z.jsx("p",{className:"text-sm text-red-600 bg-red-50 p-3 rounded mb-4",children:i}),z.jsx("button",{onClick:()=>window.location.reload(),className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700",children:"Reload Page"})]})}):t?z.jsx(z.Fragment,{children:n}):z.jsx(z.Fragment,{children:e})};class sI extends ee.Component{constructor(t){super(t);er(this,"handleReload",()=>{window.location.reload()});er(this,"handleRetry",()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0})});this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){console.error(" React Error Boundary caught an error:",t),console.error("Error Info:",r),this.setState({error:t,errorInfo:r})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:z.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center px-4",children:z.jsx("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6",children:z.jsxs("div",{className:"text-center",children:[z.jsx("div",{className:"text-6xl mb-4",children:""}),z.jsx("h1",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Something went wrong"}),z.jsx("p",{className:"text-gray-600 mb-6",children:"The canvas encountered an unexpected error. This shouldn't happen often."}),z.jsxs("div",{className:"space-y-3",children:[z.jsx("button",{onClick:this.handleRetry,className:"w-full bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors",children:"Try Again"}),z.jsx("button",{onClick:this.handleReload,className:"w-full bg-gray-200 text-gray-900 px-4 py-2 rounded-md hover:bg-gray-300 transition-colors",children:"Reload Page"})]}),!1]})})}):this.props.children}}const xq=()=>{const[n,e]=ee.useState({isOnline:!0,isConnecting:!1,lastConnected:null});return ee.useEffect(()=>{const t=pS(),r=io(t,".info/connected"),i=kf(r,s=>{const o=s.val()===!0,l=new Date;e(c=>({isOnline:o,isConnecting:!o&&c.isOnline,lastConnected:o?l:c.lastConnected})),console.log(o?" Firebase connected":" Firebase disconnected - showing reconnection banner")});return()=>i()},[]),n},Aq=()=>{const{isOnline:n,isConnecting:e}=xq();return n&&!e?null:z.jsxs("div",{className:"fixed top-0 left-0 right-0 z-50 bg-amber-500 text-white px-4 py-2 text-center text-sm font-medium shadow-lg",children:[z.jsxs("div",{className:"flex items-center justify-center gap-2",children:[z.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),z.jsx("span",{children:e?"Reconnecting...":"Connection lost - trying to reconnect"})]}),z.jsx("div",{className:"text-xs mt-1 opacity-90",children:"Changes will sync when connection is restored"})]})},Nq=()=>{const{user:n}=ua(),[e,t]=ee.useState({});ee.useEffect(()=>n?nA(s=>{t(s)}):void 0,[n]);const r=Object.entries(e);return z.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[z.jsxs("h3",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2",children:[" Online Users",z.jsx("span",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full",children:r.length})]}),z.jsx("div",{className:"space-y-2",children:r.length===0?z.jsx("div",{className:"text-xs text-gray-500 italic",children:n?`Waiting for presence data... (Current user: ${n.displayName})`:"No users online"}):r.map(([i,s])=>z.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50",children:[z.jsx("div",{className:"w-3 h-3 rounded-full border border-white shadow-sm",style:{backgroundColor:s.cursorColor}}),z.jsxs("span",{className:"text-sm font-medium text-gray-900 truncate",children:[s.displayName,i===(n==null?void 0:n.uid)&&z.jsx("span",{className:"text-xs text-blue-600 font-medium ml-1",children:"(you)"})]}),s.currentlyEditing&&z.jsx("span",{className:"text-xs text-orange-600",children:""}),z.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full ml-auto"})]},i))})]})},bq=()=>{const[n,e]=ee.useState(null),[t,r]=ee.useState(!1);return ee.useEffect(()=>{},[]),ee.useEffect(()=>{const i=s=>{(s.ctrlKey||s.metaKey)&&s.key==="p"&&s.shiftKey&&(s.preventDefault(),r(!t))};return window.addEventListener("keydown",i),()=>window.removeEventListener("keydown",i)},[t]),null};function Dq(){const n=z.jsxs("div",{className:"container mx-auto px-4 py-8",children:[z.jsx("h1",{className:"text-4xl font-bold text-center text-gray-800 mb-8",children:"CollabCanvas MVP"}),z.jsxs("div",{className:"text-center mb-8",children:[z.jsx("p",{className:"text-lg text-gray-600 mb-2",children:"Real-Time Collaborative Design Tool"}),z.jsx("p",{className:"text-sm text-gray-500",children:"Please sign in to continue"})]}),z.jsx(_z,{})]});return z.jsx(sI,{children:z.jsxs("div",{className:"min-h-screen bg-gray-50",children:[z.jsx(Aq,{}),z.jsx(bq,{}),z.jsx(Rq,{fallback:n,children:z.jsxs("div",{className:"h-screen flex flex-col",children:[z.jsx(kq,{}),z.jsx("main",{className:"flex-1 p-4",children:z.jsxs("div",{className:"h-full flex",children:[z.jsx(sI,{fallback:z.jsxs("div",{className:"flex-1 mr-4 bg-white rounded-lg border border-red-200 p-8 text-center",children:[z.jsx("div",{className:"text-4xl mb-4",children:""}),z.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Canvas Error"}),z.jsx("p",{className:"text-gray-600 mb-4",children:"The canvas encountered an error. Try refreshing the page."}),z.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Reload Canvas"})]}),children:z.jsx("div",{className:"flex-1 mr-4",children:z.jsx(Cq,{width:1200,height:800})})}),z.jsxs("div",{className:"w-64 space-y-4",children:[z.jsx(Nq,{}),z.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[z.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Shortcuts"}),z.jsxs("div",{className:"space-y-1.5 text-xs text-gray-600",children:[z.jsxs("div",{children:[z.jsx("strong",{children:"Click"}),"  Create shape"]}),z.jsxs("div",{children:[z.jsx("strong",{children:"Shift+Drag"}),"  Marquee select"]}),z.jsxs("div",{children:[z.jsx("strong",{children:"Shift+Click"}),"  Multi-select"]}),z.jsxs("div",{children:[z.jsx("strong",{children:"/Ctrl+A"}),"  Select all"]}),z.jsxs("div",{children:[z.jsx("strong",{children:"Delete"}),"  Delete selected"]}),z.jsxs("div",{children:[z.jsx("strong",{children:"Space+Drag"}),"  Pan canvas"]}),z.jsxs("div",{children:[z.jsx("strong",{children:"Scroll"}),"  Zoom/Pan"]})]})]})]})]})})]})})]})})}qv.createRoot(document.getElementById("root")).render(z.jsx(Sn.StrictMode,{children:z.jsx(Dq,{})}));
