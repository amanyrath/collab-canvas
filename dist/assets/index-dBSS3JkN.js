var wA=Object.defineProperty;var EA=(n,e,t)=>e in n?wA(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var by=(n,e,t)=>EA(n,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var G4=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Vm(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var q5={exports:{}},Um={},K5={exports:{}},ze={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $d=Symbol.for("react.element"),SA=Symbol.for("react.portal"),TA=Symbol.for("react.fragment"),CA=Symbol.for("react.strict_mode"),IA=Symbol.for("react.profiler"),PA=Symbol.for("react.provider"),kA=Symbol.for("react.context"),RA=Symbol.for("react.forward_ref"),xA=Symbol.for("react.suspense"),AA=Symbol.for("react.memo"),NA=Symbol.for("react.lazy"),W4=Symbol.iterator;function DA(n){return n===null||typeof n!="object"?null:(n=W4&&n[W4]||n["@@iterator"],typeof n=="function"?n:null)}var Q5={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Y5=Object.assign,X5={};function uc(n,e,t){this.props=n,this.context=e,this.refs=X5,this.updater=t||Q5}uc.prototype.isReactComponent={};uc.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};uc.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function J5(){}J5.prototype=uc.prototype;function D2(n,e,t){this.props=n,this.context=e,this.refs=X5,this.updater=t||Q5}var b2=D2.prototype=new J5;b2.constructor=D2;Y5(b2,uc.prototype);b2.isPureReactComponent=!0;var H4=Array.isArray,Z5=Object.prototype.hasOwnProperty,O2={current:null},eI={key:!0,ref:!0,__self:!0,__source:!0};function tI(n,e,t){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)Z5.call(e,r)&&!eI.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=t;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];i.children=c}if(n&&n.defaultProps)for(r in l=n.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:$d,type:n,key:s,ref:o,props:i,_owner:O2.current}}function bA(n,e){return{$$typeof:$d,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function M2(n){return typeof n=="object"&&n!==null&&n.$$typeof===$d}function OA(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var $4=/\/+/g;function Oy(n,e){return typeof n=="object"&&n!==null&&n.key!=null?OA(""+n.key):e.toString(36)}function ng(n,e,t,r,i){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case $d:case SA:o=!0}}if(o)return o=n,i=i(o),n=r===""?"."+Oy(o,0):r,H4(i)?(t="",n!=null&&(t=n.replace($4,"$&/")+"/"),ng(i,e,t,"",function(d){return d})):i!=null&&(M2(i)&&(i=bA(i,t+(!i.key||o&&o.key===i.key?"":(""+i.key).replace($4,"$&/")+"/")+n)),e.push(i)),1;if(o=0,r=r===""?".":r+":",H4(n))for(var l=0;l<n.length;l++){s=n[l];var c=r+Oy(s,l);o+=ng(s,e,t,c,i)}else if(c=DA(n),typeof c=="function")for(n=c.call(n),l=0;!(s=n.next()).done;)s=s.value,c=r+Oy(s,l++),o+=ng(s,e,t,c,i);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Pp(n,e,t){if(n==null)return n;var r=[],i=0;return ng(n,r,"","",function(s){return e.call(t,s,i++)}),r}function MA(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var gr={current:null},rg={transition:null},LA={ReactCurrentDispatcher:gr,ReactCurrentBatchConfig:rg,ReactCurrentOwner:O2};function nI(){throw Error("act(...) is not supported in production builds of React.")}ze.Children={map:Pp,forEach:function(n,e,t){Pp(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Pp(n,function(){e++}),e},toArray:function(n){return Pp(n,function(e){return e})||[]},only:function(n){if(!M2(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};ze.Component=uc;ze.Fragment=TA;ze.Profiler=IA;ze.PureComponent=D2;ze.StrictMode=CA;ze.Suspense=xA;ze.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=LA;ze.act=nI;ze.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=Y5({},n.props),i=n.key,s=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=O2.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var l=n.type.defaultProps;for(c in e)Z5.call(e,c)&&!eI.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=t;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:$d,type:n.type,key:i,ref:s,props:r,_owner:o}};ze.createContext=function(n){return n={$$typeof:kA,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:PA,_context:n},n.Consumer=n};ze.createElement=tI;ze.createFactory=function(n){var e=tI.bind(null,n);return e.type=n,e};ze.createRef=function(){return{current:null}};ze.forwardRef=function(n){return{$$typeof:RA,render:n}};ze.isValidElement=M2;ze.lazy=function(n){return{$$typeof:NA,_payload:{_status:-1,_result:n},_init:MA}};ze.memo=function(n,e){return{$$typeof:AA,type:n,compare:e===void 0?null:e}};ze.startTransition=function(n){var e=rg.transition;rg.transition={};try{n()}finally{rg.transition=e}};ze.unstable_act=nI;ze.useCallback=function(n,e){return gr.current.useCallback(n,e)};ze.useContext=function(n){return gr.current.useContext(n)};ze.useDebugValue=function(){};ze.useDeferredValue=function(n){return gr.current.useDeferredValue(n)};ze.useEffect=function(n,e){return gr.current.useEffect(n,e)};ze.useId=function(){return gr.current.useId()};ze.useImperativeHandle=function(n,e,t){return gr.current.useImperativeHandle(n,e,t)};ze.useInsertionEffect=function(n,e){return gr.current.useInsertionEffect(n,e)};ze.useLayoutEffect=function(n,e){return gr.current.useLayoutEffect(n,e)};ze.useMemo=function(n,e){return gr.current.useMemo(n,e)};ze.useReducer=function(n,e,t){return gr.current.useReducer(n,e,t)};ze.useRef=function(n){return gr.current.useRef(n)};ze.useState=function(n){return gr.current.useState(n)};ze.useSyncExternalStore=function(n,e,t){return gr.current.useSyncExternalStore(n,e,t)};ze.useTransition=function(){return gr.current.useTransition()};ze.version="18.3.1";K5.exports=ze;var me=K5.exports;const wn=Vm(me);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FA=me,VA=Symbol.for("react.element"),UA=Symbol.for("react.fragment"),BA=Object.prototype.hasOwnProperty,zA=FA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,jA={key:!0,ref:!0,__self:!0,__source:!0};function rI(n,e,t){var r,i={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)BA.call(e,r)&&!jA.hasOwnProperty(r)&&(i[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:VA,type:n,key:s,ref:o,props:i,_owner:zA.current}}Um.Fragment=UA;Um.jsx=rI;Um.jsxs=rI;q5.exports=Um;var z=q5.exports,Vv={},iI={exports:{}},jr={},sI={exports:{}},oI={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(Y,oe){var ne=Y.length;Y.push(oe);e:for(;0<ne;){var ae=ne-1>>>1,pe=Y[ae];if(0<i(pe,oe))Y[ae]=oe,Y[ne]=pe,ne=ae;else break e}}function t(Y){return Y.length===0?null:Y[0]}function r(Y){if(Y.length===0)return null;var oe=Y[0],ne=Y.pop();if(ne!==oe){Y[0]=ne;e:for(var ae=0,pe=Y.length,Se=pe>>>1;ae<Se;){var en=2*(ae+1)-1,xt=Y[en],pt=en+1,j=Y[pt];if(0>i(xt,ne))pt<pe&&0>i(j,xt)?(Y[ae]=j,Y[pt]=ne,ae=pt):(Y[ae]=xt,Y[en]=ne,ae=en);else if(pt<pe&&0>i(j,ne))Y[ae]=j,Y[pt]=ne,ae=pt;else break e}}return oe}function i(Y,oe){var ne=Y.sortIndex-oe.sortIndex;return ne!==0?ne:Y.id-oe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var c=[],d=[],p=1,_=null,m=3,E=!1,S=!1,k=!1,N=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(Y){for(var oe=t(d);oe!==null;){if(oe.callback===null)r(d);else if(oe.startTime<=Y)r(d),oe.sortIndex=oe.expirationTime,e(c,oe);else break;oe=t(d)}}function P(Y){if(k=!1,w(Y),!S)if(t(c)!==null)S=!0,Be(F);else{var oe=t(d);oe!==null&&De(P,oe.startTime-Y)}}function F(Y,oe){S=!1,k&&(k=!1,x(C),C=-1),E=!0;var ne=m;try{for(w(oe),_=t(c);_!==null&&(!(_.expirationTime>oe)||Y&&!M());){var ae=_.callback;if(typeof ae=="function"){_.callback=null,m=_.priorityLevel;var pe=ae(_.expirationTime<=oe);oe=n.unstable_now(),typeof pe=="function"?_.callback=pe:_===t(c)&&r(c),w(oe)}else r(c);_=t(c)}if(_!==null)var Se=!0;else{var en=t(d);en!==null&&De(P,en.startTime-oe),Se=!1}return Se}finally{_=null,m=ne,E=!1}}var U=!1,D=null,C=-1,b=5,A=-1;function M(){return!(n.unstable_now()-A<b)}function B(){if(D!==null){var Y=n.unstable_now();A=Y;var oe=!0;try{oe=D(!0,Y)}finally{oe?V():(U=!1,D=null)}}else U=!1}var V;if(typeof R=="function")V=function(){R(B)};else if(typeof MessageChannel<"u"){var fe=new MessageChannel,se=fe.port2;fe.port1.onmessage=B,V=function(){se.postMessage(null)}}else V=function(){N(B,0)};function Be(Y){D=Y,U||(U=!0,V())}function De(Y,oe){C=N(function(){Y(n.unstable_now())},oe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Y){Y.callback=null},n.unstable_continueExecution=function(){S||E||(S=!0,Be(F))},n.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<Y?Math.floor(1e3/Y):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(Y){switch(m){case 1:case 2:case 3:var oe=3;break;default:oe=m}var ne=m;m=oe;try{return Y()}finally{m=ne}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(Y,oe){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var ne=m;m=Y;try{return oe()}finally{m=ne}},n.unstable_scheduleCallback=function(Y,oe,ne){var ae=n.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?ae+ne:ae):ne=ae,Y){case 1:var pe=-1;break;case 2:pe=250;break;case 5:pe=1073741823;break;case 4:pe=1e4;break;default:pe=5e3}return pe=ne+pe,Y={id:p++,callback:oe,priorityLevel:Y,startTime:ne,expirationTime:pe,sortIndex:-1},ne>ae?(Y.sortIndex=ne,e(d,Y),t(c)===null&&Y===t(d)&&(k?(x(C),C=-1):k=!0,De(P,ne-ae))):(Y.sortIndex=pe,e(c,Y),S||E||(S=!0,Be(F))),Y},n.unstable_shouldYield=M,n.unstable_wrapCallback=function(Y){var oe=m;return function(){var ne=m;m=oe;try{return Y.apply(this,arguments)}finally{m=ne}}}})(oI);sI.exports=oI;var Vh=sI.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GA=me,zr=Vh;function ee(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var aI=new Set,sd={};function _l(n,e){Vu(n,e),Vu(n+"Capture",e)}function Vu(n,e){for(sd[n]=e,n=0;n<e.length;n++)aI.add(e[n])}var Gs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Uv=Object.prototype.hasOwnProperty,WA=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,q4={},K4={};function HA(n){return Uv.call(K4,n)?!0:Uv.call(q4,n)?!1:WA.test(n)?K4[n]=!0:(q4[n]=!0,!1)}function $A(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function qA(n,e,t,r){if(e===null||typeof e>"u"||$A(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function mr(n,e,t,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Un={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Un[n]=new mr(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Un[e]=new mr(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Un[n]=new mr(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Un[n]=new mr(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Un[n]=new mr(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Un[n]=new mr(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Un[n]=new mr(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Un[n]=new mr(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Un[n]=new mr(n,5,!1,n.toLowerCase(),null,!1,!1)});var L2=/[\-:]([a-z])/g;function F2(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(L2,F2);Un[e]=new mr(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(L2,F2);Un[e]=new mr(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(L2,F2);Un[e]=new mr(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Un[n]=new mr(n,1,!1,n.toLowerCase(),null,!1,!1)});Un.xlinkHref=new mr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Un[n]=new mr(n,1,!1,n.toLowerCase(),null,!0,!0)});function V2(n,e,t,r){var i=Un.hasOwnProperty(e)?Un[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(qA(e,t,i,r)&&(t=null),r||i===null?HA(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,r=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var Zs=GA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,kp=Symbol.for("react.element"),hu=Symbol.for("react.portal"),du=Symbol.for("react.fragment"),U2=Symbol.for("react.strict_mode"),Bv=Symbol.for("react.profiler"),lI=Symbol.for("react.provider"),uI=Symbol.for("react.context"),B2=Symbol.for("react.forward_ref"),zv=Symbol.for("react.suspense"),jv=Symbol.for("react.suspense_list"),z2=Symbol.for("react.memo"),Io=Symbol.for("react.lazy"),cI=Symbol.for("react.offscreen"),Q4=Symbol.iterator;function ch(n){return n===null||typeof n!="object"?null:(n=Q4&&n[Q4]||n["@@iterator"],typeof n=="function"?n:null)}var Mt=Object.assign,My;function kh(n){if(My===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);My=e&&e[1]||""}return`
`+My+n}var Ly=!1;function Fy(n,e){if(!n||Ly)return"";Ly=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(n,[],e)}else{try{e.call()}catch(d){r=d}n.call(e.prototype)}else{try{throw Error()}catch(d){r=d}n()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var c=`
`+i[o].replace(" at new "," at ");return n.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",n.displayName)),c}while(1<=o&&0<=l);break}}}finally{Ly=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?kh(n):""}function KA(n){switch(n.tag){case 5:return kh(n.type);case 16:return kh("Lazy");case 13:return kh("Suspense");case 19:return kh("SuspenseList");case 0:case 2:case 15:return n=Fy(n.type,!1),n;case 11:return n=Fy(n.type.render,!1),n;case 1:return n=Fy(n.type,!0),n;default:return""}}function Gv(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case du:return"Fragment";case hu:return"Portal";case Bv:return"Profiler";case U2:return"StrictMode";case zv:return"Suspense";case jv:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case uI:return(n.displayName||"Context")+".Consumer";case lI:return(n._context.displayName||"Context")+".Provider";case B2:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case z2:return e=n.displayName||null,e!==null?e:Gv(n.type)||"Memo";case Io:e=n._payload,n=n._init;try{return Gv(n(e))}catch{}}return null}function QA(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Gv(e);case 8:return e===U2?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Qo(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function hI(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function YA(n){var e=hI(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Rp(n){n._valueTracker||(n._valueTracker=YA(n))}function dI(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=hI(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function kg(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Wv(n,e){var t=e.checked;return Mt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function Y4(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=Qo(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function fI(n,e){e=e.checked,e!=null&&V2(n,"checked",e,!1)}function Hv(n,e){fI(n,e);var t=Qo(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?$v(n,e.type,t):e.hasOwnProperty("defaultValue")&&$v(n,e.type,Qo(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function X4(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function $v(n,e,t){(e!=="number"||kg(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Rh=Array.isArray;function Iu(n,e,t,r){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&r&&(n[t].defaultSelected=!0)}else{for(t=""+Qo(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,r&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function qv(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ee(91));return Mt({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function J4(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(ee(92));if(Rh(t)){if(1<t.length)throw Error(ee(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Qo(t)}}function pI(n,e){var t=Qo(e.value),r=Qo(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function Z4(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function gI(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Kv(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?gI(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var xp,mI=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(xp=xp||document.createElement("div"),xp.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=xp.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function od(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var Uh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},XA=["Webkit","ms","Moz","O"];Object.keys(Uh).forEach(function(n){XA.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),Uh[e]=Uh[n]})});function _I(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Uh.hasOwnProperty(n)&&Uh[n]?(""+e).trim():e+"px"}function yI(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,i=_I(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,i):n[t]=i}}var JA=Mt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Qv(n,e){if(e){if(JA[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ee(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ee(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ee(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ee(62))}}function Yv(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Xv=null;function j2(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Jv=null,Pu=null,ku=null;function eT(n){if(n=Qd(n)){if(typeof Jv!="function")throw Error(ee(280));var e=n.stateNode;e&&(e=Wm(e),Jv(n.stateNode,n.type,e))}}function vI(n){Pu?ku?ku.push(n):ku=[n]:Pu=n}function wI(){if(Pu){var n=Pu,e=ku;if(ku=Pu=null,eT(n),e)for(n=0;n<e.length;n++)eT(e[n])}}function EI(n,e){return n(e)}function SI(){}var Vy=!1;function TI(n,e,t){if(Vy)return n(e,t);Vy=!0;try{return EI(n,e,t)}finally{Vy=!1,(Pu!==null||ku!==null)&&(SI(),wI())}}function ad(n,e){var t=n.stateNode;if(t===null)return null;var r=Wm(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(ee(231,e,typeof t));return t}var Zv=!1;if(Gs)try{var hh={};Object.defineProperty(hh,"passive",{get:function(){Zv=!0}}),window.addEventListener("test",hh,hh),window.removeEventListener("test",hh,hh)}catch{Zv=!1}function ZA(n,e,t,r,i,s,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(t,d)}catch(p){this.onError(p)}}var Bh=!1,Rg=null,xg=!1,e1=null,e8={onError:function(n){Bh=!0,Rg=n}};function t8(n,e,t,r,i,s,o,l,c){Bh=!1,Rg=null,ZA.apply(e8,arguments)}function n8(n,e,t,r,i,s,o,l,c){if(t8.apply(this,arguments),Bh){if(Bh){var d=Rg;Bh=!1,Rg=null}else throw Error(ee(198));xg||(xg=!0,e1=d)}}function yl(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function CI(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function tT(n){if(yl(n)!==n)throw Error(ee(188))}function r8(n){var e=n.alternate;if(!e){if(e=yl(n),e===null)throw Error(ee(188));return e!==n?null:n}for(var t=n,r=e;;){var i=t.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){t=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===t)return tT(i),n;if(s===r)return tT(i),e;s=s.sibling}throw Error(ee(188))}if(t.return!==r.return)t=i,r=s;else{for(var o=!1,l=i.child;l;){if(l===t){o=!0,t=i,r=s;break}if(l===r){o=!0,r=i,t=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===t){o=!0,t=s,r=i;break}if(l===r){o=!0,r=s,t=i;break}l=l.sibling}if(!o)throw Error(ee(189))}}if(t.alternate!==r)throw Error(ee(190))}if(t.tag!==3)throw Error(ee(188));return t.stateNode.current===t?n:e}function II(n){return n=r8(n),n!==null?PI(n):null}function PI(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=PI(n);if(e!==null)return e;n=n.sibling}return null}var kI=zr.unstable_scheduleCallback,nT=zr.unstable_cancelCallback,i8=zr.unstable_shouldYield,s8=zr.unstable_requestPaint,Gt=zr.unstable_now,o8=zr.unstable_getCurrentPriorityLevel,G2=zr.unstable_ImmediatePriority,RI=zr.unstable_UserBlockingPriority,Ag=zr.unstable_NormalPriority,a8=zr.unstable_LowPriority,xI=zr.unstable_IdlePriority,Bm=null,Zi=null;function l8(n){if(Zi&&typeof Zi.onCommitFiberRoot=="function")try{Zi.onCommitFiberRoot(Bm,n,void 0,(n.current.flags&128)===128)}catch{}}var Pi=Math.clz32?Math.clz32:h8,u8=Math.log,c8=Math.LN2;function h8(n){return n>>>=0,n===0?32:31-(u8(n)/c8|0)|0}var Ap=64,Np=4194304;function xh(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Ng(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,i=n.suspendedLanes,s=n.pingedLanes,o=t&268435455;if(o!==0){var l=o&~i;l!==0?r=xh(l):(s&=o,s!==0&&(r=xh(s)))}else o=t&~i,o!==0?r=xh(o):s!==0&&(r=xh(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-Pi(e),i=1<<t,r|=n[t],e&=~i;return r}function d8(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function f8(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,i=n.expirationTimes,s=n.pendingLanes;0<s;){var o=31-Pi(s),l=1<<o,c=i[o];c===-1?(!(l&t)||l&r)&&(i[o]=d8(l,e)):c<=e&&(n.expiredLanes|=l),s&=~l}}function t1(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function AI(){var n=Ap;return Ap<<=1,!(Ap&4194240)&&(Ap=64),n}function Uy(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function qd(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Pi(e),n[e]=t}function p8(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-Pi(t),s=1<<i;e[i]=0,r[i]=-1,n[i]=-1,t&=~s}}function W2(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-Pi(t),i=1<<r;i&e|n[r]&e&&(n[r]|=e),t&=~i}}var ut=0;function NI(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var DI,H2,bI,OI,MI,n1=!1,Dp=[],Mo=null,Lo=null,Fo=null,ld=new Map,ud=new Map,ko=[],g8="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function rT(n,e){switch(n){case"focusin":case"focusout":Mo=null;break;case"dragenter":case"dragleave":Lo=null;break;case"mouseover":case"mouseout":Fo=null;break;case"pointerover":case"pointerout":ld.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ud.delete(e.pointerId)}}function dh(n,e,t,r,i,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Qd(e),e!==null&&H2(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function m8(n,e,t,r,i){switch(e){case"focusin":return Mo=dh(Mo,n,e,t,r,i),!0;case"dragenter":return Lo=dh(Lo,n,e,t,r,i),!0;case"mouseover":return Fo=dh(Fo,n,e,t,r,i),!0;case"pointerover":var s=i.pointerId;return ld.set(s,dh(ld.get(s)||null,n,e,t,r,i)),!0;case"gotpointercapture":return s=i.pointerId,ud.set(s,dh(ud.get(s)||null,n,e,t,r,i)),!0}return!1}function LI(n){var e=Ha(n.target);if(e!==null){var t=yl(e);if(t!==null){if(e=t.tag,e===13){if(e=CI(t),e!==null){n.blockedOn=e,MI(n.priority,function(){bI(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function ig(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=r1(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);Xv=r,t.target.dispatchEvent(r),Xv=null}else return e=Qd(t),e!==null&&H2(e),n.blockedOn=t,!1;e.shift()}return!0}function iT(n,e,t){ig(n)&&t.delete(e)}function _8(){n1=!1,Mo!==null&&ig(Mo)&&(Mo=null),Lo!==null&&ig(Lo)&&(Lo=null),Fo!==null&&ig(Fo)&&(Fo=null),ld.forEach(iT),ud.forEach(iT)}function fh(n,e){n.blockedOn===e&&(n.blockedOn=null,n1||(n1=!0,zr.unstable_scheduleCallback(zr.unstable_NormalPriority,_8)))}function cd(n){function e(i){return fh(i,n)}if(0<Dp.length){fh(Dp[0],n);for(var t=1;t<Dp.length;t++){var r=Dp[t];r.blockedOn===n&&(r.blockedOn=null)}}for(Mo!==null&&fh(Mo,n),Lo!==null&&fh(Lo,n),Fo!==null&&fh(Fo,n),ld.forEach(e),ud.forEach(e),t=0;t<ko.length;t++)r=ko[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<ko.length&&(t=ko[0],t.blockedOn===null);)LI(t),t.blockedOn===null&&ko.shift()}var Ru=Zs.ReactCurrentBatchConfig,Dg=!0;function y8(n,e,t,r){var i=ut,s=Ru.transition;Ru.transition=null;try{ut=1,$2(n,e,t,r)}finally{ut=i,Ru.transition=s}}function v8(n,e,t,r){var i=ut,s=Ru.transition;Ru.transition=null;try{ut=4,$2(n,e,t,r)}finally{ut=i,Ru.transition=s}}function $2(n,e,t,r){if(Dg){var i=r1(n,e,t,r);if(i===null)Qy(n,e,r,bg,t),rT(n,r);else if(m8(i,n,e,t,r))r.stopPropagation();else if(rT(n,r),e&4&&-1<g8.indexOf(n)){for(;i!==null;){var s=Qd(i);if(s!==null&&DI(s),s=r1(n,e,t,r),s===null&&Qy(n,e,r,bg,t),s===i)break;i=s}i!==null&&r.stopPropagation()}else Qy(n,e,r,null,t)}}var bg=null;function r1(n,e,t,r){if(bg=null,n=j2(r),n=Ha(n),n!==null)if(e=yl(n),e===null)n=null;else if(t=e.tag,t===13){if(n=CI(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return bg=n,null}function FI(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(o8()){case G2:return 1;case RI:return 4;case Ag:case a8:return 16;case xI:return 536870912;default:return 16}default:return 16}}var Do=null,q2=null,sg=null;function VI(){if(sg)return sg;var n,e=q2,t=e.length,r,i="value"in Do?Do.value:Do.textContent,s=i.length;for(n=0;n<t&&e[n]===i[n];n++);var o=t-n;for(r=1;r<=o&&e[t-r]===i[s-r];r++);return sg=i.slice(n,1<r?1-r:void 0)}function og(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function bp(){return!0}function sT(){return!1}function Gr(n){function e(t,r,i,s,o){this._reactName=t,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in n)n.hasOwnProperty(l)&&(t=n[l],this[l]=t?t(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?bp:sT,this.isPropagationStopped=sT,this}return Mt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=bp)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=bp)},persist:function(){},isPersistent:bp}),e}var cc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},K2=Gr(cc),Kd=Mt({},cc,{view:0,detail:0}),w8=Gr(Kd),By,zy,ph,zm=Mt({},Kd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Q2,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==ph&&(ph&&n.type==="mousemove"?(By=n.screenX-ph.screenX,zy=n.screenY-ph.screenY):zy=By=0,ph=n),By)},movementY:function(n){return"movementY"in n?n.movementY:zy}}),oT=Gr(zm),E8=Mt({},zm,{dataTransfer:0}),S8=Gr(E8),T8=Mt({},Kd,{relatedTarget:0}),jy=Gr(T8),C8=Mt({},cc,{animationName:0,elapsedTime:0,pseudoElement:0}),I8=Gr(C8),P8=Mt({},cc,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),k8=Gr(P8),R8=Mt({},cc,{data:0}),aT=Gr(R8),x8={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},A8={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},N8={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function D8(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=N8[n])?!!e[n]:!1}function Q2(){return D8}var b8=Mt({},Kd,{key:function(n){if(n.key){var e=x8[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=og(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?A8[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Q2,charCode:function(n){return n.type==="keypress"?og(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?og(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),O8=Gr(b8),M8=Mt({},zm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lT=Gr(M8),L8=Mt({},Kd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Q2}),F8=Gr(L8),V8=Mt({},cc,{propertyName:0,elapsedTime:0,pseudoElement:0}),U8=Gr(V8),B8=Mt({},zm,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),z8=Gr(B8),j8=[9,13,27,32],Y2=Gs&&"CompositionEvent"in window,zh=null;Gs&&"documentMode"in document&&(zh=document.documentMode);var G8=Gs&&"TextEvent"in window&&!zh,UI=Gs&&(!Y2||zh&&8<zh&&11>=zh),uT=" ",cT=!1;function BI(n,e){switch(n){case"keyup":return j8.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zI(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var fu=!1;function W8(n,e){switch(n){case"compositionend":return zI(e);case"keypress":return e.which!==32?null:(cT=!0,uT);case"textInput":return n=e.data,n===uT&&cT?null:n;default:return null}}function H8(n,e){if(fu)return n==="compositionend"||!Y2&&BI(n,e)?(n=VI(),sg=q2=Do=null,fu=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return UI&&e.locale!=="ko"?null:e.data;default:return null}}var $8={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function hT(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!$8[n.type]:e==="textarea"}function jI(n,e,t,r){vI(r),e=Og(e,"onChange"),0<e.length&&(t=new K2("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var jh=null,hd=null;function q8(n){ZI(n,0)}function jm(n){var e=mu(n);if(dI(e))return n}function K8(n,e){if(n==="change")return e}var GI=!1;if(Gs){var Gy;if(Gs){var Wy="oninput"in document;if(!Wy){var dT=document.createElement("div");dT.setAttribute("oninput","return;"),Wy=typeof dT.oninput=="function"}Gy=Wy}else Gy=!1;GI=Gy&&(!document.documentMode||9<document.documentMode)}function fT(){jh&&(jh.detachEvent("onpropertychange",WI),hd=jh=null)}function WI(n){if(n.propertyName==="value"&&jm(hd)){var e=[];jI(e,hd,n,j2(n)),TI(q8,e)}}function Q8(n,e,t){n==="focusin"?(fT(),jh=e,hd=t,jh.attachEvent("onpropertychange",WI)):n==="focusout"&&fT()}function Y8(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return jm(hd)}function X8(n,e){if(n==="click")return jm(e)}function J8(n,e){if(n==="input"||n==="change")return jm(e)}function Z8(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Ni=typeof Object.is=="function"?Object.is:Z8;function dd(n,e){if(Ni(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var i=t[r];if(!Uv.call(e,i)||!Ni(n[i],e[i]))return!1}return!0}function pT(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function gT(n,e){var t=pT(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=pT(t)}}function HI(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?HI(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function $I(){for(var n=window,e=kg();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=kg(n.document)}return e}function X2(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function eN(n){var e=$I(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&HI(t.ownerDocument.documentElement,t)){if(r!==null&&X2(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!n.extend&&s>r&&(i=r,r=s,s=i),i=gT(t,s);var o=gT(t,r);i&&o&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),s>r?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var tN=Gs&&"documentMode"in document&&11>=document.documentMode,pu=null,i1=null,Gh=null,s1=!1;function mT(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;s1||pu==null||pu!==kg(r)||(r=pu,"selectionStart"in r&&X2(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Gh&&dd(Gh,r)||(Gh=r,r=Og(i1,"onSelect"),0<r.length&&(e=new K2("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=pu)))}function Op(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var gu={animationend:Op("Animation","AnimationEnd"),animationiteration:Op("Animation","AnimationIteration"),animationstart:Op("Animation","AnimationStart"),transitionend:Op("Transition","TransitionEnd")},Hy={},qI={};Gs&&(qI=document.createElement("div").style,"AnimationEvent"in window||(delete gu.animationend.animation,delete gu.animationiteration.animation,delete gu.animationstart.animation),"TransitionEvent"in window||delete gu.transitionend.transition);function Gm(n){if(Hy[n])return Hy[n];if(!gu[n])return n;var e=gu[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in qI)return Hy[n]=e[t];return n}var KI=Gm("animationend"),QI=Gm("animationiteration"),YI=Gm("animationstart"),XI=Gm("transitionend"),JI=new Map,_T="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function sa(n,e){JI.set(n,e),_l(e,[n])}for(var $y=0;$y<_T.length;$y++){var qy=_T[$y],nN=qy.toLowerCase(),rN=qy[0].toUpperCase()+qy.slice(1);sa(nN,"on"+rN)}sa(KI,"onAnimationEnd");sa(QI,"onAnimationIteration");sa(YI,"onAnimationStart");sa("dblclick","onDoubleClick");sa("focusin","onFocus");sa("focusout","onBlur");sa(XI,"onTransitionEnd");Vu("onMouseEnter",["mouseout","mouseover"]);Vu("onMouseLeave",["mouseout","mouseover"]);Vu("onPointerEnter",["pointerout","pointerover"]);Vu("onPointerLeave",["pointerout","pointerover"]);_l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));_l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));_l("onBeforeInput",["compositionend","keypress","textInput","paste"]);_l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));_l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));_l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ah="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),iN=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ah));function yT(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,n8(r,e,void 0,n),n.currentTarget=null}function ZI(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==s&&i.isPropagationStopped())break e;yT(i,l,d),s=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==s&&i.isPropagationStopped())break e;yT(i,l,d),s=c}}}if(xg)throw n=e1,xg=!1,e1=null,n}function Tt(n,e){var t=e[c1];t===void 0&&(t=e[c1]=new Set);var r=n+"__bubble";t.has(r)||(e6(e,n,2,!1),t.add(r))}function Ky(n,e,t){var r=0;e&&(r|=4),e6(t,n,r,e)}var Mp="_reactListening"+Math.random().toString(36).slice(2);function fd(n){if(!n[Mp]){n[Mp]=!0,aI.forEach(function(t){t!=="selectionchange"&&(iN.has(t)||Ky(t,!1,n),Ky(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Mp]||(e[Mp]=!0,Ky("selectionchange",!1,e))}}function e6(n,e,t,r){switch(FI(e)){case 1:var i=y8;break;case 4:i=v8;break;default:i=$2}t=i.bind(null,e,t,n),i=void 0,!Zv||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function Qy(n,e,t,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=Ha(l),o===null)return;if(c=o.tag,c===5||c===6){r=s=o;continue e}l=l.parentNode}}r=r.return}TI(function(){var d=s,p=j2(t),_=[];e:{var m=JI.get(n);if(m!==void 0){var E=K2,S=n;switch(n){case"keypress":if(og(t)===0)break e;case"keydown":case"keyup":E=O8;break;case"focusin":S="focus",E=jy;break;case"focusout":S="blur",E=jy;break;case"beforeblur":case"afterblur":E=jy;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":E=oT;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":E=S8;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":E=F8;break;case KI:case QI:case YI:E=I8;break;case XI:E=U8;break;case"scroll":E=w8;break;case"wheel":E=z8;break;case"copy":case"cut":case"paste":E=k8;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":E=lT}var k=(e&4)!==0,N=!k&&n==="scroll",x=k?m!==null?m+"Capture":null:m;k=[];for(var R=d,w;R!==null;){w=R;var P=w.stateNode;if(w.tag===5&&P!==null&&(w=P,x!==null&&(P=ad(R,x),P!=null&&k.push(pd(R,P,w)))),N)break;R=R.return}0<k.length&&(m=new E(m,S,null,t,p),_.push({event:m,listeners:k}))}}if(!(e&7)){e:{if(m=n==="mouseover"||n==="pointerover",E=n==="mouseout"||n==="pointerout",m&&t!==Xv&&(S=t.relatedTarget||t.fromElement)&&(Ha(S)||S[Ws]))break e;if((E||m)&&(m=p.window===p?p:(m=p.ownerDocument)?m.defaultView||m.parentWindow:window,E?(S=t.relatedTarget||t.toElement,E=d,S=S?Ha(S):null,S!==null&&(N=yl(S),S!==N||S.tag!==5&&S.tag!==6)&&(S=null)):(E=null,S=d),E!==S)){if(k=oT,P="onMouseLeave",x="onMouseEnter",R="mouse",(n==="pointerout"||n==="pointerover")&&(k=lT,P="onPointerLeave",x="onPointerEnter",R="pointer"),N=E==null?m:mu(E),w=S==null?m:mu(S),m=new k(P,R+"leave",E,t,p),m.target=N,m.relatedTarget=w,P=null,Ha(p)===d&&(k=new k(x,R+"enter",S,t,p),k.target=w,k.relatedTarget=N,P=k),N=P,E&&S)t:{for(k=E,x=S,R=0,w=k;w;w=nu(w))R++;for(w=0,P=x;P;P=nu(P))w++;for(;0<R-w;)k=nu(k),R--;for(;0<w-R;)x=nu(x),w--;for(;R--;){if(k===x||x!==null&&k===x.alternate)break t;k=nu(k),x=nu(x)}k=null}else k=null;E!==null&&vT(_,m,E,k,!1),S!==null&&N!==null&&vT(_,N,S,k,!0)}}e:{if(m=d?mu(d):window,E=m.nodeName&&m.nodeName.toLowerCase(),E==="select"||E==="input"&&m.type==="file")var F=K8;else if(hT(m))if(GI)F=J8;else{F=Y8;var U=Q8}else(E=m.nodeName)&&E.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(F=X8);if(F&&(F=F(n,d))){jI(_,F,t,p);break e}U&&U(n,m,d),n==="focusout"&&(U=m._wrapperState)&&U.controlled&&m.type==="number"&&$v(m,"number",m.value)}switch(U=d?mu(d):window,n){case"focusin":(hT(U)||U.contentEditable==="true")&&(pu=U,i1=d,Gh=null);break;case"focusout":Gh=i1=pu=null;break;case"mousedown":s1=!0;break;case"contextmenu":case"mouseup":case"dragend":s1=!1,mT(_,t,p);break;case"selectionchange":if(tN)break;case"keydown":case"keyup":mT(_,t,p)}var D;if(Y2)e:{switch(n){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else fu?BI(n,t)&&(C="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(C="onCompositionStart");C&&(UI&&t.locale!=="ko"&&(fu||C!=="onCompositionStart"?C==="onCompositionEnd"&&fu&&(D=VI()):(Do=p,q2="value"in Do?Do.value:Do.textContent,fu=!0)),U=Og(d,C),0<U.length&&(C=new aT(C,n,null,t,p),_.push({event:C,listeners:U}),D?C.data=D:(D=zI(t),D!==null&&(C.data=D)))),(D=G8?W8(n,t):H8(n,t))&&(d=Og(d,"onBeforeInput"),0<d.length&&(p=new aT("onBeforeInput","beforeinput",null,t,p),_.push({event:p,listeners:d}),p.data=D))}ZI(_,e)})}function pd(n,e,t){return{instance:n,listener:e,currentTarget:t}}function Og(n,e){for(var t=e+"Capture",r=[];n!==null;){var i=n,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=ad(n,t),s!=null&&r.unshift(pd(n,s,i)),s=ad(n,e),s!=null&&r.push(pd(n,s,i))),n=n.return}return r}function nu(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function vT(n,e,t,r,i){for(var s=e._reactName,o=[];t!==null&&t!==r;){var l=t,c=l.alternate,d=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&d!==null&&(l=d,i?(c=ad(t,s),c!=null&&o.unshift(pd(t,c,l))):i||(c=ad(t,s),c!=null&&o.push(pd(t,c,l)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var sN=/\r\n?/g,oN=/\u0000|\uFFFD/g;function wT(n){return(typeof n=="string"?n:""+n).replace(sN,`
`).replace(oN,"")}function Lp(n,e,t){if(e=wT(e),wT(n)!==e&&t)throw Error(ee(425))}function Mg(){}var o1=null,a1=null;function l1(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var u1=typeof setTimeout=="function"?setTimeout:void 0,aN=typeof clearTimeout=="function"?clearTimeout:void 0,ET=typeof Promise=="function"?Promise:void 0,lN=typeof queueMicrotask=="function"?queueMicrotask:typeof ET<"u"?function(n){return ET.resolve(null).then(n).catch(uN)}:u1;function uN(n){setTimeout(function(){throw n})}function Yy(n,e){var t=e,r=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(r===0){n.removeChild(i),cd(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=i}while(t);cd(e)}function Vo(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function ST(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var hc=Math.random().toString(36).slice(2),Xi="__reactFiber$"+hc,gd="__reactProps$"+hc,Ws="__reactContainer$"+hc,c1="__reactEvents$"+hc,cN="__reactListeners$"+hc,hN="__reactHandles$"+hc;function Ha(n){var e=n[Xi];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Ws]||t[Xi]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=ST(n);n!==null;){if(t=n[Xi])return t;n=ST(n)}return e}n=t,t=n.parentNode}return null}function Qd(n){return n=n[Xi]||n[Ws],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function mu(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(ee(33))}function Wm(n){return n[gd]||null}var h1=[],_u=-1;function oa(n){return{current:n}}function It(n){0>_u||(n.current=h1[_u],h1[_u]=null,_u--)}function Et(n,e){_u++,h1[_u]=n.current,n.current=e}var Yo={},rr=oa(Yo),Ar=oa(!1),tl=Yo;function Uu(n,e){var t=n.type.contextTypes;if(!t)return Yo;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in t)i[s]=e[s];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function Nr(n){return n=n.childContextTypes,n!=null}function Lg(){It(Ar),It(rr)}function TT(n,e,t){if(rr.current!==Yo)throw Error(ee(168));Et(rr,e),Et(Ar,t)}function t6(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ee(108,QA(n)||"Unknown",i));return Mt({},t,r)}function Fg(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Yo,tl=rr.current,Et(rr,n),Et(Ar,Ar.current),!0}function CT(n,e,t){var r=n.stateNode;if(!r)throw Error(ee(169));t?(n=t6(n,e,tl),r.__reactInternalMemoizedMergedChildContext=n,It(Ar),It(rr),Et(rr,n)):It(Ar),Et(Ar,t)}var Rs=null,Hm=!1,Xy=!1;function n6(n){Rs===null?Rs=[n]:Rs.push(n)}function dN(n){Hm=!0,n6(n)}function aa(){if(!Xy&&Rs!==null){Xy=!0;var n=0,e=ut;try{var t=Rs;for(ut=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}Rs=null,Hm=!1}catch(i){throw Rs!==null&&(Rs=Rs.slice(n+1)),kI(G2,aa),i}finally{ut=e,Xy=!1}}return null}var yu=[],vu=0,Vg=null,Ug=0,Zr=[],ei=0,nl=null,Ds=1,bs="";function Ba(n,e){yu[vu++]=Ug,yu[vu++]=Vg,Vg=n,Ug=e}function r6(n,e,t){Zr[ei++]=Ds,Zr[ei++]=bs,Zr[ei++]=nl,nl=n;var r=Ds;n=bs;var i=32-Pi(r)-1;r&=~(1<<i),t+=1;var s=32-Pi(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Ds=1<<32-Pi(e)+i|t<<i|r,bs=s+n}else Ds=1<<s|t<<i|r,bs=n}function J2(n){n.return!==null&&(Ba(n,1),r6(n,1,0))}function Z2(n){for(;n===Vg;)Vg=yu[--vu],yu[vu]=null,Ug=yu[--vu],yu[vu]=null;for(;n===nl;)nl=Zr[--ei],Zr[ei]=null,bs=Zr[--ei],Zr[ei]=null,Ds=Zr[--ei],Zr[ei]=null}var Ur=null,Fr=null,kt=!1,Si=null;function i6(n,e){var t=ti(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function IT(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Ur=n,Fr=Vo(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Ur=n,Fr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=nl!==null?{id:Ds,overflow:bs}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=ti(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Ur=n,Fr=null,!0):!1;default:return!1}}function d1(n){return(n.mode&1)!==0&&(n.flags&128)===0}function f1(n){if(kt){var e=Fr;if(e){var t=e;if(!IT(n,e)){if(d1(n))throw Error(ee(418));e=Vo(t.nextSibling);var r=Ur;e&&IT(n,e)?i6(r,t):(n.flags=n.flags&-4097|2,kt=!1,Ur=n)}}else{if(d1(n))throw Error(ee(418));n.flags=n.flags&-4097|2,kt=!1,Ur=n}}}function PT(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Ur=n}function Fp(n){if(n!==Ur)return!1;if(!kt)return PT(n),kt=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!l1(n.type,n.memoizedProps)),e&&(e=Fr)){if(d1(n))throw s6(),Error(ee(418));for(;e;)i6(n,e),e=Vo(e.nextSibling)}if(PT(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(ee(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Fr=Vo(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Fr=null}}else Fr=Ur?Vo(n.stateNode.nextSibling):null;return!0}function s6(){for(var n=Fr;n;)n=Vo(n.nextSibling)}function Bu(){Fr=Ur=null,kt=!1}function ew(n){Si===null?Si=[n]:Si.push(n)}var fN=Zs.ReactCurrentBatchConfig;function gh(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(ee(309));var r=t.stateNode}if(!r)throw Error(ee(147,n));var i=r,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},e._stringRef=s,e)}if(typeof n!="string")throw Error(ee(284));if(!t._owner)throw Error(ee(290,n))}return n}function Vp(n,e){throw n=Object.prototype.toString.call(e),Error(ee(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function kT(n){var e=n._init;return e(n._payload)}function o6(n){function e(x,R){if(n){var w=x.deletions;w===null?(x.deletions=[R],x.flags|=16):w.push(R)}}function t(x,R){if(!n)return null;for(;R!==null;)e(x,R),R=R.sibling;return null}function r(x,R){for(x=new Map;R!==null;)R.key!==null?x.set(R.key,R):x.set(R.index,R),R=R.sibling;return x}function i(x,R){return x=jo(x,R),x.index=0,x.sibling=null,x}function s(x,R,w){return x.index=w,n?(w=x.alternate,w!==null?(w=w.index,w<R?(x.flags|=2,R):w):(x.flags|=2,R)):(x.flags|=1048576,R)}function o(x){return n&&x.alternate===null&&(x.flags|=2),x}function l(x,R,w,P){return R===null||R.tag!==6?(R=iv(w,x.mode,P),R.return=x,R):(R=i(R,w),R.return=x,R)}function c(x,R,w,P){var F=w.type;return F===du?p(x,R,w.props.children,P,w.key):R!==null&&(R.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===Io&&kT(F)===R.type)?(P=i(R,w.props),P.ref=gh(x,R,w),P.return=x,P):(P=fg(w.type,w.key,w.props,null,x.mode,P),P.ref=gh(x,R,w),P.return=x,P)}function d(x,R,w,P){return R===null||R.tag!==4||R.stateNode.containerInfo!==w.containerInfo||R.stateNode.implementation!==w.implementation?(R=sv(w,x.mode,P),R.return=x,R):(R=i(R,w.children||[]),R.return=x,R)}function p(x,R,w,P,F){return R===null||R.tag!==7?(R=Za(w,x.mode,P,F),R.return=x,R):(R=i(R,w),R.return=x,R)}function _(x,R,w){if(typeof R=="string"&&R!==""||typeof R=="number")return R=iv(""+R,x.mode,w),R.return=x,R;if(typeof R=="object"&&R!==null){switch(R.$$typeof){case kp:return w=fg(R.type,R.key,R.props,null,x.mode,w),w.ref=gh(x,null,R),w.return=x,w;case hu:return R=sv(R,x.mode,w),R.return=x,R;case Io:var P=R._init;return _(x,P(R._payload),w)}if(Rh(R)||ch(R))return R=Za(R,x.mode,w,null),R.return=x,R;Vp(x,R)}return null}function m(x,R,w,P){var F=R!==null?R.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return F!==null?null:l(x,R,""+w,P);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case kp:return w.key===F?c(x,R,w,P):null;case hu:return w.key===F?d(x,R,w,P):null;case Io:return F=w._init,m(x,R,F(w._payload),P)}if(Rh(w)||ch(w))return F!==null?null:p(x,R,w,P,null);Vp(x,w)}return null}function E(x,R,w,P,F){if(typeof P=="string"&&P!==""||typeof P=="number")return x=x.get(w)||null,l(R,x,""+P,F);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case kp:return x=x.get(P.key===null?w:P.key)||null,c(R,x,P,F);case hu:return x=x.get(P.key===null?w:P.key)||null,d(R,x,P,F);case Io:var U=P._init;return E(x,R,w,U(P._payload),F)}if(Rh(P)||ch(P))return x=x.get(w)||null,p(R,x,P,F,null);Vp(R,P)}return null}function S(x,R,w,P){for(var F=null,U=null,D=R,C=R=0,b=null;D!==null&&C<w.length;C++){D.index>C?(b=D,D=null):b=D.sibling;var A=m(x,D,w[C],P);if(A===null){D===null&&(D=b);break}n&&D&&A.alternate===null&&e(x,D),R=s(A,R,C),U===null?F=A:U.sibling=A,U=A,D=b}if(C===w.length)return t(x,D),kt&&Ba(x,C),F;if(D===null){for(;C<w.length;C++)D=_(x,w[C],P),D!==null&&(R=s(D,R,C),U===null?F=D:U.sibling=D,U=D);return kt&&Ba(x,C),F}for(D=r(x,D);C<w.length;C++)b=E(D,x,C,w[C],P),b!==null&&(n&&b.alternate!==null&&D.delete(b.key===null?C:b.key),R=s(b,R,C),U===null?F=b:U.sibling=b,U=b);return n&&D.forEach(function(M){return e(x,M)}),kt&&Ba(x,C),F}function k(x,R,w,P){var F=ch(w);if(typeof F!="function")throw Error(ee(150));if(w=F.call(w),w==null)throw Error(ee(151));for(var U=F=null,D=R,C=R=0,b=null,A=w.next();D!==null&&!A.done;C++,A=w.next()){D.index>C?(b=D,D=null):b=D.sibling;var M=m(x,D,A.value,P);if(M===null){D===null&&(D=b);break}n&&D&&M.alternate===null&&e(x,D),R=s(M,R,C),U===null?F=M:U.sibling=M,U=M,D=b}if(A.done)return t(x,D),kt&&Ba(x,C),F;if(D===null){for(;!A.done;C++,A=w.next())A=_(x,A.value,P),A!==null&&(R=s(A,R,C),U===null?F=A:U.sibling=A,U=A);return kt&&Ba(x,C),F}for(D=r(x,D);!A.done;C++,A=w.next())A=E(D,x,C,A.value,P),A!==null&&(n&&A.alternate!==null&&D.delete(A.key===null?C:A.key),R=s(A,R,C),U===null?F=A:U.sibling=A,U=A);return n&&D.forEach(function(B){return e(x,B)}),kt&&Ba(x,C),F}function N(x,R,w,P){if(typeof w=="object"&&w!==null&&w.type===du&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case kp:e:{for(var F=w.key,U=R;U!==null;){if(U.key===F){if(F=w.type,F===du){if(U.tag===7){t(x,U.sibling),R=i(U,w.props.children),R.return=x,x=R;break e}}else if(U.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===Io&&kT(F)===U.type){t(x,U.sibling),R=i(U,w.props),R.ref=gh(x,U,w),R.return=x,x=R;break e}t(x,U);break}else e(x,U);U=U.sibling}w.type===du?(R=Za(w.props.children,x.mode,P,w.key),R.return=x,x=R):(P=fg(w.type,w.key,w.props,null,x.mode,P),P.ref=gh(x,R,w),P.return=x,x=P)}return o(x);case hu:e:{for(U=w.key;R!==null;){if(R.key===U)if(R.tag===4&&R.stateNode.containerInfo===w.containerInfo&&R.stateNode.implementation===w.implementation){t(x,R.sibling),R=i(R,w.children||[]),R.return=x,x=R;break e}else{t(x,R);break}else e(x,R);R=R.sibling}R=sv(w,x.mode,P),R.return=x,x=R}return o(x);case Io:return U=w._init,N(x,R,U(w._payload),P)}if(Rh(w))return S(x,R,w,P);if(ch(w))return k(x,R,w,P);Vp(x,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,R!==null&&R.tag===6?(t(x,R.sibling),R=i(R,w),R.return=x,x=R):(t(x,R),R=iv(w,x.mode,P),R.return=x,x=R),o(x)):t(x,R)}return N}var zu=o6(!0),a6=o6(!1),Bg=oa(null),zg=null,wu=null,tw=null;function nw(){tw=wu=zg=null}function rw(n){var e=Bg.current;It(Bg),n._currentValue=e}function p1(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function xu(n,e){zg=n,tw=wu=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(kr=!0),n.firstContext=null)}function si(n){var e=n._currentValue;if(tw!==n)if(n={context:n,memoizedValue:e,next:null},wu===null){if(zg===null)throw Error(ee(308));wu=n,zg.dependencies={lanes:0,firstContext:n}}else wu=wu.next=n;return e}var $a=null;function iw(n){$a===null?$a=[n]:$a.push(n)}function l6(n,e,t,r){var i=e.interleaved;return i===null?(t.next=t,iw(e)):(t.next=i.next,i.next=t),e.interleaved=t,Hs(n,r)}function Hs(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Po=!1;function sw(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function u6(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Vs(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Uo(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,Je&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Hs(n,t)}return i=r.interleaved,i===null?(e.next=e,iw(r)):(e.next=i.next,i.next=e),r.interleaved=e,Hs(n,t)}function ag(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,W2(n,t)}}function RT(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var i=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?i=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?i=s=e:s=s.next=e}else i=s=e;t={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function jg(n,e,t,r){var i=n.updateQueue;Po=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?s=d:o.next=d,o=c;var p=n.alternate;p!==null&&(p=p.updateQueue,l=p.lastBaseUpdate,l!==o&&(l===null?p.firstBaseUpdate=d:l.next=d,p.lastBaseUpdate=c))}if(s!==null){var _=i.baseState;o=0,p=d=c=null,l=s;do{var m=l.lane,E=l.eventTime;if((r&m)===m){p!==null&&(p=p.next={eventTime:E,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var S=n,k=l;switch(m=e,E=t,k.tag){case 1:if(S=k.payload,typeof S=="function"){_=S.call(E,_,m);break e}_=S;break e;case 3:S.flags=S.flags&-65537|128;case 0:if(S=k.payload,m=typeof S=="function"?S.call(E,_,m):S,m==null)break e;_=Mt({},_,m);break e;case 2:Po=!0}}l.callback!==null&&l.lane!==0&&(n.flags|=64,m=i.effects,m===null?i.effects=[l]:m.push(l))}else E={eventTime:E,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},p===null?(d=p=E,c=_):p=p.next=E,o|=m;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;m=l,l=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);if(p===null&&(c=_),i.baseState=c,i.firstBaseUpdate=d,i.lastBaseUpdate=p,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);il|=o,n.lanes=o,n.memoizedState=_}}function xT(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],i=r.callback;if(i!==null){if(r.callback=null,r=t,typeof i!="function")throw Error(ee(191,i));i.call(r)}}}var Yd={},es=oa(Yd),md=oa(Yd),_d=oa(Yd);function qa(n){if(n===Yd)throw Error(ee(174));return n}function ow(n,e){switch(Et(_d,e),Et(md,n),Et(es,Yd),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Kv(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=Kv(e,n)}It(es),Et(es,e)}function ju(){It(es),It(md),It(_d)}function c6(n){qa(_d.current);var e=qa(es.current),t=Kv(e,n.type);e!==t&&(Et(md,n),Et(es,t))}function aw(n){md.current===n&&(It(es),It(md))}var Dt=oa(0);function Gg(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Jy=[];function lw(){for(var n=0;n<Jy.length;n++)Jy[n]._workInProgressVersionPrimary=null;Jy.length=0}var lg=Zs.ReactCurrentDispatcher,Zy=Zs.ReactCurrentBatchConfig,rl=0,Ot=null,an=null,En=null,Wg=!1,Wh=!1,yd=0,pN=0;function Qn(){throw Error(ee(321))}function uw(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Ni(n[t],e[t]))return!1;return!0}function cw(n,e,t,r,i,s){if(rl=s,Ot=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,lg.current=n===null||n.memoizedState===null?yN:vN,n=t(r,i),Wh){s=0;do{if(Wh=!1,yd=0,25<=s)throw Error(ee(301));s+=1,En=an=null,e.updateQueue=null,lg.current=wN,n=t(r,i)}while(Wh)}if(lg.current=Hg,e=an!==null&&an.next!==null,rl=0,En=an=Ot=null,Wg=!1,e)throw Error(ee(300));return n}function hw(){var n=yd!==0;return yd=0,n}function Yi(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return En===null?Ot.memoizedState=En=n:En=En.next=n,En}function oi(){if(an===null){var n=Ot.alternate;n=n!==null?n.memoizedState:null}else n=an.next;var e=En===null?Ot.memoizedState:En.next;if(e!==null)En=e,an=n;else{if(n===null)throw Error(ee(310));an=n,n={memoizedState:an.memoizedState,baseState:an.baseState,baseQueue:an.baseQueue,queue:an.queue,next:null},En===null?Ot.memoizedState=En=n:En=En.next=n}return En}function vd(n,e){return typeof e=="function"?e(n):e}function ev(n){var e=oi(),t=e.queue;if(t===null)throw Error(ee(311));t.lastRenderedReducer=n;var r=an,i=r.baseQueue,s=t.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,t.pending=null}if(i!==null){s=i.next,r=r.baseState;var l=o=null,c=null,d=s;do{var p=d.lane;if((rl&p)===p)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:n(r,d.action);else{var _={lane:p,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=_,o=r):c=c.next=_,Ot.lanes|=p,il|=p}d=d.next}while(d!==null&&d!==s);c===null?o=r:c.next=l,Ni(r,e.memoizedState)||(kr=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,t.lastRenderedState=r}if(n=t.interleaved,n!==null){i=n;do s=i.lane,Ot.lanes|=s,il|=s,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function tv(n){var e=oi(),t=e.queue;if(t===null)throw Error(ee(311));t.lastRenderedReducer=n;var r=t.dispatch,i=t.pending,s=e.memoizedState;if(i!==null){t.pending=null;var o=i=i.next;do s=n(s,o.action),o=o.next;while(o!==i);Ni(s,e.memoizedState)||(kr=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,r]}function h6(){}function d6(n,e){var t=Ot,r=oi(),i=e(),s=!Ni(r.memoizedState,i);if(s&&(r.memoizedState=i,kr=!0),r=r.queue,dw(g6.bind(null,t,r,n),[n]),r.getSnapshot!==e||s||En!==null&&En.memoizedState.tag&1){if(t.flags|=2048,wd(9,p6.bind(null,t,r,i,e),void 0,null),In===null)throw Error(ee(349));rl&30||f6(t,e,i)}return i}function f6(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Ot.updateQueue,e===null?(e={lastEffect:null,stores:null},Ot.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function p6(n,e,t,r){e.value=t,e.getSnapshot=r,m6(e)&&_6(n)}function g6(n,e,t){return t(function(){m6(e)&&_6(n)})}function m6(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Ni(n,t)}catch{return!0}}function _6(n){var e=Hs(n,1);e!==null&&ki(e,n,1,-1)}function AT(n){var e=Yi();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:vd,lastRenderedState:n},e.queue=n,n=n.dispatch=_N.bind(null,Ot,n),[e.memoizedState,n]}function wd(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=Ot.updateQueue,e===null?(e={lastEffect:null,stores:null},Ot.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function y6(){return oi().memoizedState}function ug(n,e,t,r){var i=Yi();Ot.flags|=n,i.memoizedState=wd(1|e,t,void 0,r===void 0?null:r)}function $m(n,e,t,r){var i=oi();r=r===void 0?null:r;var s=void 0;if(an!==null){var o=an.memoizedState;if(s=o.destroy,r!==null&&uw(r,o.deps)){i.memoizedState=wd(e,t,s,r);return}}Ot.flags|=n,i.memoizedState=wd(1|e,t,s,r)}function NT(n,e){return ug(8390656,8,n,e)}function dw(n,e){return $m(2048,8,n,e)}function v6(n,e){return $m(4,2,n,e)}function w6(n,e){return $m(4,4,n,e)}function E6(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function S6(n,e,t){return t=t!=null?t.concat([n]):null,$m(4,4,E6.bind(null,e,n),t)}function fw(){}function T6(n,e){var t=oi();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&uw(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function C6(n,e){var t=oi();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&uw(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function I6(n,e,t){return rl&21?(Ni(t,e)||(t=AI(),Ot.lanes|=t,il|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,kr=!0),n.memoizedState=t)}function gN(n,e){var t=ut;ut=t!==0&&4>t?t:4,n(!0);var r=Zy.transition;Zy.transition={};try{n(!1),e()}finally{ut=t,Zy.transition=r}}function P6(){return oi().memoizedState}function mN(n,e,t){var r=zo(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},k6(n))R6(e,t);else if(t=l6(n,e,t,r),t!==null){var i=pr();ki(t,n,r,i),x6(t,e,r)}}function _N(n,e,t){var r=zo(n),i={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(k6(n))R6(e,i);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,l=s(o,t);if(i.hasEagerState=!0,i.eagerState=l,Ni(l,o)){var c=e.interleaved;c===null?(i.next=i,iw(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}t=l6(n,e,i,r),t!==null&&(i=pr(),ki(t,n,r,i),x6(t,e,r))}}function k6(n){var e=n.alternate;return n===Ot||e!==null&&e===Ot}function R6(n,e){Wh=Wg=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function x6(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,W2(n,t)}}var Hg={readContext:si,useCallback:Qn,useContext:Qn,useEffect:Qn,useImperativeHandle:Qn,useInsertionEffect:Qn,useLayoutEffect:Qn,useMemo:Qn,useReducer:Qn,useRef:Qn,useState:Qn,useDebugValue:Qn,useDeferredValue:Qn,useTransition:Qn,useMutableSource:Qn,useSyncExternalStore:Qn,useId:Qn,unstable_isNewReconciler:!1},yN={readContext:si,useCallback:function(n,e){return Yi().memoizedState=[n,e===void 0?null:e],n},useContext:si,useEffect:NT,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,ug(4194308,4,E6.bind(null,e,n),t)},useLayoutEffect:function(n,e){return ug(4194308,4,n,e)},useInsertionEffect:function(n,e){return ug(4,2,n,e)},useMemo:function(n,e){var t=Yi();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=Yi();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=mN.bind(null,Ot,n),[r.memoizedState,n]},useRef:function(n){var e=Yi();return n={current:n},e.memoizedState=n},useState:AT,useDebugValue:fw,useDeferredValue:function(n){return Yi().memoizedState=n},useTransition:function(){var n=AT(!1),e=n[0];return n=gN.bind(null,n[1]),Yi().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=Ot,i=Yi();if(kt){if(t===void 0)throw Error(ee(407));t=t()}else{if(t=e(),In===null)throw Error(ee(349));rl&30||f6(r,e,t)}i.memoizedState=t;var s={value:t,getSnapshot:e};return i.queue=s,NT(g6.bind(null,r,s,n),[n]),r.flags|=2048,wd(9,p6.bind(null,r,s,t,e),void 0,null),t},useId:function(){var n=Yi(),e=In.identifierPrefix;if(kt){var t=bs,r=Ds;t=(r&~(1<<32-Pi(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=yd++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=pN++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},vN={readContext:si,useCallback:T6,useContext:si,useEffect:dw,useImperativeHandle:S6,useInsertionEffect:v6,useLayoutEffect:w6,useMemo:C6,useReducer:ev,useRef:y6,useState:function(){return ev(vd)},useDebugValue:fw,useDeferredValue:function(n){var e=oi();return I6(e,an.memoizedState,n)},useTransition:function(){var n=ev(vd)[0],e=oi().memoizedState;return[n,e]},useMutableSource:h6,useSyncExternalStore:d6,useId:P6,unstable_isNewReconciler:!1},wN={readContext:si,useCallback:T6,useContext:si,useEffect:dw,useImperativeHandle:S6,useInsertionEffect:v6,useLayoutEffect:w6,useMemo:C6,useReducer:tv,useRef:y6,useState:function(){return tv(vd)},useDebugValue:fw,useDeferredValue:function(n){var e=oi();return an===null?e.memoizedState=n:I6(e,an.memoizedState,n)},useTransition:function(){var n=tv(vd)[0],e=oi().memoizedState;return[n,e]},useMutableSource:h6,useSyncExternalStore:d6,useId:P6,unstable_isNewReconciler:!1};function wi(n,e){if(n&&n.defaultProps){e=Mt({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function g1(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:Mt({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var qm={isMounted:function(n){return(n=n._reactInternals)?yl(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=pr(),i=zo(n),s=Vs(r,i);s.payload=e,t!=null&&(s.callback=t),e=Uo(n,s,i),e!==null&&(ki(e,n,i,r),ag(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=pr(),i=zo(n),s=Vs(r,i);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=Uo(n,s,i),e!==null&&(ki(e,n,i,r),ag(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=pr(),r=zo(n),i=Vs(t,r);i.tag=2,e!=null&&(i.callback=e),e=Uo(n,i,r),e!==null&&(ki(e,n,r,t),ag(e,n,r))}};function DT(n,e,t,r,i,s,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!dd(t,r)||!dd(i,s):!0}function A6(n,e,t){var r=!1,i=Yo,s=e.contextType;return typeof s=="object"&&s!==null?s=si(s):(i=Nr(e)?tl:rr.current,r=e.contextTypes,s=(r=r!=null)?Uu(n,i):Yo),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=qm,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=s),e}function bT(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&qm.enqueueReplaceState(e,e.state,null)}function m1(n,e,t,r){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},sw(n);var s=e.contextType;typeof s=="object"&&s!==null?i.context=si(s):(s=Nr(e)?tl:rr.current,i.context=Uu(n,s)),i.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(g1(n,e,s,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&qm.enqueueReplaceState(i,i.state,null),jg(n,t,i,r),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function Gu(n,e){try{var t="",r=e;do t+=KA(r),r=r.return;while(r);var i=t}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:i,digest:null}}function nv(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function _1(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var EN=typeof WeakMap=="function"?WeakMap:Map;function N6(n,e,t){t=Vs(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){qg||(qg=!0,k1=r),_1(n,e)},t}function D6(n,e,t){t=Vs(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;t.payload=function(){return r(i)},t.callback=function(){_1(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){_1(n,e),typeof r!="function"&&(Bo===null?Bo=new Set([this]):Bo.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function OT(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new EN;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(t)||(i.add(t),n=MN.bind(null,n,e,t),e.then(n,n))}function MT(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function LT(n,e,t,r,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Vs(-1,1),e.tag=2,Uo(t,e,1))),t.lanes|=1),n)}var SN=Zs.ReactCurrentOwner,kr=!1;function dr(n,e,t,r){e.child=n===null?a6(e,null,t,r):zu(e,n.child,t,r)}function FT(n,e,t,r,i){t=t.render;var s=e.ref;return xu(e,i),r=cw(n,e,t,r,s,i),t=hw(),n!==null&&!kr?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,$s(n,e,i)):(kt&&t&&J2(e),e.flags|=1,dr(n,e,r,i),e.child)}function VT(n,e,t,r,i){if(n===null){var s=t.type;return typeof s=="function"&&!Ew(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,b6(n,e,s,r,i)):(n=fg(t.type,null,r,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&i)){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:dd,t(o,r)&&n.ref===e.ref)return $s(n,e,i)}return e.flags|=1,n=jo(s,r),n.ref=e.ref,n.return=e,e.child=n}function b6(n,e,t,r,i){if(n!==null){var s=n.memoizedProps;if(dd(s,r)&&n.ref===e.ref)if(kr=!1,e.pendingProps=r=s,(n.lanes&i)!==0)n.flags&131072&&(kr=!0);else return e.lanes=n.lanes,$s(n,e,i)}return y1(n,e,t,r,i)}function O6(n,e,t){var r=e.pendingProps,i=r.children,s=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Et(Su,Lr),Lr|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Et(Su,Lr),Lr|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:t,Et(Su,Lr),Lr|=r}else s!==null?(r=s.baseLanes|t,e.memoizedState=null):r=t,Et(Su,Lr),Lr|=r;return dr(n,e,i,t),e.child}function M6(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function y1(n,e,t,r,i){var s=Nr(t)?tl:rr.current;return s=Uu(e,s),xu(e,i),t=cw(n,e,t,r,s,i),r=hw(),n!==null&&!kr?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,$s(n,e,i)):(kt&&r&&J2(e),e.flags|=1,dr(n,e,t,i),e.child)}function UT(n,e,t,r,i){if(Nr(t)){var s=!0;Fg(e)}else s=!1;if(xu(e,i),e.stateNode===null)cg(n,e),A6(e,t,r),m1(e,t,r,i),r=!0;else if(n===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,d=t.contextType;typeof d=="object"&&d!==null?d=si(d):(d=Nr(t)?tl:rr.current,d=Uu(e,d));var p=t.getDerivedStateFromProps,_=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function";_||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==d)&&bT(e,o,r,d),Po=!1;var m=e.memoizedState;o.state=m,jg(e,r,o,i),c=e.memoizedState,l!==r||m!==c||Ar.current||Po?(typeof p=="function"&&(g1(e,t,p,r),c=e.memoizedState),(l=Po||DT(e,t,l,r,m,c,d))?(_||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,u6(n,e),l=e.memoizedProps,d=e.type===e.elementType?l:wi(e.type,l),o.props=d,_=e.pendingProps,m=o.context,c=t.contextType,typeof c=="object"&&c!==null?c=si(c):(c=Nr(t)?tl:rr.current,c=Uu(e,c));var E=t.getDerivedStateFromProps;(p=typeof E=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==_||m!==c)&&bT(e,o,r,c),Po=!1,m=e.memoizedState,o.state=m,jg(e,r,o,i);var S=e.memoizedState;l!==_||m!==S||Ar.current||Po?(typeof E=="function"&&(g1(e,t,E,r),S=e.memoizedState),(d=Po||DT(e,t,d,r,m,S,c)||!1)?(p||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,S,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,S,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===n.memoizedProps&&m===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&m===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=S),o.props=r,o.state=S,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||l===n.memoizedProps&&m===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&m===n.memoizedState||(e.flags|=1024),r=!1)}return v1(n,e,t,r,s,i)}function v1(n,e,t,r,i,s){M6(n,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&CT(e,t,!1),$s(n,e,s);r=e.stateNode,SN.current=e;var l=o&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&o?(e.child=zu(e,n.child,null,s),e.child=zu(e,null,l,s)):dr(n,e,l,s),e.memoizedState=r.state,i&&CT(e,t,!0),e.child}function L6(n){var e=n.stateNode;e.pendingContext?TT(n,e.pendingContext,e.pendingContext!==e.context):e.context&&TT(n,e.context,!1),ow(n,e.containerInfo)}function BT(n,e,t,r,i){return Bu(),ew(i),e.flags|=256,dr(n,e,t,r),e.child}var w1={dehydrated:null,treeContext:null,retryLane:0};function E1(n){return{baseLanes:n,cachePool:null,transitions:null}}function F6(n,e,t){var r=e.pendingProps,i=Dt.current,s=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=n!==null&&n.memoizedState===null?!1:(i&2)!==0),l?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),Et(Dt,i&1),n===null)return f1(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,n=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Ym(o,r,0,null),n=Za(n,r,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=E1(t),e.memoizedState=w1,n):pw(e,o));if(i=n.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return TN(n,e,o,r,l,i,t);if(s){s=r.fallback,o=e.mode,i=n.child,l=i.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=jo(i,c),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=jo(l,s):(s=Za(s,o,t,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=n.child.memoizedState,o=o===null?E1(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=n.childLanes&~t,e.memoizedState=w1,r}return s=n.child,n=s.sibling,r=jo(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function pw(n,e){return e=Ym({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function Up(n,e,t,r){return r!==null&&ew(r),zu(e,n.child,null,t),n=pw(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function TN(n,e,t,r,i,s,o){if(t)return e.flags&256?(e.flags&=-257,r=nv(Error(ee(422))),Up(n,e,o,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Ym({mode:"visible",children:r.children},i,0,null),s=Za(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&zu(e,n.child,null,o),e.child.memoizedState=E1(o),e.memoizedState=w1,s);if(!(e.mode&1))return Up(n,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error(ee(419)),r=nv(s,r,void 0),Up(n,e,o,r)}if(l=(o&n.childLanes)!==0,kr||l){if(r=In,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Hs(n,i),ki(r,n,i,-1))}return ww(),r=nv(Error(ee(421))),Up(n,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=LN.bind(null,n),i._reactRetry=e,null):(n=s.treeContext,Fr=Vo(i.nextSibling),Ur=e,kt=!0,Si=null,n!==null&&(Zr[ei++]=Ds,Zr[ei++]=bs,Zr[ei++]=nl,Ds=n.id,bs=n.overflow,nl=e),e=pw(e,r.children),e.flags|=4096,e)}function zT(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),p1(n.return,e,t)}function rv(n,e,t,r,i){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=t,s.tailMode=i)}function V6(n,e,t){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(dr(n,e,r.children,t),r=Dt.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&zT(n,t,e);else if(n.tag===19)zT(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(Et(Dt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&Gg(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),rv(e,!1,i,t,s);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&Gg(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}rv(e,!0,t,null,s);break;case"together":rv(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function cg(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function $s(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),il|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(ee(153));if(e.child!==null){for(n=e.child,t=jo(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=jo(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function CN(n,e,t){switch(e.tag){case 3:L6(e),Bu();break;case 5:c6(e);break;case 1:Nr(e.type)&&Fg(e);break;case 4:ow(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Et(Bg,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Et(Dt,Dt.current&1),e.flags|=128,null):t&e.child.childLanes?F6(n,e,t):(Et(Dt,Dt.current&1),n=$s(n,e,t),n!==null?n.sibling:null);Et(Dt,Dt.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return V6(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Et(Dt,Dt.current),r)break;return null;case 22:case 23:return e.lanes=0,O6(n,e,t)}return $s(n,e,t)}var U6,S1,B6,z6;U6=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};S1=function(){};B6=function(n,e,t,r){var i=n.memoizedProps;if(i!==r){n=e.stateNode,qa(es.current);var s=null;switch(t){case"input":i=Wv(n,i),r=Wv(n,r),s=[];break;case"select":i=Mt({},i,{value:void 0}),r=Mt({},r,{value:void 0}),s=[];break;case"textarea":i=qv(n,i),r=qv(n,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=Mg)}Qv(t,r);var o;t=null;for(d in i)if(!r.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var l=i[d];for(o in l)l.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(sd.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in r){var c=r[d];if(l=i!=null?i[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(t||(t={}),t[o]=c[o])}else t||(s||(s=[]),s.push(d,t)),t=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(sd.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Tt("scroll",n),s||l===c||(s=[])):(s=s||[]).push(d,c))}t&&(s=s||[]).push("style",t);var d=s;(e.updateQueue=d)&&(e.flags|=4)}};z6=function(n,e,t,r){t!==r&&(e.flags|=4)};function mh(n,e){if(!kt)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function Yn(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function IN(n,e,t){var r=e.pendingProps;switch(Z2(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yn(e),null;case 1:return Nr(e.type)&&Lg(),Yn(e),null;case 3:return r=e.stateNode,ju(),It(Ar),It(rr),lw(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(Fp(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Si!==null&&(A1(Si),Si=null))),S1(n,e),Yn(e),null;case 5:aw(e);var i=qa(_d.current);if(t=e.type,n!==null&&e.stateNode!=null)B6(n,e,t,r,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ee(166));return Yn(e),null}if(n=qa(es.current),Fp(e)){r=e.stateNode,t=e.type;var s=e.memoizedProps;switch(r[Xi]=e,r[gd]=s,n=(e.mode&1)!==0,t){case"dialog":Tt("cancel",r),Tt("close",r);break;case"iframe":case"object":case"embed":Tt("load",r);break;case"video":case"audio":for(i=0;i<Ah.length;i++)Tt(Ah[i],r);break;case"source":Tt("error",r);break;case"img":case"image":case"link":Tt("error",r),Tt("load",r);break;case"details":Tt("toggle",r);break;case"input":Y4(r,s),Tt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Tt("invalid",r);break;case"textarea":J4(r,s),Tt("invalid",r)}Qv(t,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&Lp(r.textContent,l,n),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&Lp(r.textContent,l,n),i=["children",""+l]):sd.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Tt("scroll",r)}switch(t){case"input":Rp(r),X4(r,s,!0);break;case"textarea":Rp(r),Z4(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Mg)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=gI(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=o.createElement(t,{is:r.is}):(n=o.createElement(t),t==="select"&&(o=n,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):n=o.createElementNS(n,t),n[Xi]=e,n[gd]=r,U6(n,e,!1,!1),e.stateNode=n;e:{switch(o=Yv(t,r),t){case"dialog":Tt("cancel",n),Tt("close",n),i=r;break;case"iframe":case"object":case"embed":Tt("load",n),i=r;break;case"video":case"audio":for(i=0;i<Ah.length;i++)Tt(Ah[i],n);i=r;break;case"source":Tt("error",n),i=r;break;case"img":case"image":case"link":Tt("error",n),Tt("load",n),i=r;break;case"details":Tt("toggle",n),i=r;break;case"input":Y4(n,r),i=Wv(n,r),Tt("invalid",n);break;case"option":i=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},i=Mt({},r,{value:void 0}),Tt("invalid",n);break;case"textarea":J4(n,r),i=qv(n,r),Tt("invalid",n);break;default:i=r}Qv(t,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?yI(n,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&mI(n,c)):s==="children"?typeof c=="string"?(t!=="textarea"||c!=="")&&od(n,c):typeof c=="number"&&od(n,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(sd.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Tt("scroll",n):c!=null&&V2(n,s,c,o))}switch(t){case"input":Rp(n),X4(n,r,!1);break;case"textarea":Rp(n),Z4(n);break;case"option":r.value!=null&&n.setAttribute("value",""+Qo(r.value));break;case"select":n.multiple=!!r.multiple,s=r.value,s!=null?Iu(n,!!r.multiple,s,!1):r.defaultValue!=null&&Iu(n,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=Mg)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Yn(e),null;case 6:if(n&&e.stateNode!=null)z6(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ee(166));if(t=qa(_d.current),qa(es.current),Fp(e)){if(r=e.stateNode,t=e.memoizedProps,r[Xi]=e,(s=r.nodeValue!==t)&&(n=Ur,n!==null))switch(n.tag){case 3:Lp(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Lp(r.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[Xi]=e,e.stateNode=r}return Yn(e),null;case 13:if(It(Dt),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(kt&&Fr!==null&&e.mode&1&&!(e.flags&128))s6(),Bu(),e.flags|=98560,s=!1;else if(s=Fp(e),r!==null&&r.dehydrated!==null){if(n===null){if(!s)throw Error(ee(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ee(317));s[Xi]=e}else Bu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Yn(e),s=!1}else Si!==null&&(A1(Si),Si=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||Dt.current&1?ln===0&&(ln=3):ww())),e.updateQueue!==null&&(e.flags|=4),Yn(e),null);case 4:return ju(),S1(n,e),n===null&&fd(e.stateNode.containerInfo),Yn(e),null;case 10:return rw(e.type._context),Yn(e),null;case 17:return Nr(e.type)&&Lg(),Yn(e),null;case 19:if(It(Dt),s=e.memoizedState,s===null)return Yn(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)mh(s,!1);else{if(ln!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=Gg(n),o!==null){for(e.flags|=128,mh(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)s=t,n=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,n=o.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Et(Dt,Dt.current&1|2),e.child}n=n.sibling}s.tail!==null&&Gt()>Wu&&(e.flags|=128,r=!0,mh(s,!1),e.lanes=4194304)}else{if(!r)if(n=Gg(o),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),mh(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!kt)return Yn(e),null}else 2*Gt()-s.renderingStartTime>Wu&&t!==1073741824&&(e.flags|=128,r=!0,mh(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(t=s.last,t!==null?t.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Gt(),e.sibling=null,t=Dt.current,Et(Dt,r?t&1|2:t&1),e):(Yn(e),null);case 22:case 23:return vw(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Lr&1073741824&&(Yn(e),e.subtreeFlags&6&&(e.flags|=8192)):Yn(e),null;case 24:return null;case 25:return null}throw Error(ee(156,e.tag))}function PN(n,e){switch(Z2(e),e.tag){case 1:return Nr(e.type)&&Lg(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return ju(),It(Ar),It(rr),lw(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return aw(e),null;case 13:if(It(Dt),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(ee(340));Bu()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return It(Dt),null;case 4:return ju(),null;case 10:return rw(e.type._context),null;case 22:case 23:return vw(),null;case 24:return null;default:return null}}var Bp=!1,Zn=!1,kN=typeof WeakSet=="function"?WeakSet:Set,de=null;function Eu(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){Ft(n,e,r)}else t.current=null}function T1(n,e,t){try{t()}catch(r){Ft(n,e,r)}}var jT=!1;function RN(n,e){if(o1=Dg,n=$I(),X2(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,l=-1,c=-1,d=0,p=0,_=n,m=null;t:for(;;){for(var E;_!==t||i!==0&&_.nodeType!==3||(l=o+i),_!==s||r!==0&&_.nodeType!==3||(c=o+r),_.nodeType===3&&(o+=_.nodeValue.length),(E=_.firstChild)!==null;)m=_,_=E;for(;;){if(_===n)break t;if(m===t&&++d===i&&(l=o),m===s&&++p===r&&(c=o),(E=_.nextSibling)!==null)break;_=m,m=_.parentNode}_=E}t=l===-1||c===-1?null:{start:l,end:c}}else t=null}t=t||{start:0,end:0}}else t=null;for(a1={focusedElem:n,selectionRange:t},Dg=!1,de=e;de!==null;)if(e=de,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,de=n;else for(;de!==null;){e=de;try{var S=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(S!==null){var k=S.memoizedProps,N=S.memoizedState,x=e.stateNode,R=x.getSnapshotBeforeUpdate(e.elementType===e.type?k:wi(e.type,k),N);x.__reactInternalSnapshotBeforeUpdate=R}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ee(163))}}catch(P){Ft(e,e.return,P)}if(n=e.sibling,n!==null){n.return=e.return,de=n;break}de=e.return}return S=jT,jT=!1,S}function Hh(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&n)===n){var s=i.destroy;i.destroy=void 0,s!==void 0&&T1(e,t,s)}i=i.next}while(i!==r)}}function Km(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function C1(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function j6(n){var e=n.alternate;e!==null&&(n.alternate=null,j6(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Xi],delete e[gd],delete e[c1],delete e[cN],delete e[hN])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function G6(n){return n.tag===5||n.tag===3||n.tag===4}function GT(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||G6(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function I1(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Mg));else if(r!==4&&(n=n.child,n!==null))for(I1(n,e,t),n=n.sibling;n!==null;)I1(n,e,t),n=n.sibling}function P1(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(P1(n,e,t),n=n.sibling;n!==null;)P1(n,e,t),n=n.sibling}var On=null,Ei=!1;function Eo(n,e,t){for(t=t.child;t!==null;)W6(n,e,t),t=t.sibling}function W6(n,e,t){if(Zi&&typeof Zi.onCommitFiberUnmount=="function")try{Zi.onCommitFiberUnmount(Bm,t)}catch{}switch(t.tag){case 5:Zn||Eu(t,e);case 6:var r=On,i=Ei;On=null,Eo(n,e,t),On=r,Ei=i,On!==null&&(Ei?(n=On,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):On.removeChild(t.stateNode));break;case 18:On!==null&&(Ei?(n=On,t=t.stateNode,n.nodeType===8?Yy(n.parentNode,t):n.nodeType===1&&Yy(n,t),cd(n)):Yy(On,t.stateNode));break;case 4:r=On,i=Ei,On=t.stateNode.containerInfo,Ei=!0,Eo(n,e,t),On=r,Ei=i;break;case 0:case 11:case 14:case 15:if(!Zn&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&T1(t,e,o),i=i.next}while(i!==r)}Eo(n,e,t);break;case 1:if(!Zn&&(Eu(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(l){Ft(t,e,l)}Eo(n,e,t);break;case 21:Eo(n,e,t);break;case 22:t.mode&1?(Zn=(r=Zn)||t.memoizedState!==null,Eo(n,e,t),Zn=r):Eo(n,e,t);break;default:Eo(n,e,t)}}function WT(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new kN),e.forEach(function(r){var i=FN.bind(null,n,r);t.has(r)||(t.add(r),r.then(i,i))})}}function yi(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];try{var s=n,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:On=l.stateNode,Ei=!1;break e;case 3:On=l.stateNode.containerInfo,Ei=!0;break e;case 4:On=l.stateNode.containerInfo,Ei=!0;break e}l=l.return}if(On===null)throw Error(ee(160));W6(s,o,i),On=null,Ei=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(d){Ft(i,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)H6(e,n),e=e.sibling}function H6(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(yi(e,n),Qi(n),r&4){try{Hh(3,n,n.return),Km(3,n)}catch(k){Ft(n,n.return,k)}try{Hh(5,n,n.return)}catch(k){Ft(n,n.return,k)}}break;case 1:yi(e,n),Qi(n),r&512&&t!==null&&Eu(t,t.return);break;case 5:if(yi(e,n),Qi(n),r&512&&t!==null&&Eu(t,t.return),n.flags&32){var i=n.stateNode;try{od(i,"")}catch(k){Ft(n,n.return,k)}}if(r&4&&(i=n.stateNode,i!=null)){var s=n.memoizedProps,o=t!==null?t.memoizedProps:s,l=n.type,c=n.updateQueue;if(n.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&fI(i,s),Yv(l,o);var d=Yv(l,s);for(o=0;o<c.length;o+=2){var p=c[o],_=c[o+1];p==="style"?yI(i,_):p==="dangerouslySetInnerHTML"?mI(i,_):p==="children"?od(i,_):V2(i,p,_,d)}switch(l){case"input":Hv(i,s);break;case"textarea":pI(i,s);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var E=s.value;E!=null?Iu(i,!!s.multiple,E,!1):m!==!!s.multiple&&(s.defaultValue!=null?Iu(i,!!s.multiple,s.defaultValue,!0):Iu(i,!!s.multiple,s.multiple?[]:"",!1))}i[gd]=s}catch(k){Ft(n,n.return,k)}}break;case 6:if(yi(e,n),Qi(n),r&4){if(n.stateNode===null)throw Error(ee(162));i=n.stateNode,s=n.memoizedProps;try{i.nodeValue=s}catch(k){Ft(n,n.return,k)}}break;case 3:if(yi(e,n),Qi(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{cd(e.containerInfo)}catch(k){Ft(n,n.return,k)}break;case 4:yi(e,n),Qi(n);break;case 13:yi(e,n),Qi(n),i=n.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(_w=Gt())),r&4&&WT(n);break;case 22:if(p=t!==null&&t.memoizedState!==null,n.mode&1?(Zn=(d=Zn)||p,yi(e,n),Zn=d):yi(e,n),Qi(n),r&8192){if(d=n.memoizedState!==null,(n.stateNode.isHidden=d)&&!p&&n.mode&1)for(de=n,p=n.child;p!==null;){for(_=de=p;de!==null;){switch(m=de,E=m.child,m.tag){case 0:case 11:case 14:case 15:Hh(4,m,m.return);break;case 1:Eu(m,m.return);var S=m.stateNode;if(typeof S.componentWillUnmount=="function"){r=m,t=m.return;try{e=r,S.props=e.memoizedProps,S.state=e.memoizedState,S.componentWillUnmount()}catch(k){Ft(r,t,k)}}break;case 5:Eu(m,m.return);break;case 22:if(m.memoizedState!==null){$T(_);continue}}E!==null?(E.return=m,de=E):$T(_)}p=p.sibling}e:for(p=null,_=n;;){if(_.tag===5){if(p===null){p=_;try{i=_.stateNode,d?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=_.stateNode,c=_.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=_I("display",o))}catch(k){Ft(n,n.return,k)}}}else if(_.tag===6){if(p===null)try{_.stateNode.nodeValue=d?"":_.memoizedProps}catch(k){Ft(n,n.return,k)}}else if((_.tag!==22&&_.tag!==23||_.memoizedState===null||_===n)&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===n)break e;for(;_.sibling===null;){if(_.return===null||_.return===n)break e;p===_&&(p=null),_=_.return}p===_&&(p=null),_.sibling.return=_.return,_=_.sibling}}break;case 19:yi(e,n),Qi(n),r&4&&WT(n);break;case 21:break;default:yi(e,n),Qi(n)}}function Qi(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(G6(t)){var r=t;break e}t=t.return}throw Error(ee(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(od(i,""),r.flags&=-33);var s=GT(n);P1(n,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,l=GT(n);I1(n,l,o);break;default:throw Error(ee(161))}}catch(c){Ft(n,n.return,c)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function xN(n,e,t){de=n,$6(n)}function $6(n,e,t){for(var r=(n.mode&1)!==0;de!==null;){var i=de,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Bp;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||Zn;l=Bp;var d=Zn;if(Bp=o,(Zn=c)&&!d)for(de=i;de!==null;)o=de,c=o.child,o.tag===22&&o.memoizedState!==null?qT(i):c!==null?(c.return=o,de=c):qT(i);for(;s!==null;)de=s,$6(s),s=s.sibling;de=i,Bp=l,Zn=d}HT(n)}else i.subtreeFlags&8772&&s!==null?(s.return=i,de=s):HT(n)}}function HT(n){for(;de!==null;){var e=de;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Zn||Km(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Zn)if(t===null)r.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:wi(e.type,t.memoizedProps);r.componentDidUpdate(i,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&xT(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}xT(e,o,t)}break;case 5:var l=e.stateNode;if(t===null&&e.flags&4){t=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&t.focus();break;case"img":c.src&&(t.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var p=d.memoizedState;if(p!==null){var _=p.dehydrated;_!==null&&cd(_)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ee(163))}Zn||e.flags&512&&C1(e)}catch(m){Ft(e,e.return,m)}}if(e===n){de=null;break}if(t=e.sibling,t!==null){t.return=e.return,de=t;break}de=e.return}}function $T(n){for(;de!==null;){var e=de;if(e===n){de=null;break}var t=e.sibling;if(t!==null){t.return=e.return,de=t;break}de=e.return}}function qT(n){for(;de!==null;){var e=de;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Km(4,e)}catch(c){Ft(e,t,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(c){Ft(e,i,c)}}var s=e.return;try{C1(e)}catch(c){Ft(e,s,c)}break;case 5:var o=e.return;try{C1(e)}catch(c){Ft(e,o,c)}}}catch(c){Ft(e,e.return,c)}if(e===n){de=null;break}var l=e.sibling;if(l!==null){l.return=e.return,de=l;break}de=e.return}}var AN=Math.ceil,$g=Zs.ReactCurrentDispatcher,gw=Zs.ReactCurrentOwner,ri=Zs.ReactCurrentBatchConfig,Je=0,In=null,Xt=null,Fn=0,Lr=0,Su=oa(0),ln=0,Ed=null,il=0,Qm=0,mw=0,$h=null,Pr=null,_w=0,Wu=1/0,ks=null,qg=!1,k1=null,Bo=null,zp=!1,bo=null,Kg=0,qh=0,R1=null,hg=-1,dg=0;function pr(){return Je&6?Gt():hg!==-1?hg:hg=Gt()}function zo(n){return n.mode&1?Je&2&&Fn!==0?Fn&-Fn:fN.transition!==null?(dg===0&&(dg=AI()),dg):(n=ut,n!==0||(n=window.event,n=n===void 0?16:FI(n.type)),n):1}function ki(n,e,t,r){if(50<qh)throw qh=0,R1=null,Error(ee(185));qd(n,t,r),(!(Je&2)||n!==In)&&(n===In&&(!(Je&2)&&(Qm|=t),ln===4&&Ro(n,Fn)),Dr(n,r),t===1&&Je===0&&!(e.mode&1)&&(Wu=Gt()+500,Hm&&aa()))}function Dr(n,e){var t=n.callbackNode;f8(n,e);var r=Ng(n,n===In?Fn:0);if(r===0)t!==null&&nT(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&nT(t),e===1)n.tag===0?dN(KT.bind(null,n)):n6(KT.bind(null,n)),lN(function(){!(Je&6)&&aa()}),t=null;else{switch(NI(r)){case 1:t=G2;break;case 4:t=RI;break;case 16:t=Ag;break;case 536870912:t=xI;break;default:t=Ag}t=eP(t,q6.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function q6(n,e){if(hg=-1,dg=0,Je&6)throw Error(ee(327));var t=n.callbackNode;if(Au()&&n.callbackNode!==t)return null;var r=Ng(n,n===In?Fn:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=Qg(n,r);else{e=r;var i=Je;Je|=2;var s=Q6();(In!==n||Fn!==e)&&(ks=null,Wu=Gt()+500,Ja(n,e));do try{bN();break}catch(l){K6(n,l)}while(!0);nw(),$g.current=s,Je=i,Xt!==null?e=0:(In=null,Fn=0,e=ln)}if(e!==0){if(e===2&&(i=t1(n),i!==0&&(r=i,e=x1(n,i))),e===1)throw t=Ed,Ja(n,0),Ro(n,r),Dr(n,Gt()),t;if(e===6)Ro(n,r);else{if(i=n.current.alternate,!(r&30)&&!NN(i)&&(e=Qg(n,r),e===2&&(s=t1(n),s!==0&&(r=s,e=x1(n,s))),e===1))throw t=Ed,Ja(n,0),Ro(n,r),Dr(n,Gt()),t;switch(n.finishedWork=i,n.finishedLanes=r,e){case 0:case 1:throw Error(ee(345));case 2:za(n,Pr,ks);break;case 3:if(Ro(n,r),(r&130023424)===r&&(e=_w+500-Gt(),10<e)){if(Ng(n,0)!==0)break;if(i=n.suspendedLanes,(i&r)!==r){pr(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=u1(za.bind(null,n,Pr,ks),e);break}za(n,Pr,ks);break;case 4:if(Ro(n,r),(r&4194240)===r)break;for(e=n.eventTimes,i=-1;0<r;){var o=31-Pi(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Gt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*AN(r/1960))-r,10<r){n.timeoutHandle=u1(za.bind(null,n,Pr,ks),r);break}za(n,Pr,ks);break;case 5:za(n,Pr,ks);break;default:throw Error(ee(329))}}}return Dr(n,Gt()),n.callbackNode===t?q6.bind(null,n):null}function x1(n,e){var t=$h;return n.current.memoizedState.isDehydrated&&(Ja(n,e).flags|=256),n=Qg(n,e),n!==2&&(e=Pr,Pr=t,e!==null&&A1(e)),n}function A1(n){Pr===null?Pr=n:Pr.push.apply(Pr,n)}function NN(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var i=t[r],s=i.getSnapshot;i=i.value;try{if(!Ni(s(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ro(n,e){for(e&=~mw,e&=~Qm,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Pi(e),r=1<<t;n[t]=-1,e&=~r}}function KT(n){if(Je&6)throw Error(ee(327));Au();var e=Ng(n,0);if(!(e&1))return Dr(n,Gt()),null;var t=Qg(n,e);if(n.tag!==0&&t===2){var r=t1(n);r!==0&&(e=r,t=x1(n,r))}if(t===1)throw t=Ed,Ja(n,0),Ro(n,e),Dr(n,Gt()),t;if(t===6)throw Error(ee(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,za(n,Pr,ks),Dr(n,Gt()),null}function yw(n,e){var t=Je;Je|=1;try{return n(e)}finally{Je=t,Je===0&&(Wu=Gt()+500,Hm&&aa())}}function sl(n){bo!==null&&bo.tag===0&&!(Je&6)&&Au();var e=Je;Je|=1;var t=ri.transition,r=ut;try{if(ri.transition=null,ut=1,n)return n()}finally{ut=r,ri.transition=t,Je=e,!(Je&6)&&aa()}}function vw(){Lr=Su.current,It(Su)}function Ja(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,aN(t)),Xt!==null)for(t=Xt.return;t!==null;){var r=t;switch(Z2(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Lg();break;case 3:ju(),It(Ar),It(rr),lw();break;case 5:aw(r);break;case 4:ju();break;case 13:It(Dt);break;case 19:It(Dt);break;case 10:rw(r.type._context);break;case 22:case 23:vw()}t=t.return}if(In=n,Xt=n=jo(n.current,null),Fn=Lr=e,ln=0,Ed=null,mw=Qm=il=0,Pr=$h=null,$a!==null){for(e=0;e<$a.length;e++)if(t=$a[e],r=t.interleaved,r!==null){t.interleaved=null;var i=r.next,s=t.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}t.pending=r}$a=null}return n}function K6(n,e){do{var t=Xt;try{if(nw(),lg.current=Hg,Wg){for(var r=Ot.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Wg=!1}if(rl=0,En=an=Ot=null,Wh=!1,yd=0,gw.current=null,t===null||t.return===null){ln=1,Ed=e,Xt=null;break}e:{var s=n,o=t.return,l=t,c=e;if(e=Fn,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,p=l,_=p.tag;if(!(p.mode&1)&&(_===0||_===11||_===15)){var m=p.alternate;m?(p.updateQueue=m.updateQueue,p.memoizedState=m.memoizedState,p.lanes=m.lanes):(p.updateQueue=null,p.memoizedState=null)}var E=MT(o);if(E!==null){E.flags&=-257,LT(E,o,l,s,e),E.mode&1&&OT(s,d,e),e=E,c=d;var S=e.updateQueue;if(S===null){var k=new Set;k.add(c),e.updateQueue=k}else S.add(c);break e}else{if(!(e&1)){OT(s,d,e),ww();break e}c=Error(ee(426))}}else if(kt&&l.mode&1){var N=MT(o);if(N!==null){!(N.flags&65536)&&(N.flags|=256),LT(N,o,l,s,e),ew(Gu(c,l));break e}}s=c=Gu(c,l),ln!==4&&(ln=2),$h===null?$h=[s]:$h.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var x=N6(s,c,e);RT(s,x);break e;case 1:l=c;var R=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof R.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Bo===null||!Bo.has(w)))){s.flags|=65536,e&=-e,s.lanes|=e;var P=D6(s,l,e);RT(s,P);break e}}s=s.return}while(s!==null)}X6(t)}catch(F){e=F,Xt===t&&t!==null&&(Xt=t=t.return);continue}break}while(!0)}function Q6(){var n=$g.current;return $g.current=Hg,n===null?Hg:n}function ww(){(ln===0||ln===3||ln===2)&&(ln=4),In===null||!(il&268435455)&&!(Qm&268435455)||Ro(In,Fn)}function Qg(n,e){var t=Je;Je|=2;var r=Q6();(In!==n||Fn!==e)&&(ks=null,Ja(n,e));do try{DN();break}catch(i){K6(n,i)}while(!0);if(nw(),Je=t,$g.current=r,Xt!==null)throw Error(ee(261));return In=null,Fn=0,ln}function DN(){for(;Xt!==null;)Y6(Xt)}function bN(){for(;Xt!==null&&!i8();)Y6(Xt)}function Y6(n){var e=Z6(n.alternate,n,Lr);n.memoizedProps=n.pendingProps,e===null?X6(n):Xt=e,gw.current=null}function X6(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=PN(t,e),t!==null){t.flags&=32767,Xt=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{ln=6,Xt=null;return}}else if(t=IN(t,e,Lr),t!==null){Xt=t;return}if(e=e.sibling,e!==null){Xt=e;return}Xt=e=n}while(e!==null);ln===0&&(ln=5)}function za(n,e,t){var r=ut,i=ri.transition;try{ri.transition=null,ut=1,ON(n,e,t,r)}finally{ri.transition=i,ut=r}return null}function ON(n,e,t,r){do Au();while(bo!==null);if(Je&6)throw Error(ee(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(ee(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(p8(n,s),n===In&&(Xt=In=null,Fn=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||zp||(zp=!0,eP(Ag,function(){return Au(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=ri.transition,ri.transition=null;var o=ut;ut=1;var l=Je;Je|=4,gw.current=null,RN(n,t),H6(t,n),eN(a1),Dg=!!o1,a1=o1=null,n.current=t,xN(t),s8(),Je=l,ut=o,ri.transition=s}else n.current=t;if(zp&&(zp=!1,bo=n,Kg=i),s=n.pendingLanes,s===0&&(Bo=null),l8(t.stateNode),Dr(n,Gt()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],r(i.value,{componentStack:i.stack,digest:i.digest});if(qg)throw qg=!1,n=k1,k1=null,n;return Kg&1&&n.tag!==0&&Au(),s=n.pendingLanes,s&1?n===R1?qh++:(qh=0,R1=n):qh=0,aa(),null}function Au(){if(bo!==null){var n=NI(Kg),e=ri.transition,t=ut;try{if(ri.transition=null,ut=16>n?16:n,bo===null)var r=!1;else{if(n=bo,bo=null,Kg=0,Je&6)throw Error(ee(331));var i=Je;for(Je|=4,de=n.current;de!==null;){var s=de,o=s.child;if(de.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(de=d;de!==null;){var p=de;switch(p.tag){case 0:case 11:case 15:Hh(8,p,s)}var _=p.child;if(_!==null)_.return=p,de=_;else for(;de!==null;){p=de;var m=p.sibling,E=p.return;if(j6(p),p===d){de=null;break}if(m!==null){m.return=E,de=m;break}de=E}}}var S=s.alternate;if(S!==null){var k=S.child;if(k!==null){S.child=null;do{var N=k.sibling;k.sibling=null,k=N}while(k!==null)}}de=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,de=o;else e:for(;de!==null;){if(s=de,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Hh(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,de=x;break e}de=s.return}}var R=n.current;for(de=R;de!==null;){o=de;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,de=w;else e:for(o=R;de!==null;){if(l=de,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Km(9,l)}}catch(F){Ft(l,l.return,F)}if(l===o){de=null;break e}var P=l.sibling;if(P!==null){P.return=l.return,de=P;break e}de=l.return}}if(Je=i,aa(),Zi&&typeof Zi.onPostCommitFiberRoot=="function")try{Zi.onPostCommitFiberRoot(Bm,n)}catch{}r=!0}return r}finally{ut=t,ri.transition=e}}return!1}function QT(n,e,t){e=Gu(t,e),e=N6(n,e,1),n=Uo(n,e,1),e=pr(),n!==null&&(qd(n,1,e),Dr(n,e))}function Ft(n,e,t){if(n.tag===3)QT(n,n,t);else for(;e!==null;){if(e.tag===3){QT(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Bo===null||!Bo.has(r))){n=Gu(t,n),n=D6(e,n,1),e=Uo(e,n,1),n=pr(),e!==null&&(qd(e,1,n),Dr(e,n));break}}e=e.return}}function MN(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=pr(),n.pingedLanes|=n.suspendedLanes&t,In===n&&(Fn&t)===t&&(ln===4||ln===3&&(Fn&130023424)===Fn&&500>Gt()-_w?Ja(n,0):mw|=t),Dr(n,e)}function J6(n,e){e===0&&(n.mode&1?(e=Np,Np<<=1,!(Np&130023424)&&(Np=4194304)):e=1);var t=pr();n=Hs(n,e),n!==null&&(qd(n,e,t),Dr(n,t))}function LN(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),J6(n,t)}function FN(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(ee(314))}r!==null&&r.delete(e),J6(n,t)}var Z6;Z6=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Ar.current)kr=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return kr=!1,CN(n,e,t);kr=!!(n.flags&131072)}else kr=!1,kt&&e.flags&1048576&&r6(e,Ug,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;cg(n,e),n=e.pendingProps;var i=Uu(e,rr.current);xu(e,t),i=cw(null,e,r,n,i,t);var s=hw();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Nr(r)?(s=!0,Fg(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,sw(e),i.updater=qm,e.stateNode=i,i._reactInternals=e,m1(e,r,n,t),e=v1(null,e,r,!0,s,t)):(e.tag=0,kt&&s&&J2(e),dr(null,e,i,t),e=e.child),e;case 16:r=e.elementType;e:{switch(cg(n,e),n=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=UN(r),n=wi(r,n),i){case 0:e=y1(null,e,r,n,t);break e;case 1:e=UT(null,e,r,n,t);break e;case 11:e=FT(null,e,r,n,t);break e;case 14:e=VT(null,e,r,wi(r.type,n),t);break e}throw Error(ee(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:wi(r,i),y1(n,e,r,i,t);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:wi(r,i),UT(n,e,r,i,t);case 3:e:{if(L6(e),n===null)throw Error(ee(387));r=e.pendingProps,s=e.memoizedState,i=s.element,u6(n,e),jg(e,r,null,t);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Gu(Error(ee(423)),e),e=BT(n,e,r,t,i);break e}else if(r!==i){i=Gu(Error(ee(424)),e),e=BT(n,e,r,t,i);break e}else for(Fr=Vo(e.stateNode.containerInfo.firstChild),Ur=e,kt=!0,Si=null,t=a6(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Bu(),r===i){e=$s(n,e,t);break e}dr(n,e,r,t)}e=e.child}return e;case 5:return c6(e),n===null&&f1(e),r=e.type,i=e.pendingProps,s=n!==null?n.memoizedProps:null,o=i.children,l1(r,i)?o=null:s!==null&&l1(r,s)&&(e.flags|=32),M6(n,e),dr(n,e,o,t),e.child;case 6:return n===null&&f1(e),null;case 13:return F6(n,e,t);case 4:return ow(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=zu(e,null,r,t):dr(n,e,r,t),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:wi(r,i),FT(n,e,r,i,t);case 7:return dr(n,e,e.pendingProps,t),e.child;case 8:return dr(n,e,e.pendingProps.children,t),e.child;case 12:return dr(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Et(Bg,r._currentValue),r._currentValue=o,s!==null)if(Ni(s.value,o)){if(s.children===i.children&&!Ar.current){e=$s(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(s.tag===1){c=Vs(-1,t&-t),c.tag=2;var d=s.updateQueue;if(d!==null){d=d.shared;var p=d.pending;p===null?c.next=c:(c.next=p.next,p.next=c),d.pending=c}}s.lanes|=t,c=s.alternate,c!==null&&(c.lanes|=t),p1(s.return,t,e),l.lanes|=t;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(ee(341));o.lanes|=t,l=o.alternate,l!==null&&(l.lanes|=t),p1(o,t,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}dr(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,xu(e,t),i=si(i),r=r(i),e.flags|=1,dr(n,e,r,t),e.child;case 14:return r=e.type,i=wi(r,e.pendingProps),i=wi(r.type,i),VT(n,e,r,i,t);case 15:return b6(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:wi(r,i),cg(n,e),e.tag=1,Nr(r)?(n=!0,Fg(e)):n=!1,xu(e,t),A6(e,r,i),m1(e,r,i,t),v1(null,e,r,!0,n,t);case 19:return V6(n,e,t);case 22:return O6(n,e,t)}throw Error(ee(156,e.tag))};function eP(n,e){return kI(n,e)}function VN(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ti(n,e,t,r){return new VN(n,e,t,r)}function Ew(n){return n=n.prototype,!(!n||!n.isReactComponent)}function UN(n){if(typeof n=="function")return Ew(n)?1:0;if(n!=null){if(n=n.$$typeof,n===B2)return 11;if(n===z2)return 14}return 2}function jo(n,e){var t=n.alternate;return t===null?(t=ti(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function fg(n,e,t,r,i,s){var o=2;if(r=n,typeof n=="function")Ew(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case du:return Za(t.children,i,s,e);case U2:o=8,i|=8;break;case Bv:return n=ti(12,t,e,i|2),n.elementType=Bv,n.lanes=s,n;case zv:return n=ti(13,t,e,i),n.elementType=zv,n.lanes=s,n;case jv:return n=ti(19,t,e,i),n.elementType=jv,n.lanes=s,n;case cI:return Ym(t,i,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case lI:o=10;break e;case uI:o=9;break e;case B2:o=11;break e;case z2:o=14;break e;case Io:o=16,r=null;break e}throw Error(ee(130,n==null?n:typeof n,""))}return e=ti(o,t,e,i),e.elementType=n,e.type=r,e.lanes=s,e}function Za(n,e,t,r){return n=ti(7,n,r,e),n.lanes=t,n}function Ym(n,e,t,r){return n=ti(22,n,r,e),n.elementType=cI,n.lanes=t,n.stateNode={isHidden:!1},n}function iv(n,e,t){return n=ti(6,n,null,e),n.lanes=t,n}function sv(n,e,t){return e=ti(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function BN(n,e,t,r,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Uy(0),this.expirationTimes=Uy(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Uy(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Sw(n,e,t,r,i,s,o,l,c){return n=new BN(n,e,t,l,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=ti(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},sw(s),n}function zN(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:hu,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function tP(n){if(!n)return Yo;n=n._reactInternals;e:{if(yl(n)!==n||n.tag!==1)throw Error(ee(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Nr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ee(171))}if(n.tag===1){var t=n.type;if(Nr(t))return t6(n,t,e)}return e}function nP(n,e,t,r,i,s,o,l,c){return n=Sw(t,r,!0,n,i,s,o,l,c),n.context=tP(null),t=n.current,r=pr(),i=zo(t),s=Vs(r,i),s.callback=e??null,Uo(t,s,i),n.current.lanes=i,qd(n,i,r),Dr(n,r),n}function Xm(n,e,t,r){var i=e.current,s=pr(),o=zo(i);return t=tP(t),e.context===null?e.context=t:e.pendingContext=t,e=Vs(s,o),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=Uo(i,e,o),n!==null&&(ki(n,i,o,s),ag(n,i,o)),o}function Yg(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function YT(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function Tw(n,e){YT(n,e),(n=n.alternate)&&YT(n,e)}function jN(){return null}var rP=typeof reportError=="function"?reportError:function(n){console.error(n)};function Cw(n){this._internalRoot=n}Jm.prototype.render=Cw.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(ee(409));Xm(n,e,null,null)};Jm.prototype.unmount=Cw.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;sl(function(){Xm(null,n,null,null)}),e[Ws]=null}};function Jm(n){this._internalRoot=n}Jm.prototype.unstable_scheduleHydration=function(n){if(n){var e=OI();n={blockedOn:null,target:n,priority:e};for(var t=0;t<ko.length&&e!==0&&e<ko[t].priority;t++);ko.splice(t,0,n),t===0&&LI(n)}};function Iw(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Zm(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function XT(){}function GN(n,e,t,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var d=Yg(o);s.call(d)}}var o=nP(e,r,n,0,null,!1,!1,"",XT);return n._reactRootContainer=o,n[Ws]=o.current,fd(n.nodeType===8?n.parentNode:n),sl(),o}for(;i=n.lastChild;)n.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var d=Yg(c);l.call(d)}}var c=Sw(n,0,!1,null,null,!1,!1,"",XT);return n._reactRootContainer=c,n[Ws]=c.current,fd(n.nodeType===8?n.parentNode:n),sl(function(){Xm(e,c,t,r)}),c}function e0(n,e,t,r,i){var s=t._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var c=Yg(o);l.call(c)}}Xm(e,o,n,i)}else o=GN(t,e,n,i,r);return Yg(o)}DI=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=xh(e.pendingLanes);t!==0&&(W2(e,t|1),Dr(e,Gt()),!(Je&6)&&(Wu=Gt()+500,aa()))}break;case 13:sl(function(){var r=Hs(n,1);if(r!==null){var i=pr();ki(r,n,1,i)}}),Tw(n,1)}};H2=function(n){if(n.tag===13){var e=Hs(n,134217728);if(e!==null){var t=pr();ki(e,n,134217728,t)}Tw(n,134217728)}};bI=function(n){if(n.tag===13){var e=zo(n),t=Hs(n,e);if(t!==null){var r=pr();ki(t,n,e,r)}Tw(n,e)}};OI=function(){return ut};MI=function(n,e){var t=ut;try{return ut=n,e()}finally{ut=t}};Jv=function(n,e,t){switch(e){case"input":if(Hv(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var i=Wm(r);if(!i)throw Error(ee(90));dI(r),Hv(r,i)}}}break;case"textarea":pI(n,t);break;case"select":e=t.value,e!=null&&Iu(n,!!t.multiple,e,!1)}};EI=yw;SI=sl;var WN={usingClientEntryPoint:!1,Events:[Qd,mu,Wm,vI,wI,yw]},_h={findFiberByHostInstance:Ha,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},HN={bundleType:_h.bundleType,version:_h.version,rendererPackageName:_h.rendererPackageName,rendererConfig:_h.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Zs.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=II(n),n===null?null:n.stateNode},findFiberByHostInstance:_h.findFiberByHostInstance||jN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var jp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!jp.isDisabled&&jp.supportsFiber)try{Bm=jp.inject(HN),Zi=jp}catch{}}jr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=WN;jr.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Iw(e))throw Error(ee(200));return zN(n,e,null,t)};jr.createRoot=function(n,e){if(!Iw(n))throw Error(ee(299));var t=!1,r="",i=rP;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Sw(n,1,!1,null,null,t,!1,r,i),n[Ws]=e.current,fd(n.nodeType===8?n.parentNode:n),new Cw(e)};jr.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(ee(188)):(n=Object.keys(n).join(","),Error(ee(268,n)));return n=II(e),n=n===null?null:n.stateNode,n};jr.flushSync=function(n){return sl(n)};jr.hydrate=function(n,e,t){if(!Zm(e))throw Error(ee(200));return e0(null,n,e,!0,t)};jr.hydrateRoot=function(n,e,t){if(!Iw(n))throw Error(ee(405));var r=t!=null&&t.hydratedSources||null,i=!1,s="",o=rP;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=nP(e,null,n,1,t??null,i,!1,s,o),n[Ws]=e.current,fd(n),r)for(n=0;n<r.length;n++)t=r[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new Jm(e)};jr.render=function(n,e,t){if(!Zm(e))throw Error(ee(200));return e0(null,n,e,!1,t)};jr.unmountComponentAtNode=function(n){if(!Zm(n))throw Error(ee(40));return n._reactRootContainer?(sl(function(){e0(null,null,n,!1,function(){n._reactRootContainer=null,n[Ws]=null})}),!0):!1};jr.unstable_batchedUpdates=yw;jr.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!Zm(t))throw Error(ee(200));if(n==null||n._reactInternals===void 0)throw Error(ee(38));return e0(n,e,t,!1,r)};jr.version="18.3.1-next-f1338f8080-20240426";function iP(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(iP)}catch(n){console.error(n)}}iP(),iI.exports=jr;var $N=iI.exports,JT=$N;Vv.createRoot=JT.createRoot,Vv.hydrateRoot=JT.hydrateRoot;var ZT={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sP={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ie=function(n,e){if(!n)throw dc(e)},dc=function(n){return new Error("Firebase Database ("+sP.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oP=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},qN=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],o=n[t++],l=n[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Pw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],o=i+1<n.length,l=o?n[i+1]:0,c=i+2<n.length,d=c?n[i+2]:0,p=s>>2,_=(s&3)<<4|l>>4;let m=(l&15)<<2|d>>6,E=d&63;c||(E=64,o||(m=64)),r.push(t[p],t[_],t[m],t[E])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(oP(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):qN(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],l=i<n.length?t[n.charAt(i)]:0;++i;const d=i<n.length?t[n.charAt(i)]:64;++i;const _=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||l==null||d==null||_==null)throw new KN;const m=s<<2|l>>4;if(r.push(m),d!==64){const E=l<<4&240|d>>2;if(r.push(E),_!==64){const S=d<<6&192|_;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class KN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const aP=function(n){const e=oP(n);return Pw.encodeByteArray(e,!0)},Xg=function(n){return aP(n).replace(/\./g,"")},Jg=function(n){try{return Pw.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QN(n){return lP(void 0,n)}function lP(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!YN(t)||(n[t]=lP(n[t],e[t]));return n}function YN(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JN=()=>XN().__FIREBASE_DEFAULTS__,ZN=()=>{if(typeof process>"u"||typeof ZT>"u")return;const n=ZT.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},e7=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Jg(n[1]);return e&&JSON.parse(e)},t0=()=>{try{return JN()||ZN()||e7()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},uP=n=>{var e,t;return(t=(e=t0())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},cP=n=>{const e=uP(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},hP=()=>{var n;return(n=t0())===null||n===void 0?void 0:n.config},dP=n=>{var e;return(e=t0())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fP(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Xg(JSON.stringify(t)),Xg(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ir(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function kw(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ir())}function t7(){var n;const e=(n=t0())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function n7(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function r7(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function pP(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function i7(){const n=ir();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function s7(){return sP.NODE_ADMIN===!0}function o7(){return!t7()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function a7(){try{return typeof indexedDB=="object"}catch{return!1}}function l7(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u7="FirebaseError";class eo extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=u7,Object.setPrototypeOf(this,eo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Xd.prototype.create)}}class Xd{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?c7(s,r):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new eo(i,l,r)}}function c7(n,e){return n.replace(h7,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const h7=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sd(n){return JSON.parse(n)}function Cn(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gP=function(n){let e={},t={},r={},i="";try{const s=n.split(".");e=Sd(Jg(s[0])||""),t=Sd(Jg(s[1])||""),i=s[2],r=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:r,signature:i}},d7=function(n){const e=gP(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},f7=function(n){const e=gP(n).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ss(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Hu(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function Zg(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function em(n,e,t){const r={};for(const i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=e.call(t,n[i],i,n));return r}function tm(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],o=e[i];if(eC(s)&&eC(o)){if(!tm(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function eC(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fc(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Nh(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Dh(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p7{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const r=this.W_;if(typeof e=="string")for(let _=0;_<16;_++)r[_]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let _=0;_<16;_++)r[_]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let _=16;_<80;_++){const m=r[_-3]^r[_-8]^r[_-14]^r[_-16];r[_]=(m<<1|m>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],l=this.chain_[3],c=this.chain_[4],d,p;for(let _=0;_<80;_++){_<40?_<20?(d=l^s&(o^l),p=1518500249):(d=s^o^l,p=1859775393):_<60?(d=s&o|l&(s|o),p=2400959708):(d=s^o^l,p=3395469782);const m=(i<<5|i>>>27)+d+c+p+r[_]&4294967295;c=l,l=o,o=(s<<30|s>>>2)&4294967295,s=i,i=m}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const r=t-this.blockSize;let i=0;const s=this.buf_;let o=this.inbuf_;for(;i<t;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<t;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<t;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=t&255,t/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}}function g7(n,e){const t=new m7(n,e);return t.subscribe.bind(t)}class m7{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");_7(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=ov),i.error===void 0&&(i.error=ov),i.complete===void 0&&(i.complete=ov);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function _7(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function ov(){}function $u(n,e){return`${n} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y7=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);if(i>=55296&&i<=56319){const s=i-55296;r++,ie(r<n.length,"Surrogate pair missing trail surrogate.");const o=n.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):i<65536?(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},n0=function(n){let e=0;for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vt(n){return n&&n._delegate?n._delegate:n}class Xo{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ja="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v7{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new xs;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(E7(e))try{this.getOrInitializeService({instanceIdentifier:ja})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=ja){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ja){return this.instances.has(e)}getOptions(e=ja){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);r===l&&o.resolve(i)}return i}onInit(e,t){var r;const i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:w7(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ja){return this.component?this.component.multipleInstances?e:ja:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function w7(n){return n===ja?void 0:n}function E7(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S7{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new v7(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var We;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(We||(We={}));const T7={debug:We.DEBUG,verbose:We.VERBOSE,info:We.INFO,warn:We.WARN,error:We.ERROR,silent:We.SILENT},C7=We.INFO,I7={[We.DEBUG]:"log",[We.VERBOSE]:"log",[We.INFO]:"info",[We.WARN]:"warn",[We.ERROR]:"error"},P7=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=I7[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class r0{constructor(e){this.name=e,this._logLevel=C7,this._logHandler=P7,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in We))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?T7[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,We.DEBUG,...e),this._logHandler(this,We.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,We.VERBOSE,...e),this._logHandler(this,We.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,We.INFO,...e),this._logHandler(this,We.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,We.WARN,...e),this._logHandler(this,We.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,We.ERROR,...e),this._logHandler(this,We.ERROR,...e)}}const k7=(n,e)=>e.some(t=>n instanceof t);let tC,nC;function R7(){return tC||(tC=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function x7(){return nC||(nC=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const mP=new WeakMap,N1=new WeakMap,_P=new WeakMap,av=new WeakMap,Rw=new WeakMap;function A7(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Go(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&mP.set(t,n)}).catch(()=>{}),Rw.set(e,n),e}function N7(n){if(N1.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});N1.set(n,e)}let D1={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return N1.get(n);if(e==="objectStoreNames")return n.objectStoreNames||_P.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Go(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function D7(n){D1=n(D1)}function b7(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(lv(this),e,...t);return _P.set(r,e.sort?e.sort():[e]),Go(r)}:x7().includes(n)?function(...e){return n.apply(lv(this),e),Go(mP.get(this))}:function(...e){return Go(n.apply(lv(this),e))}}function O7(n){return typeof n=="function"?b7(n):(n instanceof IDBTransaction&&N7(n),k7(n,R7())?new Proxy(n,D1):n)}function Go(n){if(n instanceof IDBRequest)return A7(n);if(av.has(n))return av.get(n);const e=O7(n);return e!==n&&(av.set(n,e),Rw.set(e,n)),e}const lv=n=>Rw.get(n);function M7(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(n,e),l=Go(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Go(o.result),c.oldVersion,c.newVersion,Go(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),l.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const L7=["get","getKey","getAll","getAllKeys","count"],F7=["put","add","delete","clear"],uv=new Map;function rC(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(uv.get(e))return uv.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=F7.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||L7.includes(t)))return;const s=async function(o,...l){const c=this.transaction(o,i?"readwrite":"readonly");let d=c.store;return r&&(d=d.index(l.shift())),(await Promise.all([d[t](...l),i&&c.done]))[0]};return uv.set(e,s),s}D7(n=>({...n,get:(e,t,r)=>rC(e,t)||n.get(e,t,r),has:(e,t)=>!!rC(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V7{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(U7(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function U7(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const b1="@firebase/app",iC="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qs=new r0("@firebase/app"),B7="@firebase/app-compat",z7="@firebase/analytics-compat",j7="@firebase/analytics",G7="@firebase/app-check-compat",W7="@firebase/app-check",H7="@firebase/auth",$7="@firebase/auth-compat",q7="@firebase/database",K7="@firebase/data-connect",Q7="@firebase/database-compat",Y7="@firebase/functions",X7="@firebase/functions-compat",J7="@firebase/installations",Z7="@firebase/installations-compat",eD="@firebase/messaging",tD="@firebase/messaging-compat",nD="@firebase/performance",rD="@firebase/performance-compat",iD="@firebase/remote-config",sD="@firebase/remote-config-compat",oD="@firebase/storage",aD="@firebase/storage-compat",lD="@firebase/firestore",uD="@firebase/vertexai-preview",cD="@firebase/firestore-compat",hD="firebase",dD="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O1="[DEFAULT]",fD={[b1]:"fire-core",[B7]:"fire-core-compat",[j7]:"fire-analytics",[z7]:"fire-analytics-compat",[W7]:"fire-app-check",[G7]:"fire-app-check-compat",[H7]:"fire-auth",[$7]:"fire-auth-compat",[q7]:"fire-rtdb",[K7]:"fire-data-connect",[Q7]:"fire-rtdb-compat",[Y7]:"fire-fn",[X7]:"fire-fn-compat",[J7]:"fire-iid",[Z7]:"fire-iid-compat",[eD]:"fire-fcm",[tD]:"fire-fcm-compat",[nD]:"fire-perf",[rD]:"fire-perf-compat",[iD]:"fire-rc",[sD]:"fire-rc-compat",[oD]:"fire-gcs",[aD]:"fire-gcs-compat",[lD]:"fire-fst",[cD]:"fire-fst-compat",[uD]:"fire-vertex","fire-js":"fire-js",[hD]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nm=new Map,pD=new Map,M1=new Map;function sC(n,e){try{n.container.addComponent(e)}catch(t){qs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ol(n){const e=n.name;if(M1.has(e))return qs.debug(`There were multiple attempts to register component ${e}.`),!1;M1.set(e,n);for(const t of nm.values())sC(t,n);for(const t of pD.values())sC(t,n);return!0}function i0(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ci(n){return n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Wo=new Xd("app","Firebase",gD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mD{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Xo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Wo.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vl=dD;function yP(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:O1,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Wo.create("bad-app-name",{appName:String(i)});if(t||(t=hP()),!t)throw Wo.create("no-options");const s=nm.get(i);if(s){if(tm(t,s.options)&&tm(r,s.config))return s;throw Wo.create("duplicate-app",{appName:i})}const o=new S7(i);for(const c of M1.values())o.addComponent(c);const l=new mD(t,r,o);return nm.set(i,l),l}function xw(n=O1){const e=nm.get(n);if(!e&&n===O1&&hP())return yP();if(!e)throw Wo.create("no-app",{appName:n});return e}function ts(n,e,t){var r;let i=(r=fD[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),qs.warn(l.join(" "));return}ol(new Xo(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _D="firebase-heartbeat-database",yD=1,Td="firebase-heartbeat-store";let cv=null;function vP(){return cv||(cv=M7(_D,yD,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Td)}catch(t){console.warn(t)}}}}).catch(n=>{throw Wo.create("idb-open",{originalErrorMessage:n.message})})),cv}async function vD(n){try{const t=(await vP()).transaction(Td),r=await t.objectStore(Td).get(wP(n));return await t.done,r}catch(e){if(e instanceof eo)qs.warn(e.message);else{const t=Wo.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});qs.warn(t.message)}}}async function oC(n,e){try{const r=(await vP()).transaction(Td,"readwrite");await r.objectStore(Td).put(e,wP(n)),await r.done}catch(t){if(t instanceof eo)qs.warn(t.message);else{const r=Wo.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});qs.warn(r.message)}}}function wP(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wD=1024,ED=30*24*60*60*1e3;class SD{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new CD(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=aC();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=ED}),this._storage.overwrite(this._heartbeatsCache))}catch(r){qs.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=aC(),{heartbeatsToSend:r,unsentEntries:i}=TD(this._heartbeatsCache.heartbeats),s=Xg(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return qs.warn(t),""}}}function aC(){return new Date().toISOString().substring(0,10)}function TD(n,e=wD){const t=[];let r=n.slice();for(const i of n){const s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),lC(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),lC(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class CD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return a7()?l7().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await vD(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return oC(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return oC(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function lC(n){return Xg(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ID(n){ol(new Xo("platform-logger",e=>new V7(e),"PRIVATE")),ol(new Xo("heartbeat",e=>new SD(e),"PRIVATE")),ts(b1,iC,n),ts(b1,iC,"esm2017"),ts("fire-js","")}ID("");function Aw(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function EP(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const PD=EP,SP=new Xd("auth","Firebase",EP());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rm=new r0("@firebase/auth");function kD(n,...e){rm.logLevel<=We.WARN&&rm.warn(`Auth (${vl}): ${n}`,...e)}function pg(n,...e){rm.logLevel<=We.ERROR&&rm.error(`Auth (${vl}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ai(n,...e){throw Dw(n,...e)}function Ri(n,...e){return Dw(n,...e)}function Nw(n,e,t){const r=Object.assign(Object.assign({},PD()),{[e]:t});return new Xd("auth","Firebase",r).create(e,{appName:n.name})}function Us(n){return Nw(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function RD(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&ai(n,"argument-error"),Nw(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Dw(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return SP.create(n,...e)}function Ce(n,e,...t){if(!n)throw Dw(e,...t)}function Os(n){const e="INTERNAL ASSERTION FAILED: "+n;throw pg(e),new Error(e)}function Ks(n,e){n||Os(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L1(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function xD(){return uC()==="http:"||uC()==="https:"}function uC(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(xD()||r7()||"connection"in navigator)?navigator.onLine:!0}function ND(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jd{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ks(t>e,"Short delay should be less than long delay!"),this.isMobile=kw()||pP()}get(){return AD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bw(n,e){Ks(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Os("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Os("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Os("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bD=new Jd(3e4,6e4);function la(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function ua(n,e,t,r,i={}){return CP(n,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const l=fc(Object.assign({key:n.config.apiKey},o)).slice(1),c=await n._getAdditionalHeaders();c["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode);const d=Object.assign({method:e,headers:c},s);return n7()||(d.referrerPolicy="no-referrer"),TP.fetch()(IP(n,n.config.apiHost,t,l),d)})}async function CP(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},DD),e);try{const i=new MD(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Gp(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[c,d]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Gp(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Gp(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw Gp(n,"user-disabled",o);const p=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw Nw(n,p,d);ai(n,p)}}catch(i){if(i instanceof eo)throw i;ai(n,"network-request-failed",{message:String(i)})}}async function Zd(n,e,t,r,i={}){const s=await ua(n,e,t,r,i);return"mfaPendingCredential"in s&&ai(n,"multi-factor-auth-required",{_serverResponse:s}),s}function IP(n,e,t,r){const i=`${e}${t}?${r}`;return n.config.emulator?bw(n.config,i):`${n.config.apiScheme}://${i}`}function OD(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class MD{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Ri(this.auth,"network-request-failed")),bD.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Gp(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=Ri(n,e,r);return i.customData._tokenResponse=t,i}function cC(n){return n!==void 0&&n.enterprise!==void 0}class LD{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return OD(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function FD(n,e){return ua(n,"GET","/v2/recaptchaConfig",la(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VD(n,e){return ua(n,"POST","/v1/accounts:delete",e)}async function PP(n,e){return ua(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kh(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function UD(n,e=!1){const t=vt(n),r=await t.getIdToken(e),i=Ow(r);Ce(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Kh(hv(i.auth_time)),issuedAtTime:Kh(hv(i.iat)),expirationTime:Kh(hv(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function hv(n){return Number(n)*1e3}function Ow(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return pg("JWT malformed, contained fewer than 3 sections"),null;try{const i=Jg(t);return i?JSON.parse(i):(pg("Failed to decode base64 JWT payload"),null)}catch(i){return pg("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function hC(n){const e=Ow(n);return Ce(e,"internal-error"),Ce(typeof e.exp<"u","internal-error"),Ce(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cd(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof eo&&BD(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function BD({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zD{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F1{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Kh(this.lastLoginAt),this.creationTime=Kh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function im(n){var e;const t=n.auth,r=await n.getIdToken(),i=await Cd(n,PP(t,{idToken:r}));Ce(i==null?void 0:i.users.length,t,"internal-error");const s=i.users[0];n._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?kP(s.providerUserInfo):[],l=GD(n.providerData,o),c=n.isAnonymous,d=!(n.email&&s.passwordHash)&&!(l!=null&&l.length),p=c?d:!1,_={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new F1(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,_)}async function jD(n){const e=vt(n);await im(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function GD(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function kP(n){return n.map(e=>{var{providerId:t}=e,r=Aw(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WD(n,e){const t=await CP(n,{},async()=>{const r=fc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=IP(n,i,"/v1/token",`key=${s}`),l=await n._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",TP.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function HD(n,e){return ua(n,"POST","/v2/accounts:revokeToken",la(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ce(e.idToken,"internal-error"),Ce(typeof e.idToken<"u","internal-error"),Ce(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):hC(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ce(e.length!==0,"internal-error");const t=hC(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ce(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await WD(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new Nu;return r&&(Ce(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(Ce(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(Ce(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Nu,this.toJSON())}_performRefresh(){return Os("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function So(n,e){Ce(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Ms{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=Aw(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new zD(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new F1(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Cd(this,this.stsTokenManager.getToken(this.auth,e));return Ce(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return UD(this,e)}reload(){return jD(this)}_assign(e){this!==e&&(Ce(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ms(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Ce(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await im(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ci(this.auth.app))return Promise.reject(Us(this.auth));const e=await this.getIdToken();return await Cd(this,VD(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,l,c,d,p;const _=(r=t.displayName)!==null&&r!==void 0?r:void 0,m=(i=t.email)!==null&&i!==void 0?i:void 0,E=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,S=(o=t.photoURL)!==null&&o!==void 0?o:void 0,k=(l=t.tenantId)!==null&&l!==void 0?l:void 0,N=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,x=(d=t.createdAt)!==null&&d!==void 0?d:void 0,R=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:w,emailVerified:P,isAnonymous:F,providerData:U,stsTokenManager:D}=t;Ce(w&&D,e,"internal-error");const C=Nu.fromJSON(this.name,D);Ce(typeof w=="string",e,"internal-error"),So(_,e.name),So(m,e.name),Ce(typeof P=="boolean",e,"internal-error"),Ce(typeof F=="boolean",e,"internal-error"),So(E,e.name),So(S,e.name),So(k,e.name),So(N,e.name),So(x,e.name),So(R,e.name);const b=new Ms({uid:w,auth:e,email:m,emailVerified:P,displayName:_,isAnonymous:F,photoURL:S,phoneNumber:E,tenantId:k,stsTokenManager:C,createdAt:x,lastLoginAt:R});return U&&Array.isArray(U)&&(b.providerData=U.map(A=>Object.assign({},A))),N&&(b._redirectEventId=N),b}static async _fromIdTokenResponse(e,t,r=!1){const i=new Nu;i.updateFromServerResponse(t);const s=new Ms({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await im(s),s}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];Ce(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?kP(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),l=new Nu;l.updateFromIdToken(r);const c=new Ms({uid:i.localId,auth:e,stsTokenManager:l,isAnonymous:o}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new F1(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(c,d),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dC=new Map;function Ls(n){Ks(n instanceof Function,"Expected a class definition");let e=dC.get(n);return e?(Ks(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,dC.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RP{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}RP.type="NONE";const fC=RP;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gg(n,e,t){return`firebase:${n}:${e}:${t}`}class Du{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=gg(this.userKey,i.apiKey,s),this.fullPersistenceKey=gg("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Ms._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Du(Ls(fC),e,r);const i=(await Promise.all(t.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let s=i[0]||Ls(fC);const o=gg(r,e.config.apiKey,e.name);let l=null;for(const d of t)try{const p=await d._get(o);if(p){const _=Ms._fromJSON(e,p);d!==s&&(l=_),s=d;break}}catch{}const c=i.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new Du(s,e,r):(s=c[0],l&&await s._set(o,l.toJSON()),await Promise.all(t.map(async d=>{if(d!==s)try{await d._remove(o)}catch{}})),new Du(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pC(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(DP(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(xP(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(OP(e))return"Blackberry";if(MP(e))return"Webos";if(AP(e))return"Safari";if((e.includes("chrome/")||NP(e))&&!e.includes("edge/"))return"Chrome";if(bP(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function xP(n=ir()){return/firefox\//i.test(n)}function AP(n=ir()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function NP(n=ir()){return/crios\//i.test(n)}function DP(n=ir()){return/iemobile/i.test(n)}function bP(n=ir()){return/android/i.test(n)}function OP(n=ir()){return/blackberry/i.test(n)}function MP(n=ir()){return/webos/i.test(n)}function Mw(n=ir()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function $D(n=ir()){var e;return Mw(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function qD(){return i7()&&document.documentMode===10}function LP(n=ir()){return Mw(n)||bP(n)||MP(n)||OP(n)||/windows phone/i.test(n)||DP(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FP(n,e=[]){let t;switch(n){case"Browser":t=pC(ir());break;case"Worker":t=`${pC(ir())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${vl}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KD{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((o,l)=>{try{const c=e(s);o(c)}catch(c){l(c)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QD(n,e={}){return ua(n,"GET","/v2/passwordPolicy",la(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YD=6;class XD{constructor(e){var t,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:YD,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JD{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new gC(this),this.idTokenSubscription=new gC(this),this.beforeStateQueue=new KD(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=SP,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ls(t)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await Du.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await PP(this,{idToken:e}),r=await Ms._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Ci(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,l=i==null?void 0:i._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ce(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await im(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=ND()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ci(this.app))return Promise.reject(Us(this));const t=e?vt(e):null;return t&&Ce(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ce(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ci(this.app)?Promise.reject(Us(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ci(this.app)?Promise.reject(Us(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ls(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await QD(this),t=new XD(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Xd("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await HD(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ls(e)||this._popupRedirectResolver;Ce(t,this,"argument-error"),this.redirectPersistenceManager=await Du.create(this,[Ls(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ce(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const c=e.addObserver(t,r,i);return()=>{o=!0,c()}}else{const c=e.addObserver(t);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ce(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=FP(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&kD(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function ca(n){return vt(n)}class gC{constructor(e){this.auth=e,this.observer=null,this.addObserver=g7(t=>this.observer=t)}get next(){return Ce(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let s0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function ZD(n){s0=n}function VP(n){return s0.loadJS(n)}function eb(){return s0.recaptchaEnterpriseScript}function tb(){return s0.gapiScript}function nb(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const rb="recaptcha-enterprise",ib="NO_RECAPTCHA";class sb{constructor(e){this.type=rb,this.auth=ca(e)}async verify(e="verify",t=!1){async function r(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,l)=>{FD(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const d=new LD(c);return s.tenantId==null?s._agentRecaptchaConfig=d:s._tenantRecaptchaConfigs[s.tenantId]=d,o(d.siteKey)}}).catch(c=>{l(c)})})}function i(s,o,l){const c=window.grecaptcha;cC(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(d=>{o(d)}).catch(()=>{o(ib)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(l=>{if(!t&&cC(window.grecaptcha))i(l,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=eb();c.length!==0&&(c+=l),VP(c).then(()=>{i(l,s,o)}).catch(d=>{o(d)})}}).catch(l=>{o(l)})})}}async function mC(n,e,t,r=!1){const i=new sb(n);let s;try{s=await i.verify(t)}catch{s=await i.verify(t,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function V1(n,e,t,r){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await mC(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await mC(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ob(n,e){const t=i0(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(tm(s,e??{}))return i;ai(i,"already-initialized")}return t.initialize({options:e})}function ab(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Ls);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function UP(n,e,t){const r=ca(n);Ce(r._canInitEmulator,r,"emulator-config-failed"),Ce(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(t!=null&&t.disableWarnings),s=BP(e),{host:o,port:l}=lb(e),c=l===null?"":`:${l}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||ub()}function BP(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function lb(n){const e=BP(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:_C(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:_C(o)}}}function _C(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function ub(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lw{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Os("not implemented")}_getIdTokenResponse(e){return Os("not implemented")}_linkToIdToken(e,t){return Os("not implemented")}_getReauthenticationResolver(e){return Os("not implemented")}}async function cb(n,e){return ua(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hb(n,e){return Zd(n,"POST","/v1/accounts:signInWithPassword",la(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function db(n,e){return Zd(n,"POST","/v1/accounts:signInWithEmailLink",la(n,e))}async function fb(n,e){return Zd(n,"POST","/v1/accounts:signInWithEmailLink",la(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Id extends Lw{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Id(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Id(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return V1(e,t,"signInWithPassword",hb);case"emailLink":return db(e,{email:this._email,oobCode:this._password});default:ai(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return V1(e,r,"signUpPassword",cb);case"emailLink":return fb(e,{idToken:t,email:this._email,oobCode:this._password});default:ai(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bu(n,e){return Zd(n,"POST","/v1/accounts:signInWithIdp",la(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pb="http://localhost";class al extends Lw{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new al(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ai("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=Aw(t,["providerId","signInMethod"]);if(!r||!i)return null;const o=new al(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return bu(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,bu(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,bu(e,t)}buildRequest(){const e={requestUri:pb,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=fc(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gb(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function mb(n){const e=Nh(Dh(n)).link,t=e?Nh(Dh(e)).deep_link_id:null,r=Nh(Dh(n)).deep_link_id;return(r?Nh(Dh(r)).link:null)||r||t||e||n}class Fw{constructor(e){var t,r,i,s,o,l;const c=Nh(Dh(e)),d=(t=c.apiKey)!==null&&t!==void 0?t:null,p=(r=c.oobCode)!==null&&r!==void 0?r:null,_=gb((i=c.mode)!==null&&i!==void 0?i:null);Ce(d&&p&&_,"argument-error"),this.apiKey=d,this.operation=_,this.code=p,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const t=mb(e);try{return new Fw(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pc{constructor(){this.providerId=pc.PROVIDER_ID}static credential(e,t){return Id._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Fw.parseLink(t);return Ce(r,"argument-error"),Id._fromEmailAndCode(e,r.code,r.tenantId)}}pc.PROVIDER_ID="password";pc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";pc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef extends Vw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo extends ef{constructor(){super("facebook.com")}static credential(e){return al._fromParams({providerId:xo.PROVIDER_ID,signInMethod:xo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xo.credentialFromTaggedObject(e)}static credentialFromError(e){return xo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xo.credential(e.oauthAccessToken)}catch{return null}}}xo.FACEBOOK_SIGN_IN_METHOD="facebook.com";xo.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As extends ef{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return al._fromParams({providerId:As.PROVIDER_ID,signInMethod:As.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return As.credentialFromTaggedObject(e)}static credentialFromError(e){return As.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return As.credential(t,r)}catch{return null}}}As.GOOGLE_SIGN_IN_METHOD="google.com";As.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao extends ef{constructor(){super("github.com")}static credential(e){return al._fromParams({providerId:Ao.PROVIDER_ID,signInMethod:Ao.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ao.credentialFromTaggedObject(e)}static credentialFromError(e){return Ao.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ao.credential(e.oauthAccessToken)}catch{return null}}}Ao.GITHUB_SIGN_IN_METHOD="github.com";Ao.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class No extends ef{constructor(){super("twitter.com")}static credential(e,t){return al._fromParams({providerId:No.PROVIDER_ID,signInMethod:No.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return No.credentialFromTaggedObject(e)}static credentialFromError(e){return No.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return No.credential(t,r)}catch{return null}}}No.TWITTER_SIGN_IN_METHOD="twitter.com";No.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _b(n,e){return Zd(n,"POST","/v1/accounts:signUp",la(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await Ms._fromIdTokenResponse(e,r,i),o=yC(r);return new ll({user:s,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=yC(r);return new ll({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function yC(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sm extends eo{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,sm.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new sm(e,t,r,i)}}function zP(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?sm._fromErrorAndOperation(n,s,e,r):s})}async function yb(n,e,t=!1){const r=await Cd(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return ll._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vb(n,e,t=!1){const{auth:r}=n;if(Ci(r.app))return Promise.reject(Us(r));const i="reauthenticate";try{const s=await Cd(n,zP(r,i,e,n),t);Ce(s.idToken,r,"internal-error");const o=Ow(s.idToken);Ce(o,r,"internal-error");const{sub:l}=o;return Ce(n.uid===l,r,"user-mismatch"),ll._forOperation(n,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&ai(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jP(n,e,t=!1){if(Ci(n.app))return Promise.reject(Us(n));const r="signIn",i=await zP(n,r,e),s=await ll._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}async function wb(n,e){return jP(ca(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GP(n){const e=ca(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Eb(n,e,t){if(Ci(n.app))return Promise.reject(Us(n));const r=ca(n),o=await V1(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",_b).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&GP(n),c}),l=await ll._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(l.user),l}function Sb(n,e,t){return Ci(n.app)?Promise.reject(Us(n)):wb(vt(n),pc.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&GP(n),r})}function Tb(n,e,t,r){return vt(n).onIdTokenChanged(e,t,r)}function Cb(n,e,t){return vt(n).beforeAuthStateChanged(e,t)}function Ib(n,e,t,r){return vt(n).onAuthStateChanged(e,t,r)}function Pb(n){return vt(n).signOut()}const om="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WP{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(om,"1"),this.storage.removeItem(om),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kb=1e3,Rb=10;class HP extends WP{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=LP(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);qD()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Rb):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},kb)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}HP.type="LOCAL";const xb=HP;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $P extends WP{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}$P.type="SESSION";const qP=$P;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ab(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o0{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new o0(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const l=Array.from(o).map(async d=>d(t.origin,s)),c=await Ab(l);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:c})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}o0.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uw(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nb{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((l,c)=>{const d=Uw("",20);i.port1.start();const p=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(_){const m=_;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(p),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(m.data.response);break;default:clearTimeout(p),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ns(){return window}function Db(n){ns().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KP(){return typeof ns().WorkerGlobalScope<"u"&&typeof ns().importScripts=="function"}async function bb(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Ob(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function Mb(){return KP()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QP="firebaseLocalStorageDb",Lb=1,am="firebaseLocalStorage",YP="fbase_key";class tf{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function a0(n,e){return n.transaction([am],e?"readwrite":"readonly").objectStore(am)}function Fb(){const n=indexedDB.deleteDatabase(QP);return new tf(n).toPromise()}function U1(){const n=indexedDB.open(QP,Lb);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(am,{keyPath:YP})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(am)?e(r):(r.close(),await Fb(),e(await U1()))})})}async function vC(n,e,t){const r=a0(n,!0).put({[YP]:e,value:t});return new tf(r).toPromise()}async function Vb(n,e){const t=a0(n,!1).get(e),r=await new tf(t).toPromise();return r===void 0?null:r.value}function wC(n,e){const t=a0(n,!0).delete(e);return new tf(t).toPromise()}const Ub=800,Bb=3;class XP{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await U1(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>Bb)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return KP()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=o0._getInstance(Mb()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await bb(),!this.activeServiceWorker)return;this.sender=new Nb(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Ob()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await U1();return await vC(e,om,"1"),await wC(e,om),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>vC(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>Vb(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>wC(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=a0(i,!1).getAll();return new tf(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Ub)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}XP.type="LOCAL";const zb=XP;new Jd(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JP(n,e){return e?Ls(e):(Ce(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bw extends Lw{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return bu(e,this._buildIdpRequest())}_linkToIdToken(e,t){return bu(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return bu(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function jb(n){return jP(n.auth,new Bw(n),n.bypassAuthState)}function Gb(n){const{auth:e,user:t}=n;return Ce(t,e,"internal-error"),vb(t,new Bw(n),n.bypassAuthState)}async function Wb(n){const{auth:e,user:t}=n;return Ce(t,e,"internal-error"),yb(t,new Bw(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZP{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return jb;case"linkViaPopup":case"linkViaRedirect":return Wb;case"reauthViaPopup":case"reauthViaRedirect":return Gb;default:ai(this.auth,"internal-error")}}resolve(e){Ks(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ks(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hb=new Jd(2e3,1e4);async function $b(n,e,t){if(Ci(n.app))return Promise.reject(Ri(n,"operation-not-supported-in-this-environment"));const r=ca(n);RD(n,e,Vw);const i=JP(r,t);return new Ka(r,"signInViaPopup",e,i).executeNotNull()}class Ka extends ZP{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Ka.currentPopupAction&&Ka.currentPopupAction.cancel(),Ka.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ce(e,this.auth,"internal-error"),e}async onExecution(){Ks(this.filter.length===1,"Popup operations only handle one event");const e=Uw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ri(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Ri(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ka.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ri(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Hb.get())};e()}}Ka.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qb="pendingRedirect",mg=new Map;class Kb extends ZP{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=mg.get(this.auth._key());if(!e){try{const r=await Qb(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}mg.set(this.auth._key(),e)}return this.bypassAuthState||mg.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Qb(n,e){const t=Jb(e),r=Xb(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function Yb(n,e){mg.set(n._key(),e)}function Xb(n){return Ls(n._redirectPersistence)}function Jb(n){return gg(qb,n.config.apiKey,n.name)}async function Zb(n,e,t=!1){if(Ci(n.app))return Promise.reject(Us(n));const r=ca(n),i=JP(r,e),o=await new Kb(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eO=10*60*1e3;class tO{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!nO(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!ek(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Ri(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=eO&&this.cachedEventUids.clear(),this.cachedEventUids.has(EC(e))}saveEventToCache(e){this.cachedEventUids.add(EC(e)),this.lastProcessedEventTime=Date.now()}}function EC(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function ek({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function nO(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ek(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rO(n,e={}){return ua(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iO=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,sO=/^https?/;async function oO(n){if(n.config.emulator)return;const{authorizedDomains:e}=await rO(n);for(const t of e)try{if(aO(t))return}catch{}ai(n,"unauthorized-domain")}function aO(n){const e=L1(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!sO.test(t))return!1;if(iO.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lO=new Jd(3e4,6e4);function SC(){const n=ns().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function uO(n){return new Promise((e,t)=>{var r,i,s;function o(){SC(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{SC(),t(Ri(n,"network-request-failed"))},timeout:lO.get()})}if(!((i=(r=ns().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=ns().gapi)===null||s===void 0)&&s.load)o();else{const l=nb("iframefcb");return ns()[l]=()=>{gapi.load?o():t(Ri(n,"network-request-failed"))},VP(`${tb()}?onload=${l}`).catch(c=>t(c))}}).catch(e=>{throw _g=null,e})}let _g=null;function cO(n){return _g=_g||uO(n),_g}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hO=new Jd(5e3,15e3),dO="__/auth/iframe",fO="emulator/auth/iframe",pO={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},gO=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function mO(n){const e=n.config;Ce(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?bw(e,fO):`https://${n.config.authDomain}/${dO}`,r={apiKey:e.apiKey,appName:n.name,v:vl},i=gO.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${fc(r).slice(1)}`}async function _O(n){const e=await cO(n),t=ns().gapi;return Ce(t,n,"internal-error"),e.open({where:document.body,url:mO(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:pO,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=Ri(n,"network-request-failed"),l=ns().setTimeout(()=>{s(o)},hO.get());function c(){ns().clearTimeout(l),i(r)}r.ping(c).then(c,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yO={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},vO=500,wO=600,EO="_blank",SO="http://localhost";class TC{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function TO(n,e,t,r=vO,i=wO){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},yO),{width:r.toString(),height:i.toString(),top:s,left:o}),d=ir().toLowerCase();t&&(l=NP(d)?EO:t),xP(d)&&(e=e||SO,c.scrollbars="yes");const p=Object.entries(c).reduce((m,[E,S])=>`${m}${E}=${S},`,"");if($D(d)&&l!=="_self")return CO(e||"",l),new TC(null);const _=window.open(e||"",l,p);Ce(_,n,"popup-blocked");try{_.focus()}catch{}return new TC(_)}function CO(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IO="__/auth/handler",PO="emulator/auth/handler",kO=encodeURIComponent("fac");async function CC(n,e,t,r,i,s){Ce(n.config.authDomain,n,"auth-domain-config-required"),Ce(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:vl,eventId:i};if(e instanceof Vw){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",Zg(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,_]of Object.entries({}))o[p]=_}if(e instanceof ef){const p=e.getScopes().filter(_=>_!=="");p.length>0&&(o.scopes=p.join(","))}n.tenantId&&(o.tid=n.tenantId);const l=o;for(const p of Object.keys(l))l[p]===void 0&&delete l[p];const c=await n._getAppCheckToken(),d=c?`#${kO}=${encodeURIComponent(c)}`:"";return`${RO(n)}?${fc(l).slice(1)}${d}`}function RO({config:n}){return n.emulator?bw(n,PO):`https://${n.authDomain}/${IO}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dv="webStorageSupport";class xO{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=qP,this._completeRedirectFn=Zb,this._overrideRedirectResult=Yb}async _openPopup(e,t,r,i){var s;Ks((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await CC(e,t,r,L1(),i);return TO(e,o,Uw())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await CC(e,t,r,L1(),i);return Db(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Ks(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await _O(e),r=new tO(e);return t.register("authEvent",i=>(Ce(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(dv,{type:dv},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[dv];o!==void 0&&t(!!o),ai(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=oO(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return LP()||AP()||Mw()}}const AO=xO;var IC="@firebase/auth",PC="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NO{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ce(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DO(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function bO(n){ol(new Xo("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;Ce(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:FP(n)},d=new JD(r,i,s,c);return ab(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),ol(new Xo("auth-internal",e=>{const t=ca(e.getProvider("auth").getImmediate());return(r=>new NO(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ts(IC,PC,DO(n)),ts(IC,PC,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OO=5*60,MO=dP("authIdTokenMaxAge")||OO;let kC=null;const LO=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>MO)return;const i=t==null?void 0:t.token;kC!==i&&(kC=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function FO(n=xw()){const e=i0(n,"auth");if(e.isInitialized())return e.getImmediate();const t=ob(n,{popupRedirectResolver:AO,persistence:[zb,xb,qP]}),r=dP("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=LO(s.toString());Cb(t,o,()=>o(t.currentUser)),Tb(t,l=>o(l))}}const i=uP("auth");return i&&UP(t,`http://${i}`),t}function VO(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}ZD({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=Ri("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",VO().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});bO("Browser");var UO="firebase",BO="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ts(UO,BO,"app");var RC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var el,tk;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(D,C){function b(){}b.prototype=C.prototype,D.D=C.prototype,D.prototype=new b,D.prototype.constructor=D,D.C=function(A,M,B){for(var V=Array(arguments.length-2),fe=2;fe<arguments.length;fe++)V[fe-2]=arguments[fe];return C.prototype[M].apply(A,V)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(D,C,b){b||(b=0);var A=Array(16);if(typeof C=="string")for(var M=0;16>M;++M)A[M]=C.charCodeAt(b++)|C.charCodeAt(b++)<<8|C.charCodeAt(b++)<<16|C.charCodeAt(b++)<<24;else for(M=0;16>M;++M)A[M]=C[b++]|C[b++]<<8|C[b++]<<16|C[b++]<<24;C=D.g[0],b=D.g[1],M=D.g[2];var B=D.g[3],V=C+(B^b&(M^B))+A[0]+3614090360&4294967295;C=b+(V<<7&4294967295|V>>>25),V=B+(M^C&(b^M))+A[1]+3905402710&4294967295,B=C+(V<<12&4294967295|V>>>20),V=M+(b^B&(C^b))+A[2]+606105819&4294967295,M=B+(V<<17&4294967295|V>>>15),V=b+(C^M&(B^C))+A[3]+3250441966&4294967295,b=M+(V<<22&4294967295|V>>>10),V=C+(B^b&(M^B))+A[4]+4118548399&4294967295,C=b+(V<<7&4294967295|V>>>25),V=B+(M^C&(b^M))+A[5]+1200080426&4294967295,B=C+(V<<12&4294967295|V>>>20),V=M+(b^B&(C^b))+A[6]+2821735955&4294967295,M=B+(V<<17&4294967295|V>>>15),V=b+(C^M&(B^C))+A[7]+4249261313&4294967295,b=M+(V<<22&4294967295|V>>>10),V=C+(B^b&(M^B))+A[8]+1770035416&4294967295,C=b+(V<<7&4294967295|V>>>25),V=B+(M^C&(b^M))+A[9]+2336552879&4294967295,B=C+(V<<12&4294967295|V>>>20),V=M+(b^B&(C^b))+A[10]+4294925233&4294967295,M=B+(V<<17&4294967295|V>>>15),V=b+(C^M&(B^C))+A[11]+2304563134&4294967295,b=M+(V<<22&4294967295|V>>>10),V=C+(B^b&(M^B))+A[12]+1804603682&4294967295,C=b+(V<<7&4294967295|V>>>25),V=B+(M^C&(b^M))+A[13]+4254626195&4294967295,B=C+(V<<12&4294967295|V>>>20),V=M+(b^B&(C^b))+A[14]+2792965006&4294967295,M=B+(V<<17&4294967295|V>>>15),V=b+(C^M&(B^C))+A[15]+1236535329&4294967295,b=M+(V<<22&4294967295|V>>>10),V=C+(M^B&(b^M))+A[1]+4129170786&4294967295,C=b+(V<<5&4294967295|V>>>27),V=B+(b^M&(C^b))+A[6]+3225465664&4294967295,B=C+(V<<9&4294967295|V>>>23),V=M+(C^b&(B^C))+A[11]+643717713&4294967295,M=B+(V<<14&4294967295|V>>>18),V=b+(B^C&(M^B))+A[0]+3921069994&4294967295,b=M+(V<<20&4294967295|V>>>12),V=C+(M^B&(b^M))+A[5]+3593408605&4294967295,C=b+(V<<5&4294967295|V>>>27),V=B+(b^M&(C^b))+A[10]+38016083&4294967295,B=C+(V<<9&4294967295|V>>>23),V=M+(C^b&(B^C))+A[15]+3634488961&4294967295,M=B+(V<<14&4294967295|V>>>18),V=b+(B^C&(M^B))+A[4]+3889429448&4294967295,b=M+(V<<20&4294967295|V>>>12),V=C+(M^B&(b^M))+A[9]+568446438&4294967295,C=b+(V<<5&4294967295|V>>>27),V=B+(b^M&(C^b))+A[14]+3275163606&4294967295,B=C+(V<<9&4294967295|V>>>23),V=M+(C^b&(B^C))+A[3]+4107603335&4294967295,M=B+(V<<14&4294967295|V>>>18),V=b+(B^C&(M^B))+A[8]+1163531501&4294967295,b=M+(V<<20&4294967295|V>>>12),V=C+(M^B&(b^M))+A[13]+2850285829&4294967295,C=b+(V<<5&4294967295|V>>>27),V=B+(b^M&(C^b))+A[2]+4243563512&4294967295,B=C+(V<<9&4294967295|V>>>23),V=M+(C^b&(B^C))+A[7]+1735328473&4294967295,M=B+(V<<14&4294967295|V>>>18),V=b+(B^C&(M^B))+A[12]+2368359562&4294967295,b=M+(V<<20&4294967295|V>>>12),V=C+(b^M^B)+A[5]+4294588738&4294967295,C=b+(V<<4&4294967295|V>>>28),V=B+(C^b^M)+A[8]+2272392833&4294967295,B=C+(V<<11&4294967295|V>>>21),V=M+(B^C^b)+A[11]+1839030562&4294967295,M=B+(V<<16&4294967295|V>>>16),V=b+(M^B^C)+A[14]+4259657740&4294967295,b=M+(V<<23&4294967295|V>>>9),V=C+(b^M^B)+A[1]+2763975236&4294967295,C=b+(V<<4&4294967295|V>>>28),V=B+(C^b^M)+A[4]+1272893353&4294967295,B=C+(V<<11&4294967295|V>>>21),V=M+(B^C^b)+A[7]+4139469664&4294967295,M=B+(V<<16&4294967295|V>>>16),V=b+(M^B^C)+A[10]+3200236656&4294967295,b=M+(V<<23&4294967295|V>>>9),V=C+(b^M^B)+A[13]+681279174&4294967295,C=b+(V<<4&4294967295|V>>>28),V=B+(C^b^M)+A[0]+3936430074&4294967295,B=C+(V<<11&4294967295|V>>>21),V=M+(B^C^b)+A[3]+3572445317&4294967295,M=B+(V<<16&4294967295|V>>>16),V=b+(M^B^C)+A[6]+76029189&4294967295,b=M+(V<<23&4294967295|V>>>9),V=C+(b^M^B)+A[9]+3654602809&4294967295,C=b+(V<<4&4294967295|V>>>28),V=B+(C^b^M)+A[12]+3873151461&4294967295,B=C+(V<<11&4294967295|V>>>21),V=M+(B^C^b)+A[15]+530742520&4294967295,M=B+(V<<16&4294967295|V>>>16),V=b+(M^B^C)+A[2]+3299628645&4294967295,b=M+(V<<23&4294967295|V>>>9),V=C+(M^(b|~B))+A[0]+4096336452&4294967295,C=b+(V<<6&4294967295|V>>>26),V=B+(b^(C|~M))+A[7]+1126891415&4294967295,B=C+(V<<10&4294967295|V>>>22),V=M+(C^(B|~b))+A[14]+2878612391&4294967295,M=B+(V<<15&4294967295|V>>>17),V=b+(B^(M|~C))+A[5]+4237533241&4294967295,b=M+(V<<21&4294967295|V>>>11),V=C+(M^(b|~B))+A[12]+1700485571&4294967295,C=b+(V<<6&4294967295|V>>>26),V=B+(b^(C|~M))+A[3]+2399980690&4294967295,B=C+(V<<10&4294967295|V>>>22),V=M+(C^(B|~b))+A[10]+4293915773&4294967295,M=B+(V<<15&4294967295|V>>>17),V=b+(B^(M|~C))+A[1]+2240044497&4294967295,b=M+(V<<21&4294967295|V>>>11),V=C+(M^(b|~B))+A[8]+1873313359&4294967295,C=b+(V<<6&4294967295|V>>>26),V=B+(b^(C|~M))+A[15]+4264355552&4294967295,B=C+(V<<10&4294967295|V>>>22),V=M+(C^(B|~b))+A[6]+2734768916&4294967295,M=B+(V<<15&4294967295|V>>>17),V=b+(B^(M|~C))+A[13]+1309151649&4294967295,b=M+(V<<21&4294967295|V>>>11),V=C+(M^(b|~B))+A[4]+4149444226&4294967295,C=b+(V<<6&4294967295|V>>>26),V=B+(b^(C|~M))+A[11]+3174756917&4294967295,B=C+(V<<10&4294967295|V>>>22),V=M+(C^(B|~b))+A[2]+718787259&4294967295,M=B+(V<<15&4294967295|V>>>17),V=b+(B^(M|~C))+A[9]+3951481745&4294967295,D.g[0]=D.g[0]+C&4294967295,D.g[1]=D.g[1]+(M+(V<<21&4294967295|V>>>11))&4294967295,D.g[2]=D.g[2]+M&4294967295,D.g[3]=D.g[3]+B&4294967295}r.prototype.u=function(D,C){C===void 0&&(C=D.length);for(var b=C-this.blockSize,A=this.B,M=this.h,B=0;B<C;){if(M==0)for(;B<=b;)i(this,D,B),B+=this.blockSize;if(typeof D=="string"){for(;B<C;)if(A[M++]=D.charCodeAt(B++),M==this.blockSize){i(this,A),M=0;break}}else for(;B<C;)if(A[M++]=D[B++],M==this.blockSize){i(this,A),M=0;break}}this.h=M,this.o+=C},r.prototype.v=function(){var D=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);D[0]=128;for(var C=1;C<D.length-8;++C)D[C]=0;var b=8*this.o;for(C=D.length-8;C<D.length;++C)D[C]=b&255,b/=256;for(this.u(D),D=Array(16),C=b=0;4>C;++C)for(var A=0;32>A;A+=8)D[b++]=this.g[C]>>>A&255;return D};function s(D,C){var b=l;return Object.prototype.hasOwnProperty.call(b,D)?b[D]:b[D]=C(D)}function o(D,C){this.h=C;for(var b=[],A=!0,M=D.length-1;0<=M;M--){var B=D[M]|0;A&&B==C||(b[M]=B,A=!1)}this.g=b}var l={};function c(D){return-128<=D&&128>D?s(D,function(C){return new o([C|0],0>C?-1:0)}):new o([D|0],0>D?-1:0)}function d(D){if(isNaN(D)||!isFinite(D))return _;if(0>D)return N(d(-D));for(var C=[],b=1,A=0;D>=b;A++)C[A]=D/b|0,b*=4294967296;return new o(C,0)}function p(D,C){if(D.length==0)throw Error("number format error: empty string");if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(D.charAt(0)=="-")return N(p(D.substring(1),C));if(0<=D.indexOf("-"))throw Error('number format error: interior "-" character');for(var b=d(Math.pow(C,8)),A=_,M=0;M<D.length;M+=8){var B=Math.min(8,D.length-M),V=parseInt(D.substring(M,M+B),C);8>B?(B=d(Math.pow(C,B)),A=A.j(B).add(d(V))):(A=A.j(b),A=A.add(d(V)))}return A}var _=c(0),m=c(1),E=c(16777216);n=o.prototype,n.m=function(){if(k(this))return-N(this).m();for(var D=0,C=1,b=0;b<this.g.length;b++){var A=this.i(b);D+=(0<=A?A:4294967296+A)*C,C*=4294967296}return D},n.toString=function(D){if(D=D||10,2>D||36<D)throw Error("radix out of range: "+D);if(S(this))return"0";if(k(this))return"-"+N(this).toString(D);for(var C=d(Math.pow(D,6)),b=this,A="";;){var M=P(b,C).g;b=x(b,M.j(C));var B=((0<b.g.length?b.g[0]:b.h)>>>0).toString(D);if(b=M,S(b))return B+A;for(;6>B.length;)B="0"+B;A=B+A}},n.i=function(D){return 0>D?0:D<this.g.length?this.g[D]:this.h};function S(D){if(D.h!=0)return!1;for(var C=0;C<D.g.length;C++)if(D.g[C]!=0)return!1;return!0}function k(D){return D.h==-1}n.l=function(D){return D=x(this,D),k(D)?-1:S(D)?0:1};function N(D){for(var C=D.g.length,b=[],A=0;A<C;A++)b[A]=~D.g[A];return new o(b,~D.h).add(m)}n.abs=function(){return k(this)?N(this):this},n.add=function(D){for(var C=Math.max(this.g.length,D.g.length),b=[],A=0,M=0;M<=C;M++){var B=A+(this.i(M)&65535)+(D.i(M)&65535),V=(B>>>16)+(this.i(M)>>>16)+(D.i(M)>>>16);A=V>>>16,B&=65535,V&=65535,b[M]=V<<16|B}return new o(b,b[b.length-1]&-2147483648?-1:0)};function x(D,C){return D.add(N(C))}n.j=function(D){if(S(this)||S(D))return _;if(k(this))return k(D)?N(this).j(N(D)):N(N(this).j(D));if(k(D))return N(this.j(N(D)));if(0>this.l(E)&&0>D.l(E))return d(this.m()*D.m());for(var C=this.g.length+D.g.length,b=[],A=0;A<2*C;A++)b[A]=0;for(A=0;A<this.g.length;A++)for(var M=0;M<D.g.length;M++){var B=this.i(A)>>>16,V=this.i(A)&65535,fe=D.i(M)>>>16,se=D.i(M)&65535;b[2*A+2*M]+=V*se,R(b,2*A+2*M),b[2*A+2*M+1]+=B*se,R(b,2*A+2*M+1),b[2*A+2*M+1]+=V*fe,R(b,2*A+2*M+1),b[2*A+2*M+2]+=B*fe,R(b,2*A+2*M+2)}for(A=0;A<C;A++)b[A]=b[2*A+1]<<16|b[2*A];for(A=C;A<2*C;A++)b[A]=0;return new o(b,0)};function R(D,C){for(;(D[C]&65535)!=D[C];)D[C+1]+=D[C]>>>16,D[C]&=65535,C++}function w(D,C){this.g=D,this.h=C}function P(D,C){if(S(C))throw Error("division by zero");if(S(D))return new w(_,_);if(k(D))return C=P(N(D),C),new w(N(C.g),N(C.h));if(k(C))return C=P(D,N(C)),new w(N(C.g),C.h);if(30<D.g.length){if(k(D)||k(C))throw Error("slowDivide_ only works with positive integers.");for(var b=m,A=C;0>=A.l(D);)b=F(b),A=F(A);var M=U(b,1),B=U(A,1);for(A=U(A,2),b=U(b,2);!S(A);){var V=B.add(A);0>=V.l(D)&&(M=M.add(b),B=V),A=U(A,1),b=U(b,1)}return C=x(D,M.j(C)),new w(M,C)}for(M=_;0<=D.l(C);){for(b=Math.max(1,Math.floor(D.m()/C.m())),A=Math.ceil(Math.log(b)/Math.LN2),A=48>=A?1:Math.pow(2,A-48),B=d(b),V=B.j(C);k(V)||0<V.l(D);)b-=A,B=d(b),V=B.j(C);S(B)&&(B=m),M=M.add(B),D=x(D,V)}return new w(M,D)}n.A=function(D){return P(this,D).h},n.and=function(D){for(var C=Math.max(this.g.length,D.g.length),b=[],A=0;A<C;A++)b[A]=this.i(A)&D.i(A);return new o(b,this.h&D.h)},n.or=function(D){for(var C=Math.max(this.g.length,D.g.length),b=[],A=0;A<C;A++)b[A]=this.i(A)|D.i(A);return new o(b,this.h|D.h)},n.xor=function(D){for(var C=Math.max(this.g.length,D.g.length),b=[],A=0;A<C;A++)b[A]=this.i(A)^D.i(A);return new o(b,this.h^D.h)};function F(D){for(var C=D.g.length+1,b=[],A=0;A<C;A++)b[A]=D.i(A)<<1|D.i(A-1)>>>31;return new o(b,D.h)}function U(D,C){var b=C>>5;C%=32;for(var A=D.g.length-b,M=[],B=0;B<A;B++)M[B]=0<C?D.i(B+b)>>>C|D.i(B+b+1)<<32-C:D.i(B+b);return new o(M,D.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,tk=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=p,el=o}).apply(typeof RC<"u"?RC:typeof self<"u"?self:typeof window<"u"?window:{});var Wp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var nk,bh,rk,yg,B1,ik,sk,ok;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,v,I){return h==Array.prototype||h==Object.prototype||(h[v]=I.value),h};function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Wp=="object"&&Wp];for(var v=0;v<h.length;++v){var I=h[v];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var r=t(this);function i(h,v){if(v)e:{var I=r;h=h.split(".");for(var O=0;O<h.length-1;O++){var H=h[O];if(!(H in I))break e;I=I[H]}h=h[h.length-1],O=I[h],v=v(O),v!=O&&v!=null&&e(I,h,{configurable:!0,writable:!0,value:v})}}function s(h,v){h instanceof String&&(h+="");var I=0,O=!1,H={next:function(){if(!O&&I<h.length){var K=I++;return{value:v(K,h[K]),done:!1}}return O=!0,{done:!0,value:void 0}}};return H[Symbol.iterator]=function(){return H},H}i("Array.prototype.values",function(h){return h||function(){return s(this,function(v,I){return I})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(h){var v=typeof h;return v=v!="object"?v:h?Array.isArray(h)?"array":v:"null",v=="array"||v=="object"&&typeof h.length=="number"}function d(h){var v=typeof h;return v=="object"&&h!=null||v=="function"}function p(h,v,I){return h.call.apply(h.bind,arguments)}function _(h,v,I){if(!h)throw Error();if(2<arguments.length){var O=Array.prototype.slice.call(arguments,2);return function(){var H=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(H,O),h.apply(v,H)}}return function(){return h.apply(v,arguments)}}function m(h,v,I){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:_,m.apply(null,arguments)}function E(h,v){var I=Array.prototype.slice.call(arguments,1);return function(){var O=I.slice();return O.push.apply(O,arguments),h.apply(this,O)}}function S(h,v){function I(){}I.prototype=v.prototype,h.aa=v.prototype,h.prototype=new I,h.prototype.constructor=h,h.Qb=function(O,H,K){for(var re=Array(arguments.length-2),Ye=2;Ye<arguments.length;Ye++)re[Ye-2]=arguments[Ye];return v.prototype[H].apply(O,re)}}function k(h){const v=h.length;if(0<v){const I=Array(v);for(let O=0;O<v;O++)I[O]=h[O];return I}return[]}function N(h,v){for(let I=1;I<arguments.length;I++){const O=arguments[I];if(c(O)){const H=h.length||0,K=O.length||0;h.length=H+K;for(let re=0;re<K;re++)h[H+re]=O[re]}else h.push(O)}}class x{constructor(v,I){this.i=v,this.j=I,this.h=0,this.g=null}get(){let v;return 0<this.h?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function R(h){return/^[\s\xa0]*$/.test(h)}function w(){var h=l.navigator;return h&&(h=h.userAgent)?h:""}function P(h){return P[" "](h),h}P[" "]=function(){};var F=w().indexOf("Gecko")!=-1&&!(w().toLowerCase().indexOf("webkit")!=-1&&w().indexOf("Edge")==-1)&&!(w().indexOf("Trident")!=-1||w().indexOf("MSIE")!=-1)&&w().indexOf("Edge")==-1;function U(h,v,I){for(const O in h)v.call(I,h[O],O,h)}function D(h,v){for(const I in h)v.call(void 0,h[I],I,h)}function C(h){const v={};for(const I in h)v[I]=h[I];return v}const b="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function A(h,v){let I,O;for(let H=1;H<arguments.length;H++){O=arguments[H];for(I in O)h[I]=O[I];for(let K=0;K<b.length;K++)I=b[K],Object.prototype.hasOwnProperty.call(O,I)&&(h[I]=O[I])}}function M(h){var v=1;h=h.split(":");const I=[];for(;0<v&&h.length;)I.push(h.shift()),v--;return h.length&&I.push(h.join(":")),I}function B(h){l.setTimeout(()=>{throw h},0)}function V(){var h=oe;let v=null;return h.g&&(v=h.g,h.g=h.g.next,h.g||(h.h=null),v.next=null),v}class fe{constructor(){this.h=this.g=null}add(v,I){const O=se.get();O.set(v,I),this.h?this.h.next=O:this.g=O,this.h=O}}var se=new x(()=>new Be,h=>h.reset());class Be{constructor(){this.next=this.g=this.h=null}set(v,I){this.h=v,this.g=I,this.next=null}reset(){this.next=this.g=this.h=null}}let De,Y=!1,oe=new fe,ne=()=>{const h=l.Promise.resolve(void 0);De=()=>{h.then(ae)}};var ae=()=>{for(var h;h=V();){try{h.h.call(h.g)}catch(I){B(I)}var v=se;v.j(h),100>v.h&&(v.h++,h.next=v.g,v.g=h)}Y=!1};function pe(){this.s=this.s,this.C=this.C}pe.prototype.s=!1,pe.prototype.ma=function(){this.s||(this.s=!0,this.N())},pe.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Se(h,v){this.type=h,this.g=this.target=v,this.defaultPrevented=!1}Se.prototype.h=function(){this.defaultPrevented=!0};var en=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var h=!1,v=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const I=()=>{};l.addEventListener("test",I,v),l.removeEventListener("test",I,v)}catch{}return h}();function xt(h,v){if(Se.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var I=this.type=h.type,O=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=v,v=h.relatedTarget){if(F){e:{try{P(v.nodeName);var H=!0;break e}catch{}H=!1}H||(v=null)}}else I=="mouseover"?v=h.fromElement:I=="mouseout"&&(v=h.toElement);this.relatedTarget=v,O?(this.clientX=O.clientX!==void 0?O.clientX:O.pageX,this.clientY=O.clientY!==void 0?O.clientY:O.pageY,this.screenX=O.screenX||0,this.screenY=O.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:pt[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&xt.aa.h.call(this)}}S(xt,Se);var pt={2:"touch",3:"pen",4:"mouse"};xt.prototype.h=function(){xt.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var j="closure_listenable_"+(1e6*Math.random()|0),Z=0;function ye(h,v,I,O,H){this.listener=h,this.proxy=null,this.src=v,this.type=I,this.capture=!!O,this.ha=H,this.key=++Z,this.da=this.fa=!1}function Ke(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function ke(h){this.src=h,this.g={},this.h=0}ke.prototype.add=function(h,v,I,O,H){var K=h.toString();h=this.g[K],h||(h=this.g[K]=[],this.h++);var re=lt(h,v,O,H);return-1<re?(v=h[re],I||(v.fa=!1)):(v=new ye(v,this.src,K,!!O,H),v.fa=I,h.push(v)),v};function ot(h,v){var I=v.type;if(I in h.g){var O=h.g[I],H=Array.prototype.indexOf.call(O,v,void 0),K;(K=0<=H)&&Array.prototype.splice.call(O,H,1),K&&(Ke(v),h.g[I].length==0&&(delete h.g[I],h.h--))}}function lt(h,v,I,O){for(var H=0;H<h.length;++H){var K=h[H];if(!K.da&&K.listener==v&&K.capture==!!I&&K.ha==O)return H}return-1}var _r="closure_lm_"+(1e6*Math.random()|0),rt={};function li(h,v,I,O,H){if(Array.isArray(v)){for(var K=0;K<v.length;K++)li(h,v[K],I,O,H);return null}return I=If(I),h&&h[j]?h.K(v,I,d(O)?!!O.capture:!1,H):Or(h,v,I,!1,O,H)}function Or(h,v,I,O,H,K){if(!v)throw Error("Invalid event type");var re=d(H)?!!H.capture:!!H,Ye=xc(h);if(Ye||(h[_r]=Ye=new ke(h)),I=Ye.add(v,I,O,re,K),I.proxy)return I;if(O=Oi(),I.proxy=O,O.src=h,O.listener=I,h.addEventListener)en||(H=re),H===void 0&&(H=!1),h.addEventListener(v.toString(),O,H);else if(h.attachEvent)h.attachEvent(Cf(v.toString()),O);else if(h.addListener&&h.removeListener)h.addListener(O);else throw Error("addEventListener and attachEvent are unavailable.");return I}function Oi(){function h(I){return v.call(h.src,h.listener,I)}const v=D_;return h}function Tf(h,v,I,O,H){if(Array.isArray(v))for(var K=0;K<v.length;K++)Tf(h,v[K],I,O,H);else O=d(O)?!!O.capture:!!O,I=If(I),h&&h[j]?(h=h.i,v=String(v).toString(),v in h.g&&(K=h.g[v],I=lt(K,I,O,H),-1<I&&(Ke(K[I]),Array.prototype.splice.call(K,I,1),K.length==0&&(delete h.g[v],h.h--)))):h&&(h=xc(h))&&(v=h.g[v.toString()],h=-1,v&&(h=lt(v,I,O,H)),(I=-1<h?v[h]:null)&&ls(I))}function ls(h){if(typeof h!="number"&&h&&!h.da){var v=h.src;if(v&&v[j])ot(v.i,h);else{var I=h.type,O=h.proxy;v.removeEventListener?v.removeEventListener(I,O,h.capture):v.detachEvent?v.detachEvent(Cf(I),O):v.addListener&&v.removeListener&&v.removeListener(O),(I=xc(v))?(ot(I,h),I.h==0&&(I.src=null,v[_r]=null)):Ke(h)}}}function Cf(h){return h in rt?rt[h]:rt[h]="on"+h}function D_(h,v){if(h.da)h=!0;else{v=new xt(v,this);var I=h.listener,O=h.ha||h.src;h.fa&&ls(h),h=I.call(O,v)}return h}function xc(h){return h=h[_r],h instanceof ke?h:null}var us="__closure_events_fn_"+(1e9*Math.random()>>>0);function If(h){return typeof h=="function"?h:(h[us]||(h[us]=function(v){return h.handleEvent(v)}),h[us])}function dn(){pe.call(this),this.i=new ke(this),this.M=this,this.F=null}S(dn,pe),dn.prototype[j]=!0,dn.prototype.removeEventListener=function(h,v,I,O){Tf(this,h,v,I,O)};function Pn(h,v){var I,O=h.F;if(O)for(I=[];O;O=O.F)I.push(O);if(h=h.M,O=v.type||v,typeof v=="string")v=new Se(v,h);else if(v instanceof Se)v.target=v.target||h;else{var H=v;v=new Se(O,h),A(v,H)}if(H=!0,I)for(var K=I.length-1;0<=K;K--){var re=v.g=I[K];H=Ol(re,O,!0,v)&&H}if(re=v.g=h,H=Ol(re,O,!0,v)&&H,H=Ol(re,O,!1,v)&&H,I)for(K=0;K<I.length;K++)re=v.g=I[K],H=Ol(re,O,!1,v)&&H}dn.prototype.N=function(){if(dn.aa.N.call(this),this.i){var h=this.i,v;for(v in h.g){for(var I=h.g[v],O=0;O<I.length;O++)Ke(I[O]);delete h.g[v],h.h--}}this.F=null},dn.prototype.K=function(h,v,I,O){return this.i.add(String(h),v,!1,I,O)},dn.prototype.L=function(h,v,I,O){return this.i.add(String(h),v,!0,I,O)};function Ol(h,v,I,O){if(v=h.i.g[String(v)],!v)return!0;v=v.concat();for(var H=!0,K=0;K<v.length;++K){var re=v[K];if(re&&!re.da&&re.capture==I){var Ye=re.listener,Bt=re.ha||re.src;re.fa&&ot(h.i,re),H=Ye.call(Bt,O)!==!1&&H}}return H&&!O.defaultPrevented}function Pf(h,v,I){if(typeof h=="function")I&&(h=m(h,I));else if(h&&typeof h.handleEvent=="function")h=m(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(v)?-1:l.setTimeout(h,v||0)}function kf(h){h.g=Pf(()=>{h.g=null,h.i&&(h.i=!1,kf(h))},h.l);const v=h.h;h.h=null,h.m.apply(null,v)}class b_ extends pe{constructor(v,I){super(),this.m=v,this.l=I,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:kf(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Sa(h){pe.call(this),this.h=h,this.g={}}S(Sa,pe);var Rf=[];function xf(h){U(h.g,function(v,I){this.g.hasOwnProperty(I)&&ls(v)},h),h.g={}}Sa.prototype.N=function(){Sa.aa.N.call(this),xf(this)},Sa.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ac=l.JSON.stringify,O_=l.JSON.parse,Af=class{stringify(h){return l.JSON.stringify(h,void 0)}parse(h){return l.JSON.parse(h,void 0)}};function Nc(){}Nc.prototype.h=null;function Nf(h){return h.h||(h.h=h.i())}function Df(){}var Ta={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Dc(){Se.call(this,"d")}S(Dc,Se);function bc(){Se.call(this,"c")}S(bc,Se);var Mi={},Oc=null;function Ml(){return Oc=Oc||new dn}Mi.La="serverreachability";function Ll(h){Se.call(this,Mi.La,h)}S(Ll,Se);function oo(h){const v=Ml();Pn(v,new Ll(v))}Mi.STAT_EVENT="statevent";function Mc(h,v){Se.call(this,Mi.STAT_EVENT,h),this.stat=v}S(Mc,Se);function kn(h){const v=Ml();Pn(v,new Mc(v,h))}Mi.Ma="timingevent";function bf(h,v){Se.call(this,Mi.Ma,h),this.size=v}S(bf,Se);function Ca(h,v){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){h()},v)}function ao(){this.g=!0}ao.prototype.xa=function(){this.g=!1};function Lc(h,v,I,O,H,K){h.info(function(){if(h.g)if(K)for(var re="",Ye=K.split("&"),Bt=0;Bt<Ye.length;Bt++){var je=Ye[Bt].split("=");if(1<je.length){var nn=je[0];je=je[1];var qt=nn.split("_");re=2<=qt.length&&qt[1]=="type"?re+(nn+"="+je+"&"):re+(nn+"=redacted&")}}else re=null;else re=K;return"XMLHTTP REQ ("+O+") [attempt "+H+"]: "+v+`
`+I+`
`+re})}function M_(h,v,I,O,H,K,re){h.info(function(){return"XMLHTTP RESP ("+O+") [ attempt "+H+"]: "+v+`
`+I+`
`+K+" "+re})}function lo(h,v,I,O){h.info(function(){return"XMLHTTP TEXT ("+v+"): "+L_(h,I)+(O?" "+O:"")})}function Fl(h,v){h.info(function(){return"TIMEOUT: "+v})}ao.prototype.info=function(){};function L_(h,v){if(!h.g)return v;if(!v)return null;try{var I=JSON.parse(v);if(I){for(h=0;h<I.length;h++)if(Array.isArray(I[h])){var O=I[h];if(!(2>O.length)){var H=O[1];if(Array.isArray(H)&&!(1>H.length)){var K=H[0];if(K!="noop"&&K!="stop"&&K!="close")for(var re=1;re<H.length;re++)H[re]=""}}}}return Ac(I)}catch{return v}}var Vl={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Of={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Fc;function Ul(){}S(Ul,Nc),Ul.prototype.g=function(){return new XMLHttpRequest},Ul.prototype.i=function(){return{}},Fc=new Ul;function Li(h,v,I,O){this.j=h,this.i=v,this.l=I,this.R=O||1,this.U=new Sa(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Mf}function Mf(){this.i=null,this.g="",this.h=!1}var Lf={},Vc={};function Uc(h,v,I){h.L=1,h.v=jl(yr(v)),h.m=I,h.P=!0,Ff(h,null)}function Ff(h,v){h.F=Date.now(),Bl(h),h.A=yr(h.v);var I=h.A,O=h.R;Array.isArray(O)||(O=[String(O)]),$e(I.i,"t",O),h.C=0,I=h.j.J,h.h=new Mf,h.g=Qc(h.j,I?v:null,!h.m),0<h.O&&(h.M=new b_(m(h.Y,h,h.g),h.O)),v=h.U,I=h.g,O=h.ca;var H="readystatechange";Array.isArray(H)||(H&&(Rf[0]=H.toString()),H=Rf);for(var K=0;K<H.length;K++){var re=li(I,H[K],O||v.handleEvent,!1,v.h||v);if(!re)break;v.g[re.key]=re}v=h.H?C(h.H):{},h.m?(h.u||(h.u="POST"),v["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,v)):(h.u="GET",h.g.ea(h.A,h.u,null,v)),oo(),Lc(h.i,h.u,h.A,h.l,h.R,h.m)}Li.prototype.ca=function(h){h=h.target;const v=this.M;v&&Gn(h)==3?v.j():this.Y(h)},Li.prototype.Y=function(h){try{if(h==this.g)e:{const qt=Gn(this.g);var v=this.g.Ba();const ji=this.g.Z();if(!(3>qt)&&(qt!=3||this.g&&(this.h.h||this.g.oa()||xa(this.g)))){this.J||qt!=4||v==7||(v==8||0>=ji?oo(3):oo(2)),cs(this);var I=this.g.Z();this.X=I;t:if(Vf(this)){var O=xa(this.g);h="";var H=O.length,K=Gn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ui(this),hs(this);var re="";break t}this.h.i=new l.TextDecoder}for(v=0;v<H;v++)this.h.h=!0,h+=this.h.i.decode(O[v],{stream:!(K&&v==H-1)});O.length=0,this.h.g+=h,this.C=0,re=this.h.g}else re=this.g.oa();if(this.o=I==200,M_(this.i,this.u,this.A,this.l,this.R,qt,I),this.o){if(this.T&&!this.K){t:{if(this.g){var Ye,Bt=this.g;if((Ye=Bt.g?Bt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!R(Ye)){var je=Ye;break t}}je=null}if(I=je)lo(this.i,this.l,I,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Bc(this,I);else{this.o=!1,this.s=3,kn(12),ui(this),hs(this);break e}}if(this.P){I=!0;let pn;for(;!this.J&&this.C<re.length;)if(pn=F_(this,re),pn==Vc){qt==4&&(this.s=4,kn(14),I=!1),lo(this.i,this.l,null,"[Incomplete Response]");break}else if(pn==Lf){this.s=4,kn(15),lo(this.i,this.l,re,"[Invalid Chunk]"),I=!1;break}else lo(this.i,this.l,pn,null),Bc(this,pn);if(Vf(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),qt!=4||re.length!=0||this.h.h||(this.s=1,kn(16),I=!1),this.o=this.o&&I,!I)lo(this.i,this.l,re,"[Invalid Chunked Response]"),ui(this),hs(this);else if(0<re.length&&!this.W){this.W=!0;var nn=this.j;nn.g==this&&nn.ba&&!nn.M&&(nn.j.info("Great, no buffering proxy detected. Bytes received: "+re.length),ys(nn),nn.M=!0,kn(11))}}else lo(this.i,this.l,re,null),Bc(this,re);qt==4&&ui(this),this.o&&!this.J&&(qt==4?qc(this.j,this):(this.o=!1,Bl(this)))}else ql(this.g),I==400&&0<re.indexOf("Unknown SID")?(this.s=3,kn(12)):(this.s=0,kn(13)),ui(this),hs(this)}}}catch{}finally{}};function Vf(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function F_(h,v){var I=h.C,O=v.indexOf(`
`,I);return O==-1?Vc:(I=Number(v.substring(I,O)),isNaN(I)?Lf:(O+=1,O+I>v.length?Vc:(v=v.slice(O,O+I),h.C=O+I,v)))}Li.prototype.cancel=function(){this.J=!0,ui(this)};function Bl(h){h.S=Date.now()+h.I,zl(h,h.I)}function zl(h,v){if(h.B!=null)throw Error("WatchDog timer not null");h.B=Ca(m(h.ba,h),v)}function cs(h){h.B&&(l.clearTimeout(h.B),h.B=null)}Li.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(Fl(this.i,this.A),this.L!=2&&(oo(),kn(17)),ui(this),this.s=2,hs(this)):zl(this,this.S-h)};function hs(h){h.j.G==0||h.J||qc(h.j,h)}function ui(h){cs(h);var v=h.M;v&&typeof v.ma=="function"&&v.ma(),h.M=null,xf(h.U),h.g&&(v=h.g,h.g=null,v.abort(),v.ma())}function Bc(h,v){try{var I=h.j;if(I.G!=0&&(I.g==h||at(I.h,h))){if(!h.K&&at(I.h,h)&&I.G==3){try{var O=I.Da.g.parse(v)}catch{O=null}if(Array.isArray(O)&&O.length==3){var H=O;if(H[0]==0){e:if(!I.u){if(I.g)if(I.g.F+3e3<h.F)Aa(I),wr(I);else break e;dt(I),kn(18)}}else I.za=H[1],0<I.za-I.T&&37500>H[2]&&I.F&&I.v==0&&!I.C&&(I.C=Ca(m(I.Za,I),6e3));if(1>=ht(I.h)&&I.ca){try{I.ca()}catch{}I.ca=void 0}}else fi(I,11)}else if((h.K||I.g==h)&&Aa(I),!R(v))for(H=I.Da.g.parse(v),v=0;v<H.length;v++){let je=H[v];if(I.T=je[0],je=je[1],I.G==2)if(je[0]=="c"){I.K=je[1],I.ia=je[2];const nn=je[3];nn!=null&&(I.la=nn,I.j.info("VER="+I.la));const qt=je[4];qt!=null&&(I.Aa=qt,I.j.info("SVER="+I.Aa));const ji=je[5];ji!=null&&typeof ji=="number"&&0<ji&&(O=1.5*ji,I.L=O,I.j.info("backChannelRequestTimeoutMs_="+O)),O=I;const pn=h.g;if(pn){const An=pn.g?pn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(An){var K=O.h;K.g||An.indexOf("spdy")==-1&&An.indexOf("quic")==-1&&An.indexOf("h2")==-1||(K.j=K.l,K.g=new Set,K.h&&(Wr(K,K.h),K.h=null))}if(O.D){const pi=pn.g?pn.g.getResponseHeader("X-HTTP-Session-Id"):null;pi&&(O.ya=pi,gt(O.I,O.D,pi))}}I.G=3,I.l&&I.l.ua(),I.ba&&(I.R=Date.now()-h.F,I.j.info("Handshake RTT: "+I.R+"ms")),O=I;var re=h;if(O.qa=Na(O,O.J?O.ia:null,O.W),re.K){tn(O.h,re);var Ye=re,Bt=O.L;Bt&&(Ye.I=Bt),Ye.B&&(cs(Ye),Bl(Ye)),O.g=re}else ur(O);0<I.i.length&&$r(I)}else je[0]!="stop"&&je[0]!="close"||fi(I,7);else I.G==3&&(je[0]=="stop"||je[0]=="close"?je[0]=="stop"?fi(I,7):di(I):je[0]!="noop"&&I.l&&I.l.ta(je),I.v=0)}}oo(4)}catch{}}var zc=class{constructor(h,v){this.g=h,this.map=v}};function ds(h){this.l=h||10,l.PerformanceNavigationTiming?(h=l.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ci(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function ht(h){return h.h?1:h.g?h.g.size:0}function at(h,v){return h.h?h.h==v:h.g?h.g.has(v):!1}function Wr(h,v){h.g?h.g.add(v):h.h=v}function tn(h,v){h.h&&h.h==v?h.h=null:h.g&&h.g.has(v)&&h.g.delete(v)}ds.prototype.cancel=function(){if(this.i=Rn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Rn(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let v=h.i;for(const I of h.g.values())v=v.concat(I.D);return v}return k(h.i)}function fs(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(c(h)){for(var v=[],I=h.length,O=0;O<I;O++)v.push(h[O]);return v}v=[],I=0;for(O in h)v[I++]=h[O];return v}function uo(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(c(h)||typeof h=="string"){var v=[];h=h.length;for(var I=0;I<h;I++)v.push(I);return v}v=[],I=0;for(const O in h)v[I++]=O;return v}}}function xn(h,v){if(h.forEach&&typeof h.forEach=="function")h.forEach(v,void 0);else if(c(h)||typeof h=="string")Array.prototype.forEach.call(h,v,void 0);else for(var I=uo(h),O=fs(h),H=O.length,K=0;K<H;K++)v.call(void 0,O[K],I&&I[K],h)}var Ia=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Uf(h,v){if(h){h=h.split("&");for(var I=0;I<h.length;I++){var O=h[I].indexOf("="),H=null;if(0<=O){var K=h[I].substring(0,O);H=h[I].substring(O+1)}else K=h[I];v(K,H?decodeURIComponent(H.replace(/\+/g," ")):"")}}}function Fi(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof Fi){this.h=h.h,Pa(this,h.j),this.o=h.o,this.g=h.g,zn(this,h.s),this.l=h.l;var v=h.i,I=new ps;I.i=v.i,v.g&&(I.g=new Map(v.g),I.h=v.h),Bf(this,I),this.m=h.m}else h&&(v=String(h).match(Ia))?(this.h=!1,Pa(this,v[1]||"",!0),this.o=Vi(v[2]||""),this.g=Vi(v[3]||"",!0),zn(this,v[4]),this.l=Vi(v[5]||"",!0),Bf(this,v[6]||"",!0),this.m=Vi(v[7]||"")):(this.h=!1,this.i=new ps(null,this.h))}Fi.prototype.toString=function(){var h=[],v=this.j;v&&h.push(Ui(v,Ra,!0),":");var I=this.g;return(I||v=="file")&&(h.push("//"),(v=this.o)&&h.push(Ui(v,Ra,!0),"@"),h.push(encodeURIComponent(String(I)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),I=this.s,I!=null&&h.push(":",String(I))),(I=this.l)&&(this.g&&I.charAt(0)!="/"&&h.push("/"),h.push(Ui(I,I.charAt(0)=="/"?U_:V_,!0))),(I=this.i.toString())&&h.push("?",I),(I=this.m)&&h.push("#",Ui(I,zf)),h.join("")};function yr(h){return new Fi(h)}function Pa(h,v,I){h.j=I?Vi(v,!0):v,h.j&&(h.j=h.j.replace(/:$/,""))}function zn(h,v){if(v){if(v=Number(v),isNaN(v)||0>v)throw Error("Bad port number "+v);h.s=v}else h.s=null}function Bf(h,v,I){v instanceof ps?(h.i=v,Gc(h.i,h.h)):(I||(v=Ui(v,jc)),h.i=new ps(v,h.h))}function gt(h,v,I){h.i.set(v,I)}function jl(h){return gt(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function Vi(h,v){return h?v?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Ui(h,v,I){return typeof h=="string"?(h=encodeURI(h).replace(v,ka),I&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function ka(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Ra=/[#\/\?@]/g,V_=/[#\?:]/g,U_=/[#\?]/g,jc=/[#\?@]/g,zf=/#/g;function ps(h,v){this.h=this.g=null,this.i=h||null,this.j=!!v}function vr(h){h.g||(h.g=new Map,h.h=0,h.i&&Uf(h.i,function(v,I){h.add(decodeURIComponent(v.replace(/\+/g," ")),I)}))}n=ps.prototype,n.add=function(h,v){vr(this),this.i=null,h=gs(this,h);var I=this.g.get(h);return I||this.g.set(h,I=[]),I.push(v),this.h+=1,this};function jf(h,v){vr(h),v=gs(h,v),h.g.has(v)&&(h.i=null,h.h-=h.g.get(v).length,h.g.delete(v))}function Gl(h,v){return vr(h),v=gs(h,v),h.g.has(v)}n.forEach=function(h,v){vr(this),this.g.forEach(function(I,O){I.forEach(function(H){h.call(v,H,O,this)},this)},this)},n.na=function(){vr(this);const h=Array.from(this.g.values()),v=Array.from(this.g.keys()),I=[];for(let O=0;O<v.length;O++){const H=h[O];for(let K=0;K<H.length;K++)I.push(v[O])}return I},n.V=function(h){vr(this);let v=[];if(typeof h=="string")Gl(this,h)&&(v=v.concat(this.g.get(gs(this,h))));else{h=Array.from(this.g.values());for(let I=0;I<h.length;I++)v=v.concat(h[I])}return v},n.set=function(h,v){return vr(this),this.i=null,h=gs(this,h),Gl(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[v]),this.h+=1,this},n.get=function(h,v){return h?(h=this.V(h),0<h.length?String(h[0]):v):v};function $e(h,v,I){jf(h,v),0<I.length&&(h.i=null,h.g.set(gs(h,v),k(I)),h.h+=I.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],v=Array.from(this.g.keys());for(var I=0;I<v.length;I++){var O=v[I];const K=encodeURIComponent(String(O)),re=this.V(O);for(O=0;O<re.length;O++){var H=K;re[O]!==""&&(H+="="+encodeURIComponent(String(re[O]))),h.push(H)}}return this.i=h.join("&")};function gs(h,v){return v=String(v),h.j&&(v=v.toLowerCase()),v}function Gc(h,v){v&&!h.j&&(vr(h),h.i=null,h.g.forEach(function(I,O){var H=O.toLowerCase();O!=H&&(jf(this,O),$e(this,H,I))},h)),h.j=v}function Gf(h,v){const I=new ao;if(l.Image){const O=new Image;O.onload=E(Bi,I,"TestLoadImage: loaded",!0,v,O),O.onerror=E(Bi,I,"TestLoadImage: error",!1,v,O),O.onabort=E(Bi,I,"TestLoadImage: abort",!1,v,O),O.ontimeout=E(Bi,I,"TestLoadImage: timeout",!1,v,O),l.setTimeout(function(){O.ontimeout&&O.ontimeout()},1e4),O.src=h}else v(!1)}function B_(h,v){const I=new ao,O=new AbortController,H=setTimeout(()=>{O.abort(),Bi(I,"TestPingServer: timeout",!1,v)},1e4);fetch(h,{signal:O.signal}).then(K=>{clearTimeout(H),K.ok?Bi(I,"TestPingServer: ok",!0,v):Bi(I,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(H),Bi(I,"TestPingServer: error",!1,v)})}function Bi(h,v,I,O,H){try{H&&(H.onload=null,H.onerror=null,H.onabort=null,H.ontimeout=null),O(I)}catch{}}function $t(){this.g=new Af}function Wc(h,v,I){const O=I||"";try{xn(h,function(H,K){let re=H;d(H)&&(re=Ac(H)),v.push(O+K+"="+encodeURIComponent(re))})}catch(H){throw v.push(O+"type="+encodeURIComponent("_badmap")),H}}function Wl(h){this.l=h.Ub||null,this.j=h.eb||!1}S(Wl,Nc),Wl.prototype.g=function(){return new co(this.l,this.j)},Wl.prototype.i=function(h){return function(){return h}}({});function co(h,v){dn.call(this),this.D=h,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}S(co,dn),n=co.prototype,n.open=function(h,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=v,this.readyState=1,jn(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const v={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(v.body=h),(this.D||l).fetch(new Request(this.A,v)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,zi(this)),this.readyState=0},n.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,jn(this)),this.g&&(this.readyState=3,jn(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Wf(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function Wf(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}n.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var v=h.value?h.value:new Uint8Array(0);(v=this.v.decode(v,{stream:!h.done}))&&(this.response=this.responseText+=v)}h.done?zi(this):jn(this),this.readyState==3&&Wf(this)}},n.Ra=function(h){this.g&&(this.response=this.responseText=h,zi(this))},n.Qa=function(h){this.g&&(this.response=h,zi(this))},n.ga=function(){this.g&&zi(this)};function zi(h){h.readyState=4,h.l=null,h.j=null,h.v=null,jn(h)}n.setRequestHeader=function(h,v){this.u.append(h,v)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],v=this.h.entries();for(var I=v.next();!I.done;)I=I.value,h.push(I[0]+": "+I[1]),I=v.next();return h.join(`\r
`)};function jn(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(co.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Hf(h){let v="";return U(h,function(I,O){v+=O,v+=":",v+=I,v+=`\r
`}),v}function Hc(h,v,I){e:{for(O in I){var O=!1;break e}O=!0}O||(I=Hf(I),typeof h=="string"?I!=null&&encodeURIComponent(String(I)):gt(h,v,I))}function Qe(h){dn.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}S(Qe,dn);var hi=/^https?$/i,Hl=["POST","PUT"];n=Qe.prototype,n.Ha=function(h){this.J=h},n.ea=function(h,v,I,O){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);v=v?v.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Fc.g(),this.v=this.o?Nf(this.o):Nf(Fc),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(v,String(h),!0),this.B=!1}catch(K){$l(this,K);return}if(h=I||"",I=new Map(this.headers),O)if(Object.getPrototypeOf(O)===Object.prototype)for(var H in O)I.set(H,O[H]);else if(typeof O.keys=="function"&&typeof O.get=="function")for(const K of O.keys())I.set(K,O.get(K));else throw Error("Unknown input type for opt_headers: "+String(O));O=Array.from(I.keys()).find(K=>K.toLowerCase()=="content-type"),H=l.FormData&&h instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Hl,v,void 0))||O||H||I.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[K,re]of I)this.g.setRequestHeader(K,re);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ms(this),this.u=!0,this.g.send(h),this.u=!1}catch(K){$l(this,K)}};function $l(h,v){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=v,h.m=5,$c(h),ar(h)}function $c(h){h.A||(h.A=!0,Pn(h,"complete"),Pn(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,Pn(this,"complete"),Pn(this,"abort"),ar(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ar(this,!0)),Qe.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?$f(this):this.bb())},n.bb=function(){$f(this)};function $f(h){if(h.h&&typeof o<"u"&&(!h.v[1]||Gn(h)!=4||h.Z()!=2)){if(h.u&&Gn(h)==4)Pf(h.Ea,0,h);else if(Pn(h,"readystatechange"),Gn(h)==4){h.h=!1;try{const re=h.Z();e:switch(re){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var I;if(!(I=v)){var O;if(O=re===0){var H=String(h.D).match(Ia)[1]||null;!H&&l.self&&l.self.location&&(H=l.self.location.protocol.slice(0,-1)),O=!hi.test(H?H.toLowerCase():"")}I=O}if(I)Pn(h,"complete"),Pn(h,"success");else{h.m=6;try{var K=2<Gn(h)?h.g.statusText:""}catch{K=""}h.l=K+" ["+h.Z()+"]",$c(h)}}finally{ar(h)}}}}function ar(h,v){if(h.g){ms(h);const I=h.g,O=h.v[0]?()=>{}:null;h.g=null,h.v=null,v||Pn(h,"ready");try{I.onreadystatechange=O}catch{}}}function ms(h){h.I&&(l.clearTimeout(h.I),h.I=null)}n.isActive=function(){return!!this.g};function Gn(h){return h.g?h.g.readyState:0}n.Z=function(){try{return 2<Gn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(h){if(this.g){var v=this.g.responseText;return h&&v.indexOf(h)==0&&(v=v.substring(h.length)),O_(v)}};function xa(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function ql(h){const v={};h=(h.g&&2<=Gn(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let O=0;O<h.length;O++){if(R(h[O]))continue;var I=M(h[O]);const H=I[0];if(I=I[1],typeof I!="string")continue;I=I.trim();const K=v[H]||[];v[H]=K,K.push(I)}D(v,function(O){return O.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function fn(h,v,I){return I&&I.internalChannelParams&&I.internalChannelParams[h]||v}function lr(h){this.Aa=0,this.i=[],this.j=new ao,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=fn("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=fn("baseRetryDelayMs",5e3,h),this.cb=fn("retryDelaySeedMs",1e4,h),this.Wa=fn("forwardChannelMaxRetries",2,h),this.wa=fn("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new ds(h&&h.concurrentRequestLimit),this.Da=new $t,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=lr.prototype,n.la=8,n.G=1,n.connect=function(h,v,I,O){kn(0),this.W=h,this.H=v||{},I&&O!==void 0&&(this.H.OSID=I,this.H.OAID=O),this.F=this.X,this.I=Na(this,null,this.W),$r(this)};function di(h){if(Hr(h),h.G==3){var v=h.U++,I=yr(h.I);if(gt(I,"SID",h.K),gt(I,"RID",v),gt(I,"TYPE","terminate"),_s(h,I),v=new Li(h,h.j,v),v.L=2,v.v=jl(yr(I)),I=!1,l.navigator&&l.navigator.sendBeacon)try{I=l.navigator.sendBeacon(v.v.toString(),"")}catch{}!I&&l.Image&&(new Image().src=v.v,I=!0),I||(v.g=Qc(v.j,null),v.g.ea(v.v)),v.F=Date.now(),Bl(v)}Kc(h)}function wr(h){h.g&&(ys(h),h.g.cancel(),h.g=null)}function Hr(h){wr(h),h.u&&(l.clearTimeout(h.u),h.u=null),Aa(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&l.clearTimeout(h.s),h.s=null)}function $r(h){if(!ci(h.h)&&!h.s){h.s=!0;var v=h.Ga;De||ne(),Y||(De(),Y=!0),oe.add(v,h),h.B=0}}function qf(h,v){return ht(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=v.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=Ca(m(h.Ga,h,v),Ql(h,h.B)),h.B++,!0)}n.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const H=new Li(this,this.j,h);let K=this.o;if(this.S&&(K?(K=C(K),A(K,this.S)):K=this.S),this.m!==null||this.O||(H.H=K,K=null),this.P)e:{for(var v=0,I=0;I<this.i.length;I++){t:{var O=this.i[I];if("__data__"in O.map&&(O=O.map.__data__,typeof O=="string")){O=O.length;break t}O=void 0}if(O===void 0)break;if(v+=O,4096<v){v=I;break e}if(v===4096||I===this.i.length-1){v=I+1;break e}}v=1e3}else v=1e3;v=Wn(this,H,v),I=yr(this.I),gt(I,"RID",h),gt(I,"CVER",22),this.D&&gt(I,"X-HTTP-Session-Id",this.D),_s(this,I),K&&(this.O?v="headers="+encodeURIComponent(String(Hf(K)))+"&"+v:this.m&&Hc(I,this.m,K)),Wr(this.h,H),this.Ua&&gt(I,"TYPE","init"),this.P?(gt(I,"$req",v),gt(I,"SID","null"),H.T=!0,Uc(H,I,null)):Uc(H,I,v),this.G=2}}else this.G==3&&(h?Kl(this,h):this.i.length==0||ci(this.h)||Kl(this))};function Kl(h,v){var I;v?I=v.l:I=h.U++;const O=yr(h.I);gt(O,"SID",h.K),gt(O,"RID",I),gt(O,"AID",h.T),_s(h,O),h.m&&h.o&&Hc(O,h.m,h.o),I=new Li(h,h.j,I,h.B+1),h.m===null&&(I.H=h.o),v&&(h.i=v.D.concat(h.i)),v=Wn(h,I,1e3),I.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),Wr(h.h,I),Uc(I,O,v)}function _s(h,v){h.H&&U(h.H,function(I,O){gt(v,O,I)}),h.l&&xn({},function(I,O){gt(v,O,I)})}function Wn(h,v,I){I=Math.min(h.i.length,I);var O=h.l?m(h.l.Na,h.l,h):null;e:{var H=h.i;let K=-1;for(;;){const re=["count="+I];K==-1?0<I?(K=H[0].g,re.push("ofs="+K)):K=0:re.push("ofs="+K);let Ye=!0;for(let Bt=0;Bt<I;Bt++){let je=H[Bt].g;const nn=H[Bt].map;if(je-=K,0>je)K=Math.max(0,H[Bt].g-100),Ye=!1;else try{Wc(nn,re,"req"+je+"_")}catch{O&&O(nn)}}if(Ye){O=re.join("&");break e}}}return h=h.i.splice(0,I),v.D=h,O}function ur(h){if(!h.g&&!h.u){h.Y=1;var v=h.Fa;De||ne(),Y||(De(),Y=!0),oe.add(v,h),h.v=0}}function dt(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=Ca(m(h.Fa,h),Ql(h,h.v)),h.v++,!0)}n.Fa=function(){if(this.u=null,Er(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=Ca(m(this.ab,this),h)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,kn(10),wr(this),Er(this))};function ys(h){h.A!=null&&(l.clearTimeout(h.A),h.A=null)}function Er(h){h.g=new Li(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var v=yr(h.qa);gt(v,"RID","rpc"),gt(v,"SID",h.K),gt(v,"AID",h.T),gt(v,"CI",h.F?"0":"1"),!h.F&&h.ja&&gt(v,"TO",h.ja),gt(v,"TYPE","xmlhttp"),_s(h,v),h.m&&h.o&&Hc(v,h.m,h.o),h.L&&(h.g.I=h.L);var I=h.g;h=h.ia,I.L=1,I.v=jl(yr(v)),I.m=null,I.P=!0,Ff(I,h)}n.Za=function(){this.C!=null&&(this.C=null,wr(this),dt(this),kn(19))};function Aa(h){h.C!=null&&(l.clearTimeout(h.C),h.C=null)}function qc(h,v){var I=null;if(h.g==v){Aa(h),ys(h),h.g=null;var O=2}else if(at(h.h,v))I=v.D,tn(h.h,v),O=1;else return;if(h.G!=0){if(v.o)if(O==1){I=v.m?v.m.length:0,v=Date.now()-v.F;var H=h.B;O=Ml(),Pn(O,new bf(O,I)),$r(h)}else ur(h);else if(H=v.s,H==3||H==0&&0<v.X||!(O==1&&qf(h,v)||O==2&&dt(h)))switch(I&&0<I.length&&(v=h.h,v.i=v.i.concat(I)),H){case 1:fi(h,5);break;case 4:fi(h,10);break;case 3:fi(h,6);break;default:fi(h,2)}}}function Ql(h,v){let I=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(I*=2),I*v}function fi(h,v){if(h.j.info("Error code "+v),v==2){var I=m(h.fb,h),O=h.Xa;const H=!O;O=new Fi(O||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Pa(O,"https"),jl(O),H?Gf(O.toString(),I):B_(O.toString(),I)}else kn(2);h.G=0,h.l&&h.l.sa(v),Kc(h),Hr(h)}n.fb=function(h){h?(this.j.info("Successfully pinged google.com"),kn(2)):(this.j.info("Failed to ping google.com"),kn(1))};function Kc(h){if(h.G=0,h.ka=[],h.l){const v=Rn(h.h);(v.length!=0||h.i.length!=0)&&(N(h.ka,v),N(h.ka,h.i),h.h.i.length=0,k(h.i),h.i.length=0),h.l.ra()}}function Na(h,v,I){var O=I instanceof Fi?yr(I):new Fi(I);if(O.g!="")v&&(O.g=v+"."+O.g),zn(O,O.s);else{var H=l.location;O=H.protocol,v=v?v+"."+H.hostname:H.hostname,H=+H.port;var K=new Fi(null);O&&Pa(K,O),v&&(K.g=v),H&&zn(K,H),I&&(K.l=I),O=K}return I=h.D,v=h.ya,I&&v&&gt(O,I,v),gt(O,"VER",h.la),_s(h,O),O}function Qc(h,v,I){if(v&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return v=h.Ca&&!h.pa?new Qe(new Wl({eb:I})):new Qe(h.pa),v.Ha(h.J),v}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function vs(){}n=vs.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function ho(){}ho.prototype.g=function(h,v){return new cr(h,v)};function cr(h,v){dn.call(this),this.g=new lr(v),this.l=h,this.h=v&&v.messageUrlParams||null,h=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(h?h["X-WebChannel-Content-Type"]=v.messageContentType:h={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.va&&(h?h["X-WebChannel-Client-Profile"]=v.va:h={"X-WebChannel-Client-Profile":v.va}),this.g.S=h,(h=v&&v.Sb)&&!R(h)&&(this.g.m=h),this.v=v&&v.supportsCrossDomainXhr||!1,this.u=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!R(v)&&(this.g.D=v,h=this.h,h!==null&&v in h&&(h=this.h,v in h&&delete h[v])),this.j=new qr(this)}S(cr,dn),cr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},cr.prototype.close=function(){di(this.g)},cr.prototype.o=function(h){var v=this.g;if(typeof h=="string"){var I={};I.__data__=h,h=I}else this.u&&(I={},I.__data__=Ac(h),h=I);v.i.push(new zc(v.Ya++,h)),v.G==3&&$r(v)},cr.prototype.N=function(){this.g.l=null,delete this.j,di(this.g),delete this.g,cr.aa.N.call(this)};function Da(h){Dc.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var v=h.__sm__;if(v){e:{for(const I in v){h=I;break e}h=void 0}(this.i=h)&&(h=this.i,v=v!==null&&h in v?v[h]:void 0),this.data=v}else this.data=h}S(Da,Dc);function Kf(){bc.call(this),this.status=1}S(Kf,bc);function qr(h){this.g=h}S(qr,vs),qr.prototype.ua=function(){Pn(this.g,"a")},qr.prototype.ta=function(h){Pn(this.g,new Da(h))},qr.prototype.sa=function(h){Pn(this.g,new Kf)},qr.prototype.ra=function(){Pn(this.g,"b")},ho.prototype.createWebChannel=ho.prototype.g,cr.prototype.send=cr.prototype.o,cr.prototype.open=cr.prototype.m,cr.prototype.close=cr.prototype.close,ok=function(){return new ho},sk=function(){return Ml()},ik=Mi,B1={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Vl.NO_ERROR=0,Vl.TIMEOUT=8,Vl.HTTP_ERROR=6,yg=Vl,Of.COMPLETE="complete",rk=Of,Df.EventType=Ta,Ta.OPEN="a",Ta.CLOSE="b",Ta.ERROR="c",Ta.MESSAGE="d",dn.prototype.listen=dn.prototype.K,bh=Df,Qe.prototype.listenOnce=Qe.prototype.L,Qe.prototype.getLastError=Qe.prototype.Ka,Qe.prototype.getLastErrorCode=Qe.prototype.Ba,Qe.prototype.getStatus=Qe.prototype.Z,Qe.prototype.getResponseJson=Qe.prototype.Oa,Qe.prototype.getResponseText=Qe.prototype.oa,Qe.prototype.send=Qe.prototype.ea,Qe.prototype.setWithCredentials=Qe.prototype.Ha,nk=Qe}).apply(typeof Wp<"u"?Wp:typeof self<"u"?self:typeof window<"u"?window:{});const xC="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Jn.UNAUTHENTICATED=new Jn(null),Jn.GOOGLE_CREDENTIALS=new Jn("google-credentials-uid"),Jn.FIRST_PARTY=new Jn("first-party-uid"),Jn.MOCK_USER=new Jn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gc="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ul=new r0("@firebase/firestore");function yh(){return ul.logLevel}function _e(n,...e){if(ul.logLevel<=We.DEBUG){const t=e.map(zw);ul.debug(`Firestore (${gc}): ${n}`,...t)}}function Qs(n,...e){if(ul.logLevel<=We.ERROR){const t=e.map(zw);ul.error(`Firestore (${gc}): ${n}`,...t)}}function qu(n,...e){if(ul.logLevel<=We.WARN){const t=e.map(zw);ul.warn(`Firestore (${gc}): ${n}`,...t)}}function zw(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ee(n="Unexpected state"){const e=`FIRESTORE (${gc}) INTERNAL ASSERTION FAILED: `+n;throw Qs(e),new Error(e)}function Ze(n,e){n||Ee()}function Re(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ue extends eo{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class zO{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Jn.UNAUTHENTICATED))}shutdown(){}}class jO{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class GO{constructor(e){this.t=e,this.currentUser=Jn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ze(this.o===void 0);let r=this.i;const i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve();let s=new Bs;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Bs,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},l=c=>{_e("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(_e("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Bs)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(_e("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ze(typeof r.accessToken=="string"),new ak(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ze(e===null||typeof e=="string"),new Jn(e)}}class WO{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Jn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class HO{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new WO(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Jn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class $O{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class qO{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Ze(this.o===void 0);const r=s=>{s.error!=null&&_e("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,_e("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{_e("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):_e("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ze(typeof t.token=="string"),this.R=t.token,new $O(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KO(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lk{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=KO(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}}function nt(n,e){return n<e?-1:n>e?1:0}function Ku(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ue(X.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ue(X.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new ue(X.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ue(X.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return un.fromMillis(Date.now())}static fromDate(e){return un.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new un(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?nt(this.nanoseconds,e.nanoseconds):nt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Te(e)}static min(){return new Te(new un(0,0))}static max(){return new Te(new un(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pd{constructor(e,t,r){t===void 0?t=0:t>e.length&&Ee(),r===void 0?r=e.length-t:r>e.length-t&&Ee(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Pd.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Pd?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class yt extends Pd{construct(e,t,r){return new yt(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new ue(X.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new yt(t)}static emptyPath(){return new yt([])}}const QO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ln extends Pd{construct(e,t,r){return new Ln(e,t,r)}static isValidIdentifier(e){return QO.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ln.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Ln(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new ue(X.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new ue(X.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new ue(X.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else l==="`"?(o=!o,i++):l!=="."||o?(r+=l,i++):(s(),i++)}if(s(),o)throw new ue(X.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ln(t)}static emptyPath(){return new Ln([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{constructor(e){this.path=e}static fromPath(e){return new ve(yt.fromString(e))}static fromName(e){return new ve(yt.fromString(e).popFirst(5))}static empty(){return new ve(yt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&yt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return yt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ve(new yt(e.slice()))}}function YO(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Te.fromTimestamp(r===1e9?new un(t+1,0):new un(t,r));return new Jo(i,ve.empty(),e)}function XO(n){return new Jo(n.readTime,n.key,-1)}class Jo{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Jo(Te.min(),ve.empty(),-1)}static max(){return new Jo(Te.max(),ve.empty(),-1)}}function JO(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ve.comparator(n.documentKey,e.documentKey),t!==0?t:nt(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZO="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class eM{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nf(n){if(n.code!==X.FAILED_PRECONDITION||n.message!==ZO)throw n;_e("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ee(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new J((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof J?t:J.resolve(t)}catch(t){return J.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):J.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):J.reject(t)}static resolve(e){return new J((t,r)=>{t(e)})}static reject(e){return new J((t,r)=>{r(e)})}static waitFor(e){return new J((t,r)=>{let i=0,s=0,o=!1;e.forEach(l=>{++i,l.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=J.resolve(!1);for(const r of e)t=t.next(i=>i?J.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new J((r,i)=>{const s=e.length,o=new Array(s);let l=0;for(let c=0;c<s;c++){const d=c;t(e[d]).next(p=>{o[d]=p,++l,l===s&&r(o)},p=>i(p))}})}static doWhile(e,t){return new J((r,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}}function tM(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function rf(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jw{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ie(r),this.se=r=>t.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}jw.oe=-1;function sf(n){return n==null}function lm(n){return n===0&&1/n==-1/0}function nM(n){return typeof n=="number"&&Number.isInteger(n)&&!lm(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AC(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function wl(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function uk(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zt=class z1{constructor(e,t){this.comparator=e,this.root=t||Ho.EMPTY}insert(e,t){return new z1(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ho.BLACK,null,null))}remove(e){return new z1(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ho.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Hp(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Hp(this.root,e,this.comparator,!1)}getReverseIterator(){return new Hp(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Hp(this.root,e,this.comparator,!0)}},Hp=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Ho=class Is{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??Is.RED,this.left=i??Is.EMPTY,this.right=s??Is.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new Is(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Is.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Is.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Is.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Is.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ee();const e=this.left.check();if(e!==this.right.check())throw Ee();return e+(this.isRed()?0:1)}};Ho.EMPTY=null,Ho.RED=!0,Ho.BLACK=!1;Ho.EMPTY=new class{constructor(){this.size=0}get key(){throw Ee()}get value(){throw Ee()}get color(){throw Ee()}get left(){throw Ee()}get right(){throw Ee()}copy(e,t,r,i,s){return this}insert(e,t,r){return new Ho(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(e){this.comparator=e,this.data=new Zt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new NC(this.data.getIterator())}getIteratorFrom(e){return new NC(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Vn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Vn(this.comparator);return t.data=e,t}}class NC{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vr{constructor(e){this.fields=e,e.sort(Ln.comparator)}static empty(){return new Vr([])}unionWith(e){let t=new Vn(Ln.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Vr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ku(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ck extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new ck("Invalid base64 string: "+s):s}}(e);return new Bn(t)}static fromUint8Array(e){const t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Bn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return nt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Bn.EMPTY_BYTE_STRING=new Bn("");const rM=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Zo(n){if(Ze(!!n),typeof n=="string"){let e=0;const t=rM.exec(n);if(Ze(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:jt(n.seconds),nanos:jt(n.nanos)}}function jt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function cl(n){return typeof n=="string"?Bn.fromBase64String(n):Bn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gw(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Ww(n){const e=n.mapValue.fields.__previous_value__;return Gw(e)?Ww(e):e}function kd(n){const e=Zo(n.mapValue.fields.__local_write_time__.timestampValue);return new un(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iM{constructor(e,t,r,i,s,o,l,c,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=d}}class Rd{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Rd("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Rd&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $p={mapValue:{}};function hl(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Gw(n)?4:oM(n)?9007199254740991:sM(n)?10:11:Ee()}function is(n,e){if(n===e)return!0;const t=hl(n);if(t!==hl(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return kd(n).isEqual(kd(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Zo(i.timestampValue),l=Zo(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return cl(i.bytesValue).isEqual(cl(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return jt(i.geoPointValue.latitude)===jt(s.geoPointValue.latitude)&&jt(i.geoPointValue.longitude)===jt(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return jt(i.integerValue)===jt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=jt(i.doubleValue),l=jt(s.doubleValue);return o===l?lm(o)===lm(l):isNaN(o)&&isNaN(l)}return!1}(n,e);case 9:return Ku(n.arrayValue.values||[],e.arrayValue.values||[],is);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},l=s.mapValue.fields||{};if(AC(o)!==AC(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!is(o[c],l[c])))return!1;return!0}(n,e);default:return Ee()}}function xd(n,e){return(n.values||[]).find(t=>is(t,e))!==void 0}function Qu(n,e){if(n===e)return 0;const t=hl(n),r=hl(e);if(t!==r)return nt(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return nt(n.booleanValue,e.booleanValue);case 2:return function(s,o){const l=jt(s.integerValue||s.doubleValue),c=jt(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(n,e);case 3:return DC(n.timestampValue,e.timestampValue);case 4:return DC(kd(n),kd(e));case 5:return nt(n.stringValue,e.stringValue);case 6:return function(s,o){const l=cl(s),c=cl(o);return l.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){const l=s.split("/"),c=o.split("/");for(let d=0;d<l.length&&d<c.length;d++){const p=nt(l[d],c[d]);if(p!==0)return p}return nt(l.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){const l=nt(jt(s.latitude),jt(o.latitude));return l!==0?l:nt(jt(s.longitude),jt(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return bC(n.arrayValue,e.arrayValue);case 10:return function(s,o){var l,c,d,p;const _=s.fields||{},m=o.fields||{},E=(l=_.value)===null||l===void 0?void 0:l.arrayValue,S=(c=m.value)===null||c===void 0?void 0:c.arrayValue,k=nt(((d=E==null?void 0:E.values)===null||d===void 0?void 0:d.length)||0,((p=S==null?void 0:S.values)===null||p===void 0?void 0:p.length)||0);return k!==0?k:bC(E,S)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===$p.mapValue&&o===$p.mapValue)return 0;if(s===$p.mapValue)return 1;if(o===$p.mapValue)return-1;const l=s.fields||{},c=Object.keys(l),d=o.fields||{},p=Object.keys(d);c.sort(),p.sort();for(let _=0;_<c.length&&_<p.length;++_){const m=nt(c[_],p[_]);if(m!==0)return m;const E=Qu(l[c[_]],d[p[_]]);if(E!==0)return E}return nt(c.length,p.length)}(n.mapValue,e.mapValue);default:throw Ee()}}function DC(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return nt(n,e);const t=Zo(n),r=Zo(e),i=nt(t.seconds,r.seconds);return i!==0?i:nt(t.nanos,r.nanos)}function bC(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=Qu(t[i],r[i]);if(s)return s}return nt(t.length,r.length)}function Yu(n){return j1(n)}function j1(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=Zo(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return cl(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return ve.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=j1(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${j1(t.fields[o])}`;return i+"}"}(n.mapValue):Ee()}function OC(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function G1(n){return!!n&&"integerValue"in n}function Hw(n){return!!n&&"arrayValue"in n}function MC(n){return!!n&&"nullValue"in n}function LC(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function vg(n){return!!n&&"mapValue"in n}function sM(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Qh(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return wl(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Qh(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Qh(n.arrayValue.values[t]);return e}return Object.assign({},n)}function oM(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr{constructor(e){this.value=e}static empty(){return new fr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!vg(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Qh(t)}setAll(e){let t=Ln.emptyPath(),r={},i=[];e.forEach((o,l)=>{if(!t.isImmediateParentOf(l)){const c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=l.popLast()}o?r[l.lastSegment()]=Qh(o):i.push(l.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());vg(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return is(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];vg(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){wl(t,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new fr(Qh(this.value))}}function hk(n){const e=[];return wl(n.fields,(t,r)=>{const i=new Ln([t]);if(vg(r)){const s=hk(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Vr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn{constructor(e,t,r,i,s,o,l){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Tn(e,0,Te.min(),Te.min(),Te.min(),fr.empty(),0)}static newFoundDocument(e,t,r,i){return new Tn(e,1,t,Te.min(),r,i,0)}static newNoDocument(e,t){return new Tn(e,2,t,Te.min(),Te.min(),fr.empty(),0)}static newUnknownDocument(e,t){return new Tn(e,3,t,Te.min(),Te.min(),fr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Te.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=fr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=fr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Te.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Tn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Tn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class um{constructor(e,t){this.position=e,this.inclusive=t}}function FC(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],o=n.position[i];if(s.field.isKeyField()?r=ve.comparator(ve.fromName(o.referenceValue),t.key):r=Qu(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function VC(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!is(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ad{constructor(e,t="asc"){this.field=e,this.dir=t}}function aM(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dk{}class Jt extends dk{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new uM(e,t,r):t==="array-contains"?new dM(e,r):t==="in"?new fM(e,r):t==="not-in"?new pM(e,r):t==="array-contains-any"?new gM(e,r):new Jt(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new cM(e,r):new hM(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Qu(t,this.value)):t!==null&&hl(this.value)===hl(t)&&this.matchesComparison(Qu(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ee()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Di extends dk{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new Di(e,t)}matches(e){return fk(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function fk(n){return n.op==="and"}function pk(n){return lM(n)&&fk(n)}function lM(n){for(const e of n.filters)if(e instanceof Di)return!1;return!0}function W1(n){if(n instanceof Jt)return n.field.canonicalString()+n.op.toString()+Yu(n.value);if(pk(n))return n.filters.map(e=>W1(e)).join(",");{const e=n.filters.map(t=>W1(t)).join(",");return`${n.op}(${e})`}}function gk(n,e){return n instanceof Jt?function(r,i){return i instanceof Jt&&r.op===i.op&&r.field.isEqual(i.field)&&is(r.value,i.value)}(n,e):n instanceof Di?function(r,i){return i instanceof Di&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,l)=>s&&gk(o,i.filters[l]),!0):!1}(n,e):void Ee()}function mk(n){return n instanceof Jt?function(t){return`${t.field.canonicalString()} ${t.op} ${Yu(t.value)}`}(n):n instanceof Di?function(t){return t.op.toString()+" {"+t.getFilters().map(mk).join(" ,")+"}"}(n):"Filter"}class uM extends Jt{constructor(e,t,r){super(e,t,r),this.key=ve.fromName(r.referenceValue)}matches(e){const t=ve.comparator(e.key,this.key);return this.matchesComparison(t)}}class cM extends Jt{constructor(e,t){super(e,"in",t),this.keys=_k("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class hM extends Jt{constructor(e,t){super(e,"not-in",t),this.keys=_k("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function _k(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>ve.fromName(r.referenceValue))}class dM extends Jt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Hw(t)&&xd(t.arrayValue,this.value)}}class fM extends Jt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&xd(this.value.arrayValue,t)}}class pM extends Jt{constructor(e,t){super(e,"not-in",t)}matches(e){if(xd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!xd(this.value.arrayValue,t)}}class gM extends Jt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Hw(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>xd(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mM{constructor(e,t=null,r=[],i=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=l,this.ue=null}}function UC(n,e=null,t=[],r=[],i=null,s=null,o=null){return new mM(n,e,t,r,i,s,o)}function $w(n){const e=Re(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>W1(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),sf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Yu(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Yu(r)).join(",")),e.ue=t}return e.ue}function qw(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!aM(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!gk(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!VC(n.startAt,e.startAt)&&VC(n.endAt,e.endAt)}function H1(n){return ve.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mc{constructor(e,t=null,r=[],i=[],s=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function _M(n,e,t,r,i,s,o,l){return new mc(n,e,t,r,i,s,o,l)}function Kw(n){return new mc(n)}function BC(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function yk(n){return n.collectionGroup!==null}function Yh(n){const e=Re(n);if(e.ce===null){e.ce=[];const t=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Vn(Ln.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(l=l.add(d.field))})}),l})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Ad(s,r))}),t.has(Ln.keyField().canonicalString())||e.ce.push(new Ad(Ln.keyField(),r))}return e.ce}function rs(n){const e=Re(n);return e.le||(e.le=yM(e,Yh(n))),e.le}function yM(n,e){if(n.limitType==="F")return UC(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Ad(i.field,s)});const t=n.endAt?new um(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new um(n.startAt.position,n.startAt.inclusive):null;return UC(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function $1(n,e){const t=n.filters.concat([e]);return new mc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function q1(n,e,t){return new mc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function l0(n,e){return qw(rs(n),rs(e))&&n.limitType===e.limitType}function vk(n){return`${$w(rs(n))}|lt:${n.limitType}`}function lu(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>mk(i)).join(", ")}]`),sf(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Yu(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Yu(i)).join(",")),`Target(${r})`}(rs(n))}; limitType=${n.limitType})`}function u0(n,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):ve.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(const s of Yh(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,l,c){const d=FC(o,l,c);return o.inclusive?d<=0:d<0}(r.startAt,Yh(r),i)||r.endAt&&!function(o,l,c){const d=FC(o,l,c);return o.inclusive?d>=0:d>0}(r.endAt,Yh(r),i))}(n,e)}function vM(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function wk(n){return(e,t)=>{let r=!1;for(const i of Yh(n)){const s=wM(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function wM(n,e,t){const r=n.field.isKeyField()?ve.comparator(e.key,t.key):function(s,o,l){const c=o.data.field(s),d=l.data.field(s);return c!==null&&d!==null?Qu(c,d):Ee()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Ee()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){wl(this.inner,(t,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return uk(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EM=new Zt(ve.comparator);function Ys(){return EM}const Ek=new Zt(ve.comparator);function Oh(...n){let e=Ek;for(const t of n)e=e.insert(t.key,t);return e}function Sk(n){let e=Ek;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Qa(){return Xh()}function Tk(){return Xh()}function Xh(){return new _c(n=>n.toString(),(n,e)=>n.isEqual(e))}const SM=new Zt(ve.comparator),TM=new Vn(ve.comparator);function He(...n){let e=TM;for(const t of n)e=e.add(t);return e}const CM=new Vn(nt);function IM(){return CM}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qw(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:lm(e)?"-0":e}}function Ck(n){return{integerValue:""+n}}function PM(n,e){return nM(e)?Ck(e):Qw(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c0{constructor(){this._=void 0}}function kM(n,e,t){return n instanceof Nd?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Gw(s)&&(s=Ww(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof Dd?Pk(n,e):n instanceof bd?kk(n,e):function(i,s){const o=Ik(i,s),l=zC(o)+zC(i.Pe);return G1(o)&&G1(i.Pe)?Ck(l):Qw(i.serializer,l)}(n,e)}function RM(n,e,t){return n instanceof Dd?Pk(n,e):n instanceof bd?kk(n,e):t}function Ik(n,e){return n instanceof cm?function(r){return G1(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Nd extends c0{}class Dd extends c0{constructor(e){super(),this.elements=e}}function Pk(n,e){const t=Rk(e);for(const r of n.elements)t.some(i=>is(i,r))||t.push(r);return{arrayValue:{values:t}}}class bd extends c0{constructor(e){super(),this.elements=e}}function kk(n,e){let t=Rk(e);for(const r of n.elements)t=t.filter(i=>!is(i,r));return{arrayValue:{values:t}}}class cm extends c0{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function zC(n){return jt(n.integerValue||n.doubleValue)}function Rk(n){return Hw(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xM{constructor(e,t){this.field=e,this.transform=t}}function AM(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Dd&&i instanceof Dd||r instanceof bd&&i instanceof bd?Ku(r.elements,i.elements,is):r instanceof cm&&i instanceof cm?is(r.Pe,i.Pe):r instanceof Nd&&i instanceof Nd}(n.transform,e.transform)}class NM{constructor(e,t){this.version=e,this.transformResults=t}}class er{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new er}static exists(e){return new er(void 0,e)}static updateTime(e){return new er(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function wg(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class h0{}function xk(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new d0(n.key,er.none()):new of(n.key,n.data,er.none());{const t=n.data,r=fr.empty();let i=new Vn(Ln.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new ha(n.key,r,new Vr(i.toArray()),er.none())}}function DM(n,e,t){n instanceof of?function(i,s,o){const l=i.value.clone(),c=GC(i.fieldTransforms,s,o.transformResults);l.setAll(c),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):n instanceof ha?function(i,s,o){if(!wg(i.precondition,s))return void s.convertToUnknownDocument(o.version);const l=GC(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(Ak(i)),c.setAll(l),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Jh(n,e,t,r){return n instanceof of?function(s,o,l,c){if(!wg(s.precondition,o))return l;const d=s.value.clone(),p=WC(s.fieldTransforms,c,o);return d.setAll(p),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(n,e,t,r):n instanceof ha?function(s,o,l,c){if(!wg(s.precondition,o))return l;const d=WC(s.fieldTransforms,c,o),p=o.data;return p.setAll(Ak(s)),p.setAll(d),o.convertToFoundDocument(o.version,p).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(_=>_.field))}(n,e,t,r):function(s,o,l){return wg(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(n,e,t)}function bM(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=Ik(r.transform,i||null);s!=null&&(t===null&&(t=fr.empty()),t.set(r.field,s))}return t||null}function jC(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Ku(r,i,(s,o)=>AM(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class of extends h0{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ha extends h0{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Ak(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function GC(n,e,t){const r=new Map;Ze(n.length===t.length);for(let i=0;i<t.length;i++){const s=n[i],o=s.transform,l=e.data.field(s.field);r.set(s.field,RM(o,l,t[i]))}return r}function WC(n,e,t){const r=new Map;for(const i of n){const s=i.transform,o=t.data.field(i.field);r.set(i.field,kM(s,o,e))}return r}class d0 extends h0{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Nk extends h0{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OM{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&DM(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Jh(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Jh(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Tk();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=t.has(i.key)?null:l;const c=xk(o,l);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(Te.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),He())}isEqual(e){return this.batchId===e.batchId&&Ku(this.mutations,e.mutations,(t,r)=>jC(t,r))&&Ku(this.baseMutations,e.baseMutations,(t,r)=>jC(t,r))}}class Yw{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Ze(e.mutations.length===r.length);let i=function(){return SM}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new Yw(e,t,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MM{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LM{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qt,Xe;function Dk(n){switch(n){default:return Ee();case X.CANCELLED:case X.UNKNOWN:case X.DEADLINE_EXCEEDED:case X.RESOURCE_EXHAUSTED:case X.INTERNAL:case X.UNAVAILABLE:case X.UNAUTHENTICATED:return!1;case X.INVALID_ARGUMENT:case X.NOT_FOUND:case X.ALREADY_EXISTS:case X.PERMISSION_DENIED:case X.FAILED_PRECONDITION:case X.ABORTED:case X.OUT_OF_RANGE:case X.UNIMPLEMENTED:case X.DATA_LOSS:return!0}}function bk(n){if(n===void 0)return Qs("GRPC error has no .code"),X.UNKNOWN;switch(n){case Qt.OK:return X.OK;case Qt.CANCELLED:return X.CANCELLED;case Qt.UNKNOWN:return X.UNKNOWN;case Qt.DEADLINE_EXCEEDED:return X.DEADLINE_EXCEEDED;case Qt.RESOURCE_EXHAUSTED:return X.RESOURCE_EXHAUSTED;case Qt.INTERNAL:return X.INTERNAL;case Qt.UNAVAILABLE:return X.UNAVAILABLE;case Qt.UNAUTHENTICATED:return X.UNAUTHENTICATED;case Qt.INVALID_ARGUMENT:return X.INVALID_ARGUMENT;case Qt.NOT_FOUND:return X.NOT_FOUND;case Qt.ALREADY_EXISTS:return X.ALREADY_EXISTS;case Qt.PERMISSION_DENIED:return X.PERMISSION_DENIED;case Qt.FAILED_PRECONDITION:return X.FAILED_PRECONDITION;case Qt.ABORTED:return X.ABORTED;case Qt.OUT_OF_RANGE:return X.OUT_OF_RANGE;case Qt.UNIMPLEMENTED:return X.UNIMPLEMENTED;case Qt.DATA_LOSS:return X.DATA_LOSS;default:return Ee()}}(Xe=Qt||(Qt={}))[Xe.OK=0]="OK",Xe[Xe.CANCELLED=1]="CANCELLED",Xe[Xe.UNKNOWN=2]="UNKNOWN",Xe[Xe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Xe[Xe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Xe[Xe.NOT_FOUND=5]="NOT_FOUND",Xe[Xe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Xe[Xe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Xe[Xe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Xe[Xe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Xe[Xe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Xe[Xe.ABORTED=10]="ABORTED",Xe[Xe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Xe[Xe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Xe[Xe.INTERNAL=13]="INTERNAL",Xe[Xe.UNAVAILABLE=14]="UNAVAILABLE",Xe[Xe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FM(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VM=new el([4294967295,4294967295],0);function HC(n){const e=FM().encode(n),t=new tk;return t.update(e),new Uint8Array(t.digest())}function $C(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new el([t,r],0),new el([i,s],0)]}class Xw{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Mh(`Invalid padding: ${t}`);if(r<0)throw new Mh(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Mh(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Mh(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=el.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(el.fromNumber(r)));return i.compare(VM)===1&&(i=new el([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=HC(e),[r,i]=$C(t);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Xw(s,i,t);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const t=HC(e),[r,i]=$C(t);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Mh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f0{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,af.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new f0(Te.min(),i,new Zt(nt),Ys(),He())}}class af{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new af(r,t,He(),He(),He())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eg{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}}class Ok{constructor(e,t){this.targetId=e,this.me=t}}class Mk{constructor(e,t,r=Bn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class qC{constructor(){this.fe=0,this.ge=QC(),this.pe=Bn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=He(),t=He(),r=He();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Ee()}}),new af(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=QC()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Ze(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class UM{constructor(e){this.Le=e,this.Be=new Map,this.ke=Ys(),this.qe=KC(),this.Qe=new Zt(nt)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:Ee()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){const t=e.targetId,r=e.me.count,i=this.Je(t);if(i){const s=i.target;if(H1(s))if(r===0){const o=new ve(s.path);this.Ue(t,o,Tn.newNoDocument(o,Te.min()))}else Ze(r===1);else{const o=this.Ye(t);if(o!==r){const l=this.Ze(e),c=l?this.Xe(l,e,o):1;if(c!==0){this.je(t);const d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,d)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let o,l;try{o=cl(r).toUint8Array()}catch(c){if(c instanceof ck)return qu("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new Xw(o,i,s)}catch(c){return qu(c instanceof Mh?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let i=0;return r.forEach(s=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.Ue(t,s,null),i++)}),i}rt(e){const t=new Map;this.Be.forEach((s,o)=>{const l=this.Je(o);if(l){if(s.current&&H1(l.target)){const c=new ve(l.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,Tn.newNoDocument(c,e))}s.be&&(t.set(o,s.ve()),s.Ce())}});let r=He();this.qe.forEach((s,o)=>{let l=!0;o.forEachWhile(c=>{const d=this.Je(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new f0(e,t,this.Qe,this.ke,r);return this.ke=Ys(),this.qe=KC(),this.Qe=new Zt(nt),i}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new qC,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Vn(nt),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||_e("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new qC),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function KC(){return new Zt(ve.comparator)}function QC(){return new Zt(ve.comparator)}const BM={asc:"ASCENDING",desc:"DESCENDING"},zM={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},jM={and:"AND",or:"OR"};class GM{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function K1(n,e){return n.useProto3Json||sf(e)?e:{value:e}}function hm(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Lk(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function WM(n,e){return hm(n,e.toTimestamp())}function Br(n){return Ze(!!n),Te.fromTimestamp(function(t){const r=Zo(t);return new un(r.seconds,r.nanos)}(n))}function Jw(n,e){return Q1(n,e).canonicalString()}function Q1(n,e){const t=function(i){return new yt(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Fk(n){const e=yt.fromString(n);return Ze(Gk(e)),e}function dm(n,e){return Jw(n.databaseId,e.path)}function Zh(n,e){const t=Fk(e);if(t.get(1)!==n.databaseId.projectId)throw new ue(X.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ue(X.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ve(Uk(t))}function Vk(n,e){return Jw(n.databaseId,e)}function HM(n){const e=Fk(n);return e.length===4?yt.emptyPath():Uk(e)}function Y1(n){return new yt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Uk(n){return Ze(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function YC(n,e,t){return{name:dm(n,e),fields:t.value.mapValue.fields}}function $M(n,e){return"found"in e?function(r,i){Ze(!!i.found),i.found.name,i.found.updateTime;const s=Zh(r,i.found.name),o=Br(i.found.updateTime),l=i.found.createTime?Br(i.found.createTime):Te.min(),c=new fr({mapValue:{fields:i.found.fields}});return Tn.newFoundDocument(s,o,l,c)}(n,e):"missing"in e?function(r,i){Ze(!!i.missing),Ze(!!i.readTime);const s=Zh(r,i.missing),o=Br(i.readTime);return Tn.newNoDocument(s,o)}(n,e):Ee()}function qM(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Ee()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(d,p){return d.useProto3Json?(Ze(p===void 0||typeof p=="string"),Bn.fromBase64String(p||"")):(Ze(p===void 0||p instanceof Buffer||p instanceof Uint8Array),Bn.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(d){const p=d.code===void 0?X.UNKNOWN:bk(d.code);return new ue(p,d.message||"")}(o);t=new Mk(r,i,s,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Zh(n,r.document.name),s=Br(r.document.updateTime),o=r.document.createTime?Br(r.document.createTime):Te.min(),l=new fr({mapValue:{fields:r.document.fields}}),c=Tn.newFoundDocument(i,s,o,l),d=r.targetIds||[],p=r.removedTargetIds||[];t=new Eg(d,p,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Zh(n,r.document),s=r.readTime?Br(r.readTime):Te.min(),o=Tn.newNoDocument(i,s),l=r.removedTargetIds||[];t=new Eg([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Zh(n,r.document),s=r.removedTargetIds||[];t=new Eg([],s,i,null)}else{if(!("filter"in e))return Ee();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new LM(i,s),l=r.targetId;t=new Ok(l,o)}}return t}function Bk(n,e){let t;if(e instanceof of)t={update:YC(n,e.key,e.value)};else if(e instanceof d0)t={delete:dm(n,e.key)};else if(e instanceof ha)t={update:YC(n,e.key,e.data),updateMask:nL(e.fieldMask)};else{if(!(e instanceof Nk))return Ee();t={verify:dm(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const l=o.transform;if(l instanceof Nd)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Dd)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof bd)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof cm)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw Ee()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:WM(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ee()}(n,e.precondition)),t}function KM(n,e){return n&&n.length>0?(Ze(e!==void 0),n.map(t=>function(i,s){let o=i.updateTime?Br(i.updateTime):Br(s);return o.isEqual(Te.min())&&(o=Br(s)),new NM(o,i.transformResults||[])}(t,e))):[]}function QM(n,e){return{documents:[Vk(n,e.path)]}}function YM(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Vk(n,i);const s=function(d){if(d.length!==0)return jk(Di.create(d,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const o=function(d){if(d.length!==0)return d.map(p=>function(m){return{field:uu(m.field),direction:ZM(m.dir)}}(p))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=K1(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:t,parent:i}}function XM(n){let e=HM(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Ze(r===1);const p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];t.where&&(s=function(_){const m=zk(_);return m instanceof Di&&pk(m)?m.getFilters():[m]}(t.where));let o=[];t.orderBy&&(o=function(_){return _.map(m=>function(S){return new Ad(cu(S.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(S.direction))}(m))}(t.orderBy));let l=null;t.limit&&(l=function(_){let m;return m=typeof _=="object"?_.value:_,sf(m)?null:m}(t.limit));let c=null;t.startAt&&(c=function(_){const m=!!_.before,E=_.values||[];return new um(E,m)}(t.startAt));let d=null;return t.endAt&&(d=function(_){const m=!_.before,E=_.values||[];return new um(E,m)}(t.endAt)),_M(e,i,o,s,l,"F",c,d)}function JM(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ee()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function zk(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=cu(t.unaryFilter.field);return Jt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=cu(t.unaryFilter.field);return Jt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=cu(t.unaryFilter.field);return Jt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=cu(t.unaryFilter.field);return Jt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Ee()}}(n):n.fieldFilter!==void 0?function(t){return Jt.create(cu(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ee()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Di.create(t.compositeFilter.filters.map(r=>zk(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ee()}}(t.compositeFilter.op))}(n):Ee()}function ZM(n){return BM[n]}function eL(n){return zM[n]}function tL(n){return jM[n]}function uu(n){return{fieldPath:n.canonicalString()}}function cu(n){return Ln.fromServerFormat(n.fieldPath)}function jk(n){return n instanceof Jt?function(t){if(t.op==="=="){if(LC(t.value))return{unaryFilter:{field:uu(t.field),op:"IS_NAN"}};if(MC(t.value))return{unaryFilter:{field:uu(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(LC(t.value))return{unaryFilter:{field:uu(t.field),op:"IS_NOT_NAN"}};if(MC(t.value))return{unaryFilter:{field:uu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:uu(t.field),op:eL(t.op),value:t.value}}}(n):n instanceof Di?function(t){const r=t.getFilters().map(i=>jk(i));return r.length===1?r[0]:{compositeFilter:{op:tL(t.op),filters:r}}}(n):Ee()}function nL(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Gk(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo{constructor(e,t,r,i,s=Te.min(),o=Te.min(),l=Bn.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Oo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Oo(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Oo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Oo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rL{constructor(e){this.ct=e}}function iL(n){const e=XM({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?q1(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sL{constructor(){this.un=new oL}addToCollectionParentIndex(e,t){return this.un.add(t),J.resolve()}getCollectionParents(e,t){return J.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return J.resolve()}deleteFieldIndex(e,t){return J.resolve()}deleteAllFieldIndexes(e){return J.resolve()}createTargetIndexes(e,t){return J.resolve()}getDocumentsMatchingTarget(e,t){return J.resolve(null)}getIndexType(e,t){return J.resolve(0)}getFieldIndexes(e,t){return J.resolve([])}getNextCollectionGroupToUpdate(e){return J.resolve(null)}getMinOffset(e,t){return J.resolve(Jo.min())}getMinOffsetFromCollectionGroup(e,t){return J.resolve(Jo.min())}updateCollectionGroup(e,t,r){return J.resolve()}updateIndexEntries(e,t){return J.resolve()}}class oL{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Vn(yt.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Vn(yt.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xu{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Xu(0)}static kn(){return new Xu(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aL{constructor(){this.changes=new _c(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Tn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?J.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lL{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uL{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Jh(r.mutation,i,Vr.empty(),un.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,He()).next(()=>r))}getLocalViewOfDocuments(e,t,r=He()){const i=Qa();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=Oh();return s.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=Qa();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,He()))}populateOverlays(e,t,r){const i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,l)=>{t.set(o,l)})})}computeViews(e,t,r,i){let s=Ys();const o=Xh(),l=function(){return Xh()}();return t.forEach((c,d)=>{const p=r.get(d.key);i.has(d.key)&&(p===void 0||p.mutation instanceof ha)?s=s.insert(d.key,d):p!==void 0?(o.set(d.key,p.mutation.getFieldMask()),Jh(p.mutation,d,p.mutation.getFieldMask(),un.now())):o.set(d.key,Vr.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((d,p)=>o.set(d,p)),t.forEach((d,p)=>{var _;return l.set(d,new lL(p,(_=o.get(d))!==null&&_!==void 0?_:null))}),l))}recalculateAndSaveOverlays(e,t){const r=Xh();let i=new Zt((o,l)=>o-l),s=He();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const l of o)l.keys().forEach(c=>{const d=t.get(c);if(d===null)return;let p=r.get(c)||Vr.empty();p=l.applyToLocalView(d,p),r.set(c,p);const _=(i.get(l.batchId)||He()).add(c);i=i.insert(l.batchId,_)})}).next(()=>{const o=[],l=i.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),d=c.key,p=c.value,_=Tk();p.forEach(m=>{if(!s.has(m)){const E=xk(t.get(m),r.get(m));E!==null&&_.set(m,E),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,_))}return J.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return ve.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):yk(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):J.resolve(Qa());let l=-1,c=s;return o.next(d=>J.forEach(d,(p,_)=>(l<_.largestBatchId&&(l=_.largestBatchId),s.get(p)?J.resolve():this.remoteDocumentCache.getEntry(e,p).next(m=>{c=c.insert(p,m)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,c,d,He())).next(p=>({batchId:l,changes:Sk(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ve(t)).next(r=>{let i=Oh();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let o=Oh();return this.indexManager.getCollectionParents(e,s).next(l=>J.forEach(l,c=>{const d=function(_,m){return new mc(m,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)}(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(p=>{p.forEach((_,m)=>{o=o.insert(_,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((c,d)=>{const p=d.getKey();o.get(p)===null&&(o=o.insert(p,Tn.newInvalidDocument(p)))});let l=Oh();return o.forEach((c,d)=>{const p=s.get(c);p!==void 0&&Jh(p.mutation,d,Vr.empty(),un.now()),u0(t,d)&&(l=l.insert(c,d))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cL{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return J.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Br(i.createTime)}}(t)),J.resolve()}getNamedQuery(e,t){return J.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:iL(i.bundledQuery),readTime:Br(i.readTime)}}(t)),J.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hL{constructor(){this.overlays=new Zt(ve.comparator),this.Ir=new Map}getOverlay(e,t){return J.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Qa();return J.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),J.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),J.resolve()}getOverlaysForCollection(e,t,r){const i=Qa(),s=t.length+1,o=new ve(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,d=c.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return J.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Zt((d,p)=>d-p);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let p=s.get(d.largestBatchId);p===null&&(p=Qa(),s=s.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}const l=Qa(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,p)=>l.set(d,p)),!(l.size()>=i)););return J.resolve(l)}ht(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new MM(t,r));let s=this.Ir.get(t);s===void 0&&(s=He(),this.Ir.set(t,s)),this.Ir.set(t,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dL{constructor(){this.sessionToken=Bn.EMPTY_BYTE_STRING}getSessionToken(e){return J.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,J.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zw{constructor(){this.Tr=new Vn(vn.Er),this.dr=new Vn(vn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const r=new vn(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new vn(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){const t=new ve(new yt([])),r=new vn(t,e),i=new vn(t,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new ve(new yt([])),r=new vn(t,e),i=new vn(t,e+1);let s=He();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new vn(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class vn{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return ve.comparator(e.key,t.key)||nt(e.wr,t.wr)}static Ar(e,t){return nt(e.wr,t.wr)||ve.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fL{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Vn(vn.Er)}checkEmpty(e){return J.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new OM(s,t,r,i);this.mutationQueue.push(o);for(const l of i)this.br=this.br.add(new vn(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return J.resolve(o)}lookupMutationBatch(e,t){return J.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.vr(r),s=i<0?0:i;return J.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return J.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return J.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new vn(t,0),i=new vn(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{const l=this.Dr(o.wr);s.push(l)}),J.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Vn(nt);return t.forEach(i=>{const s=new vn(i,0),o=new vn(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],l=>{r=r.add(l.wr)})}),J.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;ve.isDocumentKey(s)||(s=s.child(""));const o=new vn(new ve(s),0);let l=new Vn(nt);return this.br.forEachWhile(c=>{const d=c.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(l=l.add(c.wr)),!0)},o),J.resolve(this.Cr(l))}Cr(e){const t=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){Ze(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return J.forEach(t.mutations,i=>{const s=new vn(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){const r=new vn(t,0),i=this.br.firstAfterOrEqual(r);return J.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,J.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pL{constructor(e){this.Mr=e,this.docs=function(){return new Zt(ve.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return J.resolve(r?r.document.mutableCopy():Tn.newInvalidDocument(t))}getEntries(e,t){let r=Ys();return t.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Tn.newInvalidDocument(i))}),J.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Ys();const o=t.path,l=new ve(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:d,value:{document:p}}=c.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||JO(XO(p),r)<=0||(i.has(p.key)||u0(t,p))&&(s=s.insert(p.key,p.mutableCopy()))}return J.resolve(s)}getAllFromCollectionGroup(e,t,r,i){Ee()}Or(e,t){return J.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new gL(this)}getSize(e){return J.resolve(this.size)}}class gL extends aL{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),J.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mL{constructor(e){this.persistence=e,this.Nr=new _c(t=>$w(t),qw),this.lastRemoteSnapshotVersion=Te.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Zw,this.targetCount=0,this.kr=Xu.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),J.resolve()}getLastRemoteSnapshotVersion(e){return J.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return J.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),J.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),J.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new Xu(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,J.resolve()}updateTargetData(e,t){return this.Kn(t),J.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,J.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=t&&r.get(l.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),J.waitFor(s).next(()=>i)}getTargetCount(e){return J.resolve(this.targetCount)}getTargetData(e,t){const r=this.Nr.get(t)||null;return J.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),J.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),J.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),J.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Br.yr(t);return J.resolve(r)}containsKey(e,t){return J.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _L{constructor(e,t){this.qr={},this.overlays={},this.Qr=new jw(0),this.Kr=!1,this.Kr=!0,this.$r=new dL,this.referenceDelegate=e(this),this.Ur=new mL(this),this.indexManager=new sL,this.remoteDocumentCache=function(i){return new pL(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new rL(t),this.Gr=new cL(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new hL,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new fL(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){_e("MemoryPersistence","Starting transaction:",e);const i=new yL(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,t){return J.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}}class yL extends eM{constructor(e){super(),this.currentSequenceNumber=e}}class eE{constructor(e){this.persistence=e,this.Jr=new Zw,this.Yr=null}static Zr(e){return new eE(e)}get Xr(){if(this.Yr)return this.Yr;throw Ee()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),J.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),J.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),J.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return J.forEach(this.Xr,r=>{const i=ve.fromPath(r);return this.ei(e,i).next(s=>{s||t.removeEntry(i,Te.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return J.or([()=>J.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tE{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=He(),i=He();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new tE(e,t.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vL{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wL{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return o7()?8:tM(ir())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.Yi(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new vL;return this.Xi(e,t,o).next(l=>{if(s.result=l,this.zi)return this.es(e,t,o,l.size)})}).next(()=>s.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(yh()<=We.DEBUG&&_e("QueryEngine","SDK will not create cache indexes for query:",lu(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),J.resolve()):(yh()<=We.DEBUG&&_e("QueryEngine","Query:",lu(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(yh()<=We.DEBUG&&_e("QueryEngine","The SDK decides to create cache indexes for query:",lu(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,rs(t))):J.resolve())}Yi(e,t){if(BC(t))return J.resolve(null);let r=rs(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=q1(t,null,"F"),r=rs(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=He(...s);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const d=this.ts(t,l);return this.ns(t,d,o,c.readTime)?this.Yi(e,q1(t,null,"F")):this.rs(e,d,t,c)}))})))}Zi(e,t,r,i){return BC(t)||i.isEqual(Te.min())?J.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const o=this.ts(t,s);return this.ns(t,o,r,i)?J.resolve(null):(yh()<=We.DEBUG&&_e("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),lu(t)),this.rs(e,o,t,YO(i,-1)).next(l=>l))})}ts(e,t){let r=new Vn(wk(e));return t.forEach((i,s)=>{u0(e,s)&&(r=r.add(s))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,t,r){return yh()<=We.DEBUG&&_e("QueryEngine","Using full collection scan to execute query:",lu(t)),this.Ji.getDocumentsMatchingQuery(e,t,Jo.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EL{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new Zt(nt),this._s=new _c(s=>$w(s),qw),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new uL(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function SL(n,e,t,r){return new EL(n,e,t,r)}async function Wk(n,e){const t=Re(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],l=[];let c=He();for(const d of i){o.push(d.batchId);for(const p of d.mutations)c=c.add(p.key)}for(const d of s){l.push(d.batchId);for(const p of d.mutations)c=c.add(p.key)}return t.localDocuments.getDocuments(r,c).next(d=>({hs:d,removedBatchIds:o,addedBatchIds:l}))})})}function TL(n,e){const t=Re(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,d,p){const _=d.batch,m=_.keys();let E=J.resolve();return m.forEach(S=>{E=E.next(()=>p.getEntry(c,S)).next(k=>{const N=d.docVersions.get(S);Ze(N!==null),k.version.compareTo(N)<0&&(_.applyToRemoteDocument(k,d),k.isValidDocument()&&(k.setReadTime(d.commitVersion),p.addEntry(k)))})}),E.next(()=>l.mutationQueue.removeMutationBatch(c,_))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=He();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(c=c.add(l.batch.mutations[d].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function Hk(n){const e=Re(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function CL(n,e){const t=Re(n),r=e.snapshotVersion;let i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;const l=[];e.targetChanges.forEach((p,_)=>{const m=i.get(_);if(!m)return;l.push(t.Ur.removeMatchingKeys(s,p.removedDocuments,_).next(()=>t.Ur.addMatchingKeys(s,p.addedDocuments,_)));let E=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(_)!==null?E=E.withResumeToken(Bn.EMPTY_BYTE_STRING,Te.min()).withLastLimboFreeSnapshotVersion(Te.min()):p.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(p.resumeToken,r)),i=i.insert(_,E),function(k,N,x){return k.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-k.snapshotVersion.toMicroseconds()>=3e8?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(m,E,p)&&l.push(t.Ur.updateTargetData(s,E))});let c=Ys(),d=He();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(s,p))}),l.push(IL(s,o,e.documentUpdates).next(p=>{c=p.Ps,d=p.Is})),!r.isEqual(Te.min())){const p=t.Ur.getLastRemoteSnapshotVersion(s).next(_=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));l.push(p)}return J.waitFor(l).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,d)).next(()=>c)}).then(s=>(t.os=i,s))}function IL(n,e,t){let r=He(),i=He();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=Ys();return t.forEach((l,c)=>{const d=s.get(l);c.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(l)),c.isNoDocument()&&c.version.isEqual(Te.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):_e("LocalStore","Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",c.version)}),{Ps:o,Is:i}})}function PL(n,e){const t=Re(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function kL(n,e){const t=Re(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(s=>s?(i=s,J.resolve(i)):t.Ur.allocateTargetId(r).next(o=>(i=new Oo(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}async function X1(n,e,t){const r=Re(n),i=r.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!rf(o))throw o;_e("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function XC(n,e,t){const r=Re(n);let i=Te.min(),s=He();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,d,p){const _=Re(c),m=_._s.get(p);return m!==void 0?J.resolve(_.os.get(m)):_.Ur.getTargetData(d,p)}(r,o,rs(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,l.targetId).next(c=>{s=c})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?i:Te.min(),t?s:He())).next(l=>(RL(r,vM(e),l),{documents:l,Ts:s})))}function RL(n,e,t){let r=n.us.get(e)||Te.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.us.set(e,r)}class JC{constructor(){this.activeTargetIds=IM()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class xL{constructor(){this.so=new JC,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new JC,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AL{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZC{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){_e("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){_e("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qp=null;function fv(){return qp===null?qp=function(){return 268435456+Math.round(2147483648*Math.random())}():qp++,"0x"+qp.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DL{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xn="WebChannelConnection";class bL extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(t,r,i,s,o){const l=fv(),c=this.xo(t,r.toUriEncodedString());_e("RestConnection",`Sending RPC '${t}' ${l}:`,c,i);const d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,s,o),this.No(t,c,d,i).then(p=>(_e("RestConnection",`Received RPC '${t}' ${l}: `,p),p),p=>{throw qu("RestConnection",`RPC '${t}' ${l} failed with error: `,p,"url: ",c,"request:",i),p})}Lo(t,r,i,s,o,l){return this.Mo(t,r,i,s,o)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+gc}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}xo(t,r){const i=NL[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){const s=fv();return new Promise((o,l)=>{const c=new nk;c.setWithCredentials(!0),c.listenOnce(rk.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case yg.NO_ERROR:const p=c.getResponseJson();_e(Xn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(p)),o(p);break;case yg.TIMEOUT:_e(Xn,`RPC '${e}' ${s} timed out`),l(new ue(X.DEADLINE_EXCEEDED,"Request time out"));break;case yg.HTTP_ERROR:const _=c.getStatus();if(_e(Xn,`RPC '${e}' ${s} failed with status:`,_,"response text:",c.getResponseText()),_>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);const E=m==null?void 0:m.error;if(E&&E.status&&E.message){const S=function(N){const x=N.toLowerCase().replace(/_/g,"-");return Object.values(X).indexOf(x)>=0?x:X.UNKNOWN}(E.status);l(new ue(S,E.message))}else l(new ue(X.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new ue(X.UNAVAILABLE,"Connection failed."));break;default:Ee()}}finally{_e(Xn,`RPC '${e}' ${s} completed.`)}});const d=JSON.stringify(i);_e(Xn,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",d,r,15)})}Bo(e,t,r){const i=fv(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=ok(),l=sk(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;const p=s.join("");_e(Xn,`Creating RPC '${e}' stream ${i}: ${p}`,c);const _=o.createWebChannel(p,c);let m=!1,E=!1;const S=new DL({Io:N=>{E?_e(Xn,`Not sending because RPC '${e}' stream ${i} is closed:`,N):(m||(_e(Xn,`Opening RPC '${e}' stream ${i} transport.`),_.open(),m=!0),_e(Xn,`RPC '${e}' stream ${i} sending:`,N),_.send(N))},To:()=>_.close()}),k=(N,x,R)=>{N.listen(x,w=>{try{R(w)}catch(P){setTimeout(()=>{throw P},0)}})};return k(_,bh.EventType.OPEN,()=>{E||(_e(Xn,`RPC '${e}' stream ${i} transport opened.`),S.yo())}),k(_,bh.EventType.CLOSE,()=>{E||(E=!0,_e(Xn,`RPC '${e}' stream ${i} transport closed`),S.So())}),k(_,bh.EventType.ERROR,N=>{E||(E=!0,qu(Xn,`RPC '${e}' stream ${i} transport errored:`,N),S.So(new ue(X.UNAVAILABLE,"The operation could not be completed")))}),k(_,bh.EventType.MESSAGE,N=>{var x;if(!E){const R=N.data[0];Ze(!!R);const w=R,P=w.error||((x=w[0])===null||x===void 0?void 0:x.error);if(P){_e(Xn,`RPC '${e}' stream ${i} received error:`,P);const F=P.status;let U=function(b){const A=Qt[b];if(A!==void 0)return bk(A)}(F),D=P.message;U===void 0&&(U=X.INTERNAL,D="Unknown error status: "+F+" with message "+P.message),E=!0,S.So(new ue(U,D)),_.close()}else _e(Xn,`RPC '${e}' stream ${i} received:`,R),S.bo(R)}}),k(l,ik.STAT_EVENT,N=>{N.stat===B1.PROXY?_e(Xn,`RPC '${e}' stream ${i} detected buffering proxy`):N.stat===B1.NOPROXY&&_e(Xn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{S.wo()},0),S}}function pv(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p0(n){return new GM(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nE{constructor(e,t,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&_e("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $k{constructor(e,t,r,i,s,o,l,c){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new nE(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===X.RESOURCE_EXHAUSTED?(Qs(t.toString()),Qs("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===X.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{const i=new ue(X.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){const r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return _e("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(_e("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class OL extends $k{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=qM(this.serializer,e),r=function(s){if(!("targetChange"in s))return Te.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Te.min():o.readTime?Br(o.readTime):Te.min()}(e);return this.listener.d_(t,r)}A_(e){const t={};t.database=Y1(this.serializer),t.addTarget=function(s,o){let l;const c=o.target;if(l=H1(c)?{documents:QM(s,c)}:{query:YM(s,c)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=Lk(s,o.resumeToken);const d=K1(s,o.expectedCount);d!==null&&(l.expectedCount=d)}else if(o.snapshotVersion.compareTo(Te.min())>0){l.readTime=hm(s,o.snapshotVersion.toTimestamp());const d=K1(s,o.expectedCount);d!==null&&(l.expectedCount=d)}return l}(this.serializer,e);const r=JM(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){const t={};t.database=Y1(this.serializer),t.removeTarget=e,this.a_(t)}}class ML extends $k{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Ze(!!e.streamToken),this.lastStreamToken=e.streamToken,Ze(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Ze(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=KM(e.writeResults,e.commitTime),r=Br(e.commitTime);return this.listener.g_(r,t)}p_(){const e={};e.database=Y1(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>Bk(this.serializer,r))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LL extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new ue(X.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,Q1(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===X.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ue(X.UNKNOWN,s.toString())})}Lo(e,t,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,Q1(t,r),i,o,l,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===X.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ue(X.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class FL{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Qs(t),this.D_=!1):_e("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VL{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(async()=>{El(this)&&(_e("RemoteStore","Restarting streams for network reachability change."),await async function(c){const d=Re(c);d.L_.add(4),await lf(d),d.q_.set("Unknown"),d.L_.delete(4),await g0(d)}(this))})}),this.q_=new FL(r,i)}}async function g0(n){if(El(n))for(const e of n.B_)await e(!0)}async function lf(n){for(const e of n.B_)await e(!1)}function qk(n,e){const t=Re(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),oE(t)?sE(t):yc(t).r_()&&iE(t,e))}function rE(n,e){const t=Re(n),r=yc(t);t.N_.delete(e),r.r_()&&Kk(t,e),t.N_.size===0&&(r.r_()?r.o_():El(t)&&t.q_.set("Unknown"))}function iE(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Te.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}yc(n).A_(e)}function Kk(n,e){n.Q_.xe(e),yc(n).R_(e)}function sE(n){n.Q_=new UM({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),yc(n).start(),n.q_.v_()}function oE(n){return El(n)&&!yc(n).n_()&&n.N_.size>0}function El(n){return Re(n).L_.size===0}function Qk(n){n.Q_=void 0}async function UL(n){n.q_.set("Online")}async function BL(n){n.N_.forEach((e,t)=>{iE(n,e)})}async function zL(n,e){Qk(n),oE(n)?(n.q_.M_(e),sE(n)):n.q_.set("Unknown")}async function jL(n,e,t){if(n.q_.set("Online"),e instanceof Mk&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const l of s.targetIds)i.N_.has(l)&&(await i.remoteSyncer.rejectListen(l,o),i.N_.delete(l),i.Q_.removeTarget(l))}(n,e)}catch(r){_e("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await fm(n,r)}else if(e instanceof Eg?n.Q_.Ke(e):e instanceof Ok?n.Q_.He(e):n.Q_.We(e),!t.isEqual(Te.min()))try{const r=await Hk(n.localStore);t.compareTo(r)>=0&&await function(s,o){const l=s.Q_.rt(o);return l.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){const p=s.N_.get(d);p&&s.N_.set(d,p.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,d)=>{const p=s.N_.get(c);if(!p)return;s.N_.set(c,p.withResumeToken(Bn.EMPTY_BYTE_STRING,p.snapshotVersion)),Kk(s,c);const _=new Oo(p.target,c,d,p.sequenceNumber);iE(s,_)}),s.remoteSyncer.applyRemoteEvent(l)}(n,t)}catch(r){_e("RemoteStore","Failed to raise snapshot:",r),await fm(n,r)}}async function fm(n,e,t){if(!rf(e))throw e;n.L_.add(1),await lf(n),n.q_.set("Offline"),t||(t=()=>Hk(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{_e("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await g0(n)})}function Yk(n,e){return e().catch(t=>fm(n,t,e))}async function m0(n){const e=Re(n),t=ea(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;GL(e);)try{const i=await PL(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,WL(e,i)}catch(i){await fm(e,i)}Xk(e)&&Jk(e)}function GL(n){return El(n)&&n.O_.length<10}function WL(n,e){n.O_.push(e);const t=ea(n);t.r_()&&t.V_&&t.m_(e.mutations)}function Xk(n){return El(n)&&!ea(n).n_()&&n.O_.length>0}function Jk(n){ea(n).start()}async function HL(n){ea(n).p_()}async function $L(n){const e=ea(n);for(const t of n.O_)e.m_(t.mutations)}async function qL(n,e,t){const r=n.O_.shift(),i=Yw.from(r,e,t);await Yk(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await m0(n)}async function KL(n,e){e&&ea(n).V_&&await async function(r,i){if(function(o){return Dk(o)&&o!==X.ABORTED}(i.code)){const s=r.O_.shift();ea(r).s_(),await Yk(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await m0(r)}}(n,e),Xk(n)&&Jk(n)}async function e3(n,e){const t=Re(n);t.asyncQueue.verifyOperationInProgress(),_e("RemoteStore","RemoteStore received new credentials");const r=El(t);t.L_.add(3),await lf(t),r&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await g0(t)}async function QL(n,e){const t=Re(n);e?(t.L_.delete(2),await g0(t)):e||(t.L_.add(2),await lf(t),t.q_.set("Unknown"))}function yc(n){return n.K_||(n.K_=function(t,r,i){const s=Re(t);return s.w_(),new OL(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:UL.bind(null,n),Ro:BL.bind(null,n),mo:zL.bind(null,n),d_:jL.bind(null,n)}),n.B_.push(async e=>{e?(n.K_.s_(),oE(n)?sE(n):n.q_.set("Unknown")):(await n.K_.stop(),Qk(n))})),n.K_}function ea(n){return n.U_||(n.U_=function(t,r,i){const s=Re(t);return s.w_(),new ML(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:HL.bind(null,n),mo:KL.bind(null,n),f_:$L.bind(null,n),g_:qL.bind(null,n)}),n.B_.push(async e=>{e?(n.U_.s_(),await m0(n)):(await n.U_.stop(),n.O_.length>0&&(_e("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))})),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aE{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Bs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const o=Date.now()+r,l=new aE(e,t,o,i,s);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ue(X.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function lE(n,e){if(Qs("AsyncQueue",`${e}: ${n}`),rf(n))return new ue(X.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou{constructor(e){this.comparator=e?(t,r)=>e(t,r)||ve.comparator(t.key,r.key):(t,r)=>ve.comparator(t.key,r.key),this.keyedMap=Oh(),this.sortedSet=new Zt(this.comparator)}static emptySet(e){return new Ou(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ou)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Ou;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t3{constructor(){this.W_=new Zt(ve.comparator)}track(e){const t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Ee():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}}class Ju{constructor(e,t,r,i,s,o,l,c,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,s){const o=[];return t.forEach(l=>{o.push({type:0,doc:l})}),new Ju(e,t,Ou.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&l0(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YL{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class XL{constructor(){this.queries=n3(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){const i=Re(t),s=i.queries;i.queries=n3(),s.forEach((o,l)=>{for(const c of l.j_)c.onError(r)})})(this,new ue(X.ABORTED,"Firestore shutting down"))}}function n3(){return new _c(n=>vk(n),l0)}async function Zk(n,e){const t=Re(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new YL,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await t.onListen(i,!0);break;case 1:s.z_=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const l=lE(o,`Initialization of query '${lu(e.query)}' failed`);return void e.onError(l)}t.queries.set(i,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&uE(t)}async function e9(n,e){const t=Re(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function JL(n,e){const t=Re(n);let r=!1;for(const i of e){const s=i.query,o=t.queries.get(s);if(o){for(const l of o.j_)l.X_(i)&&(r=!0);o.z_=i}}r&&uE(t)}function ZL(n,e,t){const r=Re(n),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(t);r.queries.delete(e)}function uE(n){n.Y_.forEach(e=>{e.next()})}var J1,r3;(r3=J1||(J1={})).ea="default",r3.Cache="cache";class t9{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Ju(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Ju.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==J1.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n9{constructor(e){this.key=e}}class r9{constructor(e){this.key=e}}class eF{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=He(),this.mutatedKeys=He(),this.Aa=wk(e),this.Ra=new Ou(this.Aa)}get Va(){return this.Ta}ma(e,t){const r=t?t.fa:new t3,i=t?t.Ra:this.Ra;let s=t?t.mutatedKeys:this.mutatedKeys,o=i,l=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,_)=>{const m=i.get(p),E=u0(this.query,_)?_:null,S=!!m&&this.mutatedKeys.has(m.key),k=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let N=!1;m&&E?m.data.isEqual(E.data)?S!==k&&(r.track({type:3,doc:E}),N=!0):this.ga(m,E)||(r.track({type:2,doc:E}),N=!0,(c&&this.Aa(E,c)>0||d&&this.Aa(E,d)<0)&&(l=!0)):!m&&E?(r.track({type:0,doc:E}),N=!0):m&&!E&&(r.track({type:1,doc:m}),N=!0,(c||d)&&(l=!0)),N&&(E?(o=o.add(E),s=k?s.add(p):s.delete(p)):(o=o.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const p=this.query.limitType==="F"?o.last():o.first();o=o.delete(p.key),s=s.delete(p.key),r.track({type:1,doc:p})}return{Ra:o,fa:r,ns:l,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((p,_)=>function(E,S){const k=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ee()}};return k(E)-k(S)}(p.type,_.type)||this.Aa(p.doc,_.doc)),this.pa(r),i=i!=null&&i;const l=t&&!i?this.ya():[],c=this.da.size===0&&this.current&&!i?1:0,d=c!==this.Ea;return this.Ea=c,o.length!==0||d?{snapshot:new Ju(this.query,e.Ra,s,o,e.mutatedKeys,c===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new t3,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=He(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const t=[];return e.forEach(r=>{this.da.has(r)||t.push(new r9(r))}),this.da.forEach(r=>{e.has(r)||t.push(new n9(r))}),t}ba(e){this.Ta=e.Ts,this.da=He();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Ju.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class tF{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class nF{constructor(e){this.key=e,this.va=!1}}class rF{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new _c(l=>vk(l),l0),this.Ma=new Map,this.xa=new Set,this.Oa=new Zt(ve.comparator),this.Na=new Map,this.La=new Zw,this.Ba={},this.ka=new Map,this.qa=Xu.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function iF(n,e,t=!0){const r=u9(n);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await i9(r,e,t,!0),i}async function sF(n,e){const t=u9(n);await i9(t,e,!0,!1)}async function i9(n,e,t,r){const i=await kL(n.localStore,rs(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t);let l;return r&&(l=await oF(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&qk(n.remoteStore,i),l}async function oF(n,e,t,r,i){n.Ka=(_,m,E)=>async function(k,N,x,R){let w=N.view.ma(x);w.ns&&(w=await XC(k.localStore,N.query,!1).then(({documents:D})=>N.view.ma(D,w)));const P=R&&R.targetChanges.get(N.targetId),F=R&&R.targetMismatches.get(N.targetId)!=null,U=N.view.applyChanges(w,k.isPrimaryClient,P,F);return s3(k,N.targetId,U.wa),U.snapshot}(n,_,m,E);const s=await XC(n.localStore,e,!0),o=new eF(e,s.Ts),l=o.ma(s.documents),c=af.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=o.applyChanges(l,n.isPrimaryClient,c);s3(n,t,d.wa);const p=new tF(e,t,o);return n.Fa.set(e,p),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),d.snapshot}async function aF(n,e,t){const r=Re(n),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!l0(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await X1(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&rE(r.remoteStore,i.targetId),Z1(r,i.targetId)}).catch(nf)):(Z1(r,i.targetId),await X1(r.localStore,i.targetId,!0))}async function lF(n,e){const t=Re(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),rE(t.remoteStore,r.targetId))}async function uF(n,e,t){const r=mF(n);try{const i=await function(o,l){const c=Re(o),d=un.now(),p=l.reduce((E,S)=>E.add(S.key),He());let _,m;return c.persistence.runTransaction("Locally write mutations","readwrite",E=>{let S=Ys(),k=He();return c.cs.getEntries(E,p).next(N=>{S=N,S.forEach((x,R)=>{R.isValidDocument()||(k=k.add(x))})}).next(()=>c.localDocuments.getOverlayedDocuments(E,S)).next(N=>{_=N;const x=[];for(const R of l){const w=bM(R,_.get(R.key).overlayedDocument);w!=null&&x.push(new ha(R.key,w,hk(w.value.mapValue),er.exists(!0)))}return c.mutationQueue.addMutationBatch(E,d,x,l)}).next(N=>{m=N;const x=N.applyToLocalDocumentSet(_,k);return c.documentOverlayCache.saveOverlays(E,N.batchId,x)})}).then(()=>({batchId:m.batchId,changes:Sk(_)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,l,c){let d=o.Ba[o.currentUser.toKey()];d||(d=new Zt(nt)),d=d.insert(l,c),o.Ba[o.currentUser.toKey()]=d}(r,i.batchId,t),await uf(r,i.changes),await m0(r.remoteStore)}catch(i){const s=lE(i,"Failed to persist write");t.reject(s)}}async function s9(n,e){const t=Re(n);try{const r=await CL(t.localStore,e);e.targetChanges.forEach((i,s)=>{const o=t.Na.get(s);o&&(Ze(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?Ze(o.va):i.removedDocuments.size>0&&(Ze(o.va),o.va=!1))}),await uf(t,r,e)}catch(r){await nf(r)}}function i3(n,e,t){const r=Re(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Fa.forEach((s,o)=>{const l=o.view.Z_(e);l.snapshot&&i.push(l.snapshot)}),function(o,l){const c=Re(o);c.onlineState=l;let d=!1;c.queries.forEach((p,_)=>{for(const m of _.j_)m.Z_(l)&&(d=!0)}),d&&uE(c)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function cF(n,e,t){const r=Re(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Na.get(e),s=i&&i.key;if(s){let o=new Zt(ve.comparator);o=o.insert(s,Tn.newNoDocument(s,Te.min()));const l=He().add(s),c=new f0(Te.min(),new Map,new Zt(nt),o,l);await s9(r,c),r.Oa=r.Oa.remove(s),r.Na.delete(e),cE(r)}else await X1(r.localStore,e,!1).then(()=>Z1(r,e,t)).catch(nf)}async function hF(n,e){const t=Re(n),r=e.batch.batchId;try{const i=await TL(t.localStore,e);a9(t,r,null),o9(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await uf(t,i)}catch(i){await nf(i)}}async function dF(n,e,t){const r=Re(n);try{const i=await function(o,l){const c=Re(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let p;return c.mutationQueue.lookupMutationBatch(d,l).next(_=>(Ze(_!==null),p=_.keys(),c.mutationQueue.removeMutationBatch(d,_))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,p,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p)).next(()=>c.localDocuments.getDocuments(d,p))})}(r.localStore,e);a9(r,e,t),o9(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await uf(r,i)}catch(i){await nf(i)}}function o9(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function a9(n,e,t){const r=Re(n);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Z1(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||l9(n,r)})}function l9(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(rE(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),cE(n))}function s3(n,e,t){for(const r of t)r instanceof n9?(n.La.addReference(r.key,e),fF(n,r)):r instanceof r9?(_e("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||l9(n,r.key)):Ee()}function fF(n,e){const t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(_e("SyncEngine","New document in limbo: "+t),n.xa.add(r),cE(n))}function cE(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new ve(yt.fromString(e)),r=n.qa.next();n.Na.set(r,new nF(t)),n.Oa=n.Oa.insert(t,r),qk(n.remoteStore,new Oo(rs(Kw(t.path)),r,"TargetPurposeLimboResolution",jw.oe))}}async function uf(n,e,t){const r=Re(n),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((l,c)=>{o.push(r.Ka(c,e,t).then(d=>{var p;if((d||t)&&r.isPrimaryClient){const _=d?!d.fromCache:(p=t==null?void 0:t.targetChanges.get(c.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(c.targetId,_?"current":"not-current")}if(d){i.push(d);const _=tE.Wi(c.targetId,d);s.push(_)}}))}),await Promise.all(o),r.Ca.d_(i),await async function(c,d){const p=Re(c);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",_=>J.forEach(d,m=>J.forEach(m.$i,E=>p.persistence.referenceDelegate.addReference(_,m.targetId,E)).next(()=>J.forEach(m.Ui,E=>p.persistence.referenceDelegate.removeReference(_,m.targetId,E)))))}catch(_){if(!rf(_))throw _;_e("LocalStore","Failed to update sequence numbers: "+_)}for(const _ of d){const m=_.targetId;if(!_.fromCache){const E=p.os.get(m),S=E.snapshotVersion,k=E.withLastLimboFreeSnapshotVersion(S);p.os=p.os.insert(m,k)}}}(r.localStore,s))}async function pF(n,e){const t=Re(n);if(!t.currentUser.isEqual(e)){_e("SyncEngine","User change. New user:",e.toKey());const r=await Wk(t.localStore,e);t.currentUser=e,function(s,o){s.ka.forEach(l=>{l.forEach(c=>{c.reject(new ue(X.CANCELLED,o))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await uf(t,r.hs)}}function gF(n,e){const t=Re(n),r=t.Na.get(e);if(r&&r.va)return He().add(r.key);{let i=He();const s=t.Ma.get(e);if(!s)return i;for(const o of s){const l=t.Fa.get(o);i=i.unionWith(l.view.Va)}return i}}function u9(n){const e=Re(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=s9.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=gF.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=cF.bind(null,e),e.Ca.d_=JL.bind(null,e.eventManager),e.Ca.$a=ZL.bind(null,e.eventManager),e}function mF(n){const e=Re(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=hF.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=dF.bind(null,e),e}class pm{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=p0(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return SL(this.persistence,new wL,e.initialUser,this.serializer)}Ga(e){return new _L(eE.Zr,this.serializer)}Wa(e){return new xL}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}pm.provider={build:()=>new pm};class e2{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>i3(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=pF.bind(null,this.syncEngine),await QL(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new XL}()}createDatastore(e){const t=p0(e.databaseInfo.databaseId),r=function(s){return new bL(s)}(e.databaseInfo);return function(s,o,l,c){return new LL(s,o,l,c)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,o,l){return new VL(r,i,s,o,l)}(this.localStore,this.datastore,e.asyncQueue,t=>i3(this.syncEngine,t,0),function(){return ZC.D()?new ZC:new AL}())}createSyncEngine(e,t){return function(i,s,o,l,c,d,p){const _=new rF(i,s,o,l,c,d);return p&&(_.Qa=!0),_}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const s=Re(i);_e("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await lf(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}e2.provider={build:()=>new e2};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c9{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Qs("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _F{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new ue(X.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(i,s){const o=Re(i),l={documents:s.map(_=>dm(o.serializer,_))},c=await o.Lo("BatchGetDocuments",o.serializer.databaseId,yt.emptyPath(),l,s.length),d=new Map;c.forEach(_=>{const m=$M(o.serializer,_);d.set(m.key.toString(),m)});const p=[];return s.forEach(_=>{const m=d.get(_.toString());Ze(!!m),p.push(m)}),p}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new d0(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{const i=ve.fromPath(r);this.mutations.push(new Nk(i,this.precondition(i)))}),await async function(r,i){const s=Re(r),o={writes:i.map(l=>Bk(s.serializer,l))};await s.Mo("Commit",s.serializer.databaseId,yt.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Ee();t=Te.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new ue(X.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Te.min())?er.exists(!1):er.updateTime(t):er.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Te.min()))throw new ue(X.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return er.updateTime(t)}return er.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yF{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this._u=r.maxAttempts,this.t_=new nE(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new _F(this.datastore),t=this.cu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.lu(i)}))}).catch(r=>{this.lu(r)})})}cu(e){try{const t=this.updateFunction(e);return!sf(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!Dk(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vF{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Jn.UNAUTHENTICATED,this.clientId=lk.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{_e("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(_e("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Bs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=lE(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function gv(n,e){n.asyncQueue.verifyOperationInProgress(),_e("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await Wk(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function o3(n,e){n.asyncQueue.verifyOperationInProgress();const t=await wF(n);_e("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>e3(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>e3(e.remoteStore,i)),n._onlineComponents=e}async function wF(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){_e("FirestoreClient","Using user provided OfflineComponentProvider");try{await gv(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===X.FAILED_PRECONDITION||i.code===X.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;qu("Error using user provided cache. Falling back to memory cache: "+t),await gv(n,new pm)}}else _e("FirestoreClient","Using default OfflineComponentProvider"),await gv(n,new pm);return n._offlineComponents}async function hE(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(_e("FirestoreClient","Using user provided OnlineComponentProvider"),await o3(n,n._uninitializedComponentsProvider._online)):(_e("FirestoreClient","Using default OnlineComponentProvider"),await o3(n,new e2))),n._onlineComponents}function EF(n){return hE(n).then(e=>e.syncEngine)}function SF(n){return hE(n).then(e=>e.datastore)}async function t2(n){const e=await hE(n),t=e.eventManager;return t.onListen=iF.bind(null,e.syncEngine),t.onUnlisten=aF.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=sF.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=lF.bind(null,e.syncEngine),t}function TF(n,e,t={}){const r=new Bs;return n.asyncQueue.enqueueAndForget(async()=>function(s,o,l,c,d){const p=new c9({next:m=>{p.Za(),o.enqueueAndForget(()=>e9(s,_)),m.fromCache&&c.source==="server"?d.reject(new ue(X.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),_=new t9(l,p,{includeMetadataChanges:!0,_a:!0});return Zk(s,_)}(await t2(n),n.asyncQueue,e,t,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h9(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a3=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d9(n,e,t){if(!t)throw new ue(X.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function CF(n,e,t,r){if(e===!0&&r===!0)throw new ue(X.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function l3(n){if(!ve.isDocumentKey(n))throw new ue(X.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function u3(n){if(ve.isDocumentKey(n))throw new ue(X.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function _0(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ee()}function ii(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ue(X.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=_0(n);throw new ue(X.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c3{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ue(X.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ue(X.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}CF("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=h9((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new ue(X.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ue(X.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ue(X.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class y0{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new c3({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ue(X.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ue(X.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new c3(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new zO;switch(r.type){case"firstParty":return new HO(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ue(X.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=a3.get(t);r&&(_e("ComponentProvider","Removing Datastore"),a3.delete(t),r.terminate())}(this),Promise.resolve()}}function f9(n,e,t,r={}){var i;const s=(n=ii(n,y0))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&qu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let l,c;if(typeof r.mockUserToken=="string")l=r.mockUserToken,c=Jn.MOCK_USER;else{l=fP(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);const d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new ue(X.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Jn(d)}n._authCredentials=new jO(new ak(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class da{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new da(this.firestore,e,this._query)}}class tr{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new $o(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new tr(this.firestore,e,this._key)}}class $o extends da{constructor(e,t,r){super(e,t,Kw(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new tr(this.firestore,null,new ve(e))}withConverter(e){return new $o(this.firestore,e,this._path)}}function cf(n,e,...t){if(n=vt(n),d9("collection","path",e),n instanceof y0){const r=yt.fromString(e,...t);return u3(r),new $o(n,null,r)}{if(!(n instanceof tr||n instanceof $o))throw new ue(X.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(yt.fromString(e,...t));return u3(r),new $o(n.firestore,null,r)}}function fa(n,e,...t){if(n=vt(n),arguments.length===1&&(e=lk.newId()),d9("doc","path",e),n instanceof y0){const r=yt.fromString(e,...t);return l3(r),new tr(n,null,new ve(r))}{if(!(n instanceof tr||n instanceof $o))throw new ue(X.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(yt.fromString(e,...t));return l3(r),new tr(n.firestore,n instanceof $o?n.converter:null,new ve(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h3{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new nE(this,"async_queue_retry"),this.Vu=()=>{const r=pv();r&&_e("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const t=pv();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=pv();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new Bs;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!rf(e))throw e;_e("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(r);throw Qs("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const i=aE.createAndSchedule(this,e,t,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&Ee()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function d3(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}class ta extends y0{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new h3,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new h3(e),this._firestoreClient=void 0,await e}}}function IF(n,e){const t=typeof n=="object"?n:xw(),r=typeof n=="string"?n:"(default)",i=i0(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=cP("firestore");s&&f9(i,...s)}return i}function v0(n){if(n._terminated)throw new ue(X.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||PF(n),n._firestoreClient}function PF(n){var e,t,r;const i=n._freezeSettings(),s=function(l,c,d,p){return new iM(l,c,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,h9(p.experimentalLongPollingOptions),p.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new vF(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new dl(Bn.fromBase64String(e))}catch(t){throw new ue(X.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new dl(Bn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hf{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ue(X.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ln(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w0{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dE{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ue(X.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ue(X.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return nt(this._lat,e._lat)||nt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fE{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kF=/^__.*__$/;class RF{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new ha(e,this.data,this.fieldMask,t,this.fieldTransforms):new of(e,this.data,t,this.fieldTransforms)}}class p9{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new ha(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function g9(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ee()}}class pE{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new pE(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return gm(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(g9(this.Cu)&&kF.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class xF{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||p0(e)}Qu(e,t,r,i=!1){return new pE({Cu:e,methodName:t,qu:r,path:Ln.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function E0(n){const e=n._freezeSettings(),t=p0(n._databaseId);return new xF(n._databaseId,!!e.ignoreUndefinedProperties,t)}function m9(n,e,t,r,i,s={}){const o=n.Qu(s.merge||s.mergeFields?2:0,e,t,i);mE("Data must be an object, but it was:",o,r);const l=v9(r,o);let c,d;if(s.merge)c=new Vr(o.fieldMask),d=o.fieldTransforms;else if(s.mergeFields){const p=[];for(const _ of s.mergeFields){const m=n2(e,_,t);if(!o.contains(m))throw new ue(X.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);E9(p,m)||p.push(m)}c=new Vr(p),d=o.fieldTransforms.filter(_=>c.covers(_.field))}else c=null,d=o.fieldTransforms;return new RF(new fr(l),c,d)}class S0 extends w0{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof S0}}class gE extends w0{_toFieldTransform(e){return new xM(e.path,new Nd)}isEqual(e){return e instanceof gE}}function _9(n,e,t,r){const i=n.Qu(1,e,t);mE("Data must be an object, but it was:",i,r);const s=[],o=fr.empty();wl(r,(c,d)=>{const p=_E(e,c,t);d=vt(d);const _=i.Nu(p);if(d instanceof S0)s.push(p);else{const m=df(d,_);m!=null&&(s.push(p),o.set(p,m))}});const l=new Vr(s);return new p9(o,l,i.fieldTransforms)}function y9(n,e,t,r,i,s){const o=n.Qu(1,e,t),l=[n2(e,r,t)],c=[i];if(s.length%2!=0)throw new ue(X.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)l.push(n2(e,s[m])),c.push(s[m+1]);const d=[],p=fr.empty();for(let m=l.length-1;m>=0;--m)if(!E9(d,l[m])){const E=l[m];let S=c[m];S=vt(S);const k=o.Nu(E);if(S instanceof S0)d.push(E);else{const N=df(S,k);N!=null&&(d.push(E),p.set(E,N))}}const _=new Vr(d);return new p9(p,_,o.fieldTransforms)}function AF(n,e,t,r=!1){return df(t,n.Qu(r?4:3,e))}function df(n,e){if(w9(n=vt(n)))return mE("Unsupported field value:",e,n),v9(n,e);if(n instanceof w0)return function(r,i){if(!g9(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const l of r){let c=df(l,i.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=vt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return PM(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=un.fromDate(r);return{timestampValue:hm(i.serializer,s)}}if(r instanceof un){const s=new un(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:hm(i.serializer,s)}}if(r instanceof dE)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof dl)return{bytesValue:Lk(i.serializer,r._byteString)};if(r instanceof tr){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Jw(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof fE)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return Qw(l.serializer,c)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${_0(r)}`)}(n,e)}function v9(n,e){const t={};return uk(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):wl(n,(r,i)=>{const s=df(i,e.Mu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function w9(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof un||n instanceof dE||n instanceof dl||n instanceof tr||n instanceof w0||n instanceof fE)}function mE(n,e,t){if(!w9(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const r=_0(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function n2(n,e,t){if((e=vt(e))instanceof hf)return e._internalPath;if(typeof e=="string")return _E(n,e);throw gm("Field path arguments must be of type string or ",n,!1,void 0,t)}const NF=new RegExp("[~\\*/\\[\\]]");function _E(n,e,t){if(e.search(NF)>=0)throw gm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new hf(...e.split("."))._internalPath}catch{throw gm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function gm(n,e,t,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new ue(X.INVALID_ARGUMENT,l+n+c)}function E9(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mm{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new tr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new DF(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(T0("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class DF extends mm{data(){return super.data()}}function T0(n,e){return typeof e=="string"?_E(n,e):e instanceof hf?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S9(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ue(X.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class yE{}class T9 extends yE{}function C9(n,e,...t){let r=[];e instanceof yE&&r.push(e),r=r.concat(t),function(s){const o=s.filter(c=>c instanceof vE).length,l=s.filter(c=>c instanceof C0).length;if(o>1||o>0&&l>0)throw new ue(X.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class C0 extends T9{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new C0(e,t,r)}_apply(e){const t=this._parse(e);return I9(e._query,t),new da(e.firestore,e.converter,$1(e._query,t))}_parse(e){const t=E0(e.firestore);return function(s,o,l,c,d,p,_){let m;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new ue(X.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){p3(_,p);const E=[];for(const S of _)E.push(f3(c,s,S));m={arrayValue:{values:E}}}else m=f3(c,s,_)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||p3(_,p),m=AF(l,o,_,p==="in"||p==="not-in");return Jt.create(d,p,m)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function bF(n,e,t){const r=e,i=T0("where",n);return C0._create(i,r,t)}class vE extends yE{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new vE(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Di.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i;const l=s.getFlattenedFilters();for(const c of l)I9(o,c),o=$1(o,c)}(e._query,t),new da(e.firestore,e.converter,$1(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class wE extends T9{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new wE(e,t)}_apply(e){const t=function(i,s,o){if(i.startAt!==null)throw new ue(X.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new ue(X.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ad(s,o)}(e._query,this._field,this._direction);return new da(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new mc(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}function OF(n,e="asc"){const t=e,r=T0("orderBy",n);return wE._create(r,t)}function f3(n,e,t){if(typeof(t=vt(t))=="string"){if(t==="")throw new ue(X.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!yk(e)&&t.indexOf("/")!==-1)throw new ue(X.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(yt.fromString(t));if(!ve.isDocumentKey(r))throw new ue(X.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return OC(n,new ve(r))}if(t instanceof tr)return OC(n,t._key);throw new ue(X.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${_0(t)}.`)}function p3(n,e){if(!Array.isArray(n)||n.length===0)throw new ue(X.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function I9(n,e){const t=function(i,s){for(const o of i)for(const l of o.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new ue(X.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ue(X.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class P9{convertValue(e,t="none"){switch(hl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return jt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(cl(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ee()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return wl(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;const s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>jt(o.doubleValue));return new fE(s)}convertGeoPoint(e){return new dE(jt(e.latitude),jt(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Ww(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(kd(e));default:return null}}convertTimestamp(e){const t=Zo(e);return new un(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=yt.fromString(e);Ze(Gk(r));const i=new Rd(r.get(1),r.get(3)),s=new ve(r.popFirst(5));return i.isEqual(t)||Qs(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k9(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class MF extends P9{constructor(e){super(),this.firestore=e}convertBytes(e){return new dl(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new tr(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class EE extends mm{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Sg(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(T0("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class Sg extends EE{data(e={}){return super.data(e)}}class R9{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Tu(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Sg(this._firestore,this._userDataWriter,r.key,r,new Tu(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ue(X.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(l=>{const c=new Sg(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Tu(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const c=new Sg(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Tu(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,p=-1;return l.type!==0&&(d=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),p=o.indexOf(l.doc.key)),{type:LF(l.type),doc:c,oldIndex:d,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function LF(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ee()}}class I0 extends P9{constructor(e){super(),this.firestore=e}convertBytes(e){return new dl(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new tr(this.firestore,null,t)}}function SE(n){n=ii(n,da);const e=ii(n.firestore,ta),t=v0(e),r=new I0(e);return S9(n._query),TF(t,n._query).then(i=>new R9(e,r,n,i))}function FF(n,e,t){n=ii(n,tr);const r=ii(n.firestore,ta),i=k9(n.converter,e,t);return TE(r,[m9(E0(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,er.none())])}function x9(n,e,t,...r){n=ii(n,tr);const i=ii(n.firestore,ta),s=E0(i);let o;return o=typeof(e=vt(e))=="string"||e instanceof hf?y9(s,"updateDoc",n._key,e,t,r):_9(s,"updateDoc",n._key,e),TE(i,[o.toMutation(n._key,er.exists(!0))])}function A9(n){return TE(ii(n.firestore,ta),[new d0(n._key,er.none())])}function VF(n,...e){var t,r,i;n=vt(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||d3(e[o])||(s=e[o],o++);const l={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(d3(e[o])){const _=e[o];e[o]=(t=_.next)===null||t===void 0?void 0:t.bind(_),e[o+1]=(r=_.error)===null||r===void 0?void 0:r.bind(_),e[o+2]=(i=_.complete)===null||i===void 0?void 0:i.bind(_)}let c,d,p;if(n instanceof tr)d=ii(n.firestore,ta),p=Kw(n._key.path),c={next:_=>{e[o]&&e[o](UF(d,n,_))},error:e[o+1],complete:e[o+2]};else{const _=ii(n,da);d=ii(_.firestore,ta),p=_._query;const m=new I0(d);c={next:E=>{e[o]&&e[o](new R9(d,m,_,E))},error:e[o+1],complete:e[o+2]},S9(n._query)}return function(m,E,S,k){const N=new c9(k),x=new t9(E,N,S);return m.asyncQueue.enqueueAndForget(async()=>Zk(await t2(m),x)),()=>{N.Za(),m.asyncQueue.enqueueAndForget(async()=>e9(await t2(m),x))}}(v0(d),p,l,c)}function TE(n,e){return function(r,i){const s=new Bs;return r.asyncQueue.enqueueAndForget(async()=>uF(await EF(r),i,s)),s.promise}(v0(n),e)}function UF(n,e,t){const r=t.docs.get(e._key),i=new I0(n);return new EE(n,i,e._key,r,new Tu(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BF={maxAttempts:5};function vh(n,e){if((n=vt(n)).firestore!==e)throw new ue(X.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zF extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=E0(t)}get(t){const r=vh(t,this._firestore),i=new MF(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return Ee();const o=s[0];if(o.isFoundDocument())return new mm(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new mm(this._firestore,i,r._key,null,r.converter);throw Ee()})}set(t,r,i){const s=vh(t,this._firestore),o=k9(s.converter,r,i),l=m9(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,l),this}update(t,r,i,...s){const o=vh(t,this._firestore);let l;return l=typeof(r=vt(r))=="string"||r instanceof hf?y9(this._dataReader,"Transaction.update",o._key,r,i,s):_9(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,l),this}delete(t){const r=vh(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=vh(e,this._firestore),r=new I0(this._firestore);return super.get(e).then(i=>new EE(this._firestore,r,t._key,i._document,new Tu(!1,!1),t.converter))}}function CE(n,e,t){n=ii(n,ta);const r=Object.assign(Object.assign({},BF),t);return function(s){if(s.maxAttempts<1)throw new ue(X.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,l){const c=new Bs;return s.asyncQueue.enqueueAndForget(async()=>{const d=await SF(s);new yF(s.asyncQueue,d,l,o,c).au()}),c.promise}(v0(n),i=>e(new zF(n,i)),r)}function Zu(){return new gE("serverTimestamp")}(function(e,t=!0){(function(i){gc=i})(vl),ol(new Xo("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),l=new ta(new GO(r.getProvider("auth-internal")),new qO(r.getProvider("app-check-internal")),function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new ue(X.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Rd(d.options.projectId,p)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),ts(xC,"4.7.3",e),ts(xC,"4.7.3","esm2017")})();var g3={};const m3="@firebase/database",_3="1.0.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let N9="";function jF(n){N9=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GF{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Cn(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:Sd(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WF{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return ss(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D9=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new GF(e)}}catch{}return new WF},Ya=D9("localStorage"),HF=D9("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mu=new r0("@firebase/database"),$F=function(){let n=1;return function(){return n++}}(),b9=function(n){const e=y7(n),t=new p7;t.update(e);const r=t.digest();return Pw.encodeByteArray(r)},ff=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=ff.apply(null,r):typeof r=="object"?e+=Cn(r):e+=r,e+=" "}return e};let ed=null,y3=!0;const qF=function(n,e){ie(!0,"Can't turn on custom loggers persistently."),Mu.logLevel=We.VERBOSE,ed=Mu.log.bind(Mu)},Mn=function(...n){if(y3===!0&&(y3=!1,ed===null&&HF.get("logging_enabled")===!0&&qF()),ed){const e=ff.apply(null,n);ed(e)}},pf=function(n){return function(...e){Mn(n,...e)}},r2=function(...n){const e="FIREBASE INTERNAL ERROR: "+ff(...n);Mu.error(e)},Xs=function(...n){const e=`FIREBASE FATAL ERROR: ${ff(...n)}`;throw Mu.error(e),new Error(e)},br=function(...n){const e="FIREBASE WARNING: "+ff(...n);Mu.warn(e)},KF=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&br("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},P0=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},QF=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},ec="[MIN_NAME]",fl="[MAX_NAME]",Sl=function(n,e){if(n===e)return 0;if(n===ec||e===fl)return-1;if(e===ec||n===fl)return 1;{const t=v3(n),r=v3(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},YF=function(n,e){return n===e?0:n<e?-1:1},wh=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+Cn(e))},IE=function(n){if(typeof n!="object"||n===null)return Cn(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=Cn(e[r]),t+=":",t+=IE(n[e[r]]);return t+="}",t},O9=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function sr(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const M9=function(n){ie(!P0(n),"Invalid JSON number");const e=11,t=52,r=(1<<e-1)-1;let i,s,o,l,c;n===0?(s=0,o=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(l=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=l+r,o=Math.round(n*Math.pow(2,t-l)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-r-t))));const d=[];for(c=t;c;c-=1)d.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)d.push(s%2?1:0),s=Math.floor(s/2);d.push(i?1:0),d.reverse();const p=d.join("");let _="";for(c=0;c<64;c+=8){let m=parseInt(p.substr(c,8),2).toString(16);m.length===1&&(m="0"+m),_=_+m}return _.toLowerCase()},XF=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},JF=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function ZF(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");const r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}const eV=new RegExp("^-?(0*)\\d{1,10}$"),tV=-2147483648,nV=2147483647,v3=function(n){if(eV.test(n)){const e=Number(n);if(e>=tV&&e<=nV)return e}return null},vc=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw br("Exception was thrown by user callback.",t),e},Math.floor(0))}},rV=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},td=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iV{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){br(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sV{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(Mn("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',br(e)}}class Tg{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Tg.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PE="5",L9="v",F9="s",V9="r",U9="f",B9=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,z9="ls",j9="p",i2="ac",G9="websocket",W9="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H9{constructor(e,t,r,i,s=!1,o="",l=!1,c=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=l,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Ya.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Ya.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function oV(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function $9(n,e,t){ie(typeof e=="string","typeof type must == string"),ie(typeof t=="object","typeof params must == object");let r;if(e===G9)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===W9)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);oV(n)&&(t.ns=n.namespace);const i=[];return sr(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aV{constructor(){this.counters_={}}incrementCounter(e,t=1){ss(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return QN(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mv={},_v={};function kE(n){const e=n.toString();return mv[e]||(mv[e]=new aV),mv[e]}function lV(n,e){const t=n.toString();return _v[t]||(_v[t]=e()),_v[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uV{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&vc(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w3="start",cV="close",hV="pLPCommand",dV="pRTLPCB",q9="id",K9="pw",Q9="ser",fV="cb",pV="seg",gV="ts",mV="d",_V="dframe",Y9=1870,X9=30,yV=Y9-X9,vV=25e3,wV=3e4;class Cu{constructor(e,t,r,i,s,o,l){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=l,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=pf(e),this.stats_=kE(t),this.urlFn=c=>(this.appCheckToken&&(c[i2]=this.appCheckToken),$9(t,W9,c))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new uV(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(wV)),QF(()=>{if(this.isClosed_)return;this.scriptTagHolder=new RE((...s)=>{const[o,l,c,d,p]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===w3)this.id=l,this.password=c;else if(o===cV)l?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(l,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{const[o,l]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,l)},()=>{this.onClosed_()},this.urlFn);const r={};r[w3]="t",r[Q9]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[fV]=this.scriptTagHolder.uniqueCallbackIdentifier),r[L9]=PE,this.transportSessionId&&(r[F9]=this.transportSessionId),this.lastSessionId&&(r[z9]=this.lastSessionId),this.applicationId&&(r[j9]=this.applicationId),this.appCheckToken&&(r[i2]=this.appCheckToken),typeof location<"u"&&location.hostname&&B9.test(location.hostname)&&(r[V9]=U9);const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Cu.forceAllow_=!0}static forceDisallow(){Cu.forceDisallow_=!0}static isAvailable(){return Cu.forceAllow_?!0:!Cu.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!XF()&&!JF()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=Cn(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=aP(t),i=O9(r,yV);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const r={};r[_V]="t",r[q9]=e,r[K9]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=Cn(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class RE{constructor(e,t,r,i){this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=$F(),window[hV+this.uniqueCallbackIdentifier]=e,window[dV+this.uniqueCallbackIdentifier]=t,this.myIFrame=RE.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(l){Mn("frame writing exception"),l.stack&&Mn(l.stack),Mn(l)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Mn("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[q9]=this.myID,e[K9]=this.myPW,e[Q9]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+X9+r.length<=Y9;){const o=this.pendingSegs.shift();r=r+"&"+pV+i+"="+o.seg+"&"+gV+i+"="+o.ts+"&"+mV+i+"="+o.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(vV)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{Mn("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EV=16384,SV=45e3;let _m=null;typeof MozWebSocket<"u"?_m=MozWebSocket:typeof WebSocket<"u"&&(_m=WebSocket);class Ti{constructor(e,t,r,i,s,o,l){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=pf(this.connId),this.stats_=kE(t),this.connURL=Ti.connectionURL_(t,o,l,i,r),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,r,i,s){const o={};return o[L9]=PE,typeof location<"u"&&location.hostname&&B9.test(location.hostname)&&(o[V9]=U9),t&&(o[F9]=t),r&&(o[z9]=r),i&&(o[i2]=i),s&&(o[j9]=s),$9(e,G9,o)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Ya.set("previous_websocket_failure",!0);try{let r;s7(),this.mySock=new _m(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){Ti.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(t);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&_m!==null&&!Ti.forceDisallow_}static previouslyFailed(){return Ya.isInMemoryStorage||Ya.get("previous_websocket_failure")===!0}markConnectionHealthy(){Ya.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const r=Sd(t);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(ie(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const r=this.extractFrameCount_(t);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const t=Cn(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=O9(t,EV);r.length>1&&this.sendString_(String(r.length));for(let i=0;i<r.length;i++)this.sendString_(r[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(SV))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Ti.responsesRequiredToBeHealthy=2;Ti.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Cu,Ti]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=Ti&&Ti.isAvailable();let r=t&&!Ti.previouslyFailed();if(e.webSocketOnly&&(t||br("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[Ti];else{const i=this.transports_=[];for(const s of Od.ALL_TRANSPORTS)s&&s.isAvailable()&&i.push(s);Od.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Od.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TV=6e4,CV=5e3,IV=10*1024,PV=100*1024,yv="t",E3="d",kV="s",S3="r",RV="e",T3="o",C3="a",I3="n",P3="p",xV="h";class AV{constructor(e,t,r,i,s,o,l,c,d,p){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=l,this.onDisconnect_=c,this.onKill_=d,this.lastSessionId=p,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=pf("c:"+this.id+":"),this.transportManager_=new Od(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=td(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>PV?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>IV?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(yv in e){const t=e[yv];t===C3?this.upgradeIfSecondaryHealthy_():t===S3?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===T3&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=wh("t",e),r=wh("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:P3,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:C3,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:I3,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=wh("t",e),r=wh("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=wh(yv,e);if(E3 in e){const r=e[E3];if(t===xV){const i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===I3){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===kV?this.onConnectionShutdown_(r):t===S3?this.onReset_(r):t===RV?r2("Server Error: "+r):t===T3?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):r2("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),PE!==r&&br("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),td(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(TV))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):td(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(CV))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:P3,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Ya.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J9{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z9{constructor(e){this.allowedEvents_=e,this.listeners_={},ie(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){ie(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ym extends Z9{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!kw()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new ym}getInitialEvent(e){return ie(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k3=32,R3=768;let ct=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function it(){return new ct("")}function Me(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function na(n){return n.pieces_.length-n.pieceNum_}function _t(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new ct(n.pieces_,e)}function xE(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function NV(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function Md(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function eR(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new ct(e,0)}function Wt(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof ct)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new ct(t,0)}function Fe(n){return n.pieceNum_>=n.pieces_.length}function Rr(n,e){const t=Me(n),r=Me(e);if(t===null)return e;if(t===r)return Rr(_t(n),_t(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function DV(n,e){const t=Md(n,0),r=Md(e,0);for(let i=0;i<t.length&&i<r.length;i++){const s=Sl(t[i],r[i]);if(s!==0)return s}return t.length===r.length?0:t.length<r.length?-1:1}function AE(n,e){if(na(n)!==na(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function ni(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(na(n)>na(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class bV{constructor(e,t){this.errorPrefix_=t,this.parts_=Md(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=n0(this.parts_[r]);tR(this)}}function OV(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=n0(e),tR(n)}function MV(n){const e=n.parts_.pop();n.byteLength_-=n0(e),n.parts_.length>0&&(n.byteLength_-=1)}function tR(n){if(n.byteLength_>R3)throw new Error(n.errorPrefix_+"has a key path longer than "+R3+" bytes ("+n.byteLength_+").");if(n.parts_.length>k3)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+k3+") or object contains a cycle "+Ga(n))}function Ga(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NE extends Z9{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new NE}getInitialEvent(e){return ie(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eh=1e3,LV=60*5*1e3,x3=30*1e3,FV=1.3,VV=3e4,UV="server_kill",A3=3;class zs extends J9{constructor(e,t,r,i,s,o,l,c){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=r,this.onConnectStatus_=i,this.onServerInfoUpdate_=s,this.authTokenProvider_=o,this.appCheckTokenProvider_=l,this.authOverride_=c,this.id=zs.nextPersistentConnectionId_++,this.log_=pf("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Eh,this.maxReconnectDelay_=LV,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");NE.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&ym.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,r){const i=++this.requestNumber_,s={r:i,a:e,b:t};this.log_(Cn(s)),ie(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),r&&(this.requestCBHash_[i]=r)}get(e){this.initConnection_();const t=new xs,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const l=o.d;o.s==="ok"?t.resolve(l):t.reject(l)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),t.promise}listen(e,t,r,i){this.initConnection_();const s=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+s),this.listens.has(o)||this.listens.set(o,new Map),ie(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),ie(!this.listens.get(o).has(s),"listen() called twice for same path/queryId.");const l={onComplete:i,hashFn:t,query:e,tag:r};this.listens.get(o).set(s,l),this.connected_&&this.sendListen_(l)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(r)})}sendListen_(e){const t=e.query,r=t._path.toString(),i=t._queryIdentifier;this.log_("Listen on "+r+" for "+i);const s={p:r},o="q";e.tag&&(s.q=t._queryObject,s.t=e.tag),s.h=e.hashFn(),this.sendRequest(o,s,l=>{const c=l.d,d=l.s;zs.warnOnListenWarnings_(c,t),(this.listens.get(r)&&this.listens.get(r).get(i))===e&&(this.log_("listen response",l),d!=="ok"&&this.removeListen_(r,i),e.onComplete&&e.onComplete(d,c))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&ss(e,"w")){const r=Hu(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const i='".indexOn": "'+t._queryParams.getIndex().toString()+'"',s=t._path.toString();br(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||f7(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=x3)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=d7(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(t,r,i=>{const s=i.s,o=i.d||"error";this.authToken_===e&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,r=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,r)})}unlisten(e,t){const r=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+i),ie(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,i)&&this.connected_&&this.sendUnlisten_(r,i,e._queryObject,t)}sendUnlisten_(e,t,r,i){this.log_("Unlisten on "+e+" for "+t);const s={p:e},o="n";i&&(s.q=r,s.t=i),this.sendRequest(o,s)}onDisconnectPut(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:r})}onDisconnectMerge(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:r})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,r,i){const s={p:t,d:r};this.log_("onDisconnect "+e,s),this.sendRequest(e,s,o=>{i&&setTimeout(()=>{i(o.s,o.d)},Math.floor(0))})}put(e,t,r,i){this.putInternal("p",e,t,r,i)}merge(e,t,r,i){this.putInternal("m",e,t,r,i)}putInternal(e,t,r,i,s){this.initConnection_();const o={p:t,d:r};s!==void 0&&(o.h=s),this.outstandingPuts_.push({action:e,request:o,onComplete:i}),this.outstandingPutCount_++;const l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,r,s=>{this.log_(t+" response",s),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(s.s,s.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,r=>{if(r.s!=="ok"){const s=r.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Cn(e));const t=e.r,r=this.requestCBHash_[t];r&&(delete this.requestCBHash_[t],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):r2("Unrecognized action received from server: "+Cn(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){ie(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Eh,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Eh,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>VV&&(this.reconnectDelay_=Eh),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*FV)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+zs.nextConnectionId_++,s=this.lastSessionId;let o=!1,l=null;const c=function(){l?l.close():(o=!0,r())},d=function(_){ie(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(_)};this.realtime_={close:c,sendRequest:d};const p=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[_,m]=await Promise.all([this.authTokenProvider_.getToken(p),this.appCheckTokenProvider_.getToken(p)]);o?Mn("getToken() completed but was canceled"):(Mn("getToken() completed. Creating connection."),this.authToken_=_&&_.accessToken,this.appCheckToken_=m&&m.token,l=new AV(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,r,E=>{br(E+" ("+this.repoInfo_.toString()+")"),this.interrupt(UV)},s))}catch(_){this.log_("Failed to get token: "+_),o||(this.repoInfo_.nodeAdmin&&br(_),c())}}}interrupt(e){Mn("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Mn("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Zg(this.interruptReasons_)&&(this.reconnectDelay_=Eh,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let r;t?r=t.map(s=>IE(s)).join("$"):r="default";const i=this.removeListen_(e,r);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,t){const r=new ct(e).toString();let i;if(this.listens.has(r)){const s=this.listens.get(r);i=s.get(t),s.delete(t),s.size===0&&this.listens.delete(r)}else i=void 0;return i}onAuthRevoked_(e,t){Mn("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=A3&&(this.reconnectDelay_=x3,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Mn("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=A3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+N9.replace(/\./g,"-")]=1,kw()?e["framework.cordova"]=1:pP()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=ym.getInstance().currentlyOnline();return Zg(this.interruptReasons_)&&e}}zs.nextPersistentConnectionId_=0;zs.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Ve(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k0{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new Ve(ec,e),i=new Ve(ec,t);return this.compare(r,i)!==0}minPost(){return Ve.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Kp;class nR extends k0{static get __EMPTY_NODE(){return Kp}static set __EMPTY_NODE(e){Kp=e}compare(e,t){return Sl(e.name,t.name)}isDefinedOn(e){throw dc("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Ve.MIN}maxPost(){return new Ve(fl,Kp)}makePost(e,t){return ie(typeof e=="string","KeyIndex indexValue must always be a string."),new Ve(e,Kp)}toString(){return".key"}}const Lu=new nR;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qp{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Sn{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??Sn.RED,this.left=i??xr.EMPTY_NODE,this.right=s??xr.EMPTY_NODE}copy(e,t,r,i,s){return new Sn(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return s<0?i=i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i=i.copy(null,t,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return xr.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let r,i;if(r=this,t(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),t(e,r.key)===0){if(r.right.isEmpty())return xr.EMPTY_NODE;i=r.right.min_(),r=r.copy(i.key,i.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Sn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Sn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Sn.RED=!0;Sn.BLACK=!1;class BV{copy(e,t,r,i,s){return this}insert(e,t,r){return new Sn(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class xr{constructor(e,t=xr.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new xr(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Sn.BLACK,null,null))}remove(e){return new xr(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Sn.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Qp(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Qp(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Qp(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Qp(this.root_,null,this.comparator_,!0,e)}}xr.EMPTY_NODE=new BV;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zV(n,e){return Sl(n.name,e.name)}function DE(n,e){return Sl(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let s2;function jV(n){s2=n}const rR=function(n){return typeof n=="number"?"number:"+M9(n):"string:"+n},iR=function(n){if(n.isLeafNode()){const e=n.val();ie(typeof e=="string"||typeof e=="number"||typeof e=="object"&&ss(e,".sv"),"Priority must be a string or number.")}else ie(n===s2||n.isEmpty(),"priority of unexpected type.");ie(n===s2||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let N3;class yn{constructor(e,t=yn.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,ie(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),iR(this.priorityNode_)}static set __childrenNodeConstructor(e){N3=e}static get __childrenNodeConstructor(){return N3}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new yn(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:yn.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Fe(e)?this:Me(e)===".priority"?this.priorityNode_:yn.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:yn.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const r=Me(e);return r===null?t:t.isEmpty()&&r!==".priority"?this:(ie(r!==".priority"||na(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,yn.__childrenNodeConstructor.EMPTY_NODE.updateChild(_t(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+rR(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=M9(this.value_):e+=this.value_,this.lazyHash_=b9(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===yn.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof yn.__childrenNodeConstructor?-1:(ie(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,r=typeof this.value_,i=yn.VALUE_TYPE_ORDER.indexOf(t),s=yn.VALUE_TYPE_ORDER.indexOf(r);return ie(i>=0,"Unknown leaf type: "+t),ie(s>=0,"Unknown leaf type: "+r),i===s?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}yn.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sR,oR;function GV(n){sR=n}function WV(n){oR=n}class HV extends k0{compare(e,t){const r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return s===0?Sl(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Ve.MIN}maxPost(){return new Ve(fl,new yn("[PRIORITY-POST]",oR))}makePost(e,t){const r=sR(e);return new Ve(t,new yn("[PRIORITY-POST]",r))}toString(){return".priority"}}const bt=new HV;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $V=Math.log(2);class qV{constructor(e){const t=s=>parseInt(Math.log(s)/$V,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const vm=function(n,e,t,r){n.sort(e);const i=function(c,d){const p=d-c;let _,m;if(p===0)return null;if(p===1)return _=n[c],m=t?t(_):_,new Sn(m,_.node,Sn.BLACK,null,null);{const E=parseInt(p/2,10)+c,S=i(c,E),k=i(E+1,d);return _=n[E],m=t?t(_):_,new Sn(m,_.node,Sn.BLACK,S,k)}},s=function(c){let d=null,p=null,_=n.length;const m=function(S,k){const N=_-S,x=_;_-=S;const R=i(N+1,x),w=n[N],P=t?t(w):w;E(new Sn(P,w.node,k,null,R))},E=function(S){d?(d.left=S,d=S):(p=S,d=S)};for(let S=0;S<c.count;++S){const k=c.nextBitIsOne(),N=Math.pow(2,c.count-(S+1));k?m(N,Sn.BLACK):(m(N,Sn.BLACK),m(N,Sn.RED))}return p},o=new qV(n.length),l=s(o);return new xr(r||e,l)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vv;const ru={};class Fs{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return ie(ru&&bt,"ChildrenNode.ts has not been loaded"),vv=vv||new Fs({".priority":ru},{".priority":bt}),vv}get(e){const t=Hu(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof xr?t:null}hasIndex(e){return ss(this.indexSet_,e.toString())}addIndex(e,t){ie(e!==Lu,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const s=t.getIterator(Ve.Wrap);let o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let l;i?l=vm(r,e.getCompare()):l=ru;const c=e.toString(),d=Object.assign({},this.indexSet_);d[c]=e;const p=Object.assign({},this.indexes_);return p[c]=l,new Fs(p,d)}addToIndexes(e,t){const r=em(this.indexes_,(i,s)=>{const o=Hu(this.indexSet_,s);if(ie(o,"Missing index implementation for "+s),i===ru)if(o.isDefinedOn(e.node)){const l=[],c=t.getIterator(Ve.Wrap);let d=c.getNext();for(;d;)d.name!==e.name&&l.push(d),d=c.getNext();return l.push(e),vm(l,o.getCompare())}else return ru;else{const l=t.get(e.name);let c=i;return l&&(c=c.remove(new Ve(e.name,l))),c.insert(e,e.node)}});return new Fs(r,this.indexSet_)}removeFromIndexes(e,t){const r=em(this.indexes_,i=>{if(i===ru)return i;{const s=t.get(e.name);return s?i.remove(new Ve(e.name,s)):i}});return new Fs(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sh;class Ie{constructor(e,t,r){this.children_=e,this.priorityNode_=t,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&iR(this.priorityNode_),this.children_.isEmpty()&&ie(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Sh||(Sh=new Ie(new xr(DE),null,Fs.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Sh}updatePriority(e){return this.children_.isEmpty()?this:new Ie(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?Sh:t}}getChild(e){const t=Me(e);return t===null?this:this.getImmediateChild(t).getChild(_t(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(ie(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const r=new Ve(e,t);let i,s;t.isEmpty()?(i=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,t),s=this.indexMap_.addToIndexes(r,this.children_));const o=i.isEmpty()?Sh:this.priorityNode_;return new Ie(i,o,s)}}updateChild(e,t){const r=Me(e);if(r===null)return t;{ie(Me(e)!==".priority"||na(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(r).updateChild(_t(e),t);return this.updateImmediateChild(r,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let r=0,i=0,s=!0;if(this.forEachChild(bt,(o,l)=>{t[o]=l.val(e),r++,s&&Ie.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):s=!1}),!e&&s&&i<2*r){const o=[];for(const l in t)o[l]=t[l];return o}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+rR(this.getPriority().val())+":"),this.forEachChild(bt,(t,r)=>{const i=r.hash();i!==""&&(e+=":"+t+":"+i)}),this.lazyHash_=e===""?"":b9(e)}return this.lazyHash_}getPredecessorChildName(e,t,r){const i=this.resolveIndex_(r);if(i){const s=i.getPredecessorKey(new Ve(e,t));return s?s.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const r=t.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Ve(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const r=t.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Ve(t,this.children_.get(t)):null}forEachChild(e,t){const r=this.resolveIndex_(e);return r?r.inorderTraversal(i=>t(i.name,i.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const r=this.resolveIndex_(t);if(r)return r.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,Ve.Wrap);let s=i.peek();for(;s!=null&&t.compare(s,e)<0;)i.getNext(),s=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const r=this.resolveIndex_(t);if(r)return r.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,Ve.Wrap);let s=i.peek();for(;s!=null&&t.compare(s,e)>0;)i.getNext(),s=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===gf?-1:0}withIndex(e){if(e===Lu||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new Ie(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Lu||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const r=this.getIterator(bt),i=t.getIterator(bt);let s=r.getNext(),o=i.getNext();for(;s&&o;){if(s.name!==o.name||!s.node.equals(o.node))return!1;s=r.getNext(),o=i.getNext()}return s===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===Lu?null:this.indexMap_.get(e.toString())}}Ie.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class KV extends Ie{constructor(){super(new xr(DE),Ie.EMPTY_NODE,Fs.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Ie.EMPTY_NODE}isEmpty(){return!1}}const gf=new KV;Object.defineProperties(Ve,{MIN:{value:new Ve(ec,Ie.EMPTY_NODE)},MAX:{value:new Ve(fl,gf)}});nR.__EMPTY_NODE=Ie.EMPTY_NODE;yn.__childrenNodeConstructor=Ie;jV(gf);WV(gf);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QV=!0;function Yt(n,e=null){if(n===null)return Ie.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),ie(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new yn(t,Yt(e))}if(!(n instanceof Array)&&QV){const t=[];let r=!1;if(sr(n,(o,l)=>{if(o.substring(0,1)!=="."){const c=Yt(l);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),t.push(new Ve(o,c)))}}),t.length===0)return Ie.EMPTY_NODE;const s=vm(t,zV,o=>o.name,DE);if(r){const o=vm(t,bt.getCompare());return new Ie(s,Yt(e),new Fs({".priority":o},{".priority":bt}))}else return new Ie(s,Yt(e),Fs.Default)}else{let t=Ie.EMPTY_NODE;return sr(n,(r,i)=>{if(ss(n,r)&&r.substring(0,1)!=="."){const s=Yt(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(Yt(e))}}GV(Yt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YV extends k0{constructor(e){super(),this.indexPath_=e,ie(!Fe(e)&&Me(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return s===0?Sl(e.name,t.name):s}makePost(e,t){const r=Yt(e),i=Ie.EMPTY_NODE.updateChild(this.indexPath_,r);return new Ve(t,i)}maxPost(){const e=Ie.EMPTY_NODE.updateChild(this.indexPath_,gf);return new Ve(fl,e)}toString(){return Md(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XV extends k0{compare(e,t){const r=e.node.compareTo(t.node);return r===0?Sl(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Ve.MIN}maxPost(){return Ve.MAX}makePost(e,t){const r=Yt(e);return new Ve(t,r)}toString(){return".value"}}const JV=new XV;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aR(n){return{type:"value",snapshotNode:n}}function tc(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Ld(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function Fd(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function ZV(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bE{constructor(e){this.index_=e}updateChild(e,t,r,i,s,o){ie(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const l=e.getImmediateChild(t);return l.getChild(i).equals(r.getChild(i))&&l.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(t)?o.trackChildChange(Ld(t,l)):ie(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):l.isEmpty()?o.trackChildChange(tc(t,r)):o.trackChildChange(Fd(t,r,l))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return r!=null&&(e.isLeafNode()||e.forEachChild(bt,(i,s)=>{t.hasChild(i)||r.trackChildChange(Ld(i,s))}),t.isLeafNode()||t.forEachChild(bt,(i,s)=>{if(e.hasChild(i)){const o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(Fd(i,s,o))}else r.trackChildChange(tc(i,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?Ie.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vd{constructor(e){this.indexedFilter_=new bE(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Vd.getStartPost_(e),this.endPost_=Vd.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,s,o){return this.matches(new Ve(t,r))||(r=Ie.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,s,o)}updateFullNode(e,t,r){t.isLeafNode()&&(t=Ie.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(Ie.EMPTY_NODE);const s=this;return t.forEachChild(bt,(o,l)=>{s.matches(new Ve(o,l))||(i=i.updateImmediateChild(o,Ie.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eU{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{const r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Vd(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,s,o){return this.rangedFilter_.matches(new Ve(t,r))||(r=Ie.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,s,o):this.fullLimitUpdateChild_(e,t,r,s,o)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=Ie.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){i=Ie.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){const l=s.getNext();if(this.withinDirectionalStart(l))if(this.withinDirectionalEnd(l))i=i.updateImmediateChild(l.name,l.node),o++;else break;else continue}}else{i=t.withIndex(this.index_),i=i.updatePriority(Ie.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){const l=s.getNext();o<this.limit_&&this.withinDirectionalStart(l)&&this.withinDirectionalEnd(l)?o++:i=i.updateImmediateChild(l.name,Ie.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,s){let o;if(this.reverse_){const _=this.index_.getCompare();o=(m,E)=>_(E,m)}else o=this.index_.getCompare();const l=e;ie(l.numChildren()===this.limit_,"");const c=new Ve(t,r),d=this.reverse_?l.getFirstChild(this.index_):l.getLastChild(this.index_),p=this.rangedFilter_.matches(c);if(l.hasChild(t)){const _=l.getImmediateChild(t);let m=i.getChildAfterChild(this.index_,d,this.reverse_);for(;m!=null&&(m.name===t||l.hasChild(m.name));)m=i.getChildAfterChild(this.index_,m,this.reverse_);const E=m==null?1:o(m,c);if(p&&!r.isEmpty()&&E>=0)return s!=null&&s.trackChildChange(Fd(t,r,_)),l.updateImmediateChild(t,r);{s!=null&&s.trackChildChange(Ld(t,_));const k=l.updateImmediateChild(t,Ie.EMPTY_NODE);return m!=null&&this.rangedFilter_.matches(m)?(s!=null&&s.trackChildChange(tc(m.name,m.node)),k.updateImmediateChild(m.name,m.node)):k}}else return r.isEmpty()?e:p&&o(d,c)>=0?(s!=null&&(s.trackChildChange(Ld(d.name,d.node)),s.trackChildChange(tc(t,r))),l.updateImmediateChild(t,r).updateImmediateChild(d.name,Ie.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OE{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=bt}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return ie(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return ie(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ec}hasEnd(){return this.endSet_}getIndexEndValue(){return ie(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return ie(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:fl}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return ie(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===bt}copy(){const e=new OE;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function tU(n){return n.loadsAllData()?new bE(n.getIndex()):n.hasLimit()?new eU(n):new Vd(n)}function D3(n){const e={};if(n.isDefault())return e;let t;if(n.index_===bt?t="$priority":n.index_===JV?t="$value":n.index_===Lu?t="$key":(ie(n.index_ instanceof YV,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=Cn(t),n.startSet_){const r=n.startAfterSet_?"startAfter":"startAt";e[r]=Cn(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+Cn(n.indexStartName_))}if(n.endSet_){const r=n.endBeforeSet_?"endBefore":"endAt";e[r]=Cn(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+Cn(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function b3(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==bt&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wm extends J9{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=pf("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(ie(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const o=wm.getListenId_(e,r),l={};this.listens_[o]=l;const c=D3(e._queryParams);this.restRequest_(s+".json",c,(d,p)=>{let _=p;if(d===404&&(_=null,d=null),d===null&&this.onDataUpdate_(s,_,!1,r),Hu(this.listens_,o)===l){let m;d?d===401?m="permission_denied":m="rest_error:"+d:m="ok",i(m,null)}})}unlisten(e,t){const r=wm.getListenId_(e,t);delete this.listens_[r]}get(e){const t=D3(e._queryParams),r=e._path.toString(),i=new xs;return this.restRequest_(r+".json",t,(s,o)=>{let l=o;s===404&&(l=null,s=null),s===null?(this.onDataUpdate_(r,l,!1,null),i.resolve(l)):i.reject(new Error(l))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+fc(t);this.log_("Sending REST request for "+o);const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(r&&l.readyState===4){this.log_("REST Response for "+o+" received. status:",l.status,"response:",l.responseText);let c=null;if(l.status>=200&&l.status<300){try{c=Sd(l.responseText)}catch{br("Failed to parse JSON response for "+o+": "+l.responseText)}r(null,c)}else l.status!==401&&l.status!==404&&br("Got unsuccessful REST response for "+o+" Status: "+l.status),r(l.status);r=null}},l.open("GET",o,!0),l.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nU{constructor(){this.rootNode_=Ie.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Em(){return{value:null,children:new Map}}function wc(n,e,t){if(Fe(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const r=Me(e);n.children.has(r)||n.children.set(r,Em());const i=n.children.get(r);e=_t(e),wc(i,e,t)}}function o2(n,e){if(Fe(e))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{const t=n.value;return n.value=null,t.forEachChild(bt,(r,i)=>{wc(n,new ct(r),i)}),o2(n,e)}}else if(n.children.size>0){const t=Me(e);return e=_t(e),n.children.has(t)&&o2(n.children.get(t),e)&&n.children.delete(t),n.children.size===0}else return!0}function a2(n,e,t){n.value!==null?t(e,n.value):rU(n,(r,i)=>{const s=new ct(e.toString()+"/"+r);a2(i,s,t)})}function rU(n,e){n.children.forEach((t,r)=>{e(r,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iU{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&sr(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O3=10*1e3,sU=30*1e3,oU=5*60*1e3;class aU{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new iU(e);const r=O3+(sU-O3)*Math.random();td(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;sr(e,(i,s)=>{s>0&&ss(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),td(this.reportStats_.bind(this),Math.floor(Math.random()*2*oU))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ii;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Ii||(Ii={}));function lR(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function ME(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function LE(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sm{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Ii.ACK_USER_WRITE,this.source=lR()}operationForChild(e){if(Fe(this.path)){if(this.affectedTree.value!=null)return ie(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new ct(e));return new Sm(it(),t,this.revert)}}else return ie(Me(this.path)===e,"operationForChild called for unrelated child."),new Sm(_t(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ud{constructor(e,t){this.source=e,this.path=t,this.type=Ii.LISTEN_COMPLETE}operationForChild(e){return Fe(this.path)?new Ud(this.source,it()):new Ud(this.source,_t(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pl{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Ii.OVERWRITE}operationForChild(e){return Fe(this.path)?new pl(this.source,it(),this.snap.getImmediateChild(e)):new pl(this.source,_t(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bd{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Ii.MERGE}operationForChild(e){if(Fe(this.path)){const t=this.children.subtree(new ct(e));return t.isEmpty()?null:t.value?new pl(this.source,it(),t.value):new Bd(this.source,it(),t)}else return ie(Me(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Bd(this.source,_t(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gl{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Fe(e))return this.isFullyInitialized()&&!this.filtered_;const t=Me(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lU{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function uU(n,e,t,r){const i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(ZV(o.childName,o.snapshotNode))}),Th(n,i,"child_removed",e,r,t),Th(n,i,"child_added",e,r,t),Th(n,i,"child_moved",s,r,t),Th(n,i,"child_changed",e,r,t),Th(n,i,"value",e,r,t),i}function Th(n,e,t,r,i,s){const o=r.filter(l=>l.type===t);o.sort((l,c)=>hU(n,l,c)),o.forEach(l=>{const c=cU(n,l,s);i.forEach(d=>{d.respondsTo(l.type)&&e.push(d.createEvent(c,n.query_))})})}function cU(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function hU(n,e,t){if(e.childName==null||t.childName==null)throw dc("Should only compare child_ events.");const r=new Ve(e.childName,e.snapshotNode),i=new Ve(t.childName,t.snapshotNode);return n.index_.compare(r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R0(n,e){return{eventCache:n,serverCache:e}}function nd(n,e,t,r){return R0(new gl(e,t,r),n.serverCache)}function uR(n,e,t,r){return R0(n.eventCache,new gl(e,t,r))}function l2(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function ml(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wv;const dU=()=>(wv||(wv=new xr(YF)),wv);class Ct{constructor(e,t=dU()){this.value=e,this.children=t}static fromObject(e){let t=new Ct(null);return sr(e,(r,i)=>{t=t.set(new ct(r),i)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:it(),value:this.value};if(Fe(e))return null;{const r=Me(e),i=this.children.get(r);if(i!==null){const s=i.findRootMostMatchingPathAndValue(_t(e),t);return s!=null?{path:Wt(new ct(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Fe(e))return this;{const t=Me(e),r=this.children.get(t);return r!==null?r.subtree(_t(e)):new Ct(null)}}set(e,t){if(Fe(e))return new Ct(t,this.children);{const r=Me(e),s=(this.children.get(r)||new Ct(null)).set(_t(e),t),o=this.children.insert(r,s);return new Ct(this.value,o)}}remove(e){if(Fe(e))return this.children.isEmpty()?new Ct(null):new Ct(null,this.children);{const t=Me(e),r=this.children.get(t);if(r){const i=r.remove(_t(e));let s;return i.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,i),this.value===null&&s.isEmpty()?new Ct(null):new Ct(this.value,s)}else return this}}get(e){if(Fe(e))return this.value;{const t=Me(e),r=this.children.get(t);return r?r.get(_t(e)):null}}setTree(e,t){if(Fe(e))return t;{const r=Me(e),s=(this.children.get(r)||new Ct(null)).setTree(_t(e),t);let o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new Ct(this.value,o)}}fold(e){return this.fold_(it(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Wt(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,it(),t)}findOnPath_(e,t,r){const i=this.value?r(t,this.value):!1;if(i)return i;if(Fe(e))return null;{const s=Me(e),o=this.children.get(s);return o?o.findOnPath_(_t(e),Wt(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,it(),t)}foreachOnPath_(e,t,r){if(Fe(e))return this;{this.value&&r(t,this.value);const i=Me(e),s=this.children.get(i);return s?s.foreachOnPath_(_t(e),Wt(t,i),r):new Ct(null)}}foreach(e){this.foreach_(it(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(Wt(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi{constructor(e){this.writeTree_=e}static empty(){return new xi(new Ct(null))}}function rd(n,e,t){if(Fe(e))return new xi(new Ct(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){const i=r.path;let s=r.value;const o=Rr(i,e);return s=s.updateChild(o,t),new xi(n.writeTree_.set(i,s))}else{const i=new Ct(t),s=n.writeTree_.setTree(e,i);return new xi(s)}}}function M3(n,e,t){let r=n;return sr(t,(i,s)=>{r=rd(r,Wt(e,i),s)}),r}function L3(n,e){if(Fe(e))return xi.empty();{const t=n.writeTree_.setTree(e,new Ct(null));return new xi(t)}}function u2(n,e){return Tl(n,e)!=null}function Tl(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(Rr(t.path,e)):null}function F3(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(bt,(r,i)=>{e.push(new Ve(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new Ve(r,i.value))}),e}function qo(n,e){if(Fe(e))return n;{const t=Tl(n,e);return t!=null?new xi(new Ct(t)):new xi(n.writeTree_.subtree(e))}}function c2(n){return n.writeTree_.isEmpty()}function nc(n,e){return cR(it(),n.writeTree_,e)}function cR(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(ie(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):t=cR(Wt(n,i),s,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(Wt(n,".priority"),r)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FE(n,e){return pR(e,n)}function fU(n,e,t,r,i){ie(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=rd(n.visibleWrites,e,t)),n.lastWriteId=r}function pU(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}function gU(n,e){const t=n.allWrites.findIndex(l=>l.writeId===e);ie(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){const l=n.allWrites[o];l.visible&&(o>=t&&mU(l,r.path)?i=!1:ni(r.path,l.path)&&(s=!0)),o--}if(i){if(s)return _U(n),!0;if(r.snap)n.visibleWrites=L3(n.visibleWrites,r.path);else{const l=r.children;sr(l,c=>{n.visibleWrites=L3(n.visibleWrites,Wt(r.path,c))})}return!0}else return!1}function mU(n,e){if(n.snap)return ni(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&ni(Wt(n.path,t),e))return!0;return!1}function _U(n){n.visibleWrites=hR(n.allWrites,yU,it()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function yU(n){return n.visible}function hR(n,e,t){let r=xi.empty();for(let i=0;i<n.length;++i){const s=n[i];if(e(s)){const o=s.path;let l;if(s.snap)ni(t,o)?(l=Rr(t,o),r=rd(r,l,s.snap)):ni(o,t)&&(l=Rr(o,t),r=rd(r,it(),s.snap.getChild(l)));else if(s.children){if(ni(t,o))l=Rr(t,o),r=M3(r,l,s.children);else if(ni(o,t))if(l=Rr(o,t),Fe(l))r=M3(r,it(),s.children);else{const c=Hu(s.children,Me(l));if(c){const d=c.getChild(_t(l));r=rd(r,it(),d)}}}else throw dc("WriteRecord should have .snap or .children")}}return r}function dR(n,e,t,r,i){if(!r&&!i){const s=Tl(n.visibleWrites,e);if(s!=null)return s;{const o=qo(n.visibleWrites,e);if(c2(o))return t;if(t==null&&!u2(o,it()))return null;{const l=t||Ie.EMPTY_NODE;return nc(o,l)}}}else{const s=qo(n.visibleWrites,e);if(!i&&c2(s))return t;if(!i&&t==null&&!u2(s,it()))return null;{const o=function(d){return(d.visible||i)&&(!r||!~r.indexOf(d.writeId))&&(ni(d.path,e)||ni(e,d.path))},l=hR(n.allWrites,o,e),c=t||Ie.EMPTY_NODE;return nc(l,c)}}}function vU(n,e,t){let r=Ie.EMPTY_NODE;const i=Tl(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(bt,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){const s=qo(n.visibleWrites,e);return t.forEachChild(bt,(o,l)=>{const c=nc(qo(s,new ct(o)),l);r=r.updateImmediateChild(o,c)}),F3(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{const s=qo(n.visibleWrites,e);return F3(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function wU(n,e,t,r,i){ie(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=Wt(e,t);if(u2(n.visibleWrites,s))return null;{const o=qo(n.visibleWrites,s);return c2(o)?i.getChild(t):nc(o,i.getChild(t))}}function EU(n,e,t,r){const i=Wt(e,t),s=Tl(n.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(t)){const o=qo(n.visibleWrites,i);return nc(o,r.getNode().getImmediateChild(t))}else return null}function SU(n,e){return Tl(n.visibleWrites,e)}function TU(n,e,t,r,i,s,o){let l;const c=qo(n.visibleWrites,e),d=Tl(c,it());if(d!=null)l=d;else if(t!=null)l=nc(c,t);else return[];if(l=l.withIndex(o),!l.isEmpty()&&!l.isLeafNode()){const p=[],_=o.getCompare(),m=s?l.getReverseIteratorFrom(r,o):l.getIteratorFrom(r,o);let E=m.getNext();for(;E&&p.length<i;)_(E,r)!==0&&p.push(E),E=m.getNext();return p}else return[]}function CU(){return{visibleWrites:xi.empty(),allWrites:[],lastWriteId:-1}}function Tm(n,e,t,r){return dR(n.writeTree,n.treePath,e,t,r)}function VE(n,e){return vU(n.writeTree,n.treePath,e)}function V3(n,e,t,r){return wU(n.writeTree,n.treePath,e,t,r)}function Cm(n,e){return SU(n.writeTree,Wt(n.treePath,e))}function IU(n,e,t,r,i,s){return TU(n.writeTree,n.treePath,e,t,r,i,s)}function UE(n,e,t){return EU(n.writeTree,n.treePath,e,t)}function fR(n,e){return pR(Wt(n.treePath,e),n.writeTree)}function pR(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PU{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;ie(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),ie(r!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const s=i.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(r,Fd(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(r,Ld(r,i.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(r,tc(r,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(r,Fd(r,e.snapshotNode,i.oldSnap));else throw dc("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kU{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}}const gR=new kU;class BE{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new gl(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return UE(this.writes_,e,r)}}getChildAfterChild(e,t,r){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:ml(this.viewCache_),s=IU(this.writes_,i,t,1,r,e);return s.length===0?null:s[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RU(n){return{filter:n}}function xU(n,e){ie(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),ie(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function AU(n,e,t,r,i){const s=new PU;let o,l;if(t.type===Ii.OVERWRITE){const d=t;d.source.fromUser?o=h2(n,e,d.path,d.snap,r,i,s):(ie(d.source.fromServer,"Unknown source."),l=d.source.tagged||e.serverCache.isFiltered()&&!Fe(d.path),o=Im(n,e,d.path,d.snap,r,i,l,s))}else if(t.type===Ii.MERGE){const d=t;d.source.fromUser?o=DU(n,e,d.path,d.children,r,i,s):(ie(d.source.fromServer,"Unknown source."),l=d.source.tagged||e.serverCache.isFiltered(),o=d2(n,e,d.path,d.children,r,i,l,s))}else if(t.type===Ii.ACK_USER_WRITE){const d=t;d.revert?o=MU(n,e,d.path,r,i,s):o=bU(n,e,d.path,d.affectedTree,r,i,s)}else if(t.type===Ii.LISTEN_COMPLETE)o=OU(n,e,t.path,r,s);else throw dc("Unknown operation type: "+t.type);const c=s.getChanges();return NU(e,o,c),{viewCache:o,changes:c}}function NU(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=l2(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(aR(l2(e)))}}function mR(n,e,t,r,i,s){const o=e.eventCache;if(Cm(r,t)!=null)return e;{let l,c;if(Fe(t))if(ie(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const d=ml(e),p=d instanceof Ie?d:Ie.EMPTY_NODE,_=VE(r,p);l=n.filter.updateFullNode(e.eventCache.getNode(),_,s)}else{const d=Tm(r,ml(e));l=n.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{const d=Me(t);if(d===".priority"){ie(na(t)===1,"Can't have a priority with additional path components");const p=o.getNode();c=e.serverCache.getNode();const _=V3(r,t,p,c);_!=null?l=n.filter.updatePriority(p,_):l=o.getNode()}else{const p=_t(t);let _;if(o.isCompleteForChild(d)){c=e.serverCache.getNode();const m=V3(r,t,o.getNode(),c);m!=null?_=o.getNode().getImmediateChild(d).updateChild(p,m):_=o.getNode().getImmediateChild(d)}else _=UE(r,d,e.serverCache);_!=null?l=n.filter.updateChild(o.getNode(),d,_,p,i,s):l=o.getNode()}}return nd(e,l,o.isFullyInitialized()||Fe(t),n.filter.filtersNodes())}}function Im(n,e,t,r,i,s,o,l){const c=e.serverCache;let d;const p=o?n.filter:n.filter.getIndexedFilter();if(Fe(t))d=p.updateFullNode(c.getNode(),r,null);else if(p.filtersNodes()&&!c.isFiltered()){const E=c.getNode().updateChild(t,r);d=p.updateFullNode(c.getNode(),E,null)}else{const E=Me(t);if(!c.isCompleteForPath(t)&&na(t)>1)return e;const S=_t(t),N=c.getNode().getImmediateChild(E).updateChild(S,r);E===".priority"?d=p.updatePriority(c.getNode(),N):d=p.updateChild(c.getNode(),E,N,S,gR,null)}const _=uR(e,d,c.isFullyInitialized()||Fe(t),p.filtersNodes()),m=new BE(i,_,s);return mR(n,_,t,i,m,l)}function h2(n,e,t,r,i,s,o){const l=e.eventCache;let c,d;const p=new BE(i,e,s);if(Fe(t))d=n.filter.updateFullNode(e.eventCache.getNode(),r,o),c=nd(e,d,!0,n.filter.filtersNodes());else{const _=Me(t);if(_===".priority")d=n.filter.updatePriority(e.eventCache.getNode(),r),c=nd(e,d,l.isFullyInitialized(),l.isFiltered());else{const m=_t(t),E=l.getNode().getImmediateChild(_);let S;if(Fe(m))S=r;else{const k=p.getCompleteChild(_);k!=null?xE(m)===".priority"&&k.getChild(eR(m)).isEmpty()?S=k:S=k.updateChild(m,r):S=Ie.EMPTY_NODE}if(E.equals(S))c=e;else{const k=n.filter.updateChild(l.getNode(),_,S,m,p,o);c=nd(e,k,l.isFullyInitialized(),n.filter.filtersNodes())}}}return c}function U3(n,e){return n.eventCache.isCompleteForChild(e)}function DU(n,e,t,r,i,s,o){let l=e;return r.foreach((c,d)=>{const p=Wt(t,c);U3(e,Me(p))&&(l=h2(n,l,p,d,i,s,o))}),r.foreach((c,d)=>{const p=Wt(t,c);U3(e,Me(p))||(l=h2(n,l,p,d,i,s,o))}),l}function B3(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function d2(n,e,t,r,i,s,o,l){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,d;Fe(t)?d=r:d=new Ct(null).setTree(t,r);const p=e.serverCache.getNode();return d.children.inorderTraversal((_,m)=>{if(p.hasChild(_)){const E=e.serverCache.getNode().getImmediateChild(_),S=B3(n,E,m);c=Im(n,c,new ct(_),S,i,s,o,l)}}),d.children.inorderTraversal((_,m)=>{const E=!e.serverCache.isCompleteForChild(_)&&m.value===null;if(!p.hasChild(_)&&!E){const S=e.serverCache.getNode().getImmediateChild(_),k=B3(n,S,m);c=Im(n,c,new ct(_),k,i,s,o,l)}}),c}function bU(n,e,t,r,i,s,o){if(Cm(i,t)!=null)return e;const l=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(Fe(t)&&c.isFullyInitialized()||c.isCompleteForPath(t))return Im(n,e,t,c.getNode().getChild(t),i,s,l,o);if(Fe(t)){let d=new Ct(null);return c.getNode().forEachChild(Lu,(p,_)=>{d=d.set(new ct(p),_)}),d2(n,e,t,d,i,s,l,o)}else return e}else{let d=new Ct(null);return r.foreach((p,_)=>{const m=Wt(t,p);c.isCompleteForPath(m)&&(d=d.set(p,c.getNode().getChild(m)))}),d2(n,e,t,d,i,s,l,o)}}function OU(n,e,t,r,i){const s=e.serverCache,o=uR(e,s.getNode(),s.isFullyInitialized()||Fe(t),s.isFiltered());return mR(n,o,t,r,gR,i)}function MU(n,e,t,r,i,s){let o;if(Cm(r,t)!=null)return e;{const l=new BE(r,e,i),c=e.eventCache.getNode();let d;if(Fe(t)||Me(t)===".priority"){let p;if(e.serverCache.isFullyInitialized())p=Tm(r,ml(e));else{const _=e.serverCache.getNode();ie(_ instanceof Ie,"serverChildren would be complete if leaf node"),p=VE(r,_)}p=p,d=n.filter.updateFullNode(c,p,s)}else{const p=Me(t);let _=UE(r,p,e.serverCache);_==null&&e.serverCache.isCompleteForChild(p)&&(_=c.getImmediateChild(p)),_!=null?d=n.filter.updateChild(c,p,_,_t(t),l,s):e.eventCache.getNode().hasChild(p)?d=n.filter.updateChild(c,p,Ie.EMPTY_NODE,_t(t),l,s):d=c,d.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Tm(r,ml(e)),o.isLeafNode()&&(d=n.filter.updateFullNode(d,o,s)))}return o=e.serverCache.isFullyInitialized()||Cm(r,it())!=null,nd(e,d,o,n.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LU{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new bE(r.getIndex()),s=tU(r);this.processor_=RU(s);const o=t.serverCache,l=t.eventCache,c=i.updateFullNode(Ie.EMPTY_NODE,o.getNode(),null),d=s.updateFullNode(Ie.EMPTY_NODE,l.getNode(),null),p=new gl(c,o.isFullyInitialized(),i.filtersNodes()),_=new gl(d,l.isFullyInitialized(),s.filtersNodes());this.viewCache_=R0(_,p),this.eventGenerator_=new lU(this.query_)}get query(){return this.query_}}function FU(n){return n.viewCache_.serverCache.getNode()}function VU(n,e){const t=ml(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!Fe(e)&&!t.getImmediateChild(Me(e)).isEmpty())?t.getChild(e):null}function z3(n){return n.eventRegistrations_.length===0}function UU(n,e){n.eventRegistrations_.push(e)}function j3(n,e,t){const r=[];if(t){ie(e==null,"A cancel should cancel all event registrations.");const i=n.query._path;n.eventRegistrations_.forEach(s=>{const o=s.createCancelEvent(t,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<n.eventRegistrations_.length;++s){const o=n.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(s+1));break}}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function G3(n,e,t,r){e.type===Ii.MERGE&&e.source.queryId!==null&&(ie(ml(n.viewCache_),"We should always have a full cache before handling merges"),ie(l2(n.viewCache_),"Missing event cache, even though we have a server cache"));const i=n.viewCache_,s=AU(n.processor_,i,e,t,r);return xU(n.processor_,s.viewCache),ie(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,_R(n,s.changes,s.viewCache.eventCache.getNode(),null)}function BU(n,e){const t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(bt,(s,o)=>{r.push(tc(s,o))}),t.isFullyInitialized()&&r.push(aR(t.getNode())),_R(n,r,t.getNode(),e)}function _R(n,e,t,r){const i=r?[r]:n.eventRegistrations_;return uU(n.eventGenerator_,e,t,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pm;class zU{constructor(){this.views=new Map}}function jU(n){ie(!Pm,"__referenceConstructor has already been defined"),Pm=n}function GU(){return ie(Pm,"Reference.ts has not been loaded"),Pm}function WU(n){return n.views.size===0}function zE(n,e,t,r){const i=e.source.queryId;if(i!==null){const s=n.views.get(i);return ie(s!=null,"SyncTree gave us an op for an invalid query."),G3(s,e,t,r)}else{let s=[];for(const o of n.views.values())s=s.concat(G3(o,e,t,r));return s}}function HU(n,e,t,r,i){const s=e._queryIdentifier,o=n.views.get(s);if(!o){let l=Tm(t,i?r:null),c=!1;l?c=!0:r instanceof Ie?(l=VE(t,r),c=!1):(l=Ie.EMPTY_NODE,c=!1);const d=R0(new gl(l,c,!1),new gl(r,i,!1));return new LU(e,d)}return o}function $U(n,e,t,r,i,s){const o=HU(n,e,r,i,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),UU(o,t),BU(o,t)}function qU(n,e,t,r){const i=e._queryIdentifier,s=[];let o=[];const l=ra(n);if(i==="default")for(const[c,d]of n.views.entries())o=o.concat(j3(d,t,r)),z3(d)&&(n.views.delete(c),d.query._queryParams.loadsAllData()||s.push(d.query));else{const c=n.views.get(i);c&&(o=o.concat(j3(c,t,r)),z3(c)&&(n.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return l&&!ra(n)&&s.push(new(GU())(e._repo,e._path)),{removed:s,events:o}}function yR(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Fu(n,e){let t=null;for(const r of n.views.values())t=t||VU(r,e);return t}function vR(n,e){if(e._queryParams.loadsAllData())return x0(n);{const r=e._queryIdentifier;return n.views.get(r)}}function wR(n,e){return vR(n,e)!=null}function ra(n){return x0(n)!=null}function x0(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let km;function KU(n){ie(!km,"__referenceConstructor has already been defined"),km=n}function QU(){return ie(km,"Reference.ts has not been loaded"),km}let YU=1;class W3{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Ct(null),this.pendingWriteTree_=CU(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function ER(n,e,t,r,i){return fU(n.pendingWriteTree_,e,t,r,i),i?mf(n,new pl(lR(),e,t)):[]}function Xa(n,e,t=!1){const r=pU(n.pendingWriteTree_,e);if(gU(n.pendingWriteTree_,e)){let s=new Ct(null);return r.snap!=null?s=s.set(it(),!0):sr(r.children,o=>{s=s.set(new ct(o),!0)}),mf(n,new Sm(r.path,s,t))}else return[]}function A0(n,e,t){return mf(n,new pl(ME(),e,t))}function XU(n,e,t){const r=Ct.fromObject(t);return mf(n,new Bd(ME(),e,r))}function JU(n,e){return mf(n,new Ud(ME(),e))}function ZU(n,e,t){const r=GE(n,t);if(r){const i=WE(r),s=i.path,o=i.queryId,l=Rr(s,e),c=new Ud(LE(o),l);return HE(n,s,c)}else return[]}function f2(n,e,t,r,i=!1){const s=e._path,o=n.syncPointTree_.get(s);let l=[];if(o&&(e._queryIdentifier==="default"||wR(o,e))){const c=qU(o,e,t,r);WU(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));const d=c.removed;if(l=c.events,!i){const p=d.findIndex(m=>m._queryParams.loadsAllData())!==-1,_=n.syncPointTree_.findOnPath(s,(m,E)=>ra(E));if(p&&!_){const m=n.syncPointTree_.subtree(s);if(!m.isEmpty()){const E=nB(m);for(let S=0;S<E.length;++S){const k=E[S],N=k.query,x=CR(n,k);n.listenProvider_.startListening(id(N),Rm(n,N),x.hashFn,x.onComplete)}}}!_&&d.length>0&&!r&&(p?n.listenProvider_.stopListening(id(e),null):d.forEach(m=>{const E=n.queryToTagMap.get(N0(m));n.listenProvider_.stopListening(id(m),E)}))}rB(n,d)}return l}function eB(n,e,t,r){const i=GE(n,r);if(i!=null){const s=WE(i),o=s.path,l=s.queryId,c=Rr(o,e),d=new pl(LE(l),c,t);return HE(n,o,d)}else return[]}function tB(n,e,t,r){const i=GE(n,r);if(i){const s=WE(i),o=s.path,l=s.queryId,c=Rr(o,e),d=Ct.fromObject(t),p=new Bd(LE(l),c,d);return HE(n,o,p)}else return[]}function H3(n,e,t,r=!1){const i=e._path;let s=null,o=!1;n.syncPointTree_.foreachOnPath(i,(m,E)=>{const S=Rr(m,i);s=s||Fu(E,S),o=o||ra(E)});let l=n.syncPointTree_.get(i);l?(o=o||ra(l),s=s||Fu(l,it())):(l=new zU,n.syncPointTree_=n.syncPointTree_.set(i,l));let c;s!=null?c=!0:(c=!1,s=Ie.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((E,S)=>{const k=Fu(S,it());k&&(s=s.updateImmediateChild(E,k))}));const d=wR(l,e);if(!d&&!e._queryParams.loadsAllData()){const m=N0(e);ie(!n.queryToTagMap.has(m),"View does not exist, but we have a tag");const E=iB();n.queryToTagMap.set(m,E),n.tagToQueryMap.set(E,m)}const p=FE(n.pendingWriteTree_,i);let _=$U(l,e,t,p,s,c);if(!d&&!o&&!r){const m=vR(l,e);_=_.concat(sB(n,e,m))}return _}function jE(n,e,t){const i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,l)=>{const c=Rr(o,e),d=Fu(l,c);if(d)return d});return dR(i,e,s,t,!0)}function mf(n,e){return SR(e,n.syncPointTree_,null,FE(n.pendingWriteTree_,it()))}function SR(n,e,t,r){if(Fe(n.path))return TR(n,e,t,r);{const i=e.get(it());t==null&&i!=null&&(t=Fu(i,it()));let s=[];const o=Me(n.path),l=n.operationForChild(o),c=e.children.get(o);if(c&&l){const d=t?t.getImmediateChild(o):null,p=fR(r,o);s=s.concat(SR(l,c,d,p))}return i&&(s=s.concat(zE(i,n,r,t))),s}}function TR(n,e,t,r){const i=e.get(it());t==null&&i!=null&&(t=Fu(i,it()));let s=[];return e.children.inorderTraversal((o,l)=>{const c=t?t.getImmediateChild(o):null,d=fR(r,o),p=n.operationForChild(o);p&&(s=s.concat(TR(p,l,c,d)))}),i&&(s=s.concat(zE(i,n,r,t))),s}function CR(n,e){const t=e.query,r=Rm(n,t);return{hashFn:()=>(FU(e)||Ie.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?ZU(n,t._path,r):JU(n,t._path);{const s=ZF(i,t);return f2(n,t,null,s)}}}}function Rm(n,e){const t=N0(e);return n.queryToTagMap.get(t)}function N0(n){return n._path.toString()+"$"+n._queryIdentifier}function GE(n,e){return n.tagToQueryMap.get(e)}function WE(n){const e=n.indexOf("$");return ie(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new ct(n.substr(0,e))}}function HE(n,e,t){const r=n.syncPointTree_.get(e);ie(r,"Missing sync point for query tag that we're tracking");const i=FE(n.pendingWriteTree_,e);return zE(r,t,i,null)}function nB(n){return n.fold((e,t,r)=>{if(t&&ra(t))return[x0(t)];{let i=[];return t&&(i=yR(t)),sr(r,(s,o)=>{i=i.concat(o)}),i}})}function id(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(QU())(n._repo,n._path):n}function rB(n,e){for(let t=0;t<e.length;++t){const r=e[t];if(!r._queryParams.loadsAllData()){const i=N0(r),s=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(s)}}}function iB(){return YU++}function sB(n,e,t){const r=e._path,i=Rm(n,e),s=CR(n,t),o=n.listenProvider_.startListening(id(e),i,s.hashFn,s.onComplete),l=n.syncPointTree_.subtree(r);if(i)ie(!ra(l.value),"If we're adding a query, it shouldn't be shadowed");else{const c=l.fold((d,p,_)=>{if(!Fe(d)&&p&&ra(p))return[x0(p).query];{let m=[];return p&&(m=m.concat(yR(p).map(E=>E.query))),sr(_,(E,S)=>{m=m.concat(S)}),m}});for(let d=0;d<c.length;++d){const p=c[d];n.listenProvider_.stopListening(id(p),Rm(n,p))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $E{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new $E(t)}node(){return this.node_}}class qE{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Wt(this.path_,e);return new qE(this.syncTree_,t)}node(){return jE(this.syncTree_,this.path_)}}const oB=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},$3=function(n,e,t){if(!n||typeof n!="object")return n;if(ie(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return aB(n[".sv"],e,t);if(typeof n[".sv"]=="object")return lB(n[".sv"],e);ie(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},aB=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:ie(!1,"Unexpected server value: "+n)}},lB=function(n,e,t){n.hasOwnProperty("increment")||ie(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;typeof r!="number"&&ie(!1,"Unexpected increment value: "+r);const i=e.node();if(ie(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return typeof o!="number"?r:o+r},uB=function(n,e,t,r){return KE(e,new qE(t,n),r)},IR=function(n,e,t){return KE(n,new $E(e),t)};function KE(n,e,t){const r=n.getPriority().val(),i=$3(r,e.getImmediateChild(".priority"),t);let s;if(n.isLeafNode()){const o=n,l=$3(o.getValue(),e,t);return l!==o.getValue()||i!==o.getPriority().val()?new yn(l,Yt(i)):n}else{const o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new yn(i))),o.forEachChild(bt,(l,c)=>{const d=KE(c,e.getImmediateChild(l),t);d!==c&&(s=s.updateImmediateChild(l,d))}),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QE{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function YE(n,e){let t=e instanceof ct?e:new ct(e),r=n,i=Me(t);for(;i!==null;){const s=Hu(r.node.children,i)||{children:{},childCount:0};r=new QE(i,r,s),t=_t(t),i=Me(t)}return r}function Ec(n){return n.node.value}function PR(n,e){n.node.value=e,p2(n)}function kR(n){return n.node.childCount>0}function cB(n){return Ec(n)===void 0&&!kR(n)}function D0(n,e){sr(n.node.children,(t,r)=>{e(new QE(t,n,r))})}function RR(n,e,t,r){t&&e(n),D0(n,i=>{RR(i,e,!0)})}function hB(n,e,t){let r=n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function _f(n){return new ct(n.parent===null?n.name:_f(n.parent)+"/"+n.name)}function p2(n){n.parent!==null&&dB(n.parent,n.name,n)}function dB(n,e,t){const r=cB(t),i=ss(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,p2(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,p2(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fB=/[\[\].#$\/\u0000-\u001F\u007F]/,pB=/[\[\].#$\u0000-\u001F\u007F]/,Ev=10*1024*1024,XE=function(n){return typeof n=="string"&&n.length!==0&&!fB.test(n)},xR=function(n){return typeof n=="string"&&n.length!==0&&!pB.test(n)},gB=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),xR(n)},AR=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!P0(n)||n&&typeof n=="object"&&ss(n,".sv")},g2=function(n,e,t,r){b0($u(n,"value"),e,t)},b0=function(n,e,t){const r=t instanceof ct?new bV(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Ga(r));if(typeof e=="function")throw new Error(n+"contains a function "+Ga(r)+" with contents = "+e.toString());if(P0(e))throw new Error(n+"contains "+e.toString()+" "+Ga(r));if(typeof e=="string"&&e.length>Ev/3&&n0(e)>Ev)throw new Error(n+"contains a string greater than "+Ev+" utf8 bytes "+Ga(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(sr(e,(o,l)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!XE(o)))throw new Error(n+" contains an invalid key ("+o+") "+Ga(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);OV(r,o),b0(n,l,r),MV(r)}),i&&s)throw new Error(n+' contains ".value" child '+Ga(r)+" in addition to actual children.")}},mB=function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];const s=Md(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!XE(s[o]))throw new Error(n+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(DV);let i=null;for(t=0;t<e.length;t++){if(r=e[t],i!==null&&ni(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},_B=function(n,e,t,r){const i=$u(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const s=[];sr(e,(o,l)=>{const c=new ct(o);if(b0(i,l,Wt(t,c)),xE(c)===".priority"&&!AR(l))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(c)}),mB(i,s)},yB=function(n,e,t){if(P0(e))throw new Error($u(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!AR(e))throw new Error($u(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},NR=function(n,e,t,r){if(!xR(t))throw new Error($u(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},vB=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),NR(n,e,t)},Lh=function(n,e){if(Me(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},wB=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!XE(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!gB(t))throw new Error($u(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EB{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function JE(n,e){let t=null;for(let r=0;r<e.length;r++){const i=e[r],s=i.getPath();t!==null&&!AE(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)}function DR(n,e,t){JE(n,t),bR(n,r=>AE(r,e))}function Js(n,e,t){JE(n,t),bR(n,r=>ni(r,e)||ni(e,r))}function bR(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const i=n.eventLists_[r];if(i){const s=i.path;e(s)?(SB(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function SB(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const r=t.getEventRunner();ed&&Mn("event: "+t.toString()),vc(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TB="repo_interrupt",CB=25;class IB{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new EB,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Em(),this.transactionQueueTree_=new QE,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function PB(n,e,t){if(n.stats_=kE(n.repoInfo_),n.forceRestClient_||rV())n.server_=new wm(n.repoInfo_,(r,i,s,o)=>{q3(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>K3(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Cn(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new zs(n.repoInfo_,e,(r,i,s,o)=>{q3(n,r,i,s,o)},r=>{K3(n,r)},r=>{RB(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=lV(n.repoInfo_,()=>new aU(n.stats_,n.server_)),n.infoData_=new nU,n.infoSyncTree_=new W3({startListening:(r,i,s,o)=>{let l=[];const c=n.infoData_.getNode(r._path);return c.isEmpty()||(l=A0(n.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),l},stopListening:()=>{}}),eS(n,"connected",!1),n.serverSyncTree_=new W3({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(l,c)=>{const d=o(l,c);Js(n.eventQueue_,r._path,d)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function kB(n){const t=n.infoData_.getNode(new ct(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function ZE(n){return oB({timestamp:kB(n)})}function q3(n,e,t,r,i){n.dataUpdateCount++;const s=new ct(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){const c=em(t,d=>Yt(d));o=tB(n.serverSyncTree_,s,c,i)}else{const c=Yt(t);o=eB(n.serverSyncTree_,s,c,i)}else if(r){const c=em(t,d=>Yt(d));o=XU(n.serverSyncTree_,s,c)}else{const c=Yt(t);o=A0(n.serverSyncTree_,s,c)}let l=s;o.length>0&&(l=O0(n,s)),Js(n.eventQueue_,l,o)}function K3(n,e){eS(n,"connected",e),e===!1&&AB(n)}function RB(n,e){sr(e,(t,r)=>{eS(n,t,r)})}function eS(n,e,t){const r=new ct("/.info/"+e),i=Yt(t);n.infoData_.updateSnapshot(r,i);const s=A0(n.infoSyncTree_,r,i);Js(n.eventQueue_,r,s)}function OR(n){return n.nextWriteId_++}function xB(n,e,t,r,i){tS(n,"set",{path:e.toString(),value:t,priority:r});const s=ZE(n),o=Yt(t,r),l=jE(n.serverSyncTree_,e),c=IR(o,l,s),d=OR(n),p=ER(n.serverSyncTree_,e,c,d,!0);JE(n.eventQueue_,p),n.server_.put(e.toString(),o.val(!0),(m,E)=>{const S=m==="ok";S||br("set at "+e+" failed: "+m);const k=Xa(n.serverSyncTree_,d,!S);Js(n.eventQueue_,e,k),rc(n,i,m,E)});const _=BR(n,e);O0(n,_),Js(n.eventQueue_,_,[])}function AB(n){tS(n,"onDisconnectEvents");const e=ZE(n),t=Em();a2(n.onDisconnect_,it(),(i,s)=>{const o=uB(i,s,n.serverSyncTree_,e);wc(t,i,o)});let r=[];a2(t,it(),(i,s)=>{r=r.concat(A0(n.serverSyncTree_,i,s));const o=BR(n,i);O0(n,o)}),n.onDisconnect_=Em(),Js(n.eventQueue_,it(),r)}function NB(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&o2(n.onDisconnect_,e),rc(n,t,r,i)})}function Q3(n,e,t,r){const i=Yt(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&wc(n.onDisconnect_,e,i),rc(n,r,s,o)})}function DB(n,e,t,r,i){const s=Yt(t,r);n.server_.onDisconnectPut(e.toString(),s.val(!0),(o,l)=>{o==="ok"&&wc(n.onDisconnect_,e,s),rc(n,i,o,l)})}function bB(n,e,t,r){if(Zg(t)){Mn("onDisconnect().update() called with empty data.  Don't do anything."),rc(n,r,"ok",void 0);return}n.server_.onDisconnectMerge(e.toString(),t,(i,s)=>{i==="ok"&&sr(t,(o,l)=>{const c=Yt(l);wc(n.onDisconnect_,Wt(e,o),c)}),rc(n,r,i,s)})}function OB(n,e,t){let r;Me(e._path)===".info"?r=H3(n.infoSyncTree_,e,t):r=H3(n.serverSyncTree_,e,t),DR(n.eventQueue_,e._path,r)}function MR(n,e,t){let r;Me(e._path)===".info"?r=f2(n.infoSyncTree_,e,t):r=f2(n.serverSyncTree_,e,t),DR(n.eventQueue_,e._path,r)}function MB(n){n.persistentConnection_&&n.persistentConnection_.interrupt(TB)}function tS(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Mn(t,...e)}function rc(n,e,t,r){e&&vc(()=>{if(t==="ok")e(null);else{const i=(t||"error").toUpperCase();let s=i;r&&(s+=": "+r);const o=new Error(s);o.code=i,e(o)}})}function LR(n,e,t){return jE(n.serverSyncTree_,e,t)||Ie.EMPTY_NODE}function nS(n,e=n.transactionQueueTree_){if(e||M0(n,e),Ec(e)){const t=VR(n,e);ie(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&LB(n,_f(e),t)}else kR(e)&&D0(e,t=>{nS(n,t)})}function LB(n,e,t){const r=t.map(d=>d.currentWriteId),i=LR(n,e,r);let s=i;const o=i.hash();for(let d=0;d<t.length;d++){const p=t[d];ie(p.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),p.status=1,p.retryCount++;const _=Rr(e,p.path);s=s.updateChild(_,p.currentOutputSnapshotRaw)}const l=s.val(!0),c=e;n.server_.put(c.toString(),l,d=>{tS(n,"transaction put response",{path:c.toString(),status:d});let p=[];if(d==="ok"){const _=[];for(let m=0;m<t.length;m++)t[m].status=2,p=p.concat(Xa(n.serverSyncTree_,t[m].currentWriteId)),t[m].onComplete&&_.push(()=>t[m].onComplete(null,!0,t[m].currentOutputSnapshotResolved)),t[m].unwatcher();M0(n,YE(n.transactionQueueTree_,e)),nS(n,n.transactionQueueTree_),Js(n.eventQueue_,e,p);for(let m=0;m<_.length;m++)vc(_[m])}else{if(d==="datastale")for(let _=0;_<t.length;_++)t[_].status===3?t[_].status=4:t[_].status=0;else{br("transaction at "+c.toString()+" failed: "+d);for(let _=0;_<t.length;_++)t[_].status=4,t[_].abortReason=d}O0(n,e)}},o)}function O0(n,e){const t=FR(n,e),r=_f(t),i=VR(n,t);return FB(n,i,r),r}function FB(n,e,t){if(e.length===0)return;const r=[];let i=[];const o=e.filter(l=>l.status===0).map(l=>l.currentWriteId);for(let l=0;l<e.length;l++){const c=e[l],d=Rr(t,c.path);let p=!1,_;if(ie(d!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)p=!0,_=c.abortReason,i=i.concat(Xa(n.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=CB)p=!0,_="maxretry",i=i.concat(Xa(n.serverSyncTree_,c.currentWriteId,!0));else{const m=LR(n,c.path,o);c.currentInputSnapshot=m;const E=e[l].update(m.val());if(E!==void 0){b0("transaction failed: Data returned ",E,c.path);let S=Yt(E);typeof E=="object"&&E!=null&&ss(E,".priority")||(S=S.updatePriority(m.getPriority()));const N=c.currentWriteId,x=ZE(n),R=IR(S,m,x);c.currentOutputSnapshotRaw=S,c.currentOutputSnapshotResolved=R,c.currentWriteId=OR(n),o.splice(o.indexOf(N),1),i=i.concat(ER(n.serverSyncTree_,c.path,R,c.currentWriteId,c.applyLocally)),i=i.concat(Xa(n.serverSyncTree_,N,!0))}else p=!0,_="nodata",i=i.concat(Xa(n.serverSyncTree_,c.currentWriteId,!0))}Js(n.eventQueue_,t,i),i=[],p&&(e[l].status=2,function(m){setTimeout(m,Math.floor(0))}(e[l].unwatcher),e[l].onComplete&&(_==="nodata"?r.push(()=>e[l].onComplete(null,!1,e[l].currentInputSnapshot)):r.push(()=>e[l].onComplete(new Error(_),!1,null))))}M0(n,n.transactionQueueTree_);for(let l=0;l<r.length;l++)vc(r[l]);nS(n,n.transactionQueueTree_)}function FR(n,e){let t,r=n.transactionQueueTree_;for(t=Me(e);t!==null&&Ec(r)===void 0;)r=YE(r,t),e=_t(e),t=Me(e);return r}function VR(n,e){const t=[];return UR(n,e,t),t.sort((r,i)=>r.order-i.order),t}function UR(n,e,t){const r=Ec(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);D0(e,i=>{UR(n,i,t)})}function M0(n,e){const t=Ec(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,PR(e,t.length>0?t:void 0)}D0(e,r=>{M0(n,r)})}function BR(n,e){const t=_f(FR(n,e)),r=YE(n.transactionQueueTree_,e);return hB(r,i=>{Sv(n,i)}),Sv(n,r),RR(r,i=>{Sv(n,i)}),t}function Sv(n,e){const t=Ec(e);if(t){const r=[];let i=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(ie(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(ie(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(Xa(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?PR(e,void 0):t.length=s+1,Js(n.eventQueue_,_f(e),i);for(let o=0;o<r.length;o++)vc(r[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VB(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function UB(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):br(`Invalid query segment '${t}' in query '${n}'`)}return e}const Y3=function(n,e){const t=BB(n),r=t.namespace;t.domain==="firebase.com"&&Xs(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&Xs("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||KF();const i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new H9(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new ct(t.pathString)}},BB=function(n){let e="",t="",r="",i="",s="",o=!0,l="https",c=443;if(typeof n=="string"){let d=n.indexOf("//");d>=0&&(l=n.substring(0,d-1),n=n.substring(d+2));let p=n.indexOf("/");p===-1&&(p=n.length);let _=n.indexOf("?");_===-1&&(_=n.length),e=n.substring(0,Math.min(p,_)),p<_&&(i=VB(n.substring(p,_)));const m=UB(n.substring(Math.min(n.length,_)));d=e.indexOf(":"),d>=0?(o=l==="https"||l==="wss",c=parseInt(e.substring(d+1),10)):d=e.length;const E=e.slice(0,d);if(E.toLowerCase()==="localhost")t="localhost";else if(E.split(".").length<=2)t=E;else{const S=e.indexOf(".");r=e.substring(0,S).toLowerCase(),t=e.substring(S+1),s=r}"ns"in m&&(s=m.ns)}return{host:e,port:c,domain:t,subdomain:r,secure:o,scheme:l,pathString:i,namespace:s}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zR{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Cn(this.snapshot.exportVal())}}class jR{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GR{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return ie(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zB{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new xs;return NB(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Lh("OnDisconnect.remove",this._path);const e=new xs;return Q3(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Lh("OnDisconnect.set",this._path),g2("OnDisconnect.set",e,this._path);const t=new xs;return Q3(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){Lh("OnDisconnect.setWithPriority",this._path),g2("OnDisconnect.setWithPriority",e,this._path),yB("OnDisconnect.setWithPriority",t);const r=new xs;return DB(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){Lh("OnDisconnect.update",this._path),_B("OnDisconnect.update",e,this._path);const t=new xs;return bB(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rS{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return Fe(this._path)?null:xE(this._path)}get ref(){return new to(this._repo,this._path)}get _queryIdentifier(){const e=b3(this._queryParams),t=IE(e);return t==="{}"?"default":t}get _queryObject(){return b3(this._queryParams)}isEqual(e){if(e=vt(e),!(e instanceof rS))return!1;const t=this._repo===e._repo,r=AE(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+NV(this._path)}}class to extends rS{constructor(e,t){super(e,t,new OE,!1)}get parent(){const e=eR(this._path);return e===null?null:new to(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class zd{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new ct(e),r=xm(this.ref,e);return new zd(this._node.getChild(t),r,bt)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new zd(i,xm(this.ref,r),bt)))}hasChild(e){const t=new ct(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Cl(n,e){return n=vt(n),n._checkNotDeleted("ref"),e!==void 0?xm(n._root,e):n._root}function xm(n,e){return n=vt(n),Me(n._path)===null?vB("child","path",e):NR("child","path",e),new to(n._repo,Wt(n._path,e))}function WR(n){return n=vt(n),new zB(n._repo,n._path)}function L0(n,e){n=vt(n),Lh("set",n._path),g2("set",e,n._path);const t=new xs;return xB(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}class F0{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const r=t._queryParams.getIndex();return new zR("value",this,new zd(e.snapshotNode,new to(t._repo,t._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new jR(this,e,t):null}matches(e){return e instanceof F0?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class iS{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t=e==="children_added"?"child_added":e;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new jR(this,e,t):null}createEvent(e,t){ie(e.childName!=null,"Child events should have a childName.");const r=xm(new to(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new zR(e.type,this,new zd(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof iS?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function jB(n,e,t,r,i){const s=new GR(t,void 0),o=new F0(s);return OB(n._repo,n,o),()=>MR(n._repo,n,o)}function sS(n,e,t,r){return jB(n,"value",e)}function HR(n,e,t){let r=null;const i=t?new GR(t):null;e==="value"?r=new F0(i):e&&(r=new iS(e,i)),MR(n._repo,n,r)}jU(to);KU(to);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GB="FIREBASE_DATABASE_EMULATOR_HOST",m2={};let WB=!1;function HB(n,e,t,r){n.repoInfo_=new H9(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}function $B(n,e,t,r,i){let s=r||n.options.databaseURL;s===void 0&&(n.options.projectId||Xs("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Mn("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=Y3(s,i),l=o.repoInfo,c;typeof process<"u"&&g3&&(c=g3[GB]),c?(s=`http://${c}?ns=${l.namespace}`,o=Y3(s,i),l=o.repoInfo):o.repoInfo.secure;const d=new sV(n.name,n.options,e);wB("Invalid Firebase Database URL",o),Fe(o.path)||Xs("Database URL must point to the root of a Firebase Database (not including a child path).");const p=KB(l,n,d,new iV(n.name,t));return new QB(p,n)}function qB(n,e){const t=m2[e];(!t||t[n.key]!==n)&&Xs(`Database ${e}(${n.repoInfo_}) has already been deleted.`),MB(n),delete t[n.key]}function KB(n,e,t,r){let i=m2[e.name];i||(i={},m2[e.name]=i);let s=i[n.toURLString()];return s&&Xs("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new IB(n,WB,t,r),i[n.toURLString()]=s,s}class QB{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(PB(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new to(this._repo,it())),this._rootInternal}_delete(){return this._rootInternal!==null&&(qB(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Xs("Cannot call "+e+" on a deleted database.")}}function pa(n=xw(),e){const t=i0(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const r=cP("database");r&&$R(t,...r)}return t}function $R(n,e,t,r={}){n=vt(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&Xs("Cannot call useEmulator() after instance has already been initialized.");const i=n._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Xs('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Tg(Tg.OWNER);else if(r.mockUserToken){const o=typeof r.mockUserToken=="string"?r.mockUserToken:fP(r.mockUserToken,n.app.options.projectId);s=new Tg(o)}HB(i,e,t,s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YB(n){jF(vl),ol(new Xo("database",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return $B(r,i,s,t)},"PUBLIC").setMultipleInstances(!0)),ts(m3,_3,n),ts(m3,_3,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XB={".sv":"timestamp"};function Am(){return XB}zs.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};zs.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};YB();const JB={apiKey:"AIzaSyDQZvIf-wol_S9nLsAHlFNfyBSxViW8xWc",authDomain:"collabcanvas-d5bce.firebaseapp.com",projectId:"collabcanvas-d5bce",storageBucket:"collabcanvas-d5bce.firebasestorage.app",messagingSenderId:"484501248859",appId:"1:484501248859:web:026a6bbbaa8652239b587e",databaseURL:"https://collabcanvas-d5bce-default-rtdb.firebaseio.com"},oS=yP(JB),ic=FO(oS),nr=IF(oS),ZB=pa(oS);{console.log("🔥 Using Firebase Emulators (FREE - no quota usage)");try{UP(ic,"http://localhost:9099",{disableWarnings:!0}),console.log("✅ Auth Emulator connected")}catch{console.log("Auth emulator already connected")}try{f9(nr,"localhost",8080),console.log("✅ Firestore Emulator connected (FREE)")}catch{console.log("Firestore emulator already connected")}try{$R(ZB,"localhost",9e3),console.log("✅ Realtime Database Emulator connected (FREE)")}catch{console.log("Realtime Database emulator already connected")}}const _2=n=>{const e=(n==null?void 0:n.code)||"unknown",t={"auth/user-not-found":"No account found with this email address. Please check your email or create a new account.","auth/wrong-password":"Incorrect password. Please try again or reset your password.","auth/invalid-email":"Please enter a valid email address.","auth/user-disabled":"This account has been disabled. Please contact support.","auth/too-many-requests":"Too many failed attempts. Please try again later.","auth/invalid-credential":"Invalid email or password. Please check your credentials and try again.","auth/email-already-in-use":"An account with this email already exists. Try logging in instead.","auth/weak-password":"Password should be at least 6 characters long.","auth/operation-not-allowed":"Email/password accounts are not enabled. Please contact support.","auth/popup-closed-by-user":"Sign-in was cancelled. Please try again.","auth/popup-blocked":"Pop-up was blocked by your browser. Please allow pop-ups and try again.","auth/cancelled-popup-request":"Sign-in was cancelled. Please try again.","auth/account-exists-with-different-credential":"An account already exists with this email using a different sign-in method.","auth/network-request-failed":"Network error. Please check your internet connection and try again.","auth/timeout":"Request timed out. Please check your connection and try again.","auth/internal-error":"Something went wrong. Please try again.",unknown:"An unexpected error occurred. Please try again."};return t[e]||t.unknown},y2=n=>["auth/network-request-failed","auth/timeout","auth/too-many-requests","auth/internal-error","auth/popup-blocked"].includes(n==null?void 0:n.code),v2=n=>{const e=n==null?void 0:n.code;return{"auth/user-not-found":"Create Account","auth/email-already-in-use":"Sign In Instead","auth/popup-blocked":"Enable Pop-ups","auth/weak-password":"Use Stronger Password"}[e]||void 0},ez=({onSuccess:n,onSwitchToRegister:e})=>{const[t,r]=me.useState(""),[i,s]=me.useState(""),[o,l]=me.useState(!1),[c,d]=me.useState(null),p=async m=>{m.preventDefault(),l(!0),d(null);try{await Sb(ic,t,i),n==null||n()}catch(E){d({message:_2(E),action:v2(E),retryable:y2(E)})}finally{l(!1)}},_=async()=>{l(!0),d(null);try{const m=new As;await $b(ic,m),n==null||n()}catch(m){d({message:_2(m),action:v2(m),retryable:y2(m)})}finally{l(!1)}};return z.jsxs("div",{className:"max-w-md mx-auto bg-white rounded-lg shadow-md p-6",children:[z.jsx("h2",{className:"text-2xl font-bold mb-6 text-center text-gray-800",children:"Sign In"}),c&&z.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:z.jsxs("div",{className:"flex items-start gap-3",children:[z.jsx("div",{className:"text-red-500 text-lg",children:"⚠️"}),z.jsxs("div",{className:"flex-1",children:[z.jsx("div",{className:"text-red-800 font-medium text-sm mb-1",children:"Sign In Error"}),z.jsx("div",{className:"text-red-700 text-sm",children:c.message}),c.action&&z.jsx("button",{onClick:()=>{c.action==="Create Account"&&(e==null||e()),d(null)},className:"mt-2 text-sm text-red-600 hover:text-red-800 underline",children:c.action}),c.retryable&&z.jsx("button",{onClick:()=>d(null),className:"mt-2 ml-2 text-sm text-red-600 hover:text-red-800 underline",children:"Try Again"})]})]})}),z.jsxs("form",{onSubmit:p,className:"space-y-4",children:[z.jsxs("div",{children:[z.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),z.jsx("input",{id:"email",type:"email",value:t,onChange:m=>r(m.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:o})]}),z.jsxs("div",{children:[z.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),z.jsx("input",{id:"password",type:"password",value:i,onChange:m=>s(m.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:o})]}),z.jsx("button",{type:"submit",disabled:o,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 disabled:opacity-50",children:o?"Signing In...":"Sign In"})]}),z.jsx("div",{className:"my-4 text-center text-gray-500",children:"or"}),z.jsx("button",{onClick:_,disabled:o,className:"w-full bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700 disabled:opacity-50",children:"Sign in with Google"}),z.jsx("div",{className:"mt-4 text-center",children:z.jsx("button",{onClick:e,className:"text-blue-600 hover:underline text-sm",children:"Need an account? Sign up"})})]})},tz=({onSuccess:n,onSwitchToLogin:e})=>{const[t,r]=me.useState(""),[i,s]=me.useState(""),[o,l]=me.useState(""),[c,d]=me.useState(!1),[p,_]=me.useState(null),m=async E=>{if(E.preventDefault(),d(!0),_(null),i!==o){_({message:"Passwords do not match"}),d(!1);return}if(i.length<6){_({message:"Password must be at least 6 characters"}),d(!1);return}try{await Eb(ic,t,i),n==null||n()}catch(S){_({message:_2(S),action:v2(S),retryable:y2(S)})}finally{d(!1)}};return z.jsxs("div",{className:"max-w-md mx-auto bg-white rounded-lg shadow-md p-6",children:[z.jsx("h2",{className:"text-2xl font-bold mb-6 text-center text-gray-800",children:"Create Account"}),p&&z.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:z.jsxs("div",{className:"flex items-start gap-3",children:[z.jsx("div",{className:"text-red-500 text-lg",children:"⚠️"}),z.jsxs("div",{className:"flex-1",children:[z.jsx("div",{className:"text-red-800 font-medium text-sm mb-1",children:"Registration Error"}),z.jsx("div",{className:"text-red-700 text-sm",children:p.message}),p.action&&z.jsx("button",{onClick:()=>{p.action==="Sign In Instead"&&(e==null||e()),_(null)},className:"mt-2 text-sm text-red-600 hover:text-red-800 underline",children:p.action}),p.retryable&&z.jsx("button",{onClick:()=>_(null),className:"mt-2 ml-2 text-sm text-red-600 hover:text-red-800 underline",children:"Try Again"})]})]})}),z.jsxs("form",{onSubmit:m,className:"space-y-4",children:[z.jsxs("div",{children:[z.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),z.jsx("input",{id:"email",type:"email",value:t,onChange:E=>r(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:c})]}),z.jsxs("div",{children:[z.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),z.jsx("input",{id:"password",type:"password",value:i,onChange:E=>s(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:c,minLength:6})]}),z.jsxs("div",{children:[z.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password"}),z.jsx("input",{id:"confirmPassword",type:"password",value:o,onChange:E=>l(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:c})]}),z.jsx("button",{type:"submit",disabled:c,className:"w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 disabled:opacity-50",children:c?"Creating Account...":"Create Account"})]}),z.jsx("div",{className:"mt-4 text-center",children:z.jsx("button",{onClick:e,className:"text-blue-600 hover:underline text-sm",children:"Already have an account? Sign in"})})]})},nz=({onAuthSuccess:n})=>{const[e,t]=me.useState(!0),r=()=>{n==null||n()},i=()=>t(!0),s=()=>t(!1);return z.jsx("div",{className:"w-full max-w-md mx-auto",children:e?z.jsx(ez,{onSuccess:r,onSwitchToRegister:s}):z.jsx(tz,{onSuccess:r,onSwitchToLogin:i})})};var qR={exports:{}},V0={},Nm={},Oe={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n._registerNode=n.Konva=n.glob=void 0;const e=Math.PI/180;function t(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}n.glob=typeof G4<"u"?G4:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},n.Konva={_global:n.glob,version:"9.3.22",isBrowser:t(),isUnminified:/param/.test((function(i){}).toString()),dblClickWindow:400,getAngle(i){return n.Konva.angleDeg?i*e:i},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return n.Konva.DD.isDragging},isTransforming(){var i;return(i=n.Konva.Transformer)===null||i===void 0?void 0:i.isTransforming()},isDragReady(){return!!n.Konva.DD.node},releaseCanvasOnDestroy:!0,document:n.glob.document,_injectGlobal(i){n.glob.Konva=i}};const r=i=>{n.Konva[i.prototype.getClassName()]=i};n._registerNode=r,n.Konva._injectGlobal(n.Konva)})(Oe);var Lt={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Util=n.Transform=void 0;const e=Oe;class t{constructor(P=[1,0,0,1,0,0]){this.dirty=!1,this.m=P&&P.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new t(this.m)}copyInto(P){P.m[0]=this.m[0],P.m[1]=this.m[1],P.m[2]=this.m[2],P.m[3]=this.m[3],P.m[4]=this.m[4],P.m[5]=this.m[5]}point(P){const F=this.m;return{x:F[0]*P.x+F[2]*P.y+F[4],y:F[1]*P.x+F[3]*P.y+F[5]}}translate(P,F){return this.m[4]+=this.m[0]*P+this.m[2]*F,this.m[5]+=this.m[1]*P+this.m[3]*F,this}scale(P,F){return this.m[0]*=P,this.m[1]*=P,this.m[2]*=F,this.m[3]*=F,this}rotate(P){const F=Math.cos(P),U=Math.sin(P),D=this.m[0]*F+this.m[2]*U,C=this.m[1]*F+this.m[3]*U,b=this.m[0]*-U+this.m[2]*F,A=this.m[1]*-U+this.m[3]*F;return this.m[0]=D,this.m[1]=C,this.m[2]=b,this.m[3]=A,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(P,F){const U=this.m[0]+this.m[2]*F,D=this.m[1]+this.m[3]*F,C=this.m[2]+this.m[0]*P,b=this.m[3]+this.m[1]*P;return this.m[0]=U,this.m[1]=D,this.m[2]=C,this.m[3]=b,this}multiply(P){const F=this.m[0]*P.m[0]+this.m[2]*P.m[1],U=this.m[1]*P.m[0]+this.m[3]*P.m[1],D=this.m[0]*P.m[2]+this.m[2]*P.m[3],C=this.m[1]*P.m[2]+this.m[3]*P.m[3],b=this.m[0]*P.m[4]+this.m[2]*P.m[5]+this.m[4],A=this.m[1]*P.m[4]+this.m[3]*P.m[5]+this.m[5];return this.m[0]=F,this.m[1]=U,this.m[2]=D,this.m[3]=C,this.m[4]=b,this.m[5]=A,this}invert(){const P=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),F=this.m[3]*P,U=-this.m[1]*P,D=-this.m[2]*P,C=this.m[0]*P,b=P*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),A=P*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=F,this.m[1]=U,this.m[2]=D,this.m[3]=C,this.m[4]=b,this.m[5]=A,this}getMatrix(){return this.m}decompose(){const P=this.m[0],F=this.m[1],U=this.m[2],D=this.m[3],C=this.m[4],b=this.m[5],A=P*D-F*U,M={x:C,y:b,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(P!=0||F!=0){const B=Math.sqrt(P*P+F*F);M.rotation=F>0?Math.acos(P/B):-Math.acos(P/B),M.scaleX=B,M.scaleY=A/B,M.skewX=(P*U+F*D)/A,M.skewY=0}else if(U!=0||D!=0){const B=Math.sqrt(U*U+D*D);M.rotation=Math.PI/2-(D>0?Math.acos(-U/B):-Math.acos(U/B)),M.scaleX=A/B,M.scaleY=B,M.skewX=0,M.skewY=(P*U+F*D)/A}return M.rotation=n.Util._getRotation(M.rotation),M}}n.Transform=t;const r="[object Array]",i="[object Number]",s="[object String]",o="[object Boolean]",l=Math.PI/180,c=180/Math.PI,d="#",p="",_="0",m="Konva warning: ",E="Konva error: ",S="rgb(",k={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},N=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let x=[];const R=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(w){setTimeout(w,60)};n.Util={_isElement(w){return!!(w&&w.nodeType==1)},_isFunction(w){return!!(w&&w.constructor&&w.call&&w.apply)},_isPlainObject(w){return!!w&&w.constructor===Object},_isArray(w){return Object.prototype.toString.call(w)===r},_isNumber(w){return Object.prototype.toString.call(w)===i&&!isNaN(w)&&isFinite(w)},_isString(w){return Object.prototype.toString.call(w)===s},_isBoolean(w){return Object.prototype.toString.call(w)===o},isObject(w){return w instanceof Object},isValidSelector(w){if(typeof w!="string")return!1;const P=w[0];return P==="#"||P==="."||P===P.toUpperCase()},_sign(w){return w===0||w>0?1:-1},requestAnimFrame(w){x.push(w),x.length===1&&R(function(){const P=x;x=[],P.forEach(function(F){F()})})},createCanvasElement(){const w=document.createElement("canvas");try{w.style=w.style||{}}catch{}return w},createImageElement(){return document.createElement("img")},_isInDocument(w){for(;w=w.parentNode;)if(w==document)return!0;return!1},_urlToImage(w,P){const F=n.Util.createImageElement();F.onload=function(){P(F)},F.src=w},_rgbToHex(w,P,F){return((1<<24)+(w<<16)+(P<<8)+F).toString(16).slice(1)},_hexToRgb(w){w=w.replace(d,p);const P=parseInt(w,16);return{r:P>>16&255,g:P>>8&255,b:P&255}},getRandomColor(){let w=(Math.random()*16777215<<0).toString(16);for(;w.length<6;)w=_+w;return d+w},getRGB(w){let P;return w in k?(P=k[w],{r:P[0],g:P[1],b:P[2]}):w[0]===d?this._hexToRgb(w.substring(1)):w.substr(0,4)===S?(P=N.exec(w.replace(/ /g,"")),{r:parseInt(P[1],10),g:parseInt(P[2],10),b:parseInt(P[3],10)}):{r:0,g:0,b:0}},colorToRGBA(w){return w=w||"black",n.Util._namedColorToRBA(w)||n.Util._hex3ColorToRGBA(w)||n.Util._hex4ColorToRGBA(w)||n.Util._hex6ColorToRGBA(w)||n.Util._hex8ColorToRGBA(w)||n.Util._rgbColorToRGBA(w)||n.Util._rgbaColorToRGBA(w)||n.Util._hslColorToRGBA(w)},_namedColorToRBA(w){const P=k[w.toLowerCase()];return P?{r:P[0],g:P[1],b:P[2],a:1}:null},_rgbColorToRGBA(w){if(w.indexOf("rgb(")===0){w=w.match(/rgb\(([^)]+)\)/)[1];const P=w.split(/ *, */).map(Number);return{r:P[0],g:P[1],b:P[2],a:1}}},_rgbaColorToRGBA(w){if(w.indexOf("rgba(")===0){w=w.match(/rgba\(([^)]+)\)/)[1];const P=w.split(/ *, */).map((F,U)=>F.slice(-1)==="%"?U===3?parseInt(F)/100:parseInt(F)/100*255:Number(F));return{r:P[0],g:P[1],b:P[2],a:P[3]}}},_hex8ColorToRGBA(w){if(w[0]==="#"&&w.length===9)return{r:parseInt(w.slice(1,3),16),g:parseInt(w.slice(3,5),16),b:parseInt(w.slice(5,7),16),a:parseInt(w.slice(7,9),16)/255}},_hex6ColorToRGBA(w){if(w[0]==="#"&&w.length===7)return{r:parseInt(w.slice(1,3),16),g:parseInt(w.slice(3,5),16),b:parseInt(w.slice(5,7),16),a:1}},_hex4ColorToRGBA(w){if(w[0]==="#"&&w.length===5)return{r:parseInt(w[1]+w[1],16),g:parseInt(w[2]+w[2],16),b:parseInt(w[3]+w[3],16),a:parseInt(w[4]+w[4],16)/255}},_hex3ColorToRGBA(w){if(w[0]==="#"&&w.length===4)return{r:parseInt(w[1]+w[1],16),g:parseInt(w[2]+w[2],16),b:parseInt(w[3]+w[3],16),a:1}},_hslColorToRGBA(w){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(w)){const[P,...F]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(w),U=Number(F[0])/360,D=Number(F[1])/100,C=Number(F[2])/100;let b,A,M;if(D===0)return M=C*255,{r:Math.round(M),g:Math.round(M),b:Math.round(M),a:1};C<.5?b=C*(1+D):b=C+D-C*D;const B=2*C-b,V=[0,0,0];for(let fe=0;fe<3;fe++)A=U+1/3*-(fe-1),A<0&&A++,A>1&&A--,6*A<1?M=B+(b-B)*6*A:2*A<1?M=b:3*A<2?M=B+(b-B)*(2/3-A)*6:M=B,V[fe]=M*255;return{r:Math.round(V[0]),g:Math.round(V[1]),b:Math.round(V[2]),a:1}}},haveIntersection(w,P){return!(P.x>w.x+w.width||P.x+P.width<w.x||P.y>w.y+w.height||P.y+P.height<w.y)},cloneObject(w){const P={};for(const F in w)this._isPlainObject(w[F])?P[F]=this.cloneObject(w[F]):this._isArray(w[F])?P[F]=this.cloneArray(w[F]):P[F]=w[F];return P},cloneArray(w){return w.slice(0)},degToRad(w){return w*l},radToDeg(w){return w*c},_degToRad(w){return n.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),n.Util.degToRad(w)},_radToDeg(w){return n.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),n.Util.radToDeg(w)},_getRotation(w){return e.Konva.angleDeg?n.Util.radToDeg(w):w},_capitalize(w){return w.charAt(0).toUpperCase()+w.slice(1)},throw(w){throw new Error(E+w)},error(w){console.error(E+w)},warn(w){e.Konva.showWarnings&&console.warn(m+w)},each(w,P){for(const F in w)P(F,w[F])},_inRange(w,P,F){return P<=w&&w<F},_getProjectionToSegment(w,P,F,U,D,C){let b,A,M;const B=(w-F)*(w-F)+(P-U)*(P-U);if(B==0)b=w,A=P,M=(D-F)*(D-F)+(C-U)*(C-U);else{const V=((D-w)*(F-w)+(C-P)*(U-P))/B;V<0?(b=w,A=P,M=(w-D)*(w-D)+(P-C)*(P-C)):V>1?(b=F,A=U,M=(F-D)*(F-D)+(U-C)*(U-C)):(b=w+V*(F-w),A=P+V*(U-P),M=(b-D)*(b-D)+(A-C)*(A-C))}return[b,A,M]},_getProjectionToLine(w,P,F){const U=n.Util.cloneObject(w);let D=Number.MAX_VALUE;return P.forEach(function(C,b){if(!F&&b===P.length-1)return;const A=P[(b+1)%P.length],M=n.Util._getProjectionToSegment(C.x,C.y,A.x,A.y,w.x,w.y),B=M[0],V=M[1],fe=M[2];fe<D&&(U.x=B,U.y=V,D=fe)}),U},_prepareArrayForTween(w,P,F){const U=[],D=[];if(w.length>P.length){const b=P;P=w,w=b}for(let b=0;b<w.length;b+=2)U.push({x:w[b],y:w[b+1]});for(let b=0;b<P.length;b+=2)D.push({x:P[b],y:P[b+1]});const C=[];return D.forEach(function(b){const A=n.Util._getProjectionToLine(b,U,F);C.push(A.x),C.push(A.y)}),C},_prepareToStringify(w){let P;w.visitedByCircularReferenceRemoval=!0;for(const F in w)if(w.hasOwnProperty(F)&&w[F]&&typeof w[F]=="object"){if(P=Object.getOwnPropertyDescriptor(w,F),w[F].visitedByCircularReferenceRemoval||n.Util._isElement(w[F]))if(P.configurable)delete w[F];else return null;else if(n.Util._prepareToStringify(w[F])===null)if(P.configurable)delete w[F];else return null}return delete w.visitedByCircularReferenceRemoval,w},_assign(w,P){for(const F in P)w[F]=P[F];return w},_getFirstPointerId(w){return w.touches?w.changedTouches[0].identifier:w.pointerId||999},releaseCanvas(...w){e.Konva.releaseCanvasOnDestroy&&w.forEach(P=>{P.width=0,P.height=0})},drawRoundedRectPath(w,P,F,U){let D=0,C=0,b=0,A=0;typeof U=="number"?D=C=b=A=Math.min(U,P/2,F/2):(D=Math.min(U[0]||0,P/2,F/2),C=Math.min(U[1]||0,P/2,F/2),A=Math.min(U[2]||0,P/2,F/2),b=Math.min(U[3]||0,P/2,F/2)),w.moveTo(D,0),w.lineTo(P-C,0),w.arc(P-C,C,C,Math.PI*3/2,0,!1),w.lineTo(P,F-A),w.arc(P-A,F-A,A,0,Math.PI/2,!1),w.lineTo(b,F),w.arc(b,F-b,b,Math.PI/2,Math.PI,!1),w.lineTo(0,D),w.arc(D,D,D,Math.PI,Math.PI*3/2,!1)}}})(Lt);var Rt={},Ai={},js={};Object.defineProperty(js,"__esModule",{value:!0});js.HitContext=js.SceneContext=js.Context=void 0;const KR=Lt,rz=Oe;function iz(n){const e=[],t=n.length,r=KR.Util;for(let i=0;i<t;i++){let s=n[i];r._isNumber(s)?s=Math.round(s*1e3)/1e3:r._isString(s)||(s=s+""),e.push(s)}return e}const X3=",",sz="(",oz=")",az="([",lz="])",uz=";",cz="()",hz="=",J3=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],dz=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],fz=100;class U0{constructor(e){this.canvas=e,rz.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(e){e.fillEnabled()&&this._fill(e)}_fill(e){}strokeShape(e){e.hasStroke()&&this._stroke(e)}_stroke(e){}fillStrokeShape(e){e.attrs.fillAfterStrokeEnabled?(this.strokeShape(e),this.fillShape(e)):(this.fillShape(e),this.strokeShape(e))}getTrace(e,t){let r=this.traceArr,i=r.length,s="",o,l,c,d;for(o=0;o<i;o++)l=r[o],c=l.method,c?(d=l.args,s+=c,e?s+=cz:KR.Util._isArray(d[0])?s+=az+d.join(X3)+lz:(t&&(d=d.map(p=>typeof p=="number"?Math.floor(p):p)),s+=sz+d.join(X3)+oz)):(s+=l.property,e||(s+=hz+l.val)),s+=uz;return s}clearTrace(){this.traceArr=[]}_trace(e){let t=this.traceArr,r;t.push(e),r=t.length,r>=fz&&t.shift()}reset(){const e=this.getCanvas().getPixelRatio();this.setTransform(1*e,0,0,1*e,0,0)}getCanvas(){return this.canvas}clear(e){const t=this.getCanvas();e?this.clearRect(e.x||0,e.y||0,e.width||0,e.height||0):this.clearRect(0,0,t.getWidth()/t.pixelRatio,t.getHeight()/t.pixelRatio)}_applyLineCap(e){const t=e.attrs.lineCap;t&&this.setAttr("lineCap",t)}_applyOpacity(e){const t=e.getAbsoluteOpacity();t!==1&&this.setAttr("globalAlpha",t)}_applyLineJoin(e){const t=e.attrs.lineJoin;t&&this.setAttr("lineJoin",t)}setAttr(e,t){this._context[e]=t}arc(e,t,r,i,s,o){this._context.arc(e,t,r,i,s,o)}arcTo(e,t,r,i,s){this._context.arcTo(e,t,r,i,s)}beginPath(){this._context.beginPath()}bezierCurveTo(e,t,r,i,s,o){this._context.bezierCurveTo(e,t,r,i,s,o)}clearRect(e,t,r,i){this._context.clearRect(e,t,r,i)}clip(...e){this._context.clip.apply(this._context,e)}closePath(){this._context.closePath()}createImageData(e,t){const r=arguments;if(r.length===2)return this._context.createImageData(e,t);if(r.length===1)return this._context.createImageData(e)}createLinearGradient(e,t,r,i){return this._context.createLinearGradient(e,t,r,i)}createPattern(e,t){return this._context.createPattern(e,t)}createRadialGradient(e,t,r,i,s,o){return this._context.createRadialGradient(e,t,r,i,s,o)}drawImage(e,t,r,i,s,o,l,c,d){const p=arguments,_=this._context;p.length===3?_.drawImage(e,t,r):p.length===5?_.drawImage(e,t,r,i,s):p.length===9&&_.drawImage(e,t,r,i,s,o,l,c,d)}ellipse(e,t,r,i,s,o,l,c){this._context.ellipse(e,t,r,i,s,o,l,c)}isPointInPath(e,t,r,i){return r?this._context.isPointInPath(r,e,t,i):this._context.isPointInPath(e,t,i)}fill(...e){this._context.fill.apply(this._context,e)}fillRect(e,t,r,i){this._context.fillRect(e,t,r,i)}strokeRect(e,t,r,i){this._context.strokeRect(e,t,r,i)}fillText(e,t,r,i){i?this._context.fillText(e,t,r,i):this._context.fillText(e,t,r)}measureText(e){return this._context.measureText(e)}getImageData(e,t,r,i){return this._context.getImageData(e,t,r,i)}lineTo(e,t){this._context.lineTo(e,t)}moveTo(e,t){this._context.moveTo(e,t)}rect(e,t,r,i){this._context.rect(e,t,r,i)}roundRect(e,t,r,i,s){this._context.roundRect(e,t,r,i,s)}putImageData(e,t,r){this._context.putImageData(e,t,r)}quadraticCurveTo(e,t,r,i){this._context.quadraticCurveTo(e,t,r,i)}restore(){this._context.restore()}rotate(e){this._context.rotate(e)}save(){this._context.save()}scale(e,t){this._context.scale(e,t)}setLineDash(e){this._context.setLineDash?this._context.setLineDash(e):"mozDash"in this._context?this._context.mozDash=e:"webkitLineDash"in this._context&&(this._context.webkitLineDash=e)}getLineDash(){return this._context.getLineDash()}setTransform(e,t,r,i,s,o){this._context.setTransform(e,t,r,i,s,o)}stroke(e){e?this._context.stroke(e):this._context.stroke()}strokeText(e,t,r,i){this._context.strokeText(e,t,r,i)}transform(e,t,r,i,s,o){this._context.transform(e,t,r,i,s,o)}translate(e,t){this._context.translate(e,t)}_enableTrace(){let e=this,t=J3.length,r=this.setAttr,i,s;const o=function(l){let c=e[l],d;e[l]=function(){return s=iz(Array.prototype.slice.call(arguments,0)),d=c.apply(e,arguments),e._trace({method:l,args:s}),d}};for(i=0;i<t;i++)o(J3[i]);e.setAttr=function(){r.apply(e,arguments);const l=arguments[0];let c=arguments[1];(l==="shadowOffsetX"||l==="shadowOffsetY"||l==="shadowBlur")&&(c=c/this.canvas.getPixelRatio()),e._trace({property:l,val:c})}}_applyGlobalCompositeOperation(e){const t=e.attrs.globalCompositeOperation;!t||t==="source-over"||this.setAttr("globalCompositeOperation",t)}}js.Context=U0;dz.forEach(function(n){Object.defineProperty(U0.prototype,n,{get(){return this._context[n]},set(e){this._context[n]=e}})});class pz extends U0{constructor(e,{willReadFrequently:t=!1}={}){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:t})}_fillColor(e){const t=e.fill();this.setAttr("fillStyle",t),e._fillFunc(this)}_fillPattern(e){this.setAttr("fillStyle",e._getFillPattern()),e._fillFunc(this)}_fillLinearGradient(e){const t=e._getLinearGradient();t&&(this.setAttr("fillStyle",t),e._fillFunc(this))}_fillRadialGradient(e){const t=e._getRadialGradient();t&&(this.setAttr("fillStyle",t),e._fillFunc(this))}_fill(e){const t=e.fill(),r=e.getFillPriority();if(t&&r==="color"){this._fillColor(e);return}const i=e.getFillPatternImage();if(i&&r==="pattern"){this._fillPattern(e);return}const s=e.getFillLinearGradientColorStops();if(s&&r==="linear-gradient"){this._fillLinearGradient(e);return}const o=e.getFillRadialGradientColorStops();if(o&&r==="radial-gradient"){this._fillRadialGradient(e);return}t?this._fillColor(e):i?this._fillPattern(e):s?this._fillLinearGradient(e):o&&this._fillRadialGradient(e)}_strokeLinearGradient(e){const t=e.getStrokeLinearGradientStartPoint(),r=e.getStrokeLinearGradientEndPoint(),i=e.getStrokeLinearGradientColorStops(),s=this.createLinearGradient(t.x,t.y,r.x,r.y);if(i){for(let o=0;o<i.length;o+=2)s.addColorStop(i[o],i[o+1]);this.setAttr("strokeStyle",s)}}_stroke(e){const t=e.dash(),r=e.getStrokeScaleEnabled();if(e.hasStroke()){if(!r){this.save();const s=this.getCanvas().getPixelRatio();this.setTransform(s,0,0,s,0,0)}this._applyLineCap(e),t&&e.dashEnabled()&&(this.setLineDash(t),this.setAttr("lineDashOffset",e.dashOffset())),this.setAttr("lineWidth",e.strokeWidth()),e.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),e.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(e):this.setAttr("strokeStyle",e.stroke()),e._strokeFunc(this),r||this.restore()}}_applyShadow(e){var t,r,i;const s=(t=e.getShadowRGBA())!==null&&t!==void 0?t:"black",o=(r=e.getShadowBlur())!==null&&r!==void 0?r:5,l=(i=e.getShadowOffset())!==null&&i!==void 0?i:{x:0,y:0},c=e.getAbsoluteScale(),d=this.canvas.getPixelRatio(),p=c.x*d,_=c.y*d;this.setAttr("shadowColor",s),this.setAttr("shadowBlur",o*Math.min(Math.abs(p),Math.abs(_))),this.setAttr("shadowOffsetX",l.x*p),this.setAttr("shadowOffsetY",l.y*_)}}js.SceneContext=pz;class gz extends U0{constructor(e){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:!0})}_fill(e){this.save(),this.setAttr("fillStyle",e.colorKey),e._fillFuncHit(this),this.restore()}strokeShape(e){e.hasHitStroke()&&this._stroke(e)}_stroke(e){if(e.hasHitStroke()){const t=e.getStrokeScaleEnabled();if(!t){this.save();const s=this.getCanvas().getPixelRatio();this.setTransform(s,0,0,s,0,0)}this._applyLineCap(e);const r=e.hitStrokeWidth(),i=r==="auto"?e.strokeWidth():r;this.setAttr("lineWidth",i),this.setAttr("strokeStyle",e.colorKey),e._strokeFuncHit(this),t||this.restore()}}}js.HitContext=gz;Object.defineProperty(Ai,"__esModule",{value:!0});Ai.HitCanvas=Ai.SceneCanvas=Ai.Canvas=void 0;const Dm=Lt,QR=js,YR=Oe;let Yp;function mz(){if(Yp)return Yp;const n=Dm.Util.createCanvasElement(),e=n.getContext("2d");return Yp=function(){const t=YR.Konva._global.devicePixelRatio||1,r=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return t/r}(),Dm.Util.releaseCanvas(n),Yp}let aS=class{constructor(e){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const r=(e||{}).pixelRatio||YR.Konva.pixelRatio||mz();this.pixelRatio=r,this._canvas=Dm.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(e){const t=this.pixelRatio;this.pixelRatio=e,this.setSize(this.getWidth()/t,this.getHeight()/t)}setWidth(e){this.width=this._canvas.width=e*this.pixelRatio,this._canvas.style.width=e+"px";const t=this.pixelRatio;this.getContext()._context.scale(t,t)}setHeight(e){this.height=this._canvas.height=e*this.pixelRatio,this._canvas.style.height=e+"px";const t=this.pixelRatio;this.getContext()._context.scale(t,t)}getWidth(){return this.width}getHeight(){return this.height}setSize(e,t){this.setWidth(e||0),this.setHeight(t||0)}toDataURL(e,t){try{return this._canvas.toDataURL(e,t)}catch{try{return this._canvas.toDataURL()}catch(i){return Dm.Util.error("Unable to get data URL. "+i.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};Ai.Canvas=aS;class _z extends aS{constructor(e={width:0,height:0,willReadFrequently:!1}){super(e),this.context=new QR.SceneContext(this,{willReadFrequently:e.willReadFrequently}),this.setSize(e.width,e.height)}}Ai.SceneCanvas=_z;class yz extends aS{constructor(e={width:0,height:0}){super(e),this.hitCanvas=!0,this.context=new QR.HitContext(this),this.setSize(e.width,e.height)}}Ai.HitCanvas=yz;var B0={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.DD=void 0;const e=Oe,t=Lt;n.DD={get isDragging(){let r=!1;return n.DD._dragElements.forEach(i=>{i.dragStatus==="dragging"&&(r=!0)}),r},justDragged:!1,get node(){let r;return n.DD._dragElements.forEach(i=>{r=i.node}),r},_dragElements:new Map,_drag(r){const i=[];n.DD._dragElements.forEach((s,o)=>{const{node:l}=s,c=l.getStage();c.setPointersPositions(r),s.pointerId===void 0&&(s.pointerId=t.Util._getFirstPointerId(r));const d=c._changedPointerPositions.find(p=>p.id===s.pointerId);if(d){if(s.dragStatus!=="dragging"){const p=l.dragDistance();if(Math.max(Math.abs(d.x-s.startPointerPos.x),Math.abs(d.y-s.startPointerPos.y))<p||(l.startDrag({evt:r}),!l.isDragging()))return}l._setDragPosition(r,s),i.push(l)}}),i.forEach(s=>{s.fire("dragmove",{type:"dragmove",target:s,evt:r},!0)})},_endDragBefore(r){const i=[];n.DD._dragElements.forEach(s=>{const{node:o}=s,l=o.getStage();if(r&&l.setPointersPositions(r),!l._changedPointerPositions.find(p=>p.id===s.pointerId))return;(s.dragStatus==="dragging"||s.dragStatus==="stopped")&&(n.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,s.dragStatus="stopped");const d=s.node.getLayer()||s.node instanceof e.Konva.Stage&&s.node;d&&i.indexOf(d)===-1&&i.push(d)}),i.forEach(s=>{s.draw()})},_endDragAfter(r){n.DD._dragElements.forEach((i,s)=>{i.dragStatus==="stopped"&&i.node.fire("dragend",{type:"dragend",target:i.node,evt:r},!0),i.dragStatus!=="dragging"&&n.DD._dragElements.delete(s)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",n.DD._endDragBefore,!0),window.addEventListener("touchend",n.DD._endDragBefore,!0),window.addEventListener("touchcancel",n.DD._endDragBefore,!0),window.addEventListener("mousemove",n.DD._drag),window.addEventListener("touchmove",n.DD._drag),window.addEventListener("mouseup",n.DD._endDragAfter,!1),window.addEventListener("touchend",n.DD._endDragAfter,!1),window.addEventListener("touchcancel",n.DD._endDragAfter,!1))})(B0);var Ue={},Pe={};Object.defineProperty(Pe,"__esModule",{value:!0});Pe.RGBComponent=vz;Pe.alphaComponent=wz;Pe.getNumberValidator=Ez;Pe.getNumberOrArrayOfNumbersValidator=Sz;Pe.getNumberOrAutoValidator=Tz;Pe.getStringValidator=Cz;Pe.getStringOrGradientValidator=Iz;Pe.getFunctionValidator=Pz;Pe.getNumberArrayValidator=kz;Pe.getBooleanValidator=Rz;Pe.getComponentValidator=xz;const no=Oe,Vt=Lt;function ro(n){return Vt.Util._isString(n)?'"'+n+'"':Object.prototype.toString.call(n)==="[object Number]"||Vt.Util._isBoolean(n)?n:Object.prototype.toString.call(n)}function vz(n){return n>255?255:n<0?0:Math.round(n)}function wz(n){return n>1?1:n<1e-4?1e-4:n}function Ez(){if(no.Konva.isUnminified)return function(n,e){return Vt.Util._isNumber(n)||Vt.Util.warn(ro(n)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),n}}function Sz(n){if(no.Konva.isUnminified)return function(e,t){let r=Vt.Util._isNumber(e),i=Vt.Util._isArray(e)&&e.length==n;return!r&&!i&&Vt.Util.warn(ro(e)+' is a not valid value for "'+t+'" attribute. The value should be a number or Array<number>('+n+")"),e}}function Tz(){if(no.Konva.isUnminified)return function(n,e){return Vt.Util._isNumber(n)||n==="auto"||Vt.Util.warn(ro(n)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),n}}function Cz(){if(no.Konva.isUnminified)return function(n,e){return Vt.Util._isString(n)||Vt.Util.warn(ro(n)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),n}}function Iz(){if(no.Konva.isUnminified)return function(n,e){const t=Vt.Util._isString(n),r=Object.prototype.toString.call(n)==="[object CanvasGradient]"||n&&n.addColorStop;return t||r||Vt.Util.warn(ro(n)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),n}}function Pz(){if(no.Konva.isUnminified)return function(n,e){return Vt.Util._isFunction(n)||Vt.Util.warn(ro(n)+' is a not valid value for "'+e+'" attribute. The value should be a function.'),n}}function kz(){if(no.Konva.isUnminified)return function(n,e){const t=Int8Array?Object.getPrototypeOf(Int8Array):null;return t&&n instanceof t||(Vt.Util._isArray(n)?n.forEach(function(r){Vt.Util._isNumber(r)||Vt.Util.warn('"'+e+'" attribute has non numeric element '+r+". Make sure that all elements are numbers.")}):Vt.Util.warn(ro(n)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.')),n}}function Rz(){if(no.Konva.isUnminified)return function(n,e){return n===!0||n===!1||Vt.Util.warn(ro(n)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),n}}function xz(n){if(no.Konva.isUnminified)return function(e,t){return e==null||Vt.Util.isObject(e)||Vt.Util.warn(ro(e)+' is a not valid value for "'+t+'" attribute. The value should be an object with properties '+n),e}}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Factory=void 0;const e=Lt,t=Pe,r="get",i="set";n.Factory={addGetterSetter(s,o,l,c,d){n.Factory.addGetter(s,o,l),n.Factory.addSetter(s,o,c,d),n.Factory.addOverloadedGetterSetter(s,o)},addGetter(s,o,l){const c=r+e.Util._capitalize(o);s.prototype[c]=s.prototype[c]||function(){const d=this.attrs[o];return d===void 0?l:d}},addSetter(s,o,l,c){const d=i+e.Util._capitalize(o);s.prototype[d]||n.Factory.overWriteSetter(s,o,l,c)},overWriteSetter(s,o,l,c){const d=i+e.Util._capitalize(o);s.prototype[d]=function(p){return l&&p!==void 0&&p!==null&&(p=l.call(this,p,o)),this._setAttr(o,p),c&&c.call(this),this}},addComponentsGetterSetter(s,o,l,c,d){const p=l.length,_=e.Util._capitalize,m=r+_(o),E=i+_(o);s.prototype[m]=function(){const k={};for(let N=0;N<p;N++){const x=l[N];k[x]=this.getAttr(o+_(x))}return k};const S=(0,t.getComponentValidator)(l);s.prototype[E]=function(k){const N=this.attrs[o];c&&(k=c.call(this,k,o)),S&&S.call(this,k,o);for(const x in k)k.hasOwnProperty(x)&&this._setAttr(o+_(x),k[x]);return k||l.forEach(x=>{this._setAttr(o+_(x),void 0)}),this._fireChangeEvent(o,N,k),d&&d.call(this),this},n.Factory.addOverloadedGetterSetter(s,o)},addOverloadedGetterSetter(s,o){const l=e.Util._capitalize(o),c=i+l,d=r+l;s.prototype[o]=function(){return arguments.length?(this[c](arguments[0]),this):this[d]()}},addDeprecatedGetterSetter(s,o,l,c){e.Util.error("Adding deprecated "+o);const d=r+e.Util._capitalize(o),p=o+" property is deprecated and will be removed soon. Look at Konva change log for more information.";s.prototype[d]=function(){e.Util.error(p);const _=this.attrs[o];return _===void 0?l:_},n.Factory.addSetter(s,o,c,function(){e.Util.error(p)}),n.Factory.addOverloadedGetterSetter(s,o)},backCompat(s,o){e.Util.each(o,function(l,c){const d=s.prototype[c],p=r+e.Util._capitalize(l),_=i+e.Util._capitalize(l);function m(){d.apply(this,arguments),e.Util.error('"'+l+'" method is deprecated and will be removed soon. Use ""'+c+'" instead.')}s.prototype[l]=m,s.prototype[p]=m,s.prototype[_]=m})},afterSetFilter(){this._filterUpToDate=!1}}})(Ue);Object.defineProperty(Rt,"__esModule",{value:!0});Rt.Node=void 0;const iu=Ai,Jr=B0,yf=Ue,To=Oe,Ge=Lt,Ht=Pe,Cg="absoluteOpacity",Xp="allEventListeners",Ps="absoluteTransform",Z3="absoluteScale",Ua="canvas",Az="Change",Nz="children",Dz="konva",w2="listening",bz="mouseenter",Oz="mouseleave",Mz="pointerenter",Lz="pointerleave",Fz="touchenter",Vz="touchleave",e5="set",t5="Shape",Ig=" ",n5="stage",Co="transform",Uz="Stage",E2="visible",Bz=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(Ig);let zz=1;class xe{constructor(e){this._id=zz++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(e),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(e){(e===Co||e===Ps)&&this._cache.get(e)?this._cache.get(e).dirty=!0:e?this._cache.delete(e):this._cache.clear()}_getCache(e,t){let r=this._cache.get(e);return(r===void 0||(e===Co||e===Ps)&&r.dirty===!0)&&(r=t.call(this),this._cache.set(e,r)),r}_calculate(e,t,r){if(!this._attachedDepsListeners.get(e)){const i=t.map(s=>s+"Change.konva").join(Ig);this.on(i,()=>{this._clearCache(e)}),this._attachedDepsListeners.set(e,!0)}return this._getCache(e,r)}_getCanvasCache(){return this._cache.get(Ua)}_clearSelfAndDescendantCache(e){this._clearCache(e),e===Ps&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(Ua)){const{scene:e,filter:t,hit:r,buffer:i}=this._cache.get(Ua);Ge.Util.releaseCanvas(e,t,r,i),this._cache.delete(Ua)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(e){const t=e||{};let r={};(t.x===void 0||t.y===void 0||t.width===void 0||t.height===void 0)&&(r=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let i=Math.ceil(t.width||r.width),s=Math.ceil(t.height||r.height),o=t.pixelRatio,l=t.x===void 0?Math.floor(r.x):t.x,c=t.y===void 0?Math.floor(r.y):t.y,d=t.offset||0,p=t.drawBorder||!1,_=t.hitCanvasPixelRatio||1;if(!i||!s){Ge.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const m=Math.abs(Math.round(r.x)-l)>.5?1:0,E=Math.abs(Math.round(r.y)-c)>.5?1:0;i+=d*2+m,s+=d*2+E,l-=d,c-=d;const S=new iu.SceneCanvas({pixelRatio:o,width:i,height:s}),k=new iu.SceneCanvas({pixelRatio:o,width:0,height:0,willReadFrequently:!0}),N=new iu.HitCanvas({pixelRatio:_,width:i,height:s}),x=S.getContext(),R=N.getContext(),w=new iu.SceneCanvas({width:S.width/S.pixelRatio+Math.abs(l),height:S.height/S.pixelRatio+Math.abs(c),pixelRatio:S.pixelRatio}),P=w.getContext();return N.isCache=!0,S.isCache=!0,this._cache.delete(Ua),this._filterUpToDate=!1,t.imageSmoothingEnabled===!1&&(S.getContext()._context.imageSmoothingEnabled=!1,k.getContext()._context.imageSmoothingEnabled=!1),x.save(),R.save(),P.save(),x.translate(-l,-c),R.translate(-l,-c),P.translate(-l,-c),w.x=l,w.y=c,this._isUnderCache=!0,this._clearSelfAndDescendantCache(Cg),this._clearSelfAndDescendantCache(Z3),this.drawScene(S,this,w),this.drawHit(N,this),this._isUnderCache=!1,x.restore(),R.restore(),p&&(x.save(),x.beginPath(),x.rect(0,0,i,s),x.closePath(),x.setAttr("strokeStyle","red"),x.setAttr("lineWidth",5),x.stroke(),x.restore()),this._cache.set(Ua,{scene:S,filter:k,hit:N,buffer:w,x:l,y:c}),this._requestDraw(),this}isCached(){return this._cache.has(Ua)}getClientRect(e){throw new Error('abstract "getClientRect" method call')}_transformedRect(e,t){const r=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}];let i=1/0,s=1/0,o=-1/0,l=-1/0;const c=this.getAbsoluteTransform(t);return r.forEach(function(d){const p=c.point(d);i===void 0&&(i=o=p.x,s=l=p.y),i=Math.min(i,p.x),s=Math.min(s,p.y),o=Math.max(o,p.x),l=Math.max(l,p.y)}),{x:i,y:s,width:o-i,height:l-s}}_drawCachedSceneCanvas(e){e.save(),e._applyOpacity(this),e._applyGlobalCompositeOperation(this);const t=this._getCanvasCache();e.translate(t.x,t.y);const r=this._getCachedSceneCanvas(),i=r.pixelRatio;e.drawImage(r._canvas,0,0,r.width/i,r.height/i),e.restore()}_drawCachedHitCanvas(e){const t=this._getCanvasCache(),r=t.hit;e.save(),e.translate(t.x,t.y),e.drawImage(r._canvas,0,0,r.width/r.pixelRatio,r.height/r.pixelRatio),e.restore()}_getCachedSceneCanvas(){let e=this.filters(),t=this._getCanvasCache(),r=t.scene,i=t.filter,s=i.getContext(),o,l,c,d;if(e){if(!this._filterUpToDate){const p=r.pixelRatio;i.setSize(r.width/r.pixelRatio,r.height/r.pixelRatio);try{for(o=e.length,s.clear(),s.drawImage(r._canvas,0,0,r.getWidth()/p,r.getHeight()/p),l=s.getImageData(0,0,i.getWidth(),i.getHeight()),c=0;c<o;c++){if(d=e[c],typeof d!="function"){Ge.Util.error("Filter should be type of function, but got "+typeof d+" instead. Please check correct filters");continue}d.call(this,l),s.putImageData(l,0,0)}}catch(_){Ge.Util.error("Unable to apply filter. "+_.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return i}return r}on(e,t){if(this._cache&&this._cache.delete(Xp),arguments.length===3)return this._delegate.apply(this,arguments);const r=e.split(Ig);for(let i=0;i<r.length;i++){const o=r[i].split("."),l=o[0],c=o[1]||"";this.eventListeners[l]||(this.eventListeners[l]=[]),this.eventListeners[l].push({name:c,handler:t})}return this}off(e,t){let r=(e||"").split(Ig),i=r.length,s,o,l,c,d,p;if(this._cache&&this._cache.delete(Xp),!e)for(o in this.eventListeners)this._off(o);for(s=0;s<i;s++)if(l=r[s],c=l.split("."),d=c[0],p=c[1],d)this.eventListeners[d]&&this._off(d,p,t);else for(o in this.eventListeners)this._off(o,p,t);return this}dispatchEvent(e){const t={target:this,type:e.type,evt:e};return this.fire(e.type,t),this}addEventListener(e,t){return this.on(e,function(r){t.call(this,r.evt)}),this}removeEventListener(e){return this.off(e),this}_delegate(e,t,r){const i=this;this.on(e,function(s){const o=s.target.findAncestors(t,!0,i);for(let l=0;l<o.length;l++)s=Ge.Util.cloneObject(s),s.currentTarget=o[l],r.call(o[l],s)})}remove(){return this.isDragging()&&this.stopDrag(),Jr.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Ps),this._clearSelfAndDescendantCache(Cg),this._clearSelfAndDescendantCache(Z3),this._clearSelfAndDescendantCache(n5),this._clearSelfAndDescendantCache(E2),this._clearSelfAndDescendantCache(w2)}_remove(){this._clearCaches();const e=this.getParent();e&&e.children&&(e.children.splice(this.index,1),e._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(e){const t="get"+Ge.Util._capitalize(e);return Ge.Util._isFunction(this[t])?this[t]():this.attrs[e]}getAncestors(){let e=this.getParent(),t=[];for(;e;)t.push(e),e=e.getParent();return t}getAttrs(){return this.attrs||{}}setAttrs(e){return this._batchTransformChanges(()=>{let t,r;if(!e)return this;for(t in e)t!==Nz&&(r=e5+Ge.Util._capitalize(t),Ge.Util._isFunction(this[r])?this[r](e[t]):this._setAttr(t,e[t]))}),this}isListening(){return this._getCache(w2,this._isListening)}_isListening(e){if(!this.listening())return!1;const r=this.getParent();return r&&r!==e&&this!==e?r._isListening(e):!0}isVisible(){return this._getCache(E2,this._isVisible)}_isVisible(e){if(!this.visible())return!1;const r=this.getParent();return r&&r!==e&&this!==e?r._isVisible(e):!0}shouldDrawHit(e,t=!1){if(e)return this._isVisible(e)&&this._isListening(e);const r=this.getLayer();let i=!1;Jr.DD._dragElements.forEach(o=>{o.dragStatus==="dragging"&&(o.node.nodeType==="Stage"||o.node.getLayer()===r)&&(i=!0)});const s=!t&&!To.Konva.hitOnDragEnabled&&(i||To.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!s}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let e=this.getDepth(),t=this,r=0,i,s,o,l;function c(p){for(i=[],s=p.length,o=0;o<s;o++)l=p[o],r++,l.nodeType!==t5&&(i=i.concat(l.getChildren().slice())),l._id===t._id&&(o=s);i.length>0&&i[0].getDepth()<=e&&c(i)}const d=this.getStage();return t.nodeType!==Uz&&d&&c(d.getChildren()),r}getDepth(){let e=0,t=this.parent;for(;t;)e++,t=t.parent;return e}_batchTransformChanges(e){this._batchingTransformChange=!0,e(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(Co),this._clearSelfAndDescendantCache(Ps)),this._needClearTransformCache=!1}setPosition(e){return this._batchTransformChanges(()=>{this.x(e.x),this.y(e.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const e=this.getStage();if(!e)return null;const t=e.getPointerPosition();if(!t)return null;const r=this.getAbsoluteTransform().copy();return r.invert(),r.point(t)}getAbsolutePosition(e){let t=!1,r=this.parent;for(;r;){if(r.isCached()){t=!0;break}r=r.parent}t&&!e&&(e=!0);const i=this.getAbsoluteTransform(e).getMatrix(),s=new Ge.Transform,o=this.offset();return s.m=i.slice(),s.translate(o.x,o.y),s.getTranslation()}setAbsolutePosition(e){const{x:t,y:r,...i}=this._clearTransform();this.attrs.x=t,this.attrs.y=r,this._clearCache(Co);const s=this._getAbsoluteTransform().copy();return s.invert(),s.translate(e.x,e.y),e={x:this.attrs.x+s.getTranslation().x,y:this.attrs.y+s.getTranslation().y},this._setTransform(i),this.setPosition({x:e.x,y:e.y}),this._clearCache(Co),this._clearSelfAndDescendantCache(Ps),this}_setTransform(e){let t;for(t in e)this.attrs[t]=e[t]}_clearTransform(){const e={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,e}move(e){let t=e.x,r=e.y,i=this.x(),s=this.y();return t!==void 0&&(i+=t),r!==void 0&&(s+=r),this.setPosition({x:i,y:s}),this}_eachAncestorReverse(e,t){let r=[],i=this.getParent(),s,o;if(!(t&&t._id===this._id)){for(r.unshift(this);i&&(!t||i._id!==t._id);)r.unshift(i),i=i.parent;for(s=r.length,o=0;o<s;o++)e(r[o])}}rotate(e){return this.rotation(this.rotation()+e),this}moveToTop(){if(!this.parent)return Ge.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const e=this.index,t=this.parent.getChildren().length;return e<t-1?(this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return Ge.Util.warn("Node has no parent. moveUp function is ignored."),!1;const e=this.index,t=this.parent.getChildren().length;return e<t-1?(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return Ge.Util.warn("Node has no parent. moveDown function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return Ge.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(e){if(!this.parent)return Ge.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(e<0||e>=this.parent.children.length)&&Ge.Util.warn("Unexpected value "+e+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const t=this.index;return this.parent.children.splice(t,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(Cg,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let e=this.opacity();const t=this.getParent();return t&&!t._isUnderCache&&(e*=t.getAbsoluteOpacity()),e}moveTo(e){return this.getParent()!==e&&(this._remove(),e.add(this)),this}toObject(){let e=this.getAttrs(),t,r,i,s,o;const l={attrs:{},className:this.getClassName()};for(t in e)r=e[t],o=Ge.Util.isObject(r)&&!Ge.Util._isPlainObject(r)&&!Ge.Util._isArray(r),!o&&(i=typeof this[t]=="function"&&this[t],delete e[t],s=i?i.call(this):null,e[t]=r,s!==r&&(l.attrs[t]=r));return Ge.Util._prepareToStringify(l)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(e,t,r){const i=[];t&&this._isMatch(e)&&i.push(this);let s=this.parent;for(;s;){if(s===r)return i;s._isMatch(e)&&i.push(s),s=s.parent}return i}isAncestorOf(e){return!1}findAncestor(e,t,r){return this.findAncestors(e,t,r)[0]}_isMatch(e){if(!e)return!1;if(typeof e=="function")return e(this);let t=e.replace(/ /g,"").split(","),r=t.length,i,s;for(i=0;i<r;i++)if(s=t[i],Ge.Util.isValidSelector(s)||(Ge.Util.warn('Selector "'+s+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),Ge.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),Ge.Util.warn("Konva is awesome, right?")),s.charAt(0)==="#"){if(this.id()===s.slice(1))return!0}else if(s.charAt(0)==="."){if(this.hasName(s.slice(1)))return!0}else if(this.className===s||this.nodeType===s)return!0;return!1}getLayer(){const e=this.getParent();return e?e.getLayer():null}getStage(){return this._getCache(n5,this._getStage)}_getStage(){const e=this.getParent();return e?e.getStage():null}fire(e,t={},r){return t.target=t.target||this,r?this._fireAndBubble(e,t):this._fire(e,t),this}getAbsoluteTransform(e){return e?this._getAbsoluteTransform(e):this._getCache(Ps,this._getAbsoluteTransform)}_getAbsoluteTransform(e){let t;if(e)return t=new Ge.Transform,this._eachAncestorReverse(function(r){const i=r.transformsEnabled();i==="all"?t.multiply(r.getTransform()):i==="position"&&t.translate(r.x()-r.offsetX(),r.y()-r.offsetY())},e),t;{t=this._cache.get(Ps)||new Ge.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(t):t.reset();const r=this.transformsEnabled();if(r==="all")t.multiply(this.getTransform());else if(r==="position"){const i=this.attrs.x||0,s=this.attrs.y||0,o=this.attrs.offsetX||0,l=this.attrs.offsetY||0;t.translate(i-o,s-l)}return t.dirty=!1,t}}getAbsoluteScale(e){let t=this;for(;t;)t._isUnderCache&&(e=t),t=t.getParent();const i=this.getAbsoluteTransform(e).decompose();return{x:i.scaleX,y:i.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(Co,this._getTransform)}_getTransform(){var e,t;const r=this._cache.get(Co)||new Ge.Transform;r.reset();const i=this.x(),s=this.y(),o=To.Konva.getAngle(this.rotation()),l=(e=this.attrs.scaleX)!==null&&e!==void 0?e:1,c=(t=this.attrs.scaleY)!==null&&t!==void 0?t:1,d=this.attrs.skewX||0,p=this.attrs.skewY||0,_=this.attrs.offsetX||0,m=this.attrs.offsetY||0;return(i!==0||s!==0)&&r.translate(i,s),o!==0&&r.rotate(o),(d!==0||p!==0)&&r.skew(d,p),(l!==1||c!==1)&&r.scale(l,c),(_!==0||m!==0)&&r.translate(-1*_,-1*m),r.dirty=!1,r}clone(e){let t=Ge.Util.cloneObject(this.attrs),r,i,s,o,l;for(r in e)t[r]=e[r];const c=new this.constructor(t);for(r in this.eventListeners)for(i=this.eventListeners[r],s=i.length,o=0;o<s;o++)l=i[o],l.name.indexOf(Dz)<0&&(c.eventListeners[r]||(c.eventListeners[r]=[]),c.eventListeners[r].push(l));return c}_toKonvaCanvas(e){e=e||{};const t=this.getClientRect(),r=this.getStage(),i=e.x!==void 0?e.x:Math.floor(t.x),s=e.y!==void 0?e.y:Math.floor(t.y),o=e.pixelRatio||1,l=new iu.SceneCanvas({width:e.width||Math.ceil(t.width)||(r?r.width():0),height:e.height||Math.ceil(t.height)||(r?r.height():0),pixelRatio:o}),c=l.getContext(),d=new iu.SceneCanvas({width:l.width/l.pixelRatio+Math.abs(i),height:l.height/l.pixelRatio+Math.abs(s),pixelRatio:l.pixelRatio});return e.imageSmoothingEnabled===!1&&(c._context.imageSmoothingEnabled=!1),c.save(),(i||s)&&c.translate(-1*i,-1*s),this.drawScene(l,void 0,d),c.restore(),l}toCanvas(e){return this._toKonvaCanvas(e)._canvas}toDataURL(e){e=e||{};const t=e.mimeType||null,r=e.quality||null,i=this._toKonvaCanvas(e).toDataURL(t,r);return e.callback&&e.callback(i),i}toImage(e){return new Promise((t,r)=>{try{const i=e==null?void 0:e.callback;i&&delete e.callback,Ge.Util._urlToImage(this.toDataURL(e),function(s){t(s),i==null||i(s)})}catch(i){r(i)}})}toBlob(e){return new Promise((t,r)=>{try{const i=e==null?void 0:e.callback;i&&delete e.callback,this.toCanvas(e).toBlob(s=>{t(s),i==null||i(s)},e==null?void 0:e.mimeType,e==null?void 0:e.quality)}catch(i){r(i)}})}setSize(e){return this.width(e.width),this.height(e.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():To.Konva.dragDistance}_off(e,t,r){let i=this.eventListeners[e],s,o,l;for(s=0;s<i.length;s++)if(o=i[s].name,l=i[s].handler,(o!=="konva"||t==="konva")&&(!t||o===t)&&(!r||r===l)){if(i.splice(s,1),i.length===0){delete this.eventListeners[e];break}s--}}_fireChangeEvent(e,t,r){this._fire(e+Az,{oldVal:t,newVal:r})}addName(e){if(!this.hasName(e)){const t=this.name(),r=t?t+" "+e:e;this.name(r)}return this}hasName(e){if(!e)return!1;const t=this.name();return t?(t||"").split(/\s/g).indexOf(e)!==-1:!1}removeName(e){const t=(this.name()||"").split(/\s/g),r=t.indexOf(e);return r!==-1&&(t.splice(r,1),this.name(t.join(" "))),this}setAttr(e,t){const r=this[e5+Ge.Util._capitalize(e)];return Ge.Util._isFunction(r)?r.call(this,t):this._setAttr(e,t),this}_requestDraw(){if(To.Konva.autoDrawEnabled){const e=this.getLayer()||this.getStage();e==null||e.batchDraw()}}_setAttr(e,t){const r=this.attrs[e];r===t&&!Ge.Util.isObject(t)||(t==null?delete this.attrs[e]:this.attrs[e]=t,this._shouldFireChangeEvents&&this._fireChangeEvent(e,r,t),this._requestDraw())}_setComponentAttr(e,t,r){let i;r!==void 0&&(i=this.attrs[e],i||(this.attrs[e]=this.getAttr(e)),this.attrs[e][t]=r,this._fireChangeEvent(e,i,r))}_fireAndBubble(e,t,r){t&&this.nodeType===t5&&(t.target=this);const i=[bz,Oz,Mz,Lz,Fz,Vz];if(!(i.indexOf(e)!==-1&&(r&&(this===r||this.isAncestorOf&&this.isAncestorOf(r))||this.nodeType==="Stage"&&!r))){this._fire(e,t);const o=i.indexOf(e)!==-1&&r&&r.isAncestorOf&&r.isAncestorOf(this)&&!r.isAncestorOf(this.parent);(t&&!t.cancelBubble||!t)&&this.parent&&this.parent.isListening()&&!o&&(r&&r.parent?this._fireAndBubble.call(this.parent,e,t,r):this._fireAndBubble.call(this.parent,e,t))}}_getProtoListeners(e){var t,r,i;const s=(t=this._cache.get(Xp))!==null&&t!==void 0?t:{};let o=s==null?void 0:s[e];if(o===void 0){o=[];let l=Object.getPrototypeOf(this);for(;l;){const c=(i=(r=l.eventListeners)===null||r===void 0?void 0:r[e])!==null&&i!==void 0?i:[];o.push(...c),l=Object.getPrototypeOf(l)}s[e]=o,this._cache.set(Xp,s)}return o}_fire(e,t){t=t||{},t.currentTarget=this,t.type=e;const r=this._getProtoListeners(e);if(r)for(let s=0;s<r.length;s++)r[s].handler.call(this,t);const i=this.eventListeners[e];if(i)for(let s=0;s<i.length;s++)i[s].handler.call(this,t)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(e){const t=e?e.pointerId:void 0,r=this.getStage(),i=this.getAbsolutePosition();if(!r)return;const s=r._getPointerById(t)||r._changedPointerPositions[0]||i;Jr.DD._dragElements.set(this._id,{node:this,startPointerPos:s,offset:{x:s.x-i.x,y:s.y-i.y},dragStatus:"ready",pointerId:t})}startDrag(e,t=!0){Jr.DD._dragElements.has(this._id)||this._createDragElement(e);const r=Jr.DD._dragElements.get(this._id);r.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:e&&e.evt},t)}_setDragPosition(e,t){const r=this.getStage()._getPointerById(t.pointerId);if(!r)return;let i={x:r.x-t.offset.x,y:r.y-t.offset.y};const s=this.dragBoundFunc();if(s!==void 0){const o=s.call(this,i,e);o?i=o:Ge.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==i.x||this._lastPos.y!==i.y)&&(this.setAbsolutePosition(i),this._requestDraw()),this._lastPos=i}stopDrag(e){const t=Jr.DD._dragElements.get(this._id);t&&(t.dragStatus="stopped"),Jr.DD._endDragBefore(e),Jr.DD._endDragAfter(e)}setDraggable(e){this._setAttr("draggable",e),this._dragChange()}isDragging(){const e=Jr.DD._dragElements.get(this._id);return e?e.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(e){if(!(!(e.evt.button!==void 0)||To.Konva.dragButtons.indexOf(e.evt.button)>=0)||this.isDragging())return;let i=!1;Jr.DD._dragElements.forEach(s=>{this.isAncestorOf(s.node)&&(i=!0)}),i||this._createDragElement(e)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const t=Jr.DD._dragElements.get(this._id),r=t&&t.dragStatus==="dragging",i=t&&t.dragStatus==="ready";r?this.stopDrag():i&&Jr.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(e={x:0,y:0}){const t=this.getStage();if(!t)return!1;const r={x:-e.x,y:-e.y,width:t.width()+2*e.x,height:t.height()+2*e.y};return Ge.Util.haveIntersection(r,this.getClientRect())}static create(e,t){return Ge.Util._isString(e)&&(e=JSON.parse(e)),this._createNode(e,t)}static _createNode(e,t){let r=xe.prototype.getClassName.call(e),i=e.children,s,o,l;t&&(e.attrs.container=t),To.Konva[r]||(Ge.Util.warn('Can not find a node with class name "'+r+'". Fallback to "Shape".'),r="Shape");const c=To.Konva[r];if(s=new c(e.attrs),i)for(o=i.length,l=0;l<o;l++)s.add(xe._createNode(i[l]));return s}}Rt.Node=xe;xe.prototype.nodeType="Node";xe.prototype._attrsAffectingSize=[];xe.prototype.eventListeners={};xe.prototype.on.call(xe.prototype,Bz,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(Co),this._clearSelfAndDescendantCache(Ps)});xe.prototype.on.call(xe.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(E2)});xe.prototype.on.call(xe.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(w2)});xe.prototype.on.call(xe.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(Cg)});const wt=yf.Factory.addGetterSetter;wt(xe,"zIndex");wt(xe,"absolutePosition");wt(xe,"position");wt(xe,"x",0,(0,Ht.getNumberValidator)());wt(xe,"y",0,(0,Ht.getNumberValidator)());wt(xe,"globalCompositeOperation","source-over",(0,Ht.getStringValidator)());wt(xe,"opacity",1,(0,Ht.getNumberValidator)());wt(xe,"name","",(0,Ht.getStringValidator)());wt(xe,"id","",(0,Ht.getStringValidator)());wt(xe,"rotation",0,(0,Ht.getNumberValidator)());yf.Factory.addComponentsGetterSetter(xe,"scale",["x","y"]);wt(xe,"scaleX",1,(0,Ht.getNumberValidator)());wt(xe,"scaleY",1,(0,Ht.getNumberValidator)());yf.Factory.addComponentsGetterSetter(xe,"skew",["x","y"]);wt(xe,"skewX",0,(0,Ht.getNumberValidator)());wt(xe,"skewY",0,(0,Ht.getNumberValidator)());yf.Factory.addComponentsGetterSetter(xe,"offset",["x","y"]);wt(xe,"offsetX",0,(0,Ht.getNumberValidator)());wt(xe,"offsetY",0,(0,Ht.getNumberValidator)());wt(xe,"dragDistance",void 0,(0,Ht.getNumberValidator)());wt(xe,"width",0,(0,Ht.getNumberValidator)());wt(xe,"height",0,(0,Ht.getNumberValidator)());wt(xe,"listening",!0,(0,Ht.getBooleanValidator)());wt(xe,"preventDefault",!0,(0,Ht.getBooleanValidator)());wt(xe,"filters",void 0,function(n){return this._filterUpToDate=!1,n});wt(xe,"visible",!0,(0,Ht.getBooleanValidator)());wt(xe,"transformsEnabled","all",(0,Ht.getStringValidator)());wt(xe,"size");wt(xe,"dragBoundFunc");wt(xe,"draggable",!1,(0,Ht.getBooleanValidator)());yf.Factory.backCompat(xe,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var Il={};Object.defineProperty(Il,"__esModule",{value:!0});Il.Container=void 0;const Sc=Ue,Tv=Rt,z0=Pe;class Pl extends Tv.Node{constructor(){super(...arguments),this.children=[]}getChildren(e){const t=this.children||[];return e?t.filter(e):t}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.destroy()}),this.children=[],this._requestDraw(),this}add(...e){if(e.length===0)return this;if(e.length>1){for(let r=0;r<e.length;r++)this.add(e[r]);return this}const t=e[0];return t.getParent()?(t.moveTo(this),this):(this._validateAdd(t),t.index=this.getChildren().length,t.parent=this,t._clearCaches(),this.getChildren().push(t),this._fire("add",{child:t}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(e){return this._generalFind(e,!1)}findOne(e){const t=this._generalFind(e,!0);return t.length>0?t[0]:void 0}_generalFind(e,t){const r=[];return this._descendants(i=>{const s=i._isMatch(e);return s&&r.push(i),!!(s&&t)}),r}_descendants(e){let t=!1;const r=this.getChildren();for(const i of r){if(t=e(i),t)return!0;if(i.hasChildren()&&(t=i._descendants(e),t))return!0}return!1}toObject(){const e=Tv.Node.prototype.toObject.call(this);return e.children=[],this.getChildren().forEach(t=>{e.children.push(t.toObject())}),e}isAncestorOf(e){let t=e.getParent();for(;t;){if(t._id===this._id)return!0;t=t.getParent()}return!1}clone(e){const t=Tv.Node.prototype.clone.call(this,e);return this.getChildren().forEach(function(r){t.add(r.clone())}),t}getAllIntersections(e){const t=[];return this.find("Shape").forEach(r=>{r.isVisible()&&r.intersects(e)&&t.push(r)}),t}_clearSelfAndDescendantCache(e){var t;super._clearSelfAndDescendantCache(e),!this.isCached()&&((t=this.children)===null||t===void 0||t.forEach(function(r){r._clearSelfAndDescendantCache(e)}))}_setChildrenIndices(){var e;(e=this.children)===null||e===void 0||e.forEach(function(t,r){t.index=r}),this._requestDraw()}drawScene(e,t,r){const i=this.getLayer(),s=e||i&&i.getCanvas(),o=s&&s.getContext(),l=this._getCanvasCache(),c=l&&l.scene,d=s&&s.isCache;if(!this.isVisible()&&!d)return this;if(c){o.save();const p=this.getAbsoluteTransform(t).getMatrix();o.transform(p[0],p[1],p[2],p[3],p[4],p[5]),this._drawCachedSceneCanvas(o),o.restore()}else this._drawChildren("drawScene",s,t,r);return this}drawHit(e,t){if(!this.shouldDrawHit(t))return this;const r=this.getLayer(),i=e||r&&r.hitCanvas,s=i&&i.getContext(),o=this._getCanvasCache();if(o&&o.hit){s.save();const c=this.getAbsoluteTransform(t).getMatrix();s.transform(c[0],c[1],c[2],c[3],c[4],c[5]),this._drawCachedHitCanvas(s),s.restore()}else this._drawChildren("drawHit",i,t);return this}_drawChildren(e,t,r,i){var s;const o=t&&t.getContext(),l=this.clipWidth(),c=this.clipHeight(),d=this.clipFunc(),p=typeof l=="number"&&typeof c=="number"||d,_=r===this;if(p){o.save();const E=this.getAbsoluteTransform(r);let S=E.getMatrix();o.transform(S[0],S[1],S[2],S[3],S[4],S[5]),o.beginPath();let k;if(d)k=d.call(this,o,this);else{const N=this.clipX(),x=this.clipY();o.rect(N||0,x||0,l,c)}o.clip.apply(o,k),S=E.copy().invert().getMatrix(),o.transform(S[0],S[1],S[2],S[3],S[4],S[5])}const m=!_&&this.globalCompositeOperation()!=="source-over"&&e==="drawScene";m&&(o.save(),o._applyGlobalCompositeOperation(this)),(s=this.children)===null||s===void 0||s.forEach(function(E){E[e](t,r,i)}),m&&o.restore(),p&&o.restore()}getClientRect(e={}){var t;const r=e.skipTransform,i=e.relativeTo;let s,o,l,c,d={x:1/0,y:1/0,width:0,height:0};const p=this;(t=this.children)===null||t===void 0||t.forEach(function(E){if(!E.visible())return;const S=E.getClientRect({relativeTo:p,skipShadow:e.skipShadow,skipStroke:e.skipStroke});S.width===0&&S.height===0||(s===void 0?(s=S.x,o=S.y,l=S.x+S.width,c=S.y+S.height):(s=Math.min(s,S.x),o=Math.min(o,S.y),l=Math.max(l,S.x+S.width),c=Math.max(c,S.y+S.height)))});const _=this.find("Shape");let m=!1;for(let E=0;E<_.length;E++)if(_[E]._isVisible(this)){m=!0;break}return m&&s!==void 0?d={x:s,y:o,width:l-s,height:c-o}:d={x:0,y:0,width:0,height:0},r?d:this._transformedRect(d,i)}}Il.Container=Pl;Sc.Factory.addComponentsGetterSetter(Pl,"clip",["x","y","width","height"]);Sc.Factory.addGetterSetter(Pl,"clipX",void 0,(0,z0.getNumberValidator)());Sc.Factory.addGetterSetter(Pl,"clipY",void 0,(0,z0.getNumberValidator)());Sc.Factory.addGetterSetter(Pl,"clipWidth",void 0,(0,z0.getNumberValidator)());Sc.Factory.addGetterSetter(Pl,"clipHeight",void 0,(0,z0.getNumberValidator)());Sc.Factory.addGetterSetter(Pl,"clipFunc");var XR={},ga={};Object.defineProperty(ga,"__esModule",{value:!0});ga.getCapturedShape=Gz;ga.createEvent=lS;ga.hasPointerCapture=Wz;ga.setPointerCapture=Hz;ga.releaseCapture=ZR;const jz=Oe,jd=new Map,JR=jz.Konva._global.PointerEvent!==void 0;function Gz(n){return jd.get(n)}function lS(n){return{evt:n,pointerId:n.pointerId}}function Wz(n,e){return jd.get(n)===e}function Hz(n,e){ZR(n),e.getStage()&&(jd.set(n,e),JR&&e._fire("gotpointercapture",lS(new PointerEvent("gotpointercapture"))))}function ZR(n,e){const t=jd.get(n);if(!t)return;const r=t.getStage();r&&r.content,jd.delete(n),JR&&t._fire("lostpointercapture",lS(new PointerEvent("lostpointercapture")))}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Stage=n.stages=void 0;const e=Lt,t=Ue,r=Il,i=Oe,s=Ai,o=B0,l=Oe,c=ga,d="Stage",p="string",_="px",m="mouseout",E="mouseleave",S="mouseover",k="mouseenter",N="mousemove",x="mousedown",R="mouseup",w="pointermove",P="pointerdown",F="pointerup",U="pointercancel",D="lostpointercapture",C="pointerout",b="pointerleave",A="pointerover",M="pointerenter",B="contextmenu",V="touchstart",fe="touchend",se="touchmove",Be="touchcancel",De="wheel",Y=5,oe=[[k,"_pointerenter"],[x,"_pointerdown"],[N,"_pointermove"],[R,"_pointerup"],[E,"_pointerleave"],[V,"_pointerdown"],[se,"_pointermove"],[fe,"_pointerup"],[Be,"_pointercancel"],[S,"_pointerover"],[De,"_wheel"],[B,"_contextmenu"],[P,"_pointerdown"],[w,"_pointermove"],[F,"_pointerup"],[U,"_pointercancel"],[b,"_pointerleave"],[D,"_lostpointercapture"]],ne={mouse:{[C]:m,[b]:E,[A]:S,[M]:k,[w]:N,[P]:x,[F]:R,[U]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[C]:"touchout",[b]:"touchleave",[A]:"touchover",[M]:"touchenter",[w]:se,[P]:V,[F]:fe,[U]:Be,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[C]:C,[b]:b,[A]:A,[M]:M,[w]:w,[P]:P,[F]:F,[U]:U,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},ae=pt=>pt.indexOf("pointer")>=0?"pointer":pt.indexOf("touch")>=0?"touch":"mouse",pe=pt=>{const j=ae(pt);if(j==="pointer")return i.Konva.pointerEventsEnabled&&ne.pointer;if(j==="touch")return ne.touch;if(j==="mouse")return ne.mouse};function Se(pt={}){return(pt.clipFunc||pt.clipWidth||pt.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),pt}const en="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";n.stages=[];class xt extends r.Container{constructor(j){super(Se(j)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),n.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{Se(this.attrs)}),this._checkVisibility()}_validateAdd(j){const Z=j.getType()==="Layer",ye=j.getType()==="FastLayer";Z||ye||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const j=this.visible()?"":"none";this.content.style.display=j}setContainer(j){if(typeof j===p){let Z;if(j.charAt(0)==="."){const ye=j.slice(1);j=document.getElementsByClassName(ye)[0]}else j.charAt(0)!=="#"?Z=j:Z=j.slice(1),j=document.getElementById(Z);if(!j)throw"Can not find container in document with id "+Z}return this._setAttr("container",j),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),j.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const j=this.children,Z=j.length;for(let ye=0;ye<Z;ye++)j[ye].clear();return this}clone(j){return j||(j={}),j.container=typeof document<"u"&&document.createElement("div"),r.Container.prototype.clone.call(this,j)}destroy(){super.destroy();const j=this.content;j&&e.Util._isInDocument(j)&&this.container().removeChild(j);const Z=n.stages.indexOf(this);return Z>-1&&n.stages.splice(Z,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const j=this._pointerPositions[0]||this._changedPointerPositions[0];return j?{x:j.x,y:j.y}:(e.Util.warn(en),null)}_getPointerById(j){return this._pointerPositions.find(Z=>Z.id===j)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(j){j=j||{},j.x=j.x||0,j.y=j.y||0,j.width=j.width||this.width(),j.height=j.height||this.height();const Z=new s.SceneCanvas({width:j.width,height:j.height,pixelRatio:j.pixelRatio||1}),ye=Z.getContext()._context,Ke=this.children;return(j.x||j.y)&&ye.translate(-1*j.x,-1*j.y),Ke.forEach(function(ke){if(!ke.isVisible())return;const ot=ke._toKonvaCanvas(j);ye.drawImage(ot._canvas,j.x,j.y,ot.getWidth()/ot.getPixelRatio(),ot.getHeight()/ot.getPixelRatio())}),Z}getIntersection(j){if(!j)return null;const Z=this.children,ye=Z.length,Ke=ye-1;for(let ke=Ke;ke>=0;ke--){const ot=Z[ke].getIntersection(j);if(ot)return ot}return null}_resizeDOM(){const j=this.width(),Z=this.height();this.content&&(this.content.style.width=j+_,this.content.style.height=Z+_),this.bufferCanvas.setSize(j,Z),this.bufferHitCanvas.setSize(j,Z),this.children.forEach(ye=>{ye.setSize({width:j,height:Z}),ye.draw()})}add(j,...Z){if(arguments.length>1){for(let Ke=0;Ke<arguments.length;Ke++)this.add(arguments[Ke]);return this}super.add(j);const ye=this.children.length;return ye>Y&&e.Util.warn("The stage has "+ye+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),j.setSize({width:this.width(),height:this.height()}),j.draw(),i.Konva.isBrowser&&this.content.appendChild(j.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(j){return c.hasPointerCapture(j,this)}setPointerCapture(j){c.setPointerCapture(j,this)}releaseCapture(j){c.releaseCapture(j,this)}getLayers(){return this.children}_bindContentEvents(){i.Konva.isBrowser&&oe.forEach(([j,Z])=>{this.content.addEventListener(j,ye=>{this[Z](ye)},{passive:!1})})}_pointerenter(j){this.setPointersPositions(j);const Z=pe(j.type);Z&&this._fire(Z.pointerenter,{evt:j,target:this,currentTarget:this})}_pointerover(j){this.setPointersPositions(j);const Z=pe(j.type);Z&&this._fire(Z.pointerover,{evt:j,target:this,currentTarget:this})}_getTargetShape(j){let Z=this[j+"targetShape"];return Z&&!Z.getStage()&&(Z=null),Z}_pointerleave(j){const Z=pe(j.type),ye=ae(j.type);if(!Z)return;this.setPointersPositions(j);const Ke=this._getTargetShape(ye),ke=!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled;Ke&&ke?(Ke._fireAndBubble(Z.pointerout,{evt:j}),Ke._fireAndBubble(Z.pointerleave,{evt:j}),this._fire(Z.pointerleave,{evt:j,target:this,currentTarget:this}),this[ye+"targetShape"]=null):ke&&(this._fire(Z.pointerleave,{evt:j,target:this,currentTarget:this}),this._fire(Z.pointerout,{evt:j,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(j){const Z=pe(j.type),ye=ae(j.type);if(!Z)return;this.setPointersPositions(j);let Ke=!1;this._changedPointerPositions.forEach(ke=>{const ot=this.getIntersection(ke);if(o.DD.justDragged=!1,i.Konva["_"+ye+"ListenClick"]=!0,!ot||!ot.isListening()){this[ye+"ClickStartShape"]=void 0;return}i.Konva.capturePointerEventsEnabled&&ot.setPointerCapture(ke.id),this[ye+"ClickStartShape"]=ot,ot._fireAndBubble(Z.pointerdown,{evt:j,pointerId:ke.id}),Ke=!0;const lt=j.type.indexOf("touch")>=0;ot.preventDefault()&&j.cancelable&&lt&&j.preventDefault()}),Ke||this._fire(Z.pointerdown,{evt:j,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(j){const Z=pe(j.type),ye=ae(j.type);if(!Z||(i.Konva.isDragging()&&o.DD.node.preventDefault()&&j.cancelable&&j.preventDefault(),this.setPointersPositions(j),!(!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled)))return;const ke={};let ot=!1;const lt=this._getTargetShape(ye);this._changedPointerPositions.forEach(_r=>{const rt=c.getCapturedShape(_r.id)||this.getIntersection(_r),li=_r.id,Or={evt:j,pointerId:li},Oi=lt!==rt;if(Oi&&lt&&(lt._fireAndBubble(Z.pointerout,{...Or},rt),lt._fireAndBubble(Z.pointerleave,{...Or},rt)),rt){if(ke[rt._id])return;ke[rt._id]=!0}rt&&rt.isListening()?(ot=!0,Oi&&(rt._fireAndBubble(Z.pointerover,{...Or},lt),rt._fireAndBubble(Z.pointerenter,{...Or},lt),this[ye+"targetShape"]=rt),rt._fireAndBubble(Z.pointermove,{...Or})):lt&&(this._fire(Z.pointerover,{evt:j,target:this,currentTarget:this,pointerId:li}),this[ye+"targetShape"]=null)}),ot||this._fire(Z.pointermove,{evt:j,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(j){const Z=pe(j.type),ye=ae(j.type);if(!Z)return;this.setPointersPositions(j);const Ke=this[ye+"ClickStartShape"],ke=this[ye+"ClickEndShape"],ot={};let lt=!1;this._changedPointerPositions.forEach(_r=>{const rt=c.getCapturedShape(_r.id)||this.getIntersection(_r);if(rt){if(rt.releaseCapture(_r.id),ot[rt._id])return;ot[rt._id]=!0}const li=_r.id,Or={evt:j,pointerId:li};let Oi=!1;i.Konva["_"+ye+"InDblClickWindow"]?(Oi=!0,clearTimeout(this[ye+"DblTimeout"])):o.DD.justDragged||(i.Konva["_"+ye+"InDblClickWindow"]=!0,clearTimeout(this[ye+"DblTimeout"])),this[ye+"DblTimeout"]=setTimeout(function(){i.Konva["_"+ye+"InDblClickWindow"]=!1},i.Konva.dblClickWindow),rt&&rt.isListening()?(lt=!0,this[ye+"ClickEndShape"]=rt,rt._fireAndBubble(Z.pointerup,{...Or}),i.Konva["_"+ye+"ListenClick"]&&Ke&&Ke===rt&&(rt._fireAndBubble(Z.pointerclick,{...Or}),Oi&&ke&&ke===rt&&rt._fireAndBubble(Z.pointerdblclick,{...Or}))):(this[ye+"ClickEndShape"]=null,i.Konva["_"+ye+"ListenClick"]&&this._fire(Z.pointerclick,{evt:j,target:this,currentTarget:this,pointerId:li}),Oi&&this._fire(Z.pointerdblclick,{evt:j,target:this,currentTarget:this,pointerId:li}))}),lt||this._fire(Z.pointerup,{evt:j,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),i.Konva["_"+ye+"ListenClick"]=!1,j.cancelable&&ye!=="touch"&&ye!=="pointer"&&j.preventDefault()}_contextmenu(j){this.setPointersPositions(j);const Z=this.getIntersection(this.getPointerPosition());Z&&Z.isListening()?Z._fireAndBubble(B,{evt:j}):this._fire(B,{evt:j,target:this,currentTarget:this})}_wheel(j){this.setPointersPositions(j);const Z=this.getIntersection(this.getPointerPosition());Z&&Z.isListening()?Z._fireAndBubble(De,{evt:j}):this._fire(De,{evt:j,target:this,currentTarget:this})}_pointercancel(j){this.setPointersPositions(j);const Z=c.getCapturedShape(j.pointerId)||this.getIntersection(this.getPointerPosition());Z&&Z._fireAndBubble(F,c.createEvent(j)),c.releaseCapture(j.pointerId)}_lostpointercapture(j){c.releaseCapture(j.pointerId)}setPointersPositions(j){const Z=this._getContentPosition();let ye=null,Ke=null;j=j||window.event,j.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(j.touches,ke=>{this._pointerPositions.push({id:ke.identifier,x:(ke.clientX-Z.left)/Z.scaleX,y:(ke.clientY-Z.top)/Z.scaleY})}),Array.prototype.forEach.call(j.changedTouches||j.touches,ke=>{this._changedPointerPositions.push({id:ke.identifier,x:(ke.clientX-Z.left)/Z.scaleX,y:(ke.clientY-Z.top)/Z.scaleY})})):(ye=(j.clientX-Z.left)/Z.scaleX,Ke=(j.clientY-Z.top)/Z.scaleY,this.pointerPos={x:ye,y:Ke},this._pointerPositions=[{x:ye,y:Ke,id:e.Util._getFirstPointerId(j)}],this._changedPointerPositions=[{x:ye,y:Ke,id:e.Util._getFirstPointerId(j)}])}_setPointerPosition(j){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(j)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const j=this.content.getBoundingClientRect();return{top:j.top,left:j.left,scaleX:j.width/this.content.clientWidth||1,scaleY:j.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new s.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new s.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!i.Konva.isBrowser)return;const j=this.container();if(!j)throw"Stage has no container. A container is required.";j.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),j.appendChild(this.content),this._resizeDOM()}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(j){j.batchDraw()}),this}}n.Stage=xt,xt.prototype.nodeType=d,(0,l._registerNode)(xt),t.Factory.addGetterSetter(xt,"container"),i.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{n.stages.forEach(pt=>{pt.batchDraw()})})})(XR);var vf={},cn={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Shape=n.shapes=void 0;const e=Oe,t=Lt,r=Ue,i=Rt,s=Pe,o=Oe,l=ga,c="hasShadow",d="shadowRGBA",p="patternImage",_="linearGradient",m="radialGradient";let E;function S(){return E||(E=t.Util.createCanvasElement().getContext("2d"),E)}n.shapes={};function k(b){const A=this.attrs.fillRule;A?b.fill(A):b.fill()}function N(b){b.stroke()}function x(b){const A=this.attrs.fillRule;A?b.fill(A):b.fill()}function R(b){b.stroke()}function w(){this._clearCache(c)}function P(){this._clearCache(d)}function F(){this._clearCache(p)}function U(){this._clearCache(_)}function D(){this._clearCache(m)}class C extends i.Node{constructor(A){super(A);let M;for(;M=t.Util.getRandomColor(),!(M&&!(M in n.shapes)););this.colorKey=M,n.shapes[M]=this}getContext(){return t.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return t.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(c,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(p,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const M=S().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(M&&M.setTransform){const B=new t.Transform;B.translate(this.fillPatternX(),this.fillPatternY()),B.rotate(e.Konva.getAngle(this.fillPatternRotation())),B.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),B.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const V=B.getMatrix(),fe=typeof DOMMatrix>"u"?{a:V[0],b:V[1],c:V[2],d:V[3],e:V[4],f:V[5]}:new DOMMatrix(V);M.setTransform(fe)}return M}}_getLinearGradient(){return this._getCache(_,this.__getLinearGradient)}__getLinearGradient(){const A=this.fillLinearGradientColorStops();if(A){const M=S(),B=this.fillLinearGradientStartPoint(),V=this.fillLinearGradientEndPoint(),fe=M.createLinearGradient(B.x,B.y,V.x,V.y);for(let se=0;se<A.length;se+=2)fe.addColorStop(A[se],A[se+1]);return fe}}_getRadialGradient(){return this._getCache(m,this.__getRadialGradient)}__getRadialGradient(){const A=this.fillRadialGradientColorStops();if(A){const M=S(),B=this.fillRadialGradientStartPoint(),V=this.fillRadialGradientEndPoint(),fe=M.createRadialGradient(B.x,B.y,this.fillRadialGradientStartRadius(),V.x,V.y,this.fillRadialGradientEndRadius());for(let se=0;se<A.length;se+=2)fe.addColorStop(A[se],A[se+1]);return fe}}getShadowRGBA(){return this._getCache(d,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const A=t.Util.colorToRGBA(this.shadowColor());if(A)return"rgba("+A.r+","+A.g+","+A.b+","+A.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const A=this.hitStrokeWidth();return A==="auto"?this.hasStroke():this.strokeEnabled()&&!!A}intersects(A){const M=this.getStage();if(!M)return!1;const B=M.bufferHitCanvas;return B.getContext().clear(),this.drawHit(B,void 0,!0),B.context.getImageData(Math.round(A.x),Math.round(A.y),1,1).data[3]>0}destroy(){return i.Node.prototype.destroy.call(this),delete n.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(A){var M;if(!((M=this.attrs.perfectDrawEnabled)!==null&&M!==void 0?M:!0))return!1;const V=A||this.hasFill(),fe=this.hasStroke(),se=this.getAbsoluteOpacity()!==1;if(V&&fe&&se)return!0;const Be=this.hasShadow(),De=this.shadowForStrokeEnabled();return!!(V&&fe&&Be&&De)}setStrokeHitEnabled(A){t.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),A?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const A=this.size();return{x:this._centroid?-A.width/2:0,y:this._centroid?-A.height/2:0,width:A.width,height:A.height}}getClientRect(A={}){let M=!1,B=this.getParent();for(;B;){if(B.isCached()){M=!0;break}B=B.getParent()}const V=A.skipTransform,fe=A.relativeTo||M&&this.getStage()||void 0,se=this.getSelfRect(),De=!A.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,Y=se.width+De,oe=se.height+De,ne=!A.skipShadow&&this.hasShadow(),ae=ne?this.shadowOffsetX():0,pe=ne?this.shadowOffsetY():0,Se=Y+Math.abs(ae),en=oe+Math.abs(pe),xt=ne&&this.shadowBlur()||0,pt=Se+xt*2,j=en+xt*2,Z={width:pt,height:j,x:-(De/2+xt)+Math.min(ae,0)+se.x,y:-(De/2+xt)+Math.min(pe,0)+se.y};return V?Z:this._transformedRect(Z,fe)}drawScene(A,M,B){const V=this.getLayer(),fe=A||V.getCanvas(),se=fe.getContext(),Be=this._getCanvasCache(),De=this.getSceneFunc(),Y=this.hasShadow();let oe;const ne=M===this;if(!this.isVisible()&&!ne)return this;if(Be){se.save();const ae=this.getAbsoluteTransform(M).getMatrix();return se.transform(ae[0],ae[1],ae[2],ae[3],ae[4],ae[5]),this._drawCachedSceneCanvas(se),se.restore(),this}if(!De)return this;if(se.save(),this._useBufferCanvas()){oe=this.getStage();const ae=B||oe.bufferCanvas,pe=ae.getContext();pe.clear(),pe.save(),pe._applyLineJoin(this);const Se=this.getAbsoluteTransform(M).getMatrix();pe.transform(Se[0],Se[1],Se[2],Se[3],Se[4],Se[5]),De.call(this,pe,this),pe.restore();const en=ae.pixelRatio;Y&&se._applyShadow(this),se._applyOpacity(this),se._applyGlobalCompositeOperation(this),se.drawImage(ae._canvas,ae.x||0,ae.y||0,ae.width/en,ae.height/en)}else{if(se._applyLineJoin(this),!ne){const ae=this.getAbsoluteTransform(M).getMatrix();se.transform(ae[0],ae[1],ae[2],ae[3],ae[4],ae[5]),se._applyOpacity(this),se._applyGlobalCompositeOperation(this)}Y&&se._applyShadow(this),De.call(this,se,this)}return se.restore(),this}drawHit(A,M,B=!1){if(!this.shouldDrawHit(M,B))return this;const V=this.getLayer(),fe=A||V.hitCanvas,se=fe&&fe.getContext(),Be=this.hitFunc()||this.sceneFunc(),De=this._getCanvasCache(),Y=De&&De.hit;if(this.colorKey||t.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),Y){se.save();const ne=this.getAbsoluteTransform(M).getMatrix();return se.transform(ne[0],ne[1],ne[2],ne[3],ne[4],ne[5]),this._drawCachedHitCanvas(se),se.restore(),this}if(!Be)return this;if(se.save(),se._applyLineJoin(this),!(this===M)){const ne=this.getAbsoluteTransform(M).getMatrix();se.transform(ne[0],ne[1],ne[2],ne[3],ne[4],ne[5])}return Be.call(this,se,this),se.restore(),this}drawHitFromCache(A=0){const M=this._getCanvasCache(),B=this._getCachedSceneCanvas(),V=M.hit,fe=V.getContext(),se=V.getWidth(),Be=V.getHeight();fe.clear(),fe.drawImage(B._canvas,0,0,se,Be);try{const De=fe.getImageData(0,0,se,Be),Y=De.data,oe=Y.length,ne=t.Util._hexToRgb(this.colorKey);for(let ae=0;ae<oe;ae+=4)Y[ae+3]>A?(Y[ae]=ne.r,Y[ae+1]=ne.g,Y[ae+2]=ne.b,Y[ae+3]=255):Y[ae+3]=0;fe.putImageData(De,0,0)}catch(De){t.Util.error("Unable to draw hit graph from cached scene canvas. "+De.message)}return this}hasPointerCapture(A){return l.hasPointerCapture(A,this)}setPointerCapture(A){l.setPointerCapture(A,this)}releaseCapture(A){l.releaseCapture(A,this)}}n.Shape=C,C.prototype._fillFunc=k,C.prototype._strokeFunc=N,C.prototype._fillFuncHit=x,C.prototype._strokeFuncHit=R,C.prototype._centroid=!1,C.prototype.nodeType="Shape",(0,o._registerNode)(C),C.prototype.eventListeners={},C.prototype.on.call(C.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",w),C.prototype.on.call(C.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",P),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",F),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",U),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",D),r.Factory.addGetterSetter(C,"stroke",void 0,(0,s.getStringOrGradientValidator)()),r.Factory.addGetterSetter(C,"strokeWidth",2,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillAfterStrokeEnabled",!1),r.Factory.addGetterSetter(C,"hitStrokeWidth","auto",(0,s.getNumberOrAutoValidator)()),r.Factory.addGetterSetter(C,"strokeHitEnabled",!0,(0,s.getBooleanValidator)()),r.Factory.addGetterSetter(C,"perfectDrawEnabled",!0,(0,s.getBooleanValidator)()),r.Factory.addGetterSetter(C,"shadowForStrokeEnabled",!0,(0,s.getBooleanValidator)()),r.Factory.addGetterSetter(C,"lineJoin"),r.Factory.addGetterSetter(C,"lineCap"),r.Factory.addGetterSetter(C,"sceneFunc"),r.Factory.addGetterSetter(C,"hitFunc"),r.Factory.addGetterSetter(C,"dash"),r.Factory.addGetterSetter(C,"dashOffset",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"shadowColor",void 0,(0,s.getStringValidator)()),r.Factory.addGetterSetter(C,"shadowBlur",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"shadowOpacity",1,(0,s.getNumberValidator)()),r.Factory.addComponentsGetterSetter(C,"shadowOffset",["x","y"]),r.Factory.addGetterSetter(C,"shadowOffsetX",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"shadowOffsetY",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillPatternImage"),r.Factory.addGetterSetter(C,"fill",void 0,(0,s.getStringOrGradientValidator)()),r.Factory.addGetterSetter(C,"fillPatternX",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillPatternY",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillLinearGradientColorStops"),r.Factory.addGetterSetter(C,"strokeLinearGradientColorStops"),r.Factory.addGetterSetter(C,"fillRadialGradientStartRadius",0),r.Factory.addGetterSetter(C,"fillRadialGradientEndRadius",0),r.Factory.addGetterSetter(C,"fillRadialGradientColorStops"),r.Factory.addGetterSetter(C,"fillPatternRepeat","repeat"),r.Factory.addGetterSetter(C,"fillEnabled",!0),r.Factory.addGetterSetter(C,"strokeEnabled",!0),r.Factory.addGetterSetter(C,"shadowEnabled",!0),r.Factory.addGetterSetter(C,"dashEnabled",!0),r.Factory.addGetterSetter(C,"strokeScaleEnabled",!0),r.Factory.addGetterSetter(C,"fillPriority","color"),r.Factory.addComponentsGetterSetter(C,"fillPatternOffset",["x","y"]),r.Factory.addGetterSetter(C,"fillPatternOffsetX",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillPatternOffsetY",0,(0,s.getNumberValidator)()),r.Factory.addComponentsGetterSetter(C,"fillPatternScale",["x","y"]),r.Factory.addGetterSetter(C,"fillPatternScaleX",1,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillPatternScaleY",1,(0,s.getNumberValidator)()),r.Factory.addComponentsGetterSetter(C,"fillLinearGradientStartPoint",["x","y"]),r.Factory.addComponentsGetterSetter(C,"strokeLinearGradientStartPoint",["x","y"]),r.Factory.addGetterSetter(C,"fillLinearGradientStartPointX",0),r.Factory.addGetterSetter(C,"strokeLinearGradientStartPointX",0),r.Factory.addGetterSetter(C,"fillLinearGradientStartPointY",0),r.Factory.addGetterSetter(C,"strokeLinearGradientStartPointY",0),r.Factory.addComponentsGetterSetter(C,"fillLinearGradientEndPoint",["x","y"]),r.Factory.addComponentsGetterSetter(C,"strokeLinearGradientEndPoint",["x","y"]),r.Factory.addGetterSetter(C,"fillLinearGradientEndPointX",0),r.Factory.addGetterSetter(C,"strokeLinearGradientEndPointX",0),r.Factory.addGetterSetter(C,"fillLinearGradientEndPointY",0),r.Factory.addGetterSetter(C,"strokeLinearGradientEndPointY",0),r.Factory.addComponentsGetterSetter(C,"fillRadialGradientStartPoint",["x","y"]),r.Factory.addGetterSetter(C,"fillRadialGradientStartPointX",0),r.Factory.addGetterSetter(C,"fillRadialGradientStartPointY",0),r.Factory.addComponentsGetterSetter(C,"fillRadialGradientEndPoint",["x","y"]),r.Factory.addGetterSetter(C,"fillRadialGradientEndPointX",0),r.Factory.addGetterSetter(C,"fillRadialGradientEndPointY",0),r.Factory.addGetterSetter(C,"fillPatternRotation",0),r.Factory.addGetterSetter(C,"fillRule",void 0,(0,s.getStringValidator)()),r.Factory.backCompat(C,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(cn);Object.defineProperty(vf,"__esModule",{value:!0});vf.Layer=void 0;const Cs=Lt,Cv=Il,su=Rt,uS=Ue,r5=Ai,$z=Pe,qz=cn,Kz=Oe,Qz="#",Yz="beforeDraw",Xz="draw",ex=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],Jz=ex.length;let Tc=class extends Cv.Container{constructor(e){super(e),this.canvas=new r5.SceneCanvas,this.hitCanvas=new r5.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(e){return this.getContext().clear(e),this.getHitCanvas().getContext().clear(e),this}setZIndex(e){super.setZIndex(e);const t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),e<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[e+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){su.Node.prototype.moveToTop.call(this);const e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!su.Node.prototype.moveUp.call(this))return!1;const t=this.getStage();return!t||!t.content?!1:(t.content.removeChild(this.getNativeCanvasElement()),this.index<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[this.index+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(su.Node.prototype.moveDown.call(this)){const e=this.getStage();if(e){const t=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),t[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(su.Node.prototype.moveToBottom.call(this)){const e=this.getStage();if(e){const t=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),t[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const e=this.getNativeCanvasElement();return su.Node.prototype.remove.call(this),e&&e.parentNode&&Cs.Util._isInDocument(e)&&e.parentNode.removeChild(e),this}getStage(){return this.parent}setSize({width:e,height:t}){return this.canvas.setSize(e,t),this.hitCanvas.setSize(e,t),this._setSmoothEnabled(),this}_validateAdd(e){const t=e.getType();t!=="Group"&&t!=="Shape"&&Cs.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(e){return e=e||{},e.width=e.width||this.getWidth(),e.height=e.height||this.getHeight(),e.x=e.x!==void 0?e.x:this.x(),e.y=e.y!==void 0?e.y:this.y(),su.Node.prototype._toKonvaCanvas.call(this,e)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){Cs.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){Cs.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,Cs.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(e){if(!this.isListening()||!this.isVisible())return null;let t=1,r=!1;for(;;){for(let i=0;i<Jz;i++){const s=ex[i],o=this._getIntersection({x:e.x+s.x*t,y:e.y+s.y*t}),l=o.shape;if(l)return l;if(r=!!o.antialiased,!o.antialiased)break}if(r)t+=1;else return null}}_getIntersection(e){const t=this.hitCanvas.pixelRatio,r=this.hitCanvas.context.getImageData(Math.round(e.x*t),Math.round(e.y*t),1,1).data,i=r[3];if(i===255){const s=Cs.Util._rgbToHex(r[0],r[1],r[2]),o=qz.shapes[Qz+s];return o?{shape:o}:{antialiased:!0}}else if(i>0)return{antialiased:!0};return{}}drawScene(e,t,r){const i=this.getLayer(),s=e||i&&i.getCanvas();return this._fire(Yz,{node:this}),this.clearBeforeDraw()&&s.getContext().clear(),Cv.Container.prototype.drawScene.call(this,s,t,r),this._fire(Xz,{node:this}),this}drawHit(e,t){const r=this.getLayer(),i=e||r&&r.hitCanvas;return r&&r.clearBeforeDraw()&&r.getHitCanvas().getContext().clear(),Cv.Container.prototype.drawHit.call(this,i,t),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(e){Cs.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(e)}getHitGraphEnabled(e){return Cs.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const e=this.parent;!!this.hitCanvas._canvas.parentNode?e.content.removeChild(this.hitCanvas._canvas):e.content.appendChild(this.hitCanvas._canvas)}destroy(){return Cs.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};vf.Layer=Tc;Tc.prototype.nodeType="Layer";(0,Kz._registerNode)(Tc);uS.Factory.addGetterSetter(Tc,"imageSmoothingEnabled",!0);uS.Factory.addGetterSetter(Tc,"clearBeforeDraw",!0);uS.Factory.addGetterSetter(Tc,"hitGraphEnabled",!0,(0,$z.getBooleanValidator)());var j0={};Object.defineProperty(j0,"__esModule",{value:!0});j0.FastLayer=void 0;const Zz=Lt,ej=vf,tj=Oe;class cS extends ej.Layer{constructor(e){super(e),this.listening(!1),Zz.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}j0.FastLayer=cS;cS.prototype.nodeType="FastLayer";(0,tj._registerNode)(cS);var Cc={};Object.defineProperty(Cc,"__esModule",{value:!0});Cc.Group=void 0;const nj=Lt,rj=Il,ij=Oe;let hS=class extends rj.Container{_validateAdd(e){const t=e.getType();t!=="Group"&&t!=="Shape"&&nj.Util.throw("You may only add groups and shapes to groups.")}};Cc.Group=hS;hS.prototype.nodeType="Group";(0,ij._registerNode)(hS);var Ic={};Object.defineProperty(Ic,"__esModule",{value:!0});Ic.Animation=void 0;const Iv=Oe,i5=Lt,Pv=function(){return Iv.glob.performance&&Iv.glob.performance.now?function(){return Iv.glob.performance.now()}:function(){return new Date().getTime()}}();class Ji{constructor(e,t){this.id=Ji.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:Pv(),frameRate:0},this.func=e,this.setLayers(t)}setLayers(e){let t=[];return e&&(t=Array.isArray(e)?e:[e]),this.layers=t,this}getLayers(){return this.layers}addLayer(e){const t=this.layers,r=t.length;for(let i=0;i<r;i++)if(t[i]._id===e._id)return!1;return this.layers.push(e),!0}isRunning(){const t=Ji.animations,r=t.length;for(let i=0;i<r;i++)if(t[i].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=Pv(),Ji._addAnimation(this),this}stop(){return Ji._removeAnimation(this),this}_updateFrameObject(e){this.frame.timeDiff=e-this.frame.lastTime,this.frame.lastTime=e,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(e){this.animations.push(e),this._handleAnimation()}static _removeAnimation(e){const t=e.id,r=this.animations,i=r.length;for(let s=0;s<i;s++)if(r[s].id===t){this.animations.splice(s,1);break}}static _runFrames(){const e={},t=this.animations;for(let r=0;r<t.length;r++){const i=t[r],s=i.layers,o=i.func;i._updateFrameObject(Pv());const l=s.length;let c;if(o?c=o.call(i,i.frame)!==!1:c=!0,!!c)for(let d=0;d<l;d++){const p=s[d];p._id!==void 0&&(e[p._id]=p)}}for(const r in e)e.hasOwnProperty(r)&&e[r].batchDraw()}static _animationLoop(){const e=Ji;e.animations.length?(e._runFrames(),i5.Util.requestAnimFrame(e._animationLoop)):e.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,i5.Util.requestAnimFrame(this._animationLoop))}}Ic.Animation=Ji;Ji.animations=[];Ji.animIdCounter=0;Ji.animRunning=!1;var tx={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Easings=n.Tween=void 0;const e=Lt,t=Ic,r=Rt,i=Oe,s={node:1,duration:1,easing:1,onFinish:1,yoyo:1},o=1,l=2,c=3,d=["fill","stroke","shadowColor"];let p=0;class _{constructor(S,k,N,x,R,w,P){this.prop=S,this.propFunc=k,this.begin=x,this._pos=x,this.duration=w,this._change=0,this.prevPos=0,this.yoyo=P,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=N,this._change=R-this.begin,this.pause()}fire(S){const k=this[S];k&&k()}setTime(S){S>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():S<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=S,this.update())}getTime(){return this._time}setPosition(S){this.prevPos=this._pos,this.propFunc(S),this._pos=S}getPosition(S){return S===void 0&&(S=this._time),this.func(S,this.begin,this._change,this.duration)}play(){this.state=l,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=c,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(S){this.pause(),this._time=S,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const S=this.getTimer()-this._startTime;this.state===l?this.setTime(S):this.state===c&&this.setTime(this.duration-S)}pause(){this.state=o,this.fire("onPause")}getTimer(){return new Date().getTime()}}class m{constructor(S){const k=this,N=S.node,x=N._id,R=S.easing||n.Easings.Linear,w=!!S.yoyo;let P,F;typeof S.duration>"u"?P=.3:S.duration===0?P=.001:P=S.duration,this.node=N,this._id=p++;const U=N.getLayer()||(N instanceof i.Konva.Stage?N.getLayers():null);U||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new t.Animation(function(){k.tween.onEnterFrame()},U),this.tween=new _(F,function(D){k._tweenFunc(D)},R,0,1,P*1e3,w),this._addListeners(),m.attrs[x]||(m.attrs[x]={}),m.attrs[x][this._id]||(m.attrs[x][this._id]={}),m.tweens[x]||(m.tweens[x]={});for(F in S)s[F]===void 0&&this._addAttr(F,S[F]);this.reset(),this.onFinish=S.onFinish,this.onReset=S.onReset,this.onUpdate=S.onUpdate}_addAttr(S,k){const N=this.node,x=N._id;let R,w,P,F,U;const D=m.tweens[x][S];D&&delete m.attrs[x][D][S];let C=N.getAttr(S);if(e.Util._isArray(k))if(R=[],w=Math.max(k.length,C.length),S==="points"&&k.length!==C.length&&(k.length>C.length?(F=C,C=e.Util._prepareArrayForTween(C,k,N.closed())):(P=k,k=e.Util._prepareArrayForTween(k,C,N.closed()))),S.indexOf("fill")===0)for(let b=0;b<w;b++)if(b%2===0)R.push(k[b]-C[b]);else{const A=e.Util.colorToRGBA(C[b]);U=e.Util.colorToRGBA(k[b]),C[b]=A,R.push({r:U.r-A.r,g:U.g-A.g,b:U.b-A.b,a:U.a-A.a})}else for(let b=0;b<w;b++)R.push(k[b]-C[b]);else d.indexOf(S)!==-1?(C=e.Util.colorToRGBA(C),U=e.Util.colorToRGBA(k),R={r:U.r-C.r,g:U.g-C.g,b:U.b-C.b,a:U.a-C.a}):R=k-C;m.attrs[x][this._id][S]={start:C,diff:R,end:k,trueEnd:P,trueStart:F},m.tweens[x][S]=this._id}_tweenFunc(S){const k=this.node,N=m.attrs[k._id][this._id];let x,R,w,P,F,U,D,C;for(x in N){if(R=N[x],w=R.start,P=R.diff,C=R.end,e.Util._isArray(w))if(F=[],D=Math.max(w.length,C.length),x.indexOf("fill")===0)for(U=0;U<D;U++)U%2===0?F.push((w[U]||0)+P[U]*S):F.push("rgba("+Math.round(w[U].r+P[U].r*S)+","+Math.round(w[U].g+P[U].g*S)+","+Math.round(w[U].b+P[U].b*S)+","+(w[U].a+P[U].a*S)+")");else for(U=0;U<D;U++)F.push((w[U]||0)+P[U]*S);else d.indexOf(x)!==-1?F="rgba("+Math.round(w.r+P.r*S)+","+Math.round(w.g+P.g*S)+","+Math.round(w.b+P.b*S)+","+(w.a+P.a*S)+")":F=w+P*S;k.setAttr(x,F)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const S=this.node,k=m.attrs[S._id][this._id];k.points&&k.points.trueEnd&&S.setAttr("points",k.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const S=this.node,k=m.attrs[S._id][this._id];k.points&&k.points.trueStart&&S.points(k.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(S){return this.tween.seek(S*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const S=this.node._id,k=this._id,N=m.tweens[S];this.pause(),this.anim&&this.anim.stop();for(const x in N)delete m.tweens[S][x];delete m.attrs[S][k],m.tweens[S]&&(Object.keys(m.tweens[S]).length===0&&delete m.tweens[S],Object.keys(m.attrs[S]).length===0&&delete m.attrs[S])}}n.Tween=m,m.attrs={},m.tweens={},r.Node.prototype.to=function(E){const S=E.onFinish;E.node=this,E.onFinish=function(){this.destroy(),S&&S()},new m(E).play()},n.Easings={BackEaseIn(E,S,k,N){return k*(E/=N)*E*((1.70158+1)*E-1.70158)+S},BackEaseOut(E,S,k,N){return k*((E=E/N-1)*E*((1.70158+1)*E+1.70158)+1)+S},BackEaseInOut(E,S,k,N){let x=1.70158;return(E/=N/2)<1?k/2*(E*E*(((x*=1.525)+1)*E-x))+S:k/2*((E-=2)*E*(((x*=1.525)+1)*E+x)+2)+S},ElasticEaseIn(E,S,k,N,x,R){let w=0;return E===0?S:(E/=N)===1?S+k:(R||(R=N*.3),!x||x<Math.abs(k)?(x=k,w=R/4):w=R/(2*Math.PI)*Math.asin(k/x),-(x*Math.pow(2,10*(E-=1))*Math.sin((E*N-w)*(2*Math.PI)/R))+S)},ElasticEaseOut(E,S,k,N,x,R){let w=0;return E===0?S:(E/=N)===1?S+k:(R||(R=N*.3),!x||x<Math.abs(k)?(x=k,w=R/4):w=R/(2*Math.PI)*Math.asin(k/x),x*Math.pow(2,-10*E)*Math.sin((E*N-w)*(2*Math.PI)/R)+k+S)},ElasticEaseInOut(E,S,k,N,x,R){let w=0;return E===0?S:(E/=N/2)===2?S+k:(R||(R=N*(.3*1.5)),!x||x<Math.abs(k)?(x=k,w=R/4):w=R/(2*Math.PI)*Math.asin(k/x),E<1?-.5*(x*Math.pow(2,10*(E-=1))*Math.sin((E*N-w)*(2*Math.PI)/R))+S:x*Math.pow(2,-10*(E-=1))*Math.sin((E*N-w)*(2*Math.PI)/R)*.5+k+S)},BounceEaseOut(E,S,k,N){return(E/=N)<1/2.75?k*(7.5625*E*E)+S:E<2/2.75?k*(7.5625*(E-=1.5/2.75)*E+.75)+S:E<2.5/2.75?k*(7.5625*(E-=2.25/2.75)*E+.9375)+S:k*(7.5625*(E-=2.625/2.75)*E+.984375)+S},BounceEaseIn(E,S,k,N){return k-n.Easings.BounceEaseOut(N-E,0,k,N)+S},BounceEaseInOut(E,S,k,N){return E<N/2?n.Easings.BounceEaseIn(E*2,0,k,N)*.5+S:n.Easings.BounceEaseOut(E*2-N,0,k,N)*.5+k*.5+S},EaseIn(E,S,k,N){return k*(E/=N)*E+S},EaseOut(E,S,k,N){return-k*(E/=N)*(E-2)+S},EaseInOut(E,S,k,N){return(E/=N/2)<1?k/2*E*E+S:-k/2*(--E*(E-2)-1)+S},StrongEaseIn(E,S,k,N){return k*(E/=N)*E*E*E*E+S},StrongEaseOut(E,S,k,N){return k*((E=E/N-1)*E*E*E*E+1)+S},StrongEaseInOut(E,S,k,N){return(E/=N/2)<1?k/2*E*E*E*E*E+S:k/2*((E-=2)*E*E*E*E+2)+S},Linear(E,S,k,N){return k*E/N+S}}})(tx);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Konva=void 0;const e=Oe,t=Lt,r=Rt,i=Il,s=XR,o=vf,l=j0,c=Cc,d=B0,p=cn,_=Ic,m=tx,E=js,S=Ai;n.Konva=t.Util._assign(e.Konva,{Util:t.Util,Transform:t.Transform,Node:r.Node,Container:i.Container,Stage:s.Stage,stages:s.stages,Layer:o.Layer,FastLayer:l.FastLayer,Group:c.Group,DD:d.DD,Shape:p.Shape,shapes:p.shapes,Animation:_.Animation,Tween:m.Tween,Easings:m.Easings,Context:E.Context,Canvas:S.Canvas}),n.default=n.Konva})(Nm);var G0={};Object.defineProperty(G0,"__esModule",{value:!0});G0.Arc=void 0;const W0=Ue,sj=cn,s5=Oe,H0=Pe,oj=Oe;class io extends sj.Shape{_sceneFunc(e){const t=s5.Konva.getAngle(this.angle()),r=this.clockwise();e.beginPath(),e.arc(0,0,this.outerRadius(),0,t,r),e.arc(0,0,this.innerRadius(),t,0,!r),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}getSelfRect(){const e=this.innerRadius(),t=this.outerRadius(),r=this.clockwise(),i=s5.Konva.getAngle(r?360-this.angle():this.angle()),s=Math.cos(Math.min(i,Math.PI)),o=1,l=Math.sin(Math.min(Math.max(Math.PI,i),3*Math.PI/2)),c=Math.sin(Math.min(i,Math.PI/2)),d=s*(s>0?e:t),p=o*t,_=l*(l>0?e:t),m=c*(c>0?t:e);return{x:d,y:r?-1*m:_,width:p-d,height:m-_}}}G0.Arc=io;io.prototype._centroid=!0;io.prototype.className="Arc";io.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];(0,oj._registerNode)(io);W0.Factory.addGetterSetter(io,"innerRadius",0,(0,H0.getNumberValidator)());W0.Factory.addGetterSetter(io,"outerRadius",0,(0,H0.getNumberValidator)());W0.Factory.addGetterSetter(io,"angle",0,(0,H0.getNumberValidator)());W0.Factory.addGetterSetter(io,"clockwise",!1,(0,H0.getBooleanValidator)());var $0={},wf={};Object.defineProperty(wf,"__esModule",{value:!0});wf.Line=void 0;const q0=Ue,aj=Oe,lj=cn,nx=Pe;function S2(n,e,t,r,i,s,o){const l=Math.sqrt(Math.pow(t-n,2)+Math.pow(r-e,2)),c=Math.sqrt(Math.pow(i-t,2)+Math.pow(s-r,2)),d=o*l/(l+c),p=o*c/(l+c),_=t-d*(i-n),m=r-d*(s-e),E=t+p*(i-n),S=r+p*(s-e);return[_,m,E,S]}function o5(n,e){const t=n.length,r=[];for(let i=2;i<t-2;i+=2){const s=S2(n[i-2],n[i-1],n[i],n[i+1],n[i+2],n[i+3],e);isNaN(s[0])||(r.push(s[0]),r.push(s[1]),r.push(n[i]),r.push(n[i+1]),r.push(s[2]),r.push(s[3]))}return r}let ma=class extends lj.Shape{constructor(e){super(e),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(e){const t=this.points(),r=t.length,i=this.tension(),s=this.closed(),o=this.bezier();if(!r)return;let l=0;if(e.beginPath(),e.moveTo(t[0],t[1]),i!==0&&r>4){const c=this.getTensionPoints(),d=c.length;for(l=s?0:4,s||e.quadraticCurveTo(c[0],c[1],c[2],c[3]);l<d-2;)e.bezierCurveTo(c[l++],c[l++],c[l++],c[l++],c[l++],c[l++]);s||e.quadraticCurveTo(c[d-2],c[d-1],t[r-2],t[r-1])}else if(o)for(l=2;l<r;)e.bezierCurveTo(t[l++],t[l++],t[l++],t[l++],t[l++],t[l++]);else for(l=2;l<r;l+=2)e.lineTo(t[l],t[l+1]);s?(e.closePath(),e.fillStrokeShape(this)):e.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():o5(this.points(),this.tension())}_getTensionPointsClosed(){const e=this.points(),t=e.length,r=this.tension(),i=S2(e[t-2],e[t-1],e[0],e[1],e[2],e[3],r),s=S2(e[t-4],e[t-3],e[t-2],e[t-1],e[0],e[1],r),o=o5(e,r);return[i[2],i[3]].concat(o).concat([s[0],s[1],e[t-2],e[t-1],s[2],s[3],i[0],i[1],e[0],e[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let e=this.points();if(e.length<4)return{x:e[0]||0,y:e[1]||0,width:0,height:0};this.tension()!==0?e=[e[0],e[1],...this._getTensionPoints(),e[e.length-2],e[e.length-1]]:e=this.points();let t=e[0],r=e[0],i=e[1],s=e[1],o,l;for(let c=0;c<e.length/2;c++)o=e[c*2],l=e[c*2+1],t=Math.min(t,o),r=Math.max(r,o),i=Math.min(i,l),s=Math.max(s,l);return{x:t,y:i,width:r-t,height:s-i}}};wf.Line=ma;ma.prototype.className="Line";ma.prototype._attrsAffectingSize=["points","bezier","tension"];(0,aj._registerNode)(ma);q0.Factory.addGetterSetter(ma,"closed",!1);q0.Factory.addGetterSetter(ma,"bezier",!1);q0.Factory.addGetterSetter(ma,"tension",0,(0,nx.getNumberValidator)());q0.Factory.addGetterSetter(ma,"points",[],(0,nx.getNumberArrayValidator)());var Pc={},rx={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.t2length=n.getQuadraticArcLength=n.getCubicArcLength=n.binomialCoefficients=n.cValues=n.tValues=void 0,n.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],n.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],n.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(o,l,c)=>{let d,p;const m=c/2;d=0;for(let E=0;E<20;E++)p=m*n.tValues[20][E]+m,d+=n.cValues[20][E]*r(o,l,p);return m*d};n.getCubicArcLength=e;const t=(o,l,c)=>{c===void 0&&(c=1);const d=o[0]-2*o[1]+o[2],p=l[0]-2*l[1]+l[2],_=2*o[1]-2*o[0],m=2*l[1]-2*l[0],E=4*(d*d+p*p),S=4*(d*_+p*m),k=_*_+m*m;if(E===0)return c*Math.sqrt(Math.pow(o[2]-o[0],2)+Math.pow(l[2]-l[0],2));const N=S/(2*E),x=k/E,R=c+N,w=x-N*N,P=R*R+w>0?Math.sqrt(R*R+w):0,F=N*N+w>0?Math.sqrt(N*N+w):0,U=N+Math.sqrt(N*N+w)!==0?w*Math.log(Math.abs((R+P)/(N+F))):0;return Math.sqrt(E)/2*(R*P-N*F+U)};n.getQuadraticArcLength=t;function r(o,l,c){const d=i(1,c,o),p=i(1,c,l),_=d*d+p*p;return Math.sqrt(_)}const i=(o,l,c)=>{const d=c.length-1;let p,_;if(d===0)return 0;if(o===0){_=0;for(let m=0;m<=d;m++)_+=n.binomialCoefficients[d][m]*Math.pow(1-l,d-m)*Math.pow(l,m)*c[m];return _}else{p=new Array(d);for(let m=0;m<d;m++)p[m]=d*(c[m+1]-c[m]);return i(o-1,l,p)}},s=(o,l,c)=>{let d=1,p=o/l,_=(o-c(p))/l,m=0;for(;d>.001;){const E=c(p+_),S=Math.abs(o-E)/l;if(S<d)d=S,p+=_;else{const k=c(p-_),N=Math.abs(o-k)/l;N<d?(d=N,p-=_):_/=2}if(m++,m>500)break}return p};n.t2length=s})(rx);Object.defineProperty(Pc,"__esModule",{value:!0});Pc.Path=void 0;const uj=Ue,cj=Oe,hj=cn,ou=rx;class on extends hj.Shape{constructor(e){super(e),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=on.parsePathData(this.data()),this.pathLength=on.getPathLength(this.dataArray)}_sceneFunc(e){const t=this.dataArray;e.beginPath();let r=!1;for(let i=0;i<t.length;i++){const s=t[i].command,o=t[i].points;switch(s){case"L":e.lineTo(o[0],o[1]);break;case"M":e.moveTo(o[0],o[1]);break;case"C":e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]);break;case"Q":e.quadraticCurveTo(o[0],o[1],o[2],o[3]);break;case"A":const l=o[0],c=o[1],d=o[2],p=o[3],_=o[4],m=o[5],E=o[6],S=o[7],k=d>p?d:p,N=d>p?1:d/p,x=d>p?p/d:1;e.translate(l,c),e.rotate(E),e.scale(N,x),e.arc(0,0,k,_,_+m,1-S),e.scale(1/N,1/x),e.rotate(-E),e.translate(-l,-c);break;case"z":r=!0,e.closePath();break}}!r&&!this.hasFill()?e.strokeShape(this):e.fillStrokeShape(this)}getSelfRect(){let e=[];this.dataArray.forEach(function(c){if(c.command==="A"){const d=c.points[4],p=c.points[5],_=c.points[4]+p;let m=Math.PI/180;if(Math.abs(d-_)<m&&(m=Math.abs(d-_)),p<0)for(let E=d-m;E>_;E-=m){const S=on.getPointOnEllipticalArc(c.points[0],c.points[1],c.points[2],c.points[3],E,0);e.push(S.x,S.y)}else for(let E=d+m;E<_;E+=m){const S=on.getPointOnEllipticalArc(c.points[0],c.points[1],c.points[2],c.points[3],E,0);e.push(S.x,S.y)}}else if(c.command==="C")for(let d=0;d<=1;d+=.01){const p=on.getPointOnCubicBezier(d,c.start.x,c.start.y,c.points[0],c.points[1],c.points[2],c.points[3],c.points[4],c.points[5]);e.push(p.x,p.y)}else e=e.concat(c.points)});let t=e[0],r=e[0],i=e[1],s=e[1],o,l;for(let c=0;c<e.length/2;c++)o=e[c*2],l=e[c*2+1],isNaN(o)||(t=Math.min(t,o),r=Math.max(r,o)),isNaN(l)||(i=Math.min(i,l),s=Math.max(s,l));return{x:t,y:i,width:r-t,height:s-i}}getLength(){return this.pathLength}getPointAtLength(e){return on.getPointAtLengthOfDataArray(e,this.dataArray)}static getLineLength(e,t,r,i){return Math.sqrt((r-e)*(r-e)+(i-t)*(i-t))}static getPathLength(e){let t=0;for(let r=0;r<e.length;++r)t+=e[r].pathLength;return t}static getPointAtLengthOfDataArray(e,t){let r,i=0,s=t.length;if(!s)return null;for(;i<s&&e>t[i].pathLength;)e-=t[i].pathLength,++i;if(i===s)return r=t[i-1].points.slice(-2),{x:r[0],y:r[1]};if(e<.01)return t[i].command==="M"?(r=t[i].points.slice(0,2),{x:r[0],y:r[1]}):{x:t[i].start.x,y:t[i].start.y};const o=t[i],l=o.points;switch(o.command){case"L":return on.getPointOnLine(e,o.start.x,o.start.y,l[0],l[1]);case"C":return on.getPointOnCubicBezier((0,ou.t2length)(e,on.getPathLength(t),k=>(0,ou.getCubicArcLength)([o.start.x,l[0],l[2],l[4]],[o.start.y,l[1],l[3],l[5]],k)),o.start.x,o.start.y,l[0],l[1],l[2],l[3],l[4],l[5]);case"Q":return on.getPointOnQuadraticBezier((0,ou.t2length)(e,on.getPathLength(t),k=>(0,ou.getQuadraticArcLength)([o.start.x,l[0],l[2]],[o.start.y,l[1],l[3]],k)),o.start.x,o.start.y,l[0],l[1],l[2],l[3]);case"A":const c=l[0],d=l[1],p=l[2],_=l[3],m=l[5],E=l[6];let S=l[4];return S+=m*e/o.pathLength,on.getPointOnEllipticalArc(c,d,p,_,S,E)}return null}static getPointOnLine(e,t,r,i,s,o,l){o=o??t,l=l??r;const c=this.getLineLength(t,r,i,s);if(c<1e-10)return{x:t,y:r};if(i===t)return{x:o,y:l+(s>r?e:-e)};const d=(s-r)/(i-t),p=Math.sqrt(e*e/(1+d*d))*(i<t?-1:1),_=d*p;if(Math.abs(l-r-d*(o-t))<1e-10)return{x:o+p,y:l+_};const m=((o-t)*(i-t)+(l-r)*(s-r))/(c*c),E=t+m*(i-t),S=r+m*(s-r),k=this.getLineLength(o,l,E,S),N=Math.sqrt(e*e-k*k),x=Math.sqrt(N*N/(1+d*d))*(i<t?-1:1),R=d*x;return{x:E+x,y:S+R}}static getPointOnCubicBezier(e,t,r,i,s,o,l,c,d){function p(N){return N*N*N}function _(N){return 3*N*N*(1-N)}function m(N){return 3*N*(1-N)*(1-N)}function E(N){return(1-N)*(1-N)*(1-N)}const S=c*p(e)+o*_(e)+i*m(e)+t*E(e),k=d*p(e)+l*_(e)+s*m(e)+r*E(e);return{x:S,y:k}}static getPointOnQuadraticBezier(e,t,r,i,s,o,l){function c(E){return E*E}function d(E){return 2*E*(1-E)}function p(E){return(1-E)*(1-E)}const _=o*c(e)+i*d(e)+t*p(e),m=l*c(e)+s*d(e)+r*p(e);return{x:_,y:m}}static getPointOnEllipticalArc(e,t,r,i,s,o){const l=Math.cos(o),c=Math.sin(o),d={x:r*Math.cos(s),y:i*Math.sin(s)};return{x:e+(d.x*l-d.y*c),y:t+(d.x*c+d.y*l)}}static parsePathData(e){if(!e)return[];let t=e;const r=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];t=t.replace(new RegExp(" ","g"),",");for(let _=0;_<r.length;_++)t=t.replace(new RegExp(r[_],"g"),"|"+r[_]);const i=t.split("|"),s=[],o=[];let l=0,c=0;const d=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let p;for(let _=1;_<i.length;_++){let m=i[_],E=m.charAt(0);for(m=m.slice(1),o.length=0;p=d.exec(m);)o.push(p[0]);const S=[];for(let k=0,N=o.length;k<N;k++){if(o[k]==="00"){S.push(0,0);continue}const x=parseFloat(o[k]);isNaN(x)?S.push(0):S.push(x)}for(;S.length>0&&!isNaN(S[0]);){let k="",N=[];const x=l,R=c;let w,P,F,U,D,C,b,A,M,B;switch(E){case"l":l+=S.shift(),c+=S.shift(),k="L",N.push(l,c);break;case"L":l=S.shift(),c=S.shift(),N.push(l,c);break;case"m":const V=S.shift(),fe=S.shift();if(l+=V,c+=fe,k="M",s.length>2&&s[s.length-1].command==="z"){for(let se=s.length-2;se>=0;se--)if(s[se].command==="M"){l=s[se].points[0]+V,c=s[se].points[1]+fe;break}}N.push(l,c),E="l";break;case"M":l=S.shift(),c=S.shift(),k="M",N.push(l,c),E="L";break;case"h":l+=S.shift(),k="L",N.push(l,c);break;case"H":l=S.shift(),k="L",N.push(l,c);break;case"v":c+=S.shift(),k="L",N.push(l,c);break;case"V":c=S.shift(),k="L",N.push(l,c);break;case"C":N.push(S.shift(),S.shift(),S.shift(),S.shift()),l=S.shift(),c=S.shift(),N.push(l,c);break;case"c":N.push(l+S.shift(),c+S.shift(),l+S.shift(),c+S.shift()),l+=S.shift(),c+=S.shift(),k="C",N.push(l,c);break;case"S":P=l,F=c,w=s[s.length-1],w.command==="C"&&(P=l+(l-w.points[2]),F=c+(c-w.points[3])),N.push(P,F,S.shift(),S.shift()),l=S.shift(),c=S.shift(),k="C",N.push(l,c);break;case"s":P=l,F=c,w=s[s.length-1],w.command==="C"&&(P=l+(l-w.points[2]),F=c+(c-w.points[3])),N.push(P,F,l+S.shift(),c+S.shift()),l+=S.shift(),c+=S.shift(),k="C",N.push(l,c);break;case"Q":N.push(S.shift(),S.shift()),l=S.shift(),c=S.shift(),N.push(l,c);break;case"q":N.push(l+S.shift(),c+S.shift()),l+=S.shift(),c+=S.shift(),k="Q",N.push(l,c);break;case"T":P=l,F=c,w=s[s.length-1],w.command==="Q"&&(P=l+(l-w.points[0]),F=c+(c-w.points[1])),l=S.shift(),c=S.shift(),k="Q",N.push(P,F,l,c);break;case"t":P=l,F=c,w=s[s.length-1],w.command==="Q"&&(P=l+(l-w.points[0]),F=c+(c-w.points[1])),l+=S.shift(),c+=S.shift(),k="Q",N.push(P,F,l,c);break;case"A":U=S.shift(),D=S.shift(),C=S.shift(),b=S.shift(),A=S.shift(),M=l,B=c,l=S.shift(),c=S.shift(),k="A",N=this.convertEndpointToCenterParameterization(M,B,l,c,b,A,U,D,C);break;case"a":U=S.shift(),D=S.shift(),C=S.shift(),b=S.shift(),A=S.shift(),M=l,B=c,l+=S.shift(),c+=S.shift(),k="A",N=this.convertEndpointToCenterParameterization(M,B,l,c,b,A,U,D,C);break}s.push({command:k||E,points:N,start:{x,y:R},pathLength:this.calcLength(x,R,k||E,N)})}(E==="z"||E==="Z")&&s.push({command:"z",points:[],start:void 0,pathLength:0})}return s}static calcLength(e,t,r,i){let s,o,l,c;const d=on;switch(r){case"L":return d.getLineLength(e,t,i[0],i[1]);case"C":return(0,ou.getCubicArcLength)([e,i[0],i[2],i[4]],[t,i[1],i[3],i[5]],1);case"Q":return(0,ou.getQuadraticArcLength)([e,i[0],i[2]],[t,i[1],i[3]],1);case"A":s=0;const p=i[4],_=i[5],m=i[4]+_;let E=Math.PI/180;if(Math.abs(p-m)<E&&(E=Math.abs(p-m)),o=d.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],p,0),_<0)for(c=p-E;c>m;c-=E)l=d.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],c,0),s+=d.getLineLength(o.x,o.y,l.x,l.y),o=l;else for(c=p+E;c<m;c+=E)l=d.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],c,0),s+=d.getLineLength(o.x,o.y,l.x,l.y),o=l;return l=d.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],m,0),s+=d.getLineLength(o.x,o.y,l.x,l.y),s}return 0}static convertEndpointToCenterParameterization(e,t,r,i,s,o,l,c,d){const p=d*(Math.PI/180),_=Math.cos(p)*(e-r)/2+Math.sin(p)*(t-i)/2,m=-1*Math.sin(p)*(e-r)/2+Math.cos(p)*(t-i)/2,E=_*_/(l*l)+m*m/(c*c);E>1&&(l*=Math.sqrt(E),c*=Math.sqrt(E));let S=Math.sqrt((l*l*(c*c)-l*l*(m*m)-c*c*(_*_))/(l*l*(m*m)+c*c*(_*_)));s===o&&(S*=-1),isNaN(S)&&(S=0);const k=S*l*m/c,N=S*-c*_/l,x=(e+r)/2+Math.cos(p)*k-Math.sin(p)*N,R=(t+i)/2+Math.sin(p)*k+Math.cos(p)*N,w=function(A){return Math.sqrt(A[0]*A[0]+A[1]*A[1])},P=function(A,M){return(A[0]*M[0]+A[1]*M[1])/(w(A)*w(M))},F=function(A,M){return(A[0]*M[1]<A[1]*M[0]?-1:1)*Math.acos(P(A,M))},U=F([1,0],[(_-k)/l,(m-N)/c]),D=[(_-k)/l,(m-N)/c],C=[(-1*_-k)/l,(-1*m-N)/c];let b=F(D,C);return P(D,C)<=-1&&(b=Math.PI),P(D,C)>=1&&(b=0),o===0&&b>0&&(b=b-2*Math.PI),o===1&&b<0&&(b=b+2*Math.PI),[x,R,l,c,U,b,p,o]}}Pc.Path=on;on.prototype.className="Path";on.prototype._attrsAffectingSize=["data"];(0,cj._registerNode)(on);uj.Factory.addGetterSetter(on,"data");Object.defineProperty($0,"__esModule",{value:!0});$0.Arrow=void 0;const K0=Ue,dj=wf,ix=Pe,fj=Oe,a5=Pc;class kl extends dj.Line{_sceneFunc(e){super._sceneFunc(e);const t=Math.PI*2,r=this.points();let i=r;const s=this.tension()!==0&&r.length>4;s&&(i=this.getTensionPoints());const o=this.pointerLength(),l=r.length;let c,d;if(s){const m=[i[i.length-4],i[i.length-3],i[i.length-2],i[i.length-1],r[l-2],r[l-1]],E=a5.Path.calcLength(i[i.length-4],i[i.length-3],"C",m),S=a5.Path.getPointOnQuadraticBezier(Math.min(1,1-o/E),m[0],m[1],m[2],m[3],m[4],m[5]);c=r[l-2]-S.x,d=r[l-1]-S.y}else c=r[l-2]-r[l-4],d=r[l-1]-r[l-3];const p=(Math.atan2(d,c)+t)%t,_=this.pointerWidth();this.pointerAtEnding()&&(e.save(),e.beginPath(),e.translate(r[l-2],r[l-1]),e.rotate(p),e.moveTo(0,0),e.lineTo(-o,_/2),e.lineTo(-o,-_/2),e.closePath(),e.restore(),this.__fillStroke(e)),this.pointerAtBeginning()&&(e.save(),e.beginPath(),e.translate(r[0],r[1]),s?(c=(i[0]+i[2])/2-r[0],d=(i[1]+i[3])/2-r[1]):(c=r[2]-r[0],d=r[3]-r[1]),e.rotate((Math.atan2(-d,-c)+t)%t),e.moveTo(0,0),e.lineTo(-o,_/2),e.lineTo(-o,-_/2),e.closePath(),e.restore(),this.__fillStroke(e))}__fillStroke(e){const t=this.dashEnabled();t&&(this.attrs.dashEnabled=!1,e.setLineDash([])),e.fillStrokeShape(this),t&&(this.attrs.dashEnabled=!0)}getSelfRect(){const e=super.getSelfRect(),t=this.pointerWidth()/2;return{x:e.x,y:e.y-t,width:e.width,height:e.height+t*2}}}$0.Arrow=kl;kl.prototype.className="Arrow";(0,fj._registerNode)(kl);K0.Factory.addGetterSetter(kl,"pointerLength",10,(0,ix.getNumberValidator)());K0.Factory.addGetterSetter(kl,"pointerWidth",10,(0,ix.getNumberValidator)());K0.Factory.addGetterSetter(kl,"pointerAtBeginning",!1);K0.Factory.addGetterSetter(kl,"pointerAtEnding",!0);var Q0={};Object.defineProperty(Q0,"__esModule",{value:!0});Q0.Circle=void 0;const pj=Ue,gj=cn,mj=Pe,_j=Oe;let kc=class extends gj.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius()!==e/2&&this.radius(e/2)}setHeight(e){this.radius()!==e/2&&this.radius(e/2)}};Q0.Circle=kc;kc.prototype._centroid=!0;kc.prototype.className="Circle";kc.prototype._attrsAffectingSize=["radius"];(0,_j._registerNode)(kc);pj.Factory.addGetterSetter(kc,"radius",0,(0,mj.getNumberValidator)());var Y0={};Object.defineProperty(Y0,"__esModule",{value:!0});Y0.Ellipse=void 0;const dS=Ue,yj=cn,sx=Pe,vj=Oe;class _a extends yj.Shape{_sceneFunc(e){const t=this.radiusX(),r=this.radiusY();e.beginPath(),e.save(),t!==r&&e.scale(1,r/t),e.arc(0,0,t,0,Math.PI*2,!1),e.restore(),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(e){this.radiusX(e/2)}setHeight(e){this.radiusY(e/2)}}Y0.Ellipse=_a;_a.prototype.className="Ellipse";_a.prototype._centroid=!0;_a.prototype._attrsAffectingSize=["radiusX","radiusY"];(0,vj._registerNode)(_a);dS.Factory.addComponentsGetterSetter(_a,"radius",["x","y"]);dS.Factory.addGetterSetter(_a,"radiusX",0,(0,sx.getNumberValidator)());dS.Factory.addGetterSetter(_a,"radiusY",0,(0,sx.getNumberValidator)());var X0={};Object.defineProperty(X0,"__esModule",{value:!0});X0.Image=void 0;const kv=Lt,Rl=Ue,wj=cn,Ej=Oe,Ef=Pe;let os=class ox extends wj.Shape{constructor(e){super(e),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",t=>{this._removeImageLoad(t.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const e=this.image();e&&e.complete||e&&e.readyState===4||e&&e.addEventListener&&e.addEventListener("load",this._loadListener)}_removeImageLoad(e){e&&e.removeEventListener&&e.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const e=!!this.cornerRadius(),t=this.hasShadow();return e&&t?!0:super._useBufferCanvas(!0)}_sceneFunc(e){const t=this.getWidth(),r=this.getHeight(),i=this.cornerRadius(),s=this.attrs.image;let o;if(s){const l=this.attrs.cropWidth,c=this.attrs.cropHeight;l&&c?o=[s,this.cropX(),this.cropY(),l,c,0,0,t,r]:o=[s,0,0,t,r]}(this.hasFill()||this.hasStroke()||i)&&(e.beginPath(),i?kv.Util.drawRoundedRectPath(e,t,r,i):e.rect(0,0,t,r),e.closePath(),e.fillStrokeShape(this)),s&&(i&&e.clip(),e.drawImage.apply(e,o))}_hitFunc(e){const t=this.width(),r=this.height(),i=this.cornerRadius();e.beginPath(),i?kv.Util.drawRoundedRectPath(e,t,r,i):e.rect(0,0,t,r),e.closePath(),e.fillStrokeShape(this)}getWidth(){var e,t;return(e=this.attrs.width)!==null&&e!==void 0?e:(t=this.image())===null||t===void 0?void 0:t.width}getHeight(){var e,t;return(e=this.attrs.height)!==null&&e!==void 0?e:(t=this.image())===null||t===void 0?void 0:t.height}static fromURL(e,t,r=null){const i=kv.Util.createImageElement();i.onload=function(){const s=new ox({image:i});t(s)},i.onerror=r,i.crossOrigin="Anonymous",i.src=e}};X0.Image=os;os.prototype.className="Image";(0,Ej._registerNode)(os);Rl.Factory.addGetterSetter(os,"cornerRadius",0,(0,Ef.getNumberOrArrayOfNumbersValidator)(4));Rl.Factory.addGetterSetter(os,"image");Rl.Factory.addComponentsGetterSetter(os,"crop",["x","y","width","height"]);Rl.Factory.addGetterSetter(os,"cropX",0,(0,Ef.getNumberValidator)());Rl.Factory.addGetterSetter(os,"cropY",0,(0,Ef.getNumberValidator)());Rl.Factory.addGetterSetter(os,"cropWidth",0,(0,Ef.getNumberValidator)());Rl.Factory.addGetterSetter(os,"cropHeight",0,(0,Ef.getNumberValidator)());var sc={};Object.defineProperty(sc,"__esModule",{value:!0});sc.Tag=sc.Label=void 0;const J0=Ue,Sj=cn,Tj=Cc,fS=Pe,ax=Oe,lx=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],Cj="Change.konva",Ij="none",T2="up",C2="right",I2="down",P2="left",Pj=lx.length;class pS extends Tj.Group{constructor(e){super(e),this.on("add.konva",function(t){this._addListeners(t.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(e){let t=this,r;const i=function(){t._sync()};for(r=0;r<Pj;r++)e.on(lx[r]+Cj,i)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let e=this.getText(),t=this.getTag(),r,i,s,o,l,c,d;if(e&&t){switch(r=e.width(),i=e.height(),s=t.pointerDirection(),o=t.pointerWidth(),d=t.pointerHeight(),l=0,c=0,s){case T2:l=r/2,c=-1*d;break;case C2:l=r+o,c=i/2;break;case I2:l=r/2,c=i+d;break;case P2:l=-1*o,c=i/2;break}t.setAttrs({x:-1*l,y:-1*c,width:r,height:i}),e.setAttrs({x:-1*l,y:-1*c})}}}sc.Label=pS;pS.prototype.className="Label";(0,ax._registerNode)(pS);class xl extends Sj.Shape{_sceneFunc(e){const t=this.width(),r=this.height(),i=this.pointerDirection(),s=this.pointerWidth(),o=this.pointerHeight(),l=this.cornerRadius();let c=0,d=0,p=0,_=0;typeof l=="number"?c=d=p=_=Math.min(l,t/2,r/2):(c=Math.min(l[0]||0,t/2,r/2),d=Math.min(l[1]||0,t/2,r/2),_=Math.min(l[2]||0,t/2,r/2),p=Math.min(l[3]||0,t/2,r/2)),e.beginPath(),e.moveTo(c,0),i===T2&&(e.lineTo((t-s)/2,0),e.lineTo(t/2,-1*o),e.lineTo((t+s)/2,0)),e.lineTo(t-d,0),e.arc(t-d,d,d,Math.PI*3/2,0,!1),i===C2&&(e.lineTo(t,(r-o)/2),e.lineTo(t+s,r/2),e.lineTo(t,(r+o)/2)),e.lineTo(t,r-_),e.arc(t-_,r-_,_,0,Math.PI/2,!1),i===I2&&(e.lineTo((t+s)/2,r),e.lineTo(t/2,r+o),e.lineTo((t-s)/2,r)),e.lineTo(p,r),e.arc(p,r-p,p,Math.PI/2,Math.PI,!1),i===P2&&(e.lineTo(0,(r+o)/2),e.lineTo(-1*s,r/2),e.lineTo(0,(r-o)/2)),e.lineTo(0,c),e.arc(c,c,c,Math.PI,Math.PI*3/2,!1),e.closePath(),e.fillStrokeShape(this)}getSelfRect(){let e=0,t=0,r=this.pointerWidth(),i=this.pointerHeight(),s=this.pointerDirection(),o=this.width(),l=this.height();return s===T2?(t-=i,l+=i):s===I2?l+=i:s===P2?(e-=r*1.5,o+=r):s===C2&&(o+=r*1.5),{x:e,y:t,width:o,height:l}}}sc.Tag=xl;xl.prototype.className="Tag";(0,ax._registerNode)(xl);J0.Factory.addGetterSetter(xl,"pointerDirection",Ij);J0.Factory.addGetterSetter(xl,"pointerWidth",0,(0,fS.getNumberValidator)());J0.Factory.addGetterSetter(xl,"pointerHeight",0,(0,fS.getNumberValidator)());J0.Factory.addGetterSetter(xl,"cornerRadius",0,(0,fS.getNumberOrArrayOfNumbersValidator)(4));var Sf={};Object.defineProperty(Sf,"__esModule",{value:!0});Sf.Rect=void 0;const kj=Ue,Rj=cn,xj=Oe,Aj=Lt,Nj=Pe;let Z0=class extends Rj.Shape{_sceneFunc(e){const t=this.cornerRadius(),r=this.width(),i=this.height();e.beginPath(),t?Aj.Util.drawRoundedRectPath(e,r,i,t):e.rect(0,0,r,i),e.closePath(),e.fillStrokeShape(this)}};Sf.Rect=Z0;Z0.prototype.className="Rect";(0,xj._registerNode)(Z0);kj.Factory.addGetterSetter(Z0,"cornerRadius",0,(0,Nj.getNumberOrArrayOfNumbersValidator)(4));var e_={};Object.defineProperty(e_,"__esModule",{value:!0});e_.RegularPolygon=void 0;const ux=Ue,Dj=cn,cx=Pe,bj=Oe;class Al extends Dj.Shape{_sceneFunc(e){const t=this._getPoints();e.beginPath(),e.moveTo(t[0].x,t[0].y);for(let r=1;r<t.length;r++)e.lineTo(t[r].x,t[r].y);e.closePath(),e.fillStrokeShape(this)}_getPoints(){const e=this.attrs.sides,t=this.attrs.radius||0,r=[];for(let i=0;i<e;i++)r.push({x:t*Math.sin(i*2*Math.PI/e),y:-1*t*Math.cos(i*2*Math.PI/e)});return r}getSelfRect(){const e=this._getPoints();let t=e[0].x,r=e[0].y,i=e[0].x,s=e[0].y;return e.forEach(o=>{t=Math.min(t,o.x),r=Math.max(r,o.x),i=Math.min(i,o.y),s=Math.max(s,o.y)}),{x:t,y:i,width:r-t,height:s-i}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}e_.RegularPolygon=Al;Al.prototype.className="RegularPolygon";Al.prototype._centroid=!0;Al.prototype._attrsAffectingSize=["radius"];(0,bj._registerNode)(Al);ux.Factory.addGetterSetter(Al,"radius",0,(0,cx.getNumberValidator)());ux.Factory.addGetterSetter(Al,"sides",0,(0,cx.getNumberValidator)());var t_={};Object.defineProperty(t_,"__esModule",{value:!0});t_.Ring=void 0;const hx=Ue,Oj=cn,dx=Pe,Mj=Oe,l5=Math.PI*2;class Nl extends Oj.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.innerRadius(),0,l5,!1),e.moveTo(this.outerRadius(),0),e.arc(0,0,this.outerRadius(),l5,0,!0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}t_.Ring=Nl;Nl.prototype.className="Ring";Nl.prototype._centroid=!0;Nl.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,Mj._registerNode)(Nl);hx.Factory.addGetterSetter(Nl,"innerRadius",0,(0,dx.getNumberValidator)());hx.Factory.addGetterSetter(Nl,"outerRadius",0,(0,dx.getNumberValidator)());var n_={};Object.defineProperty(n_,"__esModule",{value:!0});n_.Sprite=void 0;const Dl=Ue,Lj=cn,Fj=Ic,fx=Pe,Vj=Oe;class as extends Lj.Shape{constructor(e){super(e),this._updated=!0,this.anim=new Fj.Animation(()=>{const t=this._updated;return this._updated=!1,t}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(e){const t=this.animation(),r=this.frameIndex(),i=r*4,s=this.animations()[t],o=this.frameOffsets(),l=s[i+0],c=s[i+1],d=s[i+2],p=s[i+3],_=this.image();if((this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,d,p),e.closePath(),e.fillStrokeShape(this)),_)if(o){const m=o[t],E=r*2;e.drawImage(_,l,c,d,p,m[E+0],m[E+1],d,p)}else e.drawImage(_,l,c,d,p,0,0,d,p)}_hitFunc(e){const t=this.animation(),r=this.frameIndex(),i=r*4,s=this.animations()[t],o=this.frameOffsets(),l=s[i+2],c=s[i+3];if(e.beginPath(),o){const d=o[t],p=r*2;e.rect(d[p+0],d[p+1],l,c)}else e.rect(0,0,l,c);e.closePath(),e.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const e=this;this.interval=setInterval(function(){e._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const e=this.getLayer();this.anim.setLayers(e),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const e=this.frameIndex(),t=this.animation(),r=this.animations(),i=r[t],s=i.length/4;e<s-1?this.frameIndex(e+1):this.frameIndex(0)}}n_.Sprite=as;as.prototype.className="Sprite";(0,Vj._registerNode)(as);Dl.Factory.addGetterSetter(as,"animation");Dl.Factory.addGetterSetter(as,"animations");Dl.Factory.addGetterSetter(as,"frameOffsets");Dl.Factory.addGetterSetter(as,"image");Dl.Factory.addGetterSetter(as,"frameIndex",0,(0,fx.getNumberValidator)());Dl.Factory.addGetterSetter(as,"frameRate",17,(0,fx.getNumberValidator)());Dl.Factory.backCompat(as,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var r_={};Object.defineProperty(r_,"__esModule",{value:!0});r_.Star=void 0;const gS=Ue,Uj=cn,mS=Pe,Bj=Oe;class ya extends Uj.Shape{_sceneFunc(e){const t=this.innerRadius(),r=this.outerRadius(),i=this.numPoints();e.beginPath(),e.moveTo(0,0-r);for(let s=1;s<i*2;s++){const o=s%2===0?r:t,l=o*Math.sin(s*Math.PI/i),c=-1*o*Math.cos(s*Math.PI/i);e.lineTo(l,c)}e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}r_.Star=ya;ya.prototype.className="Star";ya.prototype._centroid=!0;ya.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,Bj._registerNode)(ya);gS.Factory.addGetterSetter(ya,"numPoints",5,(0,mS.getNumberValidator)());gS.Factory.addGetterSetter(ya,"innerRadius",0,(0,mS.getNumberValidator)());gS.Factory.addGetterSetter(ya,"outerRadius",0,(0,mS.getNumberValidator)());var Rc={};Object.defineProperty(Rc,"__esModule",{value:!0});Rc.Text=void 0;Rc.stringToArray=Wa;const k2=Lt,or=Ue,zj=cn,Rv=Oe,va=Pe,jj=Oe;function Wa(n){return[...n].reduce((e,t,r,i)=>{if(new RegExp("\\p{Emoji}","u").test(t)){const s=i[r+1];s&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(s)?(e.push(t+s),i[r+1]=""):e.push(t)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(t+(i[r+1]||""))?e.push(t+i[r+1]):r>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(t)?e[e.length-1]+=t:t&&e.push(t);return e},[])}const au="auto",Gj="center",px="inherit",Ch="justify",Wj="Change.konva",Hj="2d",u5="-",gx="left",$j="text",qj="Text",Kj="top",Qj="bottom",c5="middle",mx="normal",Yj="px ",Jp=" ",Xj="right",h5="rtl",Jj="word",Zj="char",d5="none",xv="…",_x=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],eG=_x.length;function tG(n){return n.split(",").map(e=>{e=e.trim();const t=e.indexOf(" ")>=0,r=e.indexOf('"')>=0||e.indexOf("'")>=0;return t&&!r&&(e=`"${e}"`),e}).join(", ")}let Zp;function Av(){return Zp||(Zp=k2.Util.createCanvasElement().getContext(Hj),Zp)}function nG(n){n.fillText(this._partialText,this._partialTextX,this._partialTextY)}function rG(n){n.setAttr("miterLimit",2),n.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function iG(n){return n=n||{},!n.fillLinearGradientColorStops&&!n.fillRadialGradientColorStops&&!n.fillPatternImage&&(n.fill=n.fill||"black"),n}let Ut=class extends zj.Shape{constructor(e){super(iG(e)),this._partialTextX=0,this._partialTextY=0;for(let t=0;t<eG;t++)this.on(_x[t]+Wj,this._setTextData);this._setTextData()}_sceneFunc(e){const t=this.textArr,r=t.length;if(!this.text())return;let i=this.padding(),s=this.fontSize(),o=this.lineHeight()*s,l=this.verticalAlign(),c=this.direction(),d=0,p=this.align(),_=this.getWidth(),m=this.letterSpacing(),E=this.fill(),S=this.textDecoration(),k=S.indexOf("underline")!==-1,N=S.indexOf("line-through")!==-1,x;c=c===px?e.direction:c;let R=o/2,w=c5;if(Rv.Konva._fixTextRendering){const P=this.measureSize("M");w="alphabetic",R=(P.fontBoundingBoxAscent-P.fontBoundingBoxDescent)/2+o/2}for(c===h5&&e.setAttr("direction",c),e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",w),e.setAttr("textAlign",gx),l===c5?d=(this.getHeight()-r*o-i*2)/2:l===Qj&&(d=this.getHeight()-r*o-i*2),e.translate(i,d+i),x=0;x<r;x++){let P=0,F=0;const U=t[x],D=U.text,C=U.width,b=U.lastInParagraph;if(e.save(),p===Xj?P+=_-C-i*2:p===Gj&&(P+=(_-C-i*2)/2),k){e.save(),e.beginPath();const A=Rv.Konva._fixTextRendering?Math.round(s/4):Math.round(s/2),M=P,B=R+F+A;e.moveTo(M,B);const V=p===Ch&&!b?_-i*2:C;e.lineTo(M+Math.round(V),B),e.lineWidth=s/15;const fe=this._getLinearGradient();e.strokeStyle=fe||E,e.stroke(),e.restore()}if(N){e.save(),e.beginPath();const A=Rv.Konva._fixTextRendering?-Math.round(s/4):0;e.moveTo(P,R+F+A);const M=p===Ch&&!b?_-i*2:C;e.lineTo(P+Math.round(M),R+F+A),e.lineWidth=s/15;const B=this._getLinearGradient();e.strokeStyle=B||E,e.stroke(),e.restore()}if(c!==h5&&(m!==0||p===Ch)){const A=D.split(" ").length-1,M=Wa(D);for(let B=0;B<M.length;B++){const V=M[B];V===" "&&!b&&p===Ch&&(P+=(_-i*2-C)/A),this._partialTextX=P,this._partialTextY=R+F,this._partialText=V,e.fillStrokeShape(this),P+=this.measureSize(V).width+m}}else m!==0&&e.setAttr("letterSpacing",`${m}px`),this._partialTextX=P,this._partialTextY=R+F,this._partialText=D,e.fillStrokeShape(this);e.restore(),r>1&&(R+=o)}}_hitFunc(e){const t=this.getWidth(),r=this.getHeight();e.beginPath(),e.rect(0,0,t,r),e.closePath(),e.fillStrokeShape(this)}setText(e){const t=k2.Util._isString(e)?e:e==null?"":e+"";return this._setAttr($j,t),this}getWidth(){return this.attrs.width===au||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===au||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return k2.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(e){var t,r,i,s,o,l,c,d,p,_,m;let E=Av(),S=this.fontSize(),k;E.save(),E.font=this._getContextFont(),k=E.measureText(e),E.restore();const N=S/100;return{actualBoundingBoxAscent:(t=k.actualBoundingBoxAscent)!==null&&t!==void 0?t:71.58203125*N,actualBoundingBoxDescent:(r=k.actualBoundingBoxDescent)!==null&&r!==void 0?r:0,actualBoundingBoxLeft:(i=k.actualBoundingBoxLeft)!==null&&i!==void 0?i:-7.421875*N,actualBoundingBoxRight:(s=k.actualBoundingBoxRight)!==null&&s!==void 0?s:75.732421875*N,alphabeticBaseline:(o=k.alphabeticBaseline)!==null&&o!==void 0?o:0,emHeightAscent:(l=k.emHeightAscent)!==null&&l!==void 0?l:100*N,emHeightDescent:(c=k.emHeightDescent)!==null&&c!==void 0?c:-20*N,fontBoundingBoxAscent:(d=k.fontBoundingBoxAscent)!==null&&d!==void 0?d:91*N,fontBoundingBoxDescent:(p=k.fontBoundingBoxDescent)!==null&&p!==void 0?p:21*N,hangingBaseline:(_=k.hangingBaseline)!==null&&_!==void 0?_:72.80000305175781*N,ideographicBaseline:(m=k.ideographicBaseline)!==null&&m!==void 0?m:-21*N,width:k.width,height:S}}_getContextFont(){return this.fontStyle()+Jp+this.fontVariant()+Jp+(this.fontSize()+Yj)+tG(this.fontFamily())}_addTextLine(e){this.align()===Ch&&(e=e.trim());const r=this._getTextWidth(e);return this.textArr.push({text:e,width:r,lastInParagraph:!1})}_getTextWidth(e){const t=this.letterSpacing(),r=e.length;return Av().measureText(e).width+t*r}_setTextData(){let e=this.text().split(`
`),t=+this.fontSize(),r=0,i=this.lineHeight()*t,s=this.attrs.width,o=this.attrs.height,l=s!==au&&s!==void 0,c=o!==au&&o!==void 0,d=this.padding(),p=s-d*2,_=o-d*2,m=0,E=this.wrap(),S=E!==d5,k=E!==Zj&&S,N=this.ellipsis();this.textArr=[],Av().font=this._getContextFont();const x=N?this._getTextWidth(xv):0;for(let R=0,w=e.length;R<w;++R){let P=e[R],F=this._getTextWidth(P);if(l&&F>p)for(;P.length>0;){let U=0,D=Wa(P).length,C="",b=0;for(;U<D;){const A=U+D>>>1,M=Wa(P),B=M.slice(0,A+1).join(""),V=this._getTextWidth(B);(N&&c&&m+i>_?V+x:V)<=p?(U=A+1,C=B,b=V):D=A}if(C){if(k){const B=Wa(P),V=Wa(C),fe=B[V.length],se=fe===Jp||fe===u5;let Be;if(se&&b<=p)Be=V.length;else{const De=V.lastIndexOf(Jp),Y=V.lastIndexOf(u5);Be=Math.max(De,Y)+1}Be>0&&(U=Be,C=B.slice(0,U).join(""),b=this._getTextWidth(C))}if(C=C.trimRight(),this._addTextLine(C),r=Math.max(r,b),m+=i,this._shouldHandleEllipsis(m)){this._tryToAddEllipsisToLastLine();break}if(P=Wa(P).slice(U).join("").trimLeft(),P.length>0&&(F=this._getTextWidth(P),F<=p)){this._addTextLine(P),m+=i,r=Math.max(r,F);break}}else break}else this._addTextLine(P),m+=i,r=Math.max(r,F),this._shouldHandleEllipsis(m)&&R<w-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),c&&m+i>_)break}this.textHeight=t,this.textWidth=r}_shouldHandleEllipsis(e){const t=+this.fontSize(),r=this.lineHeight()*t,i=this.attrs.height,s=i!==au&&i!==void 0,o=this.padding(),l=i-o*2;return!(this.wrap()!==d5)||s&&e+r>l}_tryToAddEllipsisToLastLine(){const e=this.attrs.width,t=e!==au&&e!==void 0,r=this.padding(),i=e-r*2,s=this.ellipsis(),o=this.textArr[this.textArr.length-1];!o||!s||(t&&(this._getTextWidth(o.text+xv)<i||(o.text=o.text.slice(0,o.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(o.text+xv))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const e=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,t=this.hasShadow();return e&&t?!0:super._useBufferCanvas()}};Rc.Text=Ut;Ut.prototype._fillFunc=nG;Ut.prototype._strokeFunc=rG;Ut.prototype.className=qj;Ut.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];(0,jj._registerNode)(Ut);or.Factory.overWriteSetter(Ut,"width",(0,va.getNumberOrAutoValidator)());or.Factory.overWriteSetter(Ut,"height",(0,va.getNumberOrAutoValidator)());or.Factory.addGetterSetter(Ut,"direction",px);or.Factory.addGetterSetter(Ut,"fontFamily","Arial");or.Factory.addGetterSetter(Ut,"fontSize",12,(0,va.getNumberValidator)());or.Factory.addGetterSetter(Ut,"fontStyle",mx);or.Factory.addGetterSetter(Ut,"fontVariant",mx);or.Factory.addGetterSetter(Ut,"padding",0,(0,va.getNumberValidator)());or.Factory.addGetterSetter(Ut,"align",gx);or.Factory.addGetterSetter(Ut,"verticalAlign",Kj);or.Factory.addGetterSetter(Ut,"lineHeight",1,(0,va.getNumberValidator)());or.Factory.addGetterSetter(Ut,"wrap",Jj);or.Factory.addGetterSetter(Ut,"ellipsis",!1,(0,va.getBooleanValidator)());or.Factory.addGetterSetter(Ut,"letterSpacing",0,(0,va.getNumberValidator)());or.Factory.addGetterSetter(Ut,"text","",(0,va.getStringValidator)());or.Factory.addGetterSetter(Ut,"textDecoration","");var i_={};Object.defineProperty(i_,"__esModule",{value:!0});i_.TextPath=void 0;const Nv=Lt,bi=Ue,sG=cn,Ih=Pc,Dv=Rc,yx=Pe,oG=Oe,aG="",vx="normal";function wx(n){n.fillText(this.partialText,0,0)}function Ex(n){n.strokeText(this.partialText,0,0)}class hn extends sG.Shape{constructor(e){super(e),this.dummyCanvas=Nv.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return Ih.Path.getPathLength(this.dataArray)}_getPointAtLength(e){if(!this.attrs.data)return null;const t=this.pathLength;return e-1>t?null:Ih.Path.getPointAtLengthOfDataArray(e,this.dataArray)}_readDataAttribute(){this.dataArray=Ih.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(e){e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",this.textBaseline()),e.setAttr("textAlign","left"),e.save();const t=this.textDecoration(),r=this.fill(),i=this.fontSize(),s=this.glyphInfo;t==="underline"&&e.beginPath();for(let o=0;o<s.length;o++){e.save();const l=s[o].p0;e.translate(l.x,l.y),e.rotate(s[o].rotation),this.partialText=s[o].text,e.fillStrokeShape(this),t==="underline"&&(o===0&&e.moveTo(0,i/2+1),e.lineTo(i,i/2+1)),e.restore()}t==="underline"&&(e.strokeStyle=r,e.lineWidth=i/20,e.stroke()),e.restore()}_hitFunc(e){e.beginPath();const t=this.glyphInfo;if(t.length>=1){const r=t[0].p0;e.moveTo(r.x,r.y)}for(let r=0;r<t.length;r++){const i=t[r].p1;e.lineTo(i.x,i.y)}e.setAttr("lineWidth",this.fontSize()),e.setAttr("strokeStyle",this.colorKey),e.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return Nv.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(e){return Dv.Text.prototype.setText.call(this,e)}_getContextFont(){return Dv.Text.prototype._getContextFont.call(this)}_getTextSize(e){const r=this.dummyCanvas.getContext("2d");r.save(),r.font=this._getContextFont();const i=r.measureText(e);return r.restore(),{width:i.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:e,height:t}=this._getTextSize(this.attrs.text);if(this.textWidth=e,this.textHeight=t,this.glyphInfo=[],!this.attrs.data)return null;const r=this.letterSpacing(),i=this.align(),s=this.kerningFunc(),o=Math.max(this.textWidth+((this.attrs.text||"").length-1)*r,0);let l=0;i==="center"&&(l=Math.max(0,this.pathLength/2-o/2)),i==="right"&&(l=Math.max(0,this.pathLength-o));const c=(0,Dv.stringToArray)(this.text());let d=l;for(let p=0;p<c.length;p++){const _=this._getPointAtLength(d);if(!_)return;let m=this._getTextSize(c[p]).width+r;if(c[p]===" "&&i==="justify"){const R=this.text().split(" ").length-1;m+=(this.pathLength-o)/R}const E=this._getPointAtLength(d+m);if(!E)return;const S=Ih.Path.getLineLength(_.x,_.y,E.x,E.y);let k=0;if(s)try{k=s(c[p-1],c[p])*this.fontSize()}catch{k=0}_.x+=k,E.x+=k,this.textWidth+=k;const N=Ih.Path.getPointOnLine(k+S/2,_.x,_.y,E.x,E.y),x=Math.atan2(E.y-_.y,E.x-_.x);this.glyphInfo.push({transposeX:N.x,transposeY:N.y,text:c[p],rotation:x,p0:_,p1:E}),d+=m}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const e=[];this.glyphInfo.forEach(function(d){e.push(d.p0.x),e.push(d.p0.y),e.push(d.p1.x),e.push(d.p1.y)});let t=e[0]||0,r=e[0]||0,i=e[1]||0,s=e[1]||0,o,l;for(let d=0;d<e.length/2;d++)o=e[d*2],l=e[d*2+1],t=Math.min(t,o),r=Math.max(r,o),i=Math.min(i,l),s=Math.max(s,l);const c=this.fontSize();return{x:t-c/2,y:i-c/2,width:r-t+c,height:s-i+c}}destroy(){return Nv.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}i_.TextPath=hn;hn.prototype._fillFunc=wx;hn.prototype._strokeFunc=Ex;hn.prototype._fillFuncHit=wx;hn.prototype._strokeFuncHit=Ex;hn.prototype.className="TextPath";hn.prototype._attrsAffectingSize=["text","fontSize","data"];(0,oG._registerNode)(hn);bi.Factory.addGetterSetter(hn,"data");bi.Factory.addGetterSetter(hn,"fontFamily","Arial");bi.Factory.addGetterSetter(hn,"fontSize",12,(0,yx.getNumberValidator)());bi.Factory.addGetterSetter(hn,"fontStyle",vx);bi.Factory.addGetterSetter(hn,"align","left");bi.Factory.addGetterSetter(hn,"letterSpacing",0,(0,yx.getNumberValidator)());bi.Factory.addGetterSetter(hn,"textBaseline","middle");bi.Factory.addGetterSetter(hn,"fontVariant",vx);bi.Factory.addGetterSetter(hn,"text",aG);bi.Factory.addGetterSetter(hn,"textDecoration","");bi.Factory.addGetterSetter(hn,"kerningFunc",void 0);var s_={};Object.defineProperty(s_,"__esModule",{value:!0});s_.Transformer=void 0;const ft=Lt,st=Ue,f5=Rt,lG=cn,uG=Sf,p5=Cc,vi=Oe,wa=Pe,cG=Oe,Sx="tr-konva",hG=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(n=>n+`.${Sx}`).join(" "),g5="nodesRect",dG=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],fG={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},pG="ontouchstart"in vi.Konva._global;function gG(n,e,t){if(n==="rotater")return t;e+=ft.Util.degToRad(fG[n]||0);const r=(ft.Util.radToDeg(e)%360+360)%360;return ft.Util._inRange(r,315+22.5,360)||ft.Util._inRange(r,0,22.5)?"ns-resize":ft.Util._inRange(r,45-22.5,45+22.5)?"nesw-resize":ft.Util._inRange(r,90-22.5,90+22.5)?"ew-resize":ft.Util._inRange(r,135-22.5,135+22.5)?"nwse-resize":ft.Util._inRange(r,180-22.5,180+22.5)?"ns-resize":ft.Util._inRange(r,225-22.5,225+22.5)?"nesw-resize":ft.Util._inRange(r,270-22.5,270+22.5)?"ew-resize":ft.Util._inRange(r,315-22.5,315+22.5)?"nwse-resize":(ft.Util.error("Transformer has unknown angle for cursor detection: "+r),"pointer")}const bm=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function mG(n){return{x:n.x+n.width/2*Math.cos(n.rotation)+n.height/2*Math.sin(-n.rotation),y:n.y+n.height/2*Math.cos(n.rotation)+n.width/2*Math.sin(n.rotation)}}function Tx(n,e,t){const r=t.x+(n.x-t.x)*Math.cos(e)-(n.y-t.y)*Math.sin(e),i=t.y+(n.x-t.x)*Math.sin(e)+(n.y-t.y)*Math.cos(e);return{...n,rotation:n.rotation+e,x:r,y:i}}function _G(n,e){const t=mG(n);return Tx(n,e,t)}function yG(n,e,t){let r=e;for(let i=0;i<n.length;i++){const s=vi.Konva.getAngle(n[i]),o=Math.abs(s-e)%(Math.PI*2);Math.min(o,Math.PI*2-o)<t&&(r=s)}return r}let R2=0;class qe extends p5.Group{constructor(e){super(e),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(hG,this.update),this.getNode()&&this.update()}attachTo(e){return this.setNode(e),this}setNode(e){return ft.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([e])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return Sx+this._id}setNodes(e=[]){this._nodes&&this._nodes.length&&this.detach();const t=e.filter(i=>i.isAncestorOf(this)?(ft.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=e=t,e.length===1&&this.useSingleNodeRotation()?this.rotation(e[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(i=>{const s=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(i._attrsAffectingSize.length){const o=i._attrsAffectingSize.map(l=>l+"Change."+this._getEventNamespace()).join(" ");i.on(o,s)}i.on(dG.map(o=>o+`.${this._getEventNamespace()}`).join(" "),s),i.on(`absoluteTransformChange.${this._getEventNamespace()}`,s),this._proxyDrag(i)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(e){let t;e.on(`dragstart.${this._getEventNamespace()}`,r=>{t=e.getAbsolutePosition(),!this.isDragging()&&e!==this.findOne(".back")&&this.startDrag(r,!1)}),e.on(`dragmove.${this._getEventNamespace()}`,r=>{if(!t)return;const i=e.getAbsolutePosition(),s=i.x-t.x,o=i.y-t.y;this.nodes().forEach(l=>{if(l===e||l.isDragging())return;const c=l.getAbsolutePosition();l.setAbsolutePosition({x:c.x+s,y:c.y+o}),l.startDrag(r)}),t=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(e=>{e.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(g5),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(g5,this.__getNodeRect)}__getNodeShape(e,t=this.rotation(),r){const i=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),s=e.getAbsoluteScale(r),o=e.getAbsolutePosition(r),l=i.x*s.x-e.offsetX()*s.x,c=i.y*s.y-e.offsetY()*s.y,d=(vi.Konva.getAngle(e.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),p={x:o.x+l*Math.cos(d)+c*Math.sin(-d),y:o.y+c*Math.cos(d)+l*Math.sin(d),width:i.width*s.x,height:i.height*s.y,rotation:d};return Tx(p,-vi.Konva.getAngle(t),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const t=[];this.nodes().map(d=>{const p=d.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),_=[{x:p.x,y:p.y},{x:p.x+p.width,y:p.y},{x:p.x+p.width,y:p.y+p.height},{x:p.x,y:p.y+p.height}],m=d.getAbsoluteTransform();_.forEach(function(E){const S=m.point(E);t.push(S)})});const r=new ft.Transform;r.rotate(-vi.Konva.getAngle(this.rotation()));let i=1/0,s=1/0,o=-1/0,l=-1/0;t.forEach(function(d){const p=r.point(d);i===void 0&&(i=o=p.x,s=l=p.y),i=Math.min(i,p.x),s=Math.min(s,p.y),o=Math.max(o,p.x),l=Math.max(l,p.y)}),r.invert();const c=r.point({x:i,y:s});return{x:c.x,y:c.y,width:o-i,height:l-s,rotation:vi.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),bm.forEach(e=>{this._createAnchor(e)}),this._createAnchor("rotater")}_createAnchor(e){const t=new uG.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:e+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:pG?10:"auto"}),r=this;t.on("mousedown touchstart",function(i){r._handleMouseDown(i)}),t.on("dragstart",i=>{t.stopDrag(),i.cancelBubble=!0}),t.on("dragend",i=>{i.cancelBubble=!0}),t.on("mouseenter",()=>{const i=vi.Konva.getAngle(this.rotation()),s=this.rotateAnchorCursor(),o=gG(e,i,s);t.getStage().content&&(t.getStage().content.style.cursor=o),this._cursorChange=!0}),t.on("mouseout",()=>{t.getStage().content&&(t.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(t)}_createBack(){const e=new lG.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(t,r){const i=r.getParent(),s=i.padding();t.beginPath(),t.rect(-s,-s,r.width()+s*2,r.height()+s*2),t.moveTo(r.width()/2,-s),i.rotateEnabled()&&i.rotateLineVisible()&&t.lineTo(r.width()/2,-i.rotateAnchorOffset()*ft.Util._sign(r.height())-s),t.fillStrokeShape(r)},hitFunc:(t,r)=>{if(!this.shouldOverdrawWholeArea())return;const i=this.padding();t.beginPath(),t.rect(-i,-i,r.width()+i*2,r.height()+i*2),t.fillStrokeShape(r)}});this.add(e),this._proxyDrag(e),e.on("dragstart",t=>{t.cancelBubble=!0}),e.on("dragmove",t=>{t.cancelBubble=!0}),e.on("dragend",t=>{t.cancelBubble=!0}),this.on("dragmove",t=>{this.update()})}_handleMouseDown(e){if(this._transforming)return;this._movingAnchorName=e.target.name().split(" ")[0];const t=this._getNodeRect(),r=t.width,i=t.height,s=Math.sqrt(Math.pow(r,2)+Math.pow(i,2));this.sin=Math.abs(i/s),this.cos=Math.abs(r/s),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const o=e.target.getAbsolutePosition(),l=e.target.getStage().getPointerPosition();this._anchorDragOffset={x:l.x-o.x,y:l.y-o.y},R2++,this._fire("transformstart",{evt:e.evt,target:this.getNode()}),this._nodes.forEach(c=>{c._fire("transformstart",{evt:e.evt,target:c})})}_handleMouseMove(e){let t,r,i;const s=this.findOne("."+this._movingAnchorName),o=s.getStage();o.setPointersPositions(e);const l=o.getPointerPosition();let c={x:l.x-this._anchorDragOffset.x,y:l.y-this._anchorDragOffset.y};const d=s.getAbsolutePosition();this.anchorDragBoundFunc()&&(c=this.anchorDragBoundFunc()(d,c,e)),s.setAbsolutePosition(c);const p=s.getAbsolutePosition();if(d.x===p.x&&d.y===p.y)return;if(this._movingAnchorName==="rotater"){const R=this._getNodeRect();t=s.x()-R.width/2,r=-s.y()+R.height/2;let w=Math.atan2(-r,t)+Math.PI/2;R.height<0&&(w-=Math.PI);const F=vi.Konva.getAngle(this.rotation())+w,U=vi.Konva.getAngle(this.rotationSnapTolerance()),C=yG(this.rotationSnaps(),F,U)-R.rotation,b=_G(R,C);this._fitNodesInto(b,e);return}const _=this.shiftBehavior();let m;_==="inverted"?m=this.keepRatio()&&!e.shiftKey:_==="none"?m=this.keepRatio():m=this.keepRatio()||e.shiftKey;let E=this.centeredScaling()||e.altKey;if(this._movingAnchorName==="top-left"){if(m){const R=E?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};i=Math.sqrt(Math.pow(R.x-s.x(),2)+Math.pow(R.y-s.y(),2));const w=this.findOne(".top-left").x()>R.x?-1:1,P=this.findOne(".top-left").y()>R.y?-1:1;t=i*this.cos*w,r=i*this.sin*P,this.findOne(".top-left").x(R.x-t),this.findOne(".top-left").y(R.y-r)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(s.y());else if(this._movingAnchorName==="top-right"){if(m){const R=E?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};i=Math.sqrt(Math.pow(s.x()-R.x,2)+Math.pow(R.y-s.y(),2));const w=this.findOne(".top-right").x()<R.x?-1:1,P=this.findOne(".top-right").y()>R.y?-1:1;t=i*this.cos*w,r=i*this.sin*P,this.findOne(".top-right").x(R.x+t),this.findOne(".top-right").y(R.y-r)}var S=s.position();this.findOne(".top-left").y(S.y),this.findOne(".bottom-right").x(S.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(s.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(s.x());else if(this._movingAnchorName==="bottom-left"){if(m){const R=E?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};i=Math.sqrt(Math.pow(R.x-s.x(),2)+Math.pow(s.y()-R.y,2));const w=R.x<s.x()?-1:1,P=s.y()<R.y?-1:1;t=i*this.cos*w,r=i*this.sin*P,s.x(R.x-t),s.y(R.y+r)}S=s.position(),this.findOne(".top-left").x(S.x),this.findOne(".bottom-right").y(S.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(s.y());else if(this._movingAnchorName==="bottom-right"){if(m){const R=E?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};i=Math.sqrt(Math.pow(s.x()-R.x,2)+Math.pow(s.y()-R.y,2));const w=this.findOne(".bottom-right").x()<R.x?-1:1,P=this.findOne(".bottom-right").y()<R.y?-1:1;t=i*this.cos*w,r=i*this.sin*P,this.findOne(".bottom-right").x(R.x+t),this.findOne(".bottom-right").y(R.y+r)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(E=this.centeredScaling()||e.altKey,E){const R=this.findOne(".top-left"),w=this.findOne(".bottom-right"),P=R.x(),F=R.y(),U=this.getWidth()-w.x(),D=this.getHeight()-w.y();w.move({x:-P,y:-F}),R.move({x:U,y:D})}const k=this.findOne(".top-left").getAbsolutePosition();t=k.x,r=k.y;const N=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),x=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:t,y:r,width:N,height:x,rotation:vi.Konva.getAngle(this.rotation())},e)}_handleMouseUp(e){this._removeEvents(e)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(e){var t;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const r=this.getNode();R2--,this._fire("transformend",{evt:e,target:r}),(t=this.getLayer())===null||t===void 0||t.batchDraw(),r&&this._nodes.forEach(i=>{var s;i._fire("transformend",{evt:e,target:i}),(s=i.getLayer())===null||s===void 0||s.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(e,t){const r=this._getNodeRect(),i=1;if(ft.Util._inRange(e.width,-this.padding()*2-i,i)){this.update();return}if(ft.Util._inRange(e.height,-this.padding()*2-i,i)){this.update();return}const s=new ft.Transform;if(s.rotate(vi.Konva.getAngle(this.rotation())),this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("left")>=0){const m=s.point({x:-this.padding()*2,y:0});e.x+=m.x,e.y+=m.y,e.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=m.x,this._anchorDragOffset.y-=m.y}else if(this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("right")>=0){const m=s.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=m.x,this._anchorDragOffset.y-=m.y,e.width+=this.padding()*2}if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("top")>=0){const m=s.point({x:0,y:-this.padding()*2});e.x+=m.x,e.y+=m.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=m.x,this._anchorDragOffset.y-=m.y,e.height+=this.padding()*2}else if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const m=s.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=m.x,this._anchorDragOffset.y-=m.y,e.height+=this.padding()*2}if(this.boundBoxFunc()){const m=this.boundBoxFunc()(r,e);m?e=m:ft.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const o=1e7,l=new ft.Transform;l.translate(r.x,r.y),l.rotate(r.rotation),l.scale(r.width/o,r.height/o);const c=new ft.Transform,d=e.width/o,p=e.height/o;this.flipEnabled()===!1?(c.translate(e.x,e.y),c.rotate(e.rotation),c.translate(e.width<0?e.width:0,e.height<0?e.height:0),c.scale(Math.abs(d),Math.abs(p))):(c.translate(e.x,e.y),c.rotate(e.rotation),c.scale(d,p));const _=c.multiply(l.invert());this._nodes.forEach(m=>{var E;const S=m.getParent().getAbsoluteTransform(),k=m.getTransform().copy();k.translate(m.offsetX(),m.offsetY());const N=new ft.Transform;N.multiply(S.copy().invert()).multiply(_).multiply(S).multiply(k);const x=N.decompose();m.setAttrs(x),(E=m.getLayer())===null||E===void 0||E.batchDraw()}),this.rotation(ft.Util._getRotation(e.rotation)),this._nodes.forEach(m=>{this._fire("transform",{evt:t,target:m}),m._fire("transform",{evt:t,target:m})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(e,t){this.findOne(e).setAttrs(t)}update(){var e;const t=this._getNodeRect();this.rotation(ft.Util._getRotation(t.rotation));const r=t.width,i=t.height,s=this.enabledAnchors(),o=this.resizeEnabled(),l=this.padding(),c=this.anchorSize(),d=this.find("._anchor");d.forEach(_=>{_.setAttrs({width:c,height:c,offsetX:c/2,offsetY:c/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:c/2+l,offsetY:c/2+l,visible:o&&s.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:r/2,y:0,offsetY:c/2+l,visible:o&&s.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:r,y:0,offsetX:c/2-l,offsetY:c/2+l,visible:o&&s.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:i/2,offsetX:c/2+l,visible:o&&s.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:r,y:i/2,offsetX:c/2-l,visible:o&&s.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:i,offsetX:c/2+l,offsetY:c/2-l,visible:o&&s.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:r/2,y:i,offsetY:c/2-l,visible:o&&s.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:r,y:i,offsetX:c/2-l,offsetY:c/2-l,visible:o&&s.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:r/2,y:-this.rotateAnchorOffset()*ft.Util._sign(i)-l,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:r,height:i,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const p=this.anchorStyleFunc();p&&d.forEach(_=>{p(_)}),(e=this.getLayer())===null||e===void 0||e.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const e=this.findOne("."+this._movingAnchorName);e&&e.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),p5.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return f5.Node.prototype.toObject.call(this)}clone(e){return f5.Node.prototype.clone.call(this,e)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}s_.Transformer=qe;qe.isTransforming=()=>R2>0;function vG(n){return n instanceof Array||ft.Util.warn("enabledAnchors value should be an array"),n instanceof Array&&n.forEach(function(e){bm.indexOf(e)===-1&&ft.Util.warn("Unknown anchor name: "+e+". Available names are: "+bm.join(", "))}),n||[]}qe.prototype.className="Transformer";(0,cG._registerNode)(qe);st.Factory.addGetterSetter(qe,"enabledAnchors",bm,vG);st.Factory.addGetterSetter(qe,"flipEnabled",!0,(0,wa.getBooleanValidator)());st.Factory.addGetterSetter(qe,"resizeEnabled",!0);st.Factory.addGetterSetter(qe,"anchorSize",10,(0,wa.getNumberValidator)());st.Factory.addGetterSetter(qe,"rotateEnabled",!0);st.Factory.addGetterSetter(qe,"rotateLineVisible",!0);st.Factory.addGetterSetter(qe,"rotationSnaps",[]);st.Factory.addGetterSetter(qe,"rotateAnchorOffset",50,(0,wa.getNumberValidator)());st.Factory.addGetterSetter(qe,"rotateAnchorCursor","crosshair");st.Factory.addGetterSetter(qe,"rotationSnapTolerance",5,(0,wa.getNumberValidator)());st.Factory.addGetterSetter(qe,"borderEnabled",!0);st.Factory.addGetterSetter(qe,"anchorStroke","rgb(0, 161, 255)");st.Factory.addGetterSetter(qe,"anchorStrokeWidth",1,(0,wa.getNumberValidator)());st.Factory.addGetterSetter(qe,"anchorFill","white");st.Factory.addGetterSetter(qe,"anchorCornerRadius",0,(0,wa.getNumberValidator)());st.Factory.addGetterSetter(qe,"borderStroke","rgb(0, 161, 255)");st.Factory.addGetterSetter(qe,"borderStrokeWidth",1,(0,wa.getNumberValidator)());st.Factory.addGetterSetter(qe,"borderDash");st.Factory.addGetterSetter(qe,"keepRatio",!0);st.Factory.addGetterSetter(qe,"shiftBehavior","default");st.Factory.addGetterSetter(qe,"centeredScaling",!1);st.Factory.addGetterSetter(qe,"ignoreStroke",!1);st.Factory.addGetterSetter(qe,"padding",0,(0,wa.getNumberValidator)());st.Factory.addGetterSetter(qe,"nodes");st.Factory.addGetterSetter(qe,"node");st.Factory.addGetterSetter(qe,"boundBoxFunc");st.Factory.addGetterSetter(qe,"anchorDragBoundFunc");st.Factory.addGetterSetter(qe,"anchorStyleFunc");st.Factory.addGetterSetter(qe,"shouldOverdrawWholeArea",!1);st.Factory.addGetterSetter(qe,"useSingleNodeRotation",!0);st.Factory.backCompat(qe,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var o_={};Object.defineProperty(o_,"__esModule",{value:!0});o_.Wedge=void 0;const a_=Ue,wG=cn,EG=Oe,Cx=Pe,SG=Oe;class so extends wG.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.radius(),0,EG.Konva.getAngle(this.angle()),this.clockwise()),e.lineTo(0,0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}o_.Wedge=so;so.prototype.className="Wedge";so.prototype._centroid=!0;so.prototype._attrsAffectingSize=["radius"];(0,SG._registerNode)(so);a_.Factory.addGetterSetter(so,"radius",0,(0,Cx.getNumberValidator)());a_.Factory.addGetterSetter(so,"angle",0,(0,Cx.getNumberValidator)());a_.Factory.addGetterSetter(so,"clockwise",!1);a_.Factory.backCompat(so,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var l_={};Object.defineProperty(l_,"__esModule",{value:!0});l_.Blur=void 0;const m5=Ue,TG=Rt,CG=Pe;function _5(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const IG=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],PG=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function kG(n,e){const t=n.data,r=n.width,i=n.height;let s,o,l,c,d,p,_,m,E,S,k,N,x,R,w,P,F,U,D,C;const b=e+e+1,A=r-1,M=i-1,B=e+1,V=B*(B+1)/2,fe=new _5,se=IG[e],Be=PG[e];let De=null,Y=fe,oe=null,ne=null;for(let ae=1;ae<b;ae++)Y=Y.next=new _5,ae===B&&(De=Y);Y.next=fe,l=o=0;for(let ae=0;ae<i;ae++){N=x=R=w=c=d=p=_=0,m=B*(P=t[o]),E=B*(F=t[o+1]),S=B*(U=t[o+2]),k=B*(D=t[o+3]),c+=V*P,d+=V*F,p+=V*U,_+=V*D,Y=fe;for(let pe=0;pe<B;pe++)Y.r=P,Y.g=F,Y.b=U,Y.a=D,Y=Y.next;for(let pe=1;pe<B;pe++)s=o+((A<pe?A:pe)<<2),c+=(Y.r=P=t[s])*(C=B-pe),d+=(Y.g=F=t[s+1])*C,p+=(Y.b=U=t[s+2])*C,_+=(Y.a=D=t[s+3])*C,N+=P,x+=F,R+=U,w+=D,Y=Y.next;oe=fe,ne=De;for(let pe=0;pe<r;pe++)t[o+3]=D=_*se>>Be,D!==0?(D=255/D,t[o]=(c*se>>Be)*D,t[o+1]=(d*se>>Be)*D,t[o+2]=(p*se>>Be)*D):t[o]=t[o+1]=t[o+2]=0,c-=m,d-=E,p-=S,_-=k,m-=oe.r,E-=oe.g,S-=oe.b,k-=oe.a,s=l+((s=pe+e+1)<A?s:A)<<2,N+=oe.r=t[s],x+=oe.g=t[s+1],R+=oe.b=t[s+2],w+=oe.a=t[s+3],c+=N,d+=x,p+=R,_+=w,oe=oe.next,m+=P=ne.r,E+=F=ne.g,S+=U=ne.b,k+=D=ne.a,N-=P,x-=F,R-=U,w-=D,ne=ne.next,o+=4;l+=r}for(let ae=0;ae<r;ae++){x=R=w=N=d=p=_=c=0,o=ae<<2,m=B*(P=t[o]),E=B*(F=t[o+1]),S=B*(U=t[o+2]),k=B*(D=t[o+3]),c+=V*P,d+=V*F,p+=V*U,_+=V*D,Y=fe;for(let Se=0;Se<B;Se++)Y.r=P,Y.g=F,Y.b=U,Y.a=D,Y=Y.next;let pe=r;for(let Se=1;Se<=e;Se++)o=pe+ae<<2,c+=(Y.r=P=t[o])*(C=B-Se),d+=(Y.g=F=t[o+1])*C,p+=(Y.b=U=t[o+2])*C,_+=(Y.a=D=t[o+3])*C,N+=P,x+=F,R+=U,w+=D,Y=Y.next,Se<M&&(pe+=r);o=ae,oe=fe,ne=De;for(let Se=0;Se<i;Se++)s=o<<2,t[s+3]=D=_*se>>Be,D>0?(D=255/D,t[s]=(c*se>>Be)*D,t[s+1]=(d*se>>Be)*D,t[s+2]=(p*se>>Be)*D):t[s]=t[s+1]=t[s+2]=0,c-=m,d-=E,p-=S,_-=k,m-=oe.r,E-=oe.g,S-=oe.b,k-=oe.a,s=ae+((s=Se+B)<M?s:M)*r<<2,c+=N+=oe.r=t[s],d+=x+=oe.g=t[s+1],p+=R+=oe.b=t[s+2],_+=w+=oe.a=t[s+3],oe=oe.next,m+=P=ne.r,E+=F=ne.g,S+=U=ne.b,k+=D=ne.a,N-=P,x-=F,R-=U,w-=D,ne=ne.next,o+=r}}const RG=function(e){const t=Math.round(this.blurRadius());t>0&&kG(e,t)};l_.Blur=RG;m5.Factory.addGetterSetter(TG.Node,"blurRadius",0,(0,CG.getNumberValidator)(),m5.Factory.afterSetFilter);var u_={};Object.defineProperty(u_,"__esModule",{value:!0});u_.Brighten=void 0;const y5=Ue,xG=Rt,AG=Pe,NG=function(n){const e=this.brightness()*255,t=n.data,r=t.length;for(let i=0;i<r;i+=4)t[i]+=e,t[i+1]+=e,t[i+2]+=e};u_.Brighten=NG;y5.Factory.addGetterSetter(xG.Node,"brightness",0,(0,AG.getNumberValidator)(),y5.Factory.afterSetFilter);var c_={};Object.defineProperty(c_,"__esModule",{value:!0});c_.Contrast=void 0;const v5=Ue,DG=Rt,bG=Pe,OG=function(n){const e=Math.pow((this.contrast()+100)/100,2),t=n.data,r=t.length;let i=150,s=150,o=150;for(let l=0;l<r;l+=4)i=t[l],s=t[l+1],o=t[l+2],i/=255,i-=.5,i*=e,i+=.5,i*=255,s/=255,s-=.5,s*=e,s+=.5,s*=255,o/=255,o-=.5,o*=e,o+=.5,o*=255,i=i<0?0:i>255?255:i,s=s<0?0:s>255?255:s,o=o<0?0:o>255?255:o,t[l]=i,t[l+1]=s,t[l+2]=o};c_.Contrast=OG;v5.Factory.addGetterSetter(DG.Node,"contrast",0,(0,bG.getNumberValidator)(),v5.Factory.afterSetFilter);var h_={};Object.defineProperty(h_,"__esModule",{value:!0});h_.Emboss=void 0;const ia=Ue,d_=Rt,MG=Lt,Ix=Pe,LG=function(n){const e=this.embossStrength()*10,t=this.embossWhiteLevel()*255,r=this.embossDirection(),i=this.embossBlend(),s=n.data,o=n.width,l=n.height,c=o*4;let d=0,p=0,_=l;switch(r){case"top-left":d=-1,p=-1;break;case"top":d=-1,p=0;break;case"top-right":d=-1,p=1;break;case"right":d=0,p=1;break;case"bottom-right":d=1,p=1;break;case"bottom":d=1,p=0;break;case"bottom-left":d=1,p=-1;break;case"left":d=0,p=-1;break;default:MG.Util.error("Unknown emboss direction: "+r)}do{const m=(_-1)*c;let E=d;_+E<1&&(E=0),_+E>l&&(E=0);const S=(_-1+E)*o*4;let k=o;do{const N=m+(k-1)*4;let x=p;k+x<1&&(x=0),k+x>o&&(x=0);const R=S+(k-1+x)*4,w=s[N]-s[R],P=s[N+1]-s[R+1],F=s[N+2]-s[R+2];let U=w;const D=U>0?U:-U,C=P>0?P:-P,b=F>0?F:-F;if(C>D&&(U=P),b>D&&(U=F),U*=e,i){const A=s[N]+U,M=s[N+1]+U,B=s[N+2]+U;s[N]=A>255?255:A<0?0:A,s[N+1]=M>255?255:M<0?0:M,s[N+2]=B>255?255:B<0?0:B}else{let A=t-U;A<0?A=0:A>255&&(A=255),s[N]=s[N+1]=s[N+2]=A}}while(--k)}while(--_)};h_.Emboss=LG;ia.Factory.addGetterSetter(d_.Node,"embossStrength",.5,(0,Ix.getNumberValidator)(),ia.Factory.afterSetFilter);ia.Factory.addGetterSetter(d_.Node,"embossWhiteLevel",.5,(0,Ix.getNumberValidator)(),ia.Factory.afterSetFilter);ia.Factory.addGetterSetter(d_.Node,"embossDirection","top-left",void 0,ia.Factory.afterSetFilter);ia.Factory.addGetterSetter(d_.Node,"embossBlend",!1,void 0,ia.Factory.afterSetFilter);var f_={};Object.defineProperty(f_,"__esModule",{value:!0});f_.Enhance=void 0;const w5=Ue,FG=Rt,VG=Pe;function bv(n,e,t,r,i){const s=t-e,o=i-r;if(s===0)return r+o/2;if(o===0)return r;let l=(n-e)/s;return l=o*l+r,l}const UG=function(n){const e=n.data,t=e.length;let r=e[0],i=r,s,o=e[1],l=o,c,d=e[2],p=d,_;const m=this.enhance();if(m===0)return;for(let w=0;w<t;w+=4)s=e[w+0],s<r?r=s:s>i&&(i=s),c=e[w+1],c<o?o=c:c>l&&(l=c),_=e[w+2],_<d?d=_:_>p&&(p=_);i===r&&(i=255,r=0),l===o&&(l=255,o=0),p===d&&(p=255,d=0);let E,S,k,N,x,R;if(m>0)E=i+m*(255-i),S=r-m*(r-0),k=l+m*(255-l),N=o-m*(o-0),x=p+m*(255-p),R=d-m*(d-0);else{const w=(i+r)*.5;E=i+m*(i-w),S=r+m*(r-w);const P=(l+o)*.5;k=l+m*(l-P),N=o+m*(o-P);const F=(p+d)*.5;x=p+m*(p-F),R=d+m*(d-F)}for(let w=0;w<t;w+=4)e[w+0]=bv(e[w+0],r,i,S,E),e[w+1]=bv(e[w+1],o,l,N,k),e[w+2]=bv(e[w+2],d,p,R,x)};f_.Enhance=UG;w5.Factory.addGetterSetter(FG.Node,"enhance",0,(0,VG.getNumberValidator)(),w5.Factory.afterSetFilter);var p_={};Object.defineProperty(p_,"__esModule",{value:!0});p_.Grayscale=void 0;const BG=function(n){const e=n.data,t=e.length;for(let r=0;r<t;r+=4){const i=.34*e[r]+.5*e[r+1]+.16*e[r+2];e[r]=i,e[r+1]=i,e[r+2]=i}};p_.Grayscale=BG;var g_={};Object.defineProperty(g_,"__esModule",{value:!0});g_.HSL=void 0;const oc=Ue,_S=Rt,yS=Pe;oc.Factory.addGetterSetter(_S.Node,"hue",0,(0,yS.getNumberValidator)(),oc.Factory.afterSetFilter);oc.Factory.addGetterSetter(_S.Node,"saturation",0,(0,yS.getNumberValidator)(),oc.Factory.afterSetFilter);oc.Factory.addGetterSetter(_S.Node,"luminance",0,(0,yS.getNumberValidator)(),oc.Factory.afterSetFilter);const zG=function(n){const e=n.data,t=e.length,r=1,i=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,o=this.luminance()*127,l=r*i*Math.cos(s*Math.PI/180),c=r*i*Math.sin(s*Math.PI/180),d=.299*r+.701*l+.167*c,p=.587*r-.587*l+.33*c,_=.114*r-.114*l-.497*c,m=.299*r-.299*l-.328*c,E=.587*r+.413*l+.035*c,S=.114*r-.114*l+.293*c,k=.299*r-.3*l+1.25*c,N=.587*r-.586*l-1.05*c,x=.114*r+.886*l-.2*c;let R,w,P,F;for(let U=0;U<t;U+=4)R=e[U+0],w=e[U+1],P=e[U+2],F=e[U+3],e[U+0]=d*R+p*w+_*P+o,e[U+1]=m*R+E*w+S*P+o,e[U+2]=k*R+N*w+x*P+o,e[U+3]=F};g_.HSL=zG;var m_={};Object.defineProperty(m_,"__esModule",{value:!0});m_.HSV=void 0;const ac=Ue,vS=Rt,wS=Pe,jG=function(n){const e=n.data,t=e.length,r=Math.pow(2,this.value()),i=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,o=r*i*Math.cos(s*Math.PI/180),l=r*i*Math.sin(s*Math.PI/180),c=.299*r+.701*o+.167*l,d=.587*r-.587*o+.33*l,p=.114*r-.114*o-.497*l,_=.299*r-.299*o-.328*l,m=.587*r+.413*o+.035*l,E=.114*r-.114*o+.293*l,S=.299*r-.3*o+1.25*l,k=.587*r-.586*o-1.05*l,N=.114*r+.886*o-.2*l;for(let x=0;x<t;x+=4){const R=e[x+0],w=e[x+1],P=e[x+2],F=e[x+3];e[x+0]=c*R+d*w+p*P,e[x+1]=_*R+m*w+E*P,e[x+2]=S*R+k*w+N*P,e[x+3]=F}};m_.HSV=jG;ac.Factory.addGetterSetter(vS.Node,"hue",0,(0,wS.getNumberValidator)(),ac.Factory.afterSetFilter);ac.Factory.addGetterSetter(vS.Node,"saturation",0,(0,wS.getNumberValidator)(),ac.Factory.afterSetFilter);ac.Factory.addGetterSetter(vS.Node,"value",0,(0,wS.getNumberValidator)(),ac.Factory.afterSetFilter);var __={};Object.defineProperty(__,"__esModule",{value:!0});__.Invert=void 0;const GG=function(n){const e=n.data,t=e.length;for(let r=0;r<t;r+=4)e[r]=255-e[r],e[r+1]=255-e[r+1],e[r+2]=255-e[r+2]};__.Invert=GG;var y_={};Object.defineProperty(y_,"__esModule",{value:!0});y_.Kaleidoscope=void 0;const Om=Ue,Px=Rt,E5=Lt,kx=Pe,WG=function(n,e,t){const r=n.data,i=e.data,s=n.width,o=n.height,l=t.polarCenterX||s/2,c=t.polarCenterY||o/2;let d=Math.sqrt(l*l+c*c),p=s-l,_=o-c;const m=Math.sqrt(p*p+_*_);d=m>d?m:d;const E=o,S=s,k=360/S*Math.PI/180;for(let N=0;N<S;N+=1){const x=Math.sin(N*k),R=Math.cos(N*k);for(let w=0;w<E;w+=1){p=Math.floor(l+d*w/E*R),_=Math.floor(c+d*w/E*x);let P=(_*s+p)*4;const F=r[P+0],U=r[P+1],D=r[P+2],C=r[P+3];P=(N+w*s)*4,i[P+0]=F,i[P+1]=U,i[P+2]=D,i[P+3]=C}}},HG=function(n,e,t){const r=n.data,i=e.data,s=n.width,o=n.height,l=t.polarCenterX||s/2,c=t.polarCenterY||o/2;let d=Math.sqrt(l*l+c*c),p=s-l,_=o-c;const m=Math.sqrt(p*p+_*_);d=m>d?m:d;const E=o,S=s,k=0;let N,x;for(p=0;p<s;p+=1)for(_=0;_<o;_+=1){const R=p-l,w=_-c,P=Math.sqrt(R*R+w*w)*E/d;let F=(Math.atan2(w,R)*180/Math.PI+360+k)%360;F=F*S/360,N=Math.floor(F),x=Math.floor(P);let U=(x*s+N)*4;const D=r[U+0],C=r[U+1],b=r[U+2],A=r[U+3];U=(_*s+p)*4,i[U+0]=D,i[U+1]=C,i[U+2]=b,i[U+3]=A}},$G=function(n){const e=n.width,t=n.height;let r,i,s,o,l,c,d,p,_,m,E=Math.round(this.kaleidoscopePower());const S=Math.round(this.kaleidoscopeAngle()),k=Math.floor(e*(S%360)/360);if(E<1)return;const N=E5.Util.createCanvasElement();N.width=e,N.height=t;const x=N.getContext("2d").getImageData(0,0,e,t);E5.Util.releaseCanvas(N),WG(n,x,{polarCenterX:e/2,polarCenterY:t/2});let R=e/Math.pow(2,E);for(;R<=8;)R=R*2,E-=1;R=Math.ceil(R);let w=R,P=0,F=w,U=1;for(k+R>e&&(P=w,F=0,U=-1),i=0;i<t;i+=1)for(r=P;r!==F;r+=U)s=Math.round(r+k)%e,_=(e*i+s)*4,l=x.data[_+0],c=x.data[_+1],d=x.data[_+2],p=x.data[_+3],m=(e*i+r)*4,x.data[m+0]=l,x.data[m+1]=c,x.data[m+2]=d,x.data[m+3]=p;for(i=0;i<t;i+=1)for(w=Math.floor(R),o=0;o<E;o+=1){for(r=0;r<w+1;r+=1)_=(e*i+r)*4,l=x.data[_+0],c=x.data[_+1],d=x.data[_+2],p=x.data[_+3],m=(e*i+w*2-r-1)*4,x.data[m+0]=l,x.data[m+1]=c,x.data[m+2]=d,x.data[m+3]=p;w*=2}HG(x,n,{})};y_.Kaleidoscope=$G;Om.Factory.addGetterSetter(Px.Node,"kaleidoscopePower",2,(0,kx.getNumberValidator)(),Om.Factory.afterSetFilter);Om.Factory.addGetterSetter(Px.Node,"kaleidoscopeAngle",0,(0,kx.getNumberValidator)(),Om.Factory.afterSetFilter);var v_={};Object.defineProperty(v_,"__esModule",{value:!0});v_.Mask=void 0;const S5=Ue,qG=Rt,KG=Pe;function eg(n,e,t){let r=(t*n.width+e)*4;const i=[];return i.push(n.data[r++],n.data[r++],n.data[r++],n.data[r++]),i}function Ph(n,e){return Math.sqrt(Math.pow(n[0]-e[0],2)+Math.pow(n[1]-e[1],2)+Math.pow(n[2]-e[2],2))}function QG(n){const e=[0,0,0];for(let t=0;t<n.length;t++)e[0]+=n[t][0],e[1]+=n[t][1],e[2]+=n[t][2];return e[0]/=n.length,e[1]/=n.length,e[2]/=n.length,e}function YG(n,e){const t=eg(n,0,0),r=eg(n,n.width-1,0),i=eg(n,0,n.height-1),s=eg(n,n.width-1,n.height-1),o=e||10;if(Ph(t,r)<o&&Ph(r,s)<o&&Ph(s,i)<o&&Ph(i,t)<o){const l=QG([r,t,s,i]),c=[];for(let d=0;d<n.width*n.height;d++){const p=Ph(l,[n.data[d*4],n.data[d*4+1],n.data[d*4+2]]);c[d]=p<o?0:255}return c}}function XG(n,e){for(let t=0;t<n.width*n.height;t++)n.data[4*t+3]=e[t]}function JG(n,e,t){const r=[1,1,1,1,0,1,1,1,1],i=Math.round(Math.sqrt(r.length)),s=Math.floor(i/2),o=[];for(let l=0;l<t;l++)for(let c=0;c<e;c++){const d=l*e+c;let p=0;for(let _=0;_<i;_++)for(let m=0;m<i;m++){const E=l+_-s,S=c+m-s;if(E>=0&&E<t&&S>=0&&S<e){const k=E*e+S,N=r[_*i+m];p+=n[k]*N}}o[d]=p===255*8?255:0}return o}function ZG(n,e,t){const r=[1,1,1,1,1,1,1,1,1],i=Math.round(Math.sqrt(r.length)),s=Math.floor(i/2),o=[];for(let l=0;l<t;l++)for(let c=0;c<e;c++){const d=l*e+c;let p=0;for(let _=0;_<i;_++)for(let m=0;m<i;m++){const E=l+_-s,S=c+m-s;if(E>=0&&E<t&&S>=0&&S<e){const k=E*e+S,N=r[_*i+m];p+=n[k]*N}}o[d]=p>=255*4?255:0}return o}function eW(n,e,t){const r=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],i=Math.round(Math.sqrt(r.length)),s=Math.floor(i/2),o=[];for(let l=0;l<t;l++)for(let c=0;c<e;c++){const d=l*e+c;let p=0;for(let _=0;_<i;_++)for(let m=0;m<i;m++){const E=l+_-s,S=c+m-s;if(E>=0&&E<t&&S>=0&&S<e){const k=E*e+S,N=r[_*i+m];p+=n[k]*N}}o[d]=p}return o}const tW=function(n){const e=this.threshold();let t=YG(n,e);return t&&(t=JG(t,n.width,n.height),t=ZG(t,n.width,n.height),t=eW(t,n.width,n.height),XG(n,t)),n};v_.Mask=tW;S5.Factory.addGetterSetter(qG.Node,"threshold",0,(0,KG.getNumberValidator)(),S5.Factory.afterSetFilter);var w_={};Object.defineProperty(w_,"__esModule",{value:!0});w_.Noise=void 0;const T5=Ue,nW=Rt,rW=Pe,iW=function(n){const e=this.noise()*255,t=n.data,r=t.length,i=e/2;for(let s=0;s<r;s+=4)t[s+0]+=i-2*i*Math.random(),t[s+1]+=i-2*i*Math.random(),t[s+2]+=i-2*i*Math.random()};w_.Noise=iW;T5.Factory.addGetterSetter(nW.Node,"noise",.2,(0,rW.getNumberValidator)(),T5.Factory.afterSetFilter);var E_={};Object.defineProperty(E_,"__esModule",{value:!0});E_.Pixelate=void 0;const C5=Ue,sW=Lt,oW=Rt,aW=Pe,lW=function(n){let e=Math.ceil(this.pixelSize()),t=n.width,r=n.height,i=Math.ceil(t/e),s=Math.ceil(r/e),o=n.data;if(e<=0){sW.Util.error("pixelSize value can not be <= 0");return}for(let l=0;l<i;l+=1)for(let c=0;c<s;c+=1){let d=0,p=0,_=0,m=0;const E=l*e,S=E+e,k=c*e,N=k+e;let x=0;for(let R=E;R<S;R+=1)if(!(R>=t))for(let w=k;w<N;w+=1){if(w>=r)continue;const P=(t*w+R)*4;d+=o[P+0],p+=o[P+1],_+=o[P+2],m+=o[P+3],x+=1}d=d/x,p=p/x,_=_/x,m=m/x;for(let R=E;R<S;R+=1)if(!(R>=t))for(let w=k;w<N;w+=1){if(w>=r)continue;const P=(t*w+R)*4;o[P+0]=d,o[P+1]=p,o[P+2]=_,o[P+3]=m}}};E_.Pixelate=lW;C5.Factory.addGetterSetter(oW.Node,"pixelSize",8,(0,aW.getNumberValidator)(),C5.Factory.afterSetFilter);var S_={};Object.defineProperty(S_,"__esModule",{value:!0});S_.Posterize=void 0;const I5=Ue,uW=Rt,cW=Pe,hW=function(n){const e=Math.round(this.levels()*254)+1,t=n.data,r=t.length,i=255/e;for(let s=0;s<r;s+=1)t[s]=Math.floor(t[s]/i)*i};S_.Posterize=hW;I5.Factory.addGetterSetter(uW.Node,"levels",.5,(0,cW.getNumberValidator)(),I5.Factory.afterSetFilter);var T_={};Object.defineProperty(T_,"__esModule",{value:!0});T_.RGB=void 0;const Mm=Ue,ES=Rt,dW=Pe,fW=function(n){const e=n.data,t=e.length,r=this.red(),i=this.green(),s=this.blue();for(let o=0;o<t;o+=4){const l=(.34*e[o]+.5*e[o+1]+.16*e[o+2])/255;e[o]=l*r,e[o+1]=l*i,e[o+2]=l*s,e[o+3]=e[o+3]}};T_.RGB=fW;Mm.Factory.addGetterSetter(ES.Node,"red",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)});Mm.Factory.addGetterSetter(ES.Node,"green",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)});Mm.Factory.addGetterSetter(ES.Node,"blue",0,dW.RGBComponent,Mm.Factory.afterSetFilter);var C_={};Object.defineProperty(C_,"__esModule",{value:!0});C_.RGBA=void 0;const Gd=Ue,I_=Rt,pW=Pe,gW=function(n){const e=n.data,t=e.length,r=this.red(),i=this.green(),s=this.blue(),o=this.alpha();for(let l=0;l<t;l+=4){const c=1-o;e[l]=r*o+e[l]*c,e[l+1]=i*o+e[l+1]*c,e[l+2]=s*o+e[l+2]*c}};C_.RGBA=gW;Gd.Factory.addGetterSetter(I_.Node,"red",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)});Gd.Factory.addGetterSetter(I_.Node,"green",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)});Gd.Factory.addGetterSetter(I_.Node,"blue",0,pW.RGBComponent,Gd.Factory.afterSetFilter);Gd.Factory.addGetterSetter(I_.Node,"alpha",1,function(n){return this._filterUpToDate=!1,n>1?1:n<0?0:n});var P_={};Object.defineProperty(P_,"__esModule",{value:!0});P_.Sepia=void 0;const mW=function(n){const e=n.data,t=e.length;for(let r=0;r<t;r+=4){const i=e[r+0],s=e[r+1],o=e[r+2];e[r+0]=Math.min(255,i*.393+s*.769+o*.189),e[r+1]=Math.min(255,i*.349+s*.686+o*.168),e[r+2]=Math.min(255,i*.272+s*.534+o*.131)}};P_.Sepia=mW;var k_={};Object.defineProperty(k_,"__esModule",{value:!0});k_.Solarize=void 0;const _W=function(n){const e=n.data,t=n.width,r=n.height,i=t*4;let s=r;do{const o=(s-1)*i;let l=t;do{const c=o+(l-1)*4;let d=e[c],p=e[c+1],_=e[c+2];d>127&&(d=255-d),p>127&&(p=255-p),_>127&&(_=255-_),e[c]=d,e[c+1]=p,e[c+2]=_}while(--l)}while(--s)};k_.Solarize=_W;var R_={};Object.defineProperty(R_,"__esModule",{value:!0});R_.Threshold=void 0;const P5=Ue,yW=Rt,vW=Pe,wW=function(n){const e=this.threshold()*255,t=n.data,r=t.length;for(let i=0;i<r;i+=1)t[i]=t[i]<e?0:255};R_.Threshold=wW;P5.Factory.addGetterSetter(yW.Node,"threshold",.5,(0,vW.getNumberValidator)(),P5.Factory.afterSetFilter);Object.defineProperty(V0,"__esModule",{value:!0});V0.Konva=void 0;const k5=Nm,EW=G0,SW=$0,TW=Q0,CW=Y0,IW=X0,R5=sc,PW=wf,kW=Pc,RW=Sf,xW=e_,AW=t_,NW=n_,DW=r_,bW=Rc,OW=i_,MW=s_,LW=o_,FW=l_,VW=u_,UW=c_,BW=h_,zW=f_,jW=p_,GW=g_,WW=m_,HW=__,$W=y_,qW=v_,KW=w_,QW=E_,YW=S_,XW=T_,JW=C_,ZW=P_,eH=k_,tH=R_;V0.Konva=k5.Konva.Util._assign(k5.Konva,{Arc:EW.Arc,Arrow:SW.Arrow,Circle:TW.Circle,Ellipse:CW.Ellipse,Image:IW.Image,Label:R5.Label,Tag:R5.Tag,Line:PW.Line,Path:kW.Path,Rect:RW.Rect,RegularPolygon:xW.RegularPolygon,Ring:AW.Ring,Sprite:NW.Sprite,Star:DW.Star,Text:bW.Text,TextPath:OW.TextPath,Transformer:MW.Transformer,Wedge:LW.Wedge,Filters:{Blur:FW.Blur,Brighten:VW.Brighten,Contrast:UW.Contrast,Emboss:BW.Emboss,Enhance:zW.Enhance,Grayscale:jW.Grayscale,HSL:GW.HSL,HSV:WW.HSV,Invert:HW.Invert,Kaleidoscope:$W.Kaleidoscope,Mask:qW.Mask,Noise:KW.Noise,Pixelate:QW.Pixelate,Posterize:YW.Posterize,RGB:XW.RGB,RGBA:JW.RGBA,Sepia:ZW.Sepia,Solarize:eH.Solarize,Threshold:tH.Threshold}});var nH=qR.exports;Object.defineProperty(nH,"__esModule",{value:!0});const rH=V0;qR.exports=rH.Konva;var x2={exports:{}};(function(n,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;var t=Nm;Object.defineProperty(e,"Konva",{enumerable:!0,get:function(){return t.Konva}});const r=Nm;n.exports=r.Konva})(x2,x2.exports);var iH=x2.exports;const Wd=Vm(iH);var Rx={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sH=function(e){var t={},r=me,i=Vh,s=Object.assign;function o(a){for(var u="https://reactjs.org/docs/error-decoder.html?invariant="+a,f=1;f<arguments.length;f++)u+="&args[]="+encodeURIComponent(arguments[f]);return"Minified React error #"+a+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var l=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,c=Symbol.for("react.element"),d=Symbol.for("react.portal"),p=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),m=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),S=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),x=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),P=Symbol.for("react.offscreen"),F=Symbol.iterator;function U(a){return a===null||typeof a!="object"?null:(a=F&&a[F]||a["@@iterator"],typeof a=="function"?a:null)}function D(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case p:return"Fragment";case d:return"Portal";case m:return"Profiler";case _:return"StrictMode";case N:return"Suspense";case x:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case S:return(a.displayName||"Context")+".Consumer";case E:return(a._context.displayName||"Context")+".Provider";case k:var u=a.render;return a=a.displayName,a||(a=u.displayName||u.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case R:return u=a.displayName||null,u!==null?u:D(a.type)||"Memo";case w:u=a._payload,a=a._init;try{return D(a(u))}catch{}}return null}function C(a){var u=a.type;switch(a.tag){case 24:return"Cache";case 9:return(u.displayName||"Context")+".Consumer";case 10:return(u._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=u.render,a=a.displayName||a.name||"",u.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return u;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return D(u);case 8:return u===_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u}return null}function b(a){var u=a,f=a;if(a.alternate)for(;u.return;)u=u.return;else{a=u;do u=a,u.flags&4098&&(f=u.return),a=u.return;while(a)}return u.tag===3?f:null}function A(a){if(b(a)!==a)throw Error(o(188))}function M(a){var u=a.alternate;if(!u){if(u=b(a),u===null)throw Error(o(188));return u!==a?null:a}for(var f=a,g=u;;){var y=f.return;if(y===null)break;var T=y.alternate;if(T===null){if(g=y.return,g!==null){f=g;continue}break}if(y.child===T.child){for(T=y.child;T;){if(T===f)return A(y),a;if(T===g)return A(y),u;T=T.sibling}throw Error(o(188))}if(f.return!==g.return)f=y,g=T;else{for(var L=!1,G=y.child;G;){if(G===f){L=!0,f=y,g=T;break}if(G===g){L=!0,g=y,f=T;break}G=G.sibling}if(!L){for(G=T.child;G;){if(G===f){L=!0,f=T,g=y;break}if(G===g){L=!0,g=T,f=y;break}G=G.sibling}if(!L)throw Error(o(189))}}if(f.alternate!==g)throw Error(o(190))}if(f.tag!==3)throw Error(o(188));return f.stateNode.current===f?a:u}function B(a){return a=M(a),a!==null?V(a):null}function V(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var u=V(a);if(u!==null)return u;a=a.sibling}return null}function fe(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){if(a.tag!==4){var u=fe(a);if(u!==null)return u}a=a.sibling}return null}var se=Array.isArray,Be=e.getPublicInstance,De=e.getRootHostContext,Y=e.getChildHostContext,oe=e.prepareForCommit,ne=e.resetAfterCommit,ae=e.createInstance,pe=e.appendInitialChild,Se=e.finalizeInitialChildren,en=e.prepareUpdate,xt=e.shouldSetTextContent,pt=e.createTextInstance,j=e.scheduleTimeout,Z=e.cancelTimeout,ye=e.noTimeout,Ke=e.isPrimaryRenderer,ke=e.supportsMutation,ot=e.supportsPersistence,lt=e.supportsHydration,_r=e.getInstanceFromNode,rt=e.preparePortalMount,li=e.getCurrentEventPriority,Or=e.detachDeletedInstance,Oi=e.supportsMicrotasks,Tf=e.scheduleMicrotask,ls=e.supportsTestSelectors,Cf=e.findFiberRoot,D_=e.getBoundingRect,xc=e.getTextContent,us=e.isHiddenSubtree,If=e.matchAccessibilityRole,dn=e.setFocusIfFocusable,Pn=e.setupIntersectionObserver,Ol=e.appendChild,Pf=e.appendChildToContainer,kf=e.commitTextUpdate,b_=e.commitMount,Sa=e.commitUpdate,Rf=e.insertBefore,xf=e.insertInContainerBefore,Ac=e.removeChild,O_=e.removeChildFromContainer,Af=e.resetTextContent,Nc=e.hideInstance,Nf=e.hideTextInstance,Df=e.unhideInstance,Ta=e.unhideTextInstance,Dc=e.clearContainer,bc=e.cloneInstance,Mi=e.createContainerChildSet,Oc=e.appendChildToContainerChildSet,Ml=e.finalizeContainerChildren,Ll=e.replaceContainerChildren,oo=e.cloneHiddenInstance,Mc=e.cloneHiddenTextInstance,kn=e.canHydrateInstance,bf=e.canHydrateTextInstance,Ca=e.canHydrateSuspenseInstance,ao=e.isSuspenseInstancePending,Lc=e.isSuspenseInstanceFallback,M_=e.getSuspenseInstanceFallbackErrorDetails,lo=e.registerSuspenseInstanceRetry,Fl=e.getNextHydratableSibling,L_=e.getFirstHydratableChild,Vl=e.getFirstHydratableChildWithinContainer,Of=e.getFirstHydratableChildWithinSuspenseInstance,Fc=e.hydrateInstance,Ul=e.hydrateTextInstance,Li=e.hydrateSuspenseInstance,Mf=e.getNextHydratableInstanceAfterSuspenseInstance,Lf=e.commitHydratedContainer,Vc=e.commitHydratedSuspenseInstance,Uc=e.clearSuspenseBoundary,Ff=e.clearSuspenseBoundaryFromContainer,Vf=e.shouldDeleteUnhydratedTailInstances,F_=e.didNotMatchHydratedContainerTextInstance,Bl=e.didNotMatchHydratedTextInstance,zl;function cs(a){if(zl===void 0)try{throw Error()}catch(f){var u=f.stack.trim().match(/\n( *(at )?)/);zl=u&&u[1]||""}return`
`+zl+a}var hs=!1;function ui(a,u){if(!a||hs)return"";hs=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(u)if(u=function(){throw Error()},Object.defineProperty(u.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(u,[])}catch(te){var g=te}Reflect.construct(a,[],u)}else{try{u.call()}catch(te){g=te}a.call(u.prototype)}else{try{throw Error()}catch(te){g=te}a()}}catch(te){if(te&&g&&typeof te.stack=="string"){for(var y=te.stack.split(`
`),T=g.stack.split(`
`),L=y.length-1,G=T.length-1;1<=L&&0<=G&&y[L]!==T[G];)G--;for(;1<=L&&0<=G;L--,G--)if(y[L]!==T[G]){if(L!==1||G!==1)do if(L--,G--,0>G||y[L]!==T[G]){var q=`
`+y[L].replace(" at new "," at ");return a.displayName&&q.includes("<anonymous>")&&(q=q.replace("<anonymous>",a.displayName)),q}while(1<=L&&0<=G);break}}}finally{hs=!1,Error.prepareStackTrace=f}return(a=a?a.displayName||a.name:"")?cs(a):""}var Bc=Object.prototype.hasOwnProperty,zc=[],ds=-1;function ci(a){return{current:a}}function ht(a){0>ds||(a.current=zc[ds],zc[ds]=null,ds--)}function at(a,u){ds++,zc[ds]=a.current,a.current=u}var Wr={},tn=ci(Wr),Rn=ci(!1),fs=Wr;function uo(a,u){var f=a.type.contextTypes;if(!f)return Wr;var g=a.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===u)return g.__reactInternalMemoizedMaskedChildContext;var y={},T;for(T in f)y[T]=u[T];return g&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=u,a.__reactInternalMemoizedMaskedChildContext=y),y}function xn(a){return a=a.childContextTypes,a!=null}function Ia(){ht(Rn),ht(tn)}function Uf(a,u,f){if(tn.current!==Wr)throw Error(o(168));at(tn,u),at(Rn,f)}function Fi(a,u,f){var g=a.stateNode;if(u=u.childContextTypes,typeof g.getChildContext!="function")return f;g=g.getChildContext();for(var y in g)if(!(y in u))throw Error(o(108,C(a)||"Unknown",y));return s({},f,g)}function yr(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Wr,fs=tn.current,at(tn,a),at(Rn,Rn.current),!0}function Pa(a,u,f){var g=a.stateNode;if(!g)throw Error(o(169));f?(a=Fi(a,u,fs),g.__reactInternalMemoizedMergedChildContext=a,ht(Rn),ht(tn),at(tn,a)):ht(Rn),at(Rn,f)}var zn=Math.clz32?Math.clz32:jl,Bf=Math.log,gt=Math.LN2;function jl(a){return a>>>=0,a===0?32:31-(Bf(a)/gt|0)|0}var Vi=64,Ui=4194304;function ka(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function Ra(a,u){var f=a.pendingLanes;if(f===0)return 0;var g=0,y=a.suspendedLanes,T=a.pingedLanes,L=f&268435455;if(L!==0){var G=L&~y;G!==0?g=ka(G):(T&=L,T!==0&&(g=ka(T)))}else L=f&~y,L!==0?g=ka(L):T!==0&&(g=ka(T));if(g===0)return 0;if(u!==0&&u!==g&&!(u&y)&&(y=g&-g,T=u&-u,y>=T||y===16&&(T&4194240)!==0))return u;if(g&4&&(g|=f&16),u=a.entangledLanes,u!==0)for(a=a.entanglements,u&=g;0<u;)f=31-zn(u),y=1<<f,g|=a[f],u&=~y;return g}function V_(a,u){switch(a){case 1:case 2:case 4:return u+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function U_(a,u){for(var f=a.suspendedLanes,g=a.pingedLanes,y=a.expirationTimes,T=a.pendingLanes;0<T;){var L=31-zn(T),G=1<<L,q=y[L];q===-1?(!(G&f)||G&g)&&(y[L]=V_(G,u)):q<=u&&(a.expiredLanes|=G),T&=~G}}function jc(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function zf(){var a=Vi;return Vi<<=1,!(Vi&4194240)&&(Vi=64),a}function ps(a){for(var u=[],f=0;31>f;f++)u.push(a);return u}function vr(a,u,f){a.pendingLanes|=u,u!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,u=31-zn(u),a[u]=f}function jf(a,u){var f=a.pendingLanes&~u;a.pendingLanes=u,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=u,a.mutableReadLanes&=u,a.entangledLanes&=u,u=a.entanglements;var g=a.eventTimes;for(a=a.expirationTimes;0<f;){var y=31-zn(f),T=1<<y;u[y]=0,g[y]=-1,a[y]=-1,f&=~T}}function Gl(a,u){var f=a.entangledLanes|=u;for(a=a.entanglements;f;){var g=31-zn(f),y=1<<g;y&u|a[g]&u&&(a[g]|=u),f&=~y}}var $e=0;function gs(a){return a&=-a,1<a?4<a?a&268435455?16:536870912:4:1}var Gc=i.unstable_scheduleCallback,Gf=i.unstable_cancelCallback,B_=i.unstable_shouldYield,Bi=i.unstable_requestPaint,$t=i.unstable_now,Wc=i.unstable_ImmediatePriority,Wl=i.unstable_UserBlockingPriority,co=i.unstable_NormalPriority,Wf=i.unstable_IdlePriority,zi=null,jn=null;function Hf(a){if(jn&&typeof jn.onCommitFiberRoot=="function")try{jn.onCommitFiberRoot(zi,a,void 0,(a.current.flags&128)===128)}catch{}}function Hc(a,u){return a===u&&(a!==0||1/a===1/u)||a!==a&&u!==u}var Qe=typeof Object.is=="function"?Object.is:Hc,hi=null,Hl=!1,$l=!1;function $c(a){hi===null?hi=[a]:hi.push(a)}function $f(a){Hl=!0,$c(a)}function ar(){if(!$l&&hi!==null){$l=!0;var a=0,u=$e;try{var f=hi;for($e=1;a<f.length;a++){var g=f[a];do g=g(!0);while(g!==null)}hi=null,Hl=!1}catch(y){throw hi!==null&&(hi=hi.slice(a+1)),Gc(Wc,ar),y}finally{$e=u,$l=!1}}return null}var ms=[],Gn=0,xa=null,ql=0,fn=[],lr=0,di=null,wr=1,Hr="";function $r(a,u){ms[Gn++]=ql,ms[Gn++]=xa,xa=a,ql=u}function qf(a,u,f){fn[lr++]=wr,fn[lr++]=Hr,fn[lr++]=di,di=a;var g=wr;a=Hr;var y=32-zn(g)-1;g&=~(1<<y),f+=1;var T=32-zn(u)+y;if(30<T){var L=y-y%5;T=(g&(1<<L)-1).toString(32),g>>=L,y-=L,wr=1<<32-zn(u)+y|f<<y|g,Hr=T+a}else wr=1<<T|f<<y|g,Hr=a}function Kl(a){a.return!==null&&($r(a,1),qf(a,1,0))}function _s(a){for(;a===xa;)xa=ms[--Gn],ms[Gn]=null,ql=ms[--Gn],ms[Gn]=null;for(;a===di;)di=fn[--lr],fn[lr]=null,Hr=fn[--lr],fn[lr]=null,wr=fn[--lr],fn[lr]=null}var Wn=null,ur=null,dt=!1,ys=!1,Er=null;function Aa(a,u){var f=Xr(5,null,null,0);f.elementType="DELETED",f.stateNode=u,f.return=a,u=a.deletions,u===null?(a.deletions=[f],a.flags|=16):u.push(f)}function qc(a,u){switch(a.tag){case 5:return u=kn(u,a.type,a.pendingProps),u!==null?(a.stateNode=u,Wn=a,ur=L_(u),!0):!1;case 6:return u=bf(u,a.pendingProps),u!==null?(a.stateNode=u,Wn=a,ur=null,!0):!1;case 13:if(u=Ca(u),u!==null){var f=di!==null?{id:wr,overflow:Hr}:null;return a.memoizedState={dehydrated:u,treeContext:f,retryLane:1073741824},f=Xr(18,null,null,0),f.stateNode=u,f.return=a,a.child=f,Wn=a,ur=null,!0}return!1;default:return!1}}function Ql(a){return(a.mode&1)!==0&&(a.flags&128)===0}function fi(a){if(dt){var u=ur;if(u){var f=u;if(!qc(a,u)){if(Ql(a))throw Error(o(418));u=Fl(f);var g=Wn;u&&qc(a,u)?Aa(g,f):(a.flags=a.flags&-4097|2,dt=!1,Wn=a)}}else{if(Ql(a))throw Error(o(418));a.flags=a.flags&-4097|2,dt=!1,Wn=a}}}function Kc(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;Wn=a}function Na(a){if(!lt||a!==Wn)return!1;if(!dt)return Kc(a),dt=!0,!1;if(a.tag!==3&&(a.tag!==5||Vf(a.type)&&!xt(a.type,a.memoizedProps))){var u=ur;if(u){if(Ql(a))throw Qc(),Error(o(418));for(;u;)Aa(a,u),u=Fl(u)}}if(Kc(a),a.tag===13){if(!lt)throw Error(o(316));if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(o(317));ur=Mf(a)}else ur=Wn?Fl(a.stateNode):null;return!0}function Qc(){for(var a=ur;a;)a=Fl(a)}function vs(){lt&&(ur=Wn=null,ys=dt=!1)}function ho(a){Er===null?Er=[a]:Er.push(a)}var cr=l.ReactCurrentBatchConfig;function Da(a,u){if(Qe(a,u))return!0;if(typeof a!="object"||a===null||typeof u!="object"||u===null)return!1;var f=Object.keys(a),g=Object.keys(u);if(f.length!==g.length)return!1;for(g=0;g<f.length;g++){var y=f[g];if(!Bc.call(u,y)||!Qe(a[y],u[y]))return!1}return!0}function Kf(a){switch(a.tag){case 5:return cs(a.type);case 16:return cs("Lazy");case 13:return cs("Suspense");case 19:return cs("SuspenseList");case 0:case 2:case 15:return a=ui(a.type,!1),a;case 11:return a=ui(a.type.render,!1),a;case 1:return a=ui(a.type,!0),a;default:return""}}function qr(a,u,f){if(a=f.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(f._owner){if(f=f._owner,f){if(f.tag!==1)throw Error(o(309));var g=f.stateNode}if(!g)throw Error(o(147,a));var y=g,T=""+a;return u!==null&&u.ref!==null&&typeof u.ref=="function"&&u.ref._stringRef===T?u.ref:(u=function(L){var G=y.refs;L===null?delete G[T]:G[T]=L},u._stringRef=T,u)}if(typeof a!="string")throw Error(o(284));if(!f._owner)throw Error(o(290,a))}return a}function h(a,u){throw a=Object.prototype.toString.call(u),Error(o(31,a==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":a))}function v(a){var u=a._init;return u(a._payload)}function I(a){function u($,W){if(a){var Q=$.deletions;Q===null?($.deletions=[W],$.flags|=16):Q.push(W)}}function f($,W){if(!a)return null;for(;W!==null;)u($,W),W=W.sibling;return null}function g($,W){for($=new Map;W!==null;)W.key!==null?$.set(W.key,W):$.set(W.index,W),W=W.sibling;return $}function y($,W){return $=vo($,W),$.index=0,$.sibling=null,$}function T($,W,Q){return $.index=Q,a?(Q=$.alternate,Q!==null?(Q=Q.index,Q<W?($.flags|=2,W):Q):($.flags|=2,W)):($.flags|=1048576,W)}function L($){return a&&$.alternate===null&&($.flags|=2),$}function G($,W,Q,ce){return W===null||W.tag!==6?(W=Ny(Q,$.mode,ce),W.return=$,W):(W=y(W,Q),W.return=$,W)}function q($,W,Q,ce){var we=Q.type;return we===p?ge($,W,Q.props.children,ce,Q.key):W!==null&&(W.elementType===we||typeof we=="object"&&we!==null&&we.$$typeof===w&&v(we)===W.type)?(ce=y(W,Q.props),ce.ref=qr($,W,Q),ce.return=$,ce):(ce=Tp(Q.type,Q.key,Q.props,null,$.mode,ce),ce.ref=qr($,W,Q),ce.return=$,ce)}function te($,W,Q,ce){return W===null||W.tag!==4||W.stateNode.containerInfo!==Q.containerInfo||W.stateNode.implementation!==Q.implementation?(W=Dy(Q,$.mode,ce),W.return=$,W):(W=y(W,Q.children||[]),W.return=$,W)}function ge($,W,Q,ce,we){return W===null||W.tag!==7?(W=Va(Q,$.mode,ce,we),W.return=$,W):(W=y(W,Q),W.return=$,W)}function Ae($,W,Q){if(typeof W=="string"&&W!==""||typeof W=="number")return W=Ny(""+W,$.mode,Q),W.return=$,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case c:return Q=Tp(W.type,W.key,W.props,null,$.mode,Q),Q.ref=qr($,null,W),Q.return=$,Q;case d:return W=Dy(W,$.mode,Q),W.return=$,W;case w:var ce=W._init;return Ae($,ce(W._payload),Q)}if(se(W)||U(W))return W=Va(W,$.mode,Q,null),W.return=$,W;h($,W)}return null}function le($,W,Q,ce){var we=W!==null?W.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number")return we!==null?null:G($,W,""+Q,ce);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case c:return Q.key===we?q($,W,Q,ce):null;case d:return Q.key===we?te($,W,Q,ce):null;case w:return we=Q._init,le($,W,we(Q._payload),ce)}if(se(Q)||U(Q))return we!==null?null:ge($,W,Q,ce,null);h($,Q)}return null}function St($,W,Q,ce,we){if(typeof ce=="string"&&ce!==""||typeof ce=="number")return $=$.get(Q)||null,G(W,$,""+ce,we);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case c:return $=$.get(ce.key===null?Q:ce.key)||null,q(W,$,ce,we);case d:return $=$.get(ce.key===null?Q:ce.key)||null,te(W,$,ce,we);case w:var be=ce._init;return St($,W,Q,be(ce._payload),we)}if(se(ce)||U(ce))return $=$.get(Q)||null,ge(W,$,ce,we,null);h(W,ce)}return null}function mt($,W,Q,ce){for(var we=null,be=null,Ne=W,et=W=0,_n=null;Ne!==null&&et<Q.length;et++){Ne.index>et?(_n=Ne,Ne=null):_n=Ne.sibling;var tt=le($,Ne,Q[et],ce);if(tt===null){Ne===null&&(Ne=_n);break}a&&Ne&&tt.alternate===null&&u($,Ne),W=T(tt,W,et),be===null?we=tt:be.sibling=tt,be=tt,Ne=_n}if(et===Q.length)return f($,Ne),dt&&$r($,et),we;if(Ne===null){for(;et<Q.length;et++)Ne=Ae($,Q[et],ce),Ne!==null&&(W=T(Ne,W,et),be===null?we=Ne:be.sibling=Ne,be=Ne);return dt&&$r($,et),we}for(Ne=g($,Ne);et<Q.length;et++)_n=St(Ne,$,et,Q[et],ce),_n!==null&&(a&&_n.alternate!==null&&Ne.delete(_n.key===null?et:_n.key),W=T(_n,W,et),be===null?we=_n:be.sibling=_n,be=_n);return a&&Ne.forEach(function(wo){return u($,wo)}),dt&&$r($,et),we}function Ir($,W,Q,ce){var we=U(Q);if(typeof we!="function")throw Error(o(150));if(Q=we.call(Q),Q==null)throw Error(o(151));for(var be=we=null,Ne=W,et=W=0,_n=null,tt=Q.next();Ne!==null&&!tt.done;et++,tt=Q.next()){Ne.index>et?(_n=Ne,Ne=null):_n=Ne.sibling;var wo=le($,Ne,tt.value,ce);if(wo===null){Ne===null&&(Ne=_n);break}a&&Ne&&wo.alternate===null&&u($,Ne),W=T(wo,W,et),be===null?we=wo:be.sibling=wo,be=wo,Ne=_n}if(tt.done)return f($,Ne),dt&&$r($,et),we;if(Ne===null){for(;!tt.done;et++,tt=Q.next())tt=Ae($,tt.value,ce),tt!==null&&(W=T(tt,W,et),be===null?we=tt:be.sibling=tt,be=tt);return dt&&$r($,et),we}for(Ne=g($,Ne);!tt.done;et++,tt=Q.next())tt=St(Ne,$,et,tt.value,ce),tt!==null&&(a&&tt.alternate!==null&&Ne.delete(tt.key===null?et:tt.key),W=T(tt,W,et),be===null?we=tt:be.sibling=tt,be=tt);return a&&Ne.forEach(function(vA){return u($,vA)}),dt&&$r($,et),we}function Ts($,W,Q,ce){if(typeof Q=="object"&&Q!==null&&Q.type===p&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case c:e:{for(var we=Q.key,be=W;be!==null;){if(be.key===we){if(we=Q.type,we===p){if(be.tag===7){f($,be.sibling),W=y(be,Q.props.children),W.return=$,$=W;break e}}else if(be.elementType===we||typeof we=="object"&&we!==null&&we.$$typeof===w&&v(we)===be.type){f($,be.sibling),W=y(be,Q.props),W.ref=qr($,be,Q),W.return=$,$=W;break e}f($,be);break}else u($,be);be=be.sibling}Q.type===p?(W=Va(Q.props.children,$.mode,ce,Q.key),W.return=$,$=W):(ce=Tp(Q.type,Q.key,Q.props,null,$.mode,ce),ce.ref=qr($,W,Q),ce.return=$,$=ce)}return L($);case d:e:{for(be=Q.key;W!==null;){if(W.key===be)if(W.tag===4&&W.stateNode.containerInfo===Q.containerInfo&&W.stateNode.implementation===Q.implementation){f($,W.sibling),W=y(W,Q.children||[]),W.return=$,$=W;break e}else{f($,W);break}else u($,W);W=W.sibling}W=Dy(Q,$.mode,ce),W.return=$,$=W}return L($);case w:return be=Q._init,Ts($,W,be(Q._payload),ce)}if(se(Q))return mt($,W,Q,ce);if(U(Q))return Ir($,W,Q,ce);h($,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"?(Q=""+Q,W!==null&&W.tag===6?(f($,W.sibling),W=y(W,Q),W.return=$,$=W):(f($,W),W=Ny(Q,$.mode,ce),W.return=$,$=W),L($)):f($,W)}return Ts}var O=I(!0),H=I(!1),K=ci(null),re=null,Ye=null,Bt=null;function je(){Bt=Ye=re=null}function nn(a,u,f){Ke?(at(K,u._currentValue),u._currentValue=f):(at(K,u._currentValue2),u._currentValue2=f)}function qt(a){var u=K.current;ht(K),Ke?a._currentValue=u:a._currentValue2=u}function ji(a,u,f){for(;a!==null;){var g=a.alternate;if((a.childLanes&u)!==u?(a.childLanes|=u,g!==null&&(g.childLanes|=u)):g!==null&&(g.childLanes&u)!==u&&(g.childLanes|=u),a===f)break;a=a.return}}function pn(a,u){re=a,Bt=Ye=null,a=a.dependencies,a!==null&&a.firstContext!==null&&(a.lanes&u&&(Sr=!0),a.firstContext=null)}function An(a){var u=Ke?a._currentValue:a._currentValue2;if(Bt!==a)if(a={context:a,memoizedValue:u,next:null},Ye===null){if(re===null)throw Error(o(308));Ye=a,re.dependencies={lanes:0,firstContext:a}}else Ye=Ye.next=a;return u}var pi=null;function z_(a){pi===null?pi=[a]:pi.push(a)}function CS(a,u,f,g){var y=u.interleaved;return y===null?(f.next=f,z_(u)):(f.next=y.next,y.next=f),u.interleaved=f,Gi(a,g)}function Gi(a,u){a.lanes|=u;var f=a.alternate;for(f!==null&&(f.lanes|=u),f=a,a=a.return;a!==null;)a.childLanes|=u,f=a.alternate,f!==null&&(f.childLanes|=u),f=a,a=a.return;return f.tag===3?f.stateNode:null}var fo=!1;function j_(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function IS(a,u){a=a.updateQueue,u.updateQueue===a&&(u.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function ws(a,u){return{eventTime:a,lane:u,tag:0,payload:null,callback:null,next:null}}function po(a,u,f){var g=a.updateQueue;if(g===null)return null;if(g=g.shared,Le&2){var y=g.pending;return y===null?u.next=u:(u.next=y.next,y.next=u),g.pending=u,Gi(a,f)}return y=g.interleaved,y===null?(u.next=u,z_(g)):(u.next=y.next,y.next=u),g.interleaved=u,Gi(a,f)}function Qf(a,u,f){if(u=u.updateQueue,u!==null&&(u=u.shared,(f&4194240)!==0)){var g=u.lanes;g&=a.pendingLanes,f|=g,u.lanes=f,Gl(a,f)}}function PS(a,u){var f=a.updateQueue,g=a.alternate;if(g!==null&&(g=g.updateQueue,f===g)){var y=null,T=null;if(f=f.firstBaseUpdate,f!==null){do{var L={eventTime:f.eventTime,lane:f.lane,tag:f.tag,payload:f.payload,callback:f.callback,next:null};T===null?y=T=L:T=T.next=L,f=f.next}while(f!==null);T===null?y=T=u:T=T.next=u}else y=T=u;f={baseState:g.baseState,firstBaseUpdate:y,lastBaseUpdate:T,shared:g.shared,effects:g.effects},a.updateQueue=f;return}a=f.lastBaseUpdate,a===null?f.firstBaseUpdate=u:a.next=u,f.lastBaseUpdate=u}function Yf(a,u,f,g){var y=a.updateQueue;fo=!1;var T=y.firstBaseUpdate,L=y.lastBaseUpdate,G=y.shared.pending;if(G!==null){y.shared.pending=null;var q=G,te=q.next;q.next=null,L===null?T=te:L.next=te,L=q;var ge=a.alternate;ge!==null&&(ge=ge.updateQueue,G=ge.lastBaseUpdate,G!==L&&(G===null?ge.firstBaseUpdate=te:G.next=te,ge.lastBaseUpdate=q))}if(T!==null){var Ae=y.baseState;L=0,ge=te=q=null,G=T;do{var le=G.lane,St=G.eventTime;if((g&le)===le){ge!==null&&(ge=ge.next={eventTime:St,lane:0,tag:G.tag,payload:G.payload,callback:G.callback,next:null});e:{var mt=a,Ir=G;switch(le=u,St=f,Ir.tag){case 1:if(mt=Ir.payload,typeof mt=="function"){Ae=mt.call(St,Ae,le);break e}Ae=mt;break e;case 3:mt.flags=mt.flags&-65537|128;case 0:if(mt=Ir.payload,le=typeof mt=="function"?mt.call(St,Ae,le):mt,le==null)break e;Ae=s({},Ae,le);break e;case 2:fo=!0}}G.callback!==null&&G.lane!==0&&(a.flags|=64,le=y.effects,le===null?y.effects=[G]:le.push(G))}else St={eventTime:St,lane:le,tag:G.tag,payload:G.payload,callback:G.callback,next:null},ge===null?(te=ge=St,q=Ae):ge=ge.next=St,L|=le;if(G=G.next,G===null){if(G=y.shared.pending,G===null)break;le=G,G=le.next,le.next=null,y.lastBaseUpdate=le,y.shared.pending=null}}while(!0);if(ge===null&&(q=Ae),y.baseState=q,y.firstBaseUpdate=te,y.lastBaseUpdate=ge,u=y.shared.interleaved,u!==null){y=u;do L|=y.lane,y=y.next;while(y!==u)}else T===null&&(y.shared.lanes=0);Oa|=L,a.lanes=L,a.memoizedState=Ae}}function kS(a,u,f){if(a=u.effects,u.effects=null,a!==null)for(u=0;u<a.length;u++){var g=a[u],y=g.callback;if(y!==null){if(g.callback=null,g=f,typeof y!="function")throw Error(o(191,y));y.call(g)}}}var Yc={},Kr=ci(Yc),Xc=ci(Yc),Yl=ci(Yc);function Wi(a){if(a===Yc)throw Error(o(174));return a}function G_(a,u){at(Yl,u),at(Xc,a),at(Kr,Yc),a=De(u),ht(Kr),at(Kr,a)}function Xl(){ht(Kr),ht(Xc),ht(Yl)}function RS(a){var u=Wi(Yl.current),f=Wi(Kr.current);u=Y(f,a.type,u),f!==u&&(at(Xc,a),at(Kr,u))}function W_(a){Xc.current===a&&(ht(Kr),ht(Xc))}var At=ci(0);function Xf(a){for(var u=a;u!==null;){if(u.tag===13){var f=u.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||ao(f)||Lc(f)))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if(u.flags&128)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===a)break;for(;u.sibling===null;){if(u.return===null||u.return===a)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var H_=[];function $_(){for(var a=0;a<H_.length;a++){var u=H_[a];Ke?u._workInProgressVersionPrimary=null:u._workInProgressVersionSecondary=null}H_.length=0}var Jf=l.ReactCurrentDispatcher,q_=l.ReactCurrentBatchConfig,ba=0,Nt=null,rn=null,gn=null,Zf=!1,Jc=!1,Zc=0,Wx=0;function Hn(){throw Error(o(321))}function K_(a,u){if(u===null)return!1;for(var f=0;f<u.length&&f<a.length;f++)if(!Qe(a[f],u[f]))return!1;return!0}function Q_(a,u,f,g,y,T){if(ba=T,Nt=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,Jf.current=a===null||a.memoizedState===null?Kx:Qx,a=f(g,y),Jc){T=0;do{if(Jc=!1,Zc=0,25<=T)throw Error(o(301));T+=1,gn=rn=null,u.updateQueue=null,Jf.current=Yx,a=f(g,y)}while(Jc)}if(Jf.current=np,u=rn!==null&&rn.next!==null,ba=0,gn=rn=Nt=null,Zf=!1,u)throw Error(o(300));return a}function Y_(){var a=Zc!==0;return Zc=0,a}function Hi(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gn===null?Nt.memoizedState=gn=a:gn=gn.next=a,gn}function Qr(){if(rn===null){var a=Nt.alternate;a=a!==null?a.memoizedState:null}else a=rn.next;var u=gn===null?Nt.memoizedState:gn.next;if(u!==null)gn=u,rn=a;else{if(a===null)throw Error(o(310));rn=a,a={memoizedState:rn.memoizedState,baseState:rn.baseState,baseQueue:rn.baseQueue,queue:rn.queue,next:null},gn===null?Nt.memoizedState=gn=a:gn=gn.next=a}return gn}function eh(a,u){return typeof u=="function"?u(a):u}function X_(a){var u=Qr(),f=u.queue;if(f===null)throw Error(o(311));f.lastRenderedReducer=a;var g=rn,y=g.baseQueue,T=f.pending;if(T!==null){if(y!==null){var L=y.next;y.next=T.next,T.next=L}g.baseQueue=y=T,f.pending=null}if(y!==null){T=y.next,g=g.baseState;var G=L=null,q=null,te=T;do{var ge=te.lane;if((ba&ge)===ge)q!==null&&(q=q.next={lane:0,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null}),g=te.hasEagerState?te.eagerState:a(g,te.action);else{var Ae={lane:ge,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null};q===null?(G=q=Ae,L=g):q=q.next=Ae,Nt.lanes|=ge,Oa|=ge}te=te.next}while(te!==null&&te!==T);q===null?L=g:q.next=G,Qe(g,u.memoizedState)||(Sr=!0),u.memoizedState=g,u.baseState=L,u.baseQueue=q,f.lastRenderedState=g}if(a=f.interleaved,a!==null){y=a;do T=y.lane,Nt.lanes|=T,Oa|=T,y=y.next;while(y!==a)}else y===null&&(f.lanes=0);return[u.memoizedState,f.dispatch]}function J_(a){var u=Qr(),f=u.queue;if(f===null)throw Error(o(311));f.lastRenderedReducer=a;var g=f.dispatch,y=f.pending,T=u.memoizedState;if(y!==null){f.pending=null;var L=y=y.next;do T=a(T,L.action),L=L.next;while(L!==y);Qe(T,u.memoizedState)||(Sr=!0),u.memoizedState=T,u.baseQueue===null&&(u.baseState=T),f.lastRenderedState=T}return[T,g]}function xS(){}function AS(a,u){var f=Nt,g=Qr(),y=u(),T=!Qe(g.memoizedState,y);if(T&&(g.memoizedState=y,Sr=!0),g=g.queue,Z_(bS.bind(null,f,g,a),[a]),g.getSnapshot!==u||T||gn!==null&&gn.memoizedState.tag&1){if(f.flags|=2048,th(9,DS.bind(null,f,g,y,u),void 0,null),mn===null)throw Error(o(349));ba&30||NS(f,u,y)}return y}function NS(a,u,f){a.flags|=16384,a={getSnapshot:u,value:f},u=Nt.updateQueue,u===null?(u={lastEffect:null,stores:null},Nt.updateQueue=u,u.stores=[a]):(f=u.stores,f===null?u.stores=[a]:f.push(a))}function DS(a,u,f,g){u.value=f,u.getSnapshot=g,OS(u)&&MS(a)}function bS(a,u,f){return f(function(){OS(u)&&MS(a)})}function OS(a){var u=a.getSnapshot;a=a.value;try{var f=u();return!Qe(a,f)}catch{return!0}}function MS(a){var u=Gi(a,1);u!==null&&Yr(u,a,1,-1)}function LS(a){var u=Hi();return typeof a=="function"&&(a=a()),u.memoizedState=u.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:eh,lastRenderedState:a},u.queue=a,a=a.dispatch=qx.bind(null,Nt,a),[u.memoizedState,a]}function th(a,u,f,g){return a={tag:a,create:u,destroy:f,deps:g,next:null},u=Nt.updateQueue,u===null?(u={lastEffect:null,stores:null},Nt.updateQueue=u,u.lastEffect=a.next=a):(f=u.lastEffect,f===null?u.lastEffect=a.next=a:(g=f.next,f.next=a,a.next=g,u.lastEffect=a)),a}function FS(){return Qr().memoizedState}function ep(a,u,f,g){var y=Hi();Nt.flags|=a,y.memoizedState=th(1|u,f,void 0,g===void 0?null:g)}function tp(a,u,f,g){var y=Qr();g=g===void 0?null:g;var T=void 0;if(rn!==null){var L=rn.memoizedState;if(T=L.destroy,g!==null&&K_(g,L.deps)){y.memoizedState=th(u,f,T,g);return}}Nt.flags|=a,y.memoizedState=th(1|u,f,T,g)}function VS(a,u){return ep(8390656,8,a,u)}function Z_(a,u){return tp(2048,8,a,u)}function US(a,u){return tp(4,2,a,u)}function BS(a,u){return tp(4,4,a,u)}function zS(a,u){if(typeof u=="function")return a=a(),u(a),function(){u(null)};if(u!=null)return a=a(),u.current=a,function(){u.current=null}}function jS(a,u,f){return f=f!=null?f.concat([a]):null,tp(4,4,zS.bind(null,u,a),f)}function ey(){}function GS(a,u){var f=Qr();u=u===void 0?null:u;var g=f.memoizedState;return g!==null&&u!==null&&K_(u,g[1])?g[0]:(f.memoizedState=[a,u],a)}function WS(a,u){var f=Qr();u=u===void 0?null:u;var g=f.memoizedState;return g!==null&&u!==null&&K_(u,g[1])?g[0]:(a=a(),f.memoizedState=[a,u],a)}function HS(a,u,f){return ba&21?(Qe(f,u)||(f=zf(),Nt.lanes|=f,Oa|=f,a.baseState=!0),u):(a.baseState&&(a.baseState=!1,Sr=!0),a.memoizedState=f)}function Hx(a,u){var f=$e;$e=f!==0&&4>f?f:4,a(!0);var g=q_.transition;q_.transition={};try{a(!1),u()}finally{$e=f,q_.transition=g}}function $S(){return Qr().memoizedState}function $x(a,u,f){var g=_o(a);if(f={lane:g,action:f,hasEagerState:!1,eagerState:null,next:null},qS(a))KS(u,f);else if(f=CS(a,u,f,g),f!==null){var y=Kn();Yr(f,a,g,y),QS(f,u,g)}}function qx(a,u,f){var g=_o(a),y={lane:g,action:f,hasEagerState:!1,eagerState:null,next:null};if(qS(a))KS(u,y);else{var T=a.alternate;if(a.lanes===0&&(T===null||T.lanes===0)&&(T=u.lastRenderedReducer,T!==null))try{var L=u.lastRenderedState,G=T(L,f);if(y.hasEagerState=!0,y.eagerState=G,Qe(G,L)){var q=u.interleaved;q===null?(y.next=y,z_(u)):(y.next=q.next,q.next=y),u.interleaved=y;return}}catch{}finally{}f=CS(a,u,y,g),f!==null&&(y=Kn(),Yr(f,a,g,y),QS(f,u,g))}}function qS(a){var u=a.alternate;return a===Nt||u!==null&&u===Nt}function KS(a,u){Jc=Zf=!0;var f=a.pending;f===null?u.next=u:(u.next=f.next,f.next=u),a.pending=u}function QS(a,u,f){if(f&4194240){var g=u.lanes;g&=a.pendingLanes,f|=g,u.lanes=f,Gl(a,f)}}var np={readContext:An,useCallback:Hn,useContext:Hn,useEffect:Hn,useImperativeHandle:Hn,useInsertionEffect:Hn,useLayoutEffect:Hn,useMemo:Hn,useReducer:Hn,useRef:Hn,useState:Hn,useDebugValue:Hn,useDeferredValue:Hn,useTransition:Hn,useMutableSource:Hn,useSyncExternalStore:Hn,useId:Hn,unstable_isNewReconciler:!1},Kx={readContext:An,useCallback:function(a,u){return Hi().memoizedState=[a,u===void 0?null:u],a},useContext:An,useEffect:VS,useImperativeHandle:function(a,u,f){return f=f!=null?f.concat([a]):null,ep(4194308,4,zS.bind(null,u,a),f)},useLayoutEffect:function(a,u){return ep(4194308,4,a,u)},useInsertionEffect:function(a,u){return ep(4,2,a,u)},useMemo:function(a,u){var f=Hi();return u=u===void 0?null:u,a=a(),f.memoizedState=[a,u],a},useReducer:function(a,u,f){var g=Hi();return u=f!==void 0?f(u):u,g.memoizedState=g.baseState=u,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:u},g.queue=a,a=a.dispatch=$x.bind(null,Nt,a),[g.memoizedState,a]},useRef:function(a){var u=Hi();return a={current:a},u.memoizedState=a},useState:LS,useDebugValue:ey,useDeferredValue:function(a){return Hi().memoizedState=a},useTransition:function(){var a=LS(!1),u=a[0];return a=Hx.bind(null,a[1]),Hi().memoizedState=a,[u,a]},useMutableSource:function(){},useSyncExternalStore:function(a,u,f){var g=Nt,y=Hi();if(dt){if(f===void 0)throw Error(o(407));f=f()}else{if(f=u(),mn===null)throw Error(o(349));ba&30||NS(g,u,f)}y.memoizedState=f;var T={value:f,getSnapshot:u};return y.queue=T,VS(bS.bind(null,g,T,a),[a]),g.flags|=2048,th(9,DS.bind(null,g,T,f,u),void 0,null),f},useId:function(){var a=Hi(),u=mn.identifierPrefix;if(dt){var f=Hr,g=wr;f=(g&~(1<<32-zn(g)-1)).toString(32)+f,u=":"+u+"R"+f,f=Zc++,0<f&&(u+="H"+f.toString(32)),u+=":"}else f=Wx++,u=":"+u+"r"+f.toString(32)+":";return a.memoizedState=u},unstable_isNewReconciler:!1},Qx={readContext:An,useCallback:GS,useContext:An,useEffect:Z_,useImperativeHandle:jS,useInsertionEffect:US,useLayoutEffect:BS,useMemo:WS,useReducer:X_,useRef:FS,useState:function(){return X_(eh)},useDebugValue:ey,useDeferredValue:function(a){var u=Qr();return HS(u,rn.memoizedState,a)},useTransition:function(){var a=X_(eh)[0],u=Qr().memoizedState;return[a,u]},useMutableSource:xS,useSyncExternalStore:AS,useId:$S,unstable_isNewReconciler:!1},Yx={readContext:An,useCallback:GS,useContext:An,useEffect:Z_,useImperativeHandle:jS,useInsertionEffect:US,useLayoutEffect:BS,useMemo:WS,useReducer:J_,useRef:FS,useState:function(){return J_(eh)},useDebugValue:ey,useDeferredValue:function(a){var u=Qr();return rn===null?u.memoizedState=a:HS(u,rn.memoizedState,a)},useTransition:function(){var a=J_(eh)[0],u=Qr().memoizedState;return[a,u]},useMutableSource:xS,useSyncExternalStore:AS,useId:$S,unstable_isNewReconciler:!1};function gi(a,u){if(a&&a.defaultProps){u=s({},u),a=a.defaultProps;for(var f in a)u[f]===void 0&&(u[f]=a[f]);return u}return u}function ty(a,u,f,g){u=a.memoizedState,f=f(g,u),f=f==null?u:s({},u,f),a.memoizedState=f,a.lanes===0&&(a.updateQueue.baseState=f)}var rp={isMounted:function(a){return(a=a._reactInternals)?b(a)===a:!1},enqueueSetState:function(a,u,f){a=a._reactInternals;var g=Kn(),y=_o(a),T=ws(g,y);T.payload=u,f!=null&&(T.callback=f),u=po(a,T,y),u!==null&&(Yr(u,a,y,g),Qf(u,a,y))},enqueueReplaceState:function(a,u,f){a=a._reactInternals;var g=Kn(),y=_o(a),T=ws(g,y);T.tag=1,T.payload=u,f!=null&&(T.callback=f),u=po(a,T,y),u!==null&&(Yr(u,a,y,g),Qf(u,a,y))},enqueueForceUpdate:function(a,u){a=a._reactInternals;var f=Kn(),g=_o(a),y=ws(f,g);y.tag=2,u!=null&&(y.callback=u),u=po(a,y,g),u!==null&&(Yr(u,a,g,f),Qf(u,a,g))}};function YS(a,u,f,g,y,T,L){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(g,T,L):u.prototype&&u.prototype.isPureReactComponent?!Da(f,g)||!Da(y,T):!0}function XS(a,u,f){var g=!1,y=Wr,T=u.contextType;return typeof T=="object"&&T!==null?T=An(T):(y=xn(u)?fs:tn.current,g=u.contextTypes,T=(g=g!=null)?uo(a,y):Wr),u=new u(f,T),a.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,u.updater=rp,a.stateNode=u,u._reactInternals=a,g&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=y,a.__reactInternalMemoizedMaskedChildContext=T),u}function JS(a,u,f,g){a=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(f,g),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(f,g),u.state!==a&&rp.enqueueReplaceState(u,u.state,null)}function ny(a,u,f,g){var y=a.stateNode;y.props=f,y.state=a.memoizedState,y.refs={},j_(a);var T=u.contextType;typeof T=="object"&&T!==null?y.context=An(T):(T=xn(u)?fs:tn.current,y.context=uo(a,T)),y.state=a.memoizedState,T=u.getDerivedStateFromProps,typeof T=="function"&&(ty(a,u,T,f),y.state=a.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(u=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),u!==y.state&&rp.enqueueReplaceState(y,y.state,null),Yf(a,f,y,g),y.state=a.memoizedState),typeof y.componentDidMount=="function"&&(a.flags|=4194308)}function Jl(a,u){try{var f="",g=u;do f+=Kf(g),g=g.return;while(g);var y=f}catch(T){y=`
Error generating stack: `+T.message+`
`+T.stack}return{value:a,source:u,stack:y,digest:null}}function ry(a,u,f){return{value:a,source:null,stack:f??null,digest:u??null}}function iy(a,u){try{console.error(u.value)}catch(f){setTimeout(function(){throw f})}}var Xx=typeof WeakMap=="function"?WeakMap:Map;function ZS(a,u,f){f=ws(-1,f),f.tag=3,f.payload={element:null};var g=u.value;return f.callback=function(){_p||(_p=!0,Cy=g),iy(a,u)},f}function e4(a,u,f){f=ws(-1,f),f.tag=3;var g=a.type.getDerivedStateFromError;if(typeof g=="function"){var y=u.value;f.payload=function(){return g(y)},f.callback=function(){iy(a,u)}}var T=a.stateNode;return T!==null&&typeof T.componentDidCatch=="function"&&(f.callback=function(){iy(a,u),typeof g!="function"&&(go===null?go=new Set([this]):go.add(this));var L=u.stack;this.componentDidCatch(u.value,{componentStack:L!==null?L:""})}),f}function t4(a,u,f){var g=a.pingCache;if(g===null){g=a.pingCache=new Xx;var y=new Set;g.set(u,y)}else y=g.get(u),y===void 0&&(y=new Set,g.set(u,y));y.has(f)||(y.add(f),a=hA.bind(null,a,u,f),u.then(a,a))}function n4(a){do{var u;if((u=a.tag===13)&&(u=a.memoizedState,u=u!==null?u.dehydrated!==null:!0),u)return a;a=a.return}while(a!==null);return null}function r4(a,u,f,g,y){return a.mode&1?(a.flags|=65536,a.lanes=y,a):(a===u?a.flags|=65536:(a.flags|=128,f.flags|=131072,f.flags&=-52805,f.tag===1&&(f.alternate===null?f.tag=17:(u=ws(-1,1),u.tag=2,po(f,u,1))),f.lanes|=1),a)}var Jx=l.ReactCurrentOwner,Sr=!1;function hr(a,u,f,g){u.child=a===null?H(u,null,f,g):O(u,a.child,f,g)}function i4(a,u,f,g,y){f=f.render;var T=u.ref;return pn(u,y),g=Q_(a,u,f,g,T,y),f=Y_(),a!==null&&!Sr?(u.updateQueue=a.updateQueue,u.flags&=-2053,a.lanes&=~y,Es(a,u,y)):(dt&&f&&Kl(u),u.flags|=1,hr(a,u,g,y),u.child)}function s4(a,u,f,g,y){if(a===null){var T=f.type;return typeof T=="function"&&!Ay(T)&&T.defaultProps===void 0&&f.compare===null&&f.defaultProps===void 0?(u.tag=15,u.type=T,o4(a,u,T,g,y)):(a=Tp(f.type,null,g,u,u.mode,y),a.ref=u.ref,a.return=u,u.child=a)}if(T=a.child,!(a.lanes&y)){var L=T.memoizedProps;if(f=f.compare,f=f!==null?f:Da,f(L,g)&&a.ref===u.ref)return Es(a,u,y)}return u.flags|=1,a=vo(T,g),a.ref=u.ref,a.return=u,u.child=a}function o4(a,u,f,g,y){if(a!==null){var T=a.memoizedProps;if(Da(T,g)&&a.ref===u.ref)if(Sr=!1,u.pendingProps=g=T,(a.lanes&y)!==0)a.flags&131072&&(Sr=!0);else return u.lanes=a.lanes,Es(a,u,y)}return sy(a,u,f,g,y)}function a4(a,u,f){var g=u.pendingProps,y=g.children,T=a!==null?a.memoizedState:null;if(g.mode==="hidden")if(!(u.mode&1))u.memoizedState={baseLanes:0,cachePool:null,transitions:null},at(eu,Mr),Mr|=f;else{if(!(f&1073741824))return a=T!==null?T.baseLanes|f:f,u.lanes=u.childLanes=1073741824,u.memoizedState={baseLanes:a,cachePool:null,transitions:null},u.updateQueue=null,at(eu,Mr),Mr|=a,null;u.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=T!==null?T.baseLanes:f,at(eu,Mr),Mr|=g}else T!==null?(g=T.baseLanes|f,u.memoizedState=null):g=f,at(eu,Mr),Mr|=g;return hr(a,u,y,f),u.child}function l4(a,u){var f=u.ref;(a===null&&f!==null||a!==null&&a.ref!==f)&&(u.flags|=512,u.flags|=2097152)}function sy(a,u,f,g,y){var T=xn(f)?fs:tn.current;return T=uo(u,T),pn(u,y),f=Q_(a,u,f,g,T,y),g=Y_(),a!==null&&!Sr?(u.updateQueue=a.updateQueue,u.flags&=-2053,a.lanes&=~y,Es(a,u,y)):(dt&&g&&Kl(u),u.flags|=1,hr(a,u,f,y),u.child)}function u4(a,u,f,g,y){if(xn(f)){var T=!0;yr(u)}else T=!1;if(pn(u,y),u.stateNode===null)sp(a,u),XS(u,f,g),ny(u,f,g,y),g=!0;else if(a===null){var L=u.stateNode,G=u.memoizedProps;L.props=G;var q=L.context,te=f.contextType;typeof te=="object"&&te!==null?te=An(te):(te=xn(f)?fs:tn.current,te=uo(u,te));var ge=f.getDerivedStateFromProps,Ae=typeof ge=="function"||typeof L.getSnapshotBeforeUpdate=="function";Ae||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(G!==g||q!==te)&&JS(u,L,g,te),fo=!1;var le=u.memoizedState;L.state=le,Yf(u,g,L,y),q=u.memoizedState,G!==g||le!==q||Rn.current||fo?(typeof ge=="function"&&(ty(u,f,ge,g),q=u.memoizedState),(G=fo||YS(u,f,G,g,le,q,te))?(Ae||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount()),typeof L.componentDidMount=="function"&&(u.flags|=4194308)):(typeof L.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=g,u.memoizedState=q),L.props=g,L.state=q,L.context=te,g=G):(typeof L.componentDidMount=="function"&&(u.flags|=4194308),g=!1)}else{L=u.stateNode,IS(a,u),G=u.memoizedProps,te=u.type===u.elementType?G:gi(u.type,G),L.props=te,Ae=u.pendingProps,le=L.context,q=f.contextType,typeof q=="object"&&q!==null?q=An(q):(q=xn(f)?fs:tn.current,q=uo(u,q));var St=f.getDerivedStateFromProps;(ge=typeof St=="function"||typeof L.getSnapshotBeforeUpdate=="function")||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(G!==Ae||le!==q)&&JS(u,L,g,q),fo=!1,le=u.memoizedState,L.state=le,Yf(u,g,L,y);var mt=u.memoizedState;G!==Ae||le!==mt||Rn.current||fo?(typeof St=="function"&&(ty(u,f,St,g),mt=u.memoizedState),(te=fo||YS(u,f,te,g,le,mt,q)||!1)?(ge||typeof L.UNSAFE_componentWillUpdate!="function"&&typeof L.componentWillUpdate!="function"||(typeof L.componentWillUpdate=="function"&&L.componentWillUpdate(g,mt,q),typeof L.UNSAFE_componentWillUpdate=="function"&&L.UNSAFE_componentWillUpdate(g,mt,q)),typeof L.componentDidUpdate=="function"&&(u.flags|=4),typeof L.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof L.componentDidUpdate!="function"||G===a.memoizedProps&&le===a.memoizedState||(u.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||G===a.memoizedProps&&le===a.memoizedState||(u.flags|=1024),u.memoizedProps=g,u.memoizedState=mt),L.props=g,L.state=mt,L.context=q,g=te):(typeof L.componentDidUpdate!="function"||G===a.memoizedProps&&le===a.memoizedState||(u.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||G===a.memoizedProps&&le===a.memoizedState||(u.flags|=1024),g=!1)}return oy(a,u,f,g,T,y)}function oy(a,u,f,g,y,T){l4(a,u);var L=(u.flags&128)!==0;if(!g&&!L)return y&&Pa(u,f,!1),Es(a,u,T);g=u.stateNode,Jx.current=u;var G=L&&typeof f.getDerivedStateFromError!="function"?null:g.render();return u.flags|=1,a!==null&&L?(u.child=O(u,a.child,null,T),u.child=O(u,null,G,T)):hr(a,u,G,T),u.memoizedState=g.state,y&&Pa(u,f,!0),u.child}function c4(a){var u=a.stateNode;u.pendingContext?Uf(a,u.pendingContext,u.pendingContext!==u.context):u.context&&Uf(a,u.context,!1),G_(a,u.containerInfo)}function h4(a,u,f,g,y){return vs(),ho(y),u.flags|=256,hr(a,u,f,g),u.child}var ay={dehydrated:null,treeContext:null,retryLane:0};function ly(a){return{baseLanes:a,cachePool:null,transitions:null}}function d4(a,u,f){var g=u.pendingProps,y=At.current,T=!1,L=(u.flags&128)!==0,G;if((G=L)||(G=a!==null&&a.memoizedState===null?!1:(y&2)!==0),G?(T=!0,u.flags&=-129):(a===null||a.memoizedState!==null)&&(y|=1),at(At,y&1),a===null)return fi(u),a=u.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?(u.mode&1?Lc(a)?u.lanes=8:u.lanes=1073741824:u.lanes=1,null):(L=g.children,a=g.fallback,T?(g=u.mode,T=u.child,L={mode:"hidden",children:L},!(g&1)&&T!==null?(T.childLanes=0,T.pendingProps=L):T=Cp(L,g,0,null),a=Va(a,g,f,null),T.return=u,a.return=u,T.sibling=a,u.child=T,u.child.memoizedState=ly(f),u.memoizedState=ay,a):uy(u,L));if(y=a.memoizedState,y!==null&&(G=y.dehydrated,G!==null))return Zx(a,u,L,g,G,y,f);if(T){T=g.fallback,L=u.mode,y=a.child,G=y.sibling;var q={mode:"hidden",children:g.children};return!(L&1)&&u.child!==y?(g=u.child,g.childLanes=0,g.pendingProps=q,u.deletions=null):(g=vo(y,q),g.subtreeFlags=y.subtreeFlags&14680064),G!==null?T=vo(G,T):(T=Va(T,L,f,null),T.flags|=2),T.return=u,g.return=u,g.sibling=T,u.child=g,g=T,T=u.child,L=a.child.memoizedState,L=L===null?ly(f):{baseLanes:L.baseLanes|f,cachePool:null,transitions:L.transitions},T.memoizedState=L,T.childLanes=a.childLanes&~f,u.memoizedState=ay,g}return T=a.child,a=T.sibling,g=vo(T,{mode:"visible",children:g.children}),!(u.mode&1)&&(g.lanes=f),g.return=u,g.sibling=null,a!==null&&(f=u.deletions,f===null?(u.deletions=[a],u.flags|=16):f.push(a)),u.child=g,u.memoizedState=null,g}function uy(a,u){return u=Cp({mode:"visible",children:u},a.mode,0,null),u.return=a,a.child=u}function ip(a,u,f,g){return g!==null&&ho(g),O(u,a.child,null,f),a=uy(u,u.pendingProps.children),a.flags|=2,u.memoizedState=null,a}function Zx(a,u,f,g,y,T,L){if(f)return u.flags&256?(u.flags&=-257,g=ry(Error(o(422))),ip(a,u,L,g)):u.memoizedState!==null?(u.child=a.child,u.flags|=128,null):(T=g.fallback,y=u.mode,g=Cp({mode:"visible",children:g.children},y,0,null),T=Va(T,y,L,null),T.flags|=2,g.return=u,T.return=u,g.sibling=T,u.child=g,u.mode&1&&O(u,a.child,null,L),u.child.memoizedState=ly(L),u.memoizedState=ay,T);if(!(u.mode&1))return ip(a,u,L,null);if(Lc(y))return g=M_(y).digest,T=Error(o(419)),g=ry(T,g,void 0),ip(a,u,L,g);if(f=(L&a.childLanes)!==0,Sr||f){if(g=mn,g!==null){switch(L&-L){case 4:y=2;break;case 16:y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:y=32;break;case 536870912:y=268435456;break;default:y=0}y=y&(g.suspendedLanes|L)?0:y,y!==0&&y!==T.retryLane&&(T.retryLane=y,Gi(a,y),Yr(g,a,y,-1))}return xy(),g=ry(Error(o(421))),ip(a,u,L,g)}return ao(y)?(u.flags|=128,u.child=a.child,u=dA.bind(null,a),lo(y,u),null):(a=T.treeContext,lt&&(ur=Of(y),Wn=u,dt=!0,Er=null,ys=!1,a!==null&&(fn[lr++]=wr,fn[lr++]=Hr,fn[lr++]=di,wr=a.id,Hr=a.overflow,di=u)),u=uy(u,g.children),u.flags|=4096,u)}function f4(a,u,f){a.lanes|=u;var g=a.alternate;g!==null&&(g.lanes|=u),ji(a.return,u,f)}function cy(a,u,f,g,y){var T=a.memoizedState;T===null?a.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:g,tail:f,tailMode:y}:(T.isBackwards=u,T.rendering=null,T.renderingStartTime=0,T.last=g,T.tail=f,T.tailMode=y)}function p4(a,u,f){var g=u.pendingProps,y=g.revealOrder,T=g.tail;if(hr(a,u,g.children,f),g=At.current,g&2)g=g&1|2,u.flags|=128;else{if(a!==null&&a.flags&128)e:for(a=u.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&f4(a,f,u);else if(a.tag===19)f4(a,f,u);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===u)break e;for(;a.sibling===null;){if(a.return===null||a.return===u)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}g&=1}if(at(At,g),!(u.mode&1))u.memoizedState=null;else switch(y){case"forwards":for(f=u.child,y=null;f!==null;)a=f.alternate,a!==null&&Xf(a)===null&&(y=f),f=f.sibling;f=y,f===null?(y=u.child,u.child=null):(y=f.sibling,f.sibling=null),cy(u,!1,y,f,T);break;case"backwards":for(f=null,y=u.child,u.child=null;y!==null;){if(a=y.alternate,a!==null&&Xf(a)===null){u.child=y;break}a=y.sibling,y.sibling=f,f=y,y=a}cy(u,!0,f,null,T);break;case"together":cy(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function sp(a,u){!(u.mode&1)&&a!==null&&(a.alternate=null,u.alternate=null,u.flags|=2)}function Es(a,u,f){if(a!==null&&(u.dependencies=a.dependencies),Oa|=u.lanes,!(f&u.childLanes))return null;if(a!==null&&u.child!==a.child)throw Error(o(153));if(u.child!==null){for(a=u.child,f=vo(a,a.pendingProps),u.child=f,f.return=u;a.sibling!==null;)a=a.sibling,f=f.sibling=vo(a,a.pendingProps),f.return=u;f.sibling=null}return u.child}function eA(a,u,f){switch(u.tag){case 3:c4(u),vs();break;case 5:RS(u);break;case 1:xn(u.type)&&yr(u);break;case 4:G_(u,u.stateNode.containerInfo);break;case 10:nn(u,u.type._context,u.memoizedProps.value);break;case 13:var g=u.memoizedState;if(g!==null)return g.dehydrated!==null?(at(At,At.current&1),u.flags|=128,null):f&u.child.childLanes?d4(a,u,f):(at(At,At.current&1),a=Es(a,u,f),a!==null?a.sibling:null);at(At,At.current&1);break;case 19:if(g=(f&u.childLanes)!==0,a.flags&128){if(g)return p4(a,u,f);u.flags|=128}var y=u.memoizedState;if(y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),at(At,At.current),g)break;return null;case 22:case 23:return u.lanes=0,a4(a,u,f)}return Es(a,u,f)}function $i(a){a.flags|=4}function g4(a,u){if(a!==null&&a.child===u.child)return!0;if(u.flags&16)return!1;for(a=u.child;a!==null;){if(a.flags&12854||a.subtreeFlags&12854)return!1;a=a.sibling}return!0}var nh,rh,op,ap;if(ke)nh=function(a,u){for(var f=u.child;f!==null;){if(f.tag===5||f.tag===6)pe(a,f.stateNode);else if(f.tag!==4&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===u)break;for(;f.sibling===null;){if(f.return===null||f.return===u)return;f=f.return}f.sibling.return=f.return,f=f.sibling}},rh=function(){},op=function(a,u,f,g,y){if(a=a.memoizedProps,a!==g){var T=u.stateNode,L=Wi(Kr.current);f=en(T,f,a,g,y,L),(u.updateQueue=f)&&$i(u)}},ap=function(a,u,f,g){f!==g&&$i(u)};else if(ot){nh=function(a,u,f,g){for(var y=u.child;y!==null;){if(y.tag===5){var T=y.stateNode;f&&g&&(T=oo(T,y.type,y.memoizedProps,y)),pe(a,T)}else if(y.tag===6)T=y.stateNode,f&&g&&(T=Mc(T,y.memoizedProps,y)),pe(a,T);else if(y.tag!==4){if(y.tag===22&&y.memoizedState!==null)T=y.child,T!==null&&(T.return=y),nh(a,y,!0,!0);else if(y.child!==null){y.child.return=y,y=y.child;continue}}if(y===u)break;for(;y.sibling===null;){if(y.return===null||y.return===u)return;y=y.return}y.sibling.return=y.return,y=y.sibling}};var m4=function(a,u,f,g){for(var y=u.child;y!==null;){if(y.tag===5){var T=y.stateNode;f&&g&&(T=oo(T,y.type,y.memoizedProps,y)),Oc(a,T)}else if(y.tag===6)T=y.stateNode,f&&g&&(T=Mc(T,y.memoizedProps,y)),Oc(a,T);else if(y.tag!==4){if(y.tag===22&&y.memoizedState!==null)T=y.child,T!==null&&(T.return=y),m4(a,y,!0,!0);else if(y.child!==null){y.child.return=y,y=y.child;continue}}if(y===u)break;for(;y.sibling===null;){if(y.return===null||y.return===u)return;y=y.return}y.sibling.return=y.return,y=y.sibling}};rh=function(a,u){var f=u.stateNode;if(!g4(a,u)){a=f.containerInfo;var g=Mi(a);m4(g,u,!1,!1),f.pendingChildren=g,$i(u),Ml(a,g)}},op=function(a,u,f,g,y){var T=a.stateNode,L=a.memoizedProps;if((a=g4(a,u))&&L===g)u.stateNode=T;else{var G=u.stateNode,q=Wi(Kr.current),te=null;L!==g&&(te=en(G,f,L,g,y,q)),a&&te===null?u.stateNode=T:(T=bc(T,te,f,L,g,u,a,G),Se(T,f,g,y,q)&&$i(u),u.stateNode=T,a?$i(u):nh(T,u,!1,!1))}},ap=function(a,u,f,g){f!==g?(a=Wi(Yl.current),f=Wi(Kr.current),u.stateNode=pt(g,a,f,u),$i(u)):u.stateNode=a.stateNode}}else rh=function(){},op=function(){},ap=function(){};function ih(a,u){if(!dt)switch(a.tailMode){case"hidden":u=a.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?a.tail=null:f.sibling=null;break;case"collapsed":f=a.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?u||a.tail===null?a.tail=null:a.tail.sibling=null:g.sibling=null}}function $n(a){var u=a.alternate!==null&&a.alternate.child===a.child,f=0,g=0;if(u)for(var y=a.child;y!==null;)f|=y.lanes|y.childLanes,g|=y.subtreeFlags&14680064,g|=y.flags&14680064,y.return=a,y=y.sibling;else for(y=a.child;y!==null;)f|=y.lanes|y.childLanes,g|=y.subtreeFlags,g|=y.flags,y.return=a,y=y.sibling;return a.subtreeFlags|=g,a.childLanes=f,u}function tA(a,u,f){var g=u.pendingProps;switch(_s(u),u.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $n(u),null;case 1:return xn(u.type)&&Ia(),$n(u),null;case 3:return f=u.stateNode,Xl(),ht(Rn),ht(tn),$_(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(a===null||a.child===null)&&(Na(u)?$i(u):a===null||a.memoizedState.isDehydrated&&!(u.flags&256)||(u.flags|=1024,Er!==null&&(ky(Er),Er=null))),rh(a,u),$n(u),null;case 5:W_(u),f=Wi(Yl.current);var y=u.type;if(a!==null&&u.stateNode!=null)op(a,u,y,g,f),a.ref!==u.ref&&(u.flags|=512,u.flags|=2097152);else{if(!g){if(u.stateNode===null)throw Error(o(166));return $n(u),null}if(a=Wi(Kr.current),Na(u)){if(!lt)throw Error(o(175));a=Fc(u.stateNode,u.type,u.memoizedProps,f,a,u,!ys),u.updateQueue=a,a!==null&&$i(u)}else{var T=ae(y,g,f,a,u);nh(T,u,!1,!1),u.stateNode=T,Se(T,y,g,f,a)&&$i(u)}u.ref!==null&&(u.flags|=512,u.flags|=2097152)}return $n(u),null;case 6:if(a&&u.stateNode!=null)ap(a,u,a.memoizedProps,g);else{if(typeof g!="string"&&u.stateNode===null)throw Error(o(166));if(a=Wi(Yl.current),f=Wi(Kr.current),Na(u)){if(!lt)throw Error(o(176));if(a=u.stateNode,f=u.memoizedProps,(g=Ul(a,f,u,!ys))&&(y=Wn,y!==null))switch(y.tag){case 3:F_(y.stateNode.containerInfo,a,f,(y.mode&1)!==0);break;case 5:Bl(y.type,y.memoizedProps,y.stateNode,a,f,(y.mode&1)!==0)}g&&$i(u)}else u.stateNode=pt(g,a,f,u)}return $n(u),null;case 13:if(ht(At),g=u.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(dt&&ur!==null&&u.mode&1&&!(u.flags&128))Qc(),vs(),u.flags|=98560,y=!1;else if(y=Na(u),g!==null&&g.dehydrated!==null){if(a===null){if(!y)throw Error(o(318));if(!lt)throw Error(o(344));if(y=u.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(o(317));Li(y,u)}else vs(),!(u.flags&128)&&(u.memoizedState=null),u.flags|=4;$n(u),y=!1}else Er!==null&&(ky(Er),Er=null),y=!0;if(!y)return u.flags&65536?u:null}return u.flags&128?(u.lanes=f,u):(f=g!==null,f!==(a!==null&&a.memoizedState!==null)&&f&&(u.child.flags|=8192,u.mode&1&&(a===null||At.current&1?sn===0&&(sn=3):xy())),u.updateQueue!==null&&(u.flags|=4),$n(u),null);case 4:return Xl(),rh(a,u),a===null&&rt(u.stateNode.containerInfo),$n(u),null;case 10:return qt(u.type._context),$n(u),null;case 17:return xn(u.type)&&Ia(),$n(u),null;case 19:if(ht(At),y=u.memoizedState,y===null)return $n(u),null;if(g=(u.flags&128)!==0,T=y.rendering,T===null)if(g)ih(y,!1);else{if(sn!==0||a!==null&&a.flags&128)for(a=u.child;a!==null;){if(T=Xf(a),T!==null){for(u.flags|=128,ih(y,!1),a=T.updateQueue,a!==null&&(u.updateQueue=a,u.flags|=4),u.subtreeFlags=0,a=f,f=u.child;f!==null;)g=f,y=a,g.flags&=14680066,T=g.alternate,T===null?(g.childLanes=0,g.lanes=y,g.child=null,g.subtreeFlags=0,g.memoizedProps=null,g.memoizedState=null,g.updateQueue=null,g.dependencies=null,g.stateNode=null):(g.childLanes=T.childLanes,g.lanes=T.lanes,g.child=T.child,g.subtreeFlags=0,g.deletions=null,g.memoizedProps=T.memoizedProps,g.memoizedState=T.memoizedState,g.updateQueue=T.updateQueue,g.type=T.type,y=T.dependencies,g.dependencies=y===null?null:{lanes:y.lanes,firstContext:y.firstContext}),f=f.sibling;return at(At,At.current&1|2),u.child}a=a.sibling}y.tail!==null&&$t()>Ty&&(u.flags|=128,g=!0,ih(y,!1),u.lanes=4194304)}else{if(!g)if(a=Xf(T),a!==null){if(u.flags|=128,g=!0,a=a.updateQueue,a!==null&&(u.updateQueue=a,u.flags|=4),ih(y,!0),y.tail===null&&y.tailMode==="hidden"&&!T.alternate&&!dt)return $n(u),null}else 2*$t()-y.renderingStartTime>Ty&&f!==1073741824&&(u.flags|=128,g=!0,ih(y,!1),u.lanes=4194304);y.isBackwards?(T.sibling=u.child,u.child=T):(a=y.last,a!==null?a.sibling=T:u.child=T,y.last=T)}return y.tail!==null?(u=y.tail,y.rendering=u,y.tail=u.sibling,y.renderingStartTime=$t(),u.sibling=null,a=At.current,at(At,g?a&1|2:a&1),u):($n(u),null);case 22:case 23:return Ry(),f=u.memoizedState!==null,a!==null&&a.memoizedState!==null!==f&&(u.flags|=8192),f&&u.mode&1?Mr&1073741824&&($n(u),ke&&u.subtreeFlags&6&&(u.flags|=8192)):$n(u),null;case 24:return null;case 25:return null}throw Error(o(156,u.tag))}function nA(a,u){switch(_s(u),u.tag){case 1:return xn(u.type)&&Ia(),a=u.flags,a&65536?(u.flags=a&-65537|128,u):null;case 3:return Xl(),ht(Rn),ht(tn),$_(),a=u.flags,a&65536&&!(a&128)?(u.flags=a&-65537|128,u):null;case 5:return W_(u),null;case 13:if(ht(At),a=u.memoizedState,a!==null&&a.dehydrated!==null){if(u.alternate===null)throw Error(o(340));vs()}return a=u.flags,a&65536?(u.flags=a&-65537|128,u):null;case 19:return ht(At),null;case 4:return Xl(),null;case 10:return qt(u.type._context),null;case 22:case 23:return Ry(),null;case 24:return null;default:return null}}var lp=!1,qn=!1,rA=typeof WeakSet=="function"?WeakSet:Set,he=null;function Zl(a,u){var f=a.ref;if(f!==null)if(typeof f=="function")try{f(null)}catch(g){Pt(a,u,g)}else f.current=null}function hy(a,u,f){try{f()}catch(g){Pt(a,u,g)}}var _4=!1;function iA(a,u){for(oe(a.containerInfo),he=u;he!==null;)if(a=he,u=a.child,(a.subtreeFlags&1028)!==0&&u!==null)u.return=a,he=u;else for(;he!==null;){a=he;try{var f=a.alternate;if(a.flags&1024)switch(a.tag){case 0:case 11:case 15:break;case 1:if(f!==null){var g=f.memoizedProps,y=f.memoizedState,T=a.stateNode,L=T.getSnapshotBeforeUpdate(a.elementType===a.type?g:gi(a.type,g),y);T.__reactInternalSnapshotBeforeUpdate=L}break;case 3:ke&&Dc(a.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(G){Pt(a,a.return,G)}if(u=a.sibling,u!==null){u.return=a.return,he=u;break}he=a.return}return f=_4,_4=!1,f}function sh(a,u,f){var g=u.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var y=g=g.next;do{if((y.tag&a)===a){var T=y.destroy;y.destroy=void 0,T!==void 0&&hy(u,f,T)}y=y.next}while(y!==g)}}function up(a,u){if(u=u.updateQueue,u=u!==null?u.lastEffect:null,u!==null){var f=u=u.next;do{if((f.tag&a)===a){var g=f.create;f.destroy=g()}f=f.next}while(f!==u)}}function dy(a){var u=a.ref;if(u!==null){var f=a.stateNode;switch(a.tag){case 5:a=Be(f);break;default:a=f}typeof u=="function"?u(a):u.current=a}}function y4(a){var u=a.alternate;u!==null&&(a.alternate=null,y4(u)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(u=a.stateNode,u!==null&&Or(u)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function v4(a){return a.tag===5||a.tag===3||a.tag===4}function w4(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||v4(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function fy(a,u,f){var g=a.tag;if(g===5||g===6)a=a.stateNode,u?xf(f,a,u):Pf(f,a);else if(g!==4&&(a=a.child,a!==null))for(fy(a,u,f),a=a.sibling;a!==null;)fy(a,u,f),a=a.sibling}function py(a,u,f){var g=a.tag;if(g===5||g===6)a=a.stateNode,u?Rf(f,a,u):Ol(f,a);else if(g!==4&&(a=a.child,a!==null))for(py(a,u,f),a=a.sibling;a!==null;)py(a,u,f),a=a.sibling}var Nn=null,mi=!1;function qi(a,u,f){for(f=f.child;f!==null;)gy(a,u,f),f=f.sibling}function gy(a,u,f){if(jn&&typeof jn.onCommitFiberUnmount=="function")try{jn.onCommitFiberUnmount(zi,f)}catch{}switch(f.tag){case 5:qn||Zl(f,u);case 6:if(ke){var g=Nn,y=mi;Nn=null,qi(a,u,f),Nn=g,mi=y,Nn!==null&&(mi?O_(Nn,f.stateNode):Ac(Nn,f.stateNode))}else qi(a,u,f);break;case 18:ke&&Nn!==null&&(mi?Ff(Nn,f.stateNode):Uc(Nn,f.stateNode));break;case 4:ke?(g=Nn,y=mi,Nn=f.stateNode.containerInfo,mi=!0,qi(a,u,f),Nn=g,mi=y):(ot&&(g=f.stateNode.containerInfo,y=Mi(g),Ll(g,y)),qi(a,u,f));break;case 0:case 11:case 14:case 15:if(!qn&&(g=f.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){y=g=g.next;do{var T=y,L=T.destroy;T=T.tag,L!==void 0&&(T&2||T&4)&&hy(f,u,L),y=y.next}while(y!==g)}qi(a,u,f);break;case 1:if(!qn&&(Zl(f,u),g=f.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=f.memoizedProps,g.state=f.memoizedState,g.componentWillUnmount()}catch(G){Pt(f,u,G)}qi(a,u,f);break;case 21:qi(a,u,f);break;case 22:f.mode&1?(qn=(g=qn)||f.memoizedState!==null,qi(a,u,f),qn=g):qi(a,u,f);break;default:qi(a,u,f)}}function E4(a){var u=a.updateQueue;if(u!==null){a.updateQueue=null;var f=a.stateNode;f===null&&(f=a.stateNode=new rA),u.forEach(function(g){var y=fA.bind(null,a,g);f.has(g)||(f.add(g),g.then(y,y))})}}function _i(a,u){var f=u.deletions;if(f!==null)for(var g=0;g<f.length;g++){var y=f[g];try{var T=a,L=u;if(ke){var G=L;e:for(;G!==null;){switch(G.tag){case 5:Nn=G.stateNode,mi=!1;break e;case 3:Nn=G.stateNode.containerInfo,mi=!0;break e;case 4:Nn=G.stateNode.containerInfo,mi=!0;break e}G=G.return}if(Nn===null)throw Error(o(160));gy(T,L,y),Nn=null,mi=!1}else gy(T,L,y);var q=y.alternate;q!==null&&(q.return=null),y.return=null}catch(te){Pt(y,u,te)}}if(u.subtreeFlags&12854)for(u=u.child;u!==null;)S4(u,a),u=u.sibling}function S4(a,u){var f=a.alternate,g=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(_i(u,a),Ki(a),g&4){try{sh(3,a,a.return),up(3,a)}catch(le){Pt(a,a.return,le)}try{sh(5,a,a.return)}catch(le){Pt(a,a.return,le)}}break;case 1:_i(u,a),Ki(a),g&512&&f!==null&&Zl(f,f.return);break;case 5:if(_i(u,a),Ki(a),g&512&&f!==null&&Zl(f,f.return),ke){if(a.flags&32){var y=a.stateNode;try{Af(y)}catch(le){Pt(a,a.return,le)}}if(g&4&&(y=a.stateNode,y!=null)){var T=a.memoizedProps;if(f=f!==null?f.memoizedProps:T,g=a.type,u=a.updateQueue,a.updateQueue=null,u!==null)try{Sa(y,u,g,f,T,a)}catch(le){Pt(a,a.return,le)}}}break;case 6:if(_i(u,a),Ki(a),g&4&&ke){if(a.stateNode===null)throw Error(o(162));y=a.stateNode,T=a.memoizedProps,f=f!==null?f.memoizedProps:T;try{kf(y,f,T)}catch(le){Pt(a,a.return,le)}}break;case 3:if(_i(u,a),Ki(a),g&4){if(ke&&lt&&f!==null&&f.memoizedState.isDehydrated)try{Lf(u.containerInfo)}catch(le){Pt(a,a.return,le)}if(ot){y=u.containerInfo,T=u.pendingChildren;try{Ll(y,T)}catch(le){Pt(a,a.return,le)}}}break;case 4:if(_i(u,a),Ki(a),g&4&&ot){T=a.stateNode,y=T.containerInfo,T=T.pendingChildren;try{Ll(y,T)}catch(le){Pt(a,a.return,le)}}break;case 13:_i(u,a),Ki(a),y=a.child,y.flags&8192&&(T=y.memoizedState!==null,y.stateNode.isHidden=T,!T||y.alternate!==null&&y.alternate.memoizedState!==null||(Sy=$t())),g&4&&E4(a);break;case 22:var L=f!==null&&f.memoizedState!==null;if(a.mode&1?(qn=(f=qn)||L,_i(u,a),qn=f):_i(u,a),Ki(a),g&8192){if(f=a.memoizedState!==null,(a.stateNode.isHidden=f)&&!L&&a.mode&1)for(he=a,g=a.child;g!==null;){for(u=he=g;he!==null;){L=he;var G=L.child;switch(L.tag){case 0:case 11:case 14:case 15:sh(4,L,L.return);break;case 1:Zl(L,L.return);var q=L.stateNode;if(typeof q.componentWillUnmount=="function"){var te=L,ge=L.return;try{var Ae=te;q.props=Ae.memoizedProps,q.state=Ae.memoizedState,q.componentWillUnmount()}catch(le){Pt(te,ge,le)}}break;case 5:Zl(L,L.return);break;case 22:if(L.memoizedState!==null){I4(u);continue}}G!==null?(G.return=L,he=G):I4(u)}g=g.sibling}if(ke){e:if(g=null,ke)for(u=a;;){if(u.tag===5){if(g===null){g=u;try{y=u.stateNode,f?Nc(y):Df(u.stateNode,u.memoizedProps)}catch(le){Pt(a,a.return,le)}}}else if(u.tag===6){if(g===null)try{T=u.stateNode,f?Nf(T):Ta(T,u.memoizedProps)}catch(le){Pt(a,a.return,le)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===a)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===a)break e;for(;u.sibling===null;){if(u.return===null||u.return===a)break e;g===u&&(g=null),u=u.return}g===u&&(g=null),u.sibling.return=u.return,u=u.sibling}}}break;case 19:_i(u,a),Ki(a),g&4&&E4(a);break;case 21:break;default:_i(u,a),Ki(a)}}function Ki(a){var u=a.flags;if(u&2){try{if(ke){e:{for(var f=a.return;f!==null;){if(v4(f)){var g=f;break e}f=f.return}throw Error(o(160))}switch(g.tag){case 5:var y=g.stateNode;g.flags&32&&(Af(y),g.flags&=-33);var T=w4(a);py(a,T,y);break;case 3:case 4:var L=g.stateNode.containerInfo,G=w4(a);fy(a,G,L);break;default:throw Error(o(161))}}}catch(q){Pt(a,a.return,q)}a.flags&=-3}u&4096&&(a.flags&=-4097)}function sA(a,u,f){he=a,T4(a)}function T4(a,u,f){for(var g=(a.mode&1)!==0;he!==null;){var y=he,T=y.child;if(y.tag===22&&g){var L=y.memoizedState!==null||lp;if(!L){var G=y.alternate,q=G!==null&&G.memoizedState!==null||qn;G=lp;var te=qn;if(lp=L,(qn=q)&&!te)for(he=y;he!==null;)L=he,q=L.child,L.tag===22&&L.memoizedState!==null?P4(y):q!==null?(q.return=L,he=q):P4(y);for(;T!==null;)he=T,T4(T),T=T.sibling;he=y,lp=G,qn=te}C4(a)}else y.subtreeFlags&8772&&T!==null?(T.return=y,he=T):C4(a)}}function C4(a){for(;he!==null;){var u=he;if(u.flags&8772){var f=u.alternate;try{if(u.flags&8772)switch(u.tag){case 0:case 11:case 15:qn||up(5,u);break;case 1:var g=u.stateNode;if(u.flags&4&&!qn)if(f===null)g.componentDidMount();else{var y=u.elementType===u.type?f.memoizedProps:gi(u.type,f.memoizedProps);g.componentDidUpdate(y,f.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var T=u.updateQueue;T!==null&&kS(u,T,g);break;case 3:var L=u.updateQueue;if(L!==null){if(f=null,u.child!==null)switch(u.child.tag){case 5:f=Be(u.child.stateNode);break;case 1:f=u.child.stateNode}kS(u,L,f)}break;case 5:var G=u.stateNode;f===null&&u.flags&4&&b_(G,u.type,u.memoizedProps,u);break;case 6:break;case 4:break;case 12:break;case 13:if(lt&&u.memoizedState===null){var q=u.alternate;if(q!==null){var te=q.memoizedState;if(te!==null){var ge=te.dehydrated;ge!==null&&Vc(ge)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(o(163))}qn||u.flags&512&&dy(u)}catch(Ae){Pt(u,u.return,Ae)}}if(u===a){he=null;break}if(f=u.sibling,f!==null){f.return=u.return,he=f;break}he=u.return}}function I4(a){for(;he!==null;){var u=he;if(u===a){he=null;break}var f=u.sibling;if(f!==null){f.return=u.return,he=f;break}he=u.return}}function P4(a){for(;he!==null;){var u=he;try{switch(u.tag){case 0:case 11:case 15:var f=u.return;try{up(4,u)}catch(q){Pt(u,f,q)}break;case 1:var g=u.stateNode;if(typeof g.componentDidMount=="function"){var y=u.return;try{g.componentDidMount()}catch(q){Pt(u,y,q)}}var T=u.return;try{dy(u)}catch(q){Pt(u,T,q)}break;case 5:var L=u.return;try{dy(u)}catch(q){Pt(u,L,q)}}}catch(q){Pt(u,u.return,q)}if(u===a){he=null;break}var G=u.sibling;if(G!==null){G.return=u.return,he=G;break}he=u.return}}var cp=0,hp=1,dp=2,fp=3,pp=4;if(typeof Symbol=="function"&&Symbol.for){var oh=Symbol.for;cp=oh("selector.component"),hp=oh("selector.has_pseudo_class"),dp=oh("selector.role"),fp=oh("selector.test_id"),pp=oh("selector.text")}function my(a){var u=_r(a);if(u!=null){if(typeof u.memoizedProps["data-testname"]!="string")throw Error(o(364));return u}if(a=Cf(a),a===null)throw Error(o(362));return a.stateNode.current}function _y(a,u){switch(u.$$typeof){case cp:if(a.type===u.value)return!0;break;case hp:e:{u=u.value,a=[a,0];for(var f=0;f<a.length;){var g=a[f++],y=a[f++],T=u[y];if(g.tag!==5||!us(g)){for(;T!=null&&_y(g,T);)y++,T=u[y];if(y===u.length){u=!0;break e}else for(g=g.child;g!==null;)a.push(g,y),g=g.sibling}}u=!1}return u;case dp:if(a.tag===5&&If(a.stateNode,u.value))return!0;break;case pp:if((a.tag===5||a.tag===6)&&(a=xc(a),a!==null&&0<=a.indexOf(u.value)))return!0;break;case fp:if(a.tag===5&&(a=a.memoizedProps["data-testname"],typeof a=="string"&&a.toLowerCase()===u.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function yy(a){switch(a.$$typeof){case cp:return"<"+(D(a.value)||"Unknown")+">";case hp:return":has("+(yy(a)||"")+")";case dp:return'[role="'+a.value+'"]';case pp:return'"'+a.value+'"';case fp:return'[data-testname="'+a.value+'"]';default:throw Error(o(365))}}function k4(a,u){var f=[];a=[a,0];for(var g=0;g<a.length;){var y=a[g++],T=a[g++],L=u[T];if(y.tag!==5||!us(y)){for(;L!=null&&_y(y,L);)T++,L=u[T];if(T===u.length)f.push(y);else for(y=y.child;y!==null;)a.push(y,T),y=y.sibling}}return f}function vy(a,u){if(!ls)throw Error(o(363));a=my(a),a=k4(a,u),u=[],a=Array.from(a);for(var f=0;f<a.length;){var g=a[f++];if(g.tag===5)us(g)||u.push(g.stateNode);else for(g=g.child;g!==null;)a.push(g),g=g.sibling}return u}var oA=Math.ceil,gp=l.ReactCurrentDispatcher,wy=l.ReactCurrentOwner,zt=l.ReactCurrentBatchConfig,Le=0,mn=null,Kt=null,Dn=0,Mr=0,eu=ci(0),sn=0,ah=null,Oa=0,mp=0,Ey=0,lh=null,Tr=null,Sy=0,Ty=1/0,Ss=null;function tu(){Ty=$t()+500}var _p=!1,Cy=null,go=null,yp=!1,mo=null,vp=0,uh=0,Iy=null,wp=-1,Ep=0;function Kn(){return Le&6?$t():wp!==-1?wp:wp=$t()}function _o(a){return a.mode&1?Le&2&&Dn!==0?Dn&-Dn:cr.transition!==null?(Ep===0&&(Ep=zf()),Ep):(a=$e,a!==0?a:li()):1}function Yr(a,u,f,g){if(50<uh)throw uh=0,Iy=null,Error(o(185));vr(a,f,g),(!(Le&2)||a!==mn)&&(a===mn&&(!(Le&2)&&(mp|=f),sn===4&&yo(a,Dn)),Cr(a,g),f===1&&Le===0&&!(u.mode&1)&&(tu(),Hl&&ar()))}function Cr(a,u){var f=a.callbackNode;U_(a,u);var g=Ra(a,a===mn?Dn:0);if(g===0)f!==null&&Gf(f),a.callbackNode=null,a.callbackPriority=0;else if(u=g&-g,a.callbackPriority!==u){if(f!=null&&Gf(f),u===1)a.tag===0?$f(x4.bind(null,a)):$c(x4.bind(null,a)),Oi?Tf(function(){!(Le&6)&&ar()}):Gc(Wc,ar),f=null;else{switch(gs(g)){case 1:f=Wc;break;case 4:f=Wl;break;case 16:f=co;break;case 536870912:f=Wf;break;default:f=co}f=V4(f,R4.bind(null,a))}a.callbackPriority=u,a.callbackNode=f}}function R4(a,u){if(wp=-1,Ep=0,Le&6)throw Error(o(327));var f=a.callbackNode;if(Fa()&&a.callbackNode!==f)return null;var g=Ra(a,a===mn?Dn:0);if(g===0)return null;if(g&30||g&a.expiredLanes||u)u=Sp(a,g);else{u=g;var y=Le;Le|=2;var T=D4();(mn!==a||Dn!==u)&&(Ss=null,tu(),Ma(a,u));do try{uA();break}catch(G){N4(a,G)}while(!0);je(),gp.current=T,Le=y,Kt!==null?u=0:(mn=null,Dn=0,u=sn)}if(u!==0){if(u===2&&(y=jc(a),y!==0&&(g=y,u=Py(a,y))),u===1)throw f=ah,Ma(a,0),yo(a,g),Cr(a,$t()),f;if(u===6)yo(a,g);else{if(y=a.current.alternate,!(g&30)&&!aA(y)&&(u=Sp(a,g),u===2&&(T=jc(a),T!==0&&(g=T,u=Py(a,T))),u===1))throw f=ah,Ma(a,0),yo(a,g),Cr(a,$t()),f;switch(a.finishedWork=y,a.finishedLanes=g,u){case 0:case 1:throw Error(o(345));case 2:La(a,Tr,Ss);break;case 3:if(yo(a,g),(g&130023424)===g&&(u=Sy+500-$t(),10<u)){if(Ra(a,0)!==0)break;if(y=a.suspendedLanes,(y&g)!==g){Kn(),a.pingedLanes|=a.suspendedLanes&y;break}a.timeoutHandle=j(La.bind(null,a,Tr,Ss),u);break}La(a,Tr,Ss);break;case 4:if(yo(a,g),(g&4194240)===g)break;for(u=a.eventTimes,y=-1;0<g;){var L=31-zn(g);T=1<<L,L=u[L],L>y&&(y=L),g&=~T}if(g=y,g=$t()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*oA(g/1960))-g,10<g){a.timeoutHandle=j(La.bind(null,a,Tr,Ss),g);break}La(a,Tr,Ss);break;case 5:La(a,Tr,Ss);break;default:throw Error(o(329))}}}return Cr(a,$t()),a.callbackNode===f?R4.bind(null,a):null}function Py(a,u){var f=lh;return a.current.memoizedState.isDehydrated&&(Ma(a,u).flags|=256),a=Sp(a,u),a!==2&&(u=Tr,Tr=f,u!==null&&ky(u)),a}function ky(a){Tr===null?Tr=a:Tr.push.apply(Tr,a)}function aA(a){for(var u=a;;){if(u.flags&16384){var f=u.updateQueue;if(f!==null&&(f=f.stores,f!==null))for(var g=0;g<f.length;g++){var y=f[g],T=y.getSnapshot;y=y.value;try{if(!Qe(T(),y))return!1}catch{return!1}}}if(f=u.child,u.subtreeFlags&16384&&f!==null)f.return=u,u=f;else{if(u===a)break;for(;u.sibling===null;){if(u.return===null||u.return===a)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function yo(a,u){for(u&=~Ey,u&=~mp,a.suspendedLanes|=u,a.pingedLanes&=~u,a=a.expirationTimes;0<u;){var f=31-zn(u),g=1<<f;a[f]=-1,u&=~g}}function x4(a){if(Le&6)throw Error(o(327));Fa();var u=Ra(a,0);if(!(u&1))return Cr(a,$t()),null;var f=Sp(a,u);if(a.tag!==0&&f===2){var g=jc(a);g!==0&&(u=g,f=Py(a,g))}if(f===1)throw f=ah,Ma(a,0),yo(a,u),Cr(a,$t()),f;if(f===6)throw Error(o(345));return a.finishedWork=a.current.alternate,a.finishedLanes=u,La(a,Tr,Ss),Cr(a,$t()),null}function A4(a){mo!==null&&mo.tag===0&&!(Le&6)&&Fa();var u=Le;Le|=1;var f=zt.transition,g=$e;try{if(zt.transition=null,$e=1,a)return a()}finally{$e=g,zt.transition=f,Le=u,!(Le&6)&&ar()}}function Ry(){Mr=eu.current,ht(eu)}function Ma(a,u){a.finishedWork=null,a.finishedLanes=0;var f=a.timeoutHandle;if(f!==ye&&(a.timeoutHandle=ye,Z(f)),Kt!==null)for(f=Kt.return;f!==null;){var g=f;switch(_s(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&Ia();break;case 3:Xl(),ht(Rn),ht(tn),$_();break;case 5:W_(g);break;case 4:Xl();break;case 13:ht(At);break;case 19:ht(At);break;case 10:qt(g.type._context);break;case 22:case 23:Ry()}f=f.return}if(mn=a,Kt=a=vo(a.current,null),Dn=Mr=u,sn=0,ah=null,Ey=mp=Oa=0,Tr=lh=null,pi!==null){for(u=0;u<pi.length;u++)if(f=pi[u],g=f.interleaved,g!==null){f.interleaved=null;var y=g.next,T=f.pending;if(T!==null){var L=T.next;T.next=y,g.next=L}f.pending=g}pi=null}return a}function N4(a,u){do{var f=Kt;try{if(je(),Jf.current=np,Zf){for(var g=Nt.memoizedState;g!==null;){var y=g.queue;y!==null&&(y.pending=null),g=g.next}Zf=!1}if(ba=0,gn=rn=Nt=null,Jc=!1,Zc=0,wy.current=null,f===null||f.return===null){sn=1,ah=u,Kt=null;break}e:{var T=a,L=f.return,G=f,q=u;if(u=Dn,G.flags|=32768,q!==null&&typeof q=="object"&&typeof q.then=="function"){var te=q,ge=G,Ae=ge.tag;if(!(ge.mode&1)&&(Ae===0||Ae===11||Ae===15)){var le=ge.alternate;le?(ge.updateQueue=le.updateQueue,ge.memoizedState=le.memoizedState,ge.lanes=le.lanes):(ge.updateQueue=null,ge.memoizedState=null)}var St=n4(L);if(St!==null){St.flags&=-257,r4(St,L,G,T,u),St.mode&1&&t4(T,te,u),u=St,q=te;var mt=u.updateQueue;if(mt===null){var Ir=new Set;Ir.add(q),u.updateQueue=Ir}else mt.add(q);break e}else{if(!(u&1)){t4(T,te,u),xy();break e}q=Error(o(426))}}else if(dt&&G.mode&1){var Ts=n4(L);if(Ts!==null){!(Ts.flags&65536)&&(Ts.flags|=256),r4(Ts,L,G,T,u),ho(Jl(q,G));break e}}T=q=Jl(q,G),sn!==4&&(sn=2),lh===null?lh=[T]:lh.push(T),T=L;do{switch(T.tag){case 3:T.flags|=65536,u&=-u,T.lanes|=u;var $=ZS(T,q,u);PS(T,$);break e;case 1:G=q;var W=T.type,Q=T.stateNode;if(!(T.flags&128)&&(typeof W.getDerivedStateFromError=="function"||Q!==null&&typeof Q.componentDidCatch=="function"&&(go===null||!go.has(Q)))){T.flags|=65536,u&=-u,T.lanes|=u;var ce=e4(T,G,u);PS(T,ce);break e}}T=T.return}while(T!==null)}O4(f)}catch(we){u=we,Kt===f&&f!==null&&(Kt=f=f.return);continue}break}while(!0)}function D4(){var a=gp.current;return gp.current=np,a===null?np:a}function xy(){(sn===0||sn===3||sn===2)&&(sn=4),mn===null||!(Oa&268435455)&&!(mp&268435455)||yo(mn,Dn)}function Sp(a,u){var f=Le;Le|=2;var g=D4();(mn!==a||Dn!==u)&&(Ss=null,Ma(a,u));do try{lA();break}catch(y){N4(a,y)}while(!0);if(je(),Le=f,gp.current=g,Kt!==null)throw Error(o(261));return mn=null,Dn=0,sn}function lA(){for(;Kt!==null;)b4(Kt)}function uA(){for(;Kt!==null&&!B_();)b4(Kt)}function b4(a){var u=F4(a.alternate,a,Mr);a.memoizedProps=a.pendingProps,u===null?O4(a):Kt=u,wy.current=null}function O4(a){var u=a;do{var f=u.alternate;if(a=u.return,u.flags&32768){if(f=nA(f,u),f!==null){f.flags&=32767,Kt=f;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{sn=6,Kt=null;return}}else if(f=tA(f,u,Mr),f!==null){Kt=f;return}if(u=u.sibling,u!==null){Kt=u;return}Kt=u=a}while(u!==null);sn===0&&(sn=5)}function La(a,u,f){var g=$e,y=zt.transition;try{zt.transition=null,$e=1,cA(a,u,f,g)}finally{zt.transition=y,$e=g}return null}function cA(a,u,f,g){do Fa();while(mo!==null);if(Le&6)throw Error(o(327));f=a.finishedWork;var y=a.finishedLanes;if(f===null)return null;if(a.finishedWork=null,a.finishedLanes=0,f===a.current)throw Error(o(177));a.callbackNode=null,a.callbackPriority=0;var T=f.lanes|f.childLanes;if(jf(a,T),a===mn&&(Kt=mn=null,Dn=0),!(f.subtreeFlags&2064)&&!(f.flags&2064)||yp||(yp=!0,V4(co,function(){return Fa(),null})),T=(f.flags&15990)!==0,f.subtreeFlags&15990||T){T=zt.transition,zt.transition=null;var L=$e;$e=1;var G=Le;Le|=4,wy.current=null,iA(a,f),S4(f,a),ne(a.containerInfo),a.current=f,sA(f),Bi(),Le=G,$e=L,zt.transition=T}else a.current=f;if(yp&&(yp=!1,mo=a,vp=y),T=a.pendingLanes,T===0&&(go=null),Hf(f.stateNode),Cr(a,$t()),u!==null)for(g=a.onRecoverableError,f=0;f<u.length;f++)y=u[f],g(y.value,{componentStack:y.stack,digest:y.digest});if(_p)throw _p=!1,a=Cy,Cy=null,a;return vp&1&&a.tag!==0&&Fa(),T=a.pendingLanes,T&1?a===Iy?uh++:(uh=0,Iy=a):uh=0,ar(),null}function Fa(){if(mo!==null){var a=gs(vp),u=zt.transition,f=$e;try{if(zt.transition=null,$e=16>a?16:a,mo===null)var g=!1;else{if(a=mo,mo=null,vp=0,Le&6)throw Error(o(331));var y=Le;for(Le|=4,he=a.current;he!==null;){var T=he,L=T.child;if(he.flags&16){var G=T.deletions;if(G!==null){for(var q=0;q<G.length;q++){var te=G[q];for(he=te;he!==null;){var ge=he;switch(ge.tag){case 0:case 11:case 15:sh(8,ge,T)}var Ae=ge.child;if(Ae!==null)Ae.return=ge,he=Ae;else for(;he!==null;){ge=he;var le=ge.sibling,St=ge.return;if(y4(ge),ge===te){he=null;break}if(le!==null){le.return=St,he=le;break}he=St}}}var mt=T.alternate;if(mt!==null){var Ir=mt.child;if(Ir!==null){mt.child=null;do{var Ts=Ir.sibling;Ir.sibling=null,Ir=Ts}while(Ir!==null)}}he=T}}if(T.subtreeFlags&2064&&L!==null)L.return=T,he=L;else e:for(;he!==null;){if(T=he,T.flags&2048)switch(T.tag){case 0:case 11:case 15:sh(9,T,T.return)}var $=T.sibling;if($!==null){$.return=T.return,he=$;break e}he=T.return}}var W=a.current;for(he=W;he!==null;){L=he;var Q=L.child;if(L.subtreeFlags&2064&&Q!==null)Q.return=L,he=Q;else e:for(L=W;he!==null;){if(G=he,G.flags&2048)try{switch(G.tag){case 0:case 11:case 15:up(9,G)}}catch(we){Pt(G,G.return,we)}if(G===L){he=null;break e}var ce=G.sibling;if(ce!==null){ce.return=G.return,he=ce;break e}he=G.return}}if(Le=y,ar(),jn&&typeof jn.onPostCommitFiberRoot=="function")try{jn.onPostCommitFiberRoot(zi,a)}catch{}g=!0}return g}finally{$e=f,zt.transition=u}}return!1}function M4(a,u,f){u=Jl(f,u),u=ZS(a,u,1),a=po(a,u,1),u=Kn(),a!==null&&(vr(a,1,u),Cr(a,u))}function Pt(a,u,f){if(a.tag===3)M4(a,a,f);else for(;u!==null;){if(u.tag===3){M4(u,a,f);break}else if(u.tag===1){var g=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(go===null||!go.has(g))){a=Jl(f,a),a=e4(u,a,1),u=po(u,a,1),a=Kn(),u!==null&&(vr(u,1,a),Cr(u,a));break}}u=u.return}}function hA(a,u,f){var g=a.pingCache;g!==null&&g.delete(u),u=Kn(),a.pingedLanes|=a.suspendedLanes&f,mn===a&&(Dn&f)===f&&(sn===4||sn===3&&(Dn&130023424)===Dn&&500>$t()-Sy?Ma(a,0):Ey|=f),Cr(a,u)}function L4(a,u){u===0&&(a.mode&1?(u=Ui,Ui<<=1,!(Ui&130023424)&&(Ui=4194304)):u=1);var f=Kn();a=Gi(a,u),a!==null&&(vr(a,u,f),Cr(a,f))}function dA(a){var u=a.memoizedState,f=0;u!==null&&(f=u.retryLane),L4(a,f)}function fA(a,u){var f=0;switch(a.tag){case 13:var g=a.stateNode,y=a.memoizedState;y!==null&&(f=y.retryLane);break;case 19:g=a.stateNode;break;default:throw Error(o(314))}g!==null&&g.delete(u),L4(a,f)}var F4;F4=function(a,u,f){if(a!==null)if(a.memoizedProps!==u.pendingProps||Rn.current)Sr=!0;else{if(!(a.lanes&f)&&!(u.flags&128))return Sr=!1,eA(a,u,f);Sr=!!(a.flags&131072)}else Sr=!1,dt&&u.flags&1048576&&qf(u,ql,u.index);switch(u.lanes=0,u.tag){case 2:var g=u.type;sp(a,u),a=u.pendingProps;var y=uo(u,tn.current);pn(u,f),y=Q_(null,u,g,a,y,f);var T=Y_();return u.flags|=1,typeof y=="object"&&y!==null&&typeof y.render=="function"&&y.$$typeof===void 0?(u.tag=1,u.memoizedState=null,u.updateQueue=null,xn(g)?(T=!0,yr(u)):T=!1,u.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,j_(u),y.updater=rp,u.stateNode=y,y._reactInternals=u,ny(u,g,a,f),u=oy(null,u,g,!0,T,f)):(u.tag=0,dt&&T&&Kl(u),hr(null,u,y,f),u=u.child),u;case 16:g=u.elementType;e:{switch(sp(a,u),a=u.pendingProps,y=g._init,g=y(g._payload),u.type=g,y=u.tag=gA(g),a=gi(g,a),y){case 0:u=sy(null,u,g,a,f);break e;case 1:u=u4(null,u,g,a,f);break e;case 11:u=i4(null,u,g,a,f);break e;case 14:u=s4(null,u,g,gi(g.type,a),f);break e}throw Error(o(306,g,""))}return u;case 0:return g=u.type,y=u.pendingProps,y=u.elementType===g?y:gi(g,y),sy(a,u,g,y,f);case 1:return g=u.type,y=u.pendingProps,y=u.elementType===g?y:gi(g,y),u4(a,u,g,y,f);case 3:e:{if(c4(u),a===null)throw Error(o(387));g=u.pendingProps,T=u.memoizedState,y=T.element,IS(a,u),Yf(u,g,null,f);var L=u.memoizedState;if(g=L.element,lt&&T.isDehydrated)if(T={element:g,isDehydrated:!1,cache:L.cache,pendingSuspenseBoundaries:L.pendingSuspenseBoundaries,transitions:L.transitions},u.updateQueue.baseState=T,u.memoizedState=T,u.flags&256){y=Jl(Error(o(423)),u),u=h4(a,u,g,f,y);break e}else if(g!==y){y=Jl(Error(o(424)),u),u=h4(a,u,g,f,y);break e}else for(lt&&(ur=Vl(u.stateNode.containerInfo),Wn=u,dt=!0,Er=null,ys=!1),f=H(u,null,g,f),u.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(vs(),g===y){u=Es(a,u,f);break e}hr(a,u,g,f)}u=u.child}return u;case 5:return RS(u),a===null&&fi(u),g=u.type,y=u.pendingProps,T=a!==null?a.memoizedProps:null,L=y.children,xt(g,y)?L=null:T!==null&&xt(g,T)&&(u.flags|=32),l4(a,u),hr(a,u,L,f),u.child;case 6:return a===null&&fi(u),null;case 13:return d4(a,u,f);case 4:return G_(u,u.stateNode.containerInfo),g=u.pendingProps,a===null?u.child=O(u,null,g,f):hr(a,u,g,f),u.child;case 11:return g=u.type,y=u.pendingProps,y=u.elementType===g?y:gi(g,y),i4(a,u,g,y,f);case 7:return hr(a,u,u.pendingProps,f),u.child;case 8:return hr(a,u,u.pendingProps.children,f),u.child;case 12:return hr(a,u,u.pendingProps.children,f),u.child;case 10:e:{if(g=u.type._context,y=u.pendingProps,T=u.memoizedProps,L=y.value,nn(u,g,L),T!==null)if(Qe(T.value,L)){if(T.children===y.children&&!Rn.current){u=Es(a,u,f);break e}}else for(T=u.child,T!==null&&(T.return=u);T!==null;){var G=T.dependencies;if(G!==null){L=T.child;for(var q=G.firstContext;q!==null;){if(q.context===g){if(T.tag===1){q=ws(-1,f&-f),q.tag=2;var te=T.updateQueue;if(te!==null){te=te.shared;var ge=te.pending;ge===null?q.next=q:(q.next=ge.next,ge.next=q),te.pending=q}}T.lanes|=f,q=T.alternate,q!==null&&(q.lanes|=f),ji(T.return,f,u),G.lanes|=f;break}q=q.next}}else if(T.tag===10)L=T.type===u.type?null:T.child;else if(T.tag===18){if(L=T.return,L===null)throw Error(o(341));L.lanes|=f,G=L.alternate,G!==null&&(G.lanes|=f),ji(L,f,u),L=T.sibling}else L=T.child;if(L!==null)L.return=T;else for(L=T;L!==null;){if(L===u){L=null;break}if(T=L.sibling,T!==null){T.return=L.return,L=T;break}L=L.return}T=L}hr(a,u,y.children,f),u=u.child}return u;case 9:return y=u.type,g=u.pendingProps.children,pn(u,f),y=An(y),g=g(y),u.flags|=1,hr(a,u,g,f),u.child;case 14:return g=u.type,y=gi(g,u.pendingProps),y=gi(g.type,y),s4(a,u,g,y,f);case 15:return o4(a,u,u.type,u.pendingProps,f);case 17:return g=u.type,y=u.pendingProps,y=u.elementType===g?y:gi(g,y),sp(a,u),u.tag=1,xn(g)?(a=!0,yr(u)):a=!1,pn(u,f),XS(u,g,y),ny(u,g,y,f),oy(null,u,g,!0,a,f);case 19:return p4(a,u,f);case 22:return a4(a,u,f)}throw Error(o(156,u.tag))};function V4(a,u){return Gc(a,u)}function pA(a,u,f,g){this.tag=a,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xr(a,u,f,g){return new pA(a,u,f,g)}function Ay(a){return a=a.prototype,!(!a||!a.isReactComponent)}function gA(a){if(typeof a=="function")return Ay(a)?1:0;if(a!=null){if(a=a.$$typeof,a===k)return 11;if(a===R)return 14}return 2}function vo(a,u){var f=a.alternate;return f===null?(f=Xr(a.tag,u,a.key,a.mode),f.elementType=a.elementType,f.type=a.type,f.stateNode=a.stateNode,f.alternate=a,a.alternate=f):(f.pendingProps=u,f.type=a.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=a.flags&14680064,f.childLanes=a.childLanes,f.lanes=a.lanes,f.child=a.child,f.memoizedProps=a.memoizedProps,f.memoizedState=a.memoizedState,f.updateQueue=a.updateQueue,u=a.dependencies,f.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},f.sibling=a.sibling,f.index=a.index,f.ref=a.ref,f}function Tp(a,u,f,g,y,T){var L=2;if(g=a,typeof a=="function")Ay(a)&&(L=1);else if(typeof a=="string")L=5;else e:switch(a){case p:return Va(f.children,y,T,u);case _:L=8,y|=8;break;case m:return a=Xr(12,f,u,y|2),a.elementType=m,a.lanes=T,a;case N:return a=Xr(13,f,u,y),a.elementType=N,a.lanes=T,a;case x:return a=Xr(19,f,u,y),a.elementType=x,a.lanes=T,a;case P:return Cp(f,y,T,u);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case E:L=10;break e;case S:L=9;break e;case k:L=11;break e;case R:L=14;break e;case w:L=16,g=null;break e}throw Error(o(130,a==null?a:typeof a,""))}return u=Xr(L,f,u,y),u.elementType=a,u.type=g,u.lanes=T,u}function Va(a,u,f,g){return a=Xr(7,a,g,u),a.lanes=f,a}function Cp(a,u,f,g){return a=Xr(22,a,g,u),a.elementType=P,a.lanes=f,a.stateNode={isHidden:!1},a}function Ny(a,u,f){return a=Xr(6,a,null,u),a.lanes=f,a}function Dy(a,u,f){return u=Xr(4,a.children!==null?a.children:[],a.key,u),u.lanes=f,u.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},u}function mA(a,u,f,g,y){this.tag=u,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=ye,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ps(0),this.expirationTimes=ps(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ps(0),this.identifierPrefix=g,this.onRecoverableError=y,lt&&(this.mutableSourceEagerHydrationData=null)}function U4(a,u,f,g,y,T,L,G,q){return a=new mA(a,u,f,G,q),u===1?(u=1,T===!0&&(u|=8)):u=0,T=Xr(3,null,null,u),a.current=T,T.stateNode=a,T.memoizedState={element:g,isDehydrated:f,cache:null,transitions:null,pendingSuspenseBoundaries:null},j_(T),a}function B4(a){if(!a)return Wr;a=a._reactInternals;e:{if(b(a)!==a||a.tag!==1)throw Error(o(170));var u=a;do{switch(u.tag){case 3:u=u.stateNode.context;break e;case 1:if(xn(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break e}}u=u.return}while(u!==null);throw Error(o(171))}if(a.tag===1){var f=a.type;if(xn(f))return Fi(a,f,u)}return u}function z4(a){var u=a._reactInternals;if(u===void 0)throw typeof a.render=="function"?Error(o(188)):(a=Object.keys(a).join(","),Error(o(268,a)));return a=B(u),a===null?null:a.stateNode}function j4(a,u){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var f=a.retryLane;a.retryLane=f!==0&&f<u?f:u}}function Ip(a,u){j4(a,u),(a=a.alternate)&&j4(a,u)}function _A(a){return a=B(a),a===null?null:a.stateNode}function yA(){return null}return t.attemptContinuousHydration=function(a){if(a.tag===13){var u=Gi(a,134217728);if(u!==null){var f=Kn();Yr(u,a,134217728,f)}Ip(a,134217728)}},t.attemptDiscreteHydration=function(a){if(a.tag===13){var u=Gi(a,1);if(u!==null){var f=Kn();Yr(u,a,1,f)}Ip(a,1)}},t.attemptHydrationAtCurrentPriority=function(a){if(a.tag===13){var u=_o(a),f=Gi(a,u);if(f!==null){var g=Kn();Yr(f,a,u,g)}Ip(a,u)}},t.attemptSynchronousHydration=function(a){switch(a.tag){case 3:var u=a.stateNode;if(u.current.memoizedState.isDehydrated){var f=ka(u.pendingLanes);f!==0&&(Gl(u,f|1),Cr(u,$t()),!(Le&6)&&(tu(),ar()))}break;case 13:A4(function(){var g=Gi(a,1);if(g!==null){var y=Kn();Yr(g,a,1,y)}}),Ip(a,1)}},t.batchedUpdates=function(a,u){var f=Le;Le|=1;try{return a(u)}finally{Le=f,Le===0&&(tu(),Hl&&ar())}},t.createComponentSelector=function(a){return{$$typeof:cp,value:a}},t.createContainer=function(a,u,f,g,y,T,L){return U4(a,u,!1,null,f,g,y,T,L)},t.createHasPseudoClassSelector=function(a){return{$$typeof:hp,value:a}},t.createHydrationContainer=function(a,u,f,g,y,T,L,G,q){return a=U4(f,g,!0,a,y,T,L,G,q),a.context=B4(null),f=a.current,g=Kn(),y=_o(f),T=ws(g,y),T.callback=u??null,po(f,T,y),a.current.lanes=y,vr(a,y,g),Cr(a,g),a},t.createPortal=function(a,u,f){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:d,key:g==null?null:""+g,children:a,containerInfo:u,implementation:f}},t.createRoleSelector=function(a){return{$$typeof:dp,value:a}},t.createTestNameSelector=function(a){return{$$typeof:fp,value:a}},t.createTextSelector=function(a){return{$$typeof:pp,value:a}},t.deferredUpdates=function(a){var u=$e,f=zt.transition;try{return zt.transition=null,$e=16,a()}finally{$e=u,zt.transition=f}},t.discreteUpdates=function(a,u,f,g,y){var T=$e,L=zt.transition;try{return zt.transition=null,$e=1,a(u,f,g,y)}finally{$e=T,zt.transition=L,Le===0&&tu()}},t.findAllNodes=vy,t.findBoundingRects=function(a,u){if(!ls)throw Error(o(363));u=vy(a,u),a=[];for(var f=0;f<u.length;f++)a.push(D_(u[f]));for(u=a.length-1;0<u;u--){f=a[u];for(var g=f.x,y=g+f.width,T=f.y,L=T+f.height,G=u-1;0<=G;G--)if(u!==G){var q=a[G],te=q.x,ge=te+q.width,Ae=q.y,le=Ae+q.height;if(g>=te&&T>=Ae&&y<=ge&&L<=le){a.splice(u,1);break}else if(g!==te||f.width!==q.width||le<T||Ae>L){if(!(T!==Ae||f.height!==q.height||ge<g||te>y)){te>g&&(q.width+=te-g,q.x=g),ge<y&&(q.width=y-te),a.splice(u,1);break}}else{Ae>T&&(q.height+=Ae-T,q.y=T),le<L&&(q.height=L-Ae),a.splice(u,1);break}}}return a},t.findHostInstance=z4,t.findHostInstanceWithNoPortals=function(a){return a=M(a),a=a!==null?fe(a):null,a===null?null:a.stateNode},t.findHostInstanceWithWarning=function(a){return z4(a)},t.flushControlled=function(a){var u=Le;Le|=1;var f=zt.transition,g=$e;try{zt.transition=null,$e=1,a()}finally{$e=g,zt.transition=f,Le=u,Le===0&&(tu(),ar())}},t.flushPassiveEffects=Fa,t.flushSync=A4,t.focusWithin=function(a,u){if(!ls)throw Error(o(363));for(a=my(a),u=k4(a,u),u=Array.from(u),a=0;a<u.length;){var f=u[a++];if(!us(f)){if(f.tag===5&&dn(f.stateNode))return!0;for(f=f.child;f!==null;)u.push(f),f=f.sibling}}return!1},t.getCurrentUpdatePriority=function(){return $e},t.getFindAllNodesFailureDescription=function(a,u){if(!ls)throw Error(o(363));var f=0,g=[];a=[my(a),0];for(var y=0;y<a.length;){var T=a[y++],L=a[y++],G=u[L];if((T.tag!==5||!us(T))&&(_y(T,G)&&(g.push(yy(G)),L++,L>f&&(f=L)),L<u.length))for(T=T.child;T!==null;)a.push(T,L),T=T.sibling}if(f<u.length){for(a=[];f<u.length;f++)a.push(yy(u[f]));return`findAllNodes was able to match part of the selector:
  `+(g.join(" > ")+`

No matching component was found for:
  `)+a.join(" > ")}return null},t.getPublicRootInstance=function(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return Be(a.child.stateNode);default:return a.child.stateNode}},t.injectIntoDevTools=function(a){if(a={bundleType:a.bundleType,version:a.version,rendererPackageName:a.rendererPackageName,rendererConfig:a.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:l.ReactCurrentDispatcher,findHostInstanceByFiber:_A,findFiberByHostInstance:a.findFiberByHostInstance||yA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")a=!1;else{var u=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(u.isDisabled||!u.supportsFiber)a=!0;else{try{zi=u.inject(a),jn=u}catch{}a=!!u.checkDCE}}return a},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(a,u,f,g){if(!ls)throw Error(o(363));a=vy(a,u);var y=Pn(a,f,g).disconnect;return{disconnect:function(){y()}}},t.registerMutableSourceForHydration=function(a,u){var f=u._getVersion;f=f(u._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[u,f]:a.mutableSourceEagerHydrationData.push(u,f)},t.runWithPriority=function(a,u){var f=$e;try{return $e=a,u()}finally{$e=f}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(a,u,f,g){var y=u.current,T=Kn(),L=_o(y);return f=B4(f),u.context===null?u.context=f:u.pendingContext=f,u=ws(T,L),u.payload={element:a},g=g===void 0?null:g,g!==null&&(u.callback=g),a=po(y,u,L),a!==null&&(Yr(a,y,L,T),Qf(a,y,L)),L},t};Rx.exports=sH;var oH=Rx.exports;const aH=Vm(oH);var xx={exports:{}},bl={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */bl.ConcurrentRoot=1;bl.ContinuousEventPriority=4;bl.DefaultEventPriority=16;bl.DiscreteEventPriority=1;bl.IdleEventPriority=536870912;bl.LegacyRoot=0;xx.exports=bl;var Ax=xx.exports;const x5={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let A5=!1,N5=!1;const SS=".react-konva-event",lH=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,uH=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,cH={};function x_(n,e,t=cH){if(!A5&&"zIndex"in e&&(console.warn(uH),A5=!0),!N5&&e.draggable){var r=e.x!==void 0||e.y!==void 0,i=e.onDragEnd||e.onDragMove;r&&!i&&(console.warn(lH),N5=!0)}for(var s in t)if(!x5[s]){var o=s.slice(0,2)==="on",l=t[s]!==e[s];if(o&&l){var c=s.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),n.off(c,t[s])}var d=!e.hasOwnProperty(s);d&&n.setAttr(s,void 0)}var p=e._useStrictMode,_={},m=!1;const E={};for(var s in e)if(!x5[s]){var o=s.slice(0,2)==="on",S=t[s]!==e[s];if(o&&S){var c=s.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),e[s]&&(E[c]=e[s])}!o&&(e[s]!==t[s]||p&&e[s]!==n.getAttr(s))&&(m=!0,_[s]=e[s])}m&&(n.setAttrs(_),Ea(n));for(var c in E)n.on(c+SS,E[c])}function Ea(n){if(!Oe.Konva.autoDrawEnabled){var e=n.getLayer()||n.getStage();e&&e.batchDraw()}}const Nx={},hH={};Wd.Node.prototype._applyProps=x_;function dH(n,e){if(typeof e=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${e}`);return}n.add(e),Ea(n)}function fH(n,e,t){let r=Wd[n];r||(console.error(`Konva has no node with the type ${n}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${n}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),r=Wd.Group);const i={},s={};for(var o in e){var l=o.slice(0,2)==="on";l?s[o]=e[o]:i[o]=e[o]}const c=new r(i);return x_(c,s),c}function pH(n,e,t){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${n}"`)}function gH(n,e,t){return!1}function mH(n){return n}function _H(){return null}function yH(){return null}function vH(n,e,t,r){return hH}function wH(){}function EH(n){}function SH(n,e){return!1}function TH(){return Nx}function CH(){return Nx}const IH=setTimeout,PH=clearTimeout,kH=-1;function RH(n,e){return!1}const xH=!1,AH=!0,NH=!0;function DH(n,e){e.parent===n?e.moveToTop():n.add(e),Ea(n)}function bH(n,e){e.parent===n?e.moveToTop():n.add(e),Ea(n)}function Dx(n,e,t){e._remove(),n.add(e),e.setZIndex(t.getZIndex()),Ea(n)}function OH(n,e,t){Dx(n,e,t)}function MH(n,e){e.destroy(),e.off(SS),Ea(n)}function LH(n,e){e.destroy(),e.off(SS),Ea(n)}function FH(n,e,t){console.error(`Text components are not yet supported in ReactKonva. You text is: "${t}"`)}function VH(n,e,t){}function UH(n,e,t,r,i){x_(n,i,r)}function BH(n){n.hide(),Ea(n)}function zH(n){}function jH(n,e){(e.visible==null||e.visible)&&n.show()}function GH(n,e){}function WH(n){}function HH(){}const $H=()=>Ax.DefaultEventPriority,qH=Object.freeze(Object.defineProperty({__proto__:null,appendChild:DH,appendChildToContainer:bH,appendInitialChild:dH,cancelTimeout:PH,clearContainer:WH,commitMount:VH,commitTextUpdate:FH,commitUpdate:UH,createInstance:fH,createTextInstance:pH,detachDeletedInstance:HH,finalizeInitialChildren:gH,getChildHostContext:CH,getCurrentEventPriority:$H,getPublicInstance:mH,getRootHostContext:TH,hideInstance:BH,hideTextInstance:zH,idlePriority:Vh.unstable_IdlePriority,insertBefore:Dx,insertInContainerBefore:OH,isPrimaryRenderer:xH,noTimeout:kH,now:Vh.unstable_now,prepareForCommit:_H,preparePortalMount:yH,prepareUpdate:vH,removeChild:MH,removeChildFromContainer:LH,resetAfterCommit:wH,resetTextContent:EH,run:Vh.unstable_runWithPriority,scheduleTimeout:IH,shouldDeprioritizeSubtree:SH,shouldSetTextContent:RH,supportsMutation:NH,unhideInstance:jH,unhideTextInstance:GH,warnsIfNotActing:AH},Symbol.toStringTag,{value:"Module"}));var KH=Object.defineProperty,QH=Object.defineProperties,YH=Object.getOwnPropertyDescriptors,D5=Object.getOwnPropertySymbols,XH=Object.prototype.hasOwnProperty,JH=Object.prototype.propertyIsEnumerable,b5=(n,e,t)=>e in n?KH(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,O5=(n,e)=>{for(var t in e||(e={}))XH.call(e,t)&&b5(n,t,e[t]);if(D5)for(var t of D5(e))JH.call(e,t)&&b5(n,t,e[t]);return n},ZH=(n,e)=>QH(n,YH(e)),M5,L5;typeof window<"u"&&((M5=window.document)!=null&&M5.createElement||((L5=window.navigator)==null?void 0:L5.product)==="ReactNative")?me.useLayoutEffect:me.useEffect;function bx(n,e,t){if(!n)return;if(t(n)===!0)return n;let r=n.child;for(;r;){const i=bx(r,e,t);if(i)return i;r=r.sibling}}function Ox(n){try{return Object.defineProperties(n,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return n}}const F5=console.error;console.error=function(){const n=[...arguments].join("");if(n!=null&&n.startsWith("Warning:")&&n.includes("useContext")){console.error=F5;return}return F5.apply(this,arguments)};const TS=Ox(me.createContext(null));class Mx extends me.Component{render(){return me.createElement(TS.Provider,{value:this._reactInternals},this.props.children)}}function e$(){const n=me.useContext(TS);if(n===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=me.useId();return me.useMemo(()=>{for(const r of[n,n==null?void 0:n.alternate]){if(!r)continue;const i=bx(r,!1,s=>{let o=s.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(i)return i}},[n,e])}function t$(){const n=e$(),[e]=me.useState(()=>new Map);e.clear();let t=n;for(;t;){if(t.type&&typeof t.type=="object"){const i=t.type._context===void 0&&t.type.Provider===t.type?t.type:t.type._context;i&&i!==TS&&!e.has(i)&&e.set(i,me.useContext(Ox(i)))}t=t.return}return e}function n$(){const n=t$();return me.useMemo(()=>Array.from(n.keys()).reduce((e,t)=>r=>me.createElement(e,null,me.createElement(t.Provider,ZH(O5({},r),{value:n.get(t)}))),e=>me.createElement(Mx,O5({},e))),[n])}function r$(n){const e=wn.useRef({});return wn.useLayoutEffect(()=>{e.current=n}),wn.useLayoutEffect(()=>()=>{e.current={}},[]),e.current}const i$=n=>{const e=wn.useRef(null),t=wn.useRef(null),r=wn.useRef(null),i=r$(n),s=n$(),o=l=>{const{forwardedRef:c}=n;c&&(typeof c=="function"?c(l):c.current=l)};return wn.useLayoutEffect(()=>(t.current=new Wd.Stage({width:n.width,height:n.height,container:e.current}),o(t.current),r.current=Fh.createContainer(t.current,Ax.LegacyRoot,!1,null),Fh.updateContainer(wn.createElement(s,{},n.children),r.current),()=>{Wd.isBrowser&&(o(null),Fh.updateContainer(null,r.current,null),t.current.destroy())}),[]),wn.useLayoutEffect(()=>{o(t.current),x_(t.current,n,i),Fh.updateContainer(wn.createElement(s,{},n.children),r.current,null)}),wn.createElement("div",{ref:e,id:n.id,accessKey:n.accessKey,className:n.className,role:n.role,style:n.style,tabIndex:n.tabIndex,title:n.title})},Hd="Layer",V5="Group",Lm="Rect",U5="Circle",B5="Line",A2="Text",Fh=aH(qH);Fh.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:wn.version,rendererPackageName:"react-konva"});const s$=wn.forwardRef((n,e)=>wn.createElement(Mx,{},wn.createElement(i$,{...n,forwardedRef:e}))),o$={},z5=n=>{let e;const t=new Set,r=(p,_)=>{const m=typeof p=="function"?p(e):p;if(!Object.is(m,e)){const E=e;e=_??(typeof m!="object"||m===null)?m:Object.assign({},e,m),t.forEach(S=>S(e,E))}},i=()=>e,c={setState:r,getState:i,getInitialState:()=>d,subscribe:p=>(t.add(p),()=>t.delete(p)),destroy:()=>{(o$?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},d=e=n(r,i,c);return c},a$=n=>n?z5(n):z5;var Lx={exports:{}},Fx={},Vx={exports:{}},Ux={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lc=me;function l$(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var u$=typeof Object.is=="function"?Object.is:l$,c$=lc.useState,h$=lc.useEffect,d$=lc.useLayoutEffect,f$=lc.useDebugValue;function p$(n,e){var t=e(),r=c$({inst:{value:t,getSnapshot:e}}),i=r[0].inst,s=r[1];return d$(function(){i.value=t,i.getSnapshot=e,Ov(i)&&s({inst:i})},[n,t,e]),h$(function(){return Ov(i)&&s({inst:i}),n(function(){Ov(i)&&s({inst:i})})},[n]),f$(t),t}function Ov(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!u$(n,t)}catch{return!0}}function g$(n,e){return e()}var m$=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?g$:p$;Ux.useSyncExternalStore=lc.useSyncExternalStore!==void 0?lc.useSyncExternalStore:m$;Vx.exports=Ux;var _$=Vx.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var A_=me,y$=_$;function v$(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var w$=typeof Object.is=="function"?Object.is:v$,E$=y$.useSyncExternalStore,S$=A_.useRef,T$=A_.useEffect,C$=A_.useMemo,I$=A_.useDebugValue;Fx.useSyncExternalStoreWithSelector=function(n,e,t,r,i){var s=S$(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=C$(function(){function c(E){if(!d){if(d=!0,p=E,E=r(E),i!==void 0&&o.hasValue){var S=o.value;if(i(S,E))return _=S}return _=E}if(S=_,w$(p,E))return S;var k=r(E);return i!==void 0&&i(S,k)?(p=E,S):(p=E,_=k)}var d=!1,p,_,m=t===void 0?null:t;return[function(){return c(e())},m===null?void 0:function(){return c(m())}]},[e,t,r,i]);var l=E$(n,s[0],s[1]);return T$(function(){o.hasValue=!0,o.value=l},[l]),I$(l),l};Lx.exports=Fx;var P$=Lx.exports;const k$=Vm(P$),Bx={},{useDebugValue:R$}=wn,{useSyncExternalStoreWithSelector:x$}=k$;let j5=!1;const A$=n=>n;function N$(n,e=A$,t){(Bx?"production":void 0)!=="production"&&t&&!j5&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),j5=!0);const r=x$(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return R$(r),r}const G5=n=>{(Bx?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?a$(n):n,t=(r,i)=>N$(e,r,i);return Object.assign(t,e),t},zx=n=>n?G5(n):G5,W5=2e3,Ns=zx(n=>({shapes:[],optimisticUpdates:new Map,addShape:e=>n(t=>({shapes:[...t.shapes,e]})),updateShape:(e,t)=>n(r=>({shapes:r.shapes.map(i=>i.id===e?{...i,...t}:i)})),updateShapeOptimistic:(e,t)=>n(r=>{const i=new Map(r.optimisticUpdates);i.set(e,{timestamp:Date.now(),updates:t});const s=Date.now();for(const[o,l]of i.entries())s-l.timestamp>W5&&i.delete(o);return{shapes:r.shapes.map(o=>o.id===e?{...o,...t}:o),optimisticUpdates:i}}),deleteShape:e=>n(t=>({shapes:t.shapes.filter(r=>r.id!==e)})),setShapes:e=>n(t=>{const r=Date.now();return{shapes:e.map(s=>{const o=t.optimisticUpdates.get(s.id);return o&&r-o.timestamp<W5?{...s,...o.updates}:s})}})})),D$=n=>{const e=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD","#98D8C8","#F7DC6F"];let t=0;for(let r=0;r<n.length;r++)t=n.charCodeAt(r)+((t<<5)-t);return e[Math.abs(t)%e.length]},Ko=zx(n=>({user:null,firebaseUser:null,isAuthenticated:!1,isLoading:!0,error:null,setUser:(e,t)=>n({user:e,firebaseUser:t,isAuthenticated:!!e,error:null}),setLoading:e=>n({isLoading:e}),setError:e=>n({error:e,isLoading:!1}),clearUser:()=>n({user:null,firebaseUser:null,isAuthenticated:!1,isLoading:!1})})),b$=n=>{var t;const e=n.displayName||((t=n.email)==null?void 0:t.split("@")[0])||"Anonymous User";return{uid:n.uid,displayName:e.length>20?e.substring(0,20):e,email:n.email||"",cursorColor:D$(n.uid)}},O$=async n=>{const e=pa(),t=Cl(e,`/sessions/global-canvas-v1/${n.uid}`),r={userId:n.uid,displayName:n.displayName||"Anonymous",email:n.email||"",cursorColor:n.cursorColor,cursorX:0,cursorY:0,lastSeen:Am(),isOnline:!0,currentlyEditing:null};await L0(t,r),await WR(t).set({...r,isOnline:!1,lastSeen:Am(),currentlyEditing:null}),console.log(`🟢 Presence initialized for ${n.displayName}`)},M$=async(n,e,t,r=null)=>{const i=pa(),s={[`/sessions/global-canvas-v1/${n}/cursorX`]:e,[`/sessions/global-canvas-v1/${n}/cursorY`]:t,[`/sessions/global-canvas-v1/${n}/lastSeen`]:Am(),[`/sessions/global-canvas-v1/${n}/isOnline`]:!0};r!==void 0&&(s[`/sessions/global-canvas-v1/${n}/currentlyEditing`]=r),await L0(Cl(i),s)},jx=n=>{const e=pa(),t=Cl(e,"/sessions/global-canvas-v1");return sS(t,r=>{const i=r.val()||{};n(i)}),()=>HR(t)},L$=async n=>{const e=pa(),t=Cl(e,`/sessions/global-canvas-v1/${n}`);await L0(t,{isOnline:!1,lastSeen:Am(),currentlyEditing:null}),console.log(`🔴 Presence cleaned up for user: ${n}`)},F$=(n,e=null)=>{const t=me.useRef(null),r=me.useRef(!1);return{updateCursor:me.useCallback((s,o)=>{n&&(t.current={x:s,y:o},r.current||(r.current=!0,requestAnimationFrame(()=>{if(t.current&&n){const{x:l,y:c}=t.current;M$(n.uid,l,c,e).catch(console.error)}r.current=!1})))},[n,e])}},V$=(n,e)=>{if(!e.current)return null;const t=e.current.getPointerPosition();return t?{x:t.x,y:t.y}:null},U$=(n,e)=>{const t=me.useRef({x:0,y:0,time:0}),r=me.useCallback(d=>{d.evt.preventDefault(),d.evt.stopPropagation();const p=n.current;if(!p)return;e==null||e(!0);const{deltaX:_,deltaY:m,ctrlKey:E,metaKey:S}=d.evt,k=Math.abs(m)<50;E||S?i(d,p,m):k&&(Math.abs(_)>0||Math.abs(m)>0)?s(p,_,m):i(d,p,m),setTimeout(()=>e==null?void 0:e(!1),50)},[n,e]),i=me.useCallback((d,p,_)=>{const m=p.getPointerPosition();if(!m)return;const E=p.scaleX(),S=1+Math.abs(_)*.02,k=_>0?E/S:E*S,N=Math.max(.01,Math.min(100,k)),x={x:(m.x-p.x())/E,y:(m.y-p.y())/E};p.scale({x:N,y:N});const R={x:m.x-x.x*N,y:m.y-x.y*N},w=o(R,p,N);p.position(w)},[]),s=me.useCallback((d,p,_)=>{const m=d.position(),E=Date.now(),S={x:m.x-p,y:m.y-_},k=d.scaleX(),N=o(S,d,k);d.position(N),t.current={x:p,y:_,time:E}},[]),o=me.useCallback((d,p,_)=>{const m=p.width(),E=p.height(),S=5e3*_,k=5e3*_,N=Math.min(m,E)*.1;return{x:Math.max(m-S-N,Math.min(N,d.x)),y:Math.max(E-k-N,Math.min(N,d.y))}},[]),l=me.useCallback(d=>{},[]),c=me.useCallback(d=>{d.evt.preventDefault()},[]);return{handleWheel:r,handleTouchStart:l,handleTouchMove:c}};var bn=[];for(var Mv=0;Mv<256;++Mv)bn.push((Mv+256).toString(16).slice(1));function B$(n,e=0){return(bn[n[e+0]]+bn[n[e+1]]+bn[n[e+2]]+bn[n[e+3]]+"-"+bn[n[e+4]]+bn[n[e+5]]+"-"+bn[n[e+6]]+bn[n[e+7]]+"-"+bn[n[e+8]]+bn[n[e+9]]+"-"+bn[n[e+10]]+bn[n[e+11]]+bn[n[e+12]]+bn[n[e+13]]+bn[n[e+14]]+bn[n[e+15]]).toLowerCase()}var tg,z$=new Uint8Array(16);function j$(){if(!tg&&(tg=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!tg))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return tg(z$)}var G$=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const H5={randomUUID:G$};function W$(n,e,t){if(H5.randomUUID&&!n)return H5.randomUUID();n=n||{};var r=n.random||(n.rng||j$)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,B$(r)}const N_="canvas/global-canvas-v1/shapes",H$=async(n,e,t,r)=>{try{const i=W$(),s=cf(nr,N_),o={type:"rectangle",x:n,y:e,width:100,height:100,fill:"#CCCCCC",text:"",textColor:"#000000",fontSize:14,createdBy:t,createdAt:Zu(),lastModifiedBy:t,lastModifiedAt:Zu(),isLocked:!1,lockedBy:null};return await FF(fa(s,i),o),console.log(`🎯 Shape created by ${r}:`,i),i}catch(i){throw console.error("Error creating shape:",i),i}},$$=(n,e)=>{try{const t=cf(nr,N_),r=C9(t,OF("createdAt","asc"));return VF(r,s=>{const o=[];s.forEach(l=>{l.exists()&&o.push({id:l.id,...l.data()})}),console.log(`🔄 Shapes synced: ${o.length} total`),n(o)},s=>{console.error("Error subscribing to shapes:",s),e==null||e(s)})}catch(t){throw console.error("Error setting up shapes subscription:",t),t}},q$=async(n,e,t)=>{try{const r=fa(nr,N_,n);await x9(r,{...e,lastModifiedBy:t,lastModifiedAt:Zu()}),console.log("📝 Shape updated:",n)}catch(r){throw console.error("Error updating shape:",r),r}},K$=async n=>{try{const e=fa(nr,N_,n);await A9(e),console.log("🗑️ Shape deleted:",n)}catch(e){throw console.error("Error deleting shape:",e),e}},Q$=()=>{const{setShapes:n}=Ns();me.useEffect(()=>{console.log("🔄 Setting up shape sync...");const e=$$(t=>{n(t),console.log(`📦 Loaded ${t.length} shapes from Firestore:`),t.forEach(r=>{console.log(`   Shape ${r.id}: (${r.x}, ${r.y}) locked: ${r.isLocked}`)})},t=>{console.error("❌ Shape sync error:",t)});return()=>{console.log("🔄 Cleaning up shape sync..."),e==null||e()}},[n])},Fm="canvas/global-canvas-v1/shapes",N2=async(n,e,t,r)=>{try{const i=fa(nr,Fm,n);return await CE(nr,async o=>{const l=await o.get(i);if(!l.exists())throw new Error("Shape not found");const c=l.data();return c.isLocked&&c.lockedBy!==e?{success:!1,alreadyLocked:!0,lockedBy:c.lockedBy}:(o.update(i,{isLocked:!0,lockedBy:e,lockedByName:t,lockedByColor:r,lastModifiedBy:e,lastModifiedAt:Zu()}),console.log(`🔒 Lock acquired by ${t} for shape:`,n),{success:!0})})}catch(i){return console.error("Error acquiring lock:",i),{success:!1,error:i instanceof Error?i.message:"Unknown error"}}},Pg=async(n,e,t,r)=>{try{const i=fa(nr,Fm,n);return await CE(nr,async o=>{const l=await o.get(i);if(!l.exists())throw new Error("Shape not found");if(l.data().lockedBy!==e)return console.warn("Cannot release lock not owned by user"),{success:!1,error:"Lock not owned by user"};const d={isLocked:!1,lockedBy:null,lockedByName:null,lockedByColor:null,lastModifiedBy:e,lastModifiedAt:Zu()};return o.update(i,d),console.log(`🔓 Lock released by ${t} for shape:`,n,r?`with position (${r.x}, ${r.y})`:"without position update"),{success:!0}})}catch(i){return console.error("Error releasing lock:",i),{success:!1,error:i instanceof Error?i.message:"Unknown error"}}},Y$=async(n,e)=>{try{const t=pa(),r=Cl(t,`presence/${n}`);await L0(r,{userId:n,displayName:e,online:!0,lastSeen:Date.now()}),await WR(r).set({userId:n,displayName:e,online:!1,lastSeen:Date.now()}),console.log(`🔒 Set up disconnect cleanup for user: ${e}`)}catch(t){console.error("Error setting up disconnect cleanup:",t)}},X$=async n=>{try{console.log(`🧹 Force releasing all locks for user: ${n}`);const e=cf(nr,Fm),t=C9(e,bF("lockedBy","==",n)),r=await SE(t),i=r.docs.map(async s=>{const o=fa(nr,Fm,s.id);return CE(nr,async l=>{const c=await l.get(o);c.exists()&&c.data().lockedBy===n&&(l.update(o,{isLocked:!1,lockedBy:null,lastModifiedAt:Zu()}),console.log(`🔓 Force unlocked shape: ${s.id}`))})});await Promise.all(i),console.log(`✅ Released ${r.docs.length} locks for user: ${n}`)}catch(e){console.error("Error force releasing user locks:",e)}},J$=()=>{me.useEffect(()=>{const n=pa(),e=Cl(n,"presence"),t=r=>{if(!r.exists())return;const i=r.val();Object.entries(i).forEach(([s,o])=>{const l=o;!l.online&&Date.now()-l.lastSeen>5e3&&(console.log(`👻 Detected offline user: ${l.displayName}, cleaning up locks`),X$(s).catch(c=>{console.error("Failed to cleanup locks for offline user:",c)}))})};return sS(e,t),()=>{HR(e,"value",t)}},[])},Z$=({width:n,height:e,listening:t})=>{const i=[];for(let o=0;o<=n/50;o++){const l=o*50;i.push(z.jsx(B5,{points:[l,0,l,e],stroke:"#f0f0f0",strokeWidth:.5,listening:!1},`v-${o}`))}const s=[];for(let o=0;o<=e/50;o++){const l=o*50;s.push(z.jsx(B5,{points:[0,l,n,l],stroke:"#f0f0f0",strokeWidth:.5,listening:!1},`h-${o}`))}return z.jsxs(Hd,{listening:t,children:[z.jsx(Lm,{x:0,y:0,width:n,height:e,fill:"white",listening:!1}),i,s,z.jsx(Lm,{x:0,y:0,width:n,height:e,stroke:"#cccccc",strokeWidth:2,fill:"transparent",listening:!1})]})},Gx=wn.memo(({shape:n})=>{const{shapes:e}=Ns(),{user:t}=Ko(),r=n.isLocked&&n.lockedBy===(t==null?void 0:t.uid),i=n.isLocked&&n.lockedBy!==(t==null?void 0:t.uid),s=!i&&!!t,o=me.useCallback(async()=>{if(!i&&t){if(r){console.log(`Already locked by me: ${n.id}`);return}const{updateShapeOptimistic:p}=Ns.getState(),_=e.filter(m=>m.lockedBy===t.uid&&m.id!==n.id);_.forEach(m=>{p(m.id,{isLocked:!1,lockedBy:null,lockedByName:null,lockedByColor:null})}),p(n.id,{isLocked:!0,lockedBy:t.uid,lockedByName:t.displayName,lockedByColor:t.cursorColor}),Promise.all([..._.map(m=>Pg(m.id,t.uid,t.displayName)),N2(n.id,t.uid,t.displayName,t.cursorColor)]).catch(m=>{console.error("Background sync failed:",m)}),console.log(`⚡ Instant selection: ${n.id}`)}},[n.id,e,i,r,t]),l=me.useCallback(async p=>{if(!t){p.target.stopDrag();return}if(!e.find(m=>m.id===n.id)){console.warn(`Shape ${n.id} no longer exists, stopping drag`),p.target.stopDrag();return}try{const m=e.filter(S=>S.lockedBy===t.uid&&S.id!==n.id);m.length>0&&await Promise.all(m.map(S=>Pg(S.id,t.uid,t.displayName)));const E=await N2(n.id,t.uid,t.displayName,t.cursorColor);E.success||(console.warn(`Failed to acquire lock: ${E.error}`),p.target.stopDrag())}catch(m){console.error("Error in drag start:",m),p.target.stopDrag()}},[t,n.id,e]),c=me.useCallback(async p=>{if(!t)return;const _=p.target,m=_.x(),E=_.y();try{if(!e.find(k=>k.id===n.id)){console.warn(`Shape ${n.id} was deleted during drag`);return}await q$(n.id,{x:m,y:E},t.uid),console.log(`✅ Drag completed: ${n.id} -> (${m}, ${E}) - kept locked`)}catch(S){console.error("Drag end failed:",S);try{_.x(n.x),_.y(n.y),console.log(`🔄 Reset shape ${n.id} to original position after error`),await Pg(n.id,t.uid,t.displayName)}catch(k){console.error("Failed to reset shape position:",k)}}},[t,n.id,n.x,n.y,e]),d=me.useCallback(p=>{const _=Math.round(p.x/20)*20,m=Math.round(p.y/20)*20;return{x:Math.max(0,Math.min(4900,_)),y:Math.max(0,Math.min(4900,m))}},[]);return z.jsxs(z.Fragment,{children:[z.jsx(Lm,{x:n.x,y:n.y,width:n.width,height:n.height,fill:n.fill,stroke:r?(t==null?void 0:t.cursorColor)||"#0066ff":i?n.lockedByColor||"#ff6b6b":"transparent",strokeWidth:r||i?2:0,draggable:s,dragBoundFunc:s?d:void 0,onClick:o,onDragStart:l,onDragEnd:c}),n.text&&z.jsx(A2,{x:n.x,y:n.y+42,width:n.width,text:n.text,fontSize:14,fill:"#000",align:"center",listening:!1}),i&&z.jsx(A2,{x:n.x,y:n.y-20,text:`🔒 Locked: ${n.lockedByName||"Another user"}`,fontSize:12,fontFamily:"sans-serif",fill:n.lockedByColor||"#ff6b6b",listening:!1})]})});Gx.displayName="SimpleShape";const eq=({listening:n})=>{const{shapes:e}=Ns();return z.jsx(Hd,{listening:n,children:e.map(t=>z.jsx(Gx,{shape:t},t.id))})},tq=({listening:n})=>z.jsx(Hd,{listening:n}),nq=()=>{const{user:n}=Ko(),[e,t]=me.useState({});me.useEffect(()=>jx(s=>{const o=Object.entries(s).reduce((l,[c,d])=>(c!==(n==null?void 0:n.uid)&&d.isOnline&&(l[c]=d),l),{});t(o)}),[n==null?void 0:n.uid]);const r=Object.values(e);return r.length===0?z.jsx(Hd,{listening:!1}):z.jsx(Hd,{listening:!1,children:r.map(i=>z.jsx(rq,{presence:i},i.userId))})},rq=({presence:n})=>{const{cursorX:e,cursorY:t,displayName:r,cursorColor:i,currentlyEditing:s}=n;return z.jsxs(V5,{x:e,y:t,children:[z.jsx(U5,{radius:8,fill:i,stroke:"white",strokeWidth:2}),z.jsxs(V5,{x:15,y:-5,children:[z.jsx(Lm,{width:r.length*6+8,height:20,fill:i,cornerRadius:3}),z.jsx(A2,{text:r,fontSize:12,fontFamily:"Arial",fill:"white",x:4,y:4})]}),s&&z.jsx(U5,{x:0,y:20,radius:4,fill:"orange",stroke:"white",strokeWidth:1})]})},Lv=5e3,Fv=5e3,iq=({width:n,height:e})=>{var R;const t=me.useRef(null),[r,i]=me.useState(!1),[s,o]=me.useState(!1),{shapes:l}=Ns(),{user:c}=Ko(),d=((R=l.find(w=>w.lockedBy===(c==null?void 0:c.uid)))==null?void 0:R.id)||null,{updateCursor:p}=F$(c,d),{handleWheel:_,handleTouchStart:m,handleTouchMove:E}=U$(t,o);Q$(),J$();const S=me.useCallback(async()=>{if(!c)return;const{shapes:w,deleteShape:P}=Ns.getState(),F=w.find(U=>U.lockedBy===c.uid);if(!F){console.log("No shape selected for deletion");return}P(F.id),console.log(`⚡ Instantly deleted: ${F.id}`);try{await K$(F.id),console.log(`🗑️ Deletion synced to Firestore: ${F.id}`)}catch(U){console.error("Deletion sync failed:",U);const{addShape:D}=Ns.getState();D(F),console.log(`🔄 Restored shape after sync failure: ${F.id}`)}},[c]);me.useEffect(()=>{const w=U=>{if((U.key==="Delete"||U.key==="Backspace")&&!U.repeat){U.preventDefault(),S();return}if(U.code==="Space"&&!U.repeat&&!r){U.preventDefault(),i(!0);const D=t.current;D&&(D.find("Rect").forEach(C=>C.draggable(!1)),D.draggable(!0)),console.log("⌨️ Space pressed - panning mode enabled")}},P=U=>{if(U.code==="Space"){i(!1);const D=t.current;D&&(D.draggable(!1),D.find("Rect").forEach(C=>{const b=C.id(),{shapes:A}=Ns.getState(),M=A.find(V=>V.id===b),B=(M==null?void 0:M.isLocked)&&(M==null?void 0:M.lockedBy)!==(c==null?void 0:c.uid);C.draggable(!B&&!!c)})),console.log("⌨️ Space released - panning mode disabled")}},F=()=>{i(!1);const U=t.current;U&&U.draggable(!1),console.log("🪟 Window blur - reset panning state")};return window.addEventListener("keydown",w),window.addEventListener("keyup",P),window.addEventListener("blur",F),()=>{window.removeEventListener("keydown",w),window.removeEventListener("keyup",P),window.removeEventListener("blur",F)}},[r,c,S]);const k=me.useCallback(w=>{const P=n-Lv,F=e-Fv;return{x:Math.max(P,Math.min(0,w.x)),y:Math.max(F,Math.min(0,w.y))}},[n,e]),N=me.useCallback(async w=>{if(w.target!==t.current||r||!c)return;const{shapes:P}=Ns.getState(),F=P.filter(b=>b.lockedBy===c.uid);if(F.length>0){await Promise.all(F.map(b=>Pg(b.id,c.uid,c.displayName))),console.log(`🔓 Released ${F.length} locks`);return}const D=t.current.getRelativePointerPosition(),C=await H$(Math.max(0,Math.min(Lv-100,D.x)),Math.max(0,Math.min(Fv-100,D.y)),c.uid,c.displayName);await N2(C,c.uid,c.displayName,c.cursorColor),console.log("✨ Shape created and locked:",C)},[r,c]),x=me.useCallback(w=>{if(s||r)return;const P=V$(w.evt,t);P&&c&&p(P.x,P.y)},[p,c,s,r]);return z.jsxs("div",{className:`relative overflow-hidden bg-white border border-gray-300 rounded-lg shadow-sm ${r?"cursor-grab":"cursor-default"}`,children:[z.jsxs(s$,{ref:t,width:n,height:e,draggable:!1,dragBoundFunc:r?k:void 0,onWheel:_,onTouchStart:m,onTouchMove:E,onClick:N,onTap:N,onMouseMove:x,children:[z.jsx(Z$,{width:Lv,height:Fv,listening:!1}),z.jsx(eq,{listening:!r}),z.jsx(tq,{listening:!1}),z.jsx(nq,{})]}),z.jsxs("div",{className:"absolute top-2 right-2 text-xs text-gray-500 bg-white px-2 py-1 rounded shadow",children:["Scale: ",t.current?(t.current.scaleX()*100).toFixed(0):"100","%"]}),r&&z.jsx("div",{className:"absolute bottom-2 left-2 text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded shadow",children:"Space + Drag to Pan"})]})},sq=async()=>{try{console.log("🧹 Clearing all locks...");const n=cf(nr,"canvas/global-canvas-v1/shapes"),e=await SE(n),t=e.docs.map(async r=>{const i=fa(nr,"canvas/global-canvas-v1/shapes",r.id);await x9(i,{isLocked:!1,lockedBy:null}),console.log(`🔓 Cleared lock for shape: ${r.id}`)});return await Promise.all(t),console.log(`✅ Cleared ${e.docs.length} locks successfully!`),{success:!0,clearedCount:e.docs.length}}catch(n){return console.error("❌ Error clearing locks:",n),{success:!1,error:n}}},oq=async()=>{try{console.log("🗑️ Clearing all shapes...");const n=cf(nr,"canvas/global-canvas-v1/shapes"),e=await SE(n),t=e.docs.map(async r=>{const i=fa(nr,"canvas/global-canvas-v1/shapes",r.id);await A9(i),console.log(`🗑️ Deleted shape: ${r.id}`)});return await Promise.all(t),console.log(`✅ Deleted ${e.docs.length} shapes successfully!`),{success:!0,deletedCount:e.docs.length}}catch(n){return console.error("❌ Error clearing shapes:",n),{success:!1,error:n}}},aq=()=>{const{user:n,isAuthenticated:e}=Ko(),[t,r]=me.useState(!1),[i,s]=me.useState(!1),o=async()=>{try{await Pb(ic)}catch(d){console.error("Error signing out:",d)}},l=async()=>{if(confirm("⚠️ This will delete ALL shapes permanently. Are you sure?")){s(!0);try{const d=await oq();d.success?alert(`✅ Successfully deleted ${d.deletedCount} shapes!`):alert(`❌ Failed to clear shapes: ${d.error}`)}catch(d){alert(`❌ Error: ${d}`)}s(!1),r(!1)}},c=async()=>{s(!0);try{const d=await sq();d.success?alert(`✅ Successfully cleared ${d.clearedCount} locks!`):alert(`❌ Failed to clear locks: ${d.error}`)}catch(d){alert(`❌ Error: ${d}`)}s(!1),r(!1)};return e?z.jsxs("header",{className:"bg-white border-b border-gray-200 px-4 py-3 flex justify-between items-center",children:[z.jsxs("div",{className:"flex items-center space-x-4",children:[z.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:"CollabCanvas"}),z.jsx("div",{className:"text-sm text-gray-500",children:"Real-Time Collaborative Design Tool"})]}),z.jsxs("div",{className:"flex items-center space-x-4",children:[z.jsxs("div",{className:"flex items-center space-x-2",children:[z.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:n==null?void 0:n.cursorColor}}),z.jsx("span",{className:"text-sm font-medium text-gray-700",children:n==null?void 0:n.displayName})]}),z.jsxs("div",{className:"relative",children:[z.jsx("button",{onClick:()=>r(!t),className:"text-xs text-gray-400 hover:text-red-600 px-2 py-1 rounded border border-gray-200 hover:border-red-300",title:"Admin Panel",children:"🛠️"}),t&&z.jsxs("div",{className:"absolute right-0 top-8 bg-white border border-gray-300 rounded shadow-lg p-3 z-50 min-w-[200px]",children:[z.jsx("div",{className:"text-xs font-medium text-gray-600 mb-2",children:"Admin Panel"}),z.jsx("button",{onClick:c,disabled:i,className:"w-full text-left text-xs text-blue-600 hover:text-blue-800 px-2 py-1 rounded hover:bg-blue-50 disabled:opacity-50",children:"🔓 Clear All Locks"}),z.jsx("button",{onClick:l,disabled:i,className:"w-full text-left text-xs text-red-600 hover:text-red-800 px-2 py-1 rounded hover:bg-red-50 disabled:opacity-50",children:"🗑️ Delete All Shapes"}),i&&z.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"Working..."})]})]}),z.jsx("button",{onClick:o,className:"text-sm text-gray-500 hover:text-gray-700 px-3 py-1 rounded border border-gray-300 hover:border-gray-400",children:"Sign Out"})]})]}):null},lq=()=>{const{setUser:n,setLoading:e,setError:t,clearUser:r}=Ko();return me.useEffect(()=>{const i=Ib(ic,async s=>{try{if(s){const o=b$(s);n(o,s),console.log("🔥 User authenticated:",o.displayName),await O$(o),await Y$(o.uid,o.displayName)}else{const{user:o}=Ko.getState();o&&await L$(o.uid),r(),console.log("🔥 User signed out")}}catch(o){console.error("Auth state change error:",o),t("Authentication error occurred")}finally{e(!1)}},s=>{console.error("Auth state observer error:",s),t("Failed to initialize authentication"),e(!1)});return()=>i()},[n,e,t,r]),Ko()},uq=({children:n,fallback:e})=>{const{isAuthenticated:t,isLoading:r,error:i}=lq();return r?z.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:z.jsx("div",{className:"bg-white rounded-lg shadow-md p-8",children:z.jsxs("div",{className:"text-center",children:[z.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),z.jsx("p",{className:"text-gray-600",children:"Checking authentication..."})]})})}):i?z.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:z.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 max-w-md",children:[z.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Authentication Error"}),z.jsx("p",{className:"text-gray-700 mb-4",children:"Firebase authentication error:"}),z.jsx("p",{className:"text-sm text-red-600 bg-red-50 p-3 rounded mb-4",children:i}),z.jsx("button",{onClick:()=>window.location.reload(),className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700",children:"Reload Page"})]})}):t?z.jsx(z.Fragment,{children:n}):z.jsx(z.Fragment,{children:e})};class $5 extends me.Component{constructor(t){super(t);by(this,"handleReload",()=>{window.location.reload()});by(this,"handleRetry",()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0})});this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){console.error("🚨 React Error Boundary caught an error:",t),console.error("Error Info:",r),this.setState({error:t,errorInfo:r})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:z.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center px-4",children:z.jsx("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6",children:z.jsxs("div",{className:"text-center",children:[z.jsx("div",{className:"text-6xl mb-4",children:"🚨"}),z.jsx("h1",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Something went wrong"}),z.jsx("p",{className:"text-gray-600 mb-6",children:"The canvas encountered an unexpected error. This shouldn't happen often."}),z.jsxs("div",{className:"space-y-3",children:[z.jsx("button",{onClick:this.handleRetry,className:"w-full bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors",children:"Try Again"}),z.jsx("button",{onClick:this.handleReload,className:"w-full bg-gray-200 text-gray-900 px-4 py-2 rounded-md hover:bg-gray-300 transition-colors",children:"Reload Page"})]}),!1]})})}):this.props.children}}const cq=()=>{const[n,e]=me.useState({isOnline:!0,isConnecting:!1,lastConnected:null});return me.useEffect(()=>{const t=pa(),r=Cl(t,".info/connected"),i=sS(r,s=>{const o=s.val()===!0,l=new Date;e(c=>({isOnline:o,isConnecting:!o&&c.isOnline,lastConnected:o?l:c.lastConnected})),console.log(o?"🟢 Firebase connected":"🔴 Firebase disconnected - showing reconnection banner")});return()=>i()},[]),n},hq=()=>{const{isOnline:n,isConnecting:e}=cq();return n&&!e?null:z.jsxs("div",{className:"fixed top-0 left-0 right-0 z-50 bg-amber-500 text-white px-4 py-2 text-center text-sm font-medium shadow-lg",children:[z.jsxs("div",{className:"flex items-center justify-center gap-2",children:[z.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),z.jsx("span",{children:e?"Reconnecting...":"Connection lost - trying to reconnect"})]}),z.jsx("div",{className:"text-xs mt-1 opacity-90",children:"Changes will sync when connection is restored"})]})},dq=()=>{const{user:n}=Ko(),[e,t]=me.useState({});me.useEffect(()=>jx(s=>{const o=Object.entries(s).reduce((l,[c,d])=>(d.isOnline&&(l[c]=d),l),{});t(o)}),[]);const r=Object.values(e);return z.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[z.jsxs("h3",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2",children:["👥 Online Users",z.jsx("span",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full",children:r.length})]}),z.jsx("div",{className:"space-y-2",children:r.length===0?z.jsx("div",{className:"text-xs text-gray-500 italic",children:"No users online"}):r.map(i=>z.jsx(fq,{presence:i,isCurrentUser:i.userId===(n==null?void 0:n.uid)},i.userId))}),z.jsx("div",{className:"mt-4 pt-3 border-t border-gray-100",children:z.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[z.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),z.jsx("span",{children:"Real-time connected"})]})})]})},fq=({presence:n,isCurrentUser:e})=>{const{displayName:t,cursorColor:r,currentlyEditing:i}=n;return z.jsxs("div",{className:`flex items-center gap-3 p-2 rounded-lg ${e?"bg-blue-50 border border-blue-200":"hover:bg-gray-50"}`,children:[z.jsx("div",{className:"w-3 h-3 rounded-full border border-white shadow-sm",style:{backgroundColor:r}}),z.jsxs("div",{className:"flex-1 min-w-0",children:[z.jsxs("div",{className:"flex items-center gap-1",children:[z.jsx("span",{className:"text-sm font-medium text-gray-900 truncate",children:t}),e&&z.jsx("span",{className:"text-xs text-blue-600 font-medium",children:"(you)"})]}),z.jsx("div",{className:"text-xs text-gray-500",children:i?z.jsxs("div",{className:"flex items-center gap-1",children:[z.jsx("span",{children:"✏️"}),z.jsx("span",{children:"Editing shape"})]}):z.jsx("span",{children:"👀 Viewing canvas"})})]}),z.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"})]})};function pq(){const n=z.jsxs("div",{className:"container mx-auto px-4 py-8",children:[z.jsx("h1",{className:"text-4xl font-bold text-center text-gray-800 mb-8",children:"CollabCanvas MVP"}),z.jsxs("div",{className:"text-center mb-8",children:[z.jsx("p",{className:"text-lg text-gray-600 mb-2",children:"Real-Time Collaborative Design Tool"}),z.jsx("p",{className:"text-sm text-gray-500",children:"Please sign in to continue"})]}),z.jsx(nz,{})]});return z.jsx($5,{children:z.jsxs("div",{className:"min-h-screen bg-gray-50",children:[z.jsx(hq,{}),z.jsx(uq,{fallback:n,children:z.jsxs("div",{className:"h-screen flex flex-col",children:[z.jsx(aq,{}),z.jsx("main",{className:"flex-1 p-4",children:z.jsxs("div",{className:"h-full flex",children:[z.jsx($5,{fallback:z.jsxs("div",{className:"flex-1 mr-4 bg-white rounded-lg border border-red-200 p-8 text-center",children:[z.jsx("div",{className:"text-4xl mb-4",children:"🎨"}),z.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Canvas Error"}),z.jsx("p",{className:"text-gray-600 mb-4",children:"The canvas encountered an error. Try refreshing the page."}),z.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Reload Canvas"})]}),children:z.jsx("div",{className:"flex-1 mr-4",children:z.jsx(iq,{width:800,height:600})})}),z.jsxs("div",{className:"w-64 space-y-4",children:[z.jsx(dq,{}),z.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[z.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Canvas Tools"}),z.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[z.jsxs("div",{children:["• ",z.jsx("strong",{children:"Click empty space"})," → Create rectangles"]}),z.jsxs("div",{children:["• ",z.jsx("strong",{children:"Click & drag shapes"})," → Move them"]}),z.jsxs("div",{children:["• ",z.jsx("strong",{children:"Click shapes"})," → Select/lock them"]}),z.jsxs("div",{children:["• ",z.jsx("strong",{children:"Trackpad scroll"})," → Pan canvas (Figma-style)"]}),z.jsxs("div",{children:["• ",z.jsx("strong",{children:"⌘/Ctrl + scroll"})," → Zoom (or pinch)"]}),z.jsxs("div",{children:["• ",z.jsx("strong",{children:"Mouse wheel"})," → Zoom"]}),z.jsxs("div",{children:["• ",z.jsx("strong",{children:"Space + drag"})," → Pan (power users)"]}),z.jsxs("div",{children:["• ",z.jsx("strong",{children:"Delete key"})," → Delete selected shape"]})]}),z.jsxs("div",{className:"mt-6",children:[z.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Progress:"}),z.jsxs("div",{className:"space-y-1 text-sm text-gray-500",children:[z.jsx("div",{children:"✅ Canvas & Figma-style Navigation"}),z.jsx("div",{children:"✅ Shape Creation & Real-time Sync"}),z.jsx("div",{children:"✅ Selection & Multiplayer Locking"}),z.jsx("div",{children:"✅ Drag & Drop with Constraints"}),z.jsx("div",{children:"✅ Shape Deletion (optimistic)"}),z.jsx("div",{children:"✅ Error Handling & Connection Status"}),z.jsx("div",{children:"✅ Multiplayer Cursors & Presence"})]})]}),!1]})]})]})})]})})]})})}Vv.createRoot(document.getElementById("root")).render(z.jsx(wn.StrictMode,{children:z.jsx(pq,{})}));
