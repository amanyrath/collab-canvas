(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var UE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ad(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var jC={exports:{}},hm={},WC={exports:{}},Fe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kd=Symbol.for("react.element"),rA=Symbol.for("react.portal"),iA=Symbol.for("react.fragment"),sA=Symbol.for("react.strict_mode"),oA=Symbol.for("react.profiler"),aA=Symbol.for("react.provider"),lA=Symbol.for("react.context"),uA=Symbol.for("react.forward_ref"),cA=Symbol.for("react.suspense"),hA=Symbol.for("react.memo"),dA=Symbol.for("react.lazy"),zE=Symbol.iterator;function fA(n){return n===null||typeof n!="object"?null:(n=zE&&n[zE]||n["@@iterator"],typeof n=="function"?n:null)}var HC={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},$C=Object.assign,qC={};function qu(n,e,t){this.props=n,this.context=e,this.refs=qC,this.updater=t||HC}qu.prototype.isReactComponent={};qu.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};qu.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function KC(){}KC.prototype=qu.prototype;function Fv(n,e,t){this.props=n,this.context=e,this.refs=qC,this.updater=t||HC}var Vv=Fv.prototype=new KC;Vv.constructor=Fv;$C(Vv,qu.prototype);Vv.isPureReactComponent=!0;var BE=Array.isArray,QC=Object.prototype.hasOwnProperty,Uv={current:null},YC={key:!0,ref:!0,__self:!0,__source:!0};function XC(n,e,t){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)QC.call(e,r)&&!YC.hasOwnProperty(r)&&(i[r]=e[r]);var u=arguments.length-2;if(u===1)i.children=t;else if(1<u){for(var c=Array(u),d=0;d<u;d++)c[d]=arguments[d+2];i.children=c}if(n&&n.defaultProps)for(r in u=n.defaultProps,u)i[r]===void 0&&(i[r]=u[r]);return{$$typeof:kd,type:n,key:s,ref:o,props:i,_owner:Uv.current}}function pA(n,e){return{$$typeof:kd,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function zv(n){return typeof n=="object"&&n!==null&&n.$$typeof===kd}function gA(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var GE=/\/+/g;function q_(n,e){return typeof n=="object"&&n!==null&&n.key!=null?gA(""+n.key):e.toString(36)}function Up(n,e,t,r,i){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case kd:case rA:o=!0}}if(o)return o=n,i=i(o),n=r===""?"."+q_(o,0):r,BE(i)?(t="",n!=null&&(t=n.replace(GE,"$&/")+"/"),Up(i,e,t,"",function(d){return d})):i!=null&&(zv(i)&&(i=pA(i,t+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(GE,"$&/")+"/")+n)),e.push(i)),1;if(o=0,r=r===""?".":r+":",BE(n))for(var u=0;u<n.length;u++){s=n[u];var c=r+q_(s,u);o+=Up(s,e,t,c,i)}else if(c=fA(n),typeof c=="function")for(n=c.call(n),u=0;!(s=n.next()).done;)s=s.value,c=r+q_(s,u++),o+=Up(s,e,t,c,i);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function up(n,e,t){if(n==null)return n;var r=[],i=0;return Up(n,r,"","",function(s){return e.call(t,s,i++)}),r}function mA(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var fr={current:null},zp={transition:null},_A={ReactCurrentDispatcher:fr,ReactCurrentBatchConfig:zp,ReactCurrentOwner:Uv};function JC(){throw Error("act(...) is not supported in production builds of React.")}Fe.Children={map:up,forEach:function(n,e,t){up(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return up(n,function(){e++}),e},toArray:function(n){return up(n,function(e){return e})||[]},only:function(n){if(!zv(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};Fe.Component=qu;Fe.Fragment=iA;Fe.Profiler=oA;Fe.PureComponent=Fv;Fe.StrictMode=sA;Fe.Suspense=cA;Fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_A;Fe.act=JC;Fe.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=$C({},n.props),i=n.key,s=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Uv.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var u=n.type.defaultProps;for(c in e)QC.call(e,c)&&!YC.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&u!==void 0?u[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=t;else if(1<c){u=Array(c);for(var d=0;d<c;d++)u[d]=arguments[d+2];r.children=u}return{$$typeof:kd,type:n.type,key:i,ref:s,props:r,_owner:o}};Fe.createContext=function(n){return n={$$typeof:lA,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:aA,_context:n},n.Consumer=n};Fe.createElement=XC;Fe.createFactory=function(n){var e=XC.bind(null,n);return e.type=n,e};Fe.createRef=function(){return{current:null}};Fe.forwardRef=function(n){return{$$typeof:uA,render:n}};Fe.isValidElement=zv;Fe.lazy=function(n){return{$$typeof:dA,_payload:{_status:-1,_result:n},_init:mA}};Fe.memo=function(n,e){return{$$typeof:hA,type:n,compare:e===void 0?null:e}};Fe.startTransition=function(n){var e=zp.transition;zp.transition={};try{n()}finally{zp.transition=e}};Fe.unstable_act=JC;Fe.useCallback=function(n,e){return fr.current.useCallback(n,e)};Fe.useContext=function(n){return fr.current.useContext(n)};Fe.useDebugValue=function(){};Fe.useDeferredValue=function(n){return fr.current.useDeferredValue(n)};Fe.useEffect=function(n,e){return fr.current.useEffect(n,e)};Fe.useId=function(){return fr.current.useId()};Fe.useImperativeHandle=function(n,e,t){return fr.current.useImperativeHandle(n,e,t)};Fe.useInsertionEffect=function(n,e){return fr.current.useInsertionEffect(n,e)};Fe.useLayoutEffect=function(n,e){return fr.current.useLayoutEffect(n,e)};Fe.useMemo=function(n,e){return fr.current.useMemo(n,e)};Fe.useReducer=function(n,e,t){return fr.current.useReducer(n,e,t)};Fe.useRef=function(n){return fr.current.useRef(n)};Fe.useState=function(n){return fr.current.useState(n)};Fe.useSyncExternalStore=function(n,e,t){return fr.current.useSyncExternalStore(n,e,t)};Fe.useTransition=function(){return fr.current.useTransition()};Fe.version="18.3.1";WC.exports=Fe;var we=WC.exports;const rn=Ad(we);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yA=we,vA=Symbol.for("react.element"),wA=Symbol.for("react.fragment"),SA=Object.prototype.hasOwnProperty,EA=yA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,TA={key:!0,ref:!0,__self:!0,__source:!0};function ZC(n,e,t){var r,i={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)SA.call(e,r)&&!TA.hasOwnProperty(r)&&(i[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:vA,type:n,key:s,ref:o,props:i,_owner:EA.current}}hm.Fragment=wA;hm.jsx=ZC;hm.jsxs=ZC;jC.exports=hm;var X=jC.exports,Yy={},e5={exports:{}},Ur={},t5={exports:{}},n5={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(H,te){var J=H.length;H.push(te);e:for(;0<J;){var ee=J-1>>>1,ae=H[ee];if(0<i(ae,te))H[ee]=te,H[J]=ae,J=ee;else break e}}function t(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var te=H[0],J=H.pop();if(J!==te){H[0]=J;e:for(var ee=0,ae=H.length,Ee=ae>>>1;ee<Ee;){var ut=2*(ee+1)-1,ct=H[ut],ht=ut+1,B=H[ht];if(0>i(ct,J))ht<ae&&0>i(B,ct)?(H[ee]=B,H[ht]=J,ee=ht):(H[ee]=ct,H[ut]=J,ee=ut);else if(ht<ae&&0>i(B,J))H[ee]=B,H[ht]=J,ee=ht;else break e}}return te}function i(H,te){var J=H.sortIndex-te.sortIndex;return J!==0?J:H.id-te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,u=o.now();n.unstable_now=function(){return o.now()-u}}var c=[],d=[],p=1,m=null,y=3,E=!1,S=!1,x=!1,D=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(H){for(var te=t(d);te!==null;){if(te.callback===null)r(d);else if(te.startTime<=H)r(d),te.sortIndex=te.expirationTime,e(c,te);else break;te=t(d)}}function P(H){if(x=!1,w(H),!S)if(t(c)!==null)S=!0,he(V);else{var te=t(d);te!==null&&ue(P,te.startTime-H)}}function V(H,te){S=!1,x&&(x=!1,k(C),C=-1),E=!0;var J=y;try{for(w(te),m=t(c);m!==null&&(!(m.expirationTime>te)||H&&!L());){var ee=m.callback;if(typeof ee=="function"){m.callback=null,y=m.priorityLevel;var ae=ee(m.expirationTime<=te);te=n.unstable_now(),typeof ae=="function"?m.callback=ae:m===t(c)&&r(c),w(te)}else r(c);m=t(c)}if(m!==null)var Ee=!0;else{var ut=t(d);ut!==null&&ue(P,ut.startTime-te),Ee=!1}return Ee}finally{m=null,y=J,E=!1}}var z=!1,M=null,C=-1,N=5,A=-1;function L(){return!(n.unstable_now()-A<N)}function U(){if(M!==null){var H=n.unstable_now();A=H;var te=!0;try{te=M(!0,H)}finally{te?F():(z=!1,M=null)}}else z=!1}var F;if(typeof R=="function")F=function(){R(U)};else if(typeof MessageChannel<"u"){var pe=new MessageChannel,Y=pe.port2;pe.port1.onmessage=U,F=function(){Y.postMessage(null)}}else F=function(){D(U,0)};function he(H){M=H,z||(z=!0,F())}function ue(H,te){C=D(function(){H(n.unstable_now())},te)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(H){H.callback=null},n.unstable_continueExecution=function(){S||E||(S=!0,he(V))},n.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<H?Math.floor(1e3/H):5},n.unstable_getCurrentPriorityLevel=function(){return y},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(H){switch(y){case 1:case 2:case 3:var te=3;break;default:te=y}var J=y;y=te;try{return H()}finally{y=J}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(H,te){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var J=y;y=H;try{return te()}finally{y=J}},n.unstable_scheduleCallback=function(H,te,J){var ee=n.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?ee+J:ee):J=ee,H){case 1:var ae=-1;break;case 2:ae=250;break;case 5:ae=1073741823;break;case 4:ae=1e4;break;default:ae=5e3}return ae=J+ae,H={id:p++,callback:te,priorityLevel:H,startTime:J,expirationTime:ae,sortIndex:-1},J>ee?(H.sortIndex=J,e(d,H),t(c)===null&&H===t(d)&&(x?(k(C),C=-1):x=!0,ue(P,J-ee))):(H.sortIndex=ae,e(c,H),S||E||(S=!0,he(V))),H},n.unstable_shouldYield=L,n.unstable_wrapCallback=function(H){var te=y;return function(){var J=y;y=te;try{return H.apply(this,arguments)}finally{y=J}}}})(n5);t5.exports=n5;var Th=t5.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CA=we,Vr=Th;function ie(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r5=new Set,jh={};function sl(n,e){Pu(n,e),Pu(n+"Capture",e)}function Pu(n,e){for(jh[n]=e,n=0;n<e.length;n++)r5.add(e[n])}var Vs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Xy=Object.prototype.hasOwnProperty,IA=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,jE={},WE={};function PA(n){return Xy.call(WE,n)?!0:Xy.call(jE,n)?!1:IA.test(n)?WE[n]=!0:(jE[n]=!0,!1)}function RA(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function AA(n,e,t,r){if(e===null||typeof e>"u"||RA(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function pr(n,e,t,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var bn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){bn[n]=new pr(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];bn[e]=new pr(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){bn[n]=new pr(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){bn[n]=new pr(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){bn[n]=new pr(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){bn[n]=new pr(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){bn[n]=new pr(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){bn[n]=new pr(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){bn[n]=new pr(n,5,!1,n.toLowerCase(),null,!1,!1)});var Bv=/[\-:]([a-z])/g;function Gv(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(Bv,Gv);bn[e]=new pr(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(Bv,Gv);bn[e]=new pr(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(Bv,Gv);bn[e]=new pr(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){bn[n]=new pr(n,1,!1,n.toLowerCase(),null,!1,!1)});bn.xlinkHref=new pr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){bn[n]=new pr(n,1,!1,n.toLowerCase(),null,!0,!0)});function jv(n,e,t,r){var i=bn.hasOwnProperty(e)?bn[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(AA(e,t,i,r)&&(t=null),r||i===null?PA(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,r=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var qs=CA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,cp=Symbol.for("react.element"),Zl=Symbol.for("react.portal"),eu=Symbol.for("react.fragment"),Wv=Symbol.for("react.strict_mode"),Jy=Symbol.for("react.profiler"),i5=Symbol.for("react.provider"),s5=Symbol.for("react.context"),Hv=Symbol.for("react.forward_ref"),Zy=Symbol.for("react.suspense"),e1=Symbol.for("react.suspense_list"),$v=Symbol.for("react.memo"),vo=Symbol.for("react.lazy"),o5=Symbol.for("react.offscreen"),HE=Symbol.iterator;function Kc(n){return n===null||typeof n!="object"?null:(n=HE&&n[HE]||n["@@iterator"],typeof n=="function"?n:null)}var Ot=Object.assign,K_;function fh(n){if(K_===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);K_=e&&e[1]||""}return`
`+K_+n}var Q_=!1;function Y_(n,e){if(!n||Q_)return"";Q_=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(n,[],e)}else{try{e.call()}catch(d){r=d}n.call(e.prototype)}else{try{throw Error()}catch(d){r=d}n()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,u=s.length-1;1<=o&&0<=u&&i[o]!==s[u];)u--;for(;1<=o&&0<=u;o--,u--)if(i[o]!==s[u]){if(o!==1||u!==1)do if(o--,u--,0>u||i[o]!==s[u]){var c=`
`+i[o].replace(" at new "," at ");return n.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",n.displayName)),c}while(1<=o&&0<=u);break}}}finally{Q_=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?fh(n):""}function kA(n){switch(n.tag){case 5:return fh(n.type);case 16:return fh("Lazy");case 13:return fh("Suspense");case 19:return fh("SuspenseList");case 0:case 2:case 15:return n=Y_(n.type,!1),n;case 11:return n=Y_(n.type.render,!1),n;case 1:return n=Y_(n.type,!0),n;default:return""}}function t1(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case eu:return"Fragment";case Zl:return"Portal";case Jy:return"Profiler";case Wv:return"StrictMode";case Zy:return"Suspense";case e1:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case s5:return(n.displayName||"Context")+".Consumer";case i5:return(n._context.displayName||"Context")+".Provider";case Hv:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case $v:return e=n.displayName||null,e!==null?e:t1(n.type)||"Memo";case vo:e=n._payload,n=n._init;try{return t1(n(e))}catch{}}return null}function xA(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return t1(e);case 8:return e===Wv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function jo(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function a5(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function NA(n){var e=a5(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function hp(n){n._valueTracker||(n._valueTracker=NA(n))}function l5(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=a5(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function ug(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function n1(n,e){var t=e.checked;return Ot({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function $E(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=jo(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function u5(n,e){e=e.checked,e!=null&&jv(n,"checked",e,!1)}function r1(n,e){u5(n,e);var t=jo(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?i1(n,e.type,t):e.hasOwnProperty("defaultValue")&&i1(n,e.type,jo(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function qE(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function i1(n,e,t){(e!=="number"||ug(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var ph=Array.isArray;function pu(n,e,t,r){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&r&&(n[t].defaultSelected=!0)}else{for(t=""+jo(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,r&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function s1(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ie(91));return Ot({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function KE(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(ie(92));if(ph(t)){if(1<t.length)throw Error(ie(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:jo(t)}}function c5(n,e){var t=jo(e.value),r=jo(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function QE(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function h5(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function o1(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?h5(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var dp,d5=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(dp=dp||document.createElement("div"),dp.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=dp.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Wh(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var Ch={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},DA=["Webkit","ms","Moz","O"];Object.keys(Ch).forEach(function(n){DA.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),Ch[e]=Ch[n]})});function f5(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Ch.hasOwnProperty(n)&&Ch[n]?(""+e).trim():e+"px"}function p5(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,i=f5(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,i):n[t]=i}}var MA=Ot({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function a1(n,e){if(e){if(MA[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ie(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ie(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ie(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ie(62))}}function l1(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var u1=null;function qv(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var c1=null,gu=null,mu=null;function YE(n){if(n=Dd(n)){if(typeof c1!="function")throw Error(ie(280));var e=n.stateNode;e&&(e=mm(e),c1(n.stateNode,n.type,e))}}function g5(n){gu?mu?mu.push(n):mu=[n]:gu=n}function m5(){if(gu){var n=gu,e=mu;if(mu=gu=null,YE(n),e)for(n=0;n<e.length;n++)YE(e[n])}}function _5(n,e){return n(e)}function y5(){}var X_=!1;function v5(n,e,t){if(X_)return n(e,t);X_=!0;try{return _5(n,e,t)}finally{X_=!1,(gu!==null||mu!==null)&&(y5(),m5())}}function Hh(n,e){var t=n.stateNode;if(t===null)return null;var r=mm(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(ie(231,e,typeof t));return t}var h1=!1;if(Vs)try{var Qc={};Object.defineProperty(Qc,"passive",{get:function(){h1=!0}}),window.addEventListener("test",Qc,Qc),window.removeEventListener("test",Qc,Qc)}catch{h1=!1}function OA(n,e,t,r,i,s,o,u,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(t,d)}catch(p){this.onError(p)}}var Ih=!1,cg=null,hg=!1,d1=null,LA={onError:function(n){Ih=!0,cg=n}};function bA(n,e,t,r,i,s,o,u,c){Ih=!1,cg=null,OA.apply(LA,arguments)}function FA(n,e,t,r,i,s,o,u,c){if(bA.apply(this,arguments),Ih){if(Ih){var d=cg;Ih=!1,cg=null}else throw Error(ie(198));hg||(hg=!0,d1=d)}}function ol(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function w5(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function XE(n){if(ol(n)!==n)throw Error(ie(188))}function VA(n){var e=n.alternate;if(!e){if(e=ol(n),e===null)throw Error(ie(188));return e!==n?null:n}for(var t=n,r=e;;){var i=t.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){t=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===t)return XE(i),n;if(s===r)return XE(i),e;s=s.sibling}throw Error(ie(188))}if(t.return!==r.return)t=i,r=s;else{for(var o=!1,u=i.child;u;){if(u===t){o=!0,t=i,r=s;break}if(u===r){o=!0,r=i,t=s;break}u=u.sibling}if(!o){for(u=s.child;u;){if(u===t){o=!0,t=s,r=i;break}if(u===r){o=!0,r=s,t=i;break}u=u.sibling}if(!o)throw Error(ie(189))}}if(t.alternate!==r)throw Error(ie(190))}if(t.tag!==3)throw Error(ie(188));return t.stateNode.current===t?n:e}function S5(n){return n=VA(n),n!==null?E5(n):null}function E5(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=E5(n);if(e!==null)return e;n=n.sibling}return null}var T5=Vr.unstable_scheduleCallback,JE=Vr.unstable_cancelCallback,UA=Vr.unstable_shouldYield,zA=Vr.unstable_requestPaint,jt=Vr.unstable_now,BA=Vr.unstable_getCurrentPriorityLevel,Kv=Vr.unstable_ImmediatePriority,C5=Vr.unstable_UserBlockingPriority,dg=Vr.unstable_NormalPriority,GA=Vr.unstable_LowPriority,I5=Vr.unstable_IdlePriority,dm=null,Xi=null;function jA(n){if(Xi&&typeof Xi.onCommitFiberRoot=="function")try{Xi.onCommitFiberRoot(dm,n,void 0,(n.current.flags&128)===128)}catch{}}var Ti=Math.clz32?Math.clz32:$A,WA=Math.log,HA=Math.LN2;function $A(n){return n>>>=0,n===0?32:31-(WA(n)/HA|0)|0}var fp=64,pp=4194304;function gh(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function fg(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,i=n.suspendedLanes,s=n.pingedLanes,o=t&268435455;if(o!==0){var u=o&~i;u!==0?r=gh(u):(s&=o,s!==0&&(r=gh(s)))}else o=t&~i,o!==0?r=gh(o):s!==0&&(r=gh(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-Ti(e),i=1<<t,r|=n[t],e&=~i;return r}function qA(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function KA(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,i=n.expirationTimes,s=n.pendingLanes;0<s;){var o=31-Ti(s),u=1<<o,c=i[o];c===-1?(!(u&t)||u&r)&&(i[o]=qA(u,e)):c<=e&&(n.expiredLanes|=u),s&=~u}}function f1(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function P5(){var n=fp;return fp<<=1,!(fp&4194240)&&(fp=64),n}function J_(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function xd(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Ti(e),n[e]=t}function QA(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-Ti(t),s=1<<i;e[i]=0,r[i]=-1,n[i]=-1,t&=~s}}function Qv(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-Ti(t),i=1<<r;i&e|n[r]&e&&(n[r]|=e),t&=~i}}var lt=0;function R5(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var A5,Yv,k5,x5,N5,p1=!1,gp=[],ko=null,xo=null,No=null,$h=new Map,qh=new Map,So=[],YA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ZE(n,e){switch(n){case"focusin":case"focusout":ko=null;break;case"dragenter":case"dragleave":xo=null;break;case"mouseover":case"mouseout":No=null;break;case"pointerover":case"pointerout":$h.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":qh.delete(e.pointerId)}}function Yc(n,e,t,r,i,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Dd(e),e!==null&&Yv(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function XA(n,e,t,r,i){switch(e){case"focusin":return ko=Yc(ko,n,e,t,r,i),!0;case"dragenter":return xo=Yc(xo,n,e,t,r,i),!0;case"mouseover":return No=Yc(No,n,e,t,r,i),!0;case"pointerover":var s=i.pointerId;return $h.set(s,Yc($h.get(s)||null,n,e,t,r,i)),!0;case"gotpointercapture":return s=i.pointerId,qh.set(s,Yc(qh.get(s)||null,n,e,t,r,i)),!0}return!1}function D5(n){var e=Oa(n.target);if(e!==null){var t=ol(e);if(t!==null){if(e=t.tag,e===13){if(e=w5(t),e!==null){n.blockedOn=e,N5(n.priority,function(){k5(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Bp(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=g1(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);u1=r,t.target.dispatchEvent(r),u1=null}else return e=Dd(t),e!==null&&Yv(e),n.blockedOn=t,!1;e.shift()}return!0}function e4(n,e,t){Bp(n)&&t.delete(e)}function JA(){p1=!1,ko!==null&&Bp(ko)&&(ko=null),xo!==null&&Bp(xo)&&(xo=null),No!==null&&Bp(No)&&(No=null),$h.forEach(e4),qh.forEach(e4)}function Xc(n,e){n.blockedOn===e&&(n.blockedOn=null,p1||(p1=!0,Vr.unstable_scheduleCallback(Vr.unstable_NormalPriority,JA)))}function Kh(n){function e(i){return Xc(i,n)}if(0<gp.length){Xc(gp[0],n);for(var t=1;t<gp.length;t++){var r=gp[t];r.blockedOn===n&&(r.blockedOn=null)}}for(ko!==null&&Xc(ko,n),xo!==null&&Xc(xo,n),No!==null&&Xc(No,n),$h.forEach(e),qh.forEach(e),t=0;t<So.length;t++)r=So[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<So.length&&(t=So[0],t.blockedOn===null);)D5(t),t.blockedOn===null&&So.shift()}var _u=qs.ReactCurrentBatchConfig,pg=!0;function ZA(n,e,t,r){var i=lt,s=_u.transition;_u.transition=null;try{lt=1,Xv(n,e,t,r)}finally{lt=i,_u.transition=s}}function ek(n,e,t,r){var i=lt,s=_u.transition;_u.transition=null;try{lt=4,Xv(n,e,t,r)}finally{lt=i,_u.transition=s}}function Xv(n,e,t,r){if(pg){var i=g1(n,e,t,r);if(i===null)ly(n,e,r,gg,t),ZE(n,r);else if(XA(i,n,e,t,r))r.stopPropagation();else if(ZE(n,r),e&4&&-1<YA.indexOf(n)){for(;i!==null;){var s=Dd(i);if(s!==null&&A5(s),s=g1(n,e,t,r),s===null&&ly(n,e,r,gg,t),s===i)break;i=s}i!==null&&r.stopPropagation()}else ly(n,e,r,null,t)}}var gg=null;function g1(n,e,t,r){if(gg=null,n=qv(r),n=Oa(n),n!==null)if(e=ol(n),e===null)n=null;else if(t=e.tag,t===13){if(n=w5(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return gg=n,null}function M5(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(BA()){case Kv:return 1;case C5:return 4;case dg:case GA:return 16;case I5:return 536870912;default:return 16}default:return 16}}var Po=null,Jv=null,Gp=null;function O5(){if(Gp)return Gp;var n,e=Jv,t=e.length,r,i="value"in Po?Po.value:Po.textContent,s=i.length;for(n=0;n<t&&e[n]===i[n];n++);var o=t-n;for(r=1;r<=o&&e[t-r]===i[s-r];r++);return Gp=i.slice(n,1<r?1-r:void 0)}function jp(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function mp(){return!0}function t4(){return!1}function zr(n){function e(t,r,i,s,o){this._reactName=t,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var u in n)n.hasOwnProperty(u)&&(t=n[u],this[u]=t?t(s):s[u]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?mp:t4,this.isPropagationStopped=t4,this}return Ot(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=mp)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=mp)},persist:function(){},isPersistent:mp}),e}var Ku={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zv=zr(Ku),Nd=Ot({},Ku,{view:0,detail:0}),tk=zr(Nd),Z_,ey,Jc,fm=Ot({},Nd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:e2,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Jc&&(Jc&&n.type==="mousemove"?(Z_=n.screenX-Jc.screenX,ey=n.screenY-Jc.screenY):ey=Z_=0,Jc=n),Z_)},movementY:function(n){return"movementY"in n?n.movementY:ey}}),n4=zr(fm),nk=Ot({},fm,{dataTransfer:0}),rk=zr(nk),ik=Ot({},Nd,{relatedTarget:0}),ty=zr(ik),sk=Ot({},Ku,{animationName:0,elapsedTime:0,pseudoElement:0}),ok=zr(sk),ak=Ot({},Ku,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),lk=zr(ak),uk=Ot({},Ku,{data:0}),r4=zr(uk),ck={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fk(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=dk[n])?!!e[n]:!1}function e2(){return fk}var pk=Ot({},Nd,{key:function(n){if(n.key){var e=ck[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=jp(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?hk[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:e2,charCode:function(n){return n.type==="keypress"?jp(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?jp(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),gk=zr(pk),mk=Ot({},fm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),i4=zr(mk),_k=Ot({},Nd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:e2}),yk=zr(_k),vk=Ot({},Ku,{propertyName:0,elapsedTime:0,pseudoElement:0}),wk=zr(vk),Sk=Ot({},fm,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Ek=zr(Sk),Tk=[9,13,27,32],t2=Vs&&"CompositionEvent"in window,Ph=null;Vs&&"documentMode"in document&&(Ph=document.documentMode);var Ck=Vs&&"TextEvent"in window&&!Ph,L5=Vs&&(!t2||Ph&&8<Ph&&11>=Ph),s4=" ",o4=!1;function b5(n,e){switch(n){case"keyup":return Tk.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function F5(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var tu=!1;function Ik(n,e){switch(n){case"compositionend":return F5(e);case"keypress":return e.which!==32?null:(o4=!0,s4);case"textInput":return n=e.data,n===s4&&o4?null:n;default:return null}}function Pk(n,e){if(tu)return n==="compositionend"||!t2&&b5(n,e)?(n=O5(),Gp=Jv=Po=null,tu=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return L5&&e.locale!=="ko"?null:e.data;default:return null}}var Rk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function a4(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!Rk[n.type]:e==="textarea"}function V5(n,e,t,r){g5(r),e=mg(e,"onChange"),0<e.length&&(t=new Zv("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var Rh=null,Qh=null;function Ak(n){Q5(n,0)}function pm(n){var e=iu(n);if(l5(e))return n}function kk(n,e){if(n==="change")return e}var U5=!1;if(Vs){var ny;if(Vs){var ry="oninput"in document;if(!ry){var l4=document.createElement("div");l4.setAttribute("oninput","return;"),ry=typeof l4.oninput=="function"}ny=ry}else ny=!1;U5=ny&&(!document.documentMode||9<document.documentMode)}function u4(){Rh&&(Rh.detachEvent("onpropertychange",z5),Qh=Rh=null)}function z5(n){if(n.propertyName==="value"&&pm(Qh)){var e=[];V5(e,Qh,n,qv(n)),v5(Ak,e)}}function xk(n,e,t){n==="focusin"?(u4(),Rh=e,Qh=t,Rh.attachEvent("onpropertychange",z5)):n==="focusout"&&u4()}function Nk(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return pm(Qh)}function Dk(n,e){if(n==="click")return pm(e)}function Mk(n,e){if(n==="input"||n==="change")return pm(e)}function Ok(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Ai=typeof Object.is=="function"?Object.is:Ok;function Yh(n,e){if(Ai(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var i=t[r];if(!Xy.call(e,i)||!Ai(n[i],e[i]))return!1}return!0}function c4(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function h4(n,e){var t=c4(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=c4(t)}}function B5(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?B5(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function G5(){for(var n=window,e=ug();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=ug(n.document)}return e}function n2(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function Lk(n){var e=G5(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&B5(t.ownerDocument.documentElement,t)){if(r!==null&&n2(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!n.extend&&s>r&&(i=r,r=s,s=i),i=h4(t,s);var o=h4(t,r);i&&o&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),s>r?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var bk=Vs&&"documentMode"in document&&11>=document.documentMode,nu=null,m1=null,Ah=null,_1=!1;function d4(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;_1||nu==null||nu!==ug(r)||(r=nu,"selectionStart"in r&&n2(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ah&&Yh(Ah,r)||(Ah=r,r=mg(m1,"onSelect"),0<r.length&&(e=new Zv("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=nu)))}function _p(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var ru={animationend:_p("Animation","AnimationEnd"),animationiteration:_p("Animation","AnimationIteration"),animationstart:_p("Animation","AnimationStart"),transitionend:_p("Transition","TransitionEnd")},iy={},j5={};Vs&&(j5=document.createElement("div").style,"AnimationEvent"in window||(delete ru.animationend.animation,delete ru.animationiteration.animation,delete ru.animationstart.animation),"TransitionEvent"in window||delete ru.transitionend.transition);function gm(n){if(iy[n])return iy[n];if(!ru[n])return n;var e=ru[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in j5)return iy[n]=e[t];return n}var W5=gm("animationend"),H5=gm("animationiteration"),$5=gm("animationstart"),q5=gm("transitionend"),K5=new Map,f4="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xo(n,e){K5.set(n,e),sl(e,[n])}for(var sy=0;sy<f4.length;sy++){var oy=f4[sy],Fk=oy.toLowerCase(),Vk=oy[0].toUpperCase()+oy.slice(1);Xo(Fk,"on"+Vk)}Xo(W5,"onAnimationEnd");Xo(H5,"onAnimationIteration");Xo($5,"onAnimationStart");Xo("dblclick","onDoubleClick");Xo("focusin","onFocus");Xo("focusout","onBlur");Xo(q5,"onTransitionEnd");Pu("onMouseEnter",["mouseout","mouseover"]);Pu("onMouseLeave",["mouseout","mouseover"]);Pu("onPointerEnter",["pointerout","pointerover"]);Pu("onPointerLeave",["pointerout","pointerover"]);sl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));sl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));sl("onBeforeInput",["compositionend","keypress","textInput","paste"]);sl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));sl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));sl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var mh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Uk=new Set("cancel close invalid load scroll toggle".split(" ").concat(mh));function p4(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,FA(r,e,void 0,n),n.currentTarget=null}function Q5(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var u=r[o],c=u.instance,d=u.currentTarget;if(u=u.listener,c!==s&&i.isPropagationStopped())break e;p4(i,u,d),s=c}else for(o=0;o<r.length;o++){if(u=r[o],c=u.instance,d=u.currentTarget,u=u.listener,c!==s&&i.isPropagationStopped())break e;p4(i,u,d),s=c}}}if(hg)throw n=d1,hg=!1,d1=null,n}function Et(n,e){var t=e[E1];t===void 0&&(t=e[E1]=new Set);var r=n+"__bubble";t.has(r)||(Y5(e,n,2,!1),t.add(r))}function ay(n,e,t){var r=0;e&&(r|=4),Y5(t,n,r,e)}var yp="_reactListening"+Math.random().toString(36).slice(2);function Xh(n){if(!n[yp]){n[yp]=!0,r5.forEach(function(t){t!=="selectionchange"&&(Uk.has(t)||ay(t,!1,n),ay(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[yp]||(e[yp]=!0,ay("selectionchange",!1,e))}}function Y5(n,e,t,r){switch(M5(e)){case 1:var i=ZA;break;case 4:i=ek;break;default:i=Xv}t=i.bind(null,e,t,n),i=void 0,!h1||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function ly(n,e,t,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var u=r.stateNode.containerInfo;if(u===i||u.nodeType===8&&u.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;u!==null;){if(o=Oa(u),o===null)return;if(c=o.tag,c===5||c===6){r=s=o;continue e}u=u.parentNode}}r=r.return}v5(function(){var d=s,p=qv(t),m=[];e:{var y=K5.get(n);if(y!==void 0){var E=Zv,S=n;switch(n){case"keypress":if(jp(t)===0)break e;case"keydown":case"keyup":E=gk;break;case"focusin":S="focus",E=ty;break;case"focusout":S="blur",E=ty;break;case"beforeblur":case"afterblur":E=ty;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":E=n4;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":E=rk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":E=yk;break;case W5:case H5:case $5:E=ok;break;case q5:E=wk;break;case"scroll":E=tk;break;case"wheel":E=Ek;break;case"copy":case"cut":case"paste":E=lk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":E=i4}var x=(e&4)!==0,D=!x&&n==="scroll",k=x?y!==null?y+"Capture":null:y;x=[];for(var R=d,w;R!==null;){w=R;var P=w.stateNode;if(w.tag===5&&P!==null&&(w=P,k!==null&&(P=Hh(R,k),P!=null&&x.push(Jh(R,P,w)))),D)break;R=R.return}0<x.length&&(y=new E(y,S,null,t,p),m.push({event:y,listeners:x}))}}if(!(e&7)){e:{if(y=n==="mouseover"||n==="pointerover",E=n==="mouseout"||n==="pointerout",y&&t!==u1&&(S=t.relatedTarget||t.fromElement)&&(Oa(S)||S[Us]))break e;if((E||y)&&(y=p.window===p?p:(y=p.ownerDocument)?y.defaultView||y.parentWindow:window,E?(S=t.relatedTarget||t.toElement,E=d,S=S?Oa(S):null,S!==null&&(D=ol(S),S!==D||S.tag!==5&&S.tag!==6)&&(S=null)):(E=null,S=d),E!==S)){if(x=n4,P="onMouseLeave",k="onMouseEnter",R="mouse",(n==="pointerout"||n==="pointerover")&&(x=i4,P="onPointerLeave",k="onPointerEnter",R="pointer"),D=E==null?y:iu(E),w=S==null?y:iu(S),y=new x(P,R+"leave",E,t,p),y.target=D,y.relatedTarget=w,P=null,Oa(p)===d&&(x=new x(k,R+"enter",S,t,p),x.target=w,x.relatedTarget=D,P=x),D=P,E&&S)t:{for(x=E,k=S,R=0,w=x;w;w=Wl(w))R++;for(w=0,P=k;P;P=Wl(P))w++;for(;0<R-w;)x=Wl(x),R--;for(;0<w-R;)k=Wl(k),w--;for(;R--;){if(x===k||k!==null&&x===k.alternate)break t;x=Wl(x),k=Wl(k)}x=null}else x=null;E!==null&&g4(m,y,E,x,!1),S!==null&&D!==null&&g4(m,D,S,x,!0)}}e:{if(y=d?iu(d):window,E=y.nodeName&&y.nodeName.toLowerCase(),E==="select"||E==="input"&&y.type==="file")var V=kk;else if(a4(y))if(U5)V=Mk;else{V=Nk;var z=xk}else(E=y.nodeName)&&E.toLowerCase()==="input"&&(y.type==="checkbox"||y.type==="radio")&&(V=Dk);if(V&&(V=V(n,d))){V5(m,V,t,p);break e}z&&z(n,y,d),n==="focusout"&&(z=y._wrapperState)&&z.controlled&&y.type==="number"&&i1(y,"number",y.value)}switch(z=d?iu(d):window,n){case"focusin":(a4(z)||z.contentEditable==="true")&&(nu=z,m1=d,Ah=null);break;case"focusout":Ah=m1=nu=null;break;case"mousedown":_1=!0;break;case"contextmenu":case"mouseup":case"dragend":_1=!1,d4(m,t,p);break;case"selectionchange":if(bk)break;case"keydown":case"keyup":d4(m,t,p)}var M;if(t2)e:{switch(n){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else tu?b5(n,t)&&(C="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(C="onCompositionStart");C&&(L5&&t.locale!=="ko"&&(tu||C!=="onCompositionStart"?C==="onCompositionEnd"&&tu&&(M=O5()):(Po=p,Jv="value"in Po?Po.value:Po.textContent,tu=!0)),z=mg(d,C),0<z.length&&(C=new r4(C,n,null,t,p),m.push({event:C,listeners:z}),M?C.data=M:(M=F5(t),M!==null&&(C.data=M)))),(M=Ck?Ik(n,t):Pk(n,t))&&(d=mg(d,"onBeforeInput"),0<d.length&&(p=new r4("onBeforeInput","beforeinput",null,t,p),m.push({event:p,listeners:d}),p.data=M))}Q5(m,e)})}function Jh(n,e,t){return{instance:n,listener:e,currentTarget:t}}function mg(n,e){for(var t=e+"Capture",r=[];n!==null;){var i=n,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Hh(n,t),s!=null&&r.unshift(Jh(n,s,i)),s=Hh(n,e),s!=null&&r.push(Jh(n,s,i))),n=n.return}return r}function Wl(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function g4(n,e,t,r,i){for(var s=e._reactName,o=[];t!==null&&t!==r;){var u=t,c=u.alternate,d=u.stateNode;if(c!==null&&c===r)break;u.tag===5&&d!==null&&(u=d,i?(c=Hh(t,s),c!=null&&o.unshift(Jh(t,c,u))):i||(c=Hh(t,s),c!=null&&o.push(Jh(t,c,u)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var zk=/\r\n?/g,Bk=/\u0000|\uFFFD/g;function m4(n){return(typeof n=="string"?n:""+n).replace(zk,`
`).replace(Bk,"")}function vp(n,e,t){if(e=m4(e),m4(n)!==e&&t)throw Error(ie(425))}function _g(){}var y1=null,v1=null;function w1(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var S1=typeof setTimeout=="function"?setTimeout:void 0,Gk=typeof clearTimeout=="function"?clearTimeout:void 0,_4=typeof Promise=="function"?Promise:void 0,jk=typeof queueMicrotask=="function"?queueMicrotask:typeof _4<"u"?function(n){return _4.resolve(null).then(n).catch(Wk)}:S1;function Wk(n){setTimeout(function(){throw n})}function uy(n,e){var t=e,r=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(r===0){n.removeChild(i),Kh(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=i}while(t);Kh(e)}function Do(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function y4(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var Qu=Math.random().toString(36).slice(2),Ki="__reactFiber$"+Qu,Zh="__reactProps$"+Qu,Us="__reactContainer$"+Qu,E1="__reactEvents$"+Qu,Hk="__reactListeners$"+Qu,$k="__reactHandles$"+Qu;function Oa(n){var e=n[Ki];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Us]||t[Ki]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=y4(n);n!==null;){if(t=n[Ki])return t;n=y4(n)}return e}n=t,t=n.parentNode}return null}function Dd(n){return n=n[Ki]||n[Us],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function iu(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(ie(33))}function mm(n){return n[Zh]||null}var T1=[],su=-1;function Jo(n){return{current:n}}function It(n){0>su||(n.current=T1[su],T1[su]=null,su--)}function wt(n,e){su++,T1[su]=n.current,n.current=e}var Wo={},tr=Jo(Wo),Rr=Jo(!1),ja=Wo;function Ru(n,e){var t=n.type.contextTypes;if(!t)return Wo;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in t)i[s]=e[s];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function Ar(n){return n=n.childContextTypes,n!=null}function yg(){It(Rr),It(tr)}function v4(n,e,t){if(tr.current!==Wo)throw Error(ie(168));wt(tr,e),wt(Rr,t)}function X5(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ie(108,xA(n)||"Unknown",i));return Ot({},t,r)}function vg(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Wo,ja=tr.current,wt(tr,n),wt(Rr,Rr.current),!0}function w4(n,e,t){var r=n.stateNode;if(!r)throw Error(ie(169));t?(n=X5(n,e,ja),r.__reactInternalMemoizedMergedChildContext=n,It(Rr),It(tr),wt(tr,n)):It(Rr),wt(Rr,t)}var Is=null,_m=!1,cy=!1;function J5(n){Is===null?Is=[n]:Is.push(n)}function qk(n){_m=!0,J5(n)}function Zo(){if(!cy&&Is!==null){cy=!0;var n=0,e=lt;try{var t=Is;for(lt=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}Is=null,_m=!1}catch(i){throw Is!==null&&(Is=Is.slice(n+1)),T5(Kv,Zo),i}finally{lt=e,cy=!1}}return null}var ou=[],au=0,wg=null,Sg=0,Yr=[],Xr=0,Wa=null,Rs=1,As="";function ka(n,e){ou[au++]=Sg,ou[au++]=wg,wg=n,Sg=e}function Z5(n,e,t){Yr[Xr++]=Rs,Yr[Xr++]=As,Yr[Xr++]=Wa,Wa=n;var r=Rs;n=As;var i=32-Ti(r)-1;r&=~(1<<i),t+=1;var s=32-Ti(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Rs=1<<32-Ti(e)+i|t<<i|r,As=s+n}else Rs=1<<s|t<<i|r,As=n}function r2(n){n.return!==null&&(ka(n,1),Z5(n,1,0))}function i2(n){for(;n===wg;)wg=ou[--au],ou[au]=null,Sg=ou[--au],ou[au]=null;for(;n===Wa;)Wa=Yr[--Xr],Yr[Xr]=null,As=Yr[--Xr],Yr[Xr]=null,Rs=Yr[--Xr],Yr[Xr]=null}var Lr=null,Mr=null,At=!1,vi=null;function eI(n,e){var t=Jr(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function S4(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Lr=n,Mr=Do(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Lr=n,Mr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Wa!==null?{id:Rs,overflow:As}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Jr(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Lr=n,Mr=null,!0):!1;default:return!1}}function C1(n){return(n.mode&1)!==0&&(n.flags&128)===0}function I1(n){if(At){var e=Mr;if(e){var t=e;if(!S4(n,e)){if(C1(n))throw Error(ie(418));e=Do(t.nextSibling);var r=Lr;e&&S4(n,e)?eI(r,t):(n.flags=n.flags&-4097|2,At=!1,Lr=n)}}else{if(C1(n))throw Error(ie(418));n.flags=n.flags&-4097|2,At=!1,Lr=n}}}function E4(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Lr=n}function wp(n){if(n!==Lr)return!1;if(!At)return E4(n),At=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!w1(n.type,n.memoizedProps)),e&&(e=Mr)){if(C1(n))throw tI(),Error(ie(418));for(;e;)eI(n,e),e=Do(e.nextSibling)}if(E4(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(ie(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Mr=Do(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Mr=null}}else Mr=Lr?Do(n.stateNode.nextSibling):null;return!0}function tI(){for(var n=Mr;n;)n=Do(n.nextSibling)}function Au(){Mr=Lr=null,At=!1}function s2(n){vi===null?vi=[n]:vi.push(n)}var Kk=qs.ReactCurrentBatchConfig;function Zc(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(ie(309));var r=t.stateNode}if(!r)throw Error(ie(147,n));var i=r,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var u=i.refs;o===null?delete u[s]:u[s]=o},e._stringRef=s,e)}if(typeof n!="string")throw Error(ie(284));if(!t._owner)throw Error(ie(290,n))}return n}function Sp(n,e){throw n=Object.prototype.toString.call(e),Error(ie(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function T4(n){var e=n._init;return e(n._payload)}function nI(n){function e(k,R){if(n){var w=k.deletions;w===null?(k.deletions=[R],k.flags|=16):w.push(R)}}function t(k,R){if(!n)return null;for(;R!==null;)e(k,R),R=R.sibling;return null}function r(k,R){for(k=new Map;R!==null;)R.key!==null?k.set(R.key,R):k.set(R.index,R),R=R.sibling;return k}function i(k,R){return k=bo(k,R),k.index=0,k.sibling=null,k}function s(k,R,w){return k.index=w,n?(w=k.alternate,w!==null?(w=w.index,w<R?(k.flags|=2,R):w):(k.flags|=2,R)):(k.flags|=1048576,R)}function o(k){return n&&k.alternate===null&&(k.flags|=2),k}function u(k,R,w,P){return R===null||R.tag!==6?(R=_y(w,k.mode,P),R.return=k,R):(R=i(R,w),R.return=k,R)}function c(k,R,w,P){var V=w.type;return V===eu?p(k,R,w.props.children,P,w.key):R!==null&&(R.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===vo&&T4(V)===R.type)?(P=i(R,w.props),P.ref=Zc(k,R,w),P.return=k,P):(P=Yp(w.type,w.key,w.props,null,k.mode,P),P.ref=Zc(k,R,w),P.return=k,P)}function d(k,R,w,P){return R===null||R.tag!==4||R.stateNode.containerInfo!==w.containerInfo||R.stateNode.implementation!==w.implementation?(R=yy(w,k.mode,P),R.return=k,R):(R=i(R,w.children||[]),R.return=k,R)}function p(k,R,w,P,V){return R===null||R.tag!==7?(R=Ba(w,k.mode,P,V),R.return=k,R):(R=i(R,w),R.return=k,R)}function m(k,R,w){if(typeof R=="string"&&R!==""||typeof R=="number")return R=_y(""+R,k.mode,w),R.return=k,R;if(typeof R=="object"&&R!==null){switch(R.$$typeof){case cp:return w=Yp(R.type,R.key,R.props,null,k.mode,w),w.ref=Zc(k,null,R),w.return=k,w;case Zl:return R=yy(R,k.mode,w),R.return=k,R;case vo:var P=R._init;return m(k,P(R._payload),w)}if(ph(R)||Kc(R))return R=Ba(R,k.mode,w,null),R.return=k,R;Sp(k,R)}return null}function y(k,R,w,P){var V=R!==null?R.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return V!==null?null:u(k,R,""+w,P);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case cp:return w.key===V?c(k,R,w,P):null;case Zl:return w.key===V?d(k,R,w,P):null;case vo:return V=w._init,y(k,R,V(w._payload),P)}if(ph(w)||Kc(w))return V!==null?null:p(k,R,w,P,null);Sp(k,w)}return null}function E(k,R,w,P,V){if(typeof P=="string"&&P!==""||typeof P=="number")return k=k.get(w)||null,u(R,k,""+P,V);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case cp:return k=k.get(P.key===null?w:P.key)||null,c(R,k,P,V);case Zl:return k=k.get(P.key===null?w:P.key)||null,d(R,k,P,V);case vo:var z=P._init;return E(k,R,w,z(P._payload),V)}if(ph(P)||Kc(P))return k=k.get(w)||null,p(R,k,P,V,null);Sp(R,P)}return null}function S(k,R,w,P){for(var V=null,z=null,M=R,C=R=0,N=null;M!==null&&C<w.length;C++){M.index>C?(N=M,M=null):N=M.sibling;var A=y(k,M,w[C],P);if(A===null){M===null&&(M=N);break}n&&M&&A.alternate===null&&e(k,M),R=s(A,R,C),z===null?V=A:z.sibling=A,z=A,M=N}if(C===w.length)return t(k,M),At&&ka(k,C),V;if(M===null){for(;C<w.length;C++)M=m(k,w[C],P),M!==null&&(R=s(M,R,C),z===null?V=M:z.sibling=M,z=M);return At&&ka(k,C),V}for(M=r(k,M);C<w.length;C++)N=E(M,k,C,w[C],P),N!==null&&(n&&N.alternate!==null&&M.delete(N.key===null?C:N.key),R=s(N,R,C),z===null?V=N:z.sibling=N,z=N);return n&&M.forEach(function(L){return e(k,L)}),At&&ka(k,C),V}function x(k,R,w,P){var V=Kc(w);if(typeof V!="function")throw Error(ie(150));if(w=V.call(w),w==null)throw Error(ie(151));for(var z=V=null,M=R,C=R=0,N=null,A=w.next();M!==null&&!A.done;C++,A=w.next()){M.index>C?(N=M,M=null):N=M.sibling;var L=y(k,M,A.value,P);if(L===null){M===null&&(M=N);break}n&&M&&L.alternate===null&&e(k,M),R=s(L,R,C),z===null?V=L:z.sibling=L,z=L,M=N}if(A.done)return t(k,M),At&&ka(k,C),V;if(M===null){for(;!A.done;C++,A=w.next())A=m(k,A.value,P),A!==null&&(R=s(A,R,C),z===null?V=A:z.sibling=A,z=A);return At&&ka(k,C),V}for(M=r(k,M);!A.done;C++,A=w.next())A=E(M,k,C,A.value,P),A!==null&&(n&&A.alternate!==null&&M.delete(A.key===null?C:A.key),R=s(A,R,C),z===null?V=A:z.sibling=A,z=A);return n&&M.forEach(function(U){return e(k,U)}),At&&ka(k,C),V}function D(k,R,w,P){if(typeof w=="object"&&w!==null&&w.type===eu&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case cp:e:{for(var V=w.key,z=R;z!==null;){if(z.key===V){if(V=w.type,V===eu){if(z.tag===7){t(k,z.sibling),R=i(z,w.props.children),R.return=k,k=R;break e}}else if(z.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===vo&&T4(V)===z.type){t(k,z.sibling),R=i(z,w.props),R.ref=Zc(k,z,w),R.return=k,k=R;break e}t(k,z);break}else e(k,z);z=z.sibling}w.type===eu?(R=Ba(w.props.children,k.mode,P,w.key),R.return=k,k=R):(P=Yp(w.type,w.key,w.props,null,k.mode,P),P.ref=Zc(k,R,w),P.return=k,k=P)}return o(k);case Zl:e:{for(z=w.key;R!==null;){if(R.key===z)if(R.tag===4&&R.stateNode.containerInfo===w.containerInfo&&R.stateNode.implementation===w.implementation){t(k,R.sibling),R=i(R,w.children||[]),R.return=k,k=R;break e}else{t(k,R);break}else e(k,R);R=R.sibling}R=yy(w,k.mode,P),R.return=k,k=R}return o(k);case vo:return z=w._init,D(k,R,z(w._payload),P)}if(ph(w))return S(k,R,w,P);if(Kc(w))return x(k,R,w,P);Sp(k,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,R!==null&&R.tag===6?(t(k,R.sibling),R=i(R,w),R.return=k,k=R):(t(k,R),R=_y(w,k.mode,P),R.return=k,k=R),o(k)):t(k,R)}return D}var ku=nI(!0),rI=nI(!1),Eg=Jo(null),Tg=null,lu=null,o2=null;function a2(){o2=lu=Tg=null}function l2(n){var e=Eg.current;It(Eg),n._currentValue=e}function P1(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function yu(n,e){Tg=n,o2=lu=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Ir=!0),n.firstContext=null)}function ti(n){var e=n._currentValue;if(o2!==n)if(n={context:n,memoizedValue:e,next:null},lu===null){if(Tg===null)throw Error(ie(308));lu=n,Tg.dependencies={lanes:0,firstContext:n}}else lu=lu.next=n;return e}var La=null;function u2(n){La===null?La=[n]:La.push(n)}function iI(n,e,t,r){var i=e.interleaved;return i===null?(t.next=t,u2(e)):(t.next=i.next,i.next=t),e.interleaved=t,zs(n,r)}function zs(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var wo=!1;function c2(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function sI(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Ms(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Mo(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,Xe&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,zs(n,t)}return i=r.interleaved,i===null?(e.next=e,u2(r)):(e.next=i.next,i.next=e),r.interleaved=e,zs(n,t)}function Wp(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,Qv(n,t)}}function C4(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var i=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?i=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?i=s=e:s=s.next=e}else i=s=e;t={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Cg(n,e,t,r){var i=n.updateQueue;wo=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,u=i.shared.pending;if(u!==null){i.shared.pending=null;var c=u,d=c.next;c.next=null,o===null?s=d:o.next=d,o=c;var p=n.alternate;p!==null&&(p=p.updateQueue,u=p.lastBaseUpdate,u!==o&&(u===null?p.firstBaseUpdate=d:u.next=d,p.lastBaseUpdate=c))}if(s!==null){var m=i.baseState;o=0,p=d=c=null,u=s;do{var y=u.lane,E=u.eventTime;if((r&y)===y){p!==null&&(p=p.next={eventTime:E,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var S=n,x=u;switch(y=e,E=t,x.tag){case 1:if(S=x.payload,typeof S=="function"){m=S.call(E,m,y);break e}m=S;break e;case 3:S.flags=S.flags&-65537|128;case 0:if(S=x.payload,y=typeof S=="function"?S.call(E,m,y):S,y==null)break e;m=Ot({},m,y);break e;case 2:wo=!0}}u.callback!==null&&u.lane!==0&&(n.flags|=64,y=i.effects,y===null?i.effects=[u]:y.push(u))}else E={eventTime:E,lane:y,tag:u.tag,payload:u.payload,callback:u.callback,next:null},p===null?(d=p=E,c=m):p=p.next=E,o|=y;if(u=u.next,u===null){if(u=i.shared.pending,u===null)break;y=u,u=y.next,y.next=null,i.lastBaseUpdate=y,i.shared.pending=null}}while(!0);if(p===null&&(c=m),i.baseState=c,i.firstBaseUpdate=d,i.lastBaseUpdate=p,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);$a|=o,n.lanes=o,n.memoizedState=m}}function I4(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],i=r.callback;if(i!==null){if(r.callback=null,r=t,typeof i!="function")throw Error(ie(191,i));i.call(r)}}}var Md={},Ji=Jo(Md),ed=Jo(Md),td=Jo(Md);function ba(n){if(n===Md)throw Error(ie(174));return n}function h2(n,e){switch(wt(td,e),wt(ed,n),wt(Ji,Md),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:o1(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=o1(e,n)}It(Ji),wt(Ji,e)}function xu(){It(Ji),It(ed),It(td)}function oI(n){ba(td.current);var e=ba(Ji.current),t=o1(e,n.type);e!==t&&(wt(ed,n),wt(Ji,t))}function d2(n){ed.current===n&&(It(Ji),It(ed))}var Dt=Jo(0);function Ig(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var hy=[];function f2(){for(var n=0;n<hy.length;n++)hy[n]._workInProgressVersionPrimary=null;hy.length=0}var Hp=qs.ReactCurrentDispatcher,dy=qs.ReactCurrentBatchConfig,Ha=0,Mt=null,sn=null,yn=null,Pg=!1,kh=!1,nd=0,Qk=0;function $n(){throw Error(ie(321))}function p2(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Ai(n[t],e[t]))return!1;return!0}function g2(n,e,t,r,i,s){if(Ha=s,Mt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Hp.current=n===null||n.memoizedState===null?Zk:ex,n=t(r,i),kh){s=0;do{if(kh=!1,nd=0,25<=s)throw Error(ie(301));s+=1,yn=sn=null,e.updateQueue=null,Hp.current=tx,n=t(r,i)}while(kh)}if(Hp.current=Rg,e=sn!==null&&sn.next!==null,Ha=0,yn=sn=Mt=null,Pg=!1,e)throw Error(ie(300));return n}function m2(){var n=nd!==0;return nd=0,n}function qi(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yn===null?Mt.memoizedState=yn=n:yn=yn.next=n,yn}function ni(){if(sn===null){var n=Mt.alternate;n=n!==null?n.memoizedState:null}else n=sn.next;var e=yn===null?Mt.memoizedState:yn.next;if(e!==null)yn=e,sn=n;else{if(n===null)throw Error(ie(310));sn=n,n={memoizedState:sn.memoizedState,baseState:sn.baseState,baseQueue:sn.baseQueue,queue:sn.queue,next:null},yn===null?Mt.memoizedState=yn=n:yn=yn.next=n}return yn}function rd(n,e){return typeof e=="function"?e(n):e}function fy(n){var e=ni(),t=e.queue;if(t===null)throw Error(ie(311));t.lastRenderedReducer=n;var r=sn,i=r.baseQueue,s=t.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,t.pending=null}if(i!==null){s=i.next,r=r.baseState;var u=o=null,c=null,d=s;do{var p=d.lane;if((Ha&p)===p)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:n(r,d.action);else{var m={lane:p,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(u=c=m,o=r):c=c.next=m,Mt.lanes|=p,$a|=p}d=d.next}while(d!==null&&d!==s);c===null?o=r:c.next=u,Ai(r,e.memoizedState)||(Ir=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,t.lastRenderedState=r}if(n=t.interleaved,n!==null){i=n;do s=i.lane,Mt.lanes|=s,$a|=s,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function py(n){var e=ni(),t=e.queue;if(t===null)throw Error(ie(311));t.lastRenderedReducer=n;var r=t.dispatch,i=t.pending,s=e.memoizedState;if(i!==null){t.pending=null;var o=i=i.next;do s=n(s,o.action),o=o.next;while(o!==i);Ai(s,e.memoizedState)||(Ir=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,r]}function aI(){}function lI(n,e){var t=Mt,r=ni(),i=e(),s=!Ai(r.memoizedState,i);if(s&&(r.memoizedState=i,Ir=!0),r=r.queue,_2(hI.bind(null,t,r,n),[n]),r.getSnapshot!==e||s||yn!==null&&yn.memoizedState.tag&1){if(t.flags|=2048,id(9,cI.bind(null,t,r,i,e),void 0,null),En===null)throw Error(ie(349));Ha&30||uI(t,e,i)}return i}function uI(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Mt.updateQueue,e===null?(e={lastEffect:null,stores:null},Mt.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function cI(n,e,t,r){e.value=t,e.getSnapshot=r,dI(e)&&fI(n)}function hI(n,e,t){return t(function(){dI(e)&&fI(n)})}function dI(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Ai(n,t)}catch{return!0}}function fI(n){var e=zs(n,1);e!==null&&Ci(e,n,1,-1)}function P4(n){var e=qi();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:rd,lastRenderedState:n},e.queue=n,n=n.dispatch=Jk.bind(null,Mt,n),[e.memoizedState,n]}function id(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=Mt.updateQueue,e===null?(e={lastEffect:null,stores:null},Mt.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function pI(){return ni().memoizedState}function $p(n,e,t,r){var i=qi();Mt.flags|=n,i.memoizedState=id(1|e,t,void 0,r===void 0?null:r)}function ym(n,e,t,r){var i=ni();r=r===void 0?null:r;var s=void 0;if(sn!==null){var o=sn.memoizedState;if(s=o.destroy,r!==null&&p2(r,o.deps)){i.memoizedState=id(e,t,s,r);return}}Mt.flags|=n,i.memoizedState=id(1|e,t,s,r)}function R4(n,e){return $p(8390656,8,n,e)}function _2(n,e){return ym(2048,8,n,e)}function gI(n,e){return ym(4,2,n,e)}function mI(n,e){return ym(4,4,n,e)}function _I(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function yI(n,e,t){return t=t!=null?t.concat([n]):null,ym(4,4,_I.bind(null,e,n),t)}function y2(){}function vI(n,e){var t=ni();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&p2(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function wI(n,e){var t=ni();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&p2(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function SI(n,e,t){return Ha&21?(Ai(t,e)||(t=P5(),Mt.lanes|=t,$a|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Ir=!0),n.memoizedState=t)}function Yk(n,e){var t=lt;lt=t!==0&&4>t?t:4,n(!0);var r=dy.transition;dy.transition={};try{n(!1),e()}finally{lt=t,dy.transition=r}}function EI(){return ni().memoizedState}function Xk(n,e,t){var r=Lo(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},TI(n))CI(e,t);else if(t=iI(n,e,t,r),t!==null){var i=dr();Ci(t,n,r,i),II(t,e,r)}}function Jk(n,e,t){var r=Lo(n),i={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(TI(n))CI(e,i);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,u=s(o,t);if(i.hasEagerState=!0,i.eagerState=u,Ai(u,o)){var c=e.interleaved;c===null?(i.next=i,u2(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}t=iI(n,e,i,r),t!==null&&(i=dr(),Ci(t,n,r,i),II(t,e,r))}}function TI(n){var e=n.alternate;return n===Mt||e!==null&&e===Mt}function CI(n,e){kh=Pg=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function II(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,Qv(n,t)}}var Rg={readContext:ti,useCallback:$n,useContext:$n,useEffect:$n,useImperativeHandle:$n,useInsertionEffect:$n,useLayoutEffect:$n,useMemo:$n,useReducer:$n,useRef:$n,useState:$n,useDebugValue:$n,useDeferredValue:$n,useTransition:$n,useMutableSource:$n,useSyncExternalStore:$n,useId:$n,unstable_isNewReconciler:!1},Zk={readContext:ti,useCallback:function(n,e){return qi().memoizedState=[n,e===void 0?null:e],n},useContext:ti,useEffect:R4,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,$p(4194308,4,_I.bind(null,e,n),t)},useLayoutEffect:function(n,e){return $p(4194308,4,n,e)},useInsertionEffect:function(n,e){return $p(4,2,n,e)},useMemo:function(n,e){var t=qi();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=qi();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=Xk.bind(null,Mt,n),[r.memoizedState,n]},useRef:function(n){var e=qi();return n={current:n},e.memoizedState=n},useState:P4,useDebugValue:y2,useDeferredValue:function(n){return qi().memoizedState=n},useTransition:function(){var n=P4(!1),e=n[0];return n=Yk.bind(null,n[1]),qi().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=Mt,i=qi();if(At){if(t===void 0)throw Error(ie(407));t=t()}else{if(t=e(),En===null)throw Error(ie(349));Ha&30||uI(r,e,t)}i.memoizedState=t;var s={value:t,getSnapshot:e};return i.queue=s,R4(hI.bind(null,r,s,n),[n]),r.flags|=2048,id(9,cI.bind(null,r,s,t,e),void 0,null),t},useId:function(){var n=qi(),e=En.identifierPrefix;if(At){var t=As,r=Rs;t=(r&~(1<<32-Ti(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=nd++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=Qk++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},ex={readContext:ti,useCallback:vI,useContext:ti,useEffect:_2,useImperativeHandle:yI,useInsertionEffect:gI,useLayoutEffect:mI,useMemo:wI,useReducer:fy,useRef:pI,useState:function(){return fy(rd)},useDebugValue:y2,useDeferredValue:function(n){var e=ni();return SI(e,sn.memoizedState,n)},useTransition:function(){var n=fy(rd)[0],e=ni().memoizedState;return[n,e]},useMutableSource:aI,useSyncExternalStore:lI,useId:EI,unstable_isNewReconciler:!1},tx={readContext:ti,useCallback:vI,useContext:ti,useEffect:_2,useImperativeHandle:yI,useInsertionEffect:gI,useLayoutEffect:mI,useMemo:wI,useReducer:py,useRef:pI,useState:function(){return py(rd)},useDebugValue:y2,useDeferredValue:function(n){var e=ni();return sn===null?e.memoizedState=n:SI(e,sn.memoizedState,n)},useTransition:function(){var n=py(rd)[0],e=ni().memoizedState;return[n,e]},useMutableSource:aI,useSyncExternalStore:lI,useId:EI,unstable_isNewReconciler:!1};function _i(n,e){if(n&&n.defaultProps){e=Ot({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function R1(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:Ot({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var vm={isMounted:function(n){return(n=n._reactInternals)?ol(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=dr(),i=Lo(n),s=Ms(r,i);s.payload=e,t!=null&&(s.callback=t),e=Mo(n,s,i),e!==null&&(Ci(e,n,i,r),Wp(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=dr(),i=Lo(n),s=Ms(r,i);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=Mo(n,s,i),e!==null&&(Ci(e,n,i,r),Wp(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=dr(),r=Lo(n),i=Ms(t,r);i.tag=2,e!=null&&(i.callback=e),e=Mo(n,i,r),e!==null&&(Ci(e,n,r,t),Wp(e,n,r))}};function A4(n,e,t,r,i,s,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Yh(t,r)||!Yh(i,s):!0}function PI(n,e,t){var r=!1,i=Wo,s=e.contextType;return typeof s=="object"&&s!==null?s=ti(s):(i=Ar(e)?ja:tr.current,r=e.contextTypes,s=(r=r!=null)?Ru(n,i):Wo),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=vm,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=s),e}function k4(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&vm.enqueueReplaceState(e,e.state,null)}function A1(n,e,t,r){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},c2(n);var s=e.contextType;typeof s=="object"&&s!==null?i.context=ti(s):(s=Ar(e)?ja:tr.current,i.context=Ru(n,s)),i.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(R1(n,e,s,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&vm.enqueueReplaceState(i,i.state,null),Cg(n,t,i,r),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function Nu(n,e){try{var t="",r=e;do t+=kA(r),r=r.return;while(r);var i=t}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:i,digest:null}}function gy(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function k1(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var nx=typeof WeakMap=="function"?WeakMap:Map;function RI(n,e,t){t=Ms(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){kg||(kg=!0,U1=r),k1(n,e)},t}function AI(n,e,t){t=Ms(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;t.payload=function(){return r(i)},t.callback=function(){k1(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){k1(n,e),typeof r!="function"&&(Oo===null?Oo=new Set([this]):Oo.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function x4(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new nx;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(t)||(i.add(t),n=mx.bind(null,n,e,t),e.then(n,n))}function N4(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function D4(n,e,t,r,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Ms(-1,1),e.tag=2,Mo(t,e,1))),t.lanes|=1),n)}var rx=qs.ReactCurrentOwner,Ir=!1;function ur(n,e,t,r){e.child=n===null?rI(e,null,t,r):ku(e,n.child,t,r)}function M4(n,e,t,r,i){t=t.render;var s=e.ref;return yu(e,i),r=g2(n,e,t,r,s,i),t=m2(),n!==null&&!Ir?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Bs(n,e,i)):(At&&t&&r2(e),e.flags|=1,ur(n,e,r,i),e.child)}function O4(n,e,t,r,i){if(n===null){var s=t.type;return typeof s=="function"&&!P2(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,kI(n,e,s,r,i)):(n=Yp(t.type,null,r,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&i)){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:Yh,t(o,r)&&n.ref===e.ref)return Bs(n,e,i)}return e.flags|=1,n=bo(s,r),n.ref=e.ref,n.return=e,e.child=n}function kI(n,e,t,r,i){if(n!==null){var s=n.memoizedProps;if(Yh(s,r)&&n.ref===e.ref)if(Ir=!1,e.pendingProps=r=s,(n.lanes&i)!==0)n.flags&131072&&(Ir=!0);else return e.lanes=n.lanes,Bs(n,e,i)}return x1(n,e,t,r,i)}function xI(n,e,t){var r=e.pendingProps,i=r.children,s=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},wt(cu,Dr),Dr|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,wt(cu,Dr),Dr|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:t,wt(cu,Dr),Dr|=r}else s!==null?(r=s.baseLanes|t,e.memoizedState=null):r=t,wt(cu,Dr),Dr|=r;return ur(n,e,i,t),e.child}function NI(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function x1(n,e,t,r,i){var s=Ar(t)?ja:tr.current;return s=Ru(e,s),yu(e,i),t=g2(n,e,t,r,s,i),r=m2(),n!==null&&!Ir?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Bs(n,e,i)):(At&&r&&r2(e),e.flags|=1,ur(n,e,t,i),e.child)}function L4(n,e,t,r,i){if(Ar(t)){var s=!0;vg(e)}else s=!1;if(yu(e,i),e.stateNode===null)qp(n,e),PI(e,t,r),A1(e,t,r,i),r=!0;else if(n===null){var o=e.stateNode,u=e.memoizedProps;o.props=u;var c=o.context,d=t.contextType;typeof d=="object"&&d!==null?d=ti(d):(d=Ar(t)?ja:tr.current,d=Ru(e,d));var p=t.getDerivedStateFromProps,m=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(u!==r||c!==d)&&k4(e,o,r,d),wo=!1;var y=e.memoizedState;o.state=y,Cg(e,r,o,i),c=e.memoizedState,u!==r||y!==c||Rr.current||wo?(typeof p=="function"&&(R1(e,t,p,r),c=e.memoizedState),(u=wo||A4(e,t,u,r,y,c,d))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=d,r=u):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,sI(n,e),u=e.memoizedProps,d=e.type===e.elementType?u:_i(e.type,u),o.props=d,m=e.pendingProps,y=o.context,c=t.contextType,typeof c=="object"&&c!==null?c=ti(c):(c=Ar(t)?ja:tr.current,c=Ru(e,c));var E=t.getDerivedStateFromProps;(p=typeof E=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(u!==m||y!==c)&&k4(e,o,r,c),wo=!1,y=e.memoizedState,o.state=y,Cg(e,r,o,i);var S=e.memoizedState;u!==m||y!==S||Rr.current||wo?(typeof E=="function"&&(R1(e,t,E,r),S=e.memoizedState),(d=wo||A4(e,t,d,r,y,S,c)||!1)?(p||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,S,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,S,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||u===n.memoizedProps&&y===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||u===n.memoizedProps&&y===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=S),o.props=r,o.state=S,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||u===n.memoizedProps&&y===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||u===n.memoizedProps&&y===n.memoizedState||(e.flags|=1024),r=!1)}return N1(n,e,t,r,s,i)}function N1(n,e,t,r,i,s){NI(n,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&w4(e,t,!1),Bs(n,e,s);r=e.stateNode,rx.current=e;var u=o&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&o?(e.child=ku(e,n.child,null,s),e.child=ku(e,null,u,s)):ur(n,e,u,s),e.memoizedState=r.state,i&&w4(e,t,!0),e.child}function DI(n){var e=n.stateNode;e.pendingContext?v4(n,e.pendingContext,e.pendingContext!==e.context):e.context&&v4(n,e.context,!1),h2(n,e.containerInfo)}function b4(n,e,t,r,i){return Au(),s2(i),e.flags|=256,ur(n,e,t,r),e.child}var D1={dehydrated:null,treeContext:null,retryLane:0};function M1(n){return{baseLanes:n,cachePool:null,transitions:null}}function MI(n,e,t){var r=e.pendingProps,i=Dt.current,s=!1,o=(e.flags&128)!==0,u;if((u=o)||(u=n!==null&&n.memoizedState===null?!1:(i&2)!==0),u?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),wt(Dt,i&1),n===null)return I1(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,n=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Em(o,r,0,null),n=Ba(n,r,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=M1(t),e.memoizedState=D1,n):v2(e,o));if(i=n.memoizedState,i!==null&&(u=i.dehydrated,u!==null))return ix(n,e,o,r,u,i,t);if(s){s=r.fallback,o=e.mode,i=n.child,u=i.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=bo(i,c),r.subtreeFlags=i.subtreeFlags&14680064),u!==null?s=bo(u,s):(s=Ba(s,o,t,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=n.child.memoizedState,o=o===null?M1(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=n.childLanes&~t,e.memoizedState=D1,r}return s=n.child,n=s.sibling,r=bo(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function v2(n,e){return e=Em({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function Ep(n,e,t,r){return r!==null&&s2(r),ku(e,n.child,null,t),n=v2(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function ix(n,e,t,r,i,s,o){if(t)return e.flags&256?(e.flags&=-257,r=gy(Error(ie(422))),Ep(n,e,o,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Em({mode:"visible",children:r.children},i,0,null),s=Ba(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&ku(e,n.child,null,o),e.child.memoizedState=M1(o),e.memoizedState=D1,s);if(!(e.mode&1))return Ep(n,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var u=r.dgst;return r=u,s=Error(ie(419)),r=gy(s,r,void 0),Ep(n,e,o,r)}if(u=(o&n.childLanes)!==0,Ir||u){if(r=En,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,zs(n,i),Ci(r,n,i,-1))}return I2(),r=gy(Error(ie(421))),Ep(n,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=_x.bind(null,n),i._reactRetry=e,null):(n=s.treeContext,Mr=Do(i.nextSibling),Lr=e,At=!0,vi=null,n!==null&&(Yr[Xr++]=Rs,Yr[Xr++]=As,Yr[Xr++]=Wa,Rs=n.id,As=n.overflow,Wa=e),e=v2(e,r.children),e.flags|=4096,e)}function F4(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),P1(n.return,e,t)}function my(n,e,t,r,i){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=t,s.tailMode=i)}function OI(n,e,t){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(ur(n,e,r.children,t),r=Dt.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&F4(n,t,e);else if(n.tag===19)F4(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(wt(Dt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&Ig(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),my(e,!1,i,t,s);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&Ig(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}my(e,!0,t,null,s);break;case"together":my(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function qp(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Bs(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),$a|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(ie(153));if(e.child!==null){for(n=e.child,t=bo(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=bo(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function sx(n,e,t){switch(e.tag){case 3:DI(e),Au();break;case 5:oI(e);break;case 1:Ar(e.type)&&vg(e);break;case 4:h2(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;wt(Eg,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(wt(Dt,Dt.current&1),e.flags|=128,null):t&e.child.childLanes?MI(n,e,t):(wt(Dt,Dt.current&1),n=Bs(n,e,t),n!==null?n.sibling:null);wt(Dt,Dt.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return OI(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),wt(Dt,Dt.current),r)break;return null;case 22:case 23:return e.lanes=0,xI(n,e,t)}return Bs(n,e,t)}var LI,O1,bI,FI;LI=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};O1=function(){};bI=function(n,e,t,r){var i=n.memoizedProps;if(i!==r){n=e.stateNode,ba(Ji.current);var s=null;switch(t){case"input":i=n1(n,i),r=n1(n,r),s=[];break;case"select":i=Ot({},i,{value:void 0}),r=Ot({},r,{value:void 0}),s=[];break;case"textarea":i=s1(n,i),r=s1(n,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=_g)}a1(t,r);var o;t=null;for(d in i)if(!r.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var u=i[d];for(o in u)u.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(jh.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in r){var c=r[d];if(u=i!=null?i[d]:void 0,r.hasOwnProperty(d)&&c!==u&&(c!=null||u!=null))if(d==="style")if(u){for(o in u)!u.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in c)c.hasOwnProperty(o)&&u[o]!==c[o]&&(t||(t={}),t[o]=c[o])}else t||(s||(s=[]),s.push(d,t)),t=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,u=u?u.__html:void 0,c!=null&&u!==c&&(s=s||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(jh.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Et("scroll",n),s||u===c||(s=[])):(s=s||[]).push(d,c))}t&&(s=s||[]).push("style",t);var d=s;(e.updateQueue=d)&&(e.flags|=4)}};FI=function(n,e,t,r){t!==r&&(e.flags|=4)};function eh(n,e){if(!At)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function qn(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function ox(n,e,t){var r=e.pendingProps;switch(i2(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qn(e),null;case 1:return Ar(e.type)&&yg(),qn(e),null;case 3:return r=e.stateNode,xu(),It(Rr),It(tr),f2(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(wp(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,vi!==null&&(G1(vi),vi=null))),O1(n,e),qn(e),null;case 5:d2(e);var i=ba(td.current);if(t=e.type,n!==null&&e.stateNode!=null)bI(n,e,t,r,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ie(166));return qn(e),null}if(n=ba(Ji.current),wp(e)){r=e.stateNode,t=e.type;var s=e.memoizedProps;switch(r[Ki]=e,r[Zh]=s,n=(e.mode&1)!==0,t){case"dialog":Et("cancel",r),Et("close",r);break;case"iframe":case"object":case"embed":Et("load",r);break;case"video":case"audio":for(i=0;i<mh.length;i++)Et(mh[i],r);break;case"source":Et("error",r);break;case"img":case"image":case"link":Et("error",r),Et("load",r);break;case"details":Et("toggle",r);break;case"input":$E(r,s),Et("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Et("invalid",r);break;case"textarea":KE(r,s),Et("invalid",r)}a1(t,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var u=s[o];o==="children"?typeof u=="string"?r.textContent!==u&&(s.suppressHydrationWarning!==!0&&vp(r.textContent,u,n),i=["children",u]):typeof u=="number"&&r.textContent!==""+u&&(s.suppressHydrationWarning!==!0&&vp(r.textContent,u,n),i=["children",""+u]):jh.hasOwnProperty(o)&&u!=null&&o==="onScroll"&&Et("scroll",r)}switch(t){case"input":hp(r),qE(r,s,!0);break;case"textarea":hp(r),QE(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=_g)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=h5(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=o.createElement(t,{is:r.is}):(n=o.createElement(t),t==="select"&&(o=n,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):n=o.createElementNS(n,t),n[Ki]=e,n[Zh]=r,LI(n,e,!1,!1),e.stateNode=n;e:{switch(o=l1(t,r),t){case"dialog":Et("cancel",n),Et("close",n),i=r;break;case"iframe":case"object":case"embed":Et("load",n),i=r;break;case"video":case"audio":for(i=0;i<mh.length;i++)Et(mh[i],n);i=r;break;case"source":Et("error",n),i=r;break;case"img":case"image":case"link":Et("error",n),Et("load",n),i=r;break;case"details":Et("toggle",n),i=r;break;case"input":$E(n,r),i=n1(n,r),Et("invalid",n);break;case"option":i=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},i=Ot({},r,{value:void 0}),Et("invalid",n);break;case"textarea":KE(n,r),i=s1(n,r),Et("invalid",n);break;default:i=r}a1(t,i),u=i;for(s in u)if(u.hasOwnProperty(s)){var c=u[s];s==="style"?p5(n,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&d5(n,c)):s==="children"?typeof c=="string"?(t!=="textarea"||c!=="")&&Wh(n,c):typeof c=="number"&&Wh(n,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(jh.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Et("scroll",n):c!=null&&jv(n,s,c,o))}switch(t){case"input":hp(n),qE(n,r,!1);break;case"textarea":hp(n),QE(n);break;case"option":r.value!=null&&n.setAttribute("value",""+jo(r.value));break;case"select":n.multiple=!!r.multiple,s=r.value,s!=null?pu(n,!!r.multiple,s,!1):r.defaultValue!=null&&pu(n,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=_g)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return qn(e),null;case 6:if(n&&e.stateNode!=null)FI(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ie(166));if(t=ba(td.current),ba(Ji.current),wp(e)){if(r=e.stateNode,t=e.memoizedProps,r[Ki]=e,(s=r.nodeValue!==t)&&(n=Lr,n!==null))switch(n.tag){case 3:vp(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&vp(r.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[Ki]=e,e.stateNode=r}return qn(e),null;case 13:if(It(Dt),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(At&&Mr!==null&&e.mode&1&&!(e.flags&128))tI(),Au(),e.flags|=98560,s=!1;else if(s=wp(e),r!==null&&r.dehydrated!==null){if(n===null){if(!s)throw Error(ie(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ie(317));s[Ki]=e}else Au(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;qn(e),s=!1}else vi!==null&&(G1(vi),vi=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||Dt.current&1?on===0&&(on=3):I2())),e.updateQueue!==null&&(e.flags|=4),qn(e),null);case 4:return xu(),O1(n,e),n===null&&Xh(e.stateNode.containerInfo),qn(e),null;case 10:return l2(e.type._context),qn(e),null;case 17:return Ar(e.type)&&yg(),qn(e),null;case 19:if(It(Dt),s=e.memoizedState,s===null)return qn(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)eh(s,!1);else{if(on!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=Ig(n),o!==null){for(e.flags|=128,eh(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)s=t,n=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,n=o.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return wt(Dt,Dt.current&1|2),e.child}n=n.sibling}s.tail!==null&&jt()>Du&&(e.flags|=128,r=!0,eh(s,!1),e.lanes=4194304)}else{if(!r)if(n=Ig(o),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),eh(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!At)return qn(e),null}else 2*jt()-s.renderingStartTime>Du&&t!==1073741824&&(e.flags|=128,r=!0,eh(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(t=s.last,t!==null?t.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=jt(),e.sibling=null,t=Dt.current,wt(Dt,r?t&1|2:t&1),e):(qn(e),null);case 22:case 23:return C2(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Dr&1073741824&&(qn(e),e.subtreeFlags&6&&(e.flags|=8192)):qn(e),null;case 24:return null;case 25:return null}throw Error(ie(156,e.tag))}function ax(n,e){switch(i2(e),e.tag){case 1:return Ar(e.type)&&yg(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return xu(),It(Rr),It(tr),f2(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return d2(e),null;case 13:if(It(Dt),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(ie(340));Au()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return It(Dt),null;case 4:return xu(),null;case 10:return l2(e.type._context),null;case 22:case 23:return C2(),null;case 24:return null;default:return null}}var Tp=!1,Yn=!1,lx=typeof WeakSet=="function"?WeakSet:Set,me=null;function uu(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){Ft(n,e,r)}else t.current=null}function L1(n,e,t){try{t()}catch(r){Ft(n,e,r)}}var V4=!1;function ux(n,e){if(y1=pg,n=G5(),n2(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,u=-1,c=-1,d=0,p=0,m=n,y=null;t:for(;;){for(var E;m!==t||i!==0&&m.nodeType!==3||(u=o+i),m!==s||r!==0&&m.nodeType!==3||(c=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(E=m.firstChild)!==null;)y=m,m=E;for(;;){if(m===n)break t;if(y===t&&++d===i&&(u=o),y===s&&++p===r&&(c=o),(E=m.nextSibling)!==null)break;m=y,y=m.parentNode}m=E}t=u===-1||c===-1?null:{start:u,end:c}}else t=null}t=t||{start:0,end:0}}else t=null;for(v1={focusedElem:n,selectionRange:t},pg=!1,me=e;me!==null;)if(e=me,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,me=n;else for(;me!==null;){e=me;try{var S=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(S!==null){var x=S.memoizedProps,D=S.memoizedState,k=e.stateNode,R=k.getSnapshotBeforeUpdate(e.elementType===e.type?x:_i(e.type,x),D);k.__reactInternalSnapshotBeforeUpdate=R}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ie(163))}}catch(P){Ft(e,e.return,P)}if(n=e.sibling,n!==null){n.return=e.return,me=n;break}me=e.return}return S=V4,V4=!1,S}function xh(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&n)===n){var s=i.destroy;i.destroy=void 0,s!==void 0&&L1(e,t,s)}i=i.next}while(i!==r)}}function wm(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function b1(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function VI(n){var e=n.alternate;e!==null&&(n.alternate=null,VI(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Ki],delete e[Zh],delete e[E1],delete e[Hk],delete e[$k])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function UI(n){return n.tag===5||n.tag===3||n.tag===4}function U4(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||UI(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function F1(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=_g));else if(r!==4&&(n=n.child,n!==null))for(F1(n,e,t),n=n.sibling;n!==null;)F1(n,e,t),n=n.sibling}function V1(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(V1(n,e,t),n=n.sibling;n!==null;)V1(n,e,t),n=n.sibling}var Nn=null,yi=!1;function go(n,e,t){for(t=t.child;t!==null;)zI(n,e,t),t=t.sibling}function zI(n,e,t){if(Xi&&typeof Xi.onCommitFiberUnmount=="function")try{Xi.onCommitFiberUnmount(dm,t)}catch{}switch(t.tag){case 5:Yn||uu(t,e);case 6:var r=Nn,i=yi;Nn=null,go(n,e,t),Nn=r,yi=i,Nn!==null&&(yi?(n=Nn,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):Nn.removeChild(t.stateNode));break;case 18:Nn!==null&&(yi?(n=Nn,t=t.stateNode,n.nodeType===8?uy(n.parentNode,t):n.nodeType===1&&uy(n,t),Kh(n)):uy(Nn,t.stateNode));break;case 4:r=Nn,i=yi,Nn=t.stateNode.containerInfo,yi=!0,go(n,e,t),Nn=r,yi=i;break;case 0:case 11:case 14:case 15:if(!Yn&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&L1(t,e,o),i=i.next}while(i!==r)}go(n,e,t);break;case 1:if(!Yn&&(uu(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(u){Ft(t,e,u)}go(n,e,t);break;case 21:go(n,e,t);break;case 22:t.mode&1?(Yn=(r=Yn)||t.memoizedState!==null,go(n,e,t),Yn=r):go(n,e,t);break;default:go(n,e,t)}}function z4(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new lx),e.forEach(function(r){var i=yx.bind(null,n,r);t.has(r)||(t.add(r),r.then(i,i))})}}function gi(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];try{var s=n,o=e,u=o;e:for(;u!==null;){switch(u.tag){case 5:Nn=u.stateNode,yi=!1;break e;case 3:Nn=u.stateNode.containerInfo,yi=!0;break e;case 4:Nn=u.stateNode.containerInfo,yi=!0;break e}u=u.return}if(Nn===null)throw Error(ie(160));zI(s,o,i),Nn=null,yi=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(d){Ft(i,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)BI(e,n),e=e.sibling}function BI(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(gi(e,n),$i(n),r&4){try{xh(3,n,n.return),wm(3,n)}catch(x){Ft(n,n.return,x)}try{xh(5,n,n.return)}catch(x){Ft(n,n.return,x)}}break;case 1:gi(e,n),$i(n),r&512&&t!==null&&uu(t,t.return);break;case 5:if(gi(e,n),$i(n),r&512&&t!==null&&uu(t,t.return),n.flags&32){var i=n.stateNode;try{Wh(i,"")}catch(x){Ft(n,n.return,x)}}if(r&4&&(i=n.stateNode,i!=null)){var s=n.memoizedProps,o=t!==null?t.memoizedProps:s,u=n.type,c=n.updateQueue;if(n.updateQueue=null,c!==null)try{u==="input"&&s.type==="radio"&&s.name!=null&&u5(i,s),l1(u,o);var d=l1(u,s);for(o=0;o<c.length;o+=2){var p=c[o],m=c[o+1];p==="style"?p5(i,m):p==="dangerouslySetInnerHTML"?d5(i,m):p==="children"?Wh(i,m):jv(i,p,m,d)}switch(u){case"input":r1(i,s);break;case"textarea":c5(i,s);break;case"select":var y=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var E=s.value;E!=null?pu(i,!!s.multiple,E,!1):y!==!!s.multiple&&(s.defaultValue!=null?pu(i,!!s.multiple,s.defaultValue,!0):pu(i,!!s.multiple,s.multiple?[]:"",!1))}i[Zh]=s}catch(x){Ft(n,n.return,x)}}break;case 6:if(gi(e,n),$i(n),r&4){if(n.stateNode===null)throw Error(ie(162));i=n.stateNode,s=n.memoizedProps;try{i.nodeValue=s}catch(x){Ft(n,n.return,x)}}break;case 3:if(gi(e,n),$i(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{Kh(e.containerInfo)}catch(x){Ft(n,n.return,x)}break;case 4:gi(e,n),$i(n);break;case 13:gi(e,n),$i(n),i=n.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(E2=jt())),r&4&&z4(n);break;case 22:if(p=t!==null&&t.memoizedState!==null,n.mode&1?(Yn=(d=Yn)||p,gi(e,n),Yn=d):gi(e,n),$i(n),r&8192){if(d=n.memoizedState!==null,(n.stateNode.isHidden=d)&&!p&&n.mode&1)for(me=n,p=n.child;p!==null;){for(m=me=p;me!==null;){switch(y=me,E=y.child,y.tag){case 0:case 11:case 14:case 15:xh(4,y,y.return);break;case 1:uu(y,y.return);var S=y.stateNode;if(typeof S.componentWillUnmount=="function"){r=y,t=y.return;try{e=r,S.props=e.memoizedProps,S.state=e.memoizedState,S.componentWillUnmount()}catch(x){Ft(r,t,x)}}break;case 5:uu(y,y.return);break;case 22:if(y.memoizedState!==null){G4(m);continue}}E!==null?(E.return=y,me=E):G4(m)}p=p.sibling}e:for(p=null,m=n;;){if(m.tag===5){if(p===null){p=m;try{i=m.stateNode,d?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(u=m.stateNode,c=m.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,u.style.display=f5("display",o))}catch(x){Ft(n,n.return,x)}}}else if(m.tag===6){if(p===null)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(x){Ft(n,n.return,x)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===n)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===n)break e;for(;m.sibling===null;){if(m.return===null||m.return===n)break e;p===m&&(p=null),m=m.return}p===m&&(p=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:gi(e,n),$i(n),r&4&&z4(n);break;case 21:break;default:gi(e,n),$i(n)}}function $i(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(UI(t)){var r=t;break e}t=t.return}throw Error(ie(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Wh(i,""),r.flags&=-33);var s=U4(n);V1(n,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,u=U4(n);F1(n,u,o);break;default:throw Error(ie(161))}}catch(c){Ft(n,n.return,c)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function cx(n,e,t){me=n,GI(n)}function GI(n,e,t){for(var r=(n.mode&1)!==0;me!==null;){var i=me,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Tp;if(!o){var u=i.alternate,c=u!==null&&u.memoizedState!==null||Yn;u=Tp;var d=Yn;if(Tp=o,(Yn=c)&&!d)for(me=i;me!==null;)o=me,c=o.child,o.tag===22&&o.memoizedState!==null?j4(i):c!==null?(c.return=o,me=c):j4(i);for(;s!==null;)me=s,GI(s),s=s.sibling;me=i,Tp=u,Yn=d}B4(n)}else i.subtreeFlags&8772&&s!==null?(s.return=i,me=s):B4(n)}}function B4(n){for(;me!==null;){var e=me;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Yn||wm(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Yn)if(t===null)r.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:_i(e.type,t.memoizedProps);r.componentDidUpdate(i,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&I4(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}I4(e,o,t)}break;case 5:var u=e.stateNode;if(t===null&&e.flags&4){t=u;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&t.focus();break;case"img":c.src&&(t.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var p=d.memoizedState;if(p!==null){var m=p.dehydrated;m!==null&&Kh(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ie(163))}Yn||e.flags&512&&b1(e)}catch(y){Ft(e,e.return,y)}}if(e===n){me=null;break}if(t=e.sibling,t!==null){t.return=e.return,me=t;break}me=e.return}}function G4(n){for(;me!==null;){var e=me;if(e===n){me=null;break}var t=e.sibling;if(t!==null){t.return=e.return,me=t;break}me=e.return}}function j4(n){for(;me!==null;){var e=me;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{wm(4,e)}catch(c){Ft(e,t,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(c){Ft(e,i,c)}}var s=e.return;try{b1(e)}catch(c){Ft(e,s,c)}break;case 5:var o=e.return;try{b1(e)}catch(c){Ft(e,o,c)}}}catch(c){Ft(e,e.return,c)}if(e===n){me=null;break}var u=e.sibling;if(u!==null){u.return=e.return,me=u;break}me=e.return}}var hx=Math.ceil,Ag=qs.ReactCurrentDispatcher,w2=qs.ReactCurrentOwner,ei=qs.ReactCurrentBatchConfig,Xe=0,En=null,Qt=null,On=0,Dr=0,cu=Jo(0),on=0,sd=null,$a=0,Sm=0,S2=0,Nh=null,Cr=null,E2=0,Du=1/0,Cs=null,kg=!1,U1=null,Oo=null,Cp=!1,Ro=null,xg=0,Dh=0,z1=null,Kp=-1,Qp=0;function dr(){return Xe&6?jt():Kp!==-1?Kp:Kp=jt()}function Lo(n){return n.mode&1?Xe&2&&On!==0?On&-On:Kk.transition!==null?(Qp===0&&(Qp=P5()),Qp):(n=lt,n!==0||(n=window.event,n=n===void 0?16:M5(n.type)),n):1}function Ci(n,e,t,r){if(50<Dh)throw Dh=0,z1=null,Error(ie(185));xd(n,t,r),(!(Xe&2)||n!==En)&&(n===En&&(!(Xe&2)&&(Sm|=t),on===4&&Eo(n,On)),kr(n,r),t===1&&Xe===0&&!(e.mode&1)&&(Du=jt()+500,_m&&Zo()))}function kr(n,e){var t=n.callbackNode;KA(n,e);var r=fg(n,n===En?On:0);if(r===0)t!==null&&JE(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&JE(t),e===1)n.tag===0?qk(W4.bind(null,n)):J5(W4.bind(null,n)),jk(function(){!(Xe&6)&&Zo()}),t=null;else{switch(R5(r)){case 1:t=Kv;break;case 4:t=C5;break;case 16:t=dg;break;case 536870912:t=I5;break;default:t=dg}t=YI(t,jI.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function jI(n,e){if(Kp=-1,Qp=0,Xe&6)throw Error(ie(327));var t=n.callbackNode;if(vu()&&n.callbackNode!==t)return null;var r=fg(n,n===En?On:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=Ng(n,r);else{e=r;var i=Xe;Xe|=2;var s=HI();(En!==n||On!==e)&&(Cs=null,Du=jt()+500,za(n,e));do try{px();break}catch(u){WI(n,u)}while(!0);a2(),Ag.current=s,Xe=i,Qt!==null?e=0:(En=null,On=0,e=on)}if(e!==0){if(e===2&&(i=f1(n),i!==0&&(r=i,e=B1(n,i))),e===1)throw t=sd,za(n,0),Eo(n,r),kr(n,jt()),t;if(e===6)Eo(n,r);else{if(i=n.current.alternate,!(r&30)&&!dx(i)&&(e=Ng(n,r),e===2&&(s=f1(n),s!==0&&(r=s,e=B1(n,s))),e===1))throw t=sd,za(n,0),Eo(n,r),kr(n,jt()),t;switch(n.finishedWork=i,n.finishedLanes=r,e){case 0:case 1:throw Error(ie(345));case 2:xa(n,Cr,Cs);break;case 3:if(Eo(n,r),(r&130023424)===r&&(e=E2+500-jt(),10<e)){if(fg(n,0)!==0)break;if(i=n.suspendedLanes,(i&r)!==r){dr(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=S1(xa.bind(null,n,Cr,Cs),e);break}xa(n,Cr,Cs);break;case 4:if(Eo(n,r),(r&4194240)===r)break;for(e=n.eventTimes,i=-1;0<r;){var o=31-Ti(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=jt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*hx(r/1960))-r,10<r){n.timeoutHandle=S1(xa.bind(null,n,Cr,Cs),r);break}xa(n,Cr,Cs);break;case 5:xa(n,Cr,Cs);break;default:throw Error(ie(329))}}}return kr(n,jt()),n.callbackNode===t?jI.bind(null,n):null}function B1(n,e){var t=Nh;return n.current.memoizedState.isDehydrated&&(za(n,e).flags|=256),n=Ng(n,e),n!==2&&(e=Cr,Cr=t,e!==null&&G1(e)),n}function G1(n){Cr===null?Cr=n:Cr.push.apply(Cr,n)}function dx(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var i=t[r],s=i.getSnapshot;i=i.value;try{if(!Ai(s(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Eo(n,e){for(e&=~S2,e&=~Sm,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Ti(e),r=1<<t;n[t]=-1,e&=~r}}function W4(n){if(Xe&6)throw Error(ie(327));vu();var e=fg(n,0);if(!(e&1))return kr(n,jt()),null;var t=Ng(n,e);if(n.tag!==0&&t===2){var r=f1(n);r!==0&&(e=r,t=B1(n,r))}if(t===1)throw t=sd,za(n,0),Eo(n,e),kr(n,jt()),t;if(t===6)throw Error(ie(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,xa(n,Cr,Cs),kr(n,jt()),null}function T2(n,e){var t=Xe;Xe|=1;try{return n(e)}finally{Xe=t,Xe===0&&(Du=jt()+500,_m&&Zo())}}function qa(n){Ro!==null&&Ro.tag===0&&!(Xe&6)&&vu();var e=Xe;Xe|=1;var t=ei.transition,r=lt;try{if(ei.transition=null,lt=1,n)return n()}finally{lt=r,ei.transition=t,Xe=e,!(Xe&6)&&Zo()}}function C2(){Dr=cu.current,It(cu)}function za(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,Gk(t)),Qt!==null)for(t=Qt.return;t!==null;){var r=t;switch(i2(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&yg();break;case 3:xu(),It(Rr),It(tr),f2();break;case 5:d2(r);break;case 4:xu();break;case 13:It(Dt);break;case 19:It(Dt);break;case 10:l2(r.type._context);break;case 22:case 23:C2()}t=t.return}if(En=n,Qt=n=bo(n.current,null),On=Dr=e,on=0,sd=null,S2=Sm=$a=0,Cr=Nh=null,La!==null){for(e=0;e<La.length;e++)if(t=La[e],r=t.interleaved,r!==null){t.interleaved=null;var i=r.next,s=t.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}t.pending=r}La=null}return n}function WI(n,e){do{var t=Qt;try{if(a2(),Hp.current=Rg,Pg){for(var r=Mt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Pg=!1}if(Ha=0,yn=sn=Mt=null,kh=!1,nd=0,w2.current=null,t===null||t.return===null){on=1,sd=e,Qt=null;break}e:{var s=n,o=t.return,u=t,c=e;if(e=On,u.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,p=u,m=p.tag;if(!(p.mode&1)&&(m===0||m===11||m===15)){var y=p.alternate;y?(p.updateQueue=y.updateQueue,p.memoizedState=y.memoizedState,p.lanes=y.lanes):(p.updateQueue=null,p.memoizedState=null)}var E=N4(o);if(E!==null){E.flags&=-257,D4(E,o,u,s,e),E.mode&1&&x4(s,d,e),e=E,c=d;var S=e.updateQueue;if(S===null){var x=new Set;x.add(c),e.updateQueue=x}else S.add(c);break e}else{if(!(e&1)){x4(s,d,e),I2();break e}c=Error(ie(426))}}else if(At&&u.mode&1){var D=N4(o);if(D!==null){!(D.flags&65536)&&(D.flags|=256),D4(D,o,u,s,e),s2(Nu(c,u));break e}}s=c=Nu(c,u),on!==4&&(on=2),Nh===null?Nh=[s]:Nh.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var k=RI(s,c,e);C4(s,k);break e;case 1:u=c;var R=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof R.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Oo===null||!Oo.has(w)))){s.flags|=65536,e&=-e,s.lanes|=e;var P=AI(s,u,e);C4(s,P);break e}}s=s.return}while(s!==null)}qI(t)}catch(V){e=V,Qt===t&&t!==null&&(Qt=t=t.return);continue}break}while(!0)}function HI(){var n=Ag.current;return Ag.current=Rg,n===null?Rg:n}function I2(){(on===0||on===3||on===2)&&(on=4),En===null||!($a&268435455)&&!(Sm&268435455)||Eo(En,On)}function Ng(n,e){var t=Xe;Xe|=2;var r=HI();(En!==n||On!==e)&&(Cs=null,za(n,e));do try{fx();break}catch(i){WI(n,i)}while(!0);if(a2(),Xe=t,Ag.current=r,Qt!==null)throw Error(ie(261));return En=null,On=0,on}function fx(){for(;Qt!==null;)$I(Qt)}function px(){for(;Qt!==null&&!UA();)$I(Qt)}function $I(n){var e=QI(n.alternate,n,Dr);n.memoizedProps=n.pendingProps,e===null?qI(n):Qt=e,w2.current=null}function qI(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=ax(t,e),t!==null){t.flags&=32767,Qt=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{on=6,Qt=null;return}}else if(t=ox(t,e,Dr),t!==null){Qt=t;return}if(e=e.sibling,e!==null){Qt=e;return}Qt=e=n}while(e!==null);on===0&&(on=5)}function xa(n,e,t){var r=lt,i=ei.transition;try{ei.transition=null,lt=1,gx(n,e,t,r)}finally{ei.transition=i,lt=r}return null}function gx(n,e,t,r){do vu();while(Ro!==null);if(Xe&6)throw Error(ie(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(ie(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(QA(n,s),n===En&&(Qt=En=null,On=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Cp||(Cp=!0,YI(dg,function(){return vu(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=ei.transition,ei.transition=null;var o=lt;lt=1;var u=Xe;Xe|=4,w2.current=null,ux(n,t),BI(t,n),Lk(v1),pg=!!y1,v1=y1=null,n.current=t,cx(t),zA(),Xe=u,lt=o,ei.transition=s}else n.current=t;if(Cp&&(Cp=!1,Ro=n,xg=i),s=n.pendingLanes,s===0&&(Oo=null),jA(t.stateNode),kr(n,jt()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],r(i.value,{componentStack:i.stack,digest:i.digest});if(kg)throw kg=!1,n=U1,U1=null,n;return xg&1&&n.tag!==0&&vu(),s=n.pendingLanes,s&1?n===z1?Dh++:(Dh=0,z1=n):Dh=0,Zo(),null}function vu(){if(Ro!==null){var n=R5(xg),e=ei.transition,t=lt;try{if(ei.transition=null,lt=16>n?16:n,Ro===null)var r=!1;else{if(n=Ro,Ro=null,xg=0,Xe&6)throw Error(ie(331));var i=Xe;for(Xe|=4,me=n.current;me!==null;){var s=me,o=s.child;if(me.flags&16){var u=s.deletions;if(u!==null){for(var c=0;c<u.length;c++){var d=u[c];for(me=d;me!==null;){var p=me;switch(p.tag){case 0:case 11:case 15:xh(8,p,s)}var m=p.child;if(m!==null)m.return=p,me=m;else for(;me!==null;){p=me;var y=p.sibling,E=p.return;if(VI(p),p===d){me=null;break}if(y!==null){y.return=E,me=y;break}me=E}}}var S=s.alternate;if(S!==null){var x=S.child;if(x!==null){S.child=null;do{var D=x.sibling;x.sibling=null,x=D}while(x!==null)}}me=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,me=o;else e:for(;me!==null;){if(s=me,s.flags&2048)switch(s.tag){case 0:case 11:case 15:xh(9,s,s.return)}var k=s.sibling;if(k!==null){k.return=s.return,me=k;break e}me=s.return}}var R=n.current;for(me=R;me!==null;){o=me;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,me=w;else e:for(o=R;me!==null;){if(u=me,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:wm(9,u)}}catch(V){Ft(u,u.return,V)}if(u===o){me=null;break e}var P=u.sibling;if(P!==null){P.return=u.return,me=P;break e}me=u.return}}if(Xe=i,Zo(),Xi&&typeof Xi.onPostCommitFiberRoot=="function")try{Xi.onPostCommitFiberRoot(dm,n)}catch{}r=!0}return r}finally{lt=t,ei.transition=e}}return!1}function H4(n,e,t){e=Nu(t,e),e=RI(n,e,1),n=Mo(n,e,1),e=dr(),n!==null&&(xd(n,1,e),kr(n,e))}function Ft(n,e,t){if(n.tag===3)H4(n,n,t);else for(;e!==null;){if(e.tag===3){H4(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Oo===null||!Oo.has(r))){n=Nu(t,n),n=AI(e,n,1),e=Mo(e,n,1),n=dr(),e!==null&&(xd(e,1,n),kr(e,n));break}}e=e.return}}function mx(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=dr(),n.pingedLanes|=n.suspendedLanes&t,En===n&&(On&t)===t&&(on===4||on===3&&(On&130023424)===On&&500>jt()-E2?za(n,0):S2|=t),kr(n,e)}function KI(n,e){e===0&&(n.mode&1?(e=pp,pp<<=1,!(pp&130023424)&&(pp=4194304)):e=1);var t=dr();n=zs(n,e),n!==null&&(xd(n,e,t),kr(n,t))}function _x(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),KI(n,t)}function yx(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(ie(314))}r!==null&&r.delete(e),KI(n,t)}var QI;QI=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Rr.current)Ir=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Ir=!1,sx(n,e,t);Ir=!!(n.flags&131072)}else Ir=!1,At&&e.flags&1048576&&Z5(e,Sg,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;qp(n,e),n=e.pendingProps;var i=Ru(e,tr.current);yu(e,t),i=g2(null,e,r,n,i,t);var s=m2();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ar(r)?(s=!0,vg(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,c2(e),i.updater=vm,e.stateNode=i,i._reactInternals=e,A1(e,r,n,t),e=N1(null,e,r,!0,s,t)):(e.tag=0,At&&s&&r2(e),ur(null,e,i,t),e=e.child),e;case 16:r=e.elementType;e:{switch(qp(n,e),n=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=wx(r),n=_i(r,n),i){case 0:e=x1(null,e,r,n,t);break e;case 1:e=L4(null,e,r,n,t);break e;case 11:e=M4(null,e,r,n,t);break e;case 14:e=O4(null,e,r,_i(r.type,n),t);break e}throw Error(ie(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:_i(r,i),x1(n,e,r,i,t);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:_i(r,i),L4(n,e,r,i,t);case 3:e:{if(DI(e),n===null)throw Error(ie(387));r=e.pendingProps,s=e.memoizedState,i=s.element,sI(n,e),Cg(e,r,null,t);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Nu(Error(ie(423)),e),e=b4(n,e,r,t,i);break e}else if(r!==i){i=Nu(Error(ie(424)),e),e=b4(n,e,r,t,i);break e}else for(Mr=Do(e.stateNode.containerInfo.firstChild),Lr=e,At=!0,vi=null,t=rI(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Au(),r===i){e=Bs(n,e,t);break e}ur(n,e,r,t)}e=e.child}return e;case 5:return oI(e),n===null&&I1(e),r=e.type,i=e.pendingProps,s=n!==null?n.memoizedProps:null,o=i.children,w1(r,i)?o=null:s!==null&&w1(r,s)&&(e.flags|=32),NI(n,e),ur(n,e,o,t),e.child;case 6:return n===null&&I1(e),null;case 13:return MI(n,e,t);case 4:return h2(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=ku(e,null,r,t):ur(n,e,r,t),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:_i(r,i),M4(n,e,r,i,t);case 7:return ur(n,e,e.pendingProps,t),e.child;case 8:return ur(n,e,e.pendingProps.children,t),e.child;case 12:return ur(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,wt(Eg,r._currentValue),r._currentValue=o,s!==null)if(Ai(s.value,o)){if(s.children===i.children&&!Rr.current){e=Bs(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var u=s.dependencies;if(u!==null){o=s.child;for(var c=u.firstContext;c!==null;){if(c.context===r){if(s.tag===1){c=Ms(-1,t&-t),c.tag=2;var d=s.updateQueue;if(d!==null){d=d.shared;var p=d.pending;p===null?c.next=c:(c.next=p.next,p.next=c),d.pending=c}}s.lanes|=t,c=s.alternate,c!==null&&(c.lanes|=t),P1(s.return,t,e),u.lanes|=t;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(ie(341));o.lanes|=t,u=o.alternate,u!==null&&(u.lanes|=t),P1(o,t,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}ur(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,yu(e,t),i=ti(i),r=r(i),e.flags|=1,ur(n,e,r,t),e.child;case 14:return r=e.type,i=_i(r,e.pendingProps),i=_i(r.type,i),O4(n,e,r,i,t);case 15:return kI(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:_i(r,i),qp(n,e),e.tag=1,Ar(r)?(n=!0,vg(e)):n=!1,yu(e,t),PI(e,r,i),A1(e,r,i,t),N1(null,e,r,!0,n,t);case 19:return OI(n,e,t);case 22:return xI(n,e,t)}throw Error(ie(156,e.tag))};function YI(n,e){return T5(n,e)}function vx(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Jr(n,e,t,r){return new vx(n,e,t,r)}function P2(n){return n=n.prototype,!(!n||!n.isReactComponent)}function wx(n){if(typeof n=="function")return P2(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Hv)return 11;if(n===$v)return 14}return 2}function bo(n,e){var t=n.alternate;return t===null?(t=Jr(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Yp(n,e,t,r,i,s){var o=2;if(r=n,typeof n=="function")P2(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case eu:return Ba(t.children,i,s,e);case Wv:o=8,i|=8;break;case Jy:return n=Jr(12,t,e,i|2),n.elementType=Jy,n.lanes=s,n;case Zy:return n=Jr(13,t,e,i),n.elementType=Zy,n.lanes=s,n;case e1:return n=Jr(19,t,e,i),n.elementType=e1,n.lanes=s,n;case o5:return Em(t,i,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case i5:o=10;break e;case s5:o=9;break e;case Hv:o=11;break e;case $v:o=14;break e;case vo:o=16,r=null;break e}throw Error(ie(130,n==null?n:typeof n,""))}return e=Jr(o,t,e,i),e.elementType=n,e.type=r,e.lanes=s,e}function Ba(n,e,t,r){return n=Jr(7,n,r,e),n.lanes=t,n}function Em(n,e,t,r){return n=Jr(22,n,r,e),n.elementType=o5,n.lanes=t,n.stateNode={isHidden:!1},n}function _y(n,e,t){return n=Jr(6,n,null,e),n.lanes=t,n}function yy(n,e,t){return e=Jr(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function Sx(n,e,t,r,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=J_(0),this.expirationTimes=J_(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=J_(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function R2(n,e,t,r,i,s,o,u,c){return n=new Sx(n,e,t,u,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Jr(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},c2(s),n}function Ex(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Zl,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function XI(n){if(!n)return Wo;n=n._reactInternals;e:{if(ol(n)!==n||n.tag!==1)throw Error(ie(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ar(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ie(171))}if(n.tag===1){var t=n.type;if(Ar(t))return X5(n,t,e)}return e}function JI(n,e,t,r,i,s,o,u,c){return n=R2(t,r,!0,n,i,s,o,u,c),n.context=XI(null),t=n.current,r=dr(),i=Lo(t),s=Ms(r,i),s.callback=e??null,Mo(t,s,i),n.current.lanes=i,xd(n,i,r),kr(n,r),n}function Tm(n,e,t,r){var i=e.current,s=dr(),o=Lo(i);return t=XI(t),e.context===null?e.context=t:e.pendingContext=t,e=Ms(s,o),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=Mo(i,e,o),n!==null&&(Ci(n,i,o,s),Wp(n,i,o)),o}function Dg(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function $4(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function A2(n,e){$4(n,e),(n=n.alternate)&&$4(n,e)}function Tx(){return null}var ZI=typeof reportError=="function"?reportError:function(n){console.error(n)};function k2(n){this._internalRoot=n}Cm.prototype.render=k2.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(ie(409));Tm(n,e,null,null)};Cm.prototype.unmount=k2.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;qa(function(){Tm(null,n,null,null)}),e[Us]=null}};function Cm(n){this._internalRoot=n}Cm.prototype.unstable_scheduleHydration=function(n){if(n){var e=x5();n={blockedOn:null,target:n,priority:e};for(var t=0;t<So.length&&e!==0&&e<So[t].priority;t++);So.splice(t,0,n),t===0&&D5(n)}};function x2(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Im(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function q4(){}function Cx(n,e,t,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var d=Dg(o);s.call(d)}}var o=JI(e,r,n,0,null,!1,!1,"",q4);return n._reactRootContainer=o,n[Us]=o.current,Xh(n.nodeType===8?n.parentNode:n),qa(),o}for(;i=n.lastChild;)n.removeChild(i);if(typeof r=="function"){var u=r;r=function(){var d=Dg(c);u.call(d)}}var c=R2(n,0,!1,null,null,!1,!1,"",q4);return n._reactRootContainer=c,n[Us]=c.current,Xh(n.nodeType===8?n.parentNode:n),qa(function(){Tm(e,c,t,r)}),c}function Pm(n,e,t,r,i){var s=t._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var u=i;i=function(){var c=Dg(o);u.call(c)}}Tm(e,o,n,i)}else o=Cx(t,e,n,i,r);return Dg(o)}A5=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=gh(e.pendingLanes);t!==0&&(Qv(e,t|1),kr(e,jt()),!(Xe&6)&&(Du=jt()+500,Zo()))}break;case 13:qa(function(){var r=zs(n,1);if(r!==null){var i=dr();Ci(r,n,1,i)}}),A2(n,1)}};Yv=function(n){if(n.tag===13){var e=zs(n,134217728);if(e!==null){var t=dr();Ci(e,n,134217728,t)}A2(n,134217728)}};k5=function(n){if(n.tag===13){var e=Lo(n),t=zs(n,e);if(t!==null){var r=dr();Ci(t,n,e,r)}A2(n,e)}};x5=function(){return lt};N5=function(n,e){var t=lt;try{return lt=n,e()}finally{lt=t}};c1=function(n,e,t){switch(e){case"input":if(r1(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var i=mm(r);if(!i)throw Error(ie(90));l5(r),r1(r,i)}}}break;case"textarea":c5(n,t);break;case"select":e=t.value,e!=null&&pu(n,!!t.multiple,e,!1)}};_5=T2;y5=qa;var Ix={usingClientEntryPoint:!1,Events:[Dd,iu,mm,g5,m5,T2]},th={findFiberByHostInstance:Oa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Px={bundleType:th.bundleType,version:th.version,rendererPackageName:th.rendererPackageName,rendererConfig:th.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:qs.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=S5(n),n===null?null:n.stateNode},findFiberByHostInstance:th.findFiberByHostInstance||Tx,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ip=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ip.isDisabled&&Ip.supportsFiber)try{dm=Ip.inject(Px),Xi=Ip}catch{}}Ur.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ix;Ur.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!x2(e))throw Error(ie(200));return Ex(n,e,null,t)};Ur.createRoot=function(n,e){if(!x2(n))throw Error(ie(299));var t=!1,r="",i=ZI;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=R2(n,1,!1,null,null,t,!1,r,i),n[Us]=e.current,Xh(n.nodeType===8?n.parentNode:n),new k2(e)};Ur.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(ie(188)):(n=Object.keys(n).join(","),Error(ie(268,n)));return n=S5(e),n=n===null?null:n.stateNode,n};Ur.flushSync=function(n){return qa(n)};Ur.hydrate=function(n,e,t){if(!Im(e))throw Error(ie(200));return Pm(null,n,e,!0,t)};Ur.hydrateRoot=function(n,e,t){if(!x2(n))throw Error(ie(405));var r=t!=null&&t.hydratedSources||null,i=!1,s="",o=ZI;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=JI(e,null,n,1,t??null,i,!1,s,o),n[Us]=e.current,Xh(n),r)for(n=0;n<r.length;n++)t=r[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new Cm(e)};Ur.render=function(n,e,t){if(!Im(e))throw Error(ie(200));return Pm(null,n,e,!1,t)};Ur.unmountComponentAtNode=function(n){if(!Im(n))throw Error(ie(40));return n._reactRootContainer?(qa(function(){Pm(null,null,n,!1,function(){n._reactRootContainer=null,n[Us]=null})}),!0):!1};Ur.unstable_batchedUpdates=T2;Ur.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!Im(t))throw Error(ie(200));if(n==null||n._reactInternals===void 0)throw Error(ie(38));return Pm(n,e,t,!1,r)};Ur.version="18.3.1-next-f1338f8080-20240426";function e6(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e6)}catch(n){console.error(n)}}e6(),e5.exports=Ur;var Rx=e5.exports,K4=Rx;Yy.createRoot=K4.createRoot,Yy.hydrateRoot=K4.hydrateRoot;var Q4={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t6={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const le=function(n,e){if(!n)throw Yu(e)},Yu=function(n){return new Error("Firebase Database ("+t6.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n6=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Ax=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],o=n[t++],u=n[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},N2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],o=i+1<n.length,u=o?n[i+1]:0,c=i+2<n.length,d=c?n[i+2]:0,p=s>>2,m=(s&3)<<4|u>>4;let y=(u&15)<<2|d>>6,E=d&63;c||(E=64,o||(y=64)),r.push(t[p],t[m],t[y],t[E])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(n6(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Ax(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],u=i<n.length?t[n.charAt(i)]:0;++i;const d=i<n.length?t[n.charAt(i)]:64;++i;const m=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||u==null||d==null||m==null)throw new kx;const y=s<<2|u>>4;if(r.push(y),d!==64){const E=u<<4&240|d>>2;if(r.push(E),m!==64){const S=d<<6&192|m;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class kx extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const r6=function(n){const e=n6(n);return N2.encodeByteArray(e,!0)},Mg=function(n){return r6(n).replace(/\./g,"")},Og=function(n){try{return N2.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xx(n){return i6(void 0,n)}function i6(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!Nx(t)||(n[t]=i6(n[t],e[t]));return n}function Nx(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dx(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mx=()=>Dx().__FIREBASE_DEFAULTS__,Ox=()=>{if(typeof process>"u"||typeof Q4>"u")return;const n=Q4.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Lx=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Og(n[1]);return e&&JSON.parse(e)},Rm=()=>{try{return Mx()||Ox()||Lx()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},s6=n=>{var e,t;return(t=(e=Rm())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},o6=n=>{const e=s6(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},a6=()=>{var n;return(n=Rm())===null||n===void 0?void 0:n.config},l6=n=>{var e;return(e=Rm())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D2{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u6(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Mg(JSON.stringify(t)),Mg(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function M2(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(nr())}function bx(){var n;const e=(n=Rm())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Fx(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Vx(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function c6(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Ux(){const n=nr();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function zx(){return t6.NODE_ADMIN===!0}function Bx(){return!bx()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Gx(){try{return typeof indexedDB=="object"}catch{return!1}}function jx(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wx="FirebaseError";class Ks extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=Wx,Object.setPrototypeOf(this,Ks.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Od.prototype.create)}}class Od{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?Hx(s,r):"Error",u=`${this.serviceName}: ${o} (${i}).`;return new Ks(i,u,r)}}function Hx(n,e){return n.replace($x,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const $x=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function od(n){return JSON.parse(n)}function Dn(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h6=function(n){let e={},t={},r={},i="";try{const s=n.split(".");e=od(Og(s[0])||""),t=od(Og(s[1])||""),i=s[2],r=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:r,signature:i}},qx=function(n){const e=h6(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},Kx=function(n){const e=h6(n).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qs(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Mu(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function j1(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Lg(n,e,t){const r={};for(const i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=e.call(t,n[i],i,n));return r}function bg(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],o=e[i];if(Y4(s)&&Y4(o)){if(!bg(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function Y4(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xu(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function _h(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function yh(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qx{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const r=this.W_;if(typeof e=="string")for(let m=0;m<16;m++)r[m]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let m=0;m<16;m++)r[m]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let m=16;m<80;m++){const y=r[m-3]^r[m-8]^r[m-14]^r[m-16];r[m]=(y<<1|y>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],u=this.chain_[3],c=this.chain_[4],d,p;for(let m=0;m<80;m++){m<40?m<20?(d=u^s&(o^u),p=1518500249):(d=s^o^u,p=1859775393):m<60?(d=s&o|u&(s|o),p=2400959708):(d=s^o^u,p=3395469782);const y=(i<<5|i>>>27)+d+c+p+r[m]&4294967295;c=u,u=o,o=(s<<30|s>>>2)&4294967295,s=i,i=y}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+u&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const r=t-this.blockSize;let i=0;const s=this.buf_;let o=this.inbuf_;for(;i<t;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<t;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<t;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=t&255,t/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}}function Yx(n,e){const t=new Xx(n,e);return t.subscribe.bind(t)}class Xx{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");Jx(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=vy),i.error===void 0&&(i.error=vy),i.complete===void 0&&(i.complete=vy);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Jx(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function vy(){}function Zx(n,e){return`${n} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e7=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);if(i>=55296&&i<=56319){const s=i-55296;r++,le(r<n.length,"Surrogate pair missing trail surrogate.");const o=n.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):i<65536?(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Am=function(n){let e=0;for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lt(n){return n&&n._delegate?n._delegate:n}class Ho{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Na="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t7{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new D2;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(r7(e))try{this.getOrInitializeService({instanceIdentifier:Na})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Na){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Na){return this.instances.has(e)}getOptions(e=Na){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,o]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(s);r===u&&o.resolve(i)}return i}onInit(e,t){var r;const i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:n7(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Na){return this.component?this.component.multipleInstances?e:Na:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function n7(n){return n===Na?void 0:n}function r7(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i7{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new t7(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ze;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(ze||(ze={}));const s7={debug:ze.DEBUG,verbose:ze.VERBOSE,info:ze.INFO,warn:ze.WARN,error:ze.ERROR,silent:ze.SILENT},o7=ze.INFO,a7={[ze.DEBUG]:"log",[ze.VERBOSE]:"log",[ze.INFO]:"info",[ze.WARN]:"warn",[ze.ERROR]:"error"},l7=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=a7[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class km{constructor(e){this.name=e,this._logLevel=o7,this._logHandler=l7,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ze))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?s7[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ze.DEBUG,...e),this._logHandler(this,ze.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ze.VERBOSE,...e),this._logHandler(this,ze.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ze.INFO,...e),this._logHandler(this,ze.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ze.WARN,...e),this._logHandler(this,ze.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ze.ERROR,...e),this._logHandler(this,ze.ERROR,...e)}}const u7=(n,e)=>e.some(t=>n instanceof t);let X4,J4;function c7(){return X4||(X4=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function h7(){return J4||(J4=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const d6=new WeakMap,W1=new WeakMap,f6=new WeakMap,wy=new WeakMap,O2=new WeakMap;function d7(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Fo(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&d6.set(t,n)}).catch(()=>{}),O2.set(e,n),e}function f7(n){if(W1.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});W1.set(n,e)}let H1={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return W1.get(n);if(e==="objectStoreNames")return n.objectStoreNames||f6.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Fo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function p7(n){H1=n(H1)}function g7(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Sy(this),e,...t);return f6.set(r,e.sort?e.sort():[e]),Fo(r)}:h7().includes(n)?function(...e){return n.apply(Sy(this),e),Fo(d6.get(this))}:function(...e){return Fo(n.apply(Sy(this),e))}}function m7(n){return typeof n=="function"?g7(n):(n instanceof IDBTransaction&&f7(n),u7(n,c7())?new Proxy(n,H1):n)}function Fo(n){if(n instanceof IDBRequest)return d7(n);if(wy.has(n))return wy.get(n);const e=m7(n);return e!==n&&(wy.set(n,e),O2.set(e,n)),e}const Sy=n=>O2.get(n);function _7(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(n,e),u=Fo(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Fo(o.result),c.oldVersion,c.newVersion,Fo(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),u.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}const y7=["get","getKey","getAll","getAllKeys","count"],v7=["put","add","delete","clear"],Ey=new Map;function Z4(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ey.get(e))return Ey.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=v7.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||y7.includes(t)))return;const s=async function(o,...u){const c=this.transaction(o,i?"readwrite":"readonly");let d=c.store;return r&&(d=d.index(u.shift())),(await Promise.all([d[t](...u),i&&c.done]))[0]};return Ey.set(e,s),s}p7(n=>({...n,get:(e,t,r)=>Z4(e,t)||n.get(e,t,r),has:(e,t)=>!!Z4(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w7{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(S7(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function S7(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const $1="@firebase/app",eT="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gs=new km("@firebase/app"),E7="@firebase/app-compat",T7="@firebase/analytics-compat",C7="@firebase/analytics",I7="@firebase/app-check-compat",P7="@firebase/app-check",R7="@firebase/auth",A7="@firebase/auth-compat",k7="@firebase/database",x7="@firebase/data-connect",N7="@firebase/database-compat",D7="@firebase/functions",M7="@firebase/functions-compat",O7="@firebase/installations",L7="@firebase/installations-compat",b7="@firebase/messaging",F7="@firebase/messaging-compat",V7="@firebase/performance",U7="@firebase/performance-compat",z7="@firebase/remote-config",B7="@firebase/remote-config-compat",G7="@firebase/storage",j7="@firebase/storage-compat",W7="@firebase/firestore",H7="@firebase/vertexai-preview",$7="@firebase/firestore-compat",q7="firebase",K7="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q1="[DEFAULT]",Q7={[$1]:"fire-core",[E7]:"fire-core-compat",[C7]:"fire-analytics",[T7]:"fire-analytics-compat",[P7]:"fire-app-check",[I7]:"fire-app-check-compat",[R7]:"fire-auth",[A7]:"fire-auth-compat",[k7]:"fire-rtdb",[x7]:"fire-data-connect",[N7]:"fire-rtdb-compat",[D7]:"fire-fn",[M7]:"fire-fn-compat",[O7]:"fire-iid",[L7]:"fire-iid-compat",[b7]:"fire-fcm",[F7]:"fire-fcm-compat",[V7]:"fire-perf",[U7]:"fire-perf-compat",[z7]:"fire-rc",[B7]:"fire-rc-compat",[G7]:"fire-gcs",[j7]:"fire-gcs-compat",[W7]:"fire-fst",[$7]:"fire-fst-compat",[H7]:"fire-vertex","fire-js":"fire-js",[q7]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fg=new Map,Y7=new Map,K1=new Map;function tT(n,e){try{n.container.addComponent(e)}catch(t){Gs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Ka(n){const e=n.name;if(K1.has(e))return Gs.debug(`There were multiple attempts to register component ${e}.`),!1;K1.set(e,n);for(const t of Fg.values())tT(t,n);for(const t of Y7.values())tT(t,n);return!0}function xm(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Si(n){return n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X7={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Vo=new Od("app","Firebase",X7);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J7{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ho("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Vo.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const al=K7;function p6(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:q1,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Vo.create("bad-app-name",{appName:String(i)});if(t||(t=a6()),!t)throw Vo.create("no-options");const s=Fg.get(i);if(s){if(bg(t,s.options)&&bg(r,s.config))return s;throw Vo.create("duplicate-app",{appName:i})}const o=new i7(i);for(const c of K1.values())o.addComponent(c);const u=new J7(t,r,o);return Fg.set(i,u),u}function L2(n=q1){const e=Fg.get(n);if(!e&&n===q1&&a6())return p6();if(!e)throw Vo.create("no-app",{appName:n});return e}function Zi(n,e,t){var r;let i=(r=Q7[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const u=[`Unable to register library "${i}" with version "${e}":`];s&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&u.push("and"),o&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Gs.warn(u.join(" "));return}Ka(new Ho(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z7="firebase-heartbeat-database",eN=1,ad="firebase-heartbeat-store";let Ty=null;function g6(){return Ty||(Ty=_7(Z7,eN,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ad)}catch(t){console.warn(t)}}}}).catch(n=>{throw Vo.create("idb-open",{originalErrorMessage:n.message})})),Ty}async function tN(n){try{const t=(await g6()).transaction(ad),r=await t.objectStore(ad).get(m6(n));return await t.done,r}catch(e){if(e instanceof Ks)Gs.warn(e.message);else{const t=Vo.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Gs.warn(t.message)}}}async function nT(n,e){try{const r=(await g6()).transaction(ad,"readwrite");await r.objectStore(ad).put(e,m6(n)),await r.done}catch(t){if(t instanceof Ks)Gs.warn(t.message);else{const r=Vo.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Gs.warn(r.message)}}}function m6(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nN=1024,rN=30*24*60*60*1e3;class iN{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new oN(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=rT();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const u=new Date(o.date).valueOf();return Date.now()-u<=rN}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Gs.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=rT(),{heartbeatsToSend:r,unsentEntries:i}=sN(this._heartbeatsCache.heartbeats),s=Mg(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return Gs.warn(t),""}}}function rT(){return new Date().toISOString().substring(0,10)}function sN(n,e=nN){const t=[];let r=n.slice();for(const i of n){const s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),iT(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),iT(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class oN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Gx()?jx().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await tN(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return nT(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return nT(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function iT(n){return Mg(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aN(n){Ka(new Ho("platform-logger",e=>new w7(e),"PRIVATE")),Ka(new Ho("heartbeat",e=>new iN(e),"PRIVATE")),Zi($1,eT,n),Zi($1,eT,"esm2017"),Zi("fire-js","")}aN("");function b2(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function _6(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const lN=_6,y6=new Od("auth","Firebase",_6());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vg=new km("@firebase/auth");function uN(n,...e){Vg.logLevel<=ze.WARN&&Vg.warn(`Auth (${al}): ${n}`,...e)}function Xp(n,...e){Vg.logLevel<=ze.ERROR&&Vg.error(`Auth (${al}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ri(n,...e){throw V2(n,...e)}function Ii(n,...e){return V2(n,...e)}function F2(n,e,t){const r=Object.assign(Object.assign({},lN()),{[e]:t});return new Od("auth","Firebase",r).create(e,{appName:n.name})}function Os(n){return F2(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function cN(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&ri(n,"argument-error"),F2(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function V2(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return y6.create(n,...e)}function Pe(n,e,...t){if(!n)throw V2(e,...t)}function ks(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Xp(e),new Error(e)}function js(n,e){n||ks(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q1(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function hN(){return sT()==="http:"||sT()==="https:"}function sT(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(hN()||Vx()||"connection"in navigator)?navigator.onLine:!0}function fN(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ld{constructor(e,t){this.shortDelay=e,this.longDelay=t,js(t>e,"Short delay should be less than long delay!"),this.isMobile=M2()||c6()}get(){return dN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U2(n,e){js(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v6{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ks("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ks("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ks("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gN=new Ld(3e4,6e4);function ea(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function ta(n,e,t,r,i={}){return w6(n,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const u=Xu(Object.assign({key:n.config.apiKey},o)).slice(1),c=await n._getAdditionalHeaders();c["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode);const d=Object.assign({method:e,headers:c},s);return Fx()||(d.referrerPolicy="no-referrer"),v6.fetch()(S6(n,n.config.apiHost,t,u),d)})}async function w6(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},pN),e);try{const i=new _N(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Pp(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const u=s.ok?o.errorMessage:o.error.message,[c,d]=u.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Pp(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Pp(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw Pp(n,"user-disabled",o);const p=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw F2(n,p,d);ri(n,p)}}catch(i){if(i instanceof Ks)throw i;ri(n,"network-request-failed",{message:String(i)})}}async function bd(n,e,t,r,i={}){const s=await ta(n,e,t,r,i);return"mfaPendingCredential"in s&&ri(n,"multi-factor-auth-required",{_serverResponse:s}),s}function S6(n,e,t,r){const i=`${e}${t}?${r}`;return n.config.emulator?U2(n.config,i):`${n.config.apiScheme}://${i}`}function mN(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class _N{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Ii(this.auth,"network-request-failed")),gN.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Pp(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=Ii(n,e,r);return i.customData._tokenResponse=t,i}function oT(n){return n!==void 0&&n.enterprise!==void 0}class yN{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return mN(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function vN(n,e){return ta(n,"GET","/v2/recaptchaConfig",ea(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wN(n,e){return ta(n,"POST","/v1/accounts:delete",e)}async function E6(n,e){return ta(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mh(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function SN(n,e=!1){const t=Lt(n),r=await t.getIdToken(e),i=z2(r);Pe(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Mh(Cy(i.auth_time)),issuedAtTime:Mh(Cy(i.iat)),expirationTime:Mh(Cy(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Cy(n){return Number(n)*1e3}function z2(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Xp("JWT malformed, contained fewer than 3 sections"),null;try{const i=Og(t);return i?JSON.parse(i):(Xp("Failed to decode base64 JWT payload"),null)}catch(i){return Xp("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function aT(n){const e=z2(n);return Pe(e,"internal-error"),Pe(typeof e.exp<"u","internal-error"),Pe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ld(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Ks&&EN(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function EN({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TN{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y1{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Mh(this.lastLoginAt),this.creationTime=Mh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ug(n){var e;const t=n.auth,r=await n.getIdToken(),i=await ld(n,E6(t,{idToken:r}));Pe(i==null?void 0:i.users.length,t,"internal-error");const s=i.users[0];n._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?T6(s.providerUserInfo):[],u=IN(n.providerData,o),c=n.isAnonymous,d=!(n.email&&s.passwordHash)&&!(u!=null&&u.length),p=c?d:!1,m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:u,metadata:new Y1(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,m)}async function CN(n){const e=Lt(n);await Ug(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function IN(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function T6(n){return n.map(e=>{var{providerId:t}=e,r=b2(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PN(n,e){const t=await w6(n,{},async()=>{const r=Xu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=S6(n,i,"/v1/token",`key=${s}`),u=await n._getAdditionalHeaders();return u["Content-Type"]="application/x-www-form-urlencoded",v6.fetch()(o,{method:"POST",headers:u,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function RN(n,e){return ta(n,"POST","/v2/accounts:revokeToken",ea(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Pe(e.idToken,"internal-error"),Pe(typeof e.idToken<"u","internal-error"),Pe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):aT(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Pe(e.length!==0,"internal-error");const t=aT(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Pe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await PN(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new wu;return r&&(Pe(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(Pe(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(Pe(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new wu,this.toJSON())}_performRefresh(){return ks("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mo(n,e){Pe(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class xs{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=b2(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new TN(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Y1(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await ld(this,this.stsTokenManager.getToken(this.auth,e));return Pe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return SN(this,e)}reload(){return CN(this)}_assign(e){this!==e&&(Pe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new xs(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Pe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Ug(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Si(this.auth.app))return Promise.reject(Os(this.auth));const e=await this.getIdToken();return await ld(this,wN(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,u,c,d,p;const m=(r=t.displayName)!==null&&r!==void 0?r:void 0,y=(i=t.email)!==null&&i!==void 0?i:void 0,E=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,S=(o=t.photoURL)!==null&&o!==void 0?o:void 0,x=(u=t.tenantId)!==null&&u!==void 0?u:void 0,D=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,k=(d=t.createdAt)!==null&&d!==void 0?d:void 0,R=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:w,emailVerified:P,isAnonymous:V,providerData:z,stsTokenManager:M}=t;Pe(w&&M,e,"internal-error");const C=wu.fromJSON(this.name,M);Pe(typeof w=="string",e,"internal-error"),mo(m,e.name),mo(y,e.name),Pe(typeof P=="boolean",e,"internal-error"),Pe(typeof V=="boolean",e,"internal-error"),mo(E,e.name),mo(S,e.name),mo(x,e.name),mo(D,e.name),mo(k,e.name),mo(R,e.name);const N=new xs({uid:w,auth:e,email:y,emailVerified:P,displayName:m,isAnonymous:V,photoURL:S,phoneNumber:E,tenantId:x,stsTokenManager:C,createdAt:k,lastLoginAt:R});return z&&Array.isArray(z)&&(N.providerData=z.map(A=>Object.assign({},A))),D&&(N._redirectEventId=D),N}static async _fromIdTokenResponse(e,t,r=!1){const i=new wu;i.updateFromServerResponse(t);const s=new xs({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Ug(s),s}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];Pe(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?T6(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),u=new wu;u.updateFromIdToken(r);const c=new xs({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:o}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Y1(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(c,d),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lT=new Map;function Ns(n){js(n instanceof Function,"Expected a class definition");let e=lT.get(n);return e?(js(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,lT.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C6{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}C6.type="NONE";const uT=C6;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jp(n,e,t){return`firebase:${n}:${e}:${t}`}class Su{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Jp(this.userKey,i.apiKey,s),this.fullPersistenceKey=Jp("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?xs._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Su(Ns(uT),e,r);const i=(await Promise.all(t.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let s=i[0]||Ns(uT);const o=Jp(r,e.config.apiKey,e.name);let u=null;for(const d of t)try{const p=await d._get(o);if(p){const m=xs._fromJSON(e,p);d!==s&&(u=m),s=d;break}}catch{}const c=i.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new Su(s,e,r):(s=c[0],u&&await s._set(o,u.toJSON()),await Promise.all(t.map(async d=>{if(d!==s)try{await d._remove(o)}catch{}})),new Su(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cT(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(A6(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(I6(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(x6(e))return"Blackberry";if(N6(e))return"Webos";if(P6(e))return"Safari";if((e.includes("chrome/")||R6(e))&&!e.includes("edge/"))return"Chrome";if(k6(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function I6(n=nr()){return/firefox\//i.test(n)}function P6(n=nr()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function R6(n=nr()){return/crios\//i.test(n)}function A6(n=nr()){return/iemobile/i.test(n)}function k6(n=nr()){return/android/i.test(n)}function x6(n=nr()){return/blackberry/i.test(n)}function N6(n=nr()){return/webos/i.test(n)}function B2(n=nr()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function AN(n=nr()){var e;return B2(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function kN(){return Ux()&&document.documentMode===10}function D6(n=nr()){return B2(n)||k6(n)||N6(n)||x6(n)||/windows phone/i.test(n)||A6(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M6(n,e=[]){let t;switch(n){case"Browser":t=cT(nr());break;case"Worker":t=`${cT(nr())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${al}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((o,u)=>{try{const c=e(s);o(c)}catch(c){u(c)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NN(n,e={}){return ta(n,"GET","/v2/passwordPolicy",ea(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DN=6;class MN{constructor(e){var t,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:DN,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,u;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(u=c.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),c}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ON{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new hT(this),this.idTokenSubscription=new hT(this),this.beforeStateQueue=new xN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=y6,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ns(t)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await Su.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await E6(this,{idToken:e}),r=await xs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Si(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(u,u))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,u=i==null?void 0:i._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===u)&&(c!=null&&c.user)&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Pe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Ug(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=fN()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Si(this.app))return Promise.reject(Os(this));const t=e?Lt(e):null;return t&&Pe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Pe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Si(this.app)?Promise.reject(Os(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Si(this.app)?Promise.reject(Os(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ns(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await NN(this),t=new MN(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Od("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await RN(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ns(e)||this._popupRedirectResolver;Pe(t,this,"argument-error"),this.redirectPersistenceManager=await Su.create(this,[Ns(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(Pe(u,this,"internal-error"),u.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const c=e.addObserver(t,r,i);return()=>{o=!0,c()}}else{const c=e.addObserver(t);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Pe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=M6(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&uN(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function na(n){return Lt(n)}class hT{constructor(e){this.auth=e,this.observer=null,this.addObserver=Yx(t=>this.observer=t)}get next(){return Pe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nm={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function LN(n){Nm=n}function O6(n){return Nm.loadJS(n)}function bN(){return Nm.recaptchaEnterpriseScript}function FN(){return Nm.gapiScript}function VN(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const UN="recaptcha-enterprise",zN="NO_RECAPTCHA";class BN{constructor(e){this.type=UN,this.auth=na(e)}async verify(e="verify",t=!1){async function r(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,u)=>{vN(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{const d=new yN(c);return s.tenantId==null?s._agentRecaptchaConfig=d:s._tenantRecaptchaConfigs[s.tenantId]=d,o(d.siteKey)}}).catch(c=>{u(c)})})}function i(s,o,u){const c=window.grecaptcha;oT(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(d=>{o(d)}).catch(()=>{o(zN)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(u=>{if(!t&&oT(window.grecaptcha))i(u,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=bN();c.length!==0&&(c+=u),O6(c).then(()=>{i(u,s,o)}).catch(d=>{o(d)})}}).catch(u=>{o(u)})})}}async function dT(n,e,t,r=!1){const i=new BN(n);let s;try{s=await i.verify(t)}catch{s=await i.verify(t,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function X1(n,e,t,r){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await dT(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await dT(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GN(n,e){const t=xm(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(bg(s,e??{}))return i;ri(i,"already-initialized")}return t.initialize({options:e})}function jN(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Ns);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function WN(n,e,t){const r=na(n);Pe(r._canInitEmulator,r,"emulator-config-failed"),Pe(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=L6(e),{host:o,port:u}=HN(e),c=u===null?"":`:${u}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:u,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),$N()}function L6(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function HN(n){const e=L6(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:fT(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:fT(o)}}}function fT(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function $N(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G2{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ks("not implemented")}_getIdTokenResponse(e){return ks("not implemented")}_linkToIdToken(e,t){return ks("not implemented")}_getReauthenticationResolver(e){return ks("not implemented")}}async function qN(n,e){return ta(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KN(n,e){return bd(n,"POST","/v1/accounts:signInWithPassword",ea(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QN(n,e){return bd(n,"POST","/v1/accounts:signInWithEmailLink",ea(n,e))}async function YN(n,e){return bd(n,"POST","/v1/accounts:signInWithEmailLink",ea(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ud extends G2{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new ud(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new ud(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return X1(e,t,"signInWithPassword",KN);case"emailLink":return QN(e,{email:this._email,oobCode:this._password});default:ri(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return X1(e,r,"signUpPassword",qN);case"emailLink":return YN(e,{idToken:t,email:this._email,oobCode:this._password});default:ri(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Eu(n,e){return bd(n,"POST","/v1/accounts:signInWithIdp",ea(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XN="http://localhost";class Qa extends G2{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Qa(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ri("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=b2(t,["providerId","signInMethod"]);if(!r||!i)return null;const o=new Qa(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Eu(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Eu(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Eu(e,t)}buildRequest(){const e={requestUri:XN,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Xu(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JN(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function ZN(n){const e=_h(yh(n)).link,t=e?_h(yh(e)).deep_link_id:null,r=_h(yh(n)).deep_link_id;return(r?_h(yh(r)).link:null)||r||t||e||n}class j2{constructor(e){var t,r,i,s,o,u;const c=_h(yh(e)),d=(t=c.apiKey)!==null&&t!==void 0?t:null,p=(r=c.oobCode)!==null&&r!==void 0?r:null,m=JN((i=c.mode)!==null&&i!==void 0?i:null);Pe(d&&p&&m,"argument-error"),this.apiKey=d,this.operation=m,this.code=p,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(u=c.tenantId)!==null&&u!==void 0?u:null}static parseLink(e){const t=ZN(e);try{return new j2(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju{constructor(){this.providerId=Ju.PROVIDER_ID}static credential(e,t){return ud._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=j2.parseLink(t);return Pe(r,"argument-error"),ud._fromEmailAndCode(e,r.code,r.tenantId)}}Ju.PROVIDER_ID="password";Ju.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ju.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W2{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fd extends W2{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To extends Fd{constructor(){super("facebook.com")}static credential(e){return Qa._fromParams({providerId:To.PROVIDER_ID,signInMethod:To.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return To.credentialFromTaggedObject(e)}static credentialFromError(e){return To.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return To.credential(e.oauthAccessToken)}catch{return null}}}To.FACEBOOK_SIGN_IN_METHOD="facebook.com";To.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps extends Fd{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Qa._fromParams({providerId:Ps.PROVIDER_ID,signInMethod:Ps.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ps.credentialFromTaggedObject(e)}static credentialFromError(e){return Ps.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Ps.credential(t,r)}catch{return null}}}Ps.GOOGLE_SIGN_IN_METHOD="google.com";Ps.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co extends Fd{constructor(){super("github.com")}static credential(e){return Qa._fromParams({providerId:Co.PROVIDER_ID,signInMethod:Co.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Co.credentialFromTaggedObject(e)}static credentialFromError(e){return Co.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Co.credential(e.oauthAccessToken)}catch{return null}}}Co.GITHUB_SIGN_IN_METHOD="github.com";Co.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io extends Fd{constructor(){super("twitter.com")}static credential(e,t){return Qa._fromParams({providerId:Io.PROVIDER_ID,signInMethod:Io.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Io.credentialFromTaggedObject(e)}static credentialFromError(e){return Io.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Io.credential(t,r)}catch{return null}}}Io.TWITTER_SIGN_IN_METHOD="twitter.com";Io.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eD(n,e){return bd(n,"POST","/v1/accounts:signUp",ea(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ya{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await xs._fromIdTokenResponse(e,r,i),o=pT(r);return new Ya({user:s,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=pT(r);return new Ya({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function pT(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zg extends Ks{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,zg.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new zg(e,t,r,i)}}function b6(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?zg._fromErrorAndOperation(n,s,e,r):s})}async function tD(n,e,t=!1){const r=await ld(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Ya._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nD(n,e,t=!1){const{auth:r}=n;if(Si(r.app))return Promise.reject(Os(r));const i="reauthenticate";try{const s=await ld(n,b6(r,i,e,n),t);Pe(s.idToken,r,"internal-error");const o=z2(s.idToken);Pe(o,r,"internal-error");const{sub:u}=o;return Pe(n.uid===u,r,"user-mismatch"),Ya._forOperation(n,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&ri(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F6(n,e,t=!1){if(Si(n.app))return Promise.reject(Os(n));const r="signIn",i=await b6(n,r,e),s=await Ya._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}async function rD(n,e){return F6(na(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function V6(n){const e=na(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function iD(n,e,t){if(Si(n.app))return Promise.reject(Os(n));const r=na(n),o=await X1(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",eD).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&V6(n),c}),u=await Ya._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(u.user),u}function sD(n,e,t){return Si(n.app)?Promise.reject(Os(n)):rD(Lt(n),Ju.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&V6(n),r})}function oD(n,e,t,r){return Lt(n).onIdTokenChanged(e,t,r)}function aD(n,e,t){return Lt(n).beforeAuthStateChanged(e,t)}function lD(n,e,t,r){return Lt(n).onAuthStateChanged(e,t,r)}function uD(n){return Lt(n).signOut()}const Bg="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U6{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Bg,"1"),this.storage.removeItem(Bg),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cD=1e3,hD=10;class z6 extends U6{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=D6(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,u,c)=>{this.notifyListeners(o,c)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);kN()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,hD):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},cD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}z6.type="LOCAL";const dD=z6;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B6 extends U6{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}B6.type="SESSION";const G6=B6;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fD(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new Dm(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const u=Array.from(o).map(async d=>d(t.origin,s)),c=await fD(u);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:c})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Dm.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H2(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pD{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((u,c)=>{const d=H2("",20);i.port1.start();const p=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(m){const y=m;if(y.data.eventId===d)switch(y.data.status){case"ack":clearTimeout(p),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),u(y.data.response);break;default:clearTimeout(p),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function es(){return window}function gD(n){es().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j6(){return typeof es().WorkerGlobalScope<"u"&&typeof es().importScripts=="function"}async function mD(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function _D(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function yD(){return j6()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W6="firebaseLocalStorageDb",vD=1,Gg="firebaseLocalStorage",H6="fbase_key";class Vd{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Mm(n,e){return n.transaction([Gg],e?"readwrite":"readonly").objectStore(Gg)}function wD(){const n=indexedDB.deleteDatabase(W6);return new Vd(n).toPromise()}function J1(){const n=indexedDB.open(W6,vD);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Gg,{keyPath:H6})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Gg)?e(r):(r.close(),await wD(),e(await J1()))})})}async function gT(n,e,t){const r=Mm(n,!0).put({[H6]:e,value:t});return new Vd(r).toPromise()}async function SD(n,e){const t=Mm(n,!1).get(e),r=await new Vd(t).toPromise();return r===void 0?null:r.value}function mT(n,e){const t=Mm(n,!0).delete(e);return new Vd(t).toPromise()}const ED=800,TD=3;class $6{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await J1(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>TD)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return j6()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Dm._getInstance(yD()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await mD(),!this.activeServiceWorker)return;this.sender=new pD(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||_D()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await J1();return await gT(e,Bg,"1"),await mT(e,Bg),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>gT(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>SD(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>mT(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Mm(i,!1).getAll();return new Vd(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),ED)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}$6.type="LOCAL";const CD=$6;new Ld(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q6(n,e){return e?Ns(e):(Pe(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $2 extends G2{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Eu(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Eu(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Eu(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function ID(n){return F6(n.auth,new $2(n),n.bypassAuthState)}function PD(n){const{auth:e,user:t}=n;return Pe(t,e,"internal-error"),nD(t,new $2(n),n.bypassAuthState)}async function RD(n){const{auth:e,user:t}=n;return Pe(t,e,"internal-error"),tD(t,new $2(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K6{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:u}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(c))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ID;case"linkViaPopup":case"linkViaRedirect":return RD;case"reauthViaPopup":case"reauthViaRedirect":return PD;default:ri(this.auth,"internal-error")}}resolve(e){js(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){js(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AD=new Ld(2e3,1e4);async function kD(n,e,t){if(Si(n.app))return Promise.reject(Ii(n,"operation-not-supported-in-this-environment"));const r=na(n);cN(n,e,W2);const i=q6(r,t);return new Fa(r,"signInViaPopup",e,i).executeNotNull()}class Fa extends K6{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Fa.currentPopupAction&&Fa.currentPopupAction.cancel(),Fa.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Pe(e,this.auth,"internal-error"),e}async onExecution(){js(this.filter.length===1,"Popup operations only handle one event");const e=H2();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ii(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Ii(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Fa.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ii(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,AD.get())};e()}}Fa.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xD="pendingRedirect",Zp=new Map;class ND extends K6{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Zp.get(this.auth._key());if(!e){try{const r=await DD(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Zp.set(this.auth._key(),e)}return this.bypassAuthState||Zp.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function DD(n,e){const t=LD(e),r=OD(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function MD(n,e){Zp.set(n._key(),e)}function OD(n){return Ns(n._redirectPersistence)}function LD(n){return Jp(xD,n.config.apiKey,n.name)}async function bD(n,e,t=!1){if(Si(n.app))return Promise.reject(Os(n));const r=na(n),i=q6(r,e),o=await new ND(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FD=10*60*1e3;class VD{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!UD(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!Q6(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Ii(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=FD&&this.cachedEventUids.clear(),this.cachedEventUids.has(_T(e))}saveEventToCache(e){this.cachedEventUids.add(_T(e)),this.lastProcessedEventTime=Date.now()}}function _T(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Q6({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function UD(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Q6(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zD(n,e={}){return ta(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BD=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,GD=/^https?/;async function jD(n){if(n.config.emulator)return;const{authorizedDomains:e}=await zD(n);for(const t of e)try{if(WD(t))return}catch{}ri(n,"unauthorized-domain")}function WD(n){const e=Q1(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!GD.test(t))return!1;if(BD.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HD=new Ld(3e4,6e4);function yT(){const n=es().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function $D(n){return new Promise((e,t)=>{var r,i,s;function o(){yT(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{yT(),t(Ii(n,"network-request-failed"))},timeout:HD.get()})}if(!((i=(r=es().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=es().gapi)===null||s===void 0)&&s.load)o();else{const u=VN("iframefcb");return es()[u]=()=>{gapi.load?o():t(Ii(n,"network-request-failed"))},O6(`${FN()}?onload=${u}`).catch(c=>t(c))}}).catch(e=>{throw eg=null,e})}let eg=null;function qD(n){return eg=eg||$D(n),eg}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KD=new Ld(5e3,15e3),QD="__/auth/iframe",YD="emulator/auth/iframe",XD={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},JD=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ZD(n){const e=n.config;Pe(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?U2(e,YD):`https://${n.config.authDomain}/${QD}`,r={apiKey:e.apiKey,appName:n.name,v:al},i=JD.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${Xu(r).slice(1)}`}async function eM(n){const e=await qD(n),t=es().gapi;return Pe(t,n,"internal-error"),e.open({where:document.body,url:ZD(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:XD,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=Ii(n,"network-request-failed"),u=es().setTimeout(()=>{s(o)},KD.get());function c(){es().clearTimeout(u),i(r)}r.ping(c).then(c,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tM={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},nM=500,rM=600,iM="_blank",sM="http://localhost";class vT{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function oM(n,e,t,r=nM,i=rM){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let u="";const c=Object.assign(Object.assign({},tM),{width:r.toString(),height:i.toString(),top:s,left:o}),d=nr().toLowerCase();t&&(u=R6(d)?iM:t),I6(d)&&(e=e||sM,c.scrollbars="yes");const p=Object.entries(c).reduce((y,[E,S])=>`${y}${E}=${S},`,"");if(AN(d)&&u!=="_self")return aM(e||"",u),new vT(null);const m=window.open(e||"",u,p);Pe(m,n,"popup-blocked");try{m.focus()}catch{}return new vT(m)}function aM(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lM="__/auth/handler",uM="emulator/auth/handler",cM=encodeURIComponent("fac");async function wT(n,e,t,r,i,s){Pe(n.config.authDomain,n,"auth-domain-config-required"),Pe(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:al,eventId:i};if(e instanceof W2){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",j1(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,m]of Object.entries({}))o[p]=m}if(e instanceof Fd){const p=e.getScopes().filter(m=>m!=="");p.length>0&&(o.scopes=p.join(","))}n.tenantId&&(o.tid=n.tenantId);const u=o;for(const p of Object.keys(u))u[p]===void 0&&delete u[p];const c=await n._getAppCheckToken(),d=c?`#${cM}=${encodeURIComponent(c)}`:"";return`${hM(n)}?${Xu(u).slice(1)}${d}`}function hM({config:n}){return n.emulator?U2(n,uM):`https://${n.authDomain}/${lM}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iy="webStorageSupport";class dM{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=G6,this._completeRedirectFn=bD,this._overrideRedirectResult=MD}async _openPopup(e,t,r,i){var s;js((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await wT(e,t,r,Q1(),i);return oM(e,o,H2())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await wT(e,t,r,Q1(),i);return gD(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(js(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await eM(e),r=new VD(e);return t.register("authEvent",i=>(Pe(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Iy,{type:Iy},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Iy];o!==void 0&&t(!!o),ri(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=jD(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return D6()||P6()||B2()}}const fM=dM;var ST="@firebase/auth",ET="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pM{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Pe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gM(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function mM(n){Ka(new Ho("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:u}=r.options;Pe(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:M6(n)},d=new ON(r,i,s,c);return jN(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Ka(new Ho("auth-internal",e=>{const t=na(e.getProvider("auth").getImmediate());return(r=>new pM(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Zi(ST,ET,gM(n)),Zi(ST,ET,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _M=5*60,yM=l6("authIdTokenMaxAge")||_M;let TT=null;const vM=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>yM)return;const i=t==null?void 0:t.token;TT!==i&&(TT=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function wM(n=L2()){const e=xm(n,"auth");if(e.isInitialized())return e.getImmediate();const t=GN(n,{popupRedirectResolver:fM,persistence:[CD,dD,G6]}),r=l6("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=vM(s.toString());aD(t,o,()=>o(t.currentUser)),oD(t,u=>o(u))}}const i=s6("auth");return i&&WN(t,`http://${i}`),t}function SM(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}LN({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=Ii("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",SM().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});mM("Browser");var EM="firebase",TM="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Zi(EM,TM,"app");var CT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ga,Y6;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(M,C){function N(){}N.prototype=C.prototype,M.D=C.prototype,M.prototype=new N,M.prototype.constructor=M,M.C=function(A,L,U){for(var F=Array(arguments.length-2),pe=2;pe<arguments.length;pe++)F[pe-2]=arguments[pe];return C.prototype[L].apply(A,F)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(M,C,N){N||(N=0);var A=Array(16);if(typeof C=="string")for(var L=0;16>L;++L)A[L]=C.charCodeAt(N++)|C.charCodeAt(N++)<<8|C.charCodeAt(N++)<<16|C.charCodeAt(N++)<<24;else for(L=0;16>L;++L)A[L]=C[N++]|C[N++]<<8|C[N++]<<16|C[N++]<<24;C=M.g[0],N=M.g[1],L=M.g[2];var U=M.g[3],F=C+(U^N&(L^U))+A[0]+3614090360&4294967295;C=N+(F<<7&4294967295|F>>>25),F=U+(L^C&(N^L))+A[1]+3905402710&4294967295,U=C+(F<<12&4294967295|F>>>20),F=L+(N^U&(C^N))+A[2]+606105819&4294967295,L=U+(F<<17&4294967295|F>>>15),F=N+(C^L&(U^C))+A[3]+3250441966&4294967295,N=L+(F<<22&4294967295|F>>>10),F=C+(U^N&(L^U))+A[4]+4118548399&4294967295,C=N+(F<<7&4294967295|F>>>25),F=U+(L^C&(N^L))+A[5]+1200080426&4294967295,U=C+(F<<12&4294967295|F>>>20),F=L+(N^U&(C^N))+A[6]+2821735955&4294967295,L=U+(F<<17&4294967295|F>>>15),F=N+(C^L&(U^C))+A[7]+4249261313&4294967295,N=L+(F<<22&4294967295|F>>>10),F=C+(U^N&(L^U))+A[8]+1770035416&4294967295,C=N+(F<<7&4294967295|F>>>25),F=U+(L^C&(N^L))+A[9]+2336552879&4294967295,U=C+(F<<12&4294967295|F>>>20),F=L+(N^U&(C^N))+A[10]+4294925233&4294967295,L=U+(F<<17&4294967295|F>>>15),F=N+(C^L&(U^C))+A[11]+2304563134&4294967295,N=L+(F<<22&4294967295|F>>>10),F=C+(U^N&(L^U))+A[12]+1804603682&4294967295,C=N+(F<<7&4294967295|F>>>25),F=U+(L^C&(N^L))+A[13]+4254626195&4294967295,U=C+(F<<12&4294967295|F>>>20),F=L+(N^U&(C^N))+A[14]+2792965006&4294967295,L=U+(F<<17&4294967295|F>>>15),F=N+(C^L&(U^C))+A[15]+1236535329&4294967295,N=L+(F<<22&4294967295|F>>>10),F=C+(L^U&(N^L))+A[1]+4129170786&4294967295,C=N+(F<<5&4294967295|F>>>27),F=U+(N^L&(C^N))+A[6]+3225465664&4294967295,U=C+(F<<9&4294967295|F>>>23),F=L+(C^N&(U^C))+A[11]+643717713&4294967295,L=U+(F<<14&4294967295|F>>>18),F=N+(U^C&(L^U))+A[0]+3921069994&4294967295,N=L+(F<<20&4294967295|F>>>12),F=C+(L^U&(N^L))+A[5]+3593408605&4294967295,C=N+(F<<5&4294967295|F>>>27),F=U+(N^L&(C^N))+A[10]+38016083&4294967295,U=C+(F<<9&4294967295|F>>>23),F=L+(C^N&(U^C))+A[15]+3634488961&4294967295,L=U+(F<<14&4294967295|F>>>18),F=N+(U^C&(L^U))+A[4]+3889429448&4294967295,N=L+(F<<20&4294967295|F>>>12),F=C+(L^U&(N^L))+A[9]+568446438&4294967295,C=N+(F<<5&4294967295|F>>>27),F=U+(N^L&(C^N))+A[14]+3275163606&4294967295,U=C+(F<<9&4294967295|F>>>23),F=L+(C^N&(U^C))+A[3]+4107603335&4294967295,L=U+(F<<14&4294967295|F>>>18),F=N+(U^C&(L^U))+A[8]+1163531501&4294967295,N=L+(F<<20&4294967295|F>>>12),F=C+(L^U&(N^L))+A[13]+2850285829&4294967295,C=N+(F<<5&4294967295|F>>>27),F=U+(N^L&(C^N))+A[2]+4243563512&4294967295,U=C+(F<<9&4294967295|F>>>23),F=L+(C^N&(U^C))+A[7]+1735328473&4294967295,L=U+(F<<14&4294967295|F>>>18),F=N+(U^C&(L^U))+A[12]+2368359562&4294967295,N=L+(F<<20&4294967295|F>>>12),F=C+(N^L^U)+A[5]+4294588738&4294967295,C=N+(F<<4&4294967295|F>>>28),F=U+(C^N^L)+A[8]+2272392833&4294967295,U=C+(F<<11&4294967295|F>>>21),F=L+(U^C^N)+A[11]+1839030562&4294967295,L=U+(F<<16&4294967295|F>>>16),F=N+(L^U^C)+A[14]+4259657740&4294967295,N=L+(F<<23&4294967295|F>>>9),F=C+(N^L^U)+A[1]+2763975236&4294967295,C=N+(F<<4&4294967295|F>>>28),F=U+(C^N^L)+A[4]+1272893353&4294967295,U=C+(F<<11&4294967295|F>>>21),F=L+(U^C^N)+A[7]+4139469664&4294967295,L=U+(F<<16&4294967295|F>>>16),F=N+(L^U^C)+A[10]+3200236656&4294967295,N=L+(F<<23&4294967295|F>>>9),F=C+(N^L^U)+A[13]+681279174&4294967295,C=N+(F<<4&4294967295|F>>>28),F=U+(C^N^L)+A[0]+3936430074&4294967295,U=C+(F<<11&4294967295|F>>>21),F=L+(U^C^N)+A[3]+3572445317&4294967295,L=U+(F<<16&4294967295|F>>>16),F=N+(L^U^C)+A[6]+76029189&4294967295,N=L+(F<<23&4294967295|F>>>9),F=C+(N^L^U)+A[9]+3654602809&4294967295,C=N+(F<<4&4294967295|F>>>28),F=U+(C^N^L)+A[12]+3873151461&4294967295,U=C+(F<<11&4294967295|F>>>21),F=L+(U^C^N)+A[15]+530742520&4294967295,L=U+(F<<16&4294967295|F>>>16),F=N+(L^U^C)+A[2]+3299628645&4294967295,N=L+(F<<23&4294967295|F>>>9),F=C+(L^(N|~U))+A[0]+4096336452&4294967295,C=N+(F<<6&4294967295|F>>>26),F=U+(N^(C|~L))+A[7]+1126891415&4294967295,U=C+(F<<10&4294967295|F>>>22),F=L+(C^(U|~N))+A[14]+2878612391&4294967295,L=U+(F<<15&4294967295|F>>>17),F=N+(U^(L|~C))+A[5]+4237533241&4294967295,N=L+(F<<21&4294967295|F>>>11),F=C+(L^(N|~U))+A[12]+1700485571&4294967295,C=N+(F<<6&4294967295|F>>>26),F=U+(N^(C|~L))+A[3]+2399980690&4294967295,U=C+(F<<10&4294967295|F>>>22),F=L+(C^(U|~N))+A[10]+4293915773&4294967295,L=U+(F<<15&4294967295|F>>>17),F=N+(U^(L|~C))+A[1]+2240044497&4294967295,N=L+(F<<21&4294967295|F>>>11),F=C+(L^(N|~U))+A[8]+1873313359&4294967295,C=N+(F<<6&4294967295|F>>>26),F=U+(N^(C|~L))+A[15]+4264355552&4294967295,U=C+(F<<10&4294967295|F>>>22),F=L+(C^(U|~N))+A[6]+2734768916&4294967295,L=U+(F<<15&4294967295|F>>>17),F=N+(U^(L|~C))+A[13]+1309151649&4294967295,N=L+(F<<21&4294967295|F>>>11),F=C+(L^(N|~U))+A[4]+4149444226&4294967295,C=N+(F<<6&4294967295|F>>>26),F=U+(N^(C|~L))+A[11]+3174756917&4294967295,U=C+(F<<10&4294967295|F>>>22),F=L+(C^(U|~N))+A[2]+718787259&4294967295,L=U+(F<<15&4294967295|F>>>17),F=N+(U^(L|~C))+A[9]+3951481745&4294967295,M.g[0]=M.g[0]+C&4294967295,M.g[1]=M.g[1]+(L+(F<<21&4294967295|F>>>11))&4294967295,M.g[2]=M.g[2]+L&4294967295,M.g[3]=M.g[3]+U&4294967295}r.prototype.u=function(M,C){C===void 0&&(C=M.length);for(var N=C-this.blockSize,A=this.B,L=this.h,U=0;U<C;){if(L==0)for(;U<=N;)i(this,M,U),U+=this.blockSize;if(typeof M=="string"){for(;U<C;)if(A[L++]=M.charCodeAt(U++),L==this.blockSize){i(this,A),L=0;break}}else for(;U<C;)if(A[L++]=M[U++],L==this.blockSize){i(this,A),L=0;break}}this.h=L,this.o+=C},r.prototype.v=function(){var M=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);M[0]=128;for(var C=1;C<M.length-8;++C)M[C]=0;var N=8*this.o;for(C=M.length-8;C<M.length;++C)M[C]=N&255,N/=256;for(this.u(M),M=Array(16),C=N=0;4>C;++C)for(var A=0;32>A;A+=8)M[N++]=this.g[C]>>>A&255;return M};function s(M,C){var N=u;return Object.prototype.hasOwnProperty.call(N,M)?N[M]:N[M]=C(M)}function o(M,C){this.h=C;for(var N=[],A=!0,L=M.length-1;0<=L;L--){var U=M[L]|0;A&&U==C||(N[L]=U,A=!1)}this.g=N}var u={};function c(M){return-128<=M&&128>M?s(M,function(C){return new o([C|0],0>C?-1:0)}):new o([M|0],0>M?-1:0)}function d(M){if(isNaN(M)||!isFinite(M))return m;if(0>M)return D(d(-M));for(var C=[],N=1,A=0;M>=N;A++)C[A]=M/N|0,N*=4294967296;return new o(C,0)}function p(M,C){if(M.length==0)throw Error("number format error: empty string");if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(M.charAt(0)=="-")return D(p(M.substring(1),C));if(0<=M.indexOf("-"))throw Error('number format error: interior "-" character');for(var N=d(Math.pow(C,8)),A=m,L=0;L<M.length;L+=8){var U=Math.min(8,M.length-L),F=parseInt(M.substring(L,L+U),C);8>U?(U=d(Math.pow(C,U)),A=A.j(U).add(d(F))):(A=A.j(N),A=A.add(d(F)))}return A}var m=c(0),y=c(1),E=c(16777216);n=o.prototype,n.m=function(){if(x(this))return-D(this).m();for(var M=0,C=1,N=0;N<this.g.length;N++){var A=this.i(N);M+=(0<=A?A:4294967296+A)*C,C*=4294967296}return M},n.toString=function(M){if(M=M||10,2>M||36<M)throw Error("radix out of range: "+M);if(S(this))return"0";if(x(this))return"-"+D(this).toString(M);for(var C=d(Math.pow(M,6)),N=this,A="";;){var L=P(N,C).g;N=k(N,L.j(C));var U=((0<N.g.length?N.g[0]:N.h)>>>0).toString(M);if(N=L,S(N))return U+A;for(;6>U.length;)U="0"+U;A=U+A}},n.i=function(M){return 0>M?0:M<this.g.length?this.g[M]:this.h};function S(M){if(M.h!=0)return!1;for(var C=0;C<M.g.length;C++)if(M.g[C]!=0)return!1;return!0}function x(M){return M.h==-1}n.l=function(M){return M=k(this,M),x(M)?-1:S(M)?0:1};function D(M){for(var C=M.g.length,N=[],A=0;A<C;A++)N[A]=~M.g[A];return new o(N,~M.h).add(y)}n.abs=function(){return x(this)?D(this):this},n.add=function(M){for(var C=Math.max(this.g.length,M.g.length),N=[],A=0,L=0;L<=C;L++){var U=A+(this.i(L)&65535)+(M.i(L)&65535),F=(U>>>16)+(this.i(L)>>>16)+(M.i(L)>>>16);A=F>>>16,U&=65535,F&=65535,N[L]=F<<16|U}return new o(N,N[N.length-1]&-2147483648?-1:0)};function k(M,C){return M.add(D(C))}n.j=function(M){if(S(this)||S(M))return m;if(x(this))return x(M)?D(this).j(D(M)):D(D(this).j(M));if(x(M))return D(this.j(D(M)));if(0>this.l(E)&&0>M.l(E))return d(this.m()*M.m());for(var C=this.g.length+M.g.length,N=[],A=0;A<2*C;A++)N[A]=0;for(A=0;A<this.g.length;A++)for(var L=0;L<M.g.length;L++){var U=this.i(A)>>>16,F=this.i(A)&65535,pe=M.i(L)>>>16,Y=M.i(L)&65535;N[2*A+2*L]+=F*Y,R(N,2*A+2*L),N[2*A+2*L+1]+=U*Y,R(N,2*A+2*L+1),N[2*A+2*L+1]+=F*pe,R(N,2*A+2*L+1),N[2*A+2*L+2]+=U*pe,R(N,2*A+2*L+2)}for(A=0;A<C;A++)N[A]=N[2*A+1]<<16|N[2*A];for(A=C;A<2*C;A++)N[A]=0;return new o(N,0)};function R(M,C){for(;(M[C]&65535)!=M[C];)M[C+1]+=M[C]>>>16,M[C]&=65535,C++}function w(M,C){this.g=M,this.h=C}function P(M,C){if(S(C))throw Error("division by zero");if(S(M))return new w(m,m);if(x(M))return C=P(D(M),C),new w(D(C.g),D(C.h));if(x(C))return C=P(M,D(C)),new w(D(C.g),C.h);if(30<M.g.length){if(x(M)||x(C))throw Error("slowDivide_ only works with positive integers.");for(var N=y,A=C;0>=A.l(M);)N=V(N),A=V(A);var L=z(N,1),U=z(A,1);for(A=z(A,2),N=z(N,2);!S(A);){var F=U.add(A);0>=F.l(M)&&(L=L.add(N),U=F),A=z(A,1),N=z(N,1)}return C=k(M,L.j(C)),new w(L,C)}for(L=m;0<=M.l(C);){for(N=Math.max(1,Math.floor(M.m()/C.m())),A=Math.ceil(Math.log(N)/Math.LN2),A=48>=A?1:Math.pow(2,A-48),U=d(N),F=U.j(C);x(F)||0<F.l(M);)N-=A,U=d(N),F=U.j(C);S(U)&&(U=y),L=L.add(U),M=k(M,F)}return new w(L,M)}n.A=function(M){return P(this,M).h},n.and=function(M){for(var C=Math.max(this.g.length,M.g.length),N=[],A=0;A<C;A++)N[A]=this.i(A)&M.i(A);return new o(N,this.h&M.h)},n.or=function(M){for(var C=Math.max(this.g.length,M.g.length),N=[],A=0;A<C;A++)N[A]=this.i(A)|M.i(A);return new o(N,this.h|M.h)},n.xor=function(M){for(var C=Math.max(this.g.length,M.g.length),N=[],A=0;A<C;A++)N[A]=this.i(A)^M.i(A);return new o(N,this.h^M.h)};function V(M){for(var C=M.g.length+1,N=[],A=0;A<C;A++)N[A]=M.i(A)<<1|M.i(A-1)>>>31;return new o(N,M.h)}function z(M,C){var N=C>>5;C%=32;for(var A=M.g.length-N,L=[],U=0;U<A;U++)L[U]=0<C?M.i(U+N)>>>C|M.i(U+N+1)<<32-C:M.i(U+N);return new o(L,M.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Y6=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=p,Ga=o}).apply(typeof CT<"u"?CT:typeof self<"u"?self:typeof window<"u"?window:{});var Rp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var X6,vh,J6,tg,Z1,Z6,e9,t9;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,v,I){return h==Array.prototype||h==Object.prototype||(h[v]=I.value),h};function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Rp=="object"&&Rp];for(var v=0;v<h.length;++v){var I=h[v];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var r=t(this);function i(h,v){if(v)e:{var I=r;h=h.split(".");for(var O=0;O<h.length-1;O++){var W=h[O];if(!(W in I))break e;I=I[W]}h=h[h.length-1],O=I[h],v=v(O),v!=O&&v!=null&&e(I,h,{configurable:!0,writable:!0,value:v})}}function s(h,v){h instanceof String&&(h+="");var I=0,O=!1,W={next:function(){if(!O&&I<h.length){var K=I++;return{value:v(K,h[K]),done:!1}}return O=!0,{done:!0,value:void 0}}};return W[Symbol.iterator]=function(){return W},W}i("Array.prototype.values",function(h){return h||function(){return s(this,function(v,I){return I})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},u=this||self;function c(h){var v=typeof h;return v=v!="object"?v:h?Array.isArray(h)?"array":v:"null",v=="array"||v=="object"&&typeof h.length=="number"}function d(h){var v=typeof h;return v=="object"&&h!=null||v=="function"}function p(h,v,I){return h.call.apply(h.bind,arguments)}function m(h,v,I){if(!h)throw Error();if(2<arguments.length){var O=Array.prototype.slice.call(arguments,2);return function(){var W=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(W,O),h.apply(v,W)}}return function(){return h.apply(v,arguments)}}function y(h,v,I){return y=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:m,y.apply(null,arguments)}function E(h,v){var I=Array.prototype.slice.call(arguments,1);return function(){var O=I.slice();return O.push.apply(O,arguments),h.apply(this,O)}}function S(h,v){function I(){}I.prototype=v.prototype,h.aa=v.prototype,h.prototype=new I,h.prototype.constructor=h,h.Qb=function(O,W,K){for(var oe=Array(arguments.length-2),qe=2;qe<arguments.length;qe++)oe[qe-2]=arguments[qe];return v.prototype[W].apply(O,oe)}}function x(h){const v=h.length;if(0<v){const I=Array(v);for(let O=0;O<v;O++)I[O]=h[O];return I}return[]}function D(h,v){for(let I=1;I<arguments.length;I++){const O=arguments[I];if(c(O)){const W=h.length||0,K=O.length||0;h.length=W+K;for(let oe=0;oe<K;oe++)h[W+oe]=O[oe]}else h.push(O)}}class k{constructor(v,I){this.i=v,this.j=I,this.h=0,this.g=null}get(){let v;return 0<this.h?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function R(h){return/^[\s\xa0]*$/.test(h)}function w(){var h=u.navigator;return h&&(h=h.userAgent)?h:""}function P(h){return P[" "](h),h}P[" "]=function(){};var V=w().indexOf("Gecko")!=-1&&!(w().toLowerCase().indexOf("webkit")!=-1&&w().indexOf("Edge")==-1)&&!(w().indexOf("Trident")!=-1||w().indexOf("MSIE")!=-1)&&w().indexOf("Edge")==-1;function z(h,v,I){for(const O in h)v.call(I,h[O],O,h)}function M(h,v){for(const I in h)v.call(void 0,h[I],I,h)}function C(h){const v={};for(const I in h)v[I]=h[I];return v}const N="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function A(h,v){let I,O;for(let W=1;W<arguments.length;W++){O=arguments[W];for(I in O)h[I]=O[I];for(let K=0;K<N.length;K++)I=N[K],Object.prototype.hasOwnProperty.call(O,I)&&(h[I]=O[I])}}function L(h){var v=1;h=h.split(":");const I=[];for(;0<v&&h.length;)I.push(h.shift()),v--;return h.length&&I.push(h.join(":")),I}function U(h){u.setTimeout(()=>{throw h},0)}function F(){var h=te;let v=null;return h.g&&(v=h.g,h.g=h.g.next,h.g||(h.h=null),v.next=null),v}class pe{constructor(){this.h=this.g=null}add(v,I){const O=Y.get();O.set(v,I),this.h?this.h.next=O:this.g=O,this.h=O}}var Y=new k(()=>new he,h=>h.reset());class he{constructor(){this.next=this.g=this.h=null}set(v,I){this.h=v,this.g=I,this.next=null}reset(){this.next=this.g=this.h=null}}let ue,H=!1,te=new pe,J=()=>{const h=u.Promise.resolve(void 0);ue=()=>{h.then(ee)}};var ee=()=>{for(var h;h=F();){try{h.h.call(h.g)}catch(I){U(I)}var v=Y;v.j(h),100>v.h&&(v.h++,h.next=v.g,v.g=h)}H=!1};function ae(){this.s=this.s,this.C=this.C}ae.prototype.s=!1,ae.prototype.ma=function(){this.s||(this.s=!0,this.N())},ae.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ee(h,v){this.type=h,this.g=this.target=v,this.defaultPrevented=!1}Ee.prototype.h=function(){this.defaultPrevented=!0};var ut=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var h=!1,v=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const I=()=>{};u.addEventListener("test",I,v),u.removeEventListener("test",I,v)}catch{}return h}();function ct(h,v){if(Ee.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var I=this.type=h.type,O=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=v,v=h.relatedTarget){if(V){e:{try{P(v.nodeName);var W=!0;break e}catch{}W=!1}W||(v=null)}}else I=="mouseover"?v=h.fromElement:I=="mouseout"&&(v=h.toElement);this.relatedTarget=v,O?(this.clientX=O.clientX!==void 0?O.clientX:O.pageX,this.clientY=O.clientY!==void 0?O.clientY:O.pageY,this.screenX=O.screenX||0,this.screenY=O.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:ht[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&ct.aa.h.call(this)}}S(ct,Ee);var ht={2:"touch",3:"pen",4:"mouse"};ct.prototype.h=function(){ct.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var B="closure_listenable_"+(1e6*Math.random()|0),re=0;function ve(h,v,I,O,W){this.listener=h,this.proxy=null,this.src=v,this.type=I,this.capture=!!O,this.ha=W,this.key=++re,this.da=this.fa=!1}function He(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Ae(h){this.src=h,this.g={},this.h=0}Ae.prototype.add=function(h,v,I,O,W){var K=h.toString();h=this.g[K],h||(h=this.g[K]=[],this.h++);var oe=at(h,v,O,W);return-1<oe?(v=h[oe],I||(v.fa=!1)):(v=new ve(v,this.src,K,!!O,W),v.fa=I,h.push(v)),v};function it(h,v){var I=v.type;if(I in h.g){var O=h.g[I],W=Array.prototype.indexOf.call(O,v,void 0),K;(K=0<=W)&&Array.prototype.splice.call(O,W,1),K&&(He(v),h.g[I].length==0&&(delete h.g[I],h.h--))}}function at(h,v,I,O){for(var W=0;W<h.length;++W){var K=h[W];if(!K.da&&K.listener==v&&K.capture==!!I&&K.ha==O)return W}return-1}var gr="closure_lm_"+(1e6*Math.random()|0),nt={};function si(h,v,I,O,W){if(Array.isArray(v)){for(var K=0;K<v.length;K++)si(h,v[K],I,O,W);return null}return I=lf(I),h&&h[B]?h.K(v,I,d(O)?!!O.capture:!1,W):xr(h,v,I,!1,O,W)}function xr(h,v,I,O,W,K){if(!v)throw Error("Invalid event type");var oe=d(W)?!!W.capture:!!W,qe=fc(h);if(qe||(h[gr]=qe=new Ae(h)),I=qe.add(v,I,O,oe,K),I.proxy)return I;if(O=Ni(),I.proxy=O,O.src=h,O.listener=I,h.addEventListener)ut||(W=oe),W===void 0&&(W=!1),h.addEventListener(v.toString(),O,W);else if(h.attachEvent)h.attachEvent(af(v.toString()),O);else if(h.addListener&&h.removeListener)h.addListener(O);else throw Error("addEventListener and attachEvent are unavailable.");return I}function Ni(){function h(I){return v.call(h.src,h.listener,I)}const v=$0;return h}function of(h,v,I,O,W){if(Array.isArray(v))for(var K=0;K<v.length;K++)of(h,v[K],I,O,W);else O=d(O)?!!O.capture:!!O,I=lf(I),h&&h[B]?(h=h.i,v=String(v).toString(),v in h.g&&(K=h.g[v],I=at(K,I,O,W),-1<I&&(He(K[I]),Array.prototype.splice.call(K,I,1),K.length==0&&(delete h.g[v],h.h--)))):h&&(h=fc(h))&&(v=h.g[v.toString()],h=-1,v&&(h=at(v,I,O,W)),(I=-1<h?v[h]:null)&&ss(I))}function ss(h){if(typeof h!="number"&&h&&!h.da){var v=h.src;if(v&&v[B])it(v.i,h);else{var I=h.type,O=h.proxy;v.removeEventListener?v.removeEventListener(I,O,h.capture):v.detachEvent?v.detachEvent(af(I),O):v.addListener&&v.removeListener&&v.removeListener(O),(I=fc(v))?(it(I,h),I.h==0&&(I.src=null,v[gr]=null)):He(h)}}}function af(h){return h in nt?nt[h]:nt[h]="on"+h}function $0(h,v){if(h.da)h=!0;else{v=new ct(v,this);var I=h.listener,O=h.ha||h.src;h.fa&&ss(h),h=I.call(O,v)}return h}function fc(h){return h=h[gr],h instanceof Ae?h:null}var os="__closure_events_fn_"+(1e9*Math.random()>>>0);function lf(h){return typeof h=="function"?h:(h[os]||(h[os]=function(v){return h.handleEvent(v)}),h[os])}function cn(){ae.call(this),this.i=new Ae(this),this.M=this,this.F=null}S(cn,ae),cn.prototype[B]=!0,cn.prototype.removeEventListener=function(h,v,I,O){of(this,h,v,I,O)};function Tn(h,v){var I,O=h.F;if(O)for(I=[];O;O=O.F)I.push(O);if(h=h.M,O=v.type||v,typeof v=="string")v=new Ee(v,h);else if(v instanceof Ee)v.target=v.target||h;else{var W=v;v=new Ee(O,h),A(v,W)}if(W=!0,I)for(var K=I.length-1;0<=K;K--){var oe=v.g=I[K];W=El(oe,O,!0,v)&&W}if(oe=v.g=h,W=El(oe,O,!0,v)&&W,W=El(oe,O,!1,v)&&W,I)for(K=0;K<I.length;K++)oe=v.g=I[K],W=El(oe,O,!1,v)&&W}cn.prototype.N=function(){if(cn.aa.N.call(this),this.i){var h=this.i,v;for(v in h.g){for(var I=h.g[v],O=0;O<I.length;O++)He(I[O]);delete h.g[v],h.h--}}this.F=null},cn.prototype.K=function(h,v,I,O){return this.i.add(String(h),v,!1,I,O)},cn.prototype.L=function(h,v,I,O){return this.i.add(String(h),v,!0,I,O)};function El(h,v,I,O){if(v=h.i.g[String(v)],!v)return!0;v=v.concat();for(var W=!0,K=0;K<v.length;++K){var oe=v[K];if(oe&&!oe.da&&oe.capture==I){var qe=oe.listener,zt=oe.ha||oe.src;oe.fa&&it(h.i,oe),W=qe.call(zt,O)!==!1&&W}}return W&&!O.defaultPrevented}function uf(h,v,I){if(typeof h=="function")I&&(h=y(h,I));else if(h&&typeof h.handleEvent=="function")h=y(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(v)?-1:u.setTimeout(h,v||0)}function cf(h){h.g=uf(()=>{h.g=null,h.i&&(h.i=!1,cf(h))},h.l);const v=h.h;h.h=null,h.m.apply(null,v)}class q0 extends ae{constructor(v,I){super(),this.m=v,this.l=I,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:cf(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ha(h){ae.call(this),this.h=h,this.g={}}S(ha,ae);var hf=[];function df(h){z(h.g,function(v,I){this.g.hasOwnProperty(I)&&ss(v)},h),h.g={}}ha.prototype.N=function(){ha.aa.N.call(this),df(this)},ha.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var pc=u.JSON.stringify,K0=u.JSON.parse,ff=class{stringify(h){return u.JSON.stringify(h,void 0)}parse(h){return u.JSON.parse(h,void 0)}};function gc(){}gc.prototype.h=null;function pf(h){return h.h||(h.h=h.i())}function gf(){}var da={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function mc(){Ee.call(this,"d")}S(mc,Ee);function _c(){Ee.call(this,"c")}S(_c,Ee);var Di={},yc=null;function Tl(){return yc=yc||new cn}Di.La="serverreachability";function Cl(h){Ee.call(this,Di.La,h)}S(Cl,Ee);function eo(h){const v=Tl();Tn(v,new Cl(v))}Di.STAT_EVENT="statevent";function vc(h,v){Ee.call(this,Di.STAT_EVENT,h),this.stat=v}S(vc,Ee);function Cn(h){const v=Tl();Tn(v,new vc(v,h))}Di.Ma="timingevent";function mf(h,v){Ee.call(this,Di.Ma,h),this.size=v}S(mf,Ee);function fa(h,v){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){h()},v)}function to(){this.g=!0}to.prototype.xa=function(){this.g=!1};function wc(h,v,I,O,W,K){h.info(function(){if(h.g)if(K)for(var oe="",qe=K.split("&"),zt=0;zt<qe.length;zt++){var Ve=qe[zt].split("=");if(1<Ve.length){var Zt=Ve[0];Ve=Ve[1];var $t=Zt.split("_");oe=2<=$t.length&&$t[1]=="type"?oe+(Zt+"="+Ve+"&"):oe+(Zt+"=redacted&")}}else oe=null;else oe=K;return"XMLHTTP REQ ("+O+") [attempt "+W+"]: "+v+`
`+I+`
`+oe})}function Q0(h,v,I,O,W,K,oe){h.info(function(){return"XMLHTTP RESP ("+O+") [ attempt "+W+"]: "+v+`
`+I+`
`+K+" "+oe})}function no(h,v,I,O){h.info(function(){return"XMLHTTP TEXT ("+v+"): "+Y0(h,I)+(O?" "+O:"")})}function Il(h,v){h.info(function(){return"TIMEOUT: "+v})}to.prototype.info=function(){};function Y0(h,v){if(!h.g)return v;if(!v)return null;try{var I=JSON.parse(v);if(I){for(h=0;h<I.length;h++)if(Array.isArray(I[h])){var O=I[h];if(!(2>O.length)){var W=O[1];if(Array.isArray(W)&&!(1>W.length)){var K=W[0];if(K!="noop"&&K!="stop"&&K!="close")for(var oe=1;oe<W.length;oe++)W[oe]=""}}}}return pc(I)}catch{return v}}var Pl={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},_f={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Sc;function Rl(){}S(Rl,gc),Rl.prototype.g=function(){return new XMLHttpRequest},Rl.prototype.i=function(){return{}},Sc=new Rl;function Mi(h,v,I,O){this.j=h,this.i=v,this.l=I,this.R=O||1,this.U=new ha(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new yf}function yf(){this.i=null,this.g="",this.h=!1}var vf={},Ec={};function Tc(h,v,I){h.L=1,h.v=xl(mr(v)),h.m=I,h.P=!0,wf(h,null)}function wf(h,v){h.F=Date.now(),Al(h),h.A=mr(h.v);var I=h.A,O=h.R;Array.isArray(O)||(O=[String(O)]),Ge(I.i,"t",O),h.C=0,I=h.j.J,h.h=new yf,h.g=Mc(h.j,I?v:null,!h.m),0<h.O&&(h.M=new q0(y(h.Y,h,h.g),h.O)),v=h.U,I=h.g,O=h.ca;var W="readystatechange";Array.isArray(W)||(W&&(hf[0]=W.toString()),W=hf);for(var K=0;K<W.length;K++){var oe=si(I,W[K],O||v.handleEvent,!1,v.h||v);if(!oe)break;v.g[oe.key]=oe}v=h.H?C(h.H):{},h.m?(h.u||(h.u="POST"),v["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,v)):(h.u="GET",h.g.ea(h.A,h.u,null,v)),eo(),wc(h.i,h.u,h.A,h.l,h.R,h.m)}Mi.prototype.ca=function(h){h=h.target;const v=this.M;v&&zn(h)==3?v.j():this.Y(h)},Mi.prototype.Y=function(h){try{if(h==this.g)e:{const $t=zn(this.g);var v=this.g.Ba();const Ui=this.g.Z();if(!(3>$t)&&($t!=3||this.g&&(this.h.h||this.g.oa()||ya(this.g)))){this.J||$t!=4||v==7||(v==8||0>=Ui?eo(3):eo(2)),as(this);var I=this.g.Z();this.X=I;t:if(Sf(this)){var O=ya(this.g);h="";var W=O.length,K=zn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){oi(this),ls(this);var oe="";break t}this.h.i=new u.TextDecoder}for(v=0;v<W;v++)this.h.h=!0,h+=this.h.i.decode(O[v],{stream:!(K&&v==W-1)});O.length=0,this.h.g+=h,this.C=0,oe=this.h.g}else oe=this.g.oa();if(this.o=I==200,Q0(this.i,this.u,this.A,this.l,this.R,$t,I),this.o){if(this.T&&!this.K){t:{if(this.g){var qe,zt=this.g;if((qe=zt.g?zt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!R(qe)){var Ve=qe;break t}}Ve=null}if(I=Ve)no(this.i,this.l,I,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Cc(this,I);else{this.o=!1,this.s=3,Cn(12),oi(this),ls(this);break e}}if(this.P){I=!0;let dn;for(;!this.J&&this.C<oe.length;)if(dn=X0(this,oe),dn==Ec){$t==4&&(this.s=4,Cn(14),I=!1),no(this.i,this.l,null,"[Incomplete Response]");break}else if(dn==vf){this.s=4,Cn(15),no(this.i,this.l,oe,"[Invalid Chunk]"),I=!1;break}else no(this.i,this.l,dn,null),Cc(this,dn);if(Sf(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),$t!=4||oe.length!=0||this.h.h||(this.s=1,Cn(16),I=!1),this.o=this.o&&I,!I)no(this.i,this.l,oe,"[Invalid Chunked Response]"),oi(this),ls(this);else if(0<oe.length&&!this.W){this.W=!0;var Zt=this.j;Zt.g==this&&Zt.ba&&!Zt.M&&(Zt.j.info("Great, no buffering proxy detected. Bytes received: "+oe.length),gs(Zt),Zt.M=!0,Cn(11))}}else no(this.i,this.l,oe,null),Cc(this,oe);$t==4&&oi(this),this.o&&!this.J&&($t==4?Nc(this.j,this):(this.o=!1,Al(this)))}else Ll(this.g),I==400&&0<oe.indexOf("Unknown SID")?(this.s=3,Cn(12)):(this.s=0,Cn(13)),oi(this),ls(this)}}}catch{}finally{}};function Sf(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function X0(h,v){var I=h.C,O=v.indexOf(`
`,I);return O==-1?Ec:(I=Number(v.substring(I,O)),isNaN(I)?vf:(O+=1,O+I>v.length?Ec:(v=v.slice(O,O+I),h.C=O+I,v)))}Mi.prototype.cancel=function(){this.J=!0,oi(this)};function Al(h){h.S=Date.now()+h.I,kl(h,h.I)}function kl(h,v){if(h.B!=null)throw Error("WatchDog timer not null");h.B=fa(y(h.ba,h),v)}function as(h){h.B&&(u.clearTimeout(h.B),h.B=null)}Mi.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(Il(this.i,this.A),this.L!=2&&(eo(),Cn(17)),oi(this),this.s=2,ls(this)):kl(this,this.S-h)};function ls(h){h.j.G==0||h.J||Nc(h.j,h)}function oi(h){as(h);var v=h.M;v&&typeof v.ma=="function"&&v.ma(),h.M=null,df(h.U),h.g&&(v=h.g,h.g=null,v.abort(),v.ma())}function Cc(h,v){try{var I=h.j;if(I.G!=0&&(I.g==h||st(I.h,h))){if(!h.K&&st(I.h,h)&&I.G==3){try{var O=I.Da.g.parse(v)}catch{O=null}if(Array.isArray(O)&&O.length==3){var W=O;if(W[0]==0){e:if(!I.u){if(I.g)if(I.g.F+3e3<h.F)va(I),yr(I);else break e;ft(I),Cn(18)}}else I.za=W[1],0<I.za-I.T&&37500>W[2]&&I.F&&I.v==0&&!I.C&&(I.C=fa(y(I.Za,I),6e3));if(1>=dt(I.h)&&I.ca){try{I.ca()}catch{}I.ca=void 0}}else ci(I,11)}else if((h.K||I.g==h)&&va(I),!R(v))for(W=I.Da.g.parse(v),v=0;v<W.length;v++){let Ve=W[v];if(I.T=Ve[0],Ve=Ve[1],I.G==2)if(Ve[0]=="c"){I.K=Ve[1],I.ia=Ve[2];const Zt=Ve[3];Zt!=null&&(I.la=Zt,I.j.info("VER="+I.la));const $t=Ve[4];$t!=null&&(I.Aa=$t,I.j.info("SVER="+I.Aa));const Ui=Ve[5];Ui!=null&&typeof Ui=="number"&&0<Ui&&(O=1.5*Ui,I.L=O,I.j.info("backChannelRequestTimeoutMs_="+O)),O=I;const dn=h.g;if(dn){const Rn=dn.g?dn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Rn){var K=O.h;K.g||Rn.indexOf("spdy")==-1&&Rn.indexOf("quic")==-1&&Rn.indexOf("h2")==-1||(K.j=K.l,K.g=new Set,K.h&&(Br(K,K.h),K.h=null))}if(O.D){const hi=dn.g?dn.g.getResponseHeader("X-HTTP-Session-Id"):null;hi&&(O.ya=hi,mt(O.I,O.D,hi))}}I.G=3,I.l&&I.l.ua(),I.ba&&(I.R=Date.now()-h.F,I.j.info("Handshake RTT: "+I.R+"ms")),O=I;var oe=h;if(O.qa=wa(O,O.J?O.ia:null,O.W),oe.K){Jt(O.h,oe);var qe=oe,zt=O.L;zt&&(qe.I=zt),qe.B&&(as(qe),Al(qe)),O.g=oe}else or(O);0<I.i.length&&jr(I)}else Ve[0]!="stop"&&Ve[0]!="close"||ci(I,7);else I.G==3&&(Ve[0]=="stop"||Ve[0]=="close"?Ve[0]=="stop"?ci(I,7):ui(I):Ve[0]!="noop"&&I.l&&I.l.ta(Ve),I.v=0)}}eo(4)}catch{}}var Ic=class{constructor(h,v){this.g=h,this.map=v}};function us(h){this.l=h||10,u.PerformanceNavigationTiming?(h=u.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ai(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function dt(h){return h.h?1:h.g?h.g.size:0}function st(h,v){return h.h?h.h==v:h.g?h.g.has(v):!1}function Br(h,v){h.g?h.g.add(v):h.h=v}function Jt(h,v){h.h&&h.h==v?h.h=null:h.g&&h.g.has(v)&&h.g.delete(v)}us.prototype.cancel=function(){if(this.i=In(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function In(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let v=h.i;for(const I of h.g.values())v=v.concat(I.D);return v}return x(h.i)}function cs(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(c(h)){for(var v=[],I=h.length,O=0;O<I;O++)v.push(h[O]);return v}v=[],I=0;for(O in h)v[I++]=h[O];return v}function ro(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(c(h)||typeof h=="string"){var v=[];h=h.length;for(var I=0;I<h;I++)v.push(I);return v}v=[],I=0;for(const O in h)v[I++]=O;return v}}}function Pn(h,v){if(h.forEach&&typeof h.forEach=="function")h.forEach(v,void 0);else if(c(h)||typeof h=="string")Array.prototype.forEach.call(h,v,void 0);else for(var I=ro(h),O=cs(h),W=O.length,K=0;K<W;K++)v.call(void 0,O[K],I&&I[K],h)}var pa=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ef(h,v){if(h){h=h.split("&");for(var I=0;I<h.length;I++){var O=h[I].indexOf("="),W=null;if(0<=O){var K=h[I].substring(0,O);W=h[I].substring(O+1)}else K=h[I];v(K,W?decodeURIComponent(W.replace(/\+/g," ")):"")}}}function Oi(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof Oi){this.h=h.h,ga(this,h.j),this.o=h.o,this.g=h.g,Vn(this,h.s),this.l=h.l;var v=h.i,I=new hs;I.i=v.i,v.g&&(I.g=new Map(v.g),I.h=v.h),Tf(this,I),this.m=h.m}else h&&(v=String(h).match(pa))?(this.h=!1,ga(this,v[1]||"",!0),this.o=Li(v[2]||""),this.g=Li(v[3]||"",!0),Vn(this,v[4]),this.l=Li(v[5]||"",!0),Tf(this,v[6]||"",!0),this.m=Li(v[7]||"")):(this.h=!1,this.i=new hs(null,this.h))}Oi.prototype.toString=function(){var h=[],v=this.j;v&&h.push(bi(v,_a,!0),":");var I=this.g;return(I||v=="file")&&(h.push("//"),(v=this.o)&&h.push(bi(v,_a,!0),"@"),h.push(encodeURIComponent(String(I)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),I=this.s,I!=null&&h.push(":",String(I))),(I=this.l)&&(this.g&&I.charAt(0)!="/"&&h.push("/"),h.push(bi(I,I.charAt(0)=="/"?Z0:J0,!0))),(I=this.i.toString())&&h.push("?",I),(I=this.m)&&h.push("#",bi(I,Cf)),h.join("")};function mr(h){return new Oi(h)}function ga(h,v,I){h.j=I?Li(v,!0):v,h.j&&(h.j=h.j.replace(/:$/,""))}function Vn(h,v){if(v){if(v=Number(v),isNaN(v)||0>v)throw Error("Bad port number "+v);h.s=v}else h.s=null}function Tf(h,v,I){v instanceof hs?(h.i=v,Rc(h.i,h.h)):(I||(v=bi(v,Pc)),h.i=new hs(v,h.h))}function mt(h,v,I){h.i.set(v,I)}function xl(h){return mt(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function Li(h,v){return h?v?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function bi(h,v,I){return typeof h=="string"?(h=encodeURI(h).replace(v,ma),I&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function ma(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var _a=/[#\/\?@]/g,J0=/[#\?:]/g,Z0=/[#\?]/g,Pc=/[#\?@]/g,Cf=/#/g;function hs(h,v){this.h=this.g=null,this.i=h||null,this.j=!!v}function _r(h){h.g||(h.g=new Map,h.h=0,h.i&&Ef(h.i,function(v,I){h.add(decodeURIComponent(v.replace(/\+/g," ")),I)}))}n=hs.prototype,n.add=function(h,v){_r(this),this.i=null,h=ds(this,h);var I=this.g.get(h);return I||this.g.set(h,I=[]),I.push(v),this.h+=1,this};function If(h,v){_r(h),v=ds(h,v),h.g.has(v)&&(h.i=null,h.h-=h.g.get(v).length,h.g.delete(v))}function Nl(h,v){return _r(h),v=ds(h,v),h.g.has(v)}n.forEach=function(h,v){_r(this),this.g.forEach(function(I,O){I.forEach(function(W){h.call(v,W,O,this)},this)},this)},n.na=function(){_r(this);const h=Array.from(this.g.values()),v=Array.from(this.g.keys()),I=[];for(let O=0;O<v.length;O++){const W=h[O];for(let K=0;K<W.length;K++)I.push(v[O])}return I},n.V=function(h){_r(this);let v=[];if(typeof h=="string")Nl(this,h)&&(v=v.concat(this.g.get(ds(this,h))));else{h=Array.from(this.g.values());for(let I=0;I<h.length;I++)v=v.concat(h[I])}return v},n.set=function(h,v){return _r(this),this.i=null,h=ds(this,h),Nl(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[v]),this.h+=1,this},n.get=function(h,v){return h?(h=this.V(h),0<h.length?String(h[0]):v):v};function Ge(h,v,I){If(h,v),0<I.length&&(h.i=null,h.g.set(ds(h,v),x(I)),h.h+=I.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],v=Array.from(this.g.keys());for(var I=0;I<v.length;I++){var O=v[I];const K=encodeURIComponent(String(O)),oe=this.V(O);for(O=0;O<oe.length;O++){var W=K;oe[O]!==""&&(W+="="+encodeURIComponent(String(oe[O]))),h.push(W)}}return this.i=h.join("&")};function ds(h,v){return v=String(v),h.j&&(v=v.toLowerCase()),v}function Rc(h,v){v&&!h.j&&(_r(h),h.i=null,h.g.forEach(function(I,O){var W=O.toLowerCase();O!=W&&(If(this,O),Ge(this,W,I))},h)),h.j=v}function Pf(h,v){const I=new to;if(u.Image){const O=new Image;O.onload=E(Fi,I,"TestLoadImage: loaded",!0,v,O),O.onerror=E(Fi,I,"TestLoadImage: error",!1,v,O),O.onabort=E(Fi,I,"TestLoadImage: abort",!1,v,O),O.ontimeout=E(Fi,I,"TestLoadImage: timeout",!1,v,O),u.setTimeout(function(){O.ontimeout&&O.ontimeout()},1e4),O.src=h}else v(!1)}function e_(h,v){const I=new to,O=new AbortController,W=setTimeout(()=>{O.abort(),Fi(I,"TestPingServer: timeout",!1,v)},1e4);fetch(h,{signal:O.signal}).then(K=>{clearTimeout(W),K.ok?Fi(I,"TestPingServer: ok",!0,v):Fi(I,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(W),Fi(I,"TestPingServer: error",!1,v)})}function Fi(h,v,I,O,W){try{W&&(W.onload=null,W.onerror=null,W.onabort=null,W.ontimeout=null),O(I)}catch{}}function Ht(){this.g=new ff}function Ac(h,v,I){const O=I||"";try{Pn(h,function(W,K){let oe=W;d(W)&&(oe=pc(W)),v.push(O+K+"="+encodeURIComponent(oe))})}catch(W){throw v.push(O+"type="+encodeURIComponent("_badmap")),W}}function Dl(h){this.l=h.Ub||null,this.j=h.eb||!1}S(Dl,gc),Dl.prototype.g=function(){return new io(this.l,this.j)},Dl.prototype.i=function(h){return function(){return h}}({});function io(h,v){cn.call(this),this.D=h,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}S(io,cn),n=io.prototype,n.open=function(h,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=v,this.readyState=1,Un(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const v={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(v.body=h),(this.D||u).fetch(new Request(this.A,v)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Vi(this)),this.readyState=0},n.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Un(this)),this.g&&(this.readyState=3,Un(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Rf(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function Rf(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}n.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var v=h.value?h.value:new Uint8Array(0);(v=this.v.decode(v,{stream:!h.done}))&&(this.response=this.responseText+=v)}h.done?Vi(this):Un(this),this.readyState==3&&Rf(this)}},n.Ra=function(h){this.g&&(this.response=this.responseText=h,Vi(this))},n.Qa=function(h){this.g&&(this.response=h,Vi(this))},n.ga=function(){this.g&&Vi(this)};function Vi(h){h.readyState=4,h.l=null,h.j=null,h.v=null,Un(h)}n.setRequestHeader=function(h,v){this.u.append(h,v)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],v=this.h.entries();for(var I=v.next();!I.done;)I=I.value,h.push(I[0]+": "+I[1]),I=v.next();return h.join(`\r
`)};function Un(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(io.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Af(h){let v="";return z(h,function(I,O){v+=O,v+=":",v+=I,v+=`\r
`}),v}function kc(h,v,I){e:{for(O in I){var O=!1;break e}O=!0}O||(I=Af(I),typeof h=="string"?I!=null&&encodeURIComponent(String(I)):mt(h,v,I))}function $e(h){cn.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}S($e,cn);var li=/^https?$/i,Ml=["POST","PUT"];n=$e.prototype,n.Ha=function(h){this.J=h},n.ea=function(h,v,I,O){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);v=v?v.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Sc.g(),this.v=this.o?pf(this.o):pf(Sc),this.g.onreadystatechange=y(this.Ea,this);try{this.B=!0,this.g.open(v,String(h),!0),this.B=!1}catch(K){Ol(this,K);return}if(h=I||"",I=new Map(this.headers),O)if(Object.getPrototypeOf(O)===Object.prototype)for(var W in O)I.set(W,O[W]);else if(typeof O.keys=="function"&&typeof O.get=="function")for(const K of O.keys())I.set(K,O.get(K));else throw Error("Unknown input type for opt_headers: "+String(O));O=Array.from(I.keys()).find(K=>K.toLowerCase()=="content-type"),W=u.FormData&&h instanceof u.FormData,!(0<=Array.prototype.indexOf.call(Ml,v,void 0))||O||W||I.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[K,oe]of I)this.g.setRequestHeader(K,oe);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{fs(this),this.u=!0,this.g.send(h),this.u=!1}catch(K){Ol(this,K)}};function Ol(h,v){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=v,h.m=5,xc(h),ir(h)}function xc(h){h.A||(h.A=!0,Tn(h,"complete"),Tn(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,Tn(this,"complete"),Tn(this,"abort"),ir(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ir(this,!0)),$e.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?kf(this):this.bb())},n.bb=function(){kf(this)};function kf(h){if(h.h&&typeof o<"u"&&(!h.v[1]||zn(h)!=4||h.Z()!=2)){if(h.u&&zn(h)==4)uf(h.Ea,0,h);else if(Tn(h,"readystatechange"),zn(h)==4){h.h=!1;try{const oe=h.Z();e:switch(oe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var I;if(!(I=v)){var O;if(O=oe===0){var W=String(h.D).match(pa)[1]||null;!W&&u.self&&u.self.location&&(W=u.self.location.protocol.slice(0,-1)),O=!li.test(W?W.toLowerCase():"")}I=O}if(I)Tn(h,"complete"),Tn(h,"success");else{h.m=6;try{var K=2<zn(h)?h.g.statusText:""}catch{K=""}h.l=K+" ["+h.Z()+"]",xc(h)}}finally{ir(h)}}}}function ir(h,v){if(h.g){fs(h);const I=h.g,O=h.v[0]?()=>{}:null;h.g=null,h.v=null,v||Tn(h,"ready");try{I.onreadystatechange=O}catch{}}}function fs(h){h.I&&(u.clearTimeout(h.I),h.I=null)}n.isActive=function(){return!!this.g};function zn(h){return h.g?h.g.readyState:0}n.Z=function(){try{return 2<zn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(h){if(this.g){var v=this.g.responseText;return h&&v.indexOf(h)==0&&(v=v.substring(h.length)),K0(v)}};function ya(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function Ll(h){const v={};h=(h.g&&2<=zn(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let O=0;O<h.length;O++){if(R(h[O]))continue;var I=L(h[O]);const W=I[0];if(I=I[1],typeof I!="string")continue;I=I.trim();const K=v[W]||[];v[W]=K,K.push(I)}M(v,function(O){return O.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function hn(h,v,I){return I&&I.internalChannelParams&&I.internalChannelParams[h]||v}function sr(h){this.Aa=0,this.i=[],this.j=new to,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=hn("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=hn("baseRetryDelayMs",5e3,h),this.cb=hn("retryDelaySeedMs",1e4,h),this.Wa=hn("forwardChannelMaxRetries",2,h),this.wa=hn("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new us(h&&h.concurrentRequestLimit),this.Da=new Ht,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=sr.prototype,n.la=8,n.G=1,n.connect=function(h,v,I,O){Cn(0),this.W=h,this.H=v||{},I&&O!==void 0&&(this.H.OSID=I,this.H.OAID=O),this.F=this.X,this.I=wa(this,null,this.W),jr(this)};function ui(h){if(Gr(h),h.G==3){var v=h.U++,I=mr(h.I);if(mt(I,"SID",h.K),mt(I,"RID",v),mt(I,"TYPE","terminate"),ps(h,I),v=new Mi(h,h.j,v),v.L=2,v.v=xl(mr(I)),I=!1,u.navigator&&u.navigator.sendBeacon)try{I=u.navigator.sendBeacon(v.v.toString(),"")}catch{}!I&&u.Image&&(new Image().src=v.v,I=!0),I||(v.g=Mc(v.j,null),v.g.ea(v.v)),v.F=Date.now(),Al(v)}Dc(h)}function yr(h){h.g&&(gs(h),h.g.cancel(),h.g=null)}function Gr(h){yr(h),h.u&&(u.clearTimeout(h.u),h.u=null),va(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&u.clearTimeout(h.s),h.s=null)}function jr(h){if(!ai(h.h)&&!h.s){h.s=!0;var v=h.Ga;ue||J(),H||(ue(),H=!0),te.add(v,h),h.B=0}}function xf(h,v){return dt(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=v.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=fa(y(h.Ga,h,v),Fl(h,h.B)),h.B++,!0)}n.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const W=new Mi(this,this.j,h);let K=this.o;if(this.S&&(K?(K=C(K),A(K,this.S)):K=this.S),this.m!==null||this.O||(W.H=K,K=null),this.P)e:{for(var v=0,I=0;I<this.i.length;I++){t:{var O=this.i[I];if("__data__"in O.map&&(O=O.map.__data__,typeof O=="string")){O=O.length;break t}O=void 0}if(O===void 0)break;if(v+=O,4096<v){v=I;break e}if(v===4096||I===this.i.length-1){v=I+1;break e}}v=1e3}else v=1e3;v=Bn(this,W,v),I=mr(this.I),mt(I,"RID",h),mt(I,"CVER",22),this.D&&mt(I,"X-HTTP-Session-Id",this.D),ps(this,I),K&&(this.O?v="headers="+encodeURIComponent(String(Af(K)))+"&"+v:this.m&&kc(I,this.m,K)),Br(this.h,W),this.Ua&&mt(I,"TYPE","init"),this.P?(mt(I,"$req",v),mt(I,"SID","null"),W.T=!0,Tc(W,I,null)):Tc(W,I,v),this.G=2}}else this.G==3&&(h?bl(this,h):this.i.length==0||ai(this.h)||bl(this))};function bl(h,v){var I;v?I=v.l:I=h.U++;const O=mr(h.I);mt(O,"SID",h.K),mt(O,"RID",I),mt(O,"AID",h.T),ps(h,O),h.m&&h.o&&kc(O,h.m,h.o),I=new Mi(h,h.j,I,h.B+1),h.m===null&&(I.H=h.o),v&&(h.i=v.D.concat(h.i)),v=Bn(h,I,1e3),I.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),Br(h.h,I),Tc(I,O,v)}function ps(h,v){h.H&&z(h.H,function(I,O){mt(v,O,I)}),h.l&&Pn({},function(I,O){mt(v,O,I)})}function Bn(h,v,I){I=Math.min(h.i.length,I);var O=h.l?y(h.l.Na,h.l,h):null;e:{var W=h.i;let K=-1;for(;;){const oe=["count="+I];K==-1?0<I?(K=W[0].g,oe.push("ofs="+K)):K=0:oe.push("ofs="+K);let qe=!0;for(let zt=0;zt<I;zt++){let Ve=W[zt].g;const Zt=W[zt].map;if(Ve-=K,0>Ve)K=Math.max(0,W[zt].g-100),qe=!1;else try{Ac(Zt,oe,"req"+Ve+"_")}catch{O&&O(Zt)}}if(qe){O=oe.join("&");break e}}}return h=h.i.splice(0,I),v.D=h,O}function or(h){if(!h.g&&!h.u){h.Y=1;var v=h.Fa;ue||J(),H||(ue(),H=!0),te.add(v,h),h.v=0}}function ft(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=fa(y(h.Fa,h),Fl(h,h.v)),h.v++,!0)}n.Fa=function(){if(this.u=null,vr(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=fa(y(this.ab,this),h)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Cn(10),yr(this),vr(this))};function gs(h){h.A!=null&&(u.clearTimeout(h.A),h.A=null)}function vr(h){h.g=new Mi(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var v=mr(h.qa);mt(v,"RID","rpc"),mt(v,"SID",h.K),mt(v,"AID",h.T),mt(v,"CI",h.F?"0":"1"),!h.F&&h.ja&&mt(v,"TO",h.ja),mt(v,"TYPE","xmlhttp"),ps(h,v),h.m&&h.o&&kc(v,h.m,h.o),h.L&&(h.g.I=h.L);var I=h.g;h=h.ia,I.L=1,I.v=xl(mr(v)),I.m=null,I.P=!0,wf(I,h)}n.Za=function(){this.C!=null&&(this.C=null,yr(this),ft(this),Cn(19))};function va(h){h.C!=null&&(u.clearTimeout(h.C),h.C=null)}function Nc(h,v){var I=null;if(h.g==v){va(h),gs(h),h.g=null;var O=2}else if(st(h.h,v))I=v.D,Jt(h.h,v),O=1;else return;if(h.G!=0){if(v.o)if(O==1){I=v.m?v.m.length:0,v=Date.now()-v.F;var W=h.B;O=Tl(),Tn(O,new mf(O,I)),jr(h)}else or(h);else if(W=v.s,W==3||W==0&&0<v.X||!(O==1&&xf(h,v)||O==2&&ft(h)))switch(I&&0<I.length&&(v=h.h,v.i=v.i.concat(I)),W){case 1:ci(h,5);break;case 4:ci(h,10);break;case 3:ci(h,6);break;default:ci(h,2)}}}function Fl(h,v){let I=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(I*=2),I*v}function ci(h,v){if(h.j.info("Error code "+v),v==2){var I=y(h.fb,h),O=h.Xa;const W=!O;O=new Oi(O||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||ga(O,"https"),xl(O),W?Pf(O.toString(),I):e_(O.toString(),I)}else Cn(2);h.G=0,h.l&&h.l.sa(v),Dc(h),Gr(h)}n.fb=function(h){h?(this.j.info("Successfully pinged google.com"),Cn(2)):(this.j.info("Failed to ping google.com"),Cn(1))};function Dc(h){if(h.G=0,h.ka=[],h.l){const v=In(h.h);(v.length!=0||h.i.length!=0)&&(D(h.ka,v),D(h.ka,h.i),h.h.i.length=0,x(h.i),h.i.length=0),h.l.ra()}}function wa(h,v,I){var O=I instanceof Oi?mr(I):new Oi(I);if(O.g!="")v&&(O.g=v+"."+O.g),Vn(O,O.s);else{var W=u.location;O=W.protocol,v=v?v+"."+W.hostname:W.hostname,W=+W.port;var K=new Oi(null);O&&ga(K,O),v&&(K.g=v),W&&Vn(K,W),I&&(K.l=I),O=K}return I=h.D,v=h.ya,I&&v&&mt(O,I,v),mt(O,"VER",h.la),ps(h,O),O}function Mc(h,v,I){if(v&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return v=h.Ca&&!h.pa?new $e(new Dl({eb:I})):new $e(h.pa),v.Ha(h.J),v}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function ms(){}n=ms.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function so(){}so.prototype.g=function(h,v){return new ar(h,v)};function ar(h,v){cn.call(this),this.g=new sr(v),this.l=h,this.h=v&&v.messageUrlParams||null,h=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(h?h["X-WebChannel-Content-Type"]=v.messageContentType:h={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.va&&(h?h["X-WebChannel-Client-Profile"]=v.va:h={"X-WebChannel-Client-Profile":v.va}),this.g.S=h,(h=v&&v.Sb)&&!R(h)&&(this.g.m=h),this.v=v&&v.supportsCrossDomainXhr||!1,this.u=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!R(v)&&(this.g.D=v,h=this.h,h!==null&&v in h&&(h=this.h,v in h&&delete h[v])),this.j=new Wr(this)}S(ar,cn),ar.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ar.prototype.close=function(){ui(this.g)},ar.prototype.o=function(h){var v=this.g;if(typeof h=="string"){var I={};I.__data__=h,h=I}else this.u&&(I={},I.__data__=pc(h),h=I);v.i.push(new Ic(v.Ya++,h)),v.G==3&&jr(v)},ar.prototype.N=function(){this.g.l=null,delete this.j,ui(this.g),delete this.g,ar.aa.N.call(this)};function Sa(h){mc.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var v=h.__sm__;if(v){e:{for(const I in v){h=I;break e}h=void 0}(this.i=h)&&(h=this.i,v=v!==null&&h in v?v[h]:void 0),this.data=v}else this.data=h}S(Sa,mc);function Nf(){_c.call(this),this.status=1}S(Nf,_c);function Wr(h){this.g=h}S(Wr,ms),Wr.prototype.ua=function(){Tn(this.g,"a")},Wr.prototype.ta=function(h){Tn(this.g,new Sa(h))},Wr.prototype.sa=function(h){Tn(this.g,new Nf)},Wr.prototype.ra=function(){Tn(this.g,"b")},so.prototype.createWebChannel=so.prototype.g,ar.prototype.send=ar.prototype.o,ar.prototype.open=ar.prototype.m,ar.prototype.close=ar.prototype.close,t9=function(){return new so},e9=function(){return Tl()},Z6=Di,Z1={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Pl.NO_ERROR=0,Pl.TIMEOUT=8,Pl.HTTP_ERROR=6,tg=Pl,_f.COMPLETE="complete",J6=_f,gf.EventType=da,da.OPEN="a",da.CLOSE="b",da.ERROR="c",da.MESSAGE="d",cn.prototype.listen=cn.prototype.K,vh=gf,$e.prototype.listenOnce=$e.prototype.L,$e.prototype.getLastError=$e.prototype.Ka,$e.prototype.getLastErrorCode=$e.prototype.Ba,$e.prototype.getStatus=$e.prototype.Z,$e.prototype.getResponseJson=$e.prototype.Oa,$e.prototype.getResponseText=$e.prototype.oa,$e.prototype.send=$e.prototype.ea,$e.prototype.setWithCredentials=$e.prototype.Ha,X6=$e}).apply(typeof Rp<"u"?Rp:typeof self<"u"?self:typeof window<"u"?window:{});const IT="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Qn.UNAUTHENTICATED=new Qn(null),Qn.GOOGLE_CREDENTIALS=new Qn("google-credentials-uid"),Qn.FIRST_PARTY=new Qn("first-party-uid"),Qn.MOCK_USER=new Qn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zu="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xa=new km("@firebase/firestore");function nh(){return Xa.logLevel}function ye(n,...e){if(Xa.logLevel<=ze.DEBUG){const t=e.map(q2);Xa.debug(`Firestore (${Zu}): ${n}`,...t)}}function Ws(n,...e){if(Xa.logLevel<=ze.ERROR){const t=e.map(q2);Xa.error(`Firestore (${Zu}): ${n}`,...t)}}function Ou(n,...e){if(Xa.logLevel<=ze.WARN){const t=e.map(q2);Xa.warn(`Firestore (${Zu}): ${n}`,...t)}}function q2(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ce(n="Unexpected state"){const e=`FIRESTORE (${Zu}) INTERNAL ASSERTION FAILED: `+n;throw Ws(e),new Error(e)}function Je(n,e){n||Ce()}function ke(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class fe extends Ks{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n9{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class CM{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Qn.UNAUTHENTICATED))}shutdown(){}}class IM{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class PM{constructor(e){this.t=e,this.currentUser=Qn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Je(this.o===void 0);let r=this.i;const i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve();let s=new Uo;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Uo,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},u=c=>{ye("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>u(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?u(c):(ye("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Uo)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(ye("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Je(typeof r.accessToken=="string"),new n9(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Je(e===null||typeof e=="string"),new Qn(e)}}class RM{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Qn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class AM{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new RM(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Qn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class kM{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class xM{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Je(this.o===void 0);const r=s=>{s.error!=null&&ye("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,ye("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{ye("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):ye("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Je(typeof t.token=="string"),this.R=t.token,new kM(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NM(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r9{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=NM(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}}function tt(n,e){return n<e?-1:n>e?1:0}function Lu(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new fe(Z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new fe(Z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new fe(Z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new fe(Z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return an.fromMillis(Date.now())}static fromDate(e){return an.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new an(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?tt(this.nanoseconds,e.nanoseconds):tt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ie{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ie(e)}static min(){return new Ie(new an(0,0))}static max(){return new Ie(new an(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cd{constructor(e,t,r){t===void 0?t=0:t>e.length&&Ce(),r===void 0?r=e.length-t:r>e.length-t&&Ce(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return cd.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof cd?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class yt extends cd{construct(e,t,r){return new yt(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new fe(Z.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new yt(t)}static emptyPath(){return new yt([])}}const DM=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Mn extends cd{construct(e,t,r){return new Mn(e,t,r)}static isValidIdentifier(e){return DM.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Mn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Mn(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new fe(Z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;i<e.length;){const u=e[i];if(u==="\\"){if(i+1===e.length)throw new fe(Z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new fe(Z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else u==="`"?(o=!o,i++):u!=="."||o?(r+=u,i++):(s(),i++)}if(s(),o)throw new fe(Z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Mn(t)}static emptyPath(){return new Mn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Se{constructor(e){this.path=e}static fromPath(e){return new Se(yt.fromString(e))}static fromName(e){return new Se(yt.fromString(e).popFirst(5))}static empty(){return new Se(yt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&yt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return yt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Se(new yt(e.slice()))}}function MM(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Ie.fromTimestamp(r===1e9?new an(t+1,0):new an(t,r));return new $o(i,Se.empty(),e)}function OM(n){return new $o(n.readTime,n.key,-1)}class $o{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new $o(Ie.min(),Se.empty(),-1)}static max(){return new $o(Ie.max(),Se.empty(),-1)}}function LM(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Se.comparator(n.documentKey,e.documentKey),t!==0?t:tt(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bM="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class FM{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ud(n){if(n.code!==Z.FAILED_PRECONDITION||n.message!==bM)throw n;ye("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ne{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ce(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ne((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ne?t:ne.resolve(t)}catch(t){return ne.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ne.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ne.reject(t)}static resolve(e){return new ne((t,r)=>{t(e)})}static reject(e){return new ne((t,r)=>{r(e)})}static waitFor(e){return new ne((t,r)=>{let i=0,s=0,o=!1;e.forEach(u=>{++i,u.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=ne.resolve(!1);for(const r of e)t=t.next(i=>i?ne.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new ne((r,i)=>{const s=e.length,o=new Array(s);let u=0;for(let c=0;c<s;c++){const d=c;t(e[d]).next(p=>{o[d]=p,++u,u===s&&r(o)},p=>i(p))}})}static doWhile(e,t){return new ne((r,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}}function VM(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function zd(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K2{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ie(r),this.se=r=>t.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}K2.oe=-1;function Bd(n){return n==null}function jg(n){return n===0&&1/n==-1/0}function UM(n){return typeof n=="number"&&Number.isInteger(n)&&!jg(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PT(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ll(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function i9(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xt=class ev{constructor(e,t){this.comparator=e,this.root=t||zo.EMPTY}insert(e,t){return new ev(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,zo.BLACK,null,null))}remove(e){return new ev(this.comparator,this.root.remove(e,this.comparator).copy(null,null,zo.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ap(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ap(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ap(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ap(this.root,e,this.comparator,!0)}},Ap=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},zo=class Es{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??Es.RED,this.left=i??Es.EMPTY,this.right=s??Es.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new Es(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Es.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Es.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Es.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Es.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ce();const e=this.left.check();if(e!==this.right.check())throw Ce();return e+(this.isRed()?0:1)}};zo.EMPTY=null,zo.RED=!0,zo.BLACK=!1;zo.EMPTY=new class{constructor(){this.size=0}get key(){throw Ce()}get value(){throw Ce()}get color(){throw Ce()}get left(){throw Ce()}get right(){throw Ce()}copy(e,t,r,i,s){return this}insert(e,t,r){return new zo(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(e){this.comparator=e,this.data=new Xt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new RT(this.data.getIterator())}getIteratorFrom(e){return new RT(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Ln)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Ln(this.comparator);return t.data=e,t}}class RT{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(e){this.fields=e,e.sort(Mn.comparator)}static empty(){return new Or([])}unionWith(e){let t=new Ln(Mn.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Or(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Lu(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s9 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new s9("Invalid base64 string: "+s):s}}(e);return new Fn(t)}static fromUint8Array(e){const t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Fn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return tt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Fn.EMPTY_BYTE_STRING=new Fn("");const zM=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function qo(n){if(Je(!!n),typeof n=="string"){let e=0;const t=zM.exec(n);if(Je(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Gt(n.seconds),nanos:Gt(n.nanos)}}function Gt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ja(n){return typeof n=="string"?Fn.fromBase64String(n):Fn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q2(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Y2(n){const e=n.mapValue.fields.__previous_value__;return Q2(e)?Y2(e):e}function hd(n){const e=qo(n.mapValue.fields.__local_write_time__.timestampValue);return new an(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BM{constructor(e,t,r,i,s,o,u,c,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.longPollingOptions=c,this.useFetchStreams=d}}class dd{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new dd("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof dd&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kp={mapValue:{}};function Za(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Q2(n)?4:jM(n)?9007199254740991:GM(n)?10:11:Ce()}function ns(n,e){if(n===e)return!0;const t=Za(n);if(t!==Za(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return hd(n).isEqual(hd(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=qo(i.timestampValue),u=qo(s.timestampValue);return o.seconds===u.seconds&&o.nanos===u.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return Ja(i.bytesValue).isEqual(Ja(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return Gt(i.geoPointValue.latitude)===Gt(s.geoPointValue.latitude)&&Gt(i.geoPointValue.longitude)===Gt(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Gt(i.integerValue)===Gt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=Gt(i.doubleValue),u=Gt(s.doubleValue);return o===u?jg(o)===jg(u):isNaN(o)&&isNaN(u)}return!1}(n,e);case 9:return Lu(n.arrayValue.values||[],e.arrayValue.values||[],ns);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},u=s.mapValue.fields||{};if(PT(o)!==PT(u))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(u[c]===void 0||!ns(o[c],u[c])))return!1;return!0}(n,e);default:return Ce()}}function fd(n,e){return(n.values||[]).find(t=>ns(t,e))!==void 0}function bu(n,e){if(n===e)return 0;const t=Za(n),r=Za(e);if(t!==r)return tt(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return tt(n.booleanValue,e.booleanValue);case 2:return function(s,o){const u=Gt(s.integerValue||s.doubleValue),c=Gt(o.integerValue||o.doubleValue);return u<c?-1:u>c?1:u===c?0:isNaN(u)?isNaN(c)?0:-1:1}(n,e);case 3:return AT(n.timestampValue,e.timestampValue);case 4:return AT(hd(n),hd(e));case 5:return tt(n.stringValue,e.stringValue);case 6:return function(s,o){const u=Ja(s),c=Ja(o);return u.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){const u=s.split("/"),c=o.split("/");for(let d=0;d<u.length&&d<c.length;d++){const p=tt(u[d],c[d]);if(p!==0)return p}return tt(u.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){const u=tt(Gt(s.latitude),Gt(o.latitude));return u!==0?u:tt(Gt(s.longitude),Gt(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return kT(n.arrayValue,e.arrayValue);case 10:return function(s,o){var u,c,d,p;const m=s.fields||{},y=o.fields||{},E=(u=m.value)===null||u===void 0?void 0:u.arrayValue,S=(c=y.value)===null||c===void 0?void 0:c.arrayValue,x=tt(((d=E==null?void 0:E.values)===null||d===void 0?void 0:d.length)||0,((p=S==null?void 0:S.values)===null||p===void 0?void 0:p.length)||0);return x!==0?x:kT(E,S)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===kp.mapValue&&o===kp.mapValue)return 0;if(s===kp.mapValue)return 1;if(o===kp.mapValue)return-1;const u=s.fields||{},c=Object.keys(u),d=o.fields||{},p=Object.keys(d);c.sort(),p.sort();for(let m=0;m<c.length&&m<p.length;++m){const y=tt(c[m],p[m]);if(y!==0)return y;const E=bu(u[c[m]],d[p[m]]);if(E!==0)return E}return tt(c.length,p.length)}(n.mapValue,e.mapValue);default:throw Ce()}}function AT(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return tt(n,e);const t=qo(n),r=qo(e),i=tt(t.seconds,r.seconds);return i!==0?i:tt(t.nanos,r.nanos)}function kT(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=bu(t[i],r[i]);if(s)return s}return tt(t.length,r.length)}function Fu(n){return tv(n)}function tv(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=qo(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Ja(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return Se.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=tv(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${tv(t.fields[o])}`;return i+"}"}(n.mapValue):Ce()}function xT(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function nv(n){return!!n&&"integerValue"in n}function X2(n){return!!n&&"arrayValue"in n}function NT(n){return!!n&&"nullValue"in n}function DT(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ng(n){return!!n&&"mapValue"in n}function GM(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Oh(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return ll(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Oh(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Oh(n.arrayValue.values[t]);return e}return Object.assign({},n)}function jM(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(e){this.value=e}static empty(){return new cr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!ng(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Oh(t)}setAll(e){let t=Mn.emptyPath(),r={},i=[];e.forEach((o,u)=>{if(!t.isImmediateParentOf(u)){const c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=u.popLast()}o?r[u.lastSegment()]=Oh(o):i.push(u.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());ng(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ns(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];ng(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){ll(t,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new cr(Oh(this.value))}}function o9(n){const e=[];return ll(n.fields,(t,r)=>{const i=new Mn([t]);if(ng(r)){const s=o9(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Or(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wn{constructor(e,t,r,i,s,o,u){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=u}static newInvalidDocument(e){return new wn(e,0,Ie.min(),Ie.min(),Ie.min(),cr.empty(),0)}static newFoundDocument(e,t,r,i){return new wn(e,1,t,Ie.min(),r,i,0)}static newNoDocument(e,t){return new wn(e,2,t,Ie.min(),Ie.min(),cr.empty(),0)}static newUnknownDocument(e,t){return new wn(e,3,t,Ie.min(),Ie.min(),cr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ie.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=cr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=cr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ie.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof wn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new wn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wg{constructor(e,t){this.position=e,this.inclusive=t}}function MT(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],o=n.position[i];if(s.field.isKeyField()?r=Se.comparator(Se.fromName(o.referenceValue),t.key):r=bu(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function OT(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ns(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd{constructor(e,t="asc"){this.field=e,this.dir=t}}function WM(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a9{}class Yt extends a9{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new $M(e,t,r):t==="array-contains"?new QM(e,r):t==="in"?new YM(e,r):t==="not-in"?new XM(e,r):t==="array-contains-any"?new JM(e,r):new Yt(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new qM(e,r):new KM(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(bu(t,this.value)):t!==null&&Za(this.value)===Za(t)&&this.matchesComparison(bu(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ce()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ki extends a9{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new ki(e,t)}matches(e){return l9(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function l9(n){return n.op==="and"}function u9(n){return HM(n)&&l9(n)}function HM(n){for(const e of n.filters)if(e instanceof ki)return!1;return!0}function rv(n){if(n instanceof Yt)return n.field.canonicalString()+n.op.toString()+Fu(n.value);if(u9(n))return n.filters.map(e=>rv(e)).join(",");{const e=n.filters.map(t=>rv(t)).join(",");return`${n.op}(${e})`}}function c9(n,e){return n instanceof Yt?function(r,i){return i instanceof Yt&&r.op===i.op&&r.field.isEqual(i.field)&&ns(r.value,i.value)}(n,e):n instanceof ki?function(r,i){return i instanceof ki&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,u)=>s&&c9(o,i.filters[u]),!0):!1}(n,e):void Ce()}function h9(n){return n instanceof Yt?function(t){return`${t.field.canonicalString()} ${t.op} ${Fu(t.value)}`}(n):n instanceof ki?function(t){return t.op.toString()+" {"+t.getFilters().map(h9).join(" ,")+"}"}(n):"Filter"}class $M extends Yt{constructor(e,t,r){super(e,t,r),this.key=Se.fromName(r.referenceValue)}matches(e){const t=Se.comparator(e.key,this.key);return this.matchesComparison(t)}}class qM extends Yt{constructor(e,t){super(e,"in",t),this.keys=d9("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class KM extends Yt{constructor(e,t){super(e,"not-in",t),this.keys=d9("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function d9(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>Se.fromName(r.referenceValue))}class QM extends Yt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return X2(t)&&fd(t.arrayValue,this.value)}}class YM extends Yt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&fd(this.value.arrayValue,t)}}class XM extends Yt{constructor(e,t){super(e,"not-in",t)}matches(e){if(fd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!fd(this.value.arrayValue,t)}}class JM extends Yt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!X2(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>fd(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZM{constructor(e,t=null,r=[],i=[],s=null,o=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=u,this.ue=null}}function LT(n,e=null,t=[],r=[],i=null,s=null,o=null){return new ZM(n,e,t,r,i,s,o)}function J2(n){const e=ke(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>rv(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Bd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Fu(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Fu(r)).join(",")),e.ue=t}return e.ue}function Z2(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!WM(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!c9(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!OT(n.startAt,e.startAt)&&OT(n.endAt,e.endAt)}function iv(n){return Se.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ec{constructor(e,t=null,r=[],i=[],s=null,o="F",u=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=u,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function eO(n,e,t,r,i,s,o,u){return new ec(n,e,t,r,i,s,o,u)}function ew(n){return new ec(n)}function bT(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function f9(n){return n.collectionGroup!==null}function Lh(n){const e=ke(n);if(e.ce===null){e.ce=[];const t=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let u=new Ln(Mn.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new pd(s,r))}),t.has(Mn.keyField().canonicalString())||e.ce.push(new pd(Mn.keyField(),r))}return e.ce}function ts(n){const e=ke(n);return e.le||(e.le=tO(e,Lh(n))),e.le}function tO(n,e){if(n.limitType==="F")return LT(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new pd(i.field,s)});const t=n.endAt?new Wg(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Wg(n.startAt.position,n.startAt.inclusive):null;return LT(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function sv(n,e){const t=n.filters.concat([e]);return new ec(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function ov(n,e,t){return new ec(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Om(n,e){return Z2(ts(n),ts(e))&&n.limitType===e.limitType}function p9(n){return`${J2(ts(n))}|lt:${n.limitType}`}function Yl(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>h9(i)).join(", ")}]`),Bd(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Fu(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Fu(i)).join(",")),`Target(${r})`}(ts(n))}; limitType=${n.limitType})`}function Lm(n,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):Se.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(const s of Lh(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,u,c){const d=MT(o,u,c);return o.inclusive?d<=0:d<0}(r.startAt,Lh(r),i)||r.endAt&&!function(o,u,c){const d=MT(o,u,c);return o.inclusive?d>=0:d>0}(r.endAt,Lh(r),i))}(n,e)}function nO(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function g9(n){return(e,t)=>{let r=!1;for(const i of Lh(n)){const s=rO(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function rO(n,e,t){const r=n.field.isKeyField()?Se.comparator(e.key,t.key):function(s,o,u){const c=o.data.field(s),d=u.data.field(s);return c!==null&&d!==null?bu(c,d):Ce()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Ce()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ll(this.inner,(t,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return i9(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iO=new Xt(Se.comparator);function Hs(){return iO}const m9=new Xt(Se.comparator);function wh(...n){let e=m9;for(const t of n)e=e.insert(t.key,t);return e}function _9(n){let e=m9;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Va(){return bh()}function y9(){return bh()}function bh(){return new tc(n=>n.toString(),(n,e)=>n.isEqual(e))}const sO=new Xt(Se.comparator),oO=new Ln(Se.comparator);function Be(...n){let e=oO;for(const t of n)e=e.add(t);return e}const aO=new Ln(tt);function lO(){return aO}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tw(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:jg(e)?"-0":e}}function v9(n){return{integerValue:""+n}}function uO(n,e){return UM(e)?v9(e):tw(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bm{constructor(){this._=void 0}}function cO(n,e,t){return n instanceof gd?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Q2(s)&&(s=Y2(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof md?S9(n,e):n instanceof _d?E9(n,e):function(i,s){const o=w9(i,s),u=FT(o)+FT(i.Pe);return nv(o)&&nv(i.Pe)?v9(u):tw(i.serializer,u)}(n,e)}function hO(n,e,t){return n instanceof md?S9(n,e):n instanceof _d?E9(n,e):t}function w9(n,e){return n instanceof Hg?function(r){return nv(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class gd extends bm{}class md extends bm{constructor(e){super(),this.elements=e}}function S9(n,e){const t=T9(e);for(const r of n.elements)t.some(i=>ns(i,r))||t.push(r);return{arrayValue:{values:t}}}class _d extends bm{constructor(e){super(),this.elements=e}}function E9(n,e){let t=T9(e);for(const r of n.elements)t=t.filter(i=>!ns(i,r));return{arrayValue:{values:t}}}class Hg extends bm{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function FT(n){return Gt(n.integerValue||n.doubleValue)}function T9(n){return X2(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dO{constructor(e,t){this.field=e,this.transform=t}}function fO(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof md&&i instanceof md||r instanceof _d&&i instanceof _d?Lu(r.elements,i.elements,ns):r instanceof Hg&&i instanceof Hg?ns(r.Pe,i.Pe):r instanceof gd&&i instanceof gd}(n.transform,e.transform)}class pO{constructor(e,t){this.version=e,this.transformResults=t}}class hr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new hr}static exists(e){return new hr(void 0,e)}static updateTime(e){return new hr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function rg(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Fm{}function C9(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new nw(n.key,hr.none()):new Gd(n.key,n.data,hr.none());{const t=n.data,r=cr.empty();let i=new Ln(Mn.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new ra(n.key,r,new Or(i.toArray()),hr.none())}}function gO(n,e,t){n instanceof Gd?function(i,s,o){const u=i.value.clone(),c=UT(i.fieldTransforms,s,o.transformResults);u.setAll(c),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(n,e,t):n instanceof ra?function(i,s,o){if(!rg(i.precondition,s))return void s.convertToUnknownDocument(o.version);const u=UT(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(I9(i)),c.setAll(u),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Fh(n,e,t,r){return n instanceof Gd?function(s,o,u,c){if(!rg(s.precondition,o))return u;const d=s.value.clone(),p=zT(s.fieldTransforms,c,o);return d.setAll(p),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(n,e,t,r):n instanceof ra?function(s,o,u,c){if(!rg(s.precondition,o))return u;const d=zT(s.fieldTransforms,c,o),p=o.data;return p.setAll(I9(s)),p.setAll(d),o.convertToFoundDocument(o.version,p).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(m=>m.field))}(n,e,t,r):function(s,o,u){return rg(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):u}(n,e,t)}function mO(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=w9(r.transform,i||null);s!=null&&(t===null&&(t=cr.empty()),t.set(r.field,s))}return t||null}function VT(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Lu(r,i,(s,o)=>fO(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Gd extends Fm{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ra extends Fm{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function I9(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function UT(n,e,t){const r=new Map;Je(n.length===t.length);for(let i=0;i<t.length;i++){const s=n[i],o=s.transform,u=e.data.field(s.field);r.set(s.field,hO(o,u,t[i]))}return r}function zT(n,e,t){const r=new Map;for(const i of n){const s=i.transform,o=t.data.field(i.field);r.set(i.field,cO(s,o,e))}return r}class nw extends Fm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class P9 extends Fm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _O{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&gO(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Fh(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Fh(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=y9();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let u=this.applyToLocalView(o,s.mutatedFields);u=t.has(i.key)?null:u;const c=C9(o,u);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(Ie.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Be())}isEqual(e){return this.batchId===e.batchId&&Lu(this.mutations,e.mutations,(t,r)=>VT(t,r))&&Lu(this.baseMutations,e.baseMutations,(t,r)=>VT(t,r))}}class rw{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Je(e.mutations.length===r.length);let i=function(){return sO}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new rw(e,t,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yO{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vO{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Kt,Ke;function R9(n){switch(n){default:return Ce();case Z.CANCELLED:case Z.UNKNOWN:case Z.DEADLINE_EXCEEDED:case Z.RESOURCE_EXHAUSTED:case Z.INTERNAL:case Z.UNAVAILABLE:case Z.UNAUTHENTICATED:return!1;case Z.INVALID_ARGUMENT:case Z.NOT_FOUND:case Z.ALREADY_EXISTS:case Z.PERMISSION_DENIED:case Z.FAILED_PRECONDITION:case Z.ABORTED:case Z.OUT_OF_RANGE:case Z.UNIMPLEMENTED:case Z.DATA_LOSS:return!0}}function A9(n){if(n===void 0)return Ws("GRPC error has no .code"),Z.UNKNOWN;switch(n){case Kt.OK:return Z.OK;case Kt.CANCELLED:return Z.CANCELLED;case Kt.UNKNOWN:return Z.UNKNOWN;case Kt.DEADLINE_EXCEEDED:return Z.DEADLINE_EXCEEDED;case Kt.RESOURCE_EXHAUSTED:return Z.RESOURCE_EXHAUSTED;case Kt.INTERNAL:return Z.INTERNAL;case Kt.UNAVAILABLE:return Z.UNAVAILABLE;case Kt.UNAUTHENTICATED:return Z.UNAUTHENTICATED;case Kt.INVALID_ARGUMENT:return Z.INVALID_ARGUMENT;case Kt.NOT_FOUND:return Z.NOT_FOUND;case Kt.ALREADY_EXISTS:return Z.ALREADY_EXISTS;case Kt.PERMISSION_DENIED:return Z.PERMISSION_DENIED;case Kt.FAILED_PRECONDITION:return Z.FAILED_PRECONDITION;case Kt.ABORTED:return Z.ABORTED;case Kt.OUT_OF_RANGE:return Z.OUT_OF_RANGE;case Kt.UNIMPLEMENTED:return Z.UNIMPLEMENTED;case Kt.DATA_LOSS:return Z.DATA_LOSS;default:return Ce()}}(Ke=Kt||(Kt={}))[Ke.OK=0]="OK",Ke[Ke.CANCELLED=1]="CANCELLED",Ke[Ke.UNKNOWN=2]="UNKNOWN",Ke[Ke.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ke[Ke.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ke[Ke.NOT_FOUND=5]="NOT_FOUND",Ke[Ke.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ke[Ke.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ke[Ke.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ke[Ke.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ke[Ke.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ke[Ke.ABORTED=10]="ABORTED",Ke[Ke.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ke[Ke.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ke[Ke.INTERNAL=13]="INTERNAL",Ke[Ke.UNAVAILABLE=14]="UNAVAILABLE",Ke[Ke.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wO(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SO=new Ga([4294967295,4294967295],0);function BT(n){const e=wO().encode(n),t=new Y6;return t.update(e),new Uint8Array(t.digest())}function GT(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ga([t,r],0),new Ga([i,s],0)]}class iw{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Sh(`Invalid padding: ${t}`);if(r<0)throw new Sh(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Sh(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Sh(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Ga.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(Ga.fromNumber(r)));return i.compare(SO)===1&&(i=new Ga([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=BT(e),[r,i]=GT(t);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new iw(s,i,t);return r.forEach(u=>o.insert(u)),o}insert(e){if(this.Ie===0)return;const t=BT(e),[r,i]=GT(t);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Sh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vm{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,jd.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Vm(Ie.min(),i,new Xt(tt),Hs(),Be())}}class jd{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new jd(r,t,Be(),Be(),Be())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ig{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}}class k9{constructor(e,t){this.targetId=e,this.me=t}}class x9{constructor(e,t,r=Fn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class jT{constructor(){this.fe=0,this.ge=HT(),this.pe=Fn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Be(),t=Be(),r=Be();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Ce()}}),new jd(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=HT()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Je(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class EO{constructor(e){this.Le=e,this.Be=new Map,this.ke=Hs(),this.qe=WT(),this.Qe=new Xt(tt)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:Ce()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){const t=e.targetId,r=e.me.count,i=this.Je(t);if(i){const s=i.target;if(iv(s))if(r===0){const o=new Se(s.path);this.Ue(t,o,wn.newNoDocument(o,Ie.min()))}else Je(r===1);else{const o=this.Ye(t);if(o!==r){const u=this.Ze(e),c=u?this.Xe(u,e,o):1;if(c!==0){this.je(t);const d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,d)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let o,u;try{o=Ja(r).toUint8Array()}catch(c){if(c instanceof s9)return Ou("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{u=new iw(o,i,s)}catch(c){return Ou(c instanceof Sh?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return u.Ie===0?null:u}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let i=0;return r.forEach(s=>{const o=this.Le.tt(),u=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(u)||(this.Ue(t,s,null),i++)}),i}rt(e){const t=new Map;this.Be.forEach((s,o)=>{const u=this.Je(o);if(u){if(s.current&&iv(u.target)){const c=new Se(u.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,wn.newNoDocument(c,e))}s.be&&(t.set(o,s.ve()),s.Ce())}});let r=Be();this.qe.forEach((s,o)=>{let u=!0;o.forEachWhile(c=>{const d=this.Je(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new Vm(e,t,this.Qe,this.ke,r);return this.ke=Hs(),this.qe=WT(),this.Qe=new Xt(tt),i}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new jT,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Ln(tt),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||ye("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new jT),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function WT(){return new Xt(Se.comparator)}function HT(){return new Xt(Se.comparator)}const TO={asc:"ASCENDING",desc:"DESCENDING"},CO={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},IO={and:"AND",or:"OR"};class PO{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function av(n,e){return n.useProto3Json||Bd(e)?e:{value:e}}function $g(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function N9(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function RO(n,e){return $g(n,e.toTimestamp())}function br(n){return Je(!!n),Ie.fromTimestamp(function(t){const r=qo(t);return new an(r.seconds,r.nanos)}(n))}function sw(n,e){return lv(n,e).canonicalString()}function lv(n,e){const t=function(i){return new yt(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function D9(n){const e=yt.fromString(n);return Je(V9(e)),e}function qg(n,e){return sw(n.databaseId,e.path)}function Vh(n,e){const t=D9(e);if(t.get(1)!==n.databaseId.projectId)throw new fe(Z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new fe(Z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Se(O9(t))}function M9(n,e){return sw(n.databaseId,e)}function AO(n){const e=D9(n);return e.length===4?yt.emptyPath():O9(e)}function uv(n){return new yt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function O9(n){return Je(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function $T(n,e,t){return{name:qg(n,e),fields:t.value.mapValue.fields}}function kO(n,e){return"found"in e?function(r,i){Je(!!i.found),i.found.name,i.found.updateTime;const s=Vh(r,i.found.name),o=br(i.found.updateTime),u=i.found.createTime?br(i.found.createTime):Ie.min(),c=new cr({mapValue:{fields:i.found.fields}});return wn.newFoundDocument(s,o,u,c)}(n,e):"missing"in e?function(r,i){Je(!!i.missing),Je(!!i.readTime);const s=Vh(r,i.missing),o=br(i.readTime);return wn.newNoDocument(s,o)}(n,e):Ce()}function xO(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Ce()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(d,p){return d.useProto3Json?(Je(p===void 0||typeof p=="string"),Fn.fromBase64String(p||"")):(Je(p===void 0||p instanceof Buffer||p instanceof Uint8Array),Fn.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,u=o&&function(d){const p=d.code===void 0?Z.UNKNOWN:A9(d.code);return new fe(p,d.message||"")}(o);t=new x9(r,i,s,u||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Vh(n,r.document.name),s=br(r.document.updateTime),o=r.document.createTime?br(r.document.createTime):Ie.min(),u=new cr({mapValue:{fields:r.document.fields}}),c=wn.newFoundDocument(i,s,o,u),d=r.targetIds||[],p=r.removedTargetIds||[];t=new ig(d,p,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Vh(n,r.document),s=r.readTime?br(r.readTime):Ie.min(),o=wn.newNoDocument(i,s),u=r.removedTargetIds||[];t=new ig([],u,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Vh(n,r.document),s=r.removedTargetIds||[];t=new ig([],s,i,null)}else{if(!("filter"in e))return Ce();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new vO(i,s),u=r.targetId;t=new k9(u,o)}}return t}function L9(n,e){let t;if(e instanceof Gd)t={update:$T(n,e.key,e.value)};else if(e instanceof nw)t={delete:qg(n,e.key)};else if(e instanceof ra)t={update:$T(n,e.key,e.data),updateMask:UO(e.fieldMask)};else{if(!(e instanceof P9))return Ce();t={verify:qg(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const u=o.transform;if(u instanceof gd)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof md)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof _d)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Hg)return{fieldPath:o.field.canonicalString(),increment:u.Pe};throw Ce()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:RO(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ce()}(n,e.precondition)),t}function NO(n,e){return n&&n.length>0?(Je(e!==void 0),n.map(t=>function(i,s){let o=i.updateTime?br(i.updateTime):br(s);return o.isEqual(Ie.min())&&(o=br(s)),new pO(o,i.transformResults||[])}(t,e))):[]}function DO(n,e){return{documents:[M9(n,e.path)]}}function MO(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=M9(n,i);const s=function(d){if(d.length!==0)return F9(ki.create(d,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const o=function(d){if(d.length!==0)return d.map(p=>function(y){return{field:Xl(y.field),direction:bO(y.dir)}}(p))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const u=av(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:t,parent:i}}function OO(n){let e=AO(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Je(r===1);const p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];t.where&&(s=function(m){const y=b9(m);return y instanceof ki&&u9(y)?y.getFilters():[y]}(t.where));let o=[];t.orderBy&&(o=function(m){return m.map(y=>function(S){return new pd(Jl(S.field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(S.direction))}(y))}(t.orderBy));let u=null;t.limit&&(u=function(m){let y;return y=typeof m=="object"?m.value:m,Bd(y)?null:y}(t.limit));let c=null;t.startAt&&(c=function(m){const y=!!m.before,E=m.values||[];return new Wg(E,y)}(t.startAt));let d=null;return t.endAt&&(d=function(m){const y=!m.before,E=m.values||[];return new Wg(E,y)}(t.endAt)),eO(e,i,o,s,u,"F",c,d)}function LO(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ce()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function b9(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Jl(t.unaryFilter.field);return Yt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Jl(t.unaryFilter.field);return Yt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Jl(t.unaryFilter.field);return Yt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Jl(t.unaryFilter.field);return Yt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Ce()}}(n):n.fieldFilter!==void 0?function(t){return Yt.create(Jl(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ce()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return ki.create(t.compositeFilter.filters.map(r=>b9(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ce()}}(t.compositeFilter.op))}(n):Ce()}function bO(n){return TO[n]}function FO(n){return CO[n]}function VO(n){return IO[n]}function Xl(n){return{fieldPath:n.canonicalString()}}function Jl(n){return Mn.fromServerFormat(n.fieldPath)}function F9(n){return n instanceof Yt?function(t){if(t.op==="=="){if(DT(t.value))return{unaryFilter:{field:Xl(t.field),op:"IS_NAN"}};if(NT(t.value))return{unaryFilter:{field:Xl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(DT(t.value))return{unaryFilter:{field:Xl(t.field),op:"IS_NOT_NAN"}};if(NT(t.value))return{unaryFilter:{field:Xl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Xl(t.field),op:FO(t.op),value:t.value}}}(n):n instanceof ki?function(t){const r=t.getFilters().map(i=>F9(i));return r.length===1?r[0]:{compositeFilter:{op:VO(t.op),filters:r}}}(n):Ce()}function UO(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function V9(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{constructor(e,t,r,i,s=Ie.min(),o=Ie.min(),u=Fn.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u,this.expectedCount=c}withSequenceNumber(e){return new Ao(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ao(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ao(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ao(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zO{constructor(e){this.ct=e}}function BO(n){const e=OO({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?ov(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GO{constructor(){this.un=new jO}addToCollectionParentIndex(e,t){return this.un.add(t),ne.resolve()}getCollectionParents(e,t){return ne.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return ne.resolve()}deleteFieldIndex(e,t){return ne.resolve()}deleteAllFieldIndexes(e){return ne.resolve()}createTargetIndexes(e,t){return ne.resolve()}getDocumentsMatchingTarget(e,t){return ne.resolve(null)}getIndexType(e,t){return ne.resolve(0)}getFieldIndexes(e,t){return ne.resolve([])}getNextCollectionGroupToUpdate(e){return ne.resolve(null)}getMinOffset(e,t){return ne.resolve($o.min())}getMinOffsetFromCollectionGroup(e,t){return ne.resolve($o.min())}updateCollectionGroup(e,t,r){return ne.resolve()}updateIndexEntries(e,t){return ne.resolve()}}class jO{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Ln(yt.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ln(yt.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Vu(0)}static kn(){return new Vu(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WO{constructor(){this.changes=new tc(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,wn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?ne.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HO{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $O{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Fh(r.mutation,i,Or.empty(),an.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Be()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Be()){const i=Va();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=wh();return s.forEach((u,c)=>{o=o.insert(u,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=Va();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Be()))}populateOverlays(e,t,r){const i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,u)=>{t.set(o,u)})})}computeViews(e,t,r,i){let s=Hs();const o=bh(),u=function(){return bh()}();return t.forEach((c,d)=>{const p=r.get(d.key);i.has(d.key)&&(p===void 0||p.mutation instanceof ra)?s=s.insert(d.key,d):p!==void 0?(o.set(d.key,p.mutation.getFieldMask()),Fh(p.mutation,d,p.mutation.getFieldMask(),an.now())):o.set(d.key,Or.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((d,p)=>o.set(d,p)),t.forEach((d,p)=>{var m;return u.set(d,new HO(p,(m=o.get(d))!==null&&m!==void 0?m:null))}),u))}recalculateAndSaveOverlays(e,t){const r=bh();let i=new Xt((o,u)=>o-u),s=Be();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const u of o)u.keys().forEach(c=>{const d=t.get(c);if(d===null)return;let p=r.get(c)||Or.empty();p=u.applyToLocalView(d,p),r.set(c,p);const m=(i.get(u.batchId)||Be()).add(c);i=i.insert(u.batchId,m)})}).next(()=>{const o=[],u=i.getReverseIterator();for(;u.hasNext();){const c=u.getNext(),d=c.key,p=c.value,m=y9();p.forEach(y=>{if(!s.has(y)){const E=C9(t.get(y),r.get(y));E!==null&&m.set(y,E),s=s.add(y)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,m))}return ne.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return Se.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):f9(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):ne.resolve(Va());let u=-1,c=s;return o.next(d=>ne.forEach(d,(p,m)=>(u<m.largestBatchId&&(u=m.largestBatchId),s.get(p)?ne.resolve():this.remoteDocumentCache.getEntry(e,p).next(y=>{c=c.insert(p,y)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,c,d,Be())).next(p=>({batchId:u,changes:_9(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Se(t)).next(r=>{let i=wh();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let o=wh();return this.indexManager.getCollectionParents(e,s).next(u=>ne.forEach(u,c=>{const d=function(m,y){return new ec(y,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(p=>{p.forEach((m,y)=>{o=o.insert(m,y)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((c,d)=>{const p=d.getKey();o.get(p)===null&&(o=o.insert(p,wn.newInvalidDocument(p)))});let u=wh();return o.forEach((c,d)=>{const p=s.get(c);p!==void 0&&Fh(p.mutation,d,Or.empty(),an.now()),Lm(t,d)&&(u=u.insert(c,d))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qO{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return ne.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:br(i.createTime)}}(t)),ne.resolve()}getNamedQuery(e,t){return ne.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:BO(i.bundledQuery),readTime:br(i.readTime)}}(t)),ne.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KO{constructor(){this.overlays=new Xt(Se.comparator),this.Ir=new Map}getOverlay(e,t){return ne.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Va();return ne.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),ne.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),ne.resolve()}getOverlaysForCollection(e,t,r){const i=Va(),s=t.length+1,o=new Se(t.child("")),u=this.overlays.getIteratorFrom(o);for(;u.hasNext();){const c=u.getNext().value,d=c.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return ne.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Xt((d,p)=>d-p);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let p=s.get(d.largestBatchId);p===null&&(p=Va(),s=s.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}const u=Va(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,p)=>u.set(d,p)),!(u.size()>=i)););return ne.resolve(u)}ht(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new yO(t,r));let s=this.Ir.get(t);s===void 0&&(s=Be(),this.Ir.set(t,s)),this.Ir.set(t,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QO{constructor(){this.sessionToken=Fn.EMPTY_BYTE_STRING}getSessionToken(e){return ne.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ne.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ow{constructor(){this.Tr=new Ln(_n.Er),this.dr=new Ln(_n.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const r=new _n(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new _n(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){const t=new Se(new yt([])),r=new _n(t,e),i=new _n(t,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new Se(new yt([])),r=new _n(t,e),i=new _n(t,e+1);let s=Be();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new _n(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class _n{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return Se.comparator(e.key,t.key)||tt(e.wr,t.wr)}static Ar(e,t){return tt(e.wr,t.wr)||Se.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YO{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Ln(_n.Er)}checkEmpty(e){return ne.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new _O(s,t,r,i);this.mutationQueue.push(o);for(const u of i)this.br=this.br.add(new _n(u.key,s)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return ne.resolve(o)}lookupMutationBatch(e,t){return ne.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.vr(r),s=i<0?0:i;return ne.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ne.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return ne.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new _n(t,0),i=new _n(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{const u=this.Dr(o.wr);s.push(u)}),ne.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ln(tt);return t.forEach(i=>{const s=new _n(i,0),o=new _n(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],u=>{r=r.add(u.wr)})}),ne.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;Se.isDocumentKey(s)||(s=s.child(""));const o=new _n(new Se(s),0);let u=new Ln(tt);return this.br.forEachWhile(c=>{const d=c.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(u=u.add(c.wr)),!0)},o),ne.resolve(this.Cr(u))}Cr(e){const t=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){Je(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return ne.forEach(t.mutations,i=>{const s=new _n(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){const r=new _n(t,0),i=this.br.firstAfterOrEqual(r);return ne.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ne.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XO{constructor(e){this.Mr=e,this.docs=function(){return new Xt(Se.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return ne.resolve(r?r.document.mutableCopy():wn.newInvalidDocument(t))}getEntries(e,t){let r=Hs();return t.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():wn.newInvalidDocument(i))}),ne.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Hs();const o=t.path,u=new Se(o.child("")),c=this.docs.getIteratorFrom(u);for(;c.hasNext();){const{key:d,value:{document:p}}=c.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||LM(OM(p),r)<=0||(i.has(p.key)||Lm(t,p))&&(s=s.insert(p.key,p.mutableCopy()))}return ne.resolve(s)}getAllFromCollectionGroup(e,t,r,i){Ce()}Or(e,t){return ne.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new JO(this)}getSize(e){return ne.resolve(this.size)}}class JO extends WO{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),ne.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZO{constructor(e){this.persistence=e,this.Nr=new tc(t=>J2(t),Z2),this.lastRemoteSnapshotVersion=Ie.min(),this.highestTargetId=0,this.Lr=0,this.Br=new ow,this.targetCount=0,this.kr=Vu.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),ne.resolve()}getLastRemoteSnapshotVersion(e){return ne.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ne.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),ne.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),ne.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new Vu(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,ne.resolve()}updateTargetData(e,t){return this.Kn(t),ne.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,ne.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.Nr.forEach((o,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),ne.waitFor(s).next(()=>i)}getTargetCount(e){return ne.resolve(this.targetCount)}getTargetData(e,t){const r=this.Nr.get(t)||null;return ne.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),ne.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),ne.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),ne.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Br.yr(t);return ne.resolve(r)}containsKey(e,t){return ne.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL{constructor(e,t){this.qr={},this.overlays={},this.Qr=new K2(0),this.Kr=!1,this.Kr=!0,this.$r=new QO,this.referenceDelegate=e(this),this.Ur=new ZO(this),this.indexManager=new GO,this.remoteDocumentCache=function(i){return new XO(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new zO(t),this.Gr=new qO(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new KO,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new YO(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){ye("MemoryPersistence","Starting transaction:",e);const i=new tL(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,t){return ne.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}}class tL extends FM{constructor(e){super(),this.currentSequenceNumber=e}}class aw{constructor(e){this.persistence=e,this.Jr=new ow,this.Yr=null}static Zr(e){return new aw(e)}get Xr(){if(this.Yr)return this.Yr;throw Ce()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),ne.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),ne.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),ne.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ne.forEach(this.Xr,r=>{const i=Se.fromPath(r);return this.ei(e,i).next(s=>{s||t.removeEntry(i,Ie.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return ne.or([()=>ne.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lw{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=Be(),i=Be();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new lw(e,t.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nL{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rL{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return Bx()?8:VM(nr())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.Yi(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new nL;return this.Xi(e,t,o).next(u=>{if(s.result=u,this.zi)return this.es(e,t,o,u.size)})}).next(()=>s.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(nh()<=ze.DEBUG&&ye("QueryEngine","SDK will not create cache indexes for query:",Yl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),ne.resolve()):(nh()<=ze.DEBUG&&ye("QueryEngine","Query:",Yl(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(nh()<=ze.DEBUG&&ye("QueryEngine","The SDK decides to create cache indexes for query:",Yl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ts(t))):ne.resolve())}Yi(e,t){if(bT(t))return ne.resolve(null);let r=ts(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=ov(t,null,"F"),r=ts(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Be(...s);return this.Ji.getDocuments(e,o).next(u=>this.indexManager.getMinOffset(e,r).next(c=>{const d=this.ts(t,u);return this.ns(t,d,o,c.readTime)?this.Yi(e,ov(t,null,"F")):this.rs(e,d,t,c)}))})))}Zi(e,t,r,i){return bT(t)||i.isEqual(Ie.min())?ne.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const o=this.ts(t,s);return this.ns(t,o,r,i)?ne.resolve(null):(nh()<=ze.DEBUG&&ye("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Yl(t)),this.rs(e,o,t,MM(i,-1)).next(u=>u))})}ts(e,t){let r=new Ln(g9(e));return t.forEach((i,s)=>{Lm(e,s)&&(r=r.add(s))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,t,r){return nh()<=ze.DEBUG&&ye("QueryEngine","Using full collection scan to execute query:",Yl(t)),this.Ji.getDocumentsMatchingQuery(e,t,$o.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iL{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new Xt(tt),this._s=new tc(s=>J2(s),Z2),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new $O(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function sL(n,e,t,r){return new iL(n,e,t,r)}async function U9(n,e){const t=ke(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],u=[];let c=Be();for(const d of i){o.push(d.batchId);for(const p of d.mutations)c=c.add(p.key)}for(const d of s){u.push(d.batchId);for(const p of d.mutations)c=c.add(p.key)}return t.localDocuments.getDocuments(r,c).next(d=>({hs:d,removedBatchIds:o,addedBatchIds:u}))})})}function oL(n,e){const t=ke(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(u,c,d,p){const m=d.batch,y=m.keys();let E=ne.resolve();return y.forEach(S=>{E=E.next(()=>p.getEntry(c,S)).next(x=>{const D=d.docVersions.get(S);Je(D!==null),x.version.compareTo(D)<0&&(m.applyToRemoteDocument(x,d),x.isValidDocument()&&(x.setReadTime(d.commitVersion),p.addEntry(x)))})}),E.next(()=>u.mutationQueue.removeMutationBatch(c,m))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let c=Be();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(c=c.add(u.batch.mutations[d].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function z9(n){const e=ke(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function aL(n,e){const t=ke(n),r=e.snapshotVersion;let i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;const u=[];e.targetChanges.forEach((p,m)=>{const y=i.get(m);if(!y)return;u.push(t.Ur.removeMatchingKeys(s,p.removedDocuments,m).next(()=>t.Ur.addMatchingKeys(s,p.addedDocuments,m)));let E=y.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?E=E.withResumeToken(Fn.EMPTY_BYTE_STRING,Ie.min()).withLastLimboFreeSnapshotVersion(Ie.min()):p.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(p.resumeToken,r)),i=i.insert(m,E),function(x,D,k){return x.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(y,E,p)&&u.push(t.Ur.updateTargetData(s,E))});let c=Hs(),d=Be();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(s,p))}),u.push(lL(s,o,e.documentUpdates).next(p=>{c=p.Ps,d=p.Is})),!r.isEqual(Ie.min())){const p=t.Ur.getLastRemoteSnapshotVersion(s).next(m=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));u.push(p)}return ne.waitFor(u).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,d)).next(()=>c)}).then(s=>(t.os=i,s))}function lL(n,e,t){let r=Be(),i=Be();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=Hs();return t.forEach((u,c)=>{const d=s.get(u);c.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(u)),c.isNoDocument()&&c.version.isEqual(Ie.min())?(e.removeEntry(u,c.readTime),o=o.insert(u,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),o=o.insert(u,c)):ye("LocalStore","Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",c.version)}),{Ps:o,Is:i}})}function uL(n,e){const t=ke(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function cL(n,e){const t=ke(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(s=>s?(i=s,ne.resolve(i)):t.Ur.allocateTargetId(r).next(o=>(i=new Ao(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}async function cv(n,e,t){const r=ke(n),i=r.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!zd(o))throw o;ye("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function qT(n,e,t){const r=ke(n);let i=Ie.min(),s=Be();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,d,p){const m=ke(c),y=m._s.get(p);return y!==void 0?ne.resolve(m.os.get(y)):m.Ur.getTargetData(d,p)}(r,o,ts(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,u.targetId).next(c=>{s=c})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?i:Ie.min(),t?s:Be())).next(u=>(hL(r,nO(e),u),{documents:u,Ts:s})))}function hL(n,e,t){let r=n.us.get(e)||Ie.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.us.set(e,r)}class KT{constructor(){this.activeTargetIds=lO()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class dL{constructor(){this.so=new KT,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new KT,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fL{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QT{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){ye("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){ye("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xp=null;function Py(){return xp===null?xp=function(){return 268435456+Math.round(2147483648*Math.random())}():xp++,"0x"+xp.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gL{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kn="WebChannelConnection";class mL extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(t,r,i,s,o){const u=Py(),c=this.xo(t,r.toUriEncodedString());ye("RestConnection",`Sending RPC '${t}' ${u}:`,c,i);const d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,s,o),this.No(t,c,d,i).then(p=>(ye("RestConnection",`Received RPC '${t}' ${u}: `,p),p),p=>{throw Ou("RestConnection",`RPC '${t}' ${u} failed with error: `,p,"url: ",c,"request:",i),p})}Lo(t,r,i,s,o,u){return this.Mo(t,r,i,s,o)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Zu}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}xo(t,r){const i=pL[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){const s=Py();return new Promise((o,u)=>{const c=new X6;c.setWithCredentials(!0),c.listenOnce(J6.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case tg.NO_ERROR:const p=c.getResponseJson();ye(Kn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(p)),o(p);break;case tg.TIMEOUT:ye(Kn,`RPC '${e}' ${s} timed out`),u(new fe(Z.DEADLINE_EXCEEDED,"Request time out"));break;case tg.HTTP_ERROR:const m=c.getStatus();if(ye(Kn,`RPC '${e}' ${s} failed with status:`,m,"response text:",c.getResponseText()),m>0){let y=c.getResponseJson();Array.isArray(y)&&(y=y[0]);const E=y==null?void 0:y.error;if(E&&E.status&&E.message){const S=function(D){const k=D.toLowerCase().replace(/_/g,"-");return Object.values(Z).indexOf(k)>=0?k:Z.UNKNOWN}(E.status);u(new fe(S,E.message))}else u(new fe(Z.UNKNOWN,"Server responded with status "+c.getStatus()))}else u(new fe(Z.UNAVAILABLE,"Connection failed."));break;default:Ce()}}finally{ye(Kn,`RPC '${e}' ${s} completed.`)}});const d=JSON.stringify(i);ye(Kn,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",d,r,15)})}Bo(e,t,r){const i=Py(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=t9(),u=e9(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;const p=s.join("");ye(Kn,`Creating RPC '${e}' stream ${i}: ${p}`,c);const m=o.createWebChannel(p,c);let y=!1,E=!1;const S=new gL({Io:D=>{E?ye(Kn,`Not sending because RPC '${e}' stream ${i} is closed:`,D):(y||(ye(Kn,`Opening RPC '${e}' stream ${i} transport.`),m.open(),y=!0),ye(Kn,`RPC '${e}' stream ${i} sending:`,D),m.send(D))},To:()=>m.close()}),x=(D,k,R)=>{D.listen(k,w=>{try{R(w)}catch(P){setTimeout(()=>{throw P},0)}})};return x(m,vh.EventType.OPEN,()=>{E||(ye(Kn,`RPC '${e}' stream ${i} transport opened.`),S.yo())}),x(m,vh.EventType.CLOSE,()=>{E||(E=!0,ye(Kn,`RPC '${e}' stream ${i} transport closed`),S.So())}),x(m,vh.EventType.ERROR,D=>{E||(E=!0,Ou(Kn,`RPC '${e}' stream ${i} transport errored:`,D),S.So(new fe(Z.UNAVAILABLE,"The operation could not be completed")))}),x(m,vh.EventType.MESSAGE,D=>{var k;if(!E){const R=D.data[0];Je(!!R);const w=R,P=w.error||((k=w[0])===null||k===void 0?void 0:k.error);if(P){ye(Kn,`RPC '${e}' stream ${i} received error:`,P);const V=P.status;let z=function(N){const A=Kt[N];if(A!==void 0)return A9(A)}(V),M=P.message;z===void 0&&(z=Z.INTERNAL,M="Unknown error status: "+V+" with message "+P.message),E=!0,S.So(new fe(z,M)),m.close()}else ye(Kn,`RPC '${e}' stream ${i} received:`,R),S.bo(R)}}),x(u,Z6.STAT_EVENT,D=>{D.stat===Z1.PROXY?ye(Kn,`RPC '${e}' stream ${i} detected buffering proxy`):D.stat===Z1.NOPROXY&&ye(Kn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{S.wo()},0),S}}function Ry(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Um(n){return new PO(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uw{constructor(e,t,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&ye("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B9{constructor(e,t,r,i,s,o,u,c){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new uw(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===Z.RESOURCE_EXHAUSTED?(Ws(t.toString()),Ws("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===Z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{const i=new fe(Z.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){const r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return ye("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(ye("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class _L extends B9{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=xO(this.serializer,e),r=function(s){if(!("targetChange"in s))return Ie.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Ie.min():o.readTime?br(o.readTime):Ie.min()}(e);return this.listener.d_(t,r)}A_(e){const t={};t.database=uv(this.serializer),t.addTarget=function(s,o){let u;const c=o.target;if(u=iv(c)?{documents:DO(s,c)}:{query:MO(s,c)._t},u.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){u.resumeToken=N9(s,o.resumeToken);const d=av(s,o.expectedCount);d!==null&&(u.expectedCount=d)}else if(o.snapshotVersion.compareTo(Ie.min())>0){u.readTime=$g(s,o.snapshotVersion.toTimestamp());const d=av(s,o.expectedCount);d!==null&&(u.expectedCount=d)}return u}(this.serializer,e);const r=LO(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){const t={};t.database=uv(this.serializer),t.removeTarget=e,this.a_(t)}}class yL extends B9{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Je(!!e.streamToken),this.lastStreamToken=e.streamToken,Je(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Je(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=NO(e.writeResults,e.commitTime),r=br(e.commitTime);return this.listener.g_(r,t)}p_(){const e={};e.database=uv(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>L9(this.serializer,r))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vL extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new fe(Z.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,lv(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new fe(Z.UNKNOWN,s.toString())})}Lo(e,t,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,u])=>this.connection.Lo(e,lv(t,r),i,o,u,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new fe(Z.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class wL{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Ws(t),this.D_=!1):ye("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SL{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(async()=>{ul(this)&&(ye("RemoteStore","Restarting streams for network reachability change."),await async function(c){const d=ke(c);d.L_.add(4),await Wd(d),d.q_.set("Unknown"),d.L_.delete(4),await zm(d)}(this))})}),this.q_=new wL(r,i)}}async function zm(n){if(ul(n))for(const e of n.B_)await e(!0)}async function Wd(n){for(const e of n.B_)await e(!1)}function G9(n,e){const t=ke(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),fw(t)?dw(t):nc(t).r_()&&hw(t,e))}function cw(n,e){const t=ke(n),r=nc(t);t.N_.delete(e),r.r_()&&j9(t,e),t.N_.size===0&&(r.r_()?r.o_():ul(t)&&t.q_.set("Unknown"))}function hw(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ie.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}nc(n).A_(e)}function j9(n,e){n.Q_.xe(e),nc(n).R_(e)}function dw(n){n.Q_=new EO({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),nc(n).start(),n.q_.v_()}function fw(n){return ul(n)&&!nc(n).n_()&&n.N_.size>0}function ul(n){return ke(n).L_.size===0}function W9(n){n.Q_=void 0}async function EL(n){n.q_.set("Online")}async function TL(n){n.N_.forEach((e,t)=>{hw(n,e)})}async function CL(n,e){W9(n),fw(n)?(n.q_.M_(e),dw(n)):n.q_.set("Unknown")}async function IL(n,e,t){if(n.q_.set("Online"),e instanceof x9&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const u of s.targetIds)i.N_.has(u)&&(await i.remoteSyncer.rejectListen(u,o),i.N_.delete(u),i.Q_.removeTarget(u))}(n,e)}catch(r){ye("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Kg(n,r)}else if(e instanceof ig?n.Q_.Ke(e):e instanceof k9?n.Q_.He(e):n.Q_.We(e),!t.isEqual(Ie.min()))try{const r=await z9(n.localStore);t.compareTo(r)>=0&&await function(s,o){const u=s.Q_.rt(o);return u.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){const p=s.N_.get(d);p&&s.N_.set(d,p.withResumeToken(c.resumeToken,o))}}),u.targetMismatches.forEach((c,d)=>{const p=s.N_.get(c);if(!p)return;s.N_.set(c,p.withResumeToken(Fn.EMPTY_BYTE_STRING,p.snapshotVersion)),j9(s,c);const m=new Ao(p.target,c,d,p.sequenceNumber);hw(s,m)}),s.remoteSyncer.applyRemoteEvent(u)}(n,t)}catch(r){ye("RemoteStore","Failed to raise snapshot:",r),await Kg(n,r)}}async function Kg(n,e,t){if(!zd(e))throw e;n.L_.add(1),await Wd(n),n.q_.set("Offline"),t||(t=()=>z9(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{ye("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await zm(n)})}function H9(n,e){return e().catch(t=>Kg(n,t,e))}async function Bm(n){const e=ke(n),t=Ko(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;PL(e);)try{const i=await uL(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,RL(e,i)}catch(i){await Kg(e,i)}$9(e)&&q9(e)}function PL(n){return ul(n)&&n.O_.length<10}function RL(n,e){n.O_.push(e);const t=Ko(n);t.r_()&&t.V_&&t.m_(e.mutations)}function $9(n){return ul(n)&&!Ko(n).n_()&&n.O_.length>0}function q9(n){Ko(n).start()}async function AL(n){Ko(n).p_()}async function kL(n){const e=Ko(n);for(const t of n.O_)e.m_(t.mutations)}async function xL(n,e,t){const r=n.O_.shift(),i=rw.from(r,e,t);await H9(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await Bm(n)}async function NL(n,e){e&&Ko(n).V_&&await async function(r,i){if(function(o){return R9(o)&&o!==Z.ABORTED}(i.code)){const s=r.O_.shift();Ko(r).s_(),await H9(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Bm(r)}}(n,e),$9(n)&&q9(n)}async function YT(n,e){const t=ke(n);t.asyncQueue.verifyOperationInProgress(),ye("RemoteStore","RemoteStore received new credentials");const r=ul(t);t.L_.add(3),await Wd(t),r&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await zm(t)}async function DL(n,e){const t=ke(n);e?(t.L_.delete(2),await zm(t)):e||(t.L_.add(2),await Wd(t),t.q_.set("Unknown"))}function nc(n){return n.K_||(n.K_=function(t,r,i){const s=ke(t);return s.w_(),new _L(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:EL.bind(null,n),Ro:TL.bind(null,n),mo:CL.bind(null,n),d_:IL.bind(null,n)}),n.B_.push(async e=>{e?(n.K_.s_(),fw(n)?dw(n):n.q_.set("Unknown")):(await n.K_.stop(),W9(n))})),n.K_}function Ko(n){return n.U_||(n.U_=function(t,r,i){const s=ke(t);return s.w_(),new yL(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:AL.bind(null,n),mo:NL.bind(null,n),f_:kL.bind(null,n),g_:xL.bind(null,n)}),n.B_.push(async e=>{e?(n.U_.s_(),await Bm(n)):(await n.U_.stop(),n.O_.length>0&&(ye("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))})),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pw{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Uo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const o=Date.now()+r,u=new pw(e,t,o,i,s);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new fe(Z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function gw(n,e){if(Ws("AsyncQueue",`${e}: ${n}`),zd(n))return new fe(Z.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tu{constructor(e){this.comparator=e?(t,r)=>e(t,r)||Se.comparator(t.key,r.key):(t,r)=>Se.comparator(t.key,r.key),this.keyedMap=wh(),this.sortedSet=new Xt(this.comparator)}static emptySet(e){return new Tu(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Tu)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Tu;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XT{constructor(){this.W_=new Xt(Se.comparator)}track(e){const t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Ce():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}}class Uu{constructor(e,t,r,i,s,o,u,c,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,s){const o=[];return t.forEach(u=>{o.push({type:0,doc:u})}),new Uu(e,t,Tu.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Om(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ML{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class OL{constructor(){this.queries=JT(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){const i=ke(t),s=i.queries;i.queries=JT(),s.forEach((o,u)=>{for(const c of u.j_)c.onError(r)})})(this,new fe(Z.ABORTED,"Firestore shutting down"))}}function JT(){return new tc(n=>p9(n),Om)}async function LL(n,e){const t=ke(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new ML,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await t.onListen(i,!0);break;case 1:s.z_=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const u=gw(o,`Initialization of query '${Yl(e.query)}' failed`);return void e.onError(u)}t.queries.set(i,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&mw(t)}async function bL(n,e){const t=ke(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function FL(n,e){const t=ke(n);let r=!1;for(const i of e){const s=i.query,o=t.queries.get(s);if(o){for(const u of o.j_)u.X_(i)&&(r=!0);o.z_=i}}r&&mw(t)}function VL(n,e,t){const r=ke(n),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(t);r.queries.delete(e)}function mw(n){n.Y_.forEach(e=>{e.next()})}var hv,ZT;(ZT=hv||(hv={})).ea="default",ZT.Cache="cache";class UL{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Uu(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Uu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==hv.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K9{constructor(e){this.key=e}}class Q9{constructor(e){this.key=e}}class zL{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Be(),this.mutatedKeys=Be(),this.Aa=g9(e),this.Ra=new Tu(this.Aa)}get Va(){return this.Ta}ma(e,t){const r=t?t.fa:new XT,i=t?t.Ra:this.Ra;let s=t?t.mutatedKeys:this.mutatedKeys,o=i,u=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,m)=>{const y=i.get(p),E=Lm(this.query,m)?m:null,S=!!y&&this.mutatedKeys.has(y.key),x=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let D=!1;y&&E?y.data.isEqual(E.data)?S!==x&&(r.track({type:3,doc:E}),D=!0):this.ga(y,E)||(r.track({type:2,doc:E}),D=!0,(c&&this.Aa(E,c)>0||d&&this.Aa(E,d)<0)&&(u=!0)):!y&&E?(r.track({type:0,doc:E}),D=!0):y&&!E&&(r.track({type:1,doc:y}),D=!0,(c||d)&&(u=!0)),D&&(E?(o=o.add(E),s=x?s.add(p):s.delete(p)):(o=o.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const p=this.query.limitType==="F"?o.last():o.first();o=o.delete(p.key),s=s.delete(p.key),r.track({type:1,doc:p})}return{Ra:o,fa:r,ns:u,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((p,m)=>function(E,S){const x=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ce()}};return x(E)-x(S)}(p.type,m.type)||this.Aa(p.doc,m.doc)),this.pa(r),i=i!=null&&i;const u=t&&!i?this.ya():[],c=this.da.size===0&&this.current&&!i?1:0,d=c!==this.Ea;return this.Ea=c,o.length!==0||d?{snapshot:new Uu(this.query,e.Ra,s,o,e.mutatedKeys,c===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:u}:{wa:u}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new XT,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Be(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const t=[];return e.forEach(r=>{this.da.has(r)||t.push(new Q9(r))}),this.da.forEach(r=>{e.has(r)||t.push(new K9(r))}),t}ba(e){this.Ta=e.Ts,this.da=Be();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Uu.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class BL{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class GL{constructor(e){this.key=e,this.va=!1}}class jL{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new tc(u=>p9(u),Om),this.Ma=new Map,this.xa=new Set,this.Oa=new Xt(Se.comparator),this.Na=new Map,this.La=new ow,this.Ba={},this.ka=new Map,this.qa=Vu.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function WL(n,e,t=!0){const r=tP(n);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await Y9(r,e,t,!0),i}async function HL(n,e){const t=tP(n);await Y9(t,e,!0,!1)}async function Y9(n,e,t,r){const i=await cL(n.localStore,ts(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t);let u;return r&&(u=await $L(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&G9(n.remoteStore,i),u}async function $L(n,e,t,r,i){n.Ka=(m,y,E)=>async function(x,D,k,R){let w=D.view.ma(k);w.ns&&(w=await qT(x.localStore,D.query,!1).then(({documents:M})=>D.view.ma(M,w)));const P=R&&R.targetChanges.get(D.targetId),V=R&&R.targetMismatches.get(D.targetId)!=null,z=D.view.applyChanges(w,x.isPrimaryClient,P,V);return t3(x,D.targetId,z.wa),z.snapshot}(n,m,y,E);const s=await qT(n.localStore,e,!0),o=new zL(e,s.Ts),u=o.ma(s.documents),c=jd.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=o.applyChanges(u,n.isPrimaryClient,c);t3(n,t,d.wa);const p=new BL(e,t,o);return n.Fa.set(e,p),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),d.snapshot}async function qL(n,e,t){const r=ke(n),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!Om(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await cv(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&cw(r.remoteStore,i.targetId),dv(r,i.targetId)}).catch(Ud)):(dv(r,i.targetId),await cv(r.localStore,i.targetId,!0))}async function KL(n,e){const t=ke(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),cw(t.remoteStore,r.targetId))}async function QL(n,e,t){const r=nb(n);try{const i=await function(o,u){const c=ke(o),d=an.now(),p=u.reduce((E,S)=>E.add(S.key),Be());let m,y;return c.persistence.runTransaction("Locally write mutations","readwrite",E=>{let S=Hs(),x=Be();return c.cs.getEntries(E,p).next(D=>{S=D,S.forEach((k,R)=>{R.isValidDocument()||(x=x.add(k))})}).next(()=>c.localDocuments.getOverlayedDocuments(E,S)).next(D=>{m=D;const k=[];for(const R of u){const w=mO(R,m.get(R.key).overlayedDocument);w!=null&&k.push(new ra(R.key,w,o9(w.value.mapValue),hr.exists(!0)))}return c.mutationQueue.addMutationBatch(E,d,k,u)}).next(D=>{y=D;const k=D.applyToLocalDocumentSet(m,x);return c.documentOverlayCache.saveOverlays(E,D.batchId,k)})}).then(()=>({batchId:y.batchId,changes:_9(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,u,c){let d=o.Ba[o.currentUser.toKey()];d||(d=new Xt(tt)),d=d.insert(u,c),o.Ba[o.currentUser.toKey()]=d}(r,i.batchId,t),await Hd(r,i.changes),await Bm(r.remoteStore)}catch(i){const s=gw(i,"Failed to persist write");t.reject(s)}}async function X9(n,e){const t=ke(n);try{const r=await aL(t.localStore,e);e.targetChanges.forEach((i,s)=>{const o=t.Na.get(s);o&&(Je(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?Je(o.va):i.removedDocuments.size>0&&(Je(o.va),o.va=!1))}),await Hd(t,r,e)}catch(r){await Ud(r)}}function e3(n,e,t){const r=ke(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Fa.forEach((s,o)=>{const u=o.view.Z_(e);u.snapshot&&i.push(u.snapshot)}),function(o,u){const c=ke(o);c.onlineState=u;let d=!1;c.queries.forEach((p,m)=>{for(const y of m.j_)y.Z_(u)&&(d=!0)}),d&&mw(c)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function YL(n,e,t){const r=ke(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Na.get(e),s=i&&i.key;if(s){let o=new Xt(Se.comparator);o=o.insert(s,wn.newNoDocument(s,Ie.min()));const u=Be().add(s),c=new Vm(Ie.min(),new Map,new Xt(tt),o,u);await X9(r,c),r.Oa=r.Oa.remove(s),r.Na.delete(e),_w(r)}else await cv(r.localStore,e,!1).then(()=>dv(r,e,t)).catch(Ud)}async function XL(n,e){const t=ke(n),r=e.batch.batchId;try{const i=await oL(t.localStore,e);Z9(t,r,null),J9(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Hd(t,i)}catch(i){await Ud(i)}}async function JL(n,e,t){const r=ke(n);try{const i=await function(o,u){const c=ke(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let p;return c.mutationQueue.lookupMutationBatch(d,u).next(m=>(Je(m!==null),p=m.keys(),c.mutationQueue.removeMutationBatch(d,m))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,p,u)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p)).next(()=>c.localDocuments.getDocuments(d,p))})}(r.localStore,e);Z9(r,e,t),J9(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Hd(r,i)}catch(i){await Ud(i)}}function J9(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function Z9(n,e,t){const r=ke(n);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function dv(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||eP(n,r)})}function eP(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(cw(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),_w(n))}function t3(n,e,t){for(const r of t)r instanceof K9?(n.La.addReference(r.key,e),ZL(n,r)):r instanceof Q9?(ye("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||eP(n,r.key)):Ce()}function ZL(n,e){const t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(ye("SyncEngine","New document in limbo: "+t),n.xa.add(r),_w(n))}function _w(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new Se(yt.fromString(e)),r=n.qa.next();n.Na.set(r,new GL(t)),n.Oa=n.Oa.insert(t,r),G9(n.remoteStore,new Ao(ts(ew(t.path)),r,"TargetPurposeLimboResolution",K2.oe))}}async function Hd(n,e,t){const r=ke(n),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((u,c)=>{o.push(r.Ka(c,e,t).then(d=>{var p;if((d||t)&&r.isPrimaryClient){const m=d?!d.fromCache:(p=t==null?void 0:t.targetChanges.get(c.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(c.targetId,m?"current":"not-current")}if(d){i.push(d);const m=lw.Wi(c.targetId,d);s.push(m)}}))}),await Promise.all(o),r.Ca.d_(i),await async function(c,d){const p=ke(c);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>ne.forEach(d,y=>ne.forEach(y.$i,E=>p.persistence.referenceDelegate.addReference(m,y.targetId,E)).next(()=>ne.forEach(y.Ui,E=>p.persistence.referenceDelegate.removeReference(m,y.targetId,E)))))}catch(m){if(!zd(m))throw m;ye("LocalStore","Failed to update sequence numbers: "+m)}for(const m of d){const y=m.targetId;if(!m.fromCache){const E=p.os.get(y),S=E.snapshotVersion,x=E.withLastLimboFreeSnapshotVersion(S);p.os=p.os.insert(y,x)}}}(r.localStore,s))}async function eb(n,e){const t=ke(n);if(!t.currentUser.isEqual(e)){ye("SyncEngine","User change. New user:",e.toKey());const r=await U9(t.localStore,e);t.currentUser=e,function(s,o){s.ka.forEach(u=>{u.forEach(c=>{c.reject(new fe(Z.CANCELLED,o))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Hd(t,r.hs)}}function tb(n,e){const t=ke(n),r=t.Na.get(e);if(r&&r.va)return Be().add(r.key);{let i=Be();const s=t.Ma.get(e);if(!s)return i;for(const o of s){const u=t.Fa.get(o);i=i.unionWith(u.view.Va)}return i}}function tP(n){const e=ke(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=X9.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=tb.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=YL.bind(null,e),e.Ca.d_=FL.bind(null,e.eventManager),e.Ca.$a=VL.bind(null,e.eventManager),e}function nb(n){const e=ke(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=XL.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=JL.bind(null,e),e}class Qg{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Um(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return sL(this.persistence,new rL,e.initialUser,this.serializer)}Ga(e){return new eL(aw.Zr,this.serializer)}Wa(e){return new dL}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Qg.provider={build:()=>new Qg};class fv{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>e3(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=eb.bind(null,this.syncEngine),await DL(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new OL}()}createDatastore(e){const t=Um(e.databaseInfo.databaseId),r=function(s){return new mL(s)}(e.databaseInfo);return function(s,o,u,c){return new vL(s,o,u,c)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,o,u){return new SL(r,i,s,o,u)}(this.localStore,this.datastore,e.asyncQueue,t=>e3(this.syncEngine,t,0),function(){return QT.D()?new QT:new fL}())}createSyncEngine(e,t){return function(i,s,o,u,c,d,p){const m=new jL(i,s,o,u,c,d);return p&&(m.Qa=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const s=ke(i);ye("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Wd(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}fv.provider={build:()=>new fv};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rb{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Ws("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ib{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new fe(Z.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(i,s){const o=ke(i),u={documents:s.map(m=>qg(o.serializer,m))},c=await o.Lo("BatchGetDocuments",o.serializer.databaseId,yt.emptyPath(),u,s.length),d=new Map;c.forEach(m=>{const y=kO(o.serializer,m);d.set(y.key.toString(),y)});const p=[];return s.forEach(m=>{const y=d.get(m.toString());Je(!!y),p.push(y)}),p}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new nw(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{const i=Se.fromPath(r);this.mutations.push(new P9(i,this.precondition(i)))}),await async function(r,i){const s=ke(r),o={writes:i.map(u=>L9(s.serializer,u))};await s.Mo("Commit",s.serializer.databaseId,yt.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Ce();t=Ie.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new fe(Z.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Ie.min())?hr.exists(!1):hr.updateTime(t):hr.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Ie.min()))throw new fe(Z.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return hr.updateTime(t)}return hr.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sb{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this._u=r.maxAttempts,this.t_=new uw(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new ib(this.datastore),t=this.cu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.lu(i)}))}).catch(r=>{this.lu(r)})})}cu(e){try{const t=this.updateFunction(e);return!Bd(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!R9(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ob{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Qn.UNAUTHENTICATED,this.clientId=r9.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{ye("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ye("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Uo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=gw(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Ay(n,e){n.asyncQueue.verifyOperationInProgress(),ye("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await U9(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function n3(n,e){n.asyncQueue.verifyOperationInProgress();const t=await ab(n);ye("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>YT(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>YT(e.remoteStore,i)),n._onlineComponents=e}async function ab(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ye("FirestoreClient","Using user provided OfflineComponentProvider");try{await Ay(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===Z.FAILED_PRECONDITION||i.code===Z.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Ou("Error using user provided cache. Falling back to memory cache: "+t),await Ay(n,new Qg)}}else ye("FirestoreClient","Using default OfflineComponentProvider"),await Ay(n,new Qg);return n._offlineComponents}async function yw(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ye("FirestoreClient","Using user provided OnlineComponentProvider"),await n3(n,n._uninitializedComponentsProvider._online)):(ye("FirestoreClient","Using default OnlineComponentProvider"),await n3(n,new fv))),n._onlineComponents}function lb(n){return yw(n).then(e=>e.syncEngine)}function ub(n){return yw(n).then(e=>e.datastore)}async function r3(n){const e=await yw(n),t=e.eventManager;return t.onListen=WL.bind(null,e.syncEngine),t.onUnlisten=qL.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=HL.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=KL.bind(null,e.syncEngine),t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nP(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i3=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rP(n,e,t){if(!t)throw new fe(Z.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function cb(n,e,t,r){if(e===!0&&r===!0)throw new fe(Z.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function s3(n){if(!Se.isDocumentKey(n))throw new fe(Z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function o3(n){if(Se.isDocumentKey(n))throw new fe(Z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Gm(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ce()}function Ls(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new fe(Z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Gm(n);throw new fe(Z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a3{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new fe(Z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new fe(Z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}cb("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=nP((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new fe(Z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new fe(Z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new fe(Z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class jm{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new a3({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new fe(Z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new fe(Z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new a3(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new CM;switch(r.type){case"firstParty":return new AM(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new fe(Z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=i3.get(t);r&&(ye("ComponentProvider","Removing Datastore"),i3.delete(t),r.terminate())}(this),Promise.resolve()}}function hb(n,e,t,r={}){var i;const s=(n=Ls(n,jm))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Ou("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let u,c;if(typeof r.mockUserToken=="string")u=r.mockUserToken,c=Qn.MOCK_USER;else{u=u6(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);const d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new fe(Z.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Qn(d)}n._authCredentials=new IM(new n9(u,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new cl(this.firestore,e,this._query)}}class er{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Bo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new er(this.firestore,e,this._key)}}class Bo extends cl{constructor(e,t,r){super(e,t,ew(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new er(this.firestore,null,new Se(e))}withConverter(e){return new Bo(this.firestore,e,this._path)}}function iP(n,e,...t){if(n=Lt(n),rP("collection","path",e),n instanceof jm){const r=yt.fromString(e,...t);return o3(r),new Bo(n,null,r)}{if(!(n instanceof er||n instanceof Bo))throw new fe(Z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(yt.fromString(e,...t));return o3(r),new Bo(n.firestore,null,r)}}function Wm(n,e,...t){if(n=Lt(n),arguments.length===1&&(e=r9.newId()),rP("doc","path",e),n instanceof jm){const r=yt.fromString(e,...t);return s3(r),new er(n,null,new Se(r))}{if(!(n instanceof er||n instanceof Bo))throw new fe(Z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(yt.fromString(e,...t));return s3(r),new er(n.firestore,n instanceof Bo?n.converter:null,new Se(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l3{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new uw(this,"async_queue_retry"),this.Vu=()=>{const r=Ry();r&&ye("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const t=Ry();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=Ry();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new Uo;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!zd(e))throw e;ye("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(o){let u=o.message||"";return o.stack&&(u=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),u}(r);throw Ws("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const i=pw.createAndSchedule(this,e,t,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&Ce()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function u3(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}class zu extends jm{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new l3,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new l3(e),this._firestoreClient=void 0,await e}}}function db(n,e){const t=typeof n=="object"?n:L2(),r=typeof n=="string"?n:"(default)",i=xm(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=o6("firestore");s&&hb(i,...s)}return i}function vw(n){if(n._terminated)throw new fe(Z.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||fb(n),n._firestoreClient}function fb(n){var e,t,r;const i=n._freezeSettings(),s=function(u,c,d,p){return new BM(u,c,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,nP(p.experimentalLongPollingOptions),p.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new ob(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(u){const c=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(c),_online:c}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el{constructor(e){this._byteString=e}static fromBase64String(e){try{return new el(Fn.fromBase64String(e))}catch(t){throw new fe(Z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new el(Fn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $d{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new fe(Z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Mn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hm{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ww{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new fe(Z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new fe(Z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return tt(this._lat,e._lat)||tt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sw{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pb=/^__.*__$/;class gb{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new ra(e,this.data,this.fieldMask,t,this.fieldTransforms):new Gd(e,this.data,t,this.fieldTransforms)}}class sP{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new ra(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function oP(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ce()}}class Ew{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Ew(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Yg(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(oP(this.Cu)&&pb.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class mb{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Um(e)}Qu(e,t,r,i=!1){return new Ew({Cu:e,methodName:t,qu:r,path:Mn.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function $m(n){const e=n._freezeSettings(),t=Um(n._databaseId);return new mb(n._databaseId,!!e.ignoreUndefinedProperties,t)}function aP(n,e,t,r,i,s={}){const o=n.Qu(s.merge||s.mergeFields?2:0,e,t,i);Cw("Data must be an object, but it was:",o,r);const u=cP(r,o);let c,d;if(s.merge)c=new Or(o.fieldMask),d=o.fieldTransforms;else if(s.mergeFields){const p=[];for(const m of s.mergeFields){const y=pv(e,m,t);if(!o.contains(y))throw new fe(Z.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);dP(p,y)||p.push(y)}c=new Or(p),d=o.fieldTransforms.filter(m=>c.covers(m.field))}else c=null,d=o.fieldTransforms;return new gb(new cr(u),c,d)}class qm extends Hm{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof qm}}class Tw extends Hm{_toFieldTransform(e){return new dO(e.path,new gd)}isEqual(e){return e instanceof Tw}}function lP(n,e,t,r){const i=n.Qu(1,e,t);Cw("Data must be an object, but it was:",i,r);const s=[],o=cr.empty();ll(r,(c,d)=>{const p=Iw(e,c,t);d=Lt(d);const m=i.Nu(p);if(d instanceof qm)s.push(p);else{const y=qd(d,m);y!=null&&(s.push(p),o.set(p,y))}});const u=new Or(s);return new sP(o,u,i.fieldTransforms)}function uP(n,e,t,r,i,s){const o=n.Qu(1,e,t),u=[pv(e,r,t)],c=[i];if(s.length%2!=0)throw new fe(Z.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let y=0;y<s.length;y+=2)u.push(pv(e,s[y])),c.push(s[y+1]);const d=[],p=cr.empty();for(let y=u.length-1;y>=0;--y)if(!dP(d,u[y])){const E=u[y];let S=c[y];S=Lt(S);const x=o.Nu(E);if(S instanceof qm)d.push(E);else{const D=qd(S,x);D!=null&&(d.push(E),p.set(E,D))}}const m=new Or(d);return new sP(p,m,o.fieldTransforms)}function _b(n,e,t,r=!1){return qd(t,n.Qu(r?4:3,e))}function qd(n,e){if(hP(n=Lt(n)))return Cw("Unsupported field value:",e,n),cP(n,e);if(n instanceof Hm)return function(r,i){if(!oP(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const u of r){let c=qd(u,i.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=Lt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return uO(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=an.fromDate(r);return{timestampValue:$g(i.serializer,s)}}if(r instanceof an){const s=new an(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:$g(i.serializer,s)}}if(r instanceof ww)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof el)return{bytesValue:N9(i.serializer,r._byteString)};if(r instanceof er){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:sw(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Sw)return function(o,u){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw u.Bu("VectorValues must only contain numeric values.");return tw(u.serializer,c)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${Gm(r)}`)}(n,e)}function cP(n,e){const t={};return i9(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ll(n,(r,i)=>{const s=qd(i,e.Mu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function hP(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof an||n instanceof ww||n instanceof el||n instanceof er||n instanceof Hm||n instanceof Sw)}function Cw(n,e,t){if(!hP(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const r=Gm(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function pv(n,e,t){if((e=Lt(e))instanceof $d)return e._internalPath;if(typeof e=="string")return Iw(n,e);throw Yg("Field path arguments must be of type string or ",n,!1,void 0,t)}const yb=new RegExp("[~\\*/\\[\\]]");function Iw(n,e,t){if(e.search(yb)>=0)throw Yg(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new $d(...e.split("."))._internalPath}catch{throw Yg(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Yg(n,e,t,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new fe(Z.INVALID_ARGUMENT,u+n+c)}function dP(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xg{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new er(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new vb(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Pw("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class vb extends Xg{data(){return super.data()}}function Pw(n,e){return typeof e=="string"?Iw(n,e):e instanceof $d?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wb(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new fe(Z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Rw{}class fP extends Rw{}function Sb(n,e,...t){let r=[];e instanceof Rw&&r.push(e),r=r.concat(t),function(s){const o=s.filter(c=>c instanceof kw).length,u=s.filter(c=>c instanceof Aw).length;if(o>1||o>0&&u>0)throw new fe(Z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class Aw extends fP{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Aw(e,t,r)}_apply(e){const t=this._parse(e);return pP(e._query,t),new cl(e.firestore,e.converter,sv(e._query,t))}_parse(e){const t=$m(e.firestore);return function(s,o,u,c,d,p,m){let y;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new fe(Z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){h3(m,p);const E=[];for(const S of m)E.push(c3(c,s,S));y={arrayValue:{values:E}}}else y=c3(c,s,m)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||h3(m,p),y=_b(u,o,m,p==="in"||p==="not-in");return Yt.create(d,p,y)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}class kw extends Rw{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new kw(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:ki.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i;const u=s.getFlattenedFilters();for(const c of u)pP(o,c),o=sv(o,c)}(e._query,t),new cl(e.firestore,e.converter,sv(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class xw extends fP{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new xw(e,t)}_apply(e){const t=function(i,s,o){if(i.startAt!==null)throw new fe(Z.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new fe(Z.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new pd(s,o)}(e._query,this._field,this._direction);return new cl(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new ec(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}function Eb(n,e="asc"){const t=e,r=Pw("orderBy",n);return xw._create(r,t)}function c3(n,e,t){if(typeof(t=Lt(t))=="string"){if(t==="")throw new fe(Z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!f9(e)&&t.indexOf("/")!==-1)throw new fe(Z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(yt.fromString(t));if(!Se.isDocumentKey(r))throw new fe(Z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return xT(n,new Se(r))}if(t instanceof er)return xT(n,t._key);throw new fe(Z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Gm(t)}.`)}function h3(n,e){if(!Array.isArray(n)||n.length===0)throw new fe(Z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function pP(n,e){const t=function(i,s){for(const o of i)for(const u of o.getFlattenedFilters())if(s.indexOf(u.op)>=0)return u.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new fe(Z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new fe(Z.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class gP{convertValue(e,t="none"){switch(Za(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Gt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ja(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ce()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return ll(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;const s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>Gt(o.doubleValue));return new Sw(s)}convertGeoPoint(e){return new ww(Gt(e.latitude),Gt(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Y2(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(hd(e));default:return null}}convertTimestamp(e){const t=qo(e);return new an(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=yt.fromString(e);Je(V9(r));const i=new dd(r.get(1),r.get(3)),s=new Se(r.popFirst(5));return i.isEqual(t)||Ws(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mP(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class Tb extends gP{constructor(e){super(),this.firestore=e}convertBytes(e){return new el(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new er(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Nw extends Xg{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new sg(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Pw("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class sg extends Nw{data(e={}){return super.data(e)}}class Cb{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new hu(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new sg(this._firestore,this._userDataWriter,r.key,r,new hu(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new fe(Z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(u=>{const c=new sg(i._firestore,i._userDataWriter,u.doc.key,u.doc,new hu(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>s||u.type!==3).map(u=>{const c=new sg(i._firestore,i._userDataWriter,u.doc.key,u.doc,new hu(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,p=-1;return u.type!==0&&(d=o.indexOf(u.doc.key),o=o.delete(u.doc.key)),u.type!==1&&(o=o.add(u.doc),p=o.indexOf(u.doc.key)),{type:Ib(u.type),doc:c,oldIndex:d,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function Ib(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ce()}}class Dw extends gP{constructor(e){super(),this.firestore=e}convertBytes(e){return new el(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new er(this.firestore,null,t)}}function Pb(n,e,t){n=Ls(n,er);const r=Ls(n.firestore,zu),i=mP(n.converter,e,t);return _P(r,[aP($m(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,hr.none())])}function Rb(n,e,t,...r){n=Ls(n,er);const i=Ls(n.firestore,zu),s=$m(i);let o;return o=typeof(e=Lt(e))=="string"||e instanceof $d?uP(s,"updateDoc",n._key,e,t,r):lP(s,"updateDoc",n._key,e),_P(i,[o.toMutation(n._key,hr.exists(!0))])}function Ab(n,...e){var t,r,i;n=Lt(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||u3(e[o])||(s=e[o],o++);const u={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(u3(e[o])){const m=e[o];e[o]=(t=m.next)===null||t===void 0?void 0:t.bind(m),e[o+1]=(r=m.error)===null||r===void 0?void 0:r.bind(m),e[o+2]=(i=m.complete)===null||i===void 0?void 0:i.bind(m)}let c,d,p;if(n instanceof er)d=Ls(n.firestore,zu),p=ew(n._key.path),c={next:m=>{e[o]&&e[o](kb(d,n,m))},error:e[o+1],complete:e[o+2]};else{const m=Ls(n,cl);d=Ls(m.firestore,zu),p=m._query;const y=new Dw(d);c={next:E=>{e[o]&&e[o](new Cb(d,y,m,E))},error:e[o+1],complete:e[o+2]},wb(n._query)}return function(y,E,S,x){const D=new rb(x),k=new UL(E,D,S);return y.asyncQueue.enqueueAndForget(async()=>LL(await r3(y),k)),()=>{D.Za(),y.asyncQueue.enqueueAndForget(async()=>bL(await r3(y),k))}}(vw(d),p,u,c)}function _P(n,e){return function(r,i){const s=new Uo;return r.asyncQueue.enqueueAndForget(async()=>QL(await lb(r),i,s)),s.promise}(vw(n),e)}function kb(n,e,t){const r=t.docs.get(e._key),i=new Dw(n);return new Nw(n,i,e._key,r,new hu(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xb={maxAttempts:5};function rh(n,e){if((n=Lt(n)).firestore!==e)throw new fe(Z.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nb extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=$m(t)}get(t){const r=rh(t,this._firestore),i=new Tb(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return Ce();const o=s[0];if(o.isFoundDocument())return new Xg(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new Xg(this._firestore,i,r._key,null,r.converter);throw Ce()})}set(t,r,i){const s=rh(t,this._firestore),o=mP(s.converter,r,i),u=aP(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,u),this}update(t,r,i,...s){const o=rh(t,this._firestore);let u;return u=typeof(r=Lt(r))=="string"||r instanceof $d?uP(this._dataReader,"Transaction.update",o._key,r,i,s):lP(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,u),this}delete(t){const r=rh(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=rh(e,this._firestore),r=new Dw(this._firestore);return super.get(e).then(i=>new Nw(this._firestore,r,t._key,i._document,new hu(!1,!1),t.converter))}}function yP(n,e,t){n=Ls(n,zu);const r=Object.assign(Object.assign({},xb),t);return function(s){if(s.maxAttempts<1)throw new fe(Z.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,u){const c=new Uo;return s.asyncQueue.enqueueAndForget(async()=>{const d=await ub(s);new sb(s.asyncQueue,d,u,o,c).au()}),c.promise}(vw(n),i=>e(new Nb(n,i)),r)}function yd(){return new Tw("serverTimestamp")}(function(e,t=!0){(function(i){Zu=i})(al),Ka(new Ho("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),u=new zu(new PM(r.getProvider("auth-internal")),new xM(r.getProvider("app-check-internal")),function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new fe(Z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new dd(d.options.projectId,p)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),Zi(IT,"4.7.3",e),Zi(IT,"4.7.3","esm2017")})();var d3={};const f3="@firebase/database",p3="1.0.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vP="";function Db(n){vP=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mb{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Dn(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:od(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ob{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Qs(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wP=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new Mb(e)}}catch{}return new Ob},Ua=wP("localStorage"),Lb=wP("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cu=new km("@firebase/database"),bb=function(){let n=1;return function(){return n++}}(),SP=function(n){const e=e7(n),t=new Qx;t.update(e);const r=t.digest();return N2.encodeByteArray(r)},Kd=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Kd.apply(null,r):typeof r=="object"?e+=Dn(r):e+=r,e+=" "}return e};let Uh=null,g3=!0;const Fb=function(n,e){le(!0,"Can't turn on custom loggers persistently."),Cu.logLevel=ze.VERBOSE,Uh=Cu.log.bind(Cu)},Xn=function(...n){if(g3===!0&&(g3=!1,Uh===null&&Lb.get("logging_enabled")===!0&&Fb()),Uh){const e=Kd.apply(null,n);Uh(e)}},Qd=function(n){return function(...e){Xn(n,...e)}},gv=function(...n){const e="FIREBASE INTERNAL ERROR: "+Kd(...n);Cu.error(e)},$s=function(...n){const e=`FIREBASE FATAL ERROR: ${Kd(...n)}`;throw Cu.error(e),new Error(e)},Fr=function(...n){const e="FIREBASE WARNING: "+Kd(...n);Cu.warn(e)},Vb=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Fr("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},EP=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},Ub=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Bu="[MIN_NAME]",tl="[MAX_NAME]",rc=function(n,e){if(n===e)return 0;if(n===Bu||e===tl)return-1;if(e===Bu||n===tl)return 1;{const t=m3(n),r=m3(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},zb=function(n,e){return n===e?0:n<e?-1:1},ih=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+Dn(e))},Mw=function(n){if(typeof n!="object"||n===null)return Dn(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=Dn(e[r]),t+=":",t+=Mw(n[e[r]]);return t+="}",t},TP=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function ii(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const CP=function(n){le(!EP(n),"Invalid JSON number");const e=11,t=52,r=(1<<e-1)-1;let i,s,o,u,c;n===0?(s=0,o=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(u=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=u+r,o=Math.round(n*Math.pow(2,t-u)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-r-t))));const d=[];for(c=t;c;c-=1)d.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)d.push(s%2?1:0),s=Math.floor(s/2);d.push(i?1:0),d.reverse();const p=d.join("");let m="";for(c=0;c<64;c+=8){let y=parseInt(p.substr(c,8),2).toString(16);y.length===1&&(y="0"+y),m=m+y}return m.toLowerCase()},Bb=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},Gb=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"},jb=new RegExp("^-?(0*)\\d{1,10}$"),Wb=-2147483648,Hb=2147483647,m3=function(n){if(jb.test(n)){const e=Number(n);if(e>=Wb&&e<=Hb)return e}return null},Yd=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw Fr("Exception was thrown by user callback.",t),e},Math.floor(0))}},$b=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},zh=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qb{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Fr(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kb{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(Xn("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Fr(e)}}class og{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}og.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ow="5",IP="v",PP="s",RP="r",AP="f",kP=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,xP="ls",NP="p",mv="ac",DP="websocket",MP="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OP{constructor(e,t,r,i,s=!1,o="",u=!1,c=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=u,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Ua.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Ua.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function Qb(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function LP(n,e,t){le(typeof e=="string","typeof type must == string"),le(typeof t=="object","typeof params must == object");let r;if(e===DP)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===MP)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Qb(n)&&(t.ns=n.namespace);const i=[];return ii(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yb{constructor(){this.counters_={}}incrementCounter(e,t=1){Qs(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return xx(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ky={},xy={};function Lw(n){const e=n.toString();return ky[e]||(ky[e]=new Yb),ky[e]}function Xb(n,e){const t=n.toString();return xy[t]||(xy[t]=e()),xy[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jb{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Yd(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _3="start",Zb="close",eF="pLPCommand",tF="pRTLPCB",bP="id",FP="pw",VP="ser",nF="cb",rF="seg",iF="ts",sF="d",oF="dframe",UP=1870,zP=30,aF=UP-zP,lF=25e3,uF=3e4;class du{constructor(e,t,r,i,s,o,u){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=u,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Qd(e),this.stats_=Lw(t),this.urlFn=c=>(this.appCheckToken&&(c[mv]=this.appCheckToken),LP(t,MP,c))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Jb(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(uF)),Ub(()=>{if(this.isClosed_)return;this.scriptTagHolder=new bw((...s)=>{const[o,u,c,d,p]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===_3)this.id=u,this.password=c;else if(o===Zb)u?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(u,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{const[o,u]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,u)},()=>{this.onClosed_()},this.urlFn);const r={};r[_3]="t",r[VP]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[nF]=this.scriptTagHolder.uniqueCallbackIdentifier),r[IP]=Ow,this.transportSessionId&&(r[PP]=this.transportSessionId),this.lastSessionId&&(r[xP]=this.lastSessionId),this.applicationId&&(r[NP]=this.applicationId),this.appCheckToken&&(r[mv]=this.appCheckToken),typeof location<"u"&&location.hostname&&kP.test(location.hostname)&&(r[RP]=AP);const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){du.forceAllow_=!0}static forceDisallow(){du.forceDisallow_=!0}static isAvailable(){return du.forceAllow_?!0:!du.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!Bb()&&!Gb()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=Dn(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=r6(t),i=TP(r,aF);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const r={};r[oF]="t",r[bP]=e,r[FP]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=Dn(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class bw{constructor(e,t,r,i){this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=bb(),window[eF+this.uniqueCallbackIdentifier]=e,window[tF+this.uniqueCallbackIdentifier]=t,this.myIFrame=bw.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(u){Xn("frame writing exception"),u.stack&&Xn(u.stack),Xn(u)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Xn("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[bP]=this.myID,e[FP]=this.myPW,e[VP]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+zP+r.length<=UP;){const o=this.pendingSegs.shift();r=r+"&"+rF+i+"="+o.seg+"&"+iF+i+"="+o.ts+"&"+sF+i+"="+o.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(lF)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{Xn("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cF=16384,hF=45e3;let Jg=null;typeof MozWebSocket<"u"?Jg=MozWebSocket:typeof WebSocket<"u"&&(Jg=WebSocket);class wi{constructor(e,t,r,i,s,o,u){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Qd(this.connId),this.stats_=Lw(t),this.connURL=wi.connectionURL_(t,o,u,i,r),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,r,i,s){const o={};return o[IP]=Ow,typeof location<"u"&&location.hostname&&kP.test(location.hostname)&&(o[RP]=AP),t&&(o[PP]=t),r&&(o[xP]=r),i&&(o[mv]=i),s&&(o[NP]=s),LP(e,DP,o)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Ua.set("previous_websocket_failure",!0);try{let r;zx(),this.mySock=new Jg(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){wi.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(t);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&Jg!==null&&!wi.forceDisallow_}static previouslyFailed(){return Ua.isInMemoryStorage||Ua.get("previous_websocket_failure")===!0}markConnectionHealthy(){Ua.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const r=od(t);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(le(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const r=this.extractFrameCount_(t);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const t=Dn(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=TP(t,cF);r.length>1&&this.sendString_(String(r.length));for(let i=0;i<r.length;i++)this.sendString_(r[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(hF))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}wi.responsesRequiredToBeHealthy=2;wi.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vd{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[du,wi]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=wi&&wi.isAvailable();let r=t&&!wi.previouslyFailed();if(e.webSocketOnly&&(t||Fr("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[wi];else{const i=this.transports_=[];for(const s of vd.ALL_TRANSPORTS)s&&s.isAvailable()&&i.push(s);vd.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}vd.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dF=6e4,fF=5e3,pF=10*1024,gF=100*1024,Ny="t",y3="d",mF="s",v3="r",_F="e",w3="o",S3="a",E3="n",T3="p",yF="h";class vF{constructor(e,t,r,i,s,o,u,c,d,p){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=u,this.onDisconnect_=c,this.onKill_=d,this.lastSessionId=p,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Qd("c:"+this.id+":"),this.transportManager_=new vd(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=zh(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>gF?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>pF?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Ny in e){const t=e[Ny];t===S3?this.upgradeIfSecondaryHealthy_():t===v3?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===w3&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=ih("t",e),r=ih("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:T3,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:S3,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:E3,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=ih("t",e),r=ih("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=ih(Ny,e);if(y3 in e){const r=e[y3];if(t===yF){const i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===E3){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===mF?this.onConnectionShutdown_(r):t===v3?this.onReset_(r):t===_F?gv("Server Error: "+r):t===w3?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):gv("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),Ow!==r&&Fr("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),zh(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(dF))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):zh(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(fF))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:T3,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Ua.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BP{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GP{constructor(e){this.allowedEvents_=e,this.listeners_={},le(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){le(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zg extends GP{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!M2()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new Zg}getInitialEvent(e){return le(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C3=32,I3=768;let Pt=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function gt(){return new Pt("")}function Qe(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Qo(n){return n.pieces_.length-n.pieceNum_}function Ct(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new Pt(n.pieces_,e)}function jP(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function wF(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function WP(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function HP(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new Pt(e,0)}function Sn(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof Pt)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new Pt(t,0)}function je(n){return n.pieceNum_>=n.pieces_.length}function Zr(n,e){const t=Qe(n),r=Qe(e);if(t===null)return e;if(t===r)return Zr(Ct(n),Ct(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function $P(n,e){if(Qo(n)!==Qo(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function Ei(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(Qo(n)>Qo(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class SF{constructor(e,t){this.errorPrefix_=t,this.parts_=WP(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Am(this.parts_[r]);qP(this)}}function EF(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Am(e),qP(n)}function TF(n){const e=n.parts_.pop();n.byteLength_-=Am(e),n.parts_.length>0&&(n.byteLength_-=1)}function qP(n){if(n.byteLength_>I3)throw new Error(n.errorPrefix_+"has a key path longer than "+I3+" bytes ("+n.byteLength_+").");if(n.parts_.length>C3)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+C3+") or object contains a cycle "+Da(n))}function Da(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fw extends GP{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new Fw}getInitialEvent(e){return le(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sh=1e3,CF=60*5*1e3,P3=30*1e3,IF=1.3,PF=3e4,RF="server_kill",R3=3;class bs extends BP{constructor(e,t,r,i,s,o,u,c){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=r,this.onConnectStatus_=i,this.onServerInfoUpdate_=s,this.authTokenProvider_=o,this.appCheckTokenProvider_=u,this.authOverride_=c,this.id=bs.nextPersistentConnectionId_++,this.log_=Qd("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=sh,this.maxReconnectDelay_=CF,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Fw.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Zg.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,r){const i=++this.requestNumber_,s={r:i,a:e,b:t};this.log_(Dn(s)),le(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),r&&(this.requestCBHash_[i]=r)}get(e){this.initConnection_();const t=new D2,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const u=o.d;o.s==="ok"?t.resolve(u):t.reject(u)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),t.promise}listen(e,t,r,i){this.initConnection_();const s=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+s),this.listens.has(o)||this.listens.set(o,new Map),le(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),le(!this.listens.get(o).has(s),"listen() called twice for same path/queryId.");const u={onComplete:i,hashFn:t,query:e,tag:r};this.listens.get(o).set(s,u),this.connected_&&this.sendListen_(u)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(r)})}sendListen_(e){const t=e.query,r=t._path.toString(),i=t._queryIdentifier;this.log_("Listen on "+r+" for "+i);const s={p:r},o="q";e.tag&&(s.q=t._queryObject,s.t=e.tag),s.h=e.hashFn(),this.sendRequest(o,s,u=>{const c=u.d,d=u.s;bs.warnOnListenWarnings_(c,t),(this.listens.get(r)&&this.listens.get(r).get(i))===e&&(this.log_("listen response",u),d!=="ok"&&this.removeListen_(r,i),e.onComplete&&e.onComplete(d,c))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&Qs(e,"w")){const r=Mu(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const i='".indexOn": "'+t._queryParams.getIndex().toString()+'"',s=t._path.toString();Fr(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||Kx(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=P3)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=qx(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(t,r,i=>{const s=i.s,o=i.d||"error";this.authToken_===e&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,r=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,r)})}unlisten(e,t){const r=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+i),le(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,i)&&this.connected_&&this.sendUnlisten_(r,i,e._queryObject,t)}sendUnlisten_(e,t,r,i){this.log_("Unlisten on "+e+" for "+t);const s={p:e},o="n";i&&(s.q=r,s.t=i),this.sendRequest(o,s)}onDisconnectPut(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:r})}onDisconnectMerge(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:r})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,r,i){const s={p:t,d:r};this.log_("onDisconnect "+e,s),this.sendRequest(e,s,o=>{i&&setTimeout(()=>{i(o.s,o.d)},Math.floor(0))})}put(e,t,r,i){this.putInternal("p",e,t,r,i)}merge(e,t,r,i){this.putInternal("m",e,t,r,i)}putInternal(e,t,r,i,s){this.initConnection_();const o={p:t,d:r};s!==void 0&&(o.h=s),this.outstandingPuts_.push({action:e,request:o,onComplete:i}),this.outstandingPutCount_++;const u=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(u):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,r,s=>{this.log_(t+" response",s),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(s.s,s.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,r=>{if(r.s!=="ok"){const s=r.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Dn(e));const t=e.r,r=this.requestCBHash_[t];r&&(delete this.requestCBHash_[t],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):gv("Unrecognized action received from server: "+Dn(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){le(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=sh,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=sh,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>PF&&(this.reconnectDelay_=sh),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*IF)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+bs.nextConnectionId_++,s=this.lastSessionId;let o=!1,u=null;const c=function(){u?u.close():(o=!0,r())},d=function(m){le(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(m)};this.realtime_={close:c,sendRequest:d};const p=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[m,y]=await Promise.all([this.authTokenProvider_.getToken(p),this.appCheckTokenProvider_.getToken(p)]);o?Xn("getToken() completed but was canceled"):(Xn("getToken() completed. Creating connection."),this.authToken_=m&&m.accessToken,this.appCheckToken_=y&&y.token,u=new vF(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,r,E=>{Fr(E+" ("+this.repoInfo_.toString()+")"),this.interrupt(RF)},s))}catch(m){this.log_("Failed to get token: "+m),o||(this.repoInfo_.nodeAdmin&&Fr(m),c())}}}interrupt(e){Xn("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Xn("Resuming connection for reason: "+e),delete this.interruptReasons_[e],j1(this.interruptReasons_)&&(this.reconnectDelay_=sh,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let r;t?r=t.map(s=>Mw(s)).join("$"):r="default";const i=this.removeListen_(e,r);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,t){const r=new Pt(e).toString();let i;if(this.listens.has(r)){const s=this.listens.get(r);i=s.get(t),s.delete(t),s.size===0&&this.listens.delete(r)}else i=void 0;return i}onAuthRevoked_(e,t){Xn("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=R3&&(this.reconnectDelay_=P3,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Xn("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=R3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+vP.replace(/\./g,"-")]=1,M2()?e["framework.cordova"]=1:c6()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Zg.getInstance().currentlyOnline();return j1(this.interruptReasons_)&&e}}bs.nextPersistentConnectionId_=0;bs.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Ye(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Km{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new Ye(Bu,e),i=new Ye(Bu,t);return this.compare(r,i)!==0}minPost(){return Ye.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Np;class KP extends Km{static get __EMPTY_NODE(){return Np}static set __EMPTY_NODE(e){Np=e}compare(e,t){return rc(e.name,t.name)}isDefinedOn(e){throw Yu("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Ye.MIN}maxPost(){return new Ye(tl,Np)}makePost(e,t){return le(typeof e=="string","KeyIndex indexValue must always be a string."),new Ye(e,Np)}toString(){return".key"}}const Iu=new KP;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dp{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class vn{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??vn.RED,this.left=i??Pr.EMPTY_NODE,this.right=s??Pr.EMPTY_NODE}copy(e,t,r,i,s){return new vn(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return s<0?i=i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i=i.copy(null,t,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return Pr.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let r,i;if(r=this,t(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),t(e,r.key)===0){if(r.right.isEmpty())return Pr.EMPTY_NODE;i=r.right.min_(),r=r.copy(i.key,i.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,vn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,vn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}vn.RED=!0;vn.BLACK=!1;class AF{copy(e,t,r,i,s){return this}insert(e,t,r){return new vn(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Pr{constructor(e,t=Pr.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Pr(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,vn.BLACK,null,null))}remove(e){return new Pr(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,vn.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Dp(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Dp(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Dp(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Dp(this.root_,null,this.comparator_,!0,e)}}Pr.EMPTY_NODE=new AF;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kF(n,e){return rc(n.name,e.name)}function Vw(n,e){return rc(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _v;function xF(n){_v=n}const QP=function(n){return typeof n=="number"?"number:"+CP(n):"string:"+n},YP=function(n){if(n.isLeafNode()){const e=n.val();le(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Qs(e,".sv"),"Priority must be a string or number.")}else le(n===_v||n.isEmpty(),"priority of unexpected type.");le(n===_v||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let A3;class mn{constructor(e,t=mn.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,le(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),YP(this.priorityNode_)}static set __childrenNodeConstructor(e){A3=e}static get __childrenNodeConstructor(){return A3}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new mn(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:mn.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return je(e)?this:Qe(e)===".priority"?this.priorityNode_:mn.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:mn.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const r=Qe(e);return r===null?t:t.isEmpty()&&r!==".priority"?this:(le(r!==".priority"||Qo(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,mn.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ct(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+QP(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=CP(this.value_):e+=this.value_,this.lazyHash_=SP(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===mn.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof mn.__childrenNodeConstructor?-1:(le(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,r=typeof this.value_,i=mn.VALUE_TYPE_ORDER.indexOf(t),s=mn.VALUE_TYPE_ORDER.indexOf(r);return le(i>=0,"Unknown leaf type: "+t),le(s>=0,"Unknown leaf type: "+r),i===s?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}mn.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let XP,JP;function NF(n){XP=n}function DF(n){JP=n}class MF extends Km{compare(e,t){const r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return s===0?rc(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Ye.MIN}maxPost(){return new Ye(tl,new mn("[PRIORITY-POST]",JP))}makePost(e,t){const r=XP(e);return new Ye(t,new mn("[PRIORITY-POST]",r))}toString(){return".priority"}}const Zn=new MF;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OF=Math.log(2);class LF{constructor(e){const t=s=>parseInt(Math.log(s)/OF,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const em=function(n,e,t,r){n.sort(e);const i=function(c,d){const p=d-c;let m,y;if(p===0)return null;if(p===1)return m=n[c],y=t?t(m):m,new vn(y,m.node,vn.BLACK,null,null);{const E=parseInt(p/2,10)+c,S=i(c,E),x=i(E+1,d);return m=n[E],y=t?t(m):m,new vn(y,m.node,vn.BLACK,S,x)}},s=function(c){let d=null,p=null,m=n.length;const y=function(S,x){const D=m-S,k=m;m-=S;const R=i(D+1,k),w=n[D],P=t?t(w):w;E(new vn(P,w.node,x,null,R))},E=function(S){d?(d.left=S,d=S):(p=S,d=S)};for(let S=0;S<c.count;++S){const x=c.nextBitIsOne(),D=Math.pow(2,c.count-(S+1));x?y(D,vn.BLACK):(y(D,vn.BLACK),y(D,vn.RED))}return p},o=new LF(n.length),u=s(o);return new Pr(r||e,u)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Dy;const Hl={};class Ds{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return le(Hl&&Zn,"ChildrenNode.ts has not been loaded"),Dy=Dy||new Ds({".priority":Hl},{".priority":Zn}),Dy}get(e){const t=Mu(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Pr?t:null}hasIndex(e){return Qs(this.indexSet_,e.toString())}addIndex(e,t){le(e!==Iu,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const s=t.getIterator(Ye.Wrap);let o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let u;i?u=em(r,e.getCompare()):u=Hl;const c=e.toString(),d=Object.assign({},this.indexSet_);d[c]=e;const p=Object.assign({},this.indexes_);return p[c]=u,new Ds(p,d)}addToIndexes(e,t){const r=Lg(this.indexes_,(i,s)=>{const o=Mu(this.indexSet_,s);if(le(o,"Missing index implementation for "+s),i===Hl)if(o.isDefinedOn(e.node)){const u=[],c=t.getIterator(Ye.Wrap);let d=c.getNext();for(;d;)d.name!==e.name&&u.push(d),d=c.getNext();return u.push(e),em(u,o.getCompare())}else return Hl;else{const u=t.get(e.name);let c=i;return u&&(c=c.remove(new Ye(e.name,u))),c.insert(e,e.node)}});return new Ds(r,this.indexSet_)}removeFromIndexes(e,t){const r=Lg(this.indexes_,i=>{if(i===Hl)return i;{const s=t.get(e.name);return s?i.remove(new Ye(e.name,s)):i}});return new Ds(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let oh;class ot{constructor(e,t,r){this.children_=e,this.priorityNode_=t,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&YP(this.priorityNode_),this.children_.isEmpty()&&le(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return oh||(oh=new ot(new Pr(Vw),null,Ds.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||oh}updatePriority(e){return this.children_.isEmpty()?this:new ot(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?oh:t}}getChild(e){const t=Qe(e);return t===null?this:this.getImmediateChild(t).getChild(Ct(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(le(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const r=new Ye(e,t);let i,s;t.isEmpty()?(i=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,t),s=this.indexMap_.addToIndexes(r,this.children_));const o=i.isEmpty()?oh:this.priorityNode_;return new ot(i,o,s)}}updateChild(e,t){const r=Qe(e);if(r===null)return t;{le(Qe(e)!==".priority"||Qo(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(r).updateChild(Ct(e),t);return this.updateImmediateChild(r,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let r=0,i=0,s=!0;if(this.forEachChild(Zn,(o,u)=>{t[o]=u.val(e),r++,s&&ot.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):s=!1}),!e&&s&&i<2*r){const o=[];for(const u in t)o[u]=t[u];return o}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+QP(this.getPriority().val())+":"),this.forEachChild(Zn,(t,r)=>{const i=r.hash();i!==""&&(e+=":"+t+":"+i)}),this.lazyHash_=e===""?"":SP(e)}return this.lazyHash_}getPredecessorChildName(e,t,r){const i=this.resolveIndex_(r);if(i){const s=i.getPredecessorKey(new Ye(e,t));return s?s.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const r=t.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Ye(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const r=t.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Ye(t,this.children_.get(t)):null}forEachChild(e,t){const r=this.resolveIndex_(e);return r?r.inorderTraversal(i=>t(i.name,i.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const r=this.resolveIndex_(t);if(r)return r.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,Ye.Wrap);let s=i.peek();for(;s!=null&&t.compare(s,e)<0;)i.getNext(),s=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const r=this.resolveIndex_(t);if(r)return r.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,Ye.Wrap);let s=i.peek();for(;s!=null&&t.compare(s,e)>0;)i.getNext(),s=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Xd?-1:0}withIndex(e){if(e===Iu||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new ot(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Iu||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const r=this.getIterator(Zn),i=t.getIterator(Zn);let s=r.getNext(),o=i.getNext();for(;s&&o;){if(s.name!==o.name||!s.node.equals(o.node))return!1;s=r.getNext(),o=i.getNext()}return s===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===Iu?null:this.indexMap_.get(e.toString())}}ot.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class bF extends ot{constructor(){super(new Pr(Vw),ot.EMPTY_NODE,Ds.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ot.EMPTY_NODE}isEmpty(){return!1}}const Xd=new bF;Object.defineProperties(Ye,{MIN:{value:new Ye(Bu,ot.EMPTY_NODE)},MAX:{value:new Ye(tl,Xd)}});KP.__EMPTY_NODE=ot.EMPTY_NODE;mn.__childrenNodeConstructor=ot;xF(Xd);DF(Xd);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FF=!0;function Jn(n,e=null){if(n===null)return ot.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),le(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new mn(t,Jn(e))}if(!(n instanceof Array)&&FF){const t=[];let r=!1;if(ii(n,(o,u)=>{if(o.substring(0,1)!=="."){const c=Jn(u);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),t.push(new Ye(o,c)))}}),t.length===0)return ot.EMPTY_NODE;const s=em(t,kF,o=>o.name,Vw);if(r){const o=em(t,Zn.getCompare());return new ot(s,Jn(e),new Ds({".priority":o},{".priority":Zn}))}else return new ot(s,Jn(e),Ds.Default)}else{let t=ot.EMPTY_NODE;return ii(n,(r,i)=>{if(Qs(n,r)&&r.substring(0,1)!=="."){const s=Jn(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(Jn(e))}}NF(Jn);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VF extends Km{constructor(e){super(),this.indexPath_=e,le(!je(e)&&Qe(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return s===0?rc(e.name,t.name):s}makePost(e,t){const r=Jn(e),i=ot.EMPTY_NODE.updateChild(this.indexPath_,r);return new Ye(t,i)}maxPost(){const e=ot.EMPTY_NODE.updateChild(this.indexPath_,Xd);return new Ye(tl,e)}toString(){return WP(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UF extends Km{compare(e,t){const r=e.node.compareTo(t.node);return r===0?rc(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Ye.MIN}maxPost(){return Ye.MAX}makePost(e,t){const r=Jn(e);return new Ye(t,r)}toString(){return".value"}}const zF=new UF;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BF(n){return{type:"value",snapshotNode:n}}function GF(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function jF(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function k3(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function WF(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uw{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Zn}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return le(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return le(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Bu}hasEnd(){return this.endSet_}getIndexEndValue(){return le(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return le(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:tl}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return le(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Zn}copy(){const e=new Uw;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function x3(n){const e={};if(n.isDefault())return e;let t;if(n.index_===Zn?t="$priority":n.index_===zF?t="$value":n.index_===Iu?t="$key":(le(n.index_ instanceof VF,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=Dn(t),n.startSet_){const r=n.startAfterSet_?"startAfter":"startAt";e[r]=Dn(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+Dn(n.indexStartName_))}if(n.endSet_){const r=n.endBeforeSet_?"endBefore":"endAt";e[r]=Dn(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+Dn(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function N3(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==Zn&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tm extends BP{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Qd("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(le(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const o=tm.getListenId_(e,r),u={};this.listens_[o]=u;const c=x3(e._queryParams);this.restRequest_(s+".json",c,(d,p)=>{let m=p;if(d===404&&(m=null,d=null),d===null&&this.onDataUpdate_(s,m,!1,r),Mu(this.listens_,o)===u){let y;d?d===401?y="permission_denied":y="rest_error:"+d:y="ok",i(y,null)}})}unlisten(e,t){const r=tm.getListenId_(e,t);delete this.listens_[r]}get(e){const t=x3(e._queryParams),r=e._path.toString(),i=new D2;return this.restRequest_(r+".json",t,(s,o)=>{let u=o;s===404&&(u=null,s=null),s===null?(this.onDataUpdate_(r,u,!1,null),i.resolve(u)):i.reject(new Error(u))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Xu(t);this.log_("Sending REST request for "+o);const u=new XMLHttpRequest;u.onreadystatechange=()=>{if(r&&u.readyState===4){this.log_("REST Response for "+o+" received. status:",u.status,"response:",u.responseText);let c=null;if(u.status>=200&&u.status<300){try{c=od(u.responseText)}catch{Fr("Failed to parse JSON response for "+o+": "+u.responseText)}r(null,c)}else u.status!==401&&u.status!==404&&Fr("Got unsuccessful REST response for "+o+" Status: "+u.status),r(u.status);r=null}},u.open("GET",o,!0),u.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HF{constructor(){this.rootNode_=ot.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nm(){return{value:null,children:new Map}}function ZP(n,e,t){if(je(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const r=Qe(e);n.children.has(r)||n.children.set(r,nm());const i=n.children.get(r);e=Ct(e),ZP(i,e,t)}}function yv(n,e,t){n.value!==null?t(e,n.value):$F(n,(r,i)=>{const s=new Pt(e.toString()+"/"+r);yv(i,s,t)})}function $F(n,e){n.children.forEach((t,r)=>{e(r,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qF{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&ii(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D3=10*1e3,KF=30*1e3,QF=5*60*1e3;class YF{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new qF(e);const r=D3+(KF-D3)*Math.random();zh(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;ii(e,(i,s)=>{s>0&&Qs(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),zh(this.reportStats_.bind(this),Math.floor(Math.random()*2*QF))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Yi;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Yi||(Yi={}));function eR(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function tR(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function nR(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rm{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Yi.ACK_USER_WRITE,this.source=eR()}operationForChild(e){if(je(this.path)){if(this.affectedTree.value!=null)return le(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Pt(e));return new rm(gt(),t,this.revert)}}else return le(Qe(this.path)===e,"operationForChild called for unrelated child."),new rm(Ct(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Yi.OVERWRITE}operationForChild(e){return je(this.path)?new nl(this.source,gt(),this.snap.getImmediateChild(e)):new nl(this.source,Ct(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Yi.MERGE}operationForChild(e){if(je(this.path)){const t=this.children.subtree(new Pt(e));return t.isEmpty()?null:t.value?new nl(this.source,gt(),t.value):new wd(this.source,gt(),t)}else return le(Qe(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new wd(this.source,Ct(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zw{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(je(e))return this.isFullyInitialized()&&!this.filtered_;const t=Qe(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}function XF(n,e,t,r){const i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(WF(o.childName,o.snapshotNode))}),ah(n,i,"child_removed",e,r,t),ah(n,i,"child_added",e,r,t),ah(n,i,"child_moved",s,r,t),ah(n,i,"child_changed",e,r,t),ah(n,i,"value",e,r,t),i}function ah(n,e,t,r,i,s){const o=r.filter(u=>u.type===t);o.sort((u,c)=>ZF(n,u,c)),o.forEach(u=>{const c=JF(n,u,s);i.forEach(d=>{d.respondsTo(u.type)&&e.push(d.createEvent(c,n.query_))})})}function JF(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function ZF(n,e,t){if(e.childName==null||t.childName==null)throw Yu("Should only compare child_ events.");const r=new Ye(e.childName,e.snapshotNode),i=new Ye(t.childName,t.snapshotNode);return n.index_.compare(r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rR(n,e){return{eventCache:n,serverCache:e}}function Bh(n,e,t,r){return rR(new zw(e,t,r),n.serverCache)}function iR(n,e,t,r){return rR(n.eventCache,new zw(e,t,r))}function vv(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function rl(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let My;const eV=()=>(My||(My=new Pr(zb)),My);class Tt{constructor(e,t=eV()){this.value=e,this.children=t}static fromObject(e){let t=new Tt(null);return ii(e,(r,i)=>{t=t.set(new Pt(r),i)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:gt(),value:this.value};if(je(e))return null;{const r=Qe(e),i=this.children.get(r);if(i!==null){const s=i.findRootMostMatchingPathAndValue(Ct(e),t);return s!=null?{path:Sn(new Pt(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(je(e))return this;{const t=Qe(e),r=this.children.get(t);return r!==null?r.subtree(Ct(e)):new Tt(null)}}set(e,t){if(je(e))return new Tt(t,this.children);{const r=Qe(e),s=(this.children.get(r)||new Tt(null)).set(Ct(e),t),o=this.children.insert(r,s);return new Tt(this.value,o)}}remove(e){if(je(e))return this.children.isEmpty()?new Tt(null):new Tt(null,this.children);{const t=Qe(e),r=this.children.get(t);if(r){const i=r.remove(Ct(e));let s;return i.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,i),this.value===null&&s.isEmpty()?new Tt(null):new Tt(this.value,s)}else return this}}get(e){if(je(e))return this.value;{const t=Qe(e),r=this.children.get(t);return r?r.get(Ct(e)):null}}setTree(e,t){if(je(e))return t;{const r=Qe(e),s=(this.children.get(r)||new Tt(null)).setTree(Ct(e),t);let o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new Tt(this.value,o)}}fold(e){return this.fold_(gt(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Sn(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,gt(),t)}findOnPath_(e,t,r){const i=this.value?r(t,this.value):!1;if(i)return i;if(je(e))return null;{const s=Qe(e),o=this.children.get(s);return o?o.findOnPath_(Ct(e),Sn(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,gt(),t)}foreachOnPath_(e,t,r){if(je(e))return this;{this.value&&r(t,this.value);const i=Qe(e),s=this.children.get(i);return s?s.foreachOnPath_(Ct(e),Sn(t,i),r):new Tt(null)}}foreach(e){this.foreach_(gt(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(Sn(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pi{constructor(e){this.writeTree_=e}static empty(){return new Pi(new Tt(null))}}function Gh(n,e,t){if(je(e))return new Pi(new Tt(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){const i=r.path;let s=r.value;const o=Zr(i,e);return s=s.updateChild(o,t),new Pi(n.writeTree_.set(i,s))}else{const i=new Tt(t),s=n.writeTree_.setTree(e,i);return new Pi(s)}}}function M3(n,e,t){let r=n;return ii(t,(i,s)=>{r=Gh(r,Sn(e,i),s)}),r}function O3(n,e){if(je(e))return Pi.empty();{const t=n.writeTree_.setTree(e,new Tt(null));return new Pi(t)}}function wv(n,e){return hl(n,e)!=null}function hl(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(Zr(t.path,e)):null}function L3(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(Zn,(r,i)=>{e.push(new Ye(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new Ye(r,i.value))}),e}function Go(n,e){if(je(e))return n;{const t=hl(n,e);return t!=null?new Pi(new Tt(t)):new Pi(n.writeTree_.subtree(e))}}function Sv(n){return n.writeTree_.isEmpty()}function Gu(n,e){return sR(gt(),n.writeTree_,e)}function sR(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(le(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):t=sR(Sn(n,i),s,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(Sn(n,".priority"),r)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oR(n,e){return hR(e,n)}function tV(n,e,t,r,i){le(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=Gh(n.visibleWrites,e,t)),n.lastWriteId=r}function nV(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}function rV(n,e){const t=n.allWrites.findIndex(u=>u.writeId===e);le(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){const u=n.allWrites[o];u.visible&&(o>=t&&iV(u,r.path)?i=!1:Ei(r.path,u.path)&&(s=!0)),o--}if(i){if(s)return sV(n),!0;if(r.snap)n.visibleWrites=O3(n.visibleWrites,r.path);else{const u=r.children;ii(u,c=>{n.visibleWrites=O3(n.visibleWrites,Sn(r.path,c))})}return!0}else return!1}function iV(n,e){if(n.snap)return Ei(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&Ei(Sn(n.path,t),e))return!0;return!1}function sV(n){n.visibleWrites=aR(n.allWrites,oV,gt()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function oV(n){return n.visible}function aR(n,e,t){let r=Pi.empty();for(let i=0;i<n.length;++i){const s=n[i];if(e(s)){const o=s.path;let u;if(s.snap)Ei(t,o)?(u=Zr(t,o),r=Gh(r,u,s.snap)):Ei(o,t)&&(u=Zr(o,t),r=Gh(r,gt(),s.snap.getChild(u)));else if(s.children){if(Ei(t,o))u=Zr(t,o),r=M3(r,u,s.children);else if(Ei(o,t))if(u=Zr(o,t),je(u))r=M3(r,gt(),s.children);else{const c=Mu(s.children,Qe(u));if(c){const d=c.getChild(Ct(u));r=Gh(r,gt(),d)}}}else throw Yu("WriteRecord should have .snap or .children")}}return r}function lR(n,e,t,r,i){if(!r&&!i){const s=hl(n.visibleWrites,e);if(s!=null)return s;{const o=Go(n.visibleWrites,e);if(Sv(o))return t;if(t==null&&!wv(o,gt()))return null;{const u=t||ot.EMPTY_NODE;return Gu(o,u)}}}else{const s=Go(n.visibleWrites,e);if(!i&&Sv(s))return t;if(!i&&t==null&&!wv(s,gt()))return null;{const o=function(d){return(d.visible||i)&&(!r||!~r.indexOf(d.writeId))&&(Ei(d.path,e)||Ei(e,d.path))},u=aR(n.allWrites,o,e),c=t||ot.EMPTY_NODE;return Gu(u,c)}}}function aV(n,e,t){let r=ot.EMPTY_NODE;const i=hl(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Zn,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){const s=Go(n.visibleWrites,e);return t.forEachChild(Zn,(o,u)=>{const c=Gu(Go(s,new Pt(o)),u);r=r.updateImmediateChild(o,c)}),L3(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{const s=Go(n.visibleWrites,e);return L3(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function lV(n,e,t,r,i){le(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=Sn(e,t);if(wv(n.visibleWrites,s))return null;{const o=Go(n.visibleWrites,s);return Sv(o)?i.getChild(t):Gu(o,i.getChild(t))}}function uV(n,e,t,r){const i=Sn(e,t),s=hl(n.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(t)){const o=Go(n.visibleWrites,i);return Gu(o,r.getNode().getImmediateChild(t))}else return null}function cV(n,e){return hl(n.visibleWrites,e)}function hV(n,e,t,r,i,s,o){let u;const c=Go(n.visibleWrites,e),d=hl(c,gt());if(d!=null)u=d;else if(t!=null)u=Gu(c,t);else return[];if(u=u.withIndex(o),!u.isEmpty()&&!u.isLeafNode()){const p=[],m=o.getCompare(),y=s?u.getReverseIteratorFrom(r,o):u.getIteratorFrom(r,o);let E=y.getNext();for(;E&&p.length<i;)m(E,r)!==0&&p.push(E),E=y.getNext();return p}else return[]}function dV(){return{visibleWrites:Pi.empty(),allWrites:[],lastWriteId:-1}}function Ev(n,e,t,r){return lR(n.writeTree,n.treePath,e,t,r)}function uR(n,e){return aV(n.writeTree,n.treePath,e)}function b3(n,e,t,r){return lV(n.writeTree,n.treePath,e,t,r)}function im(n,e){return cV(n.writeTree,Sn(n.treePath,e))}function fV(n,e,t,r,i,s){return hV(n.writeTree,n.treePath,e,t,r,i,s)}function Bw(n,e,t){return uV(n.writeTree,n.treePath,e,t)}function cR(n,e){return hR(Sn(n.treePath,e),n.writeTree)}function hR(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pV{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;le(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),le(r!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const s=i.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(r,k3(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(r,jF(r,i.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(r,GF(r,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(r,k3(r,e.snapshotNode,i.oldSnap));else throw Yu("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gV{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}}const dR=new gV;class Gw{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new zw(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Bw(this.writes_,e,r)}}getChildAfterChild(e,t,r){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:rl(this.viewCache_),s=fV(this.writes_,i,t,1,r,e);return s.length===0?null:s[0]}}function mV(n,e){le(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),le(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function _V(n,e,t,r,i){const s=new pV;let o,u;if(t.type===Yi.OVERWRITE){const d=t;d.source.fromUser?o=Tv(n,e,d.path,d.snap,r,i,s):(le(d.source.fromServer,"Unknown source."),u=d.source.tagged||e.serverCache.isFiltered()&&!je(d.path),o=sm(n,e,d.path,d.snap,r,i,u,s))}else if(t.type===Yi.MERGE){const d=t;d.source.fromUser?o=vV(n,e,d.path,d.children,r,i,s):(le(d.source.fromServer,"Unknown source."),u=d.source.tagged||e.serverCache.isFiltered(),o=Cv(n,e,d.path,d.children,r,i,u,s))}else if(t.type===Yi.ACK_USER_WRITE){const d=t;d.revert?o=EV(n,e,d.path,r,i,s):o=wV(n,e,d.path,d.affectedTree,r,i,s)}else if(t.type===Yi.LISTEN_COMPLETE)o=SV(n,e,t.path,r,s);else throw Yu("Unknown operation type: "+t.type);const c=s.getChanges();return yV(e,o,c),{viewCache:o,changes:c}}function yV(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=vv(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(BF(vv(e)))}}function fR(n,e,t,r,i,s){const o=e.eventCache;if(im(r,t)!=null)return e;{let u,c;if(je(t))if(le(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const d=rl(e),p=d instanceof ot?d:ot.EMPTY_NODE,m=uR(r,p);u=n.filter.updateFullNode(e.eventCache.getNode(),m,s)}else{const d=Ev(r,rl(e));u=n.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{const d=Qe(t);if(d===".priority"){le(Qo(t)===1,"Can't have a priority with additional path components");const p=o.getNode();c=e.serverCache.getNode();const m=b3(r,t,p,c);m!=null?u=n.filter.updatePriority(p,m):u=o.getNode()}else{const p=Ct(t);let m;if(o.isCompleteForChild(d)){c=e.serverCache.getNode();const y=b3(r,t,o.getNode(),c);y!=null?m=o.getNode().getImmediateChild(d).updateChild(p,y):m=o.getNode().getImmediateChild(d)}else m=Bw(r,d,e.serverCache);m!=null?u=n.filter.updateChild(o.getNode(),d,m,p,i,s):u=o.getNode()}}return Bh(e,u,o.isFullyInitialized()||je(t),n.filter.filtersNodes())}}function sm(n,e,t,r,i,s,o,u){const c=e.serverCache;let d;const p=o?n.filter:n.filter.getIndexedFilter();if(je(t))d=p.updateFullNode(c.getNode(),r,null);else if(p.filtersNodes()&&!c.isFiltered()){const E=c.getNode().updateChild(t,r);d=p.updateFullNode(c.getNode(),E,null)}else{const E=Qe(t);if(!c.isCompleteForPath(t)&&Qo(t)>1)return e;const S=Ct(t),D=c.getNode().getImmediateChild(E).updateChild(S,r);E===".priority"?d=p.updatePriority(c.getNode(),D):d=p.updateChild(c.getNode(),E,D,S,dR,null)}const m=iR(e,d,c.isFullyInitialized()||je(t),p.filtersNodes()),y=new Gw(i,m,s);return fR(n,m,t,i,y,u)}function Tv(n,e,t,r,i,s,o){const u=e.eventCache;let c,d;const p=new Gw(i,e,s);if(je(t))d=n.filter.updateFullNode(e.eventCache.getNode(),r,o),c=Bh(e,d,!0,n.filter.filtersNodes());else{const m=Qe(t);if(m===".priority")d=n.filter.updatePriority(e.eventCache.getNode(),r),c=Bh(e,d,u.isFullyInitialized(),u.isFiltered());else{const y=Ct(t),E=u.getNode().getImmediateChild(m);let S;if(je(y))S=r;else{const x=p.getCompleteChild(m);x!=null?jP(y)===".priority"&&x.getChild(HP(y)).isEmpty()?S=x:S=x.updateChild(y,r):S=ot.EMPTY_NODE}if(E.equals(S))c=e;else{const x=n.filter.updateChild(u.getNode(),m,S,y,p,o);c=Bh(e,x,u.isFullyInitialized(),n.filter.filtersNodes())}}}return c}function F3(n,e){return n.eventCache.isCompleteForChild(e)}function vV(n,e,t,r,i,s,o){let u=e;return r.foreach((c,d)=>{const p=Sn(t,c);F3(e,Qe(p))&&(u=Tv(n,u,p,d,i,s,o))}),r.foreach((c,d)=>{const p=Sn(t,c);F3(e,Qe(p))||(u=Tv(n,u,p,d,i,s,o))}),u}function V3(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function Cv(n,e,t,r,i,s,o,u){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,d;je(t)?d=r:d=new Tt(null).setTree(t,r);const p=e.serverCache.getNode();return d.children.inorderTraversal((m,y)=>{if(p.hasChild(m)){const E=e.serverCache.getNode().getImmediateChild(m),S=V3(n,E,y);c=sm(n,c,new Pt(m),S,i,s,o,u)}}),d.children.inorderTraversal((m,y)=>{const E=!e.serverCache.isCompleteForChild(m)&&y.value===null;if(!p.hasChild(m)&&!E){const S=e.serverCache.getNode().getImmediateChild(m),x=V3(n,S,y);c=sm(n,c,new Pt(m),x,i,s,o,u)}}),c}function wV(n,e,t,r,i,s,o){if(im(i,t)!=null)return e;const u=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(je(t)&&c.isFullyInitialized()||c.isCompleteForPath(t))return sm(n,e,t,c.getNode().getChild(t),i,s,u,o);if(je(t)){let d=new Tt(null);return c.getNode().forEachChild(Iu,(p,m)=>{d=d.set(new Pt(p),m)}),Cv(n,e,t,d,i,s,u,o)}else return e}else{let d=new Tt(null);return r.foreach((p,m)=>{const y=Sn(t,p);c.isCompleteForPath(y)&&(d=d.set(p,c.getNode().getChild(y)))}),Cv(n,e,t,d,i,s,u,o)}}function SV(n,e,t,r,i){const s=e.serverCache,o=iR(e,s.getNode(),s.isFullyInitialized()||je(t),s.isFiltered());return fR(n,o,t,r,dR,i)}function EV(n,e,t,r,i,s){let o;if(im(r,t)!=null)return e;{const u=new Gw(r,e,i),c=e.eventCache.getNode();let d;if(je(t)||Qe(t)===".priority"){let p;if(e.serverCache.isFullyInitialized())p=Ev(r,rl(e));else{const m=e.serverCache.getNode();le(m instanceof ot,"serverChildren would be complete if leaf node"),p=uR(r,m)}p=p,d=n.filter.updateFullNode(c,p,s)}else{const p=Qe(t);let m=Bw(r,p,e.serverCache);m==null&&e.serverCache.isCompleteForChild(p)&&(m=c.getImmediateChild(p)),m!=null?d=n.filter.updateChild(c,p,m,Ct(t),u,s):e.eventCache.getNode().hasChild(p)?d=n.filter.updateChild(c,p,ot.EMPTY_NODE,Ct(t),u,s):d=c,d.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Ev(r,rl(e)),o.isLeafNode()&&(d=n.filter.updateFullNode(d,o,s)))}return o=e.serverCache.isFullyInitialized()||im(r,gt())!=null,Bh(e,d,o,n.filter.filtersNodes())}}function TV(n,e){const t=rl(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!je(e)&&!t.getImmediateChild(Qe(e)).isEmpty())?t.getChild(e):null}function U3(n,e,t,r){e.type===Yi.MERGE&&e.source.queryId!==null&&(le(rl(n.viewCache_),"We should always have a full cache before handling merges"),le(vv(n.viewCache_),"Missing event cache, even though we have a server cache"));const i=n.viewCache_,s=_V(n.processor_,i,e,t,r);return mV(n.processor_,s.viewCache),le(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,CV(n,s.changes,s.viewCache.eventCache.getNode())}function CV(n,e,t,r){const i=n.eventRegistrations_;return XF(n.eventGenerator_,e,t,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let z3;function IV(n){le(!z3,"__referenceConstructor has already been defined"),z3=n}function jw(n,e,t,r){const i=e.source.queryId;if(i!==null){const s=n.views.get(i);return le(s!=null,"SyncTree gave us an op for an invalid query."),U3(s,e,t,r)}else{let s=[];for(const o of n.views.values())s=s.concat(U3(o,e,t,r));return s}}function Ww(n,e){let t=null;for(const r of n.views.values())t=t||TV(r,e);return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let B3;function PV(n){le(!B3,"__referenceConstructor has already been defined"),B3=n}class G3{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Tt(null),this.pendingWriteTree_=dV(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function RV(n,e,t,r,i){return tV(n.pendingWriteTree_,e,t,r,i),i?Ym(n,new nl(eR(),e,t)):[]}function fu(n,e,t=!1){const r=nV(n.pendingWriteTree_,e);if(rV(n.pendingWriteTree_,e)){let s=new Tt(null);return r.snap!=null?s=s.set(gt(),!0):ii(r.children,o=>{s=s.set(new Pt(o),!0)}),Ym(n,new rm(r.path,s,t))}else return[]}function Qm(n,e,t){return Ym(n,new nl(tR(),e,t))}function AV(n,e,t){const r=Tt.fromObject(t);return Ym(n,new wd(tR(),e,r))}function kV(n,e,t,r){const i=_R(n,r);if(i!=null){const s=yR(i),o=s.path,u=s.queryId,c=Zr(o,e),d=new nl(nR(u),c,t);return vR(n,o,d)}else return[]}function xV(n,e,t,r){const i=_R(n,r);if(i){const s=yR(i),o=s.path,u=s.queryId,c=Zr(o,e),d=Tt.fromObject(t),p=new wd(nR(u),c,d);return vR(n,o,p)}else return[]}function pR(n,e,t){const i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,u)=>{const c=Zr(o,e),d=Ww(u,c);if(d)return d});return lR(i,e,s,t,!0)}function Ym(n,e){return gR(e,n.syncPointTree_,null,oR(n.pendingWriteTree_,gt()))}function gR(n,e,t,r){if(je(n.path))return mR(n,e,t,r);{const i=e.get(gt());t==null&&i!=null&&(t=Ww(i,gt()));let s=[];const o=Qe(n.path),u=n.operationForChild(o),c=e.children.get(o);if(c&&u){const d=t?t.getImmediateChild(o):null,p=cR(r,o);s=s.concat(gR(u,c,d,p))}return i&&(s=s.concat(jw(i,n,r,t))),s}}function mR(n,e,t,r){const i=e.get(gt());t==null&&i!=null&&(t=Ww(i,gt()));let s=[];return e.children.inorderTraversal((o,u)=>{const c=t?t.getImmediateChild(o):null,d=cR(r,o),p=n.operationForChild(o);p&&(s=s.concat(mR(p,u,c,d)))}),i&&(s=s.concat(jw(i,n,r,t))),s}function _R(n,e){return n.tagToQueryMap.get(e)}function yR(n){const e=n.indexOf("$");return le(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new Pt(n.substr(0,e))}}function vR(n,e,t){const r=n.syncPointTree_.get(e);le(r,"Missing sync point for query tag that we're tracking");const i=oR(n.pendingWriteTree_,e);return jw(r,t,i,null)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hw{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new Hw(t)}node(){return this.node_}}class $w{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Sn(this.path_,e);return new $w(this.syncTree_,t)}node(){return pR(this.syncTree_,this.path_)}}const NV=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},j3=function(n,e,t){if(!n||typeof n!="object")return n;if(le(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return DV(n[".sv"],e,t);if(typeof n[".sv"]=="object")return MV(n[".sv"],e);le(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},DV=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:le(!1,"Unexpected server value: "+n)}},MV=function(n,e,t){n.hasOwnProperty("increment")||le(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;typeof r!="number"&&le(!1,"Unexpected increment value: "+r);const i=e.node();if(le(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return typeof o!="number"?r:o+r},OV=function(n,e,t,r){return qw(e,new $w(t,n),r)},LV=function(n,e,t){return qw(n,new Hw(e),t)};function qw(n,e,t){const r=n.getPriority().val(),i=j3(r,e.getImmediateChild(".priority"),t);let s;if(n.isLeafNode()){const o=n,u=j3(o.getValue(),e,t);return u!==o.getValue()||i!==o.getPriority().val()?new mn(u,Jn(i)):n}else{const o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new mn(i))),o.forEachChild(Zn,(u,c)=>{const d=qw(c,e.getImmediateChild(u),t);d!==c&&(s=s.updateImmediateChild(u,d))}),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kw{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function Qw(n,e){let t=e instanceof Pt?e:new Pt(e),r=n,i=Qe(t);for(;i!==null;){const s=Mu(r.node.children,i)||{children:{},childCount:0};r=new Kw(i,r,s),t=Ct(t),i=Qe(t)}return r}function ic(n){return n.node.value}function wR(n,e){n.node.value=e,Iv(n)}function SR(n){return n.node.childCount>0}function bV(n){return ic(n)===void 0&&!SR(n)}function Xm(n,e){ii(n.node.children,(t,r)=>{e(new Kw(t,n,r))})}function ER(n,e,t,r){t&&e(n),Xm(n,i=>{ER(i,e,!0)})}function FV(n,e,t){let r=n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Jd(n){return new Pt(n.parent===null?n.name:Jd(n.parent)+"/"+n.name)}function Iv(n){n.parent!==null&&VV(n.parent,n.name,n)}function VV(n,e,t){const r=bV(t),i=Qs(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,Iv(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,Iv(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UV=/[\[\].#$\/\u0000-\u001F\u007F]/,zV=/[\[\].#$\u0000-\u001F\u007F]/,Oy=10*1024*1024,TR=function(n){return typeof n=="string"&&n.length!==0&&!UV.test(n)},BV=function(n){return typeof n=="string"&&n.length!==0&&!zV.test(n)},GV=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),BV(n)},CR=function(n,e,t){const r=t instanceof Pt?new SF(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Da(r));if(typeof e=="function")throw new Error(n+"contains a function "+Da(r)+" with contents = "+e.toString());if(EP(e))throw new Error(n+"contains "+e.toString()+" "+Da(r));if(typeof e=="string"&&e.length>Oy/3&&Am(e)>Oy)throw new Error(n+"contains a string greater than "+Oy+" utf8 bytes "+Da(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(ii(e,(o,u)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!TR(o)))throw new Error(n+" contains an invalid key ("+o+") "+Da(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);EF(r,o),CR(n,u,r),TF(r)}),i&&s)throw new Error(n+' contains ".value" child '+Da(r)+" in addition to actual children.")}},jV=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!TR(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!GV(t))throw new Error(Zx(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WV{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function HV(n,e){let t=null;for(let r=0;r<e.length;r++){const i=e[r],s=i.getPath();t!==null&&!$P(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)}function dl(n,e,t){HV(n,t),$V(n,r=>Ei(r,e)||Ei(e,r))}function $V(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const i=n.eventLists_[r];if(i){const s=i.path;e(s)?(qV(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function qV(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const r=t.getEventRunner();Uh&&Xn("event: "+t.toString()),Yd(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KV="repo_interrupt",QV=25;class YV{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new WV,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=nm(),this.transactionQueueTree_=new Kw,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function XV(n,e,t){if(n.stats_=Lw(n.repoInfo_),n.forceRestClient_||$b())n.server_=new tm(n.repoInfo_,(r,i,s,o)=>{W3(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>H3(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Dn(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new bs(n.repoInfo_,e,(r,i,s,o)=>{W3(n,r,i,s,o)},r=>{H3(n,r)},r=>{ZV(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=Xb(n.repoInfo_,()=>new YF(n.stats_,n.server_)),n.infoData_=new HF,n.infoSyncTree_=new G3({startListening:(r,i,s,o)=>{let u=[];const c=n.infoData_.getNode(r._path);return c.isEmpty()||(u=Qm(n.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),u},stopListening:()=>{}}),Yw(n,"connected",!1),n.serverSyncTree_=new G3({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(u,c)=>{const d=o(u,c);dl(n.eventQueue_,r._path,d)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function JV(n){const t=n.infoData_.getNode(new Pt(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function IR(n){return NV({timestamp:JV(n)})}function W3(n,e,t,r,i){n.dataUpdateCount++;const s=new Pt(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){const c=Lg(t,d=>Jn(d));o=xV(n.serverSyncTree_,s,c,i)}else{const c=Jn(t);o=kV(n.serverSyncTree_,s,c,i)}else if(r){const c=Lg(t,d=>Jn(d));o=AV(n.serverSyncTree_,s,c)}else{const c=Jn(t);o=Qm(n.serverSyncTree_,s,c)}let u=s;o.length>0&&(u=Jw(n,s)),dl(n.eventQueue_,u,o)}function H3(n,e){Yw(n,"connected",e),e===!1&&tU(n)}function ZV(n,e){ii(e,(t,r)=>{Yw(n,t,r)})}function Yw(n,e,t){const r=new Pt("/.info/"+e),i=Jn(t);n.infoData_.updateSnapshot(r,i);const s=Qm(n.infoSyncTree_,r,i);dl(n.eventQueue_,r,s)}function eU(n){return n.nextWriteId_++}function tU(n){PR(n,"onDisconnectEvents");const e=IR(n),t=nm();yv(n.onDisconnect_,gt(),(i,s)=>{const o=OV(i,s,n.serverSyncTree_,e);ZP(t,i,o)});let r=[];yv(t,gt(),(i,s)=>{r=r.concat(Qm(n.serverSyncTree_,i,s));const o=sU(n,i);Jw(n,o)}),n.onDisconnect_=nm(),dl(n.eventQueue_,gt(),r)}function nU(n){n.persistentConnection_&&n.persistentConnection_.interrupt(KV)}function PR(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Xn(t,...e)}function RR(n,e,t){return pR(n.serverSyncTree_,e,t)||ot.EMPTY_NODE}function Xw(n,e=n.transactionQueueTree_){if(e||Jm(n,e),ic(e)){const t=kR(n,e);le(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&rU(n,Jd(e),t)}else SR(e)&&Xm(e,t=>{Xw(n,t)})}function rU(n,e,t){const r=t.map(d=>d.currentWriteId),i=RR(n,e,r);let s=i;const o=i.hash();for(let d=0;d<t.length;d++){const p=t[d];le(p.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),p.status=1,p.retryCount++;const m=Zr(e,p.path);s=s.updateChild(m,p.currentOutputSnapshotRaw)}const u=s.val(!0),c=e;n.server_.put(c.toString(),u,d=>{PR(n,"transaction put response",{path:c.toString(),status:d});let p=[];if(d==="ok"){const m=[];for(let y=0;y<t.length;y++)t[y].status=2,p=p.concat(fu(n.serverSyncTree_,t[y].currentWriteId)),t[y].onComplete&&m.push(()=>t[y].onComplete(null,!0,t[y].currentOutputSnapshotResolved)),t[y].unwatcher();Jm(n,Qw(n.transactionQueueTree_,e)),Xw(n,n.transactionQueueTree_),dl(n.eventQueue_,e,p);for(let y=0;y<m.length;y++)Yd(m[y])}else{if(d==="datastale")for(let m=0;m<t.length;m++)t[m].status===3?t[m].status=4:t[m].status=0;else{Fr("transaction at "+c.toString()+" failed: "+d);for(let m=0;m<t.length;m++)t[m].status=4,t[m].abortReason=d}Jw(n,e)}},o)}function Jw(n,e){const t=AR(n,e),r=Jd(t),i=kR(n,t);return iU(n,i,r),r}function iU(n,e,t){if(e.length===0)return;const r=[];let i=[];const o=e.filter(u=>u.status===0).map(u=>u.currentWriteId);for(let u=0;u<e.length;u++){const c=e[u],d=Zr(t,c.path);let p=!1,m;if(le(d!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)p=!0,m=c.abortReason,i=i.concat(fu(n.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=QV)p=!0,m="maxretry",i=i.concat(fu(n.serverSyncTree_,c.currentWriteId,!0));else{const y=RR(n,c.path,o);c.currentInputSnapshot=y;const E=e[u].update(y.val());if(E!==void 0){CR("transaction failed: Data returned ",E,c.path);let S=Jn(E);typeof E=="object"&&E!=null&&Qs(E,".priority")||(S=S.updatePriority(y.getPriority()));const D=c.currentWriteId,k=IR(n),R=LV(S,y,k);c.currentOutputSnapshotRaw=S,c.currentOutputSnapshotResolved=R,c.currentWriteId=eU(n),o.splice(o.indexOf(D),1),i=i.concat(RV(n.serverSyncTree_,c.path,R,c.currentWriteId,c.applyLocally)),i=i.concat(fu(n.serverSyncTree_,D,!0))}else p=!0,m="nodata",i=i.concat(fu(n.serverSyncTree_,c.currentWriteId,!0))}dl(n.eventQueue_,t,i),i=[],p&&(e[u].status=2,function(y){setTimeout(y,Math.floor(0))}(e[u].unwatcher),e[u].onComplete&&(m==="nodata"?r.push(()=>e[u].onComplete(null,!1,e[u].currentInputSnapshot)):r.push(()=>e[u].onComplete(new Error(m),!1,null))))}Jm(n,n.transactionQueueTree_);for(let u=0;u<r.length;u++)Yd(r[u]);Xw(n,n.transactionQueueTree_)}function AR(n,e){let t,r=n.transactionQueueTree_;for(t=Qe(e);t!==null&&ic(r)===void 0;)r=Qw(r,t),e=Ct(e),t=Qe(e);return r}function kR(n,e){const t=[];return xR(n,e,t),t.sort((r,i)=>r.order-i.order),t}function xR(n,e,t){const r=ic(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);Xm(e,i=>{xR(n,i,t)})}function Jm(n,e){const t=ic(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,wR(e,t.length>0?t:void 0)}Xm(e,r=>{Jm(n,r)})}function sU(n,e){const t=Jd(AR(n,e)),r=Qw(n.transactionQueueTree_,e);return FV(r,i=>{Ly(n,i)}),Ly(n,r),ER(r,i=>{Ly(n,i)}),t}function Ly(n,e){const t=ic(e);if(t){const r=[];let i=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(le(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(le(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(fu(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?wR(e,void 0):t.length=s+1,dl(n.eventQueue_,Jd(e),i);for(let o=0;o<r.length;o++)Yd(r[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oU(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function aU(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Fr(`Invalid query segment '${t}' in query '${n}'`)}return e}const $3=function(n,e){const t=lU(n),r=t.namespace;t.domain==="firebase.com"&&$s(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&$s("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||Vb();const i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new OP(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new Pt(t.pathString)}},lU=function(n){let e="",t="",r="",i="",s="",o=!0,u="https",c=443;if(typeof n=="string"){let d=n.indexOf("//");d>=0&&(u=n.substring(0,d-1),n=n.substring(d+2));let p=n.indexOf("/");p===-1&&(p=n.length);let m=n.indexOf("?");m===-1&&(m=n.length),e=n.substring(0,Math.min(p,m)),p<m&&(i=oU(n.substring(p,m)));const y=aU(n.substring(Math.min(n.length,m)));d=e.indexOf(":"),d>=0?(o=u==="https"||u==="wss",c=parseInt(e.substring(d+1),10)):d=e.length;const E=e.slice(0,d);if(E.toLowerCase()==="localhost")t="localhost";else if(E.split(".").length<=2)t=E;else{const S=e.indexOf(".");r=e.substring(0,S).toLowerCase(),t=e.substring(S+1),s=r}"ns"in y&&(s=y.ns)}return{host:e,port:c,domain:t,subdomain:r,secure:o,scheme:u,pathString:i,namespace:s}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zw{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return je(this._path)?null:jP(this._path)}get ref(){return new sc(this._repo,this._path)}get _queryIdentifier(){const e=N3(this._queryParams),t=Mw(e);return t==="{}"?"default":t}get _queryObject(){return N3(this._queryParams)}isEqual(e){if(e=Lt(e),!(e instanceof Zw))return!1;const t=this._repo===e._repo,r=$P(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+wF(this._path)}}class sc extends Zw{constructor(e,t){super(e,t,new Uw,!1)}get parent(){const e=HP(this._path);return e===null?null:new sc(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}IV(sc);PV(sc);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uU="FIREBASE_DATABASE_EMULATOR_HOST",Pv={};let cU=!1;function hU(n,e,t,r){n.repoInfo_=new OP(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}function dU(n,e,t,r,i){let s=r||n.options.databaseURL;s===void 0&&(n.options.projectId||$s("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Xn("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=$3(s,i),u=o.repoInfo,c;typeof process<"u"&&d3&&(c=d3[uU]),c?(s=`http://${c}?ns=${u.namespace}`,o=$3(s,i),u=o.repoInfo):o.repoInfo.secure;const d=new Kb(n.name,n.options,e);jV("Invalid Firebase Database URL",o),je(o.path)||$s("Database URL must point to the root of a Firebase Database (not including a child path).");const p=pU(u,n,d,new qb(n.name,t));return new gU(p,n)}function fU(n,e){const t=Pv[e];(!t||t[n.key]!==n)&&$s(`Database ${e}(${n.repoInfo_}) has already been deleted.`),nU(n),delete t[n.key]}function pU(n,e,t,r){let i=Pv[e.name];i||(i={},Pv[e.name]=i);let s=i[n.toURLString()];return s&&$s("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new YV(n,cU,t,r),i[n.toURLString()]=s,s}class gU{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(XV(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new sc(this._repo,gt())),this._rootInternal}_delete(){return this._rootInternal!==null&&(fU(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&$s("Cannot call "+e+" on a deleted database.")}}function mU(n=L2(),e){const t=xm(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const r=o6("database");r&&_U(t,...r)}return t}function _U(n,e,t,r={}){n=Lt(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&$s("Cannot call useEmulator() after instance has already been initialized.");const i=n._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&$s('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new og(og.OWNER);else if(r.mockUserToken){const o=typeof r.mockUserToken=="string"?r.mockUserToken:u6(r.mockUserToken,n.app.options.projectId);s=new og(o)}hU(i,e,t,s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yU(n){Db(al),Ka(new Ho("database",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return dU(r,i,s,t)},"PUBLIC").setMultipleInstances(!0)),Zi(f3,p3,n),Zi(f3,p3,"esm2017")}bs.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};bs.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};yU();const vU={apiKey:"AIzaSyDQZvIf-wol_S9nLsAHlFNfyBSxViW8xWc",authDomain:"collabcanvas-d5bce.firebaseapp.com",projectId:"collabcanvas-d5bce",storageBucket:"collabcanvas-d5bce.firebasestorage.app",messagingSenderId:"484501248859",appId:"1:484501248859:web:026a6bbbaa8652239b587e",databaseURL:"https://collabcanvas-d5bce-default-rtdb.firebaseio.com"},eS=p6(vU),Sd=wM(eS),il=db(eS);mU(eS);const wU=({onSuccess:n,onSwitchToRegister:e})=>{const[t,r]=we.useState(""),[i,s]=we.useState(""),[o,u]=we.useState(!1),[c,d]=we.useState(null),p=async y=>{y.preventDefault(),u(!0),d(null);try{await sD(Sd,t,i),n==null||n()}catch(E){d(E.message)}finally{u(!1)}},m=async()=>{u(!0),d(null);try{const y=new Ps;await kD(Sd,y),n==null||n()}catch(y){d(y.message)}finally{u(!1)}};return X.jsxs("div",{className:"max-w-md mx-auto bg-white rounded-lg shadow-md p-6",children:[X.jsx("h2",{className:"text-2xl font-bold mb-6 text-center text-gray-800",children:"Sign In"}),c&&X.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:c}),X.jsxs("form",{onSubmit:p,className:"space-y-4",children:[X.jsxs("div",{children:[X.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),X.jsx("input",{id:"email",type:"email",value:t,onChange:y=>r(y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:o})]}),X.jsxs("div",{children:[X.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),X.jsx("input",{id:"password",type:"password",value:i,onChange:y=>s(y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:o})]}),X.jsx("button",{type:"submit",disabled:o,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 disabled:opacity-50",children:o?"Signing In...":"Sign In"})]}),X.jsx("div",{className:"my-4 text-center text-gray-500",children:"or"}),X.jsx("button",{onClick:m,disabled:o,className:"w-full bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700 disabled:opacity-50",children:"Sign in with Google"}),X.jsx("div",{className:"mt-4 text-center",children:X.jsx("button",{onClick:e,className:"text-blue-600 hover:underline text-sm",children:"Need an account? Sign up"})})]})},SU=({onSuccess:n,onSwitchToLogin:e})=>{const[t,r]=we.useState(""),[i,s]=we.useState(""),[o,u]=we.useState(""),[c,d]=we.useState(!1),[p,m]=we.useState(null),y=async E=>{if(E.preventDefault(),d(!0),m(null),i!==o){m("Passwords do not match"),d(!1);return}if(i.length<6){m("Password must be at least 6 characters"),d(!1);return}try{await iD(Sd,t,i),n==null||n()}catch(S){m(S.message)}finally{d(!1)}};return X.jsxs("div",{className:"max-w-md mx-auto bg-white rounded-lg shadow-md p-6",children:[X.jsx("h2",{className:"text-2xl font-bold mb-6 text-center text-gray-800",children:"Create Account"}),p&&X.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:p}),X.jsxs("form",{onSubmit:y,className:"space-y-4",children:[X.jsxs("div",{children:[X.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),X.jsx("input",{id:"email",type:"email",value:t,onChange:E=>r(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:c})]}),X.jsxs("div",{children:[X.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),X.jsx("input",{id:"password",type:"password",value:i,onChange:E=>s(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:c,minLength:6})]}),X.jsxs("div",{children:[X.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password"}),X.jsx("input",{id:"confirmPassword",type:"password",value:o,onChange:E=>u(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:c})]}),X.jsx("button",{type:"submit",disabled:c,className:"w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 disabled:opacity-50",children:c?"Creating Account...":"Create Account"})]}),X.jsx("div",{className:"mt-4 text-center",children:X.jsx("button",{onClick:e,className:"text-blue-600 hover:underline text-sm",children:"Already have an account? Sign in"})})]})},EU=({onAuthSuccess:n})=>{const[e,t]=we.useState(!0),r=()=>{n==null||n()},i=()=>t(!0),s=()=>t(!1);return X.jsx("div",{className:"w-full max-w-md mx-auto",children:e?X.jsx(wU,{onSuccess:r,onSwitchToRegister:s}):X.jsx(SU,{onSuccess:r,onSwitchToLogin:i})})};var tS={exports:{}},Zm={},om={},Oe={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n._registerNode=n.Konva=n.glob=void 0;const e=Math.PI/180;function t(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}n.glob=typeof UE<"u"?UE:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},n.Konva={_global:n.glob,version:"9.3.22",isBrowser:t(),isUnminified:/param/.test((function(i){}).toString()),dblClickWindow:400,getAngle(i){return n.Konva.angleDeg?i*e:i},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return n.Konva.DD.isDragging},isTransforming(){var i;return(i=n.Konva.Transformer)===null||i===void 0?void 0:i.isTransforming()},isDragReady(){return!!n.Konva.DD.node},releaseCanvasOnDestroy:!0,document:n.glob.document,_injectGlobal(i){n.glob.Konva=i}};const r=i=>{n.Konva[i.prototype.getClassName()]=i};n._registerNode=r,n.Konva._injectGlobal(n.Konva)})(Oe);var bt={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Util=n.Transform=void 0;const e=Oe;class t{constructor(P=[1,0,0,1,0,0]){this.dirty=!1,this.m=P&&P.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new t(this.m)}copyInto(P){P.m[0]=this.m[0],P.m[1]=this.m[1],P.m[2]=this.m[2],P.m[3]=this.m[3],P.m[4]=this.m[4],P.m[5]=this.m[5]}point(P){const V=this.m;return{x:V[0]*P.x+V[2]*P.y+V[4],y:V[1]*P.x+V[3]*P.y+V[5]}}translate(P,V){return this.m[4]+=this.m[0]*P+this.m[2]*V,this.m[5]+=this.m[1]*P+this.m[3]*V,this}scale(P,V){return this.m[0]*=P,this.m[1]*=P,this.m[2]*=V,this.m[3]*=V,this}rotate(P){const V=Math.cos(P),z=Math.sin(P),M=this.m[0]*V+this.m[2]*z,C=this.m[1]*V+this.m[3]*z,N=this.m[0]*-z+this.m[2]*V,A=this.m[1]*-z+this.m[3]*V;return this.m[0]=M,this.m[1]=C,this.m[2]=N,this.m[3]=A,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(P,V){const z=this.m[0]+this.m[2]*V,M=this.m[1]+this.m[3]*V,C=this.m[2]+this.m[0]*P,N=this.m[3]+this.m[1]*P;return this.m[0]=z,this.m[1]=M,this.m[2]=C,this.m[3]=N,this}multiply(P){const V=this.m[0]*P.m[0]+this.m[2]*P.m[1],z=this.m[1]*P.m[0]+this.m[3]*P.m[1],M=this.m[0]*P.m[2]+this.m[2]*P.m[3],C=this.m[1]*P.m[2]+this.m[3]*P.m[3],N=this.m[0]*P.m[4]+this.m[2]*P.m[5]+this.m[4],A=this.m[1]*P.m[4]+this.m[3]*P.m[5]+this.m[5];return this.m[0]=V,this.m[1]=z,this.m[2]=M,this.m[3]=C,this.m[4]=N,this.m[5]=A,this}invert(){const P=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),V=this.m[3]*P,z=-this.m[1]*P,M=-this.m[2]*P,C=this.m[0]*P,N=P*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),A=P*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=V,this.m[1]=z,this.m[2]=M,this.m[3]=C,this.m[4]=N,this.m[5]=A,this}getMatrix(){return this.m}decompose(){const P=this.m[0],V=this.m[1],z=this.m[2],M=this.m[3],C=this.m[4],N=this.m[5],A=P*M-V*z,L={x:C,y:N,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(P!=0||V!=0){const U=Math.sqrt(P*P+V*V);L.rotation=V>0?Math.acos(P/U):-Math.acos(P/U),L.scaleX=U,L.scaleY=A/U,L.skewX=(P*z+V*M)/A,L.skewY=0}else if(z!=0||M!=0){const U=Math.sqrt(z*z+M*M);L.rotation=Math.PI/2-(M>0?Math.acos(-z/U):-Math.acos(z/U)),L.scaleX=A/U,L.scaleY=U,L.skewX=0,L.skewY=(P*z+V*M)/A}return L.rotation=n.Util._getRotation(L.rotation),L}}n.Transform=t;const r="[object Array]",i="[object Number]",s="[object String]",o="[object Boolean]",u=Math.PI/180,c=180/Math.PI,d="#",p="",m="0",y="Konva warning: ",E="Konva error: ",S="rgb(",x={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},D=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let k=[];const R=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(w){setTimeout(w,60)};n.Util={_isElement(w){return!!(w&&w.nodeType==1)},_isFunction(w){return!!(w&&w.constructor&&w.call&&w.apply)},_isPlainObject(w){return!!w&&w.constructor===Object},_isArray(w){return Object.prototype.toString.call(w)===r},_isNumber(w){return Object.prototype.toString.call(w)===i&&!isNaN(w)&&isFinite(w)},_isString(w){return Object.prototype.toString.call(w)===s},_isBoolean(w){return Object.prototype.toString.call(w)===o},isObject(w){return w instanceof Object},isValidSelector(w){if(typeof w!="string")return!1;const P=w[0];return P==="#"||P==="."||P===P.toUpperCase()},_sign(w){return w===0||w>0?1:-1},requestAnimFrame(w){k.push(w),k.length===1&&R(function(){const P=k;k=[],P.forEach(function(V){V()})})},createCanvasElement(){const w=document.createElement("canvas");try{w.style=w.style||{}}catch{}return w},createImageElement(){return document.createElement("img")},_isInDocument(w){for(;w=w.parentNode;)if(w==document)return!0;return!1},_urlToImage(w,P){const V=n.Util.createImageElement();V.onload=function(){P(V)},V.src=w},_rgbToHex(w,P,V){return((1<<24)+(w<<16)+(P<<8)+V).toString(16).slice(1)},_hexToRgb(w){w=w.replace(d,p);const P=parseInt(w,16);return{r:P>>16&255,g:P>>8&255,b:P&255}},getRandomColor(){let w=(Math.random()*16777215<<0).toString(16);for(;w.length<6;)w=m+w;return d+w},getRGB(w){let P;return w in x?(P=x[w],{r:P[0],g:P[1],b:P[2]}):w[0]===d?this._hexToRgb(w.substring(1)):w.substr(0,4)===S?(P=D.exec(w.replace(/ /g,"")),{r:parseInt(P[1],10),g:parseInt(P[2],10),b:parseInt(P[3],10)}):{r:0,g:0,b:0}},colorToRGBA(w){return w=w||"black",n.Util._namedColorToRBA(w)||n.Util._hex3ColorToRGBA(w)||n.Util._hex4ColorToRGBA(w)||n.Util._hex6ColorToRGBA(w)||n.Util._hex8ColorToRGBA(w)||n.Util._rgbColorToRGBA(w)||n.Util._rgbaColorToRGBA(w)||n.Util._hslColorToRGBA(w)},_namedColorToRBA(w){const P=x[w.toLowerCase()];return P?{r:P[0],g:P[1],b:P[2],a:1}:null},_rgbColorToRGBA(w){if(w.indexOf("rgb(")===0){w=w.match(/rgb\(([^)]+)\)/)[1];const P=w.split(/ *, */).map(Number);return{r:P[0],g:P[1],b:P[2],a:1}}},_rgbaColorToRGBA(w){if(w.indexOf("rgba(")===0){w=w.match(/rgba\(([^)]+)\)/)[1];const P=w.split(/ *, */).map((V,z)=>V.slice(-1)==="%"?z===3?parseInt(V)/100:parseInt(V)/100*255:Number(V));return{r:P[0],g:P[1],b:P[2],a:P[3]}}},_hex8ColorToRGBA(w){if(w[0]==="#"&&w.length===9)return{r:parseInt(w.slice(1,3),16),g:parseInt(w.slice(3,5),16),b:parseInt(w.slice(5,7),16),a:parseInt(w.slice(7,9),16)/255}},_hex6ColorToRGBA(w){if(w[0]==="#"&&w.length===7)return{r:parseInt(w.slice(1,3),16),g:parseInt(w.slice(3,5),16),b:parseInt(w.slice(5,7),16),a:1}},_hex4ColorToRGBA(w){if(w[0]==="#"&&w.length===5)return{r:parseInt(w[1]+w[1],16),g:parseInt(w[2]+w[2],16),b:parseInt(w[3]+w[3],16),a:parseInt(w[4]+w[4],16)/255}},_hex3ColorToRGBA(w){if(w[0]==="#"&&w.length===4)return{r:parseInt(w[1]+w[1],16),g:parseInt(w[2]+w[2],16),b:parseInt(w[3]+w[3],16),a:1}},_hslColorToRGBA(w){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(w)){const[P,...V]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(w),z=Number(V[0])/360,M=Number(V[1])/100,C=Number(V[2])/100;let N,A,L;if(M===0)return L=C*255,{r:Math.round(L),g:Math.round(L),b:Math.round(L),a:1};C<.5?N=C*(1+M):N=C+M-C*M;const U=2*C-N,F=[0,0,0];for(let pe=0;pe<3;pe++)A=z+1/3*-(pe-1),A<0&&A++,A>1&&A--,6*A<1?L=U+(N-U)*6*A:2*A<1?L=N:3*A<2?L=U+(N-U)*(2/3-A)*6:L=U,F[pe]=L*255;return{r:Math.round(F[0]),g:Math.round(F[1]),b:Math.round(F[2]),a:1}}},haveIntersection(w,P){return!(P.x>w.x+w.width||P.x+P.width<w.x||P.y>w.y+w.height||P.y+P.height<w.y)},cloneObject(w){const P={};for(const V in w)this._isPlainObject(w[V])?P[V]=this.cloneObject(w[V]):this._isArray(w[V])?P[V]=this.cloneArray(w[V]):P[V]=w[V];return P},cloneArray(w){return w.slice(0)},degToRad(w){return w*u},radToDeg(w){return w*c},_degToRad(w){return n.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),n.Util.degToRad(w)},_radToDeg(w){return n.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),n.Util.radToDeg(w)},_getRotation(w){return e.Konva.angleDeg?n.Util.radToDeg(w):w},_capitalize(w){return w.charAt(0).toUpperCase()+w.slice(1)},throw(w){throw new Error(E+w)},error(w){console.error(E+w)},warn(w){e.Konva.showWarnings&&console.warn(y+w)},each(w,P){for(const V in w)P(V,w[V])},_inRange(w,P,V){return P<=w&&w<V},_getProjectionToSegment(w,P,V,z,M,C){let N,A,L;const U=(w-V)*(w-V)+(P-z)*(P-z);if(U==0)N=w,A=P,L=(M-V)*(M-V)+(C-z)*(C-z);else{const F=((M-w)*(V-w)+(C-P)*(z-P))/U;F<0?(N=w,A=P,L=(w-M)*(w-M)+(P-C)*(P-C)):F>1?(N=V,A=z,L=(V-M)*(V-M)+(z-C)*(z-C)):(N=w+F*(V-w),A=P+F*(z-P),L=(N-M)*(N-M)+(A-C)*(A-C))}return[N,A,L]},_getProjectionToLine(w,P,V){const z=n.Util.cloneObject(w);let M=Number.MAX_VALUE;return P.forEach(function(C,N){if(!V&&N===P.length-1)return;const A=P[(N+1)%P.length],L=n.Util._getProjectionToSegment(C.x,C.y,A.x,A.y,w.x,w.y),U=L[0],F=L[1],pe=L[2];pe<M&&(z.x=U,z.y=F,M=pe)}),z},_prepareArrayForTween(w,P,V){const z=[],M=[];if(w.length>P.length){const N=P;P=w,w=N}for(let N=0;N<w.length;N+=2)z.push({x:w[N],y:w[N+1]});for(let N=0;N<P.length;N+=2)M.push({x:P[N],y:P[N+1]});const C=[];return M.forEach(function(N){const A=n.Util._getProjectionToLine(N,z,V);C.push(A.x),C.push(A.y)}),C},_prepareToStringify(w){let P;w.visitedByCircularReferenceRemoval=!0;for(const V in w)if(w.hasOwnProperty(V)&&w[V]&&typeof w[V]=="object"){if(P=Object.getOwnPropertyDescriptor(w,V),w[V].visitedByCircularReferenceRemoval||n.Util._isElement(w[V]))if(P.configurable)delete w[V];else return null;else if(n.Util._prepareToStringify(w[V])===null)if(P.configurable)delete w[V];else return null}return delete w.visitedByCircularReferenceRemoval,w},_assign(w,P){for(const V in P)w[V]=P[V];return w},_getFirstPointerId(w){return w.touches?w.changedTouches[0].identifier:w.pointerId||999},releaseCanvas(...w){e.Konva.releaseCanvasOnDestroy&&w.forEach(P=>{P.width=0,P.height=0})},drawRoundedRectPath(w,P,V,z){let M=0,C=0,N=0,A=0;typeof z=="number"?M=C=N=A=Math.min(z,P/2,V/2):(M=Math.min(z[0]||0,P/2,V/2),C=Math.min(z[1]||0,P/2,V/2),A=Math.min(z[2]||0,P/2,V/2),N=Math.min(z[3]||0,P/2,V/2)),w.moveTo(M,0),w.lineTo(P-C,0),w.arc(P-C,C,C,Math.PI*3/2,0,!1),w.lineTo(P,V-A),w.arc(P-A,V-A,A,0,Math.PI/2,!1),w.lineTo(N,V),w.arc(N,V-N,N,Math.PI/2,Math.PI,!1),w.lineTo(0,M),w.arc(M,M,M,Math.PI,Math.PI*3/2,!1)}}})(bt);var kt={},Ri={},Fs={};Object.defineProperty(Fs,"__esModule",{value:!0});Fs.HitContext=Fs.SceneContext=Fs.Context=void 0;const NR=bt,TU=Oe;function CU(n){const e=[],t=n.length,r=NR.Util;for(let i=0;i<t;i++){let s=n[i];r._isNumber(s)?s=Math.round(s*1e3)/1e3:r._isString(s)||(s=s+""),e.push(s)}return e}const q3=",",IU="(",PU=")",RU="([",AU="])",kU=";",xU="()",NU="=",K3=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],DU=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],MU=100;class e0{constructor(e){this.canvas=e,TU.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(e){e.fillEnabled()&&this._fill(e)}_fill(e){}strokeShape(e){e.hasStroke()&&this._stroke(e)}_stroke(e){}fillStrokeShape(e){e.attrs.fillAfterStrokeEnabled?(this.strokeShape(e),this.fillShape(e)):(this.fillShape(e),this.strokeShape(e))}getTrace(e,t){let r=this.traceArr,i=r.length,s="",o,u,c,d;for(o=0;o<i;o++)u=r[o],c=u.method,c?(d=u.args,s+=c,e?s+=xU:NR.Util._isArray(d[0])?s+=RU+d.join(q3)+AU:(t&&(d=d.map(p=>typeof p=="number"?Math.floor(p):p)),s+=IU+d.join(q3)+PU)):(s+=u.property,e||(s+=NU+u.val)),s+=kU;return s}clearTrace(){this.traceArr=[]}_trace(e){let t=this.traceArr,r;t.push(e),r=t.length,r>=MU&&t.shift()}reset(){const e=this.getCanvas().getPixelRatio();this.setTransform(1*e,0,0,1*e,0,0)}getCanvas(){return this.canvas}clear(e){const t=this.getCanvas();e?this.clearRect(e.x||0,e.y||0,e.width||0,e.height||0):this.clearRect(0,0,t.getWidth()/t.pixelRatio,t.getHeight()/t.pixelRatio)}_applyLineCap(e){const t=e.attrs.lineCap;t&&this.setAttr("lineCap",t)}_applyOpacity(e){const t=e.getAbsoluteOpacity();t!==1&&this.setAttr("globalAlpha",t)}_applyLineJoin(e){const t=e.attrs.lineJoin;t&&this.setAttr("lineJoin",t)}setAttr(e,t){this._context[e]=t}arc(e,t,r,i,s,o){this._context.arc(e,t,r,i,s,o)}arcTo(e,t,r,i,s){this._context.arcTo(e,t,r,i,s)}beginPath(){this._context.beginPath()}bezierCurveTo(e,t,r,i,s,o){this._context.bezierCurveTo(e,t,r,i,s,o)}clearRect(e,t,r,i){this._context.clearRect(e,t,r,i)}clip(...e){this._context.clip.apply(this._context,e)}closePath(){this._context.closePath()}createImageData(e,t){const r=arguments;if(r.length===2)return this._context.createImageData(e,t);if(r.length===1)return this._context.createImageData(e)}createLinearGradient(e,t,r,i){return this._context.createLinearGradient(e,t,r,i)}createPattern(e,t){return this._context.createPattern(e,t)}createRadialGradient(e,t,r,i,s,o){return this._context.createRadialGradient(e,t,r,i,s,o)}drawImage(e,t,r,i,s,o,u,c,d){const p=arguments,m=this._context;p.length===3?m.drawImage(e,t,r):p.length===5?m.drawImage(e,t,r,i,s):p.length===9&&m.drawImage(e,t,r,i,s,o,u,c,d)}ellipse(e,t,r,i,s,o,u,c){this._context.ellipse(e,t,r,i,s,o,u,c)}isPointInPath(e,t,r,i){return r?this._context.isPointInPath(r,e,t,i):this._context.isPointInPath(e,t,i)}fill(...e){this._context.fill.apply(this._context,e)}fillRect(e,t,r,i){this._context.fillRect(e,t,r,i)}strokeRect(e,t,r,i){this._context.strokeRect(e,t,r,i)}fillText(e,t,r,i){i?this._context.fillText(e,t,r,i):this._context.fillText(e,t,r)}measureText(e){return this._context.measureText(e)}getImageData(e,t,r,i){return this._context.getImageData(e,t,r,i)}lineTo(e,t){this._context.lineTo(e,t)}moveTo(e,t){this._context.moveTo(e,t)}rect(e,t,r,i){this._context.rect(e,t,r,i)}roundRect(e,t,r,i,s){this._context.roundRect(e,t,r,i,s)}putImageData(e,t,r){this._context.putImageData(e,t,r)}quadraticCurveTo(e,t,r,i){this._context.quadraticCurveTo(e,t,r,i)}restore(){this._context.restore()}rotate(e){this._context.rotate(e)}save(){this._context.save()}scale(e,t){this._context.scale(e,t)}setLineDash(e){this._context.setLineDash?this._context.setLineDash(e):"mozDash"in this._context?this._context.mozDash=e:"webkitLineDash"in this._context&&(this._context.webkitLineDash=e)}getLineDash(){return this._context.getLineDash()}setTransform(e,t,r,i,s,o){this._context.setTransform(e,t,r,i,s,o)}stroke(e){e?this._context.stroke(e):this._context.stroke()}strokeText(e,t,r,i){this._context.strokeText(e,t,r,i)}transform(e,t,r,i,s,o){this._context.transform(e,t,r,i,s,o)}translate(e,t){this._context.translate(e,t)}_enableTrace(){let e=this,t=K3.length,r=this.setAttr,i,s;const o=function(u){let c=e[u],d;e[u]=function(){return s=CU(Array.prototype.slice.call(arguments,0)),d=c.apply(e,arguments),e._trace({method:u,args:s}),d}};for(i=0;i<t;i++)o(K3[i]);e.setAttr=function(){r.apply(e,arguments);const u=arguments[0];let c=arguments[1];(u==="shadowOffsetX"||u==="shadowOffsetY"||u==="shadowBlur")&&(c=c/this.canvas.getPixelRatio()),e._trace({property:u,val:c})}}_applyGlobalCompositeOperation(e){const t=e.attrs.globalCompositeOperation;!t||t==="source-over"||this.setAttr("globalCompositeOperation",t)}}Fs.Context=e0;DU.forEach(function(n){Object.defineProperty(e0.prototype,n,{get(){return this._context[n]},set(e){this._context[n]=e}})});class OU extends e0{constructor(e,{willReadFrequently:t=!1}={}){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:t})}_fillColor(e){const t=e.fill();this.setAttr("fillStyle",t),e._fillFunc(this)}_fillPattern(e){this.setAttr("fillStyle",e._getFillPattern()),e._fillFunc(this)}_fillLinearGradient(e){const t=e._getLinearGradient();t&&(this.setAttr("fillStyle",t),e._fillFunc(this))}_fillRadialGradient(e){const t=e._getRadialGradient();t&&(this.setAttr("fillStyle",t),e._fillFunc(this))}_fill(e){const t=e.fill(),r=e.getFillPriority();if(t&&r==="color"){this._fillColor(e);return}const i=e.getFillPatternImage();if(i&&r==="pattern"){this._fillPattern(e);return}const s=e.getFillLinearGradientColorStops();if(s&&r==="linear-gradient"){this._fillLinearGradient(e);return}const o=e.getFillRadialGradientColorStops();if(o&&r==="radial-gradient"){this._fillRadialGradient(e);return}t?this._fillColor(e):i?this._fillPattern(e):s?this._fillLinearGradient(e):o&&this._fillRadialGradient(e)}_strokeLinearGradient(e){const t=e.getStrokeLinearGradientStartPoint(),r=e.getStrokeLinearGradientEndPoint(),i=e.getStrokeLinearGradientColorStops(),s=this.createLinearGradient(t.x,t.y,r.x,r.y);if(i){for(let o=0;o<i.length;o+=2)s.addColorStop(i[o],i[o+1]);this.setAttr("strokeStyle",s)}}_stroke(e){const t=e.dash(),r=e.getStrokeScaleEnabled();if(e.hasStroke()){if(!r){this.save();const s=this.getCanvas().getPixelRatio();this.setTransform(s,0,0,s,0,0)}this._applyLineCap(e),t&&e.dashEnabled()&&(this.setLineDash(t),this.setAttr("lineDashOffset",e.dashOffset())),this.setAttr("lineWidth",e.strokeWidth()),e.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),e.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(e):this.setAttr("strokeStyle",e.stroke()),e._strokeFunc(this),r||this.restore()}}_applyShadow(e){var t,r,i;const s=(t=e.getShadowRGBA())!==null&&t!==void 0?t:"black",o=(r=e.getShadowBlur())!==null&&r!==void 0?r:5,u=(i=e.getShadowOffset())!==null&&i!==void 0?i:{x:0,y:0},c=e.getAbsoluteScale(),d=this.canvas.getPixelRatio(),p=c.x*d,m=c.y*d;this.setAttr("shadowColor",s),this.setAttr("shadowBlur",o*Math.min(Math.abs(p),Math.abs(m))),this.setAttr("shadowOffsetX",u.x*p),this.setAttr("shadowOffsetY",u.y*m)}}Fs.SceneContext=OU;class LU extends e0{constructor(e){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:!0})}_fill(e){this.save(),this.setAttr("fillStyle",e.colorKey),e._fillFuncHit(this),this.restore()}strokeShape(e){e.hasHitStroke()&&this._stroke(e)}_stroke(e){if(e.hasHitStroke()){const t=e.getStrokeScaleEnabled();if(!t){this.save();const s=this.getCanvas().getPixelRatio();this.setTransform(s,0,0,s,0,0)}this._applyLineCap(e);const r=e.hitStrokeWidth(),i=r==="auto"?e.strokeWidth():r;this.setAttr("lineWidth",i),this.setAttr("strokeStyle",e.colorKey),e._strokeFuncHit(this),t||this.restore()}}}Fs.HitContext=LU;Object.defineProperty(Ri,"__esModule",{value:!0});Ri.HitCanvas=Ri.SceneCanvas=Ri.Canvas=void 0;const am=bt,DR=Fs,MR=Oe;let Mp;function bU(){if(Mp)return Mp;const n=am.Util.createCanvasElement(),e=n.getContext("2d");return Mp=function(){const t=MR.Konva._global.devicePixelRatio||1,r=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return t/r}(),am.Util.releaseCanvas(n),Mp}let nS=class{constructor(e){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const r=(e||{}).pixelRatio||MR.Konva.pixelRatio||bU();this.pixelRatio=r,this._canvas=am.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(e){const t=this.pixelRatio;this.pixelRatio=e,this.setSize(this.getWidth()/t,this.getHeight()/t)}setWidth(e){this.width=this._canvas.width=e*this.pixelRatio,this._canvas.style.width=e+"px";const t=this.pixelRatio;this.getContext()._context.scale(t,t)}setHeight(e){this.height=this._canvas.height=e*this.pixelRatio,this._canvas.style.height=e+"px";const t=this.pixelRatio;this.getContext()._context.scale(t,t)}getWidth(){return this.width}getHeight(){return this.height}setSize(e,t){this.setWidth(e||0),this.setHeight(t||0)}toDataURL(e,t){try{return this._canvas.toDataURL(e,t)}catch{try{return this._canvas.toDataURL()}catch(i){return am.Util.error("Unable to get data URL. "+i.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};Ri.Canvas=nS;class FU extends nS{constructor(e={width:0,height:0,willReadFrequently:!1}){super(e),this.context=new DR.SceneContext(this,{willReadFrequently:e.willReadFrequently}),this.setSize(e.width,e.height)}}Ri.SceneCanvas=FU;class VU extends nS{constructor(e={width:0,height:0}){super(e),this.hitCanvas=!0,this.context=new DR.HitContext(this),this.setSize(e.width,e.height)}}Ri.HitCanvas=VU;var t0={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.DD=void 0;const e=Oe,t=bt;n.DD={get isDragging(){let r=!1;return n.DD._dragElements.forEach(i=>{i.dragStatus==="dragging"&&(r=!0)}),r},justDragged:!1,get node(){let r;return n.DD._dragElements.forEach(i=>{r=i.node}),r},_dragElements:new Map,_drag(r){const i=[];n.DD._dragElements.forEach((s,o)=>{const{node:u}=s,c=u.getStage();c.setPointersPositions(r),s.pointerId===void 0&&(s.pointerId=t.Util._getFirstPointerId(r));const d=c._changedPointerPositions.find(p=>p.id===s.pointerId);if(d){if(s.dragStatus!=="dragging"){const p=u.dragDistance();if(Math.max(Math.abs(d.x-s.startPointerPos.x),Math.abs(d.y-s.startPointerPos.y))<p||(u.startDrag({evt:r}),!u.isDragging()))return}u._setDragPosition(r,s),i.push(u)}}),i.forEach(s=>{s.fire("dragmove",{type:"dragmove",target:s,evt:r},!0)})},_endDragBefore(r){const i=[];n.DD._dragElements.forEach(s=>{const{node:o}=s,u=o.getStage();if(r&&u.setPointersPositions(r),!u._changedPointerPositions.find(p=>p.id===s.pointerId))return;(s.dragStatus==="dragging"||s.dragStatus==="stopped")&&(n.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,s.dragStatus="stopped");const d=s.node.getLayer()||s.node instanceof e.Konva.Stage&&s.node;d&&i.indexOf(d)===-1&&i.push(d)}),i.forEach(s=>{s.draw()})},_endDragAfter(r){n.DD._dragElements.forEach((i,s)=>{i.dragStatus==="stopped"&&i.node.fire("dragend",{type:"dragend",target:i.node,evt:r},!0),i.dragStatus!=="dragging"&&n.DD._dragElements.delete(s)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",n.DD._endDragBefore,!0),window.addEventListener("touchend",n.DD._endDragBefore,!0),window.addEventListener("touchcancel",n.DD._endDragBefore,!0),window.addEventListener("mousemove",n.DD._drag),window.addEventListener("touchmove",n.DD._drag),window.addEventListener("mouseup",n.DD._endDragAfter,!1),window.addEventListener("touchend",n.DD._endDragAfter,!1),window.addEventListener("touchcancel",n.DD._endDragAfter,!1))})(t0);var be={},Re={};Object.defineProperty(Re,"__esModule",{value:!0});Re.RGBComponent=UU;Re.alphaComponent=zU;Re.getNumberValidator=BU;Re.getNumberOrArrayOfNumbersValidator=GU;Re.getNumberOrAutoValidator=jU;Re.getStringValidator=WU;Re.getStringOrGradientValidator=HU;Re.getFunctionValidator=$U;Re.getNumberArrayValidator=qU;Re.getBooleanValidator=KU;Re.getComponentValidator=QU;const Ys=Oe,Vt=bt;function Xs(n){return Vt.Util._isString(n)?'"'+n+'"':Object.prototype.toString.call(n)==="[object Number]"||Vt.Util._isBoolean(n)?n:Object.prototype.toString.call(n)}function UU(n){return n>255?255:n<0?0:Math.round(n)}function zU(n){return n>1?1:n<1e-4?1e-4:n}function BU(){if(Ys.Konva.isUnminified)return function(n,e){return Vt.Util._isNumber(n)||Vt.Util.warn(Xs(n)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),n}}function GU(n){if(Ys.Konva.isUnminified)return function(e,t){let r=Vt.Util._isNumber(e),i=Vt.Util._isArray(e)&&e.length==n;return!r&&!i&&Vt.Util.warn(Xs(e)+' is a not valid value for "'+t+'" attribute. The value should be a number or Array<number>('+n+")"),e}}function jU(){if(Ys.Konva.isUnminified)return function(n,e){return Vt.Util._isNumber(n)||n==="auto"||Vt.Util.warn(Xs(n)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),n}}function WU(){if(Ys.Konva.isUnminified)return function(n,e){return Vt.Util._isString(n)||Vt.Util.warn(Xs(n)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),n}}function HU(){if(Ys.Konva.isUnminified)return function(n,e){const t=Vt.Util._isString(n),r=Object.prototype.toString.call(n)==="[object CanvasGradient]"||n&&n.addColorStop;return t||r||Vt.Util.warn(Xs(n)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),n}}function $U(){if(Ys.Konva.isUnminified)return function(n,e){return Vt.Util._isFunction(n)||Vt.Util.warn(Xs(n)+' is a not valid value for "'+e+'" attribute. The value should be a function.'),n}}function qU(){if(Ys.Konva.isUnminified)return function(n,e){const t=Int8Array?Object.getPrototypeOf(Int8Array):null;return t&&n instanceof t||(Vt.Util._isArray(n)?n.forEach(function(r){Vt.Util._isNumber(r)||Vt.Util.warn('"'+e+'" attribute has non numeric element '+r+". Make sure that all elements are numbers.")}):Vt.Util.warn(Xs(n)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.')),n}}function KU(){if(Ys.Konva.isUnminified)return function(n,e){return n===!0||n===!1||Vt.Util.warn(Xs(n)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),n}}function QU(n){if(Ys.Konva.isUnminified)return function(e,t){return e==null||Vt.Util.isObject(e)||Vt.Util.warn(Xs(e)+' is a not valid value for "'+t+'" attribute. The value should be an object with properties '+n),e}}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Factory=void 0;const e=bt,t=Re,r="get",i="set";n.Factory={addGetterSetter(s,o,u,c,d){n.Factory.addGetter(s,o,u),n.Factory.addSetter(s,o,c,d),n.Factory.addOverloadedGetterSetter(s,o)},addGetter(s,o,u){const c=r+e.Util._capitalize(o);s.prototype[c]=s.prototype[c]||function(){const d=this.attrs[o];return d===void 0?u:d}},addSetter(s,o,u,c){const d=i+e.Util._capitalize(o);s.prototype[d]||n.Factory.overWriteSetter(s,o,u,c)},overWriteSetter(s,o,u,c){const d=i+e.Util._capitalize(o);s.prototype[d]=function(p){return u&&p!==void 0&&p!==null&&(p=u.call(this,p,o)),this._setAttr(o,p),c&&c.call(this),this}},addComponentsGetterSetter(s,o,u,c,d){const p=u.length,m=e.Util._capitalize,y=r+m(o),E=i+m(o);s.prototype[y]=function(){const x={};for(let D=0;D<p;D++){const k=u[D];x[k]=this.getAttr(o+m(k))}return x};const S=(0,t.getComponentValidator)(u);s.prototype[E]=function(x){const D=this.attrs[o];c&&(x=c.call(this,x,o)),S&&S.call(this,x,o);for(const k in x)x.hasOwnProperty(k)&&this._setAttr(o+m(k),x[k]);return x||u.forEach(k=>{this._setAttr(o+m(k),void 0)}),this._fireChangeEvent(o,D,x),d&&d.call(this),this},n.Factory.addOverloadedGetterSetter(s,o)},addOverloadedGetterSetter(s,o){const u=e.Util._capitalize(o),c=i+u,d=r+u;s.prototype[o]=function(){return arguments.length?(this[c](arguments[0]),this):this[d]()}},addDeprecatedGetterSetter(s,o,u,c){e.Util.error("Adding deprecated "+o);const d=r+e.Util._capitalize(o),p=o+" property is deprecated and will be removed soon. Look at Konva change log for more information.";s.prototype[d]=function(){e.Util.error(p);const m=this.attrs[o];return m===void 0?u:m},n.Factory.addSetter(s,o,c,function(){e.Util.error(p)}),n.Factory.addOverloadedGetterSetter(s,o)},backCompat(s,o){e.Util.each(o,function(u,c){const d=s.prototype[c],p=r+e.Util._capitalize(u),m=i+e.Util._capitalize(u);function y(){d.apply(this,arguments),e.Util.error('"'+u+'" method is deprecated and will be removed soon. Use ""'+c+'" instead.')}s.prototype[u]=y,s.prototype[p]=y,s.prototype[m]=y})},afterSetFilter(){this._filterUpToDate=!1}}})(be);Object.defineProperty(kt,"__esModule",{value:!0});kt.Node=void 0;const $l=Ri,Qr=t0,Zd=be,_o=Oe,Ue=bt,Wt=Re,ag="absoluteOpacity",Op="allEventListeners",Ts="absoluteTransform",Q3="absoluteScale",Aa="canvas",YU="Change",XU="children",JU="konva",Rv="listening",ZU="mouseenter",ez="mouseleave",tz="pointerenter",nz="pointerleave",rz="touchenter",iz="touchleave",Y3="set",X3="Shape",lg=" ",J3="stage",yo="transform",sz="Stage",Av="visible",oz=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(lg);let az=1;class xe{constructor(e){this._id=az++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(e),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(e){(e===yo||e===Ts)&&this._cache.get(e)?this._cache.get(e).dirty=!0:e?this._cache.delete(e):this._cache.clear()}_getCache(e,t){let r=this._cache.get(e);return(r===void 0||(e===yo||e===Ts)&&r.dirty===!0)&&(r=t.call(this),this._cache.set(e,r)),r}_calculate(e,t,r){if(!this._attachedDepsListeners.get(e)){const i=t.map(s=>s+"Change.konva").join(lg);this.on(i,()=>{this._clearCache(e)}),this._attachedDepsListeners.set(e,!0)}return this._getCache(e,r)}_getCanvasCache(){return this._cache.get(Aa)}_clearSelfAndDescendantCache(e){this._clearCache(e),e===Ts&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(Aa)){const{scene:e,filter:t,hit:r,buffer:i}=this._cache.get(Aa);Ue.Util.releaseCanvas(e,t,r,i),this._cache.delete(Aa)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(e){const t=e||{};let r={};(t.x===void 0||t.y===void 0||t.width===void 0||t.height===void 0)&&(r=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let i=Math.ceil(t.width||r.width),s=Math.ceil(t.height||r.height),o=t.pixelRatio,u=t.x===void 0?Math.floor(r.x):t.x,c=t.y===void 0?Math.floor(r.y):t.y,d=t.offset||0,p=t.drawBorder||!1,m=t.hitCanvasPixelRatio||1;if(!i||!s){Ue.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const y=Math.abs(Math.round(r.x)-u)>.5?1:0,E=Math.abs(Math.round(r.y)-c)>.5?1:0;i+=d*2+y,s+=d*2+E,u-=d,c-=d;const S=new $l.SceneCanvas({pixelRatio:o,width:i,height:s}),x=new $l.SceneCanvas({pixelRatio:o,width:0,height:0,willReadFrequently:!0}),D=new $l.HitCanvas({pixelRatio:m,width:i,height:s}),k=S.getContext(),R=D.getContext(),w=new $l.SceneCanvas({width:S.width/S.pixelRatio+Math.abs(u),height:S.height/S.pixelRatio+Math.abs(c),pixelRatio:S.pixelRatio}),P=w.getContext();return D.isCache=!0,S.isCache=!0,this._cache.delete(Aa),this._filterUpToDate=!1,t.imageSmoothingEnabled===!1&&(S.getContext()._context.imageSmoothingEnabled=!1,x.getContext()._context.imageSmoothingEnabled=!1),k.save(),R.save(),P.save(),k.translate(-u,-c),R.translate(-u,-c),P.translate(-u,-c),w.x=u,w.y=c,this._isUnderCache=!0,this._clearSelfAndDescendantCache(ag),this._clearSelfAndDescendantCache(Q3),this.drawScene(S,this,w),this.drawHit(D,this),this._isUnderCache=!1,k.restore(),R.restore(),p&&(k.save(),k.beginPath(),k.rect(0,0,i,s),k.closePath(),k.setAttr("strokeStyle","red"),k.setAttr("lineWidth",5),k.stroke(),k.restore()),this._cache.set(Aa,{scene:S,filter:x,hit:D,buffer:w,x:u,y:c}),this._requestDraw(),this}isCached(){return this._cache.has(Aa)}getClientRect(e){throw new Error('abstract "getClientRect" method call')}_transformedRect(e,t){const r=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}];let i=1/0,s=1/0,o=-1/0,u=-1/0;const c=this.getAbsoluteTransform(t);return r.forEach(function(d){const p=c.point(d);i===void 0&&(i=o=p.x,s=u=p.y),i=Math.min(i,p.x),s=Math.min(s,p.y),o=Math.max(o,p.x),u=Math.max(u,p.y)}),{x:i,y:s,width:o-i,height:u-s}}_drawCachedSceneCanvas(e){e.save(),e._applyOpacity(this),e._applyGlobalCompositeOperation(this);const t=this._getCanvasCache();e.translate(t.x,t.y);const r=this._getCachedSceneCanvas(),i=r.pixelRatio;e.drawImage(r._canvas,0,0,r.width/i,r.height/i),e.restore()}_drawCachedHitCanvas(e){const t=this._getCanvasCache(),r=t.hit;e.save(),e.translate(t.x,t.y),e.drawImage(r._canvas,0,0,r.width/r.pixelRatio,r.height/r.pixelRatio),e.restore()}_getCachedSceneCanvas(){let e=this.filters(),t=this._getCanvasCache(),r=t.scene,i=t.filter,s=i.getContext(),o,u,c,d;if(e){if(!this._filterUpToDate){const p=r.pixelRatio;i.setSize(r.width/r.pixelRatio,r.height/r.pixelRatio);try{for(o=e.length,s.clear(),s.drawImage(r._canvas,0,0,r.getWidth()/p,r.getHeight()/p),u=s.getImageData(0,0,i.getWidth(),i.getHeight()),c=0;c<o;c++){if(d=e[c],typeof d!="function"){Ue.Util.error("Filter should be type of function, but got "+typeof d+" instead. Please check correct filters");continue}d.call(this,u),s.putImageData(u,0,0)}}catch(m){Ue.Util.error("Unable to apply filter. "+m.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return i}return r}on(e,t){if(this._cache&&this._cache.delete(Op),arguments.length===3)return this._delegate.apply(this,arguments);const r=e.split(lg);for(let i=0;i<r.length;i++){const o=r[i].split("."),u=o[0],c=o[1]||"";this.eventListeners[u]||(this.eventListeners[u]=[]),this.eventListeners[u].push({name:c,handler:t})}return this}off(e,t){let r=(e||"").split(lg),i=r.length,s,o,u,c,d,p;if(this._cache&&this._cache.delete(Op),!e)for(o in this.eventListeners)this._off(o);for(s=0;s<i;s++)if(u=r[s],c=u.split("."),d=c[0],p=c[1],d)this.eventListeners[d]&&this._off(d,p,t);else for(o in this.eventListeners)this._off(o,p,t);return this}dispatchEvent(e){const t={target:this,type:e.type,evt:e};return this.fire(e.type,t),this}addEventListener(e,t){return this.on(e,function(r){t.call(this,r.evt)}),this}removeEventListener(e){return this.off(e),this}_delegate(e,t,r){const i=this;this.on(e,function(s){const o=s.target.findAncestors(t,!0,i);for(let u=0;u<o.length;u++)s=Ue.Util.cloneObject(s),s.currentTarget=o[u],r.call(o[u],s)})}remove(){return this.isDragging()&&this.stopDrag(),Qr.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Ts),this._clearSelfAndDescendantCache(ag),this._clearSelfAndDescendantCache(Q3),this._clearSelfAndDescendantCache(J3),this._clearSelfAndDescendantCache(Av),this._clearSelfAndDescendantCache(Rv)}_remove(){this._clearCaches();const e=this.getParent();e&&e.children&&(e.children.splice(this.index,1),e._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(e){const t="get"+Ue.Util._capitalize(e);return Ue.Util._isFunction(this[t])?this[t]():this.attrs[e]}getAncestors(){let e=this.getParent(),t=[];for(;e;)t.push(e),e=e.getParent();return t}getAttrs(){return this.attrs||{}}setAttrs(e){return this._batchTransformChanges(()=>{let t,r;if(!e)return this;for(t in e)t!==XU&&(r=Y3+Ue.Util._capitalize(t),Ue.Util._isFunction(this[r])?this[r](e[t]):this._setAttr(t,e[t]))}),this}isListening(){return this._getCache(Rv,this._isListening)}_isListening(e){if(!this.listening())return!1;const r=this.getParent();return r&&r!==e&&this!==e?r._isListening(e):!0}isVisible(){return this._getCache(Av,this._isVisible)}_isVisible(e){if(!this.visible())return!1;const r=this.getParent();return r&&r!==e&&this!==e?r._isVisible(e):!0}shouldDrawHit(e,t=!1){if(e)return this._isVisible(e)&&this._isListening(e);const r=this.getLayer();let i=!1;Qr.DD._dragElements.forEach(o=>{o.dragStatus==="dragging"&&(o.node.nodeType==="Stage"||o.node.getLayer()===r)&&(i=!0)});const s=!t&&!_o.Konva.hitOnDragEnabled&&(i||_o.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!s}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let e=this.getDepth(),t=this,r=0,i,s,o,u;function c(p){for(i=[],s=p.length,o=0;o<s;o++)u=p[o],r++,u.nodeType!==X3&&(i=i.concat(u.getChildren().slice())),u._id===t._id&&(o=s);i.length>0&&i[0].getDepth()<=e&&c(i)}const d=this.getStage();return t.nodeType!==sz&&d&&c(d.getChildren()),r}getDepth(){let e=0,t=this.parent;for(;t;)e++,t=t.parent;return e}_batchTransformChanges(e){this._batchingTransformChange=!0,e(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(yo),this._clearSelfAndDescendantCache(Ts)),this._needClearTransformCache=!1}setPosition(e){return this._batchTransformChanges(()=>{this.x(e.x),this.y(e.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const e=this.getStage();if(!e)return null;const t=e.getPointerPosition();if(!t)return null;const r=this.getAbsoluteTransform().copy();return r.invert(),r.point(t)}getAbsolutePosition(e){let t=!1,r=this.parent;for(;r;){if(r.isCached()){t=!0;break}r=r.parent}t&&!e&&(e=!0);const i=this.getAbsoluteTransform(e).getMatrix(),s=new Ue.Transform,o=this.offset();return s.m=i.slice(),s.translate(o.x,o.y),s.getTranslation()}setAbsolutePosition(e){const{x:t,y:r,...i}=this._clearTransform();this.attrs.x=t,this.attrs.y=r,this._clearCache(yo);const s=this._getAbsoluteTransform().copy();return s.invert(),s.translate(e.x,e.y),e={x:this.attrs.x+s.getTranslation().x,y:this.attrs.y+s.getTranslation().y},this._setTransform(i),this.setPosition({x:e.x,y:e.y}),this._clearCache(yo),this._clearSelfAndDescendantCache(Ts),this}_setTransform(e){let t;for(t in e)this.attrs[t]=e[t]}_clearTransform(){const e={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,e}move(e){let t=e.x,r=e.y,i=this.x(),s=this.y();return t!==void 0&&(i+=t),r!==void 0&&(s+=r),this.setPosition({x:i,y:s}),this}_eachAncestorReverse(e,t){let r=[],i=this.getParent(),s,o;if(!(t&&t._id===this._id)){for(r.unshift(this);i&&(!t||i._id!==t._id);)r.unshift(i),i=i.parent;for(s=r.length,o=0;o<s;o++)e(r[o])}}rotate(e){return this.rotation(this.rotation()+e),this}moveToTop(){if(!this.parent)return Ue.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const e=this.index,t=this.parent.getChildren().length;return e<t-1?(this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return Ue.Util.warn("Node has no parent. moveUp function is ignored."),!1;const e=this.index,t=this.parent.getChildren().length;return e<t-1?(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return Ue.Util.warn("Node has no parent. moveDown function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return Ue.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(e){if(!this.parent)return Ue.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(e<0||e>=this.parent.children.length)&&Ue.Util.warn("Unexpected value "+e+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const t=this.index;return this.parent.children.splice(t,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(ag,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let e=this.opacity();const t=this.getParent();return t&&!t._isUnderCache&&(e*=t.getAbsoluteOpacity()),e}moveTo(e){return this.getParent()!==e&&(this._remove(),e.add(this)),this}toObject(){let e=this.getAttrs(),t,r,i,s,o;const u={attrs:{},className:this.getClassName()};for(t in e)r=e[t],o=Ue.Util.isObject(r)&&!Ue.Util._isPlainObject(r)&&!Ue.Util._isArray(r),!o&&(i=typeof this[t]=="function"&&this[t],delete e[t],s=i?i.call(this):null,e[t]=r,s!==r&&(u.attrs[t]=r));return Ue.Util._prepareToStringify(u)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(e,t,r){const i=[];t&&this._isMatch(e)&&i.push(this);let s=this.parent;for(;s;){if(s===r)return i;s._isMatch(e)&&i.push(s),s=s.parent}return i}isAncestorOf(e){return!1}findAncestor(e,t,r){return this.findAncestors(e,t,r)[0]}_isMatch(e){if(!e)return!1;if(typeof e=="function")return e(this);let t=e.replace(/ /g,"").split(","),r=t.length,i,s;for(i=0;i<r;i++)if(s=t[i],Ue.Util.isValidSelector(s)||(Ue.Util.warn('Selector "'+s+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),Ue.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),Ue.Util.warn("Konva is awesome, right?")),s.charAt(0)==="#"){if(this.id()===s.slice(1))return!0}else if(s.charAt(0)==="."){if(this.hasName(s.slice(1)))return!0}else if(this.className===s||this.nodeType===s)return!0;return!1}getLayer(){const e=this.getParent();return e?e.getLayer():null}getStage(){return this._getCache(J3,this._getStage)}_getStage(){const e=this.getParent();return e?e.getStage():null}fire(e,t={},r){return t.target=t.target||this,r?this._fireAndBubble(e,t):this._fire(e,t),this}getAbsoluteTransform(e){return e?this._getAbsoluteTransform(e):this._getCache(Ts,this._getAbsoluteTransform)}_getAbsoluteTransform(e){let t;if(e)return t=new Ue.Transform,this._eachAncestorReverse(function(r){const i=r.transformsEnabled();i==="all"?t.multiply(r.getTransform()):i==="position"&&t.translate(r.x()-r.offsetX(),r.y()-r.offsetY())},e),t;{t=this._cache.get(Ts)||new Ue.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(t):t.reset();const r=this.transformsEnabled();if(r==="all")t.multiply(this.getTransform());else if(r==="position"){const i=this.attrs.x||0,s=this.attrs.y||0,o=this.attrs.offsetX||0,u=this.attrs.offsetY||0;t.translate(i-o,s-u)}return t.dirty=!1,t}}getAbsoluteScale(e){let t=this;for(;t;)t._isUnderCache&&(e=t),t=t.getParent();const i=this.getAbsoluteTransform(e).decompose();return{x:i.scaleX,y:i.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(yo,this._getTransform)}_getTransform(){var e,t;const r=this._cache.get(yo)||new Ue.Transform;r.reset();const i=this.x(),s=this.y(),o=_o.Konva.getAngle(this.rotation()),u=(e=this.attrs.scaleX)!==null&&e!==void 0?e:1,c=(t=this.attrs.scaleY)!==null&&t!==void 0?t:1,d=this.attrs.skewX||0,p=this.attrs.skewY||0,m=this.attrs.offsetX||0,y=this.attrs.offsetY||0;return(i!==0||s!==0)&&r.translate(i,s),o!==0&&r.rotate(o),(d!==0||p!==0)&&r.skew(d,p),(u!==1||c!==1)&&r.scale(u,c),(m!==0||y!==0)&&r.translate(-1*m,-1*y),r.dirty=!1,r}clone(e){let t=Ue.Util.cloneObject(this.attrs),r,i,s,o,u;for(r in e)t[r]=e[r];const c=new this.constructor(t);for(r in this.eventListeners)for(i=this.eventListeners[r],s=i.length,o=0;o<s;o++)u=i[o],u.name.indexOf(JU)<0&&(c.eventListeners[r]||(c.eventListeners[r]=[]),c.eventListeners[r].push(u));return c}_toKonvaCanvas(e){e=e||{};const t=this.getClientRect(),r=this.getStage(),i=e.x!==void 0?e.x:Math.floor(t.x),s=e.y!==void 0?e.y:Math.floor(t.y),o=e.pixelRatio||1,u=new $l.SceneCanvas({width:e.width||Math.ceil(t.width)||(r?r.width():0),height:e.height||Math.ceil(t.height)||(r?r.height():0),pixelRatio:o}),c=u.getContext(),d=new $l.SceneCanvas({width:u.width/u.pixelRatio+Math.abs(i),height:u.height/u.pixelRatio+Math.abs(s),pixelRatio:u.pixelRatio});return e.imageSmoothingEnabled===!1&&(c._context.imageSmoothingEnabled=!1),c.save(),(i||s)&&c.translate(-1*i,-1*s),this.drawScene(u,void 0,d),c.restore(),u}toCanvas(e){return this._toKonvaCanvas(e)._canvas}toDataURL(e){e=e||{};const t=e.mimeType||null,r=e.quality||null,i=this._toKonvaCanvas(e).toDataURL(t,r);return e.callback&&e.callback(i),i}toImage(e){return new Promise((t,r)=>{try{const i=e==null?void 0:e.callback;i&&delete e.callback,Ue.Util._urlToImage(this.toDataURL(e),function(s){t(s),i==null||i(s)})}catch(i){r(i)}})}toBlob(e){return new Promise((t,r)=>{try{const i=e==null?void 0:e.callback;i&&delete e.callback,this.toCanvas(e).toBlob(s=>{t(s),i==null||i(s)},e==null?void 0:e.mimeType,e==null?void 0:e.quality)}catch(i){r(i)}})}setSize(e){return this.width(e.width),this.height(e.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():_o.Konva.dragDistance}_off(e,t,r){let i=this.eventListeners[e],s,o,u;for(s=0;s<i.length;s++)if(o=i[s].name,u=i[s].handler,(o!=="konva"||t==="konva")&&(!t||o===t)&&(!r||r===u)){if(i.splice(s,1),i.length===0){delete this.eventListeners[e];break}s--}}_fireChangeEvent(e,t,r){this._fire(e+YU,{oldVal:t,newVal:r})}addName(e){if(!this.hasName(e)){const t=this.name(),r=t?t+" "+e:e;this.name(r)}return this}hasName(e){if(!e)return!1;const t=this.name();return t?(t||"").split(/\s/g).indexOf(e)!==-1:!1}removeName(e){const t=(this.name()||"").split(/\s/g),r=t.indexOf(e);return r!==-1&&(t.splice(r,1),this.name(t.join(" "))),this}setAttr(e,t){const r=this[Y3+Ue.Util._capitalize(e)];return Ue.Util._isFunction(r)?r.call(this,t):this._setAttr(e,t),this}_requestDraw(){if(_o.Konva.autoDrawEnabled){const e=this.getLayer()||this.getStage();e==null||e.batchDraw()}}_setAttr(e,t){const r=this.attrs[e];r===t&&!Ue.Util.isObject(t)||(t==null?delete this.attrs[e]:this.attrs[e]=t,this._shouldFireChangeEvents&&this._fireChangeEvent(e,r,t),this._requestDraw())}_setComponentAttr(e,t,r){let i;r!==void 0&&(i=this.attrs[e],i||(this.attrs[e]=this.getAttr(e)),this.attrs[e][t]=r,this._fireChangeEvent(e,i,r))}_fireAndBubble(e,t,r){t&&this.nodeType===X3&&(t.target=this);const i=[ZU,ez,tz,nz,rz,iz];if(!(i.indexOf(e)!==-1&&(r&&(this===r||this.isAncestorOf&&this.isAncestorOf(r))||this.nodeType==="Stage"&&!r))){this._fire(e,t);const o=i.indexOf(e)!==-1&&r&&r.isAncestorOf&&r.isAncestorOf(this)&&!r.isAncestorOf(this.parent);(t&&!t.cancelBubble||!t)&&this.parent&&this.parent.isListening()&&!o&&(r&&r.parent?this._fireAndBubble.call(this.parent,e,t,r):this._fireAndBubble.call(this.parent,e,t))}}_getProtoListeners(e){var t,r,i;const s=(t=this._cache.get(Op))!==null&&t!==void 0?t:{};let o=s==null?void 0:s[e];if(o===void 0){o=[];let u=Object.getPrototypeOf(this);for(;u;){const c=(i=(r=u.eventListeners)===null||r===void 0?void 0:r[e])!==null&&i!==void 0?i:[];o.push(...c),u=Object.getPrototypeOf(u)}s[e]=o,this._cache.set(Op,s)}return o}_fire(e,t){t=t||{},t.currentTarget=this,t.type=e;const r=this._getProtoListeners(e);if(r)for(let s=0;s<r.length;s++)r[s].handler.call(this,t);const i=this.eventListeners[e];if(i)for(let s=0;s<i.length;s++)i[s].handler.call(this,t)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(e){const t=e?e.pointerId:void 0,r=this.getStage(),i=this.getAbsolutePosition();if(!r)return;const s=r._getPointerById(t)||r._changedPointerPositions[0]||i;Qr.DD._dragElements.set(this._id,{node:this,startPointerPos:s,offset:{x:s.x-i.x,y:s.y-i.y},dragStatus:"ready",pointerId:t})}startDrag(e,t=!0){Qr.DD._dragElements.has(this._id)||this._createDragElement(e);const r=Qr.DD._dragElements.get(this._id);r.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:e&&e.evt},t)}_setDragPosition(e,t){const r=this.getStage()._getPointerById(t.pointerId);if(!r)return;let i={x:r.x-t.offset.x,y:r.y-t.offset.y};const s=this.dragBoundFunc();if(s!==void 0){const o=s.call(this,i,e);o?i=o:Ue.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==i.x||this._lastPos.y!==i.y)&&(this.setAbsolutePosition(i),this._requestDraw()),this._lastPos=i}stopDrag(e){const t=Qr.DD._dragElements.get(this._id);t&&(t.dragStatus="stopped"),Qr.DD._endDragBefore(e),Qr.DD._endDragAfter(e)}setDraggable(e){this._setAttr("draggable",e),this._dragChange()}isDragging(){const e=Qr.DD._dragElements.get(this._id);return e?e.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(e){if(!(!(e.evt.button!==void 0)||_o.Konva.dragButtons.indexOf(e.evt.button)>=0)||this.isDragging())return;let i=!1;Qr.DD._dragElements.forEach(s=>{this.isAncestorOf(s.node)&&(i=!0)}),i||this._createDragElement(e)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const t=Qr.DD._dragElements.get(this._id),r=t&&t.dragStatus==="dragging",i=t&&t.dragStatus==="ready";r?this.stopDrag():i&&Qr.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(e={x:0,y:0}){const t=this.getStage();if(!t)return!1;const r={x:-e.x,y:-e.y,width:t.width()+2*e.x,height:t.height()+2*e.y};return Ue.Util.haveIntersection(r,this.getClientRect())}static create(e,t){return Ue.Util._isString(e)&&(e=JSON.parse(e)),this._createNode(e,t)}static _createNode(e,t){let r=xe.prototype.getClassName.call(e),i=e.children,s,o,u;t&&(e.attrs.container=t),_o.Konva[r]||(Ue.Util.warn('Can not find a node with class name "'+r+'". Fallback to "Shape".'),r="Shape");const c=_o.Konva[r];if(s=new c(e.attrs),i)for(o=i.length,u=0;u<o;u++)s.add(xe._createNode(i[u]));return s}}kt.Node=xe;xe.prototype.nodeType="Node";xe.prototype._attrsAffectingSize=[];xe.prototype.eventListeners={};xe.prototype.on.call(xe.prototype,oz,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(yo),this._clearSelfAndDescendantCache(Ts)});xe.prototype.on.call(xe.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(Av)});xe.prototype.on.call(xe.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(Rv)});xe.prototype.on.call(xe.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(ag)});const vt=Zd.Factory.addGetterSetter;vt(xe,"zIndex");vt(xe,"absolutePosition");vt(xe,"position");vt(xe,"x",0,(0,Wt.getNumberValidator)());vt(xe,"y",0,(0,Wt.getNumberValidator)());vt(xe,"globalCompositeOperation","source-over",(0,Wt.getStringValidator)());vt(xe,"opacity",1,(0,Wt.getNumberValidator)());vt(xe,"name","",(0,Wt.getStringValidator)());vt(xe,"id","",(0,Wt.getStringValidator)());vt(xe,"rotation",0,(0,Wt.getNumberValidator)());Zd.Factory.addComponentsGetterSetter(xe,"scale",["x","y"]);vt(xe,"scaleX",1,(0,Wt.getNumberValidator)());vt(xe,"scaleY",1,(0,Wt.getNumberValidator)());Zd.Factory.addComponentsGetterSetter(xe,"skew",["x","y"]);vt(xe,"skewX",0,(0,Wt.getNumberValidator)());vt(xe,"skewY",0,(0,Wt.getNumberValidator)());Zd.Factory.addComponentsGetterSetter(xe,"offset",["x","y"]);vt(xe,"offsetX",0,(0,Wt.getNumberValidator)());vt(xe,"offsetY",0,(0,Wt.getNumberValidator)());vt(xe,"dragDistance",void 0,(0,Wt.getNumberValidator)());vt(xe,"width",0,(0,Wt.getNumberValidator)());vt(xe,"height",0,(0,Wt.getNumberValidator)());vt(xe,"listening",!0,(0,Wt.getBooleanValidator)());vt(xe,"preventDefault",!0,(0,Wt.getBooleanValidator)());vt(xe,"filters",void 0,function(n){return this._filterUpToDate=!1,n});vt(xe,"visible",!0,(0,Wt.getBooleanValidator)());vt(xe,"transformsEnabled","all",(0,Wt.getStringValidator)());vt(xe,"size");vt(xe,"dragBoundFunc");vt(xe,"draggable",!1,(0,Wt.getBooleanValidator)());Zd.Factory.backCompat(xe,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var fl={};Object.defineProperty(fl,"__esModule",{value:!0});fl.Container=void 0;const oc=be,by=kt,n0=Re;class pl extends by.Node{constructor(){super(...arguments),this.children=[]}getChildren(e){const t=this.children||[];return e?t.filter(e):t}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.destroy()}),this.children=[],this._requestDraw(),this}add(...e){if(e.length===0)return this;if(e.length>1){for(let r=0;r<e.length;r++)this.add(e[r]);return this}const t=e[0];return t.getParent()?(t.moveTo(this),this):(this._validateAdd(t),t.index=this.getChildren().length,t.parent=this,t._clearCaches(),this.getChildren().push(t),this._fire("add",{child:t}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(e){return this._generalFind(e,!1)}findOne(e){const t=this._generalFind(e,!0);return t.length>0?t[0]:void 0}_generalFind(e,t){const r=[];return this._descendants(i=>{const s=i._isMatch(e);return s&&r.push(i),!!(s&&t)}),r}_descendants(e){let t=!1;const r=this.getChildren();for(const i of r){if(t=e(i),t)return!0;if(i.hasChildren()&&(t=i._descendants(e),t))return!0}return!1}toObject(){const e=by.Node.prototype.toObject.call(this);return e.children=[],this.getChildren().forEach(t=>{e.children.push(t.toObject())}),e}isAncestorOf(e){let t=e.getParent();for(;t;){if(t._id===this._id)return!0;t=t.getParent()}return!1}clone(e){const t=by.Node.prototype.clone.call(this,e);return this.getChildren().forEach(function(r){t.add(r.clone())}),t}getAllIntersections(e){const t=[];return this.find("Shape").forEach(r=>{r.isVisible()&&r.intersects(e)&&t.push(r)}),t}_clearSelfAndDescendantCache(e){var t;super._clearSelfAndDescendantCache(e),!this.isCached()&&((t=this.children)===null||t===void 0||t.forEach(function(r){r._clearSelfAndDescendantCache(e)}))}_setChildrenIndices(){var e;(e=this.children)===null||e===void 0||e.forEach(function(t,r){t.index=r}),this._requestDraw()}drawScene(e,t,r){const i=this.getLayer(),s=e||i&&i.getCanvas(),o=s&&s.getContext(),u=this._getCanvasCache(),c=u&&u.scene,d=s&&s.isCache;if(!this.isVisible()&&!d)return this;if(c){o.save();const p=this.getAbsoluteTransform(t).getMatrix();o.transform(p[0],p[1],p[2],p[3],p[4],p[5]),this._drawCachedSceneCanvas(o),o.restore()}else this._drawChildren("drawScene",s,t,r);return this}drawHit(e,t){if(!this.shouldDrawHit(t))return this;const r=this.getLayer(),i=e||r&&r.hitCanvas,s=i&&i.getContext(),o=this._getCanvasCache();if(o&&o.hit){s.save();const c=this.getAbsoluteTransform(t).getMatrix();s.transform(c[0],c[1],c[2],c[3],c[4],c[5]),this._drawCachedHitCanvas(s),s.restore()}else this._drawChildren("drawHit",i,t);return this}_drawChildren(e,t,r,i){var s;const o=t&&t.getContext(),u=this.clipWidth(),c=this.clipHeight(),d=this.clipFunc(),p=typeof u=="number"&&typeof c=="number"||d,m=r===this;if(p){o.save();const E=this.getAbsoluteTransform(r);let S=E.getMatrix();o.transform(S[0],S[1],S[2],S[3],S[4],S[5]),o.beginPath();let x;if(d)x=d.call(this,o,this);else{const D=this.clipX(),k=this.clipY();o.rect(D||0,k||0,u,c)}o.clip.apply(o,x),S=E.copy().invert().getMatrix(),o.transform(S[0],S[1],S[2],S[3],S[4],S[5])}const y=!m&&this.globalCompositeOperation()!=="source-over"&&e==="drawScene";y&&(o.save(),o._applyGlobalCompositeOperation(this)),(s=this.children)===null||s===void 0||s.forEach(function(E){E[e](t,r,i)}),y&&o.restore(),p&&o.restore()}getClientRect(e={}){var t;const r=e.skipTransform,i=e.relativeTo;let s,o,u,c,d={x:1/0,y:1/0,width:0,height:0};const p=this;(t=this.children)===null||t===void 0||t.forEach(function(E){if(!E.visible())return;const S=E.getClientRect({relativeTo:p,skipShadow:e.skipShadow,skipStroke:e.skipStroke});S.width===0&&S.height===0||(s===void 0?(s=S.x,o=S.y,u=S.x+S.width,c=S.y+S.height):(s=Math.min(s,S.x),o=Math.min(o,S.y),u=Math.max(u,S.x+S.width),c=Math.max(c,S.y+S.height)))});const m=this.find("Shape");let y=!1;for(let E=0;E<m.length;E++)if(m[E]._isVisible(this)){y=!0;break}return y&&s!==void 0?d={x:s,y:o,width:u-s,height:c-o}:d={x:0,y:0,width:0,height:0},r?d:this._transformedRect(d,i)}}fl.Container=pl;oc.Factory.addComponentsGetterSetter(pl,"clip",["x","y","width","height"]);oc.Factory.addGetterSetter(pl,"clipX",void 0,(0,n0.getNumberValidator)());oc.Factory.addGetterSetter(pl,"clipY",void 0,(0,n0.getNumberValidator)());oc.Factory.addGetterSetter(pl,"clipWidth",void 0,(0,n0.getNumberValidator)());oc.Factory.addGetterSetter(pl,"clipHeight",void 0,(0,n0.getNumberValidator)());oc.Factory.addGetterSetter(pl,"clipFunc");var OR={},ia={};Object.defineProperty(ia,"__esModule",{value:!0});ia.getCapturedShape=uz;ia.createEvent=rS;ia.hasPointerCapture=cz;ia.setPointerCapture=hz;ia.releaseCapture=bR;const lz=Oe,Ed=new Map,LR=lz.Konva._global.PointerEvent!==void 0;function uz(n){return Ed.get(n)}function rS(n){return{evt:n,pointerId:n.pointerId}}function cz(n,e){return Ed.get(n)===e}function hz(n,e){bR(n),e.getStage()&&(Ed.set(n,e),LR&&e._fire("gotpointercapture",rS(new PointerEvent("gotpointercapture"))))}function bR(n,e){const t=Ed.get(n);if(!t)return;const r=t.getStage();r&&r.content,Ed.delete(n),LR&&t._fire("lostpointercapture",rS(new PointerEvent("lostpointercapture")))}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Stage=n.stages=void 0;const e=bt,t=be,r=fl,i=Oe,s=Ri,o=t0,u=Oe,c=ia,d="Stage",p="string",m="px",y="mouseout",E="mouseleave",S="mouseover",x="mouseenter",D="mousemove",k="mousedown",R="mouseup",w="pointermove",P="pointerdown",V="pointerup",z="pointercancel",M="lostpointercapture",C="pointerout",N="pointerleave",A="pointerover",L="pointerenter",U="contextmenu",F="touchstart",pe="touchend",Y="touchmove",he="touchcancel",ue="wheel",H=5,te=[[x,"_pointerenter"],[k,"_pointerdown"],[D,"_pointermove"],[R,"_pointerup"],[E,"_pointerleave"],[F,"_pointerdown"],[Y,"_pointermove"],[pe,"_pointerup"],[he,"_pointercancel"],[S,"_pointerover"],[ue,"_wheel"],[U,"_contextmenu"],[P,"_pointerdown"],[w,"_pointermove"],[V,"_pointerup"],[z,"_pointercancel"],[N,"_pointerleave"],[M,"_lostpointercapture"]],J={mouse:{[C]:y,[N]:E,[A]:S,[L]:x,[w]:D,[P]:k,[V]:R,[z]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[C]:"touchout",[N]:"touchleave",[A]:"touchover",[L]:"touchenter",[w]:Y,[P]:F,[V]:pe,[z]:he,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[C]:C,[N]:N,[A]:A,[L]:L,[w]:w,[P]:P,[V]:V,[z]:z,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},ee=ht=>ht.indexOf("pointer")>=0?"pointer":ht.indexOf("touch")>=0?"touch":"mouse",ae=ht=>{const B=ee(ht);if(B==="pointer")return i.Konva.pointerEventsEnabled&&J.pointer;if(B==="touch")return J.touch;if(B==="mouse")return J.mouse};function Ee(ht={}){return(ht.clipFunc||ht.clipWidth||ht.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),ht}const ut="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";n.stages=[];class ct extends r.Container{constructor(B){super(Ee(B)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),n.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{Ee(this.attrs)}),this._checkVisibility()}_validateAdd(B){const re=B.getType()==="Layer",ve=B.getType()==="FastLayer";re||ve||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const B=this.visible()?"":"none";this.content.style.display=B}setContainer(B){if(typeof B===p){let re;if(B.charAt(0)==="."){const ve=B.slice(1);B=document.getElementsByClassName(ve)[0]}else B.charAt(0)!=="#"?re=B:re=B.slice(1),B=document.getElementById(re);if(!B)throw"Can not find container in document with id "+re}return this._setAttr("container",B),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),B.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const B=this.children,re=B.length;for(let ve=0;ve<re;ve++)B[ve].clear();return this}clone(B){return B||(B={}),B.container=typeof document<"u"&&document.createElement("div"),r.Container.prototype.clone.call(this,B)}destroy(){super.destroy();const B=this.content;B&&e.Util._isInDocument(B)&&this.container().removeChild(B);const re=n.stages.indexOf(this);return re>-1&&n.stages.splice(re,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const B=this._pointerPositions[0]||this._changedPointerPositions[0];return B?{x:B.x,y:B.y}:(e.Util.warn(ut),null)}_getPointerById(B){return this._pointerPositions.find(re=>re.id===B)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(B){B=B||{},B.x=B.x||0,B.y=B.y||0,B.width=B.width||this.width(),B.height=B.height||this.height();const re=new s.SceneCanvas({width:B.width,height:B.height,pixelRatio:B.pixelRatio||1}),ve=re.getContext()._context,He=this.children;return(B.x||B.y)&&ve.translate(-1*B.x,-1*B.y),He.forEach(function(Ae){if(!Ae.isVisible())return;const it=Ae._toKonvaCanvas(B);ve.drawImage(it._canvas,B.x,B.y,it.getWidth()/it.getPixelRatio(),it.getHeight()/it.getPixelRatio())}),re}getIntersection(B){if(!B)return null;const re=this.children,ve=re.length,He=ve-1;for(let Ae=He;Ae>=0;Ae--){const it=re[Ae].getIntersection(B);if(it)return it}return null}_resizeDOM(){const B=this.width(),re=this.height();this.content&&(this.content.style.width=B+m,this.content.style.height=re+m),this.bufferCanvas.setSize(B,re),this.bufferHitCanvas.setSize(B,re),this.children.forEach(ve=>{ve.setSize({width:B,height:re}),ve.draw()})}add(B,...re){if(arguments.length>1){for(let He=0;He<arguments.length;He++)this.add(arguments[He]);return this}super.add(B);const ve=this.children.length;return ve>H&&e.Util.warn("The stage has "+ve+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),B.setSize({width:this.width(),height:this.height()}),B.draw(),i.Konva.isBrowser&&this.content.appendChild(B.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(B){return c.hasPointerCapture(B,this)}setPointerCapture(B){c.setPointerCapture(B,this)}releaseCapture(B){c.releaseCapture(B,this)}getLayers(){return this.children}_bindContentEvents(){i.Konva.isBrowser&&te.forEach(([B,re])=>{this.content.addEventListener(B,ve=>{this[re](ve)},{passive:!1})})}_pointerenter(B){this.setPointersPositions(B);const re=ae(B.type);re&&this._fire(re.pointerenter,{evt:B,target:this,currentTarget:this})}_pointerover(B){this.setPointersPositions(B);const re=ae(B.type);re&&this._fire(re.pointerover,{evt:B,target:this,currentTarget:this})}_getTargetShape(B){let re=this[B+"targetShape"];return re&&!re.getStage()&&(re=null),re}_pointerleave(B){const re=ae(B.type),ve=ee(B.type);if(!re)return;this.setPointersPositions(B);const He=this._getTargetShape(ve),Ae=!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled;He&&Ae?(He._fireAndBubble(re.pointerout,{evt:B}),He._fireAndBubble(re.pointerleave,{evt:B}),this._fire(re.pointerleave,{evt:B,target:this,currentTarget:this}),this[ve+"targetShape"]=null):Ae&&(this._fire(re.pointerleave,{evt:B,target:this,currentTarget:this}),this._fire(re.pointerout,{evt:B,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(B){const re=ae(B.type),ve=ee(B.type);if(!re)return;this.setPointersPositions(B);let He=!1;this._changedPointerPositions.forEach(Ae=>{const it=this.getIntersection(Ae);if(o.DD.justDragged=!1,i.Konva["_"+ve+"ListenClick"]=!0,!it||!it.isListening()){this[ve+"ClickStartShape"]=void 0;return}i.Konva.capturePointerEventsEnabled&&it.setPointerCapture(Ae.id),this[ve+"ClickStartShape"]=it,it._fireAndBubble(re.pointerdown,{evt:B,pointerId:Ae.id}),He=!0;const at=B.type.indexOf("touch")>=0;it.preventDefault()&&B.cancelable&&at&&B.preventDefault()}),He||this._fire(re.pointerdown,{evt:B,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(B){const re=ae(B.type),ve=ee(B.type);if(!re||(i.Konva.isDragging()&&o.DD.node.preventDefault()&&B.cancelable&&B.preventDefault(),this.setPointersPositions(B),!(!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled)))return;const Ae={};let it=!1;const at=this._getTargetShape(ve);this._changedPointerPositions.forEach(gr=>{const nt=c.getCapturedShape(gr.id)||this.getIntersection(gr),si=gr.id,xr={evt:B,pointerId:si},Ni=at!==nt;if(Ni&&at&&(at._fireAndBubble(re.pointerout,{...xr},nt),at._fireAndBubble(re.pointerleave,{...xr},nt)),nt){if(Ae[nt._id])return;Ae[nt._id]=!0}nt&&nt.isListening()?(it=!0,Ni&&(nt._fireAndBubble(re.pointerover,{...xr},at),nt._fireAndBubble(re.pointerenter,{...xr},at),this[ve+"targetShape"]=nt),nt._fireAndBubble(re.pointermove,{...xr})):at&&(this._fire(re.pointerover,{evt:B,target:this,currentTarget:this,pointerId:si}),this[ve+"targetShape"]=null)}),it||this._fire(re.pointermove,{evt:B,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(B){const re=ae(B.type),ve=ee(B.type);if(!re)return;this.setPointersPositions(B);const He=this[ve+"ClickStartShape"],Ae=this[ve+"ClickEndShape"],it={};let at=!1;this._changedPointerPositions.forEach(gr=>{const nt=c.getCapturedShape(gr.id)||this.getIntersection(gr);if(nt){if(nt.releaseCapture(gr.id),it[nt._id])return;it[nt._id]=!0}const si=gr.id,xr={evt:B,pointerId:si};let Ni=!1;i.Konva["_"+ve+"InDblClickWindow"]?(Ni=!0,clearTimeout(this[ve+"DblTimeout"])):o.DD.justDragged||(i.Konva["_"+ve+"InDblClickWindow"]=!0,clearTimeout(this[ve+"DblTimeout"])),this[ve+"DblTimeout"]=setTimeout(function(){i.Konva["_"+ve+"InDblClickWindow"]=!1},i.Konva.dblClickWindow),nt&&nt.isListening()?(at=!0,this[ve+"ClickEndShape"]=nt,nt._fireAndBubble(re.pointerup,{...xr}),i.Konva["_"+ve+"ListenClick"]&&He&&He===nt&&(nt._fireAndBubble(re.pointerclick,{...xr}),Ni&&Ae&&Ae===nt&&nt._fireAndBubble(re.pointerdblclick,{...xr}))):(this[ve+"ClickEndShape"]=null,i.Konva["_"+ve+"ListenClick"]&&this._fire(re.pointerclick,{evt:B,target:this,currentTarget:this,pointerId:si}),Ni&&this._fire(re.pointerdblclick,{evt:B,target:this,currentTarget:this,pointerId:si}))}),at||this._fire(re.pointerup,{evt:B,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),i.Konva["_"+ve+"ListenClick"]=!1,B.cancelable&&ve!=="touch"&&ve!=="pointer"&&B.preventDefault()}_contextmenu(B){this.setPointersPositions(B);const re=this.getIntersection(this.getPointerPosition());re&&re.isListening()?re._fireAndBubble(U,{evt:B}):this._fire(U,{evt:B,target:this,currentTarget:this})}_wheel(B){this.setPointersPositions(B);const re=this.getIntersection(this.getPointerPosition());re&&re.isListening()?re._fireAndBubble(ue,{evt:B}):this._fire(ue,{evt:B,target:this,currentTarget:this})}_pointercancel(B){this.setPointersPositions(B);const re=c.getCapturedShape(B.pointerId)||this.getIntersection(this.getPointerPosition());re&&re._fireAndBubble(V,c.createEvent(B)),c.releaseCapture(B.pointerId)}_lostpointercapture(B){c.releaseCapture(B.pointerId)}setPointersPositions(B){const re=this._getContentPosition();let ve=null,He=null;B=B||window.event,B.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(B.touches,Ae=>{this._pointerPositions.push({id:Ae.identifier,x:(Ae.clientX-re.left)/re.scaleX,y:(Ae.clientY-re.top)/re.scaleY})}),Array.prototype.forEach.call(B.changedTouches||B.touches,Ae=>{this._changedPointerPositions.push({id:Ae.identifier,x:(Ae.clientX-re.left)/re.scaleX,y:(Ae.clientY-re.top)/re.scaleY})})):(ve=(B.clientX-re.left)/re.scaleX,He=(B.clientY-re.top)/re.scaleY,this.pointerPos={x:ve,y:He},this._pointerPositions=[{x:ve,y:He,id:e.Util._getFirstPointerId(B)}],this._changedPointerPositions=[{x:ve,y:He,id:e.Util._getFirstPointerId(B)}])}_setPointerPosition(B){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(B)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const B=this.content.getBoundingClientRect();return{top:B.top,left:B.left,scaleX:B.width/this.content.clientWidth||1,scaleY:B.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new s.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new s.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!i.Konva.isBrowser)return;const B=this.container();if(!B)throw"Stage has no container. A container is required.";B.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),B.appendChild(this.content),this._resizeDOM()}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(B){B.batchDraw()}),this}}n.Stage=ct,ct.prototype.nodeType=d,(0,u._registerNode)(ct),t.Factory.addGetterSetter(ct,"container"),i.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{n.stages.forEach(ht=>{ht.batchDraw()})})})(OR);var ef={},ln={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Shape=n.shapes=void 0;const e=Oe,t=bt,r=be,i=kt,s=Re,o=Oe,u=ia,c="hasShadow",d="shadowRGBA",p="patternImage",m="linearGradient",y="radialGradient";let E;function S(){return E||(E=t.Util.createCanvasElement().getContext("2d"),E)}n.shapes={};function x(N){const A=this.attrs.fillRule;A?N.fill(A):N.fill()}function D(N){N.stroke()}function k(N){const A=this.attrs.fillRule;A?N.fill(A):N.fill()}function R(N){N.stroke()}function w(){this._clearCache(c)}function P(){this._clearCache(d)}function V(){this._clearCache(p)}function z(){this._clearCache(m)}function M(){this._clearCache(y)}class C extends i.Node{constructor(A){super(A);let L;for(;L=t.Util.getRandomColor(),!(L&&!(L in n.shapes)););this.colorKey=L,n.shapes[L]=this}getContext(){return t.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return t.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(c,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(p,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const L=S().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(L&&L.setTransform){const U=new t.Transform;U.translate(this.fillPatternX(),this.fillPatternY()),U.rotate(e.Konva.getAngle(this.fillPatternRotation())),U.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),U.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const F=U.getMatrix(),pe=typeof DOMMatrix>"u"?{a:F[0],b:F[1],c:F[2],d:F[3],e:F[4],f:F[5]}:new DOMMatrix(F);L.setTransform(pe)}return L}}_getLinearGradient(){return this._getCache(m,this.__getLinearGradient)}__getLinearGradient(){const A=this.fillLinearGradientColorStops();if(A){const L=S(),U=this.fillLinearGradientStartPoint(),F=this.fillLinearGradientEndPoint(),pe=L.createLinearGradient(U.x,U.y,F.x,F.y);for(let Y=0;Y<A.length;Y+=2)pe.addColorStop(A[Y],A[Y+1]);return pe}}_getRadialGradient(){return this._getCache(y,this.__getRadialGradient)}__getRadialGradient(){const A=this.fillRadialGradientColorStops();if(A){const L=S(),U=this.fillRadialGradientStartPoint(),F=this.fillRadialGradientEndPoint(),pe=L.createRadialGradient(U.x,U.y,this.fillRadialGradientStartRadius(),F.x,F.y,this.fillRadialGradientEndRadius());for(let Y=0;Y<A.length;Y+=2)pe.addColorStop(A[Y],A[Y+1]);return pe}}getShadowRGBA(){return this._getCache(d,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const A=t.Util.colorToRGBA(this.shadowColor());if(A)return"rgba("+A.r+","+A.g+","+A.b+","+A.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const A=this.hitStrokeWidth();return A==="auto"?this.hasStroke():this.strokeEnabled()&&!!A}intersects(A){const L=this.getStage();if(!L)return!1;const U=L.bufferHitCanvas;return U.getContext().clear(),this.drawHit(U,void 0,!0),U.context.getImageData(Math.round(A.x),Math.round(A.y),1,1).data[3]>0}destroy(){return i.Node.prototype.destroy.call(this),delete n.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(A){var L;if(!((L=this.attrs.perfectDrawEnabled)!==null&&L!==void 0?L:!0))return!1;const F=A||this.hasFill(),pe=this.hasStroke(),Y=this.getAbsoluteOpacity()!==1;if(F&&pe&&Y)return!0;const he=this.hasShadow(),ue=this.shadowForStrokeEnabled();return!!(F&&pe&&he&&ue)}setStrokeHitEnabled(A){t.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),A?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const A=this.size();return{x:this._centroid?-A.width/2:0,y:this._centroid?-A.height/2:0,width:A.width,height:A.height}}getClientRect(A={}){let L=!1,U=this.getParent();for(;U;){if(U.isCached()){L=!0;break}U=U.getParent()}const F=A.skipTransform,pe=A.relativeTo||L&&this.getStage()||void 0,Y=this.getSelfRect(),ue=!A.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,H=Y.width+ue,te=Y.height+ue,J=!A.skipShadow&&this.hasShadow(),ee=J?this.shadowOffsetX():0,ae=J?this.shadowOffsetY():0,Ee=H+Math.abs(ee),ut=te+Math.abs(ae),ct=J&&this.shadowBlur()||0,ht=Ee+ct*2,B=ut+ct*2,re={width:ht,height:B,x:-(ue/2+ct)+Math.min(ee,0)+Y.x,y:-(ue/2+ct)+Math.min(ae,0)+Y.y};return F?re:this._transformedRect(re,pe)}drawScene(A,L,U){const F=this.getLayer(),pe=A||F.getCanvas(),Y=pe.getContext(),he=this._getCanvasCache(),ue=this.getSceneFunc(),H=this.hasShadow();let te;const J=L===this;if(!this.isVisible()&&!J)return this;if(he){Y.save();const ee=this.getAbsoluteTransform(L).getMatrix();return Y.transform(ee[0],ee[1],ee[2],ee[3],ee[4],ee[5]),this._drawCachedSceneCanvas(Y),Y.restore(),this}if(!ue)return this;if(Y.save(),this._useBufferCanvas()){te=this.getStage();const ee=U||te.bufferCanvas,ae=ee.getContext();ae.clear(),ae.save(),ae._applyLineJoin(this);const Ee=this.getAbsoluteTransform(L).getMatrix();ae.transform(Ee[0],Ee[1],Ee[2],Ee[3],Ee[4],Ee[5]),ue.call(this,ae,this),ae.restore();const ut=ee.pixelRatio;H&&Y._applyShadow(this),Y._applyOpacity(this),Y._applyGlobalCompositeOperation(this),Y.drawImage(ee._canvas,ee.x||0,ee.y||0,ee.width/ut,ee.height/ut)}else{if(Y._applyLineJoin(this),!J){const ee=this.getAbsoluteTransform(L).getMatrix();Y.transform(ee[0],ee[1],ee[2],ee[3],ee[4],ee[5]),Y._applyOpacity(this),Y._applyGlobalCompositeOperation(this)}H&&Y._applyShadow(this),ue.call(this,Y,this)}return Y.restore(),this}drawHit(A,L,U=!1){if(!this.shouldDrawHit(L,U))return this;const F=this.getLayer(),pe=A||F.hitCanvas,Y=pe&&pe.getContext(),he=this.hitFunc()||this.sceneFunc(),ue=this._getCanvasCache(),H=ue&&ue.hit;if(this.colorKey||t.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),H){Y.save();const J=this.getAbsoluteTransform(L).getMatrix();return Y.transform(J[0],J[1],J[2],J[3],J[4],J[5]),this._drawCachedHitCanvas(Y),Y.restore(),this}if(!he)return this;if(Y.save(),Y._applyLineJoin(this),!(this===L)){const J=this.getAbsoluteTransform(L).getMatrix();Y.transform(J[0],J[1],J[2],J[3],J[4],J[5])}return he.call(this,Y,this),Y.restore(),this}drawHitFromCache(A=0){const L=this._getCanvasCache(),U=this._getCachedSceneCanvas(),F=L.hit,pe=F.getContext(),Y=F.getWidth(),he=F.getHeight();pe.clear(),pe.drawImage(U._canvas,0,0,Y,he);try{const ue=pe.getImageData(0,0,Y,he),H=ue.data,te=H.length,J=t.Util._hexToRgb(this.colorKey);for(let ee=0;ee<te;ee+=4)H[ee+3]>A?(H[ee]=J.r,H[ee+1]=J.g,H[ee+2]=J.b,H[ee+3]=255):H[ee+3]=0;pe.putImageData(ue,0,0)}catch(ue){t.Util.error("Unable to draw hit graph from cached scene canvas. "+ue.message)}return this}hasPointerCapture(A){return u.hasPointerCapture(A,this)}setPointerCapture(A){u.setPointerCapture(A,this)}releaseCapture(A){u.releaseCapture(A,this)}}n.Shape=C,C.prototype._fillFunc=x,C.prototype._strokeFunc=D,C.prototype._fillFuncHit=k,C.prototype._strokeFuncHit=R,C.prototype._centroid=!1,C.prototype.nodeType="Shape",(0,o._registerNode)(C),C.prototype.eventListeners={},C.prototype.on.call(C.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",w),C.prototype.on.call(C.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",P),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",V),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",z),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",M),r.Factory.addGetterSetter(C,"stroke",void 0,(0,s.getStringOrGradientValidator)()),r.Factory.addGetterSetter(C,"strokeWidth",2,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillAfterStrokeEnabled",!1),r.Factory.addGetterSetter(C,"hitStrokeWidth","auto",(0,s.getNumberOrAutoValidator)()),r.Factory.addGetterSetter(C,"strokeHitEnabled",!0,(0,s.getBooleanValidator)()),r.Factory.addGetterSetter(C,"perfectDrawEnabled",!0,(0,s.getBooleanValidator)()),r.Factory.addGetterSetter(C,"shadowForStrokeEnabled",!0,(0,s.getBooleanValidator)()),r.Factory.addGetterSetter(C,"lineJoin"),r.Factory.addGetterSetter(C,"lineCap"),r.Factory.addGetterSetter(C,"sceneFunc"),r.Factory.addGetterSetter(C,"hitFunc"),r.Factory.addGetterSetter(C,"dash"),r.Factory.addGetterSetter(C,"dashOffset",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"shadowColor",void 0,(0,s.getStringValidator)()),r.Factory.addGetterSetter(C,"shadowBlur",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"shadowOpacity",1,(0,s.getNumberValidator)()),r.Factory.addComponentsGetterSetter(C,"shadowOffset",["x","y"]),r.Factory.addGetterSetter(C,"shadowOffsetX",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"shadowOffsetY",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillPatternImage"),r.Factory.addGetterSetter(C,"fill",void 0,(0,s.getStringOrGradientValidator)()),r.Factory.addGetterSetter(C,"fillPatternX",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillPatternY",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillLinearGradientColorStops"),r.Factory.addGetterSetter(C,"strokeLinearGradientColorStops"),r.Factory.addGetterSetter(C,"fillRadialGradientStartRadius",0),r.Factory.addGetterSetter(C,"fillRadialGradientEndRadius",0),r.Factory.addGetterSetter(C,"fillRadialGradientColorStops"),r.Factory.addGetterSetter(C,"fillPatternRepeat","repeat"),r.Factory.addGetterSetter(C,"fillEnabled",!0),r.Factory.addGetterSetter(C,"strokeEnabled",!0),r.Factory.addGetterSetter(C,"shadowEnabled",!0),r.Factory.addGetterSetter(C,"dashEnabled",!0),r.Factory.addGetterSetter(C,"strokeScaleEnabled",!0),r.Factory.addGetterSetter(C,"fillPriority","color"),r.Factory.addComponentsGetterSetter(C,"fillPatternOffset",["x","y"]),r.Factory.addGetterSetter(C,"fillPatternOffsetX",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillPatternOffsetY",0,(0,s.getNumberValidator)()),r.Factory.addComponentsGetterSetter(C,"fillPatternScale",["x","y"]),r.Factory.addGetterSetter(C,"fillPatternScaleX",1,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillPatternScaleY",1,(0,s.getNumberValidator)()),r.Factory.addComponentsGetterSetter(C,"fillLinearGradientStartPoint",["x","y"]),r.Factory.addComponentsGetterSetter(C,"strokeLinearGradientStartPoint",["x","y"]),r.Factory.addGetterSetter(C,"fillLinearGradientStartPointX",0),r.Factory.addGetterSetter(C,"strokeLinearGradientStartPointX",0),r.Factory.addGetterSetter(C,"fillLinearGradientStartPointY",0),r.Factory.addGetterSetter(C,"strokeLinearGradientStartPointY",0),r.Factory.addComponentsGetterSetter(C,"fillLinearGradientEndPoint",["x","y"]),r.Factory.addComponentsGetterSetter(C,"strokeLinearGradientEndPoint",["x","y"]),r.Factory.addGetterSetter(C,"fillLinearGradientEndPointX",0),r.Factory.addGetterSetter(C,"strokeLinearGradientEndPointX",0),r.Factory.addGetterSetter(C,"fillLinearGradientEndPointY",0),r.Factory.addGetterSetter(C,"strokeLinearGradientEndPointY",0),r.Factory.addComponentsGetterSetter(C,"fillRadialGradientStartPoint",["x","y"]),r.Factory.addGetterSetter(C,"fillRadialGradientStartPointX",0),r.Factory.addGetterSetter(C,"fillRadialGradientStartPointY",0),r.Factory.addComponentsGetterSetter(C,"fillRadialGradientEndPoint",["x","y"]),r.Factory.addGetterSetter(C,"fillRadialGradientEndPointX",0),r.Factory.addGetterSetter(C,"fillRadialGradientEndPointY",0),r.Factory.addGetterSetter(C,"fillPatternRotation",0),r.Factory.addGetterSetter(C,"fillRule",void 0,(0,s.getStringValidator)()),r.Factory.backCompat(C,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(ln);Object.defineProperty(ef,"__esModule",{value:!0});ef.Layer=void 0;const Ss=bt,Fy=fl,ql=kt,iS=be,Z3=Ri,dz=Re,fz=ln,pz=Oe,gz="#",mz="beforeDraw",_z="draw",FR=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],yz=FR.length;let ac=class extends Fy.Container{constructor(e){super(e),this.canvas=new Z3.SceneCanvas,this.hitCanvas=new Z3.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(e){return this.getContext().clear(e),this.getHitCanvas().getContext().clear(e),this}setZIndex(e){super.setZIndex(e);const t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),e<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[e+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){ql.Node.prototype.moveToTop.call(this);const e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!ql.Node.prototype.moveUp.call(this))return!1;const t=this.getStage();return!t||!t.content?!1:(t.content.removeChild(this.getNativeCanvasElement()),this.index<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[this.index+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(ql.Node.prototype.moveDown.call(this)){const e=this.getStage();if(e){const t=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),t[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(ql.Node.prototype.moveToBottom.call(this)){const e=this.getStage();if(e){const t=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),t[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const e=this.getNativeCanvasElement();return ql.Node.prototype.remove.call(this),e&&e.parentNode&&Ss.Util._isInDocument(e)&&e.parentNode.removeChild(e),this}getStage(){return this.parent}setSize({width:e,height:t}){return this.canvas.setSize(e,t),this.hitCanvas.setSize(e,t),this._setSmoothEnabled(),this}_validateAdd(e){const t=e.getType();t!=="Group"&&t!=="Shape"&&Ss.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(e){return e=e||{},e.width=e.width||this.getWidth(),e.height=e.height||this.getHeight(),e.x=e.x!==void 0?e.x:this.x(),e.y=e.y!==void 0?e.y:this.y(),ql.Node.prototype._toKonvaCanvas.call(this,e)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){Ss.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){Ss.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,Ss.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(e){if(!this.isListening()||!this.isVisible())return null;let t=1,r=!1;for(;;){for(let i=0;i<yz;i++){const s=FR[i],o=this._getIntersection({x:e.x+s.x*t,y:e.y+s.y*t}),u=o.shape;if(u)return u;if(r=!!o.antialiased,!o.antialiased)break}if(r)t+=1;else return null}}_getIntersection(e){const t=this.hitCanvas.pixelRatio,r=this.hitCanvas.context.getImageData(Math.round(e.x*t),Math.round(e.y*t),1,1).data,i=r[3];if(i===255){const s=Ss.Util._rgbToHex(r[0],r[1],r[2]),o=fz.shapes[gz+s];return o?{shape:o}:{antialiased:!0}}else if(i>0)return{antialiased:!0};return{}}drawScene(e,t,r){const i=this.getLayer(),s=e||i&&i.getCanvas();return this._fire(mz,{node:this}),this.clearBeforeDraw()&&s.getContext().clear(),Fy.Container.prototype.drawScene.call(this,s,t,r),this._fire(_z,{node:this}),this}drawHit(e,t){const r=this.getLayer(),i=e||r&&r.hitCanvas;return r&&r.clearBeforeDraw()&&r.getHitCanvas().getContext().clear(),Fy.Container.prototype.drawHit.call(this,i,t),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(e){Ss.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(e)}getHitGraphEnabled(e){return Ss.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const e=this.parent;!!this.hitCanvas._canvas.parentNode?e.content.removeChild(this.hitCanvas._canvas):e.content.appendChild(this.hitCanvas._canvas)}destroy(){return Ss.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};ef.Layer=ac;ac.prototype.nodeType="Layer";(0,pz._registerNode)(ac);iS.Factory.addGetterSetter(ac,"imageSmoothingEnabled",!0);iS.Factory.addGetterSetter(ac,"clearBeforeDraw",!0);iS.Factory.addGetterSetter(ac,"hitGraphEnabled",!0,(0,dz.getBooleanValidator)());var r0={};Object.defineProperty(r0,"__esModule",{value:!0});r0.FastLayer=void 0;const vz=bt,wz=ef,Sz=Oe;class sS extends wz.Layer{constructor(e){super(e),this.listening(!1),vz.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}r0.FastLayer=sS;sS.prototype.nodeType="FastLayer";(0,Sz._registerNode)(sS);var lc={};Object.defineProperty(lc,"__esModule",{value:!0});lc.Group=void 0;const Ez=bt,Tz=fl,Cz=Oe;class oS extends Tz.Container{_validateAdd(e){const t=e.getType();t!=="Group"&&t!=="Shape"&&Ez.Util.throw("You may only add groups and shapes to groups.")}}lc.Group=oS;oS.prototype.nodeType="Group";(0,Cz._registerNode)(oS);var uc={};Object.defineProperty(uc,"__esModule",{value:!0});uc.Animation=void 0;const Vy=Oe,eC=bt,Uy=function(){return Vy.glob.performance&&Vy.glob.performance.now?function(){return Vy.glob.performance.now()}:function(){return new Date().getTime()}}();class Qi{constructor(e,t){this.id=Qi.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:Uy(),frameRate:0},this.func=e,this.setLayers(t)}setLayers(e){let t=[];return e&&(t=Array.isArray(e)?e:[e]),this.layers=t,this}getLayers(){return this.layers}addLayer(e){const t=this.layers,r=t.length;for(let i=0;i<r;i++)if(t[i]._id===e._id)return!1;return this.layers.push(e),!0}isRunning(){const t=Qi.animations,r=t.length;for(let i=0;i<r;i++)if(t[i].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=Uy(),Qi._addAnimation(this),this}stop(){return Qi._removeAnimation(this),this}_updateFrameObject(e){this.frame.timeDiff=e-this.frame.lastTime,this.frame.lastTime=e,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(e){this.animations.push(e),this._handleAnimation()}static _removeAnimation(e){const t=e.id,r=this.animations,i=r.length;for(let s=0;s<i;s++)if(r[s].id===t){this.animations.splice(s,1);break}}static _runFrames(){const e={},t=this.animations;for(let r=0;r<t.length;r++){const i=t[r],s=i.layers,o=i.func;i._updateFrameObject(Uy());const u=s.length;let c;if(o?c=o.call(i,i.frame)!==!1:c=!0,!!c)for(let d=0;d<u;d++){const p=s[d];p._id!==void 0&&(e[p._id]=p)}}for(const r in e)e.hasOwnProperty(r)&&e[r].batchDraw()}static _animationLoop(){const e=Qi;e.animations.length?(e._runFrames(),eC.Util.requestAnimFrame(e._animationLoop)):e.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,eC.Util.requestAnimFrame(this._animationLoop))}}uc.Animation=Qi;Qi.animations=[];Qi.animIdCounter=0;Qi.animRunning=!1;var VR={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Easings=n.Tween=void 0;const e=bt,t=uc,r=kt,i=Oe,s={node:1,duration:1,easing:1,onFinish:1,yoyo:1},o=1,u=2,c=3,d=["fill","stroke","shadowColor"];let p=0;class m{constructor(S,x,D,k,R,w,P){this.prop=S,this.propFunc=x,this.begin=k,this._pos=k,this.duration=w,this._change=0,this.prevPos=0,this.yoyo=P,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=D,this._change=R-this.begin,this.pause()}fire(S){const x=this[S];x&&x()}setTime(S){S>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():S<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=S,this.update())}getTime(){return this._time}setPosition(S){this.prevPos=this._pos,this.propFunc(S),this._pos=S}getPosition(S){return S===void 0&&(S=this._time),this.func(S,this.begin,this._change,this.duration)}play(){this.state=u,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=c,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(S){this.pause(),this._time=S,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const S=this.getTimer()-this._startTime;this.state===u?this.setTime(S):this.state===c&&this.setTime(this.duration-S)}pause(){this.state=o,this.fire("onPause")}getTimer(){return new Date().getTime()}}class y{constructor(S){const x=this,D=S.node,k=D._id,R=S.easing||n.Easings.Linear,w=!!S.yoyo;let P,V;typeof S.duration>"u"?P=.3:S.duration===0?P=.001:P=S.duration,this.node=D,this._id=p++;const z=D.getLayer()||(D instanceof i.Konva.Stage?D.getLayers():null);z||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new t.Animation(function(){x.tween.onEnterFrame()},z),this.tween=new m(V,function(M){x._tweenFunc(M)},R,0,1,P*1e3,w),this._addListeners(),y.attrs[k]||(y.attrs[k]={}),y.attrs[k][this._id]||(y.attrs[k][this._id]={}),y.tweens[k]||(y.tweens[k]={});for(V in S)s[V]===void 0&&this._addAttr(V,S[V]);this.reset(),this.onFinish=S.onFinish,this.onReset=S.onReset,this.onUpdate=S.onUpdate}_addAttr(S,x){const D=this.node,k=D._id;let R,w,P,V,z;const M=y.tweens[k][S];M&&delete y.attrs[k][M][S];let C=D.getAttr(S);if(e.Util._isArray(x))if(R=[],w=Math.max(x.length,C.length),S==="points"&&x.length!==C.length&&(x.length>C.length?(V=C,C=e.Util._prepareArrayForTween(C,x,D.closed())):(P=x,x=e.Util._prepareArrayForTween(x,C,D.closed()))),S.indexOf("fill")===0)for(let N=0;N<w;N++)if(N%2===0)R.push(x[N]-C[N]);else{const A=e.Util.colorToRGBA(C[N]);z=e.Util.colorToRGBA(x[N]),C[N]=A,R.push({r:z.r-A.r,g:z.g-A.g,b:z.b-A.b,a:z.a-A.a})}else for(let N=0;N<w;N++)R.push(x[N]-C[N]);else d.indexOf(S)!==-1?(C=e.Util.colorToRGBA(C),z=e.Util.colorToRGBA(x),R={r:z.r-C.r,g:z.g-C.g,b:z.b-C.b,a:z.a-C.a}):R=x-C;y.attrs[k][this._id][S]={start:C,diff:R,end:x,trueEnd:P,trueStart:V},y.tweens[k][S]=this._id}_tweenFunc(S){const x=this.node,D=y.attrs[x._id][this._id];let k,R,w,P,V,z,M,C;for(k in D){if(R=D[k],w=R.start,P=R.diff,C=R.end,e.Util._isArray(w))if(V=[],M=Math.max(w.length,C.length),k.indexOf("fill")===0)for(z=0;z<M;z++)z%2===0?V.push((w[z]||0)+P[z]*S):V.push("rgba("+Math.round(w[z].r+P[z].r*S)+","+Math.round(w[z].g+P[z].g*S)+","+Math.round(w[z].b+P[z].b*S)+","+(w[z].a+P[z].a*S)+")");else for(z=0;z<M;z++)V.push((w[z]||0)+P[z]*S);else d.indexOf(k)!==-1?V="rgba("+Math.round(w.r+P.r*S)+","+Math.round(w.g+P.g*S)+","+Math.round(w.b+P.b*S)+","+(w.a+P.a*S)+")":V=w+P*S;x.setAttr(k,V)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const S=this.node,x=y.attrs[S._id][this._id];x.points&&x.points.trueEnd&&S.setAttr("points",x.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const S=this.node,x=y.attrs[S._id][this._id];x.points&&x.points.trueStart&&S.points(x.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(S){return this.tween.seek(S*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const S=this.node._id,x=this._id,D=y.tweens[S];this.pause(),this.anim&&this.anim.stop();for(const k in D)delete y.tweens[S][k];delete y.attrs[S][x],y.tweens[S]&&(Object.keys(y.tweens[S]).length===0&&delete y.tweens[S],Object.keys(y.attrs[S]).length===0&&delete y.attrs[S])}}n.Tween=y,y.attrs={},y.tweens={},r.Node.prototype.to=function(E){const S=E.onFinish;E.node=this,E.onFinish=function(){this.destroy(),S&&S()},new y(E).play()},n.Easings={BackEaseIn(E,S,x,D){return x*(E/=D)*E*((1.70158+1)*E-1.70158)+S},BackEaseOut(E,S,x,D){return x*((E=E/D-1)*E*((1.70158+1)*E+1.70158)+1)+S},BackEaseInOut(E,S,x,D){let k=1.70158;return(E/=D/2)<1?x/2*(E*E*(((k*=1.525)+1)*E-k))+S:x/2*((E-=2)*E*(((k*=1.525)+1)*E+k)+2)+S},ElasticEaseIn(E,S,x,D,k,R){let w=0;return E===0?S:(E/=D)===1?S+x:(R||(R=D*.3),!k||k<Math.abs(x)?(k=x,w=R/4):w=R/(2*Math.PI)*Math.asin(x/k),-(k*Math.pow(2,10*(E-=1))*Math.sin((E*D-w)*(2*Math.PI)/R))+S)},ElasticEaseOut(E,S,x,D,k,R){let w=0;return E===0?S:(E/=D)===1?S+x:(R||(R=D*.3),!k||k<Math.abs(x)?(k=x,w=R/4):w=R/(2*Math.PI)*Math.asin(x/k),k*Math.pow(2,-10*E)*Math.sin((E*D-w)*(2*Math.PI)/R)+x+S)},ElasticEaseInOut(E,S,x,D,k,R){let w=0;return E===0?S:(E/=D/2)===2?S+x:(R||(R=D*(.3*1.5)),!k||k<Math.abs(x)?(k=x,w=R/4):w=R/(2*Math.PI)*Math.asin(x/k),E<1?-.5*(k*Math.pow(2,10*(E-=1))*Math.sin((E*D-w)*(2*Math.PI)/R))+S:k*Math.pow(2,-10*(E-=1))*Math.sin((E*D-w)*(2*Math.PI)/R)*.5+x+S)},BounceEaseOut(E,S,x,D){return(E/=D)<1/2.75?x*(7.5625*E*E)+S:E<2/2.75?x*(7.5625*(E-=1.5/2.75)*E+.75)+S:E<2.5/2.75?x*(7.5625*(E-=2.25/2.75)*E+.9375)+S:x*(7.5625*(E-=2.625/2.75)*E+.984375)+S},BounceEaseIn(E,S,x,D){return x-n.Easings.BounceEaseOut(D-E,0,x,D)+S},BounceEaseInOut(E,S,x,D){return E<D/2?n.Easings.BounceEaseIn(E*2,0,x,D)*.5+S:n.Easings.BounceEaseOut(E*2-D,0,x,D)*.5+x*.5+S},EaseIn(E,S,x,D){return x*(E/=D)*E+S},EaseOut(E,S,x,D){return-x*(E/=D)*(E-2)+S},EaseInOut(E,S,x,D){return(E/=D/2)<1?x/2*E*E+S:-x/2*(--E*(E-2)-1)+S},StrongEaseIn(E,S,x,D){return x*(E/=D)*E*E*E*E+S},StrongEaseOut(E,S,x,D){return x*((E=E/D-1)*E*E*E*E+1)+S},StrongEaseInOut(E,S,x,D){return(E/=D/2)<1?x/2*E*E*E*E*E+S:x/2*((E-=2)*E*E*E*E+2)+S},Linear(E,S,x,D){return x*E/D+S}}})(VR);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Konva=void 0;const e=Oe,t=bt,r=kt,i=fl,s=OR,o=ef,u=r0,c=lc,d=t0,p=ln,m=uc,y=VR,E=Fs,S=Ri;n.Konva=t.Util._assign(e.Konva,{Util:t.Util,Transform:t.Transform,Node:r.Node,Container:i.Container,Stage:s.Stage,stages:s.stages,Layer:o.Layer,FastLayer:u.FastLayer,Group:c.Group,DD:d.DD,Shape:p.Shape,shapes:p.shapes,Animation:m.Animation,Tween:y.Tween,Easings:y.Easings,Context:E.Context,Canvas:S.Canvas}),n.default=n.Konva})(om);var i0={};Object.defineProperty(i0,"__esModule",{value:!0});i0.Arc=void 0;const s0=be,Iz=ln,tC=Oe,o0=Re,Pz=Oe;class Js extends Iz.Shape{_sceneFunc(e){const t=tC.Konva.getAngle(this.angle()),r=this.clockwise();e.beginPath(),e.arc(0,0,this.outerRadius(),0,t,r),e.arc(0,0,this.innerRadius(),t,0,!r),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}getSelfRect(){const e=this.innerRadius(),t=this.outerRadius(),r=this.clockwise(),i=tC.Konva.getAngle(r?360-this.angle():this.angle()),s=Math.cos(Math.min(i,Math.PI)),o=1,u=Math.sin(Math.min(Math.max(Math.PI,i),3*Math.PI/2)),c=Math.sin(Math.min(i,Math.PI/2)),d=s*(s>0?e:t),p=o*t,m=u*(u>0?e:t),y=c*(c>0?t:e);return{x:d,y:r?-1*y:m,width:p-d,height:y-m}}}i0.Arc=Js;Js.prototype._centroid=!0;Js.prototype.className="Arc";Js.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];(0,Pz._registerNode)(Js);s0.Factory.addGetterSetter(Js,"innerRadius",0,(0,o0.getNumberValidator)());s0.Factory.addGetterSetter(Js,"outerRadius",0,(0,o0.getNumberValidator)());s0.Factory.addGetterSetter(Js,"angle",0,(0,o0.getNumberValidator)());s0.Factory.addGetterSetter(Js,"clockwise",!1,(0,o0.getBooleanValidator)());var a0={},tf={};Object.defineProperty(tf,"__esModule",{value:!0});tf.Line=void 0;const l0=be,Rz=Oe,Az=ln,UR=Re;function kv(n,e,t,r,i,s,o){const u=Math.sqrt(Math.pow(t-n,2)+Math.pow(r-e,2)),c=Math.sqrt(Math.pow(i-t,2)+Math.pow(s-r,2)),d=o*u/(u+c),p=o*c/(u+c),m=t-d*(i-n),y=r-d*(s-e),E=t+p*(i-n),S=r+p*(s-e);return[m,y,E,S]}function nC(n,e){const t=n.length,r=[];for(let i=2;i<t-2;i+=2){const s=kv(n[i-2],n[i-1],n[i],n[i+1],n[i+2],n[i+3],e);isNaN(s[0])||(r.push(s[0]),r.push(s[1]),r.push(n[i]),r.push(n[i+1]),r.push(s[2]),r.push(s[3]))}return r}let sa=class extends Az.Shape{constructor(e){super(e),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(e){const t=this.points(),r=t.length,i=this.tension(),s=this.closed(),o=this.bezier();if(!r)return;let u=0;if(e.beginPath(),e.moveTo(t[0],t[1]),i!==0&&r>4){const c=this.getTensionPoints(),d=c.length;for(u=s?0:4,s||e.quadraticCurveTo(c[0],c[1],c[2],c[3]);u<d-2;)e.bezierCurveTo(c[u++],c[u++],c[u++],c[u++],c[u++],c[u++]);s||e.quadraticCurveTo(c[d-2],c[d-1],t[r-2],t[r-1])}else if(o)for(u=2;u<r;)e.bezierCurveTo(t[u++],t[u++],t[u++],t[u++],t[u++],t[u++]);else for(u=2;u<r;u+=2)e.lineTo(t[u],t[u+1]);s?(e.closePath(),e.fillStrokeShape(this)):e.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():nC(this.points(),this.tension())}_getTensionPointsClosed(){const e=this.points(),t=e.length,r=this.tension(),i=kv(e[t-2],e[t-1],e[0],e[1],e[2],e[3],r),s=kv(e[t-4],e[t-3],e[t-2],e[t-1],e[0],e[1],r),o=nC(e,r);return[i[2],i[3]].concat(o).concat([s[0],s[1],e[t-2],e[t-1],s[2],s[3],i[0],i[1],e[0],e[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let e=this.points();if(e.length<4)return{x:e[0]||0,y:e[1]||0,width:0,height:0};this.tension()!==0?e=[e[0],e[1],...this._getTensionPoints(),e[e.length-2],e[e.length-1]]:e=this.points();let t=e[0],r=e[0],i=e[1],s=e[1],o,u;for(let c=0;c<e.length/2;c++)o=e[c*2],u=e[c*2+1],t=Math.min(t,o),r=Math.max(r,o),i=Math.min(i,u),s=Math.max(s,u);return{x:t,y:i,width:r-t,height:s-i}}};tf.Line=sa;sa.prototype.className="Line";sa.prototype._attrsAffectingSize=["points","bezier","tension"];(0,Rz._registerNode)(sa);l0.Factory.addGetterSetter(sa,"closed",!1);l0.Factory.addGetterSetter(sa,"bezier",!1);l0.Factory.addGetterSetter(sa,"tension",0,(0,UR.getNumberValidator)());l0.Factory.addGetterSetter(sa,"points",[],(0,UR.getNumberArrayValidator)());var cc={},zR={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.t2length=n.getQuadraticArcLength=n.getCubicArcLength=n.binomialCoefficients=n.cValues=n.tValues=void 0,n.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],n.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],n.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(o,u,c)=>{let d,p;const y=c/2;d=0;for(let E=0;E<20;E++)p=y*n.tValues[20][E]+y,d+=n.cValues[20][E]*r(o,u,p);return y*d};n.getCubicArcLength=e;const t=(o,u,c)=>{c===void 0&&(c=1);const d=o[0]-2*o[1]+o[2],p=u[0]-2*u[1]+u[2],m=2*o[1]-2*o[0],y=2*u[1]-2*u[0],E=4*(d*d+p*p),S=4*(d*m+p*y),x=m*m+y*y;if(E===0)return c*Math.sqrt(Math.pow(o[2]-o[0],2)+Math.pow(u[2]-u[0],2));const D=S/(2*E),k=x/E,R=c+D,w=k-D*D,P=R*R+w>0?Math.sqrt(R*R+w):0,V=D*D+w>0?Math.sqrt(D*D+w):0,z=D+Math.sqrt(D*D+w)!==0?w*Math.log(Math.abs((R+P)/(D+V))):0;return Math.sqrt(E)/2*(R*P-D*V+z)};n.getQuadraticArcLength=t;function r(o,u,c){const d=i(1,c,o),p=i(1,c,u),m=d*d+p*p;return Math.sqrt(m)}const i=(o,u,c)=>{const d=c.length-1;let p,m;if(d===0)return 0;if(o===0){m=0;for(let y=0;y<=d;y++)m+=n.binomialCoefficients[d][y]*Math.pow(1-u,d-y)*Math.pow(u,y)*c[y];return m}else{p=new Array(d);for(let y=0;y<d;y++)p[y]=d*(c[y+1]-c[y]);return i(o-1,u,p)}},s=(o,u,c)=>{let d=1,p=o/u,m=(o-c(p))/u,y=0;for(;d>.001;){const E=c(p+m),S=Math.abs(o-E)/u;if(S<d)d=S,p+=m;else{const x=c(p-m),D=Math.abs(o-x)/u;D<d?(d=D,p-=m):m/=2}if(y++,y>500)break}return p};n.t2length=s})(zR);Object.defineProperty(cc,"__esModule",{value:!0});cc.Path=void 0;const kz=be,xz=Oe,Nz=ln,Kl=zR;class nn extends Nz.Shape{constructor(e){super(e),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=nn.parsePathData(this.data()),this.pathLength=nn.getPathLength(this.dataArray)}_sceneFunc(e){const t=this.dataArray;e.beginPath();let r=!1;for(let i=0;i<t.length;i++){const s=t[i].command,o=t[i].points;switch(s){case"L":e.lineTo(o[0],o[1]);break;case"M":e.moveTo(o[0],o[1]);break;case"C":e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]);break;case"Q":e.quadraticCurveTo(o[0],o[1],o[2],o[3]);break;case"A":const u=o[0],c=o[1],d=o[2],p=o[3],m=o[4],y=o[5],E=o[6],S=o[7],x=d>p?d:p,D=d>p?1:d/p,k=d>p?p/d:1;e.translate(u,c),e.rotate(E),e.scale(D,k),e.arc(0,0,x,m,m+y,1-S),e.scale(1/D,1/k),e.rotate(-E),e.translate(-u,-c);break;case"z":r=!0,e.closePath();break}}!r&&!this.hasFill()?e.strokeShape(this):e.fillStrokeShape(this)}getSelfRect(){let e=[];this.dataArray.forEach(function(c){if(c.command==="A"){const d=c.points[4],p=c.points[5],m=c.points[4]+p;let y=Math.PI/180;if(Math.abs(d-m)<y&&(y=Math.abs(d-m)),p<0)for(let E=d-y;E>m;E-=y){const S=nn.getPointOnEllipticalArc(c.points[0],c.points[1],c.points[2],c.points[3],E,0);e.push(S.x,S.y)}else for(let E=d+y;E<m;E+=y){const S=nn.getPointOnEllipticalArc(c.points[0],c.points[1],c.points[2],c.points[3],E,0);e.push(S.x,S.y)}}else if(c.command==="C")for(let d=0;d<=1;d+=.01){const p=nn.getPointOnCubicBezier(d,c.start.x,c.start.y,c.points[0],c.points[1],c.points[2],c.points[3],c.points[4],c.points[5]);e.push(p.x,p.y)}else e=e.concat(c.points)});let t=e[0],r=e[0],i=e[1],s=e[1],o,u;for(let c=0;c<e.length/2;c++)o=e[c*2],u=e[c*2+1],isNaN(o)||(t=Math.min(t,o),r=Math.max(r,o)),isNaN(u)||(i=Math.min(i,u),s=Math.max(s,u));return{x:t,y:i,width:r-t,height:s-i}}getLength(){return this.pathLength}getPointAtLength(e){return nn.getPointAtLengthOfDataArray(e,this.dataArray)}static getLineLength(e,t,r,i){return Math.sqrt((r-e)*(r-e)+(i-t)*(i-t))}static getPathLength(e){let t=0;for(let r=0;r<e.length;++r)t+=e[r].pathLength;return t}static getPointAtLengthOfDataArray(e,t){let r,i=0,s=t.length;if(!s)return null;for(;i<s&&e>t[i].pathLength;)e-=t[i].pathLength,++i;if(i===s)return r=t[i-1].points.slice(-2),{x:r[0],y:r[1]};if(e<.01)return t[i].command==="M"?(r=t[i].points.slice(0,2),{x:r[0],y:r[1]}):{x:t[i].start.x,y:t[i].start.y};const o=t[i],u=o.points;switch(o.command){case"L":return nn.getPointOnLine(e,o.start.x,o.start.y,u[0],u[1]);case"C":return nn.getPointOnCubicBezier((0,Kl.t2length)(e,nn.getPathLength(t),x=>(0,Kl.getCubicArcLength)([o.start.x,u[0],u[2],u[4]],[o.start.y,u[1],u[3],u[5]],x)),o.start.x,o.start.y,u[0],u[1],u[2],u[3],u[4],u[5]);case"Q":return nn.getPointOnQuadraticBezier((0,Kl.t2length)(e,nn.getPathLength(t),x=>(0,Kl.getQuadraticArcLength)([o.start.x,u[0],u[2]],[o.start.y,u[1],u[3]],x)),o.start.x,o.start.y,u[0],u[1],u[2],u[3]);case"A":const c=u[0],d=u[1],p=u[2],m=u[3],y=u[5],E=u[6];let S=u[4];return S+=y*e/o.pathLength,nn.getPointOnEllipticalArc(c,d,p,m,S,E)}return null}static getPointOnLine(e,t,r,i,s,o,u){o=o??t,u=u??r;const c=this.getLineLength(t,r,i,s);if(c<1e-10)return{x:t,y:r};if(i===t)return{x:o,y:u+(s>r?e:-e)};const d=(s-r)/(i-t),p=Math.sqrt(e*e/(1+d*d))*(i<t?-1:1),m=d*p;if(Math.abs(u-r-d*(o-t))<1e-10)return{x:o+p,y:u+m};const y=((o-t)*(i-t)+(u-r)*(s-r))/(c*c),E=t+y*(i-t),S=r+y*(s-r),x=this.getLineLength(o,u,E,S),D=Math.sqrt(e*e-x*x),k=Math.sqrt(D*D/(1+d*d))*(i<t?-1:1),R=d*k;return{x:E+k,y:S+R}}static getPointOnCubicBezier(e,t,r,i,s,o,u,c,d){function p(D){return D*D*D}function m(D){return 3*D*D*(1-D)}function y(D){return 3*D*(1-D)*(1-D)}function E(D){return(1-D)*(1-D)*(1-D)}const S=c*p(e)+o*m(e)+i*y(e)+t*E(e),x=d*p(e)+u*m(e)+s*y(e)+r*E(e);return{x:S,y:x}}static getPointOnQuadraticBezier(e,t,r,i,s,o,u){function c(E){return E*E}function d(E){return 2*E*(1-E)}function p(E){return(1-E)*(1-E)}const m=o*c(e)+i*d(e)+t*p(e),y=u*c(e)+s*d(e)+r*p(e);return{x:m,y}}static getPointOnEllipticalArc(e,t,r,i,s,o){const u=Math.cos(o),c=Math.sin(o),d={x:r*Math.cos(s),y:i*Math.sin(s)};return{x:e+(d.x*u-d.y*c),y:t+(d.x*c+d.y*u)}}static parsePathData(e){if(!e)return[];let t=e;const r=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];t=t.replace(new RegExp(" ","g"),",");for(let m=0;m<r.length;m++)t=t.replace(new RegExp(r[m],"g"),"|"+r[m]);const i=t.split("|"),s=[],o=[];let u=0,c=0;const d=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let p;for(let m=1;m<i.length;m++){let y=i[m],E=y.charAt(0);for(y=y.slice(1),o.length=0;p=d.exec(y);)o.push(p[0]);const S=[];for(let x=0,D=o.length;x<D;x++){if(o[x]==="00"){S.push(0,0);continue}const k=parseFloat(o[x]);isNaN(k)?S.push(0):S.push(k)}for(;S.length>0&&!isNaN(S[0]);){let x="",D=[];const k=u,R=c;let w,P,V,z,M,C,N,A,L,U;switch(E){case"l":u+=S.shift(),c+=S.shift(),x="L",D.push(u,c);break;case"L":u=S.shift(),c=S.shift(),D.push(u,c);break;case"m":const F=S.shift(),pe=S.shift();if(u+=F,c+=pe,x="M",s.length>2&&s[s.length-1].command==="z"){for(let Y=s.length-2;Y>=0;Y--)if(s[Y].command==="M"){u=s[Y].points[0]+F,c=s[Y].points[1]+pe;break}}D.push(u,c),E="l";break;case"M":u=S.shift(),c=S.shift(),x="M",D.push(u,c),E="L";break;case"h":u+=S.shift(),x="L",D.push(u,c);break;case"H":u=S.shift(),x="L",D.push(u,c);break;case"v":c+=S.shift(),x="L",D.push(u,c);break;case"V":c=S.shift(),x="L",D.push(u,c);break;case"C":D.push(S.shift(),S.shift(),S.shift(),S.shift()),u=S.shift(),c=S.shift(),D.push(u,c);break;case"c":D.push(u+S.shift(),c+S.shift(),u+S.shift(),c+S.shift()),u+=S.shift(),c+=S.shift(),x="C",D.push(u,c);break;case"S":P=u,V=c,w=s[s.length-1],w.command==="C"&&(P=u+(u-w.points[2]),V=c+(c-w.points[3])),D.push(P,V,S.shift(),S.shift()),u=S.shift(),c=S.shift(),x="C",D.push(u,c);break;case"s":P=u,V=c,w=s[s.length-1],w.command==="C"&&(P=u+(u-w.points[2]),V=c+(c-w.points[3])),D.push(P,V,u+S.shift(),c+S.shift()),u+=S.shift(),c+=S.shift(),x="C",D.push(u,c);break;case"Q":D.push(S.shift(),S.shift()),u=S.shift(),c=S.shift(),D.push(u,c);break;case"q":D.push(u+S.shift(),c+S.shift()),u+=S.shift(),c+=S.shift(),x="Q",D.push(u,c);break;case"T":P=u,V=c,w=s[s.length-1],w.command==="Q"&&(P=u+(u-w.points[0]),V=c+(c-w.points[1])),u=S.shift(),c=S.shift(),x="Q",D.push(P,V,u,c);break;case"t":P=u,V=c,w=s[s.length-1],w.command==="Q"&&(P=u+(u-w.points[0]),V=c+(c-w.points[1])),u+=S.shift(),c+=S.shift(),x="Q",D.push(P,V,u,c);break;case"A":z=S.shift(),M=S.shift(),C=S.shift(),N=S.shift(),A=S.shift(),L=u,U=c,u=S.shift(),c=S.shift(),x="A",D=this.convertEndpointToCenterParameterization(L,U,u,c,N,A,z,M,C);break;case"a":z=S.shift(),M=S.shift(),C=S.shift(),N=S.shift(),A=S.shift(),L=u,U=c,u+=S.shift(),c+=S.shift(),x="A",D=this.convertEndpointToCenterParameterization(L,U,u,c,N,A,z,M,C);break}s.push({command:x||E,points:D,start:{x:k,y:R},pathLength:this.calcLength(k,R,x||E,D)})}(E==="z"||E==="Z")&&s.push({command:"z",points:[],start:void 0,pathLength:0})}return s}static calcLength(e,t,r,i){let s,o,u,c;const d=nn;switch(r){case"L":return d.getLineLength(e,t,i[0],i[1]);case"C":return(0,Kl.getCubicArcLength)([e,i[0],i[2],i[4]],[t,i[1],i[3],i[5]],1);case"Q":return(0,Kl.getQuadraticArcLength)([e,i[0],i[2]],[t,i[1],i[3]],1);case"A":s=0;const p=i[4],m=i[5],y=i[4]+m;let E=Math.PI/180;if(Math.abs(p-y)<E&&(E=Math.abs(p-y)),o=d.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],p,0),m<0)for(c=p-E;c>y;c-=E)u=d.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],c,0),s+=d.getLineLength(o.x,o.y,u.x,u.y),o=u;else for(c=p+E;c<y;c+=E)u=d.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],c,0),s+=d.getLineLength(o.x,o.y,u.x,u.y),o=u;return u=d.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],y,0),s+=d.getLineLength(o.x,o.y,u.x,u.y),s}return 0}static convertEndpointToCenterParameterization(e,t,r,i,s,o,u,c,d){const p=d*(Math.PI/180),m=Math.cos(p)*(e-r)/2+Math.sin(p)*(t-i)/2,y=-1*Math.sin(p)*(e-r)/2+Math.cos(p)*(t-i)/2,E=m*m/(u*u)+y*y/(c*c);E>1&&(u*=Math.sqrt(E),c*=Math.sqrt(E));let S=Math.sqrt((u*u*(c*c)-u*u*(y*y)-c*c*(m*m))/(u*u*(y*y)+c*c*(m*m)));s===o&&(S*=-1),isNaN(S)&&(S=0);const x=S*u*y/c,D=S*-c*m/u,k=(e+r)/2+Math.cos(p)*x-Math.sin(p)*D,R=(t+i)/2+Math.sin(p)*x+Math.cos(p)*D,w=function(A){return Math.sqrt(A[0]*A[0]+A[1]*A[1])},P=function(A,L){return(A[0]*L[0]+A[1]*L[1])/(w(A)*w(L))},V=function(A,L){return(A[0]*L[1]<A[1]*L[0]?-1:1)*Math.acos(P(A,L))},z=V([1,0],[(m-x)/u,(y-D)/c]),M=[(m-x)/u,(y-D)/c],C=[(-1*m-x)/u,(-1*y-D)/c];let N=V(M,C);return P(M,C)<=-1&&(N=Math.PI),P(M,C)>=1&&(N=0),o===0&&N>0&&(N=N-2*Math.PI),o===1&&N<0&&(N=N+2*Math.PI),[k,R,u,c,z,N,p,o]}}cc.Path=nn;nn.prototype.className="Path";nn.prototype._attrsAffectingSize=["data"];(0,xz._registerNode)(nn);kz.Factory.addGetterSetter(nn,"data");Object.defineProperty(a0,"__esModule",{value:!0});a0.Arrow=void 0;const u0=be,Dz=tf,BR=Re,Mz=Oe,rC=cc;class gl extends Dz.Line{_sceneFunc(e){super._sceneFunc(e);const t=Math.PI*2,r=this.points();let i=r;const s=this.tension()!==0&&r.length>4;s&&(i=this.getTensionPoints());const o=this.pointerLength(),u=r.length;let c,d;if(s){const y=[i[i.length-4],i[i.length-3],i[i.length-2],i[i.length-1],r[u-2],r[u-1]],E=rC.Path.calcLength(i[i.length-4],i[i.length-3],"C",y),S=rC.Path.getPointOnQuadraticBezier(Math.min(1,1-o/E),y[0],y[1],y[2],y[3],y[4],y[5]);c=r[u-2]-S.x,d=r[u-1]-S.y}else c=r[u-2]-r[u-4],d=r[u-1]-r[u-3];const p=(Math.atan2(d,c)+t)%t,m=this.pointerWidth();this.pointerAtEnding()&&(e.save(),e.beginPath(),e.translate(r[u-2],r[u-1]),e.rotate(p),e.moveTo(0,0),e.lineTo(-o,m/2),e.lineTo(-o,-m/2),e.closePath(),e.restore(),this.__fillStroke(e)),this.pointerAtBeginning()&&(e.save(),e.beginPath(),e.translate(r[0],r[1]),s?(c=(i[0]+i[2])/2-r[0],d=(i[1]+i[3])/2-r[1]):(c=r[2]-r[0],d=r[3]-r[1]),e.rotate((Math.atan2(-d,-c)+t)%t),e.moveTo(0,0),e.lineTo(-o,m/2),e.lineTo(-o,-m/2),e.closePath(),e.restore(),this.__fillStroke(e))}__fillStroke(e){const t=this.dashEnabled();t&&(this.attrs.dashEnabled=!1,e.setLineDash([])),e.fillStrokeShape(this),t&&(this.attrs.dashEnabled=!0)}getSelfRect(){const e=super.getSelfRect(),t=this.pointerWidth()/2;return{x:e.x,y:e.y-t,width:e.width,height:e.height+t*2}}}a0.Arrow=gl;gl.prototype.className="Arrow";(0,Mz._registerNode)(gl);u0.Factory.addGetterSetter(gl,"pointerLength",10,(0,BR.getNumberValidator)());u0.Factory.addGetterSetter(gl,"pointerWidth",10,(0,BR.getNumberValidator)());u0.Factory.addGetterSetter(gl,"pointerAtBeginning",!1);u0.Factory.addGetterSetter(gl,"pointerAtEnding",!0);var c0={};Object.defineProperty(c0,"__esModule",{value:!0});c0.Circle=void 0;const Oz=be,Lz=ln,bz=Re,Fz=Oe;class hc extends Lz.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius()!==e/2&&this.radius(e/2)}setHeight(e){this.radius()!==e/2&&this.radius(e/2)}}c0.Circle=hc;hc.prototype._centroid=!0;hc.prototype.className="Circle";hc.prototype._attrsAffectingSize=["radius"];(0,Fz._registerNode)(hc);Oz.Factory.addGetterSetter(hc,"radius",0,(0,bz.getNumberValidator)());var h0={};Object.defineProperty(h0,"__esModule",{value:!0});h0.Ellipse=void 0;const aS=be,Vz=ln,GR=Re,Uz=Oe;class oa extends Vz.Shape{_sceneFunc(e){const t=this.radiusX(),r=this.radiusY();e.beginPath(),e.save(),t!==r&&e.scale(1,r/t),e.arc(0,0,t,0,Math.PI*2,!1),e.restore(),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(e){this.radiusX(e/2)}setHeight(e){this.radiusY(e/2)}}h0.Ellipse=oa;oa.prototype.className="Ellipse";oa.prototype._centroid=!0;oa.prototype._attrsAffectingSize=["radiusX","radiusY"];(0,Uz._registerNode)(oa);aS.Factory.addComponentsGetterSetter(oa,"radius",["x","y"]);aS.Factory.addGetterSetter(oa,"radiusX",0,(0,GR.getNumberValidator)());aS.Factory.addGetterSetter(oa,"radiusY",0,(0,GR.getNumberValidator)());var d0={};Object.defineProperty(d0,"__esModule",{value:!0});d0.Image=void 0;const zy=bt,ml=be,zz=ln,Bz=Oe,nf=Re;let rs=class jR extends zz.Shape{constructor(e){super(e),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",t=>{this._removeImageLoad(t.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const e=this.image();e&&e.complete||e&&e.readyState===4||e&&e.addEventListener&&e.addEventListener("load",this._loadListener)}_removeImageLoad(e){e&&e.removeEventListener&&e.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const e=!!this.cornerRadius(),t=this.hasShadow();return e&&t?!0:super._useBufferCanvas(!0)}_sceneFunc(e){const t=this.getWidth(),r=this.getHeight(),i=this.cornerRadius(),s=this.attrs.image;let o;if(s){const u=this.attrs.cropWidth,c=this.attrs.cropHeight;u&&c?o=[s,this.cropX(),this.cropY(),u,c,0,0,t,r]:o=[s,0,0,t,r]}(this.hasFill()||this.hasStroke()||i)&&(e.beginPath(),i?zy.Util.drawRoundedRectPath(e,t,r,i):e.rect(0,0,t,r),e.closePath(),e.fillStrokeShape(this)),s&&(i&&e.clip(),e.drawImage.apply(e,o))}_hitFunc(e){const t=this.width(),r=this.height(),i=this.cornerRadius();e.beginPath(),i?zy.Util.drawRoundedRectPath(e,t,r,i):e.rect(0,0,t,r),e.closePath(),e.fillStrokeShape(this)}getWidth(){var e,t;return(e=this.attrs.width)!==null&&e!==void 0?e:(t=this.image())===null||t===void 0?void 0:t.width}getHeight(){var e,t;return(e=this.attrs.height)!==null&&e!==void 0?e:(t=this.image())===null||t===void 0?void 0:t.height}static fromURL(e,t,r=null){const i=zy.Util.createImageElement();i.onload=function(){const s=new jR({image:i});t(s)},i.onerror=r,i.crossOrigin="Anonymous",i.src=e}};d0.Image=rs;rs.prototype.className="Image";(0,Bz._registerNode)(rs);ml.Factory.addGetterSetter(rs,"cornerRadius",0,(0,nf.getNumberOrArrayOfNumbersValidator)(4));ml.Factory.addGetterSetter(rs,"image");ml.Factory.addComponentsGetterSetter(rs,"crop",["x","y","width","height"]);ml.Factory.addGetterSetter(rs,"cropX",0,(0,nf.getNumberValidator)());ml.Factory.addGetterSetter(rs,"cropY",0,(0,nf.getNumberValidator)());ml.Factory.addGetterSetter(rs,"cropWidth",0,(0,nf.getNumberValidator)());ml.Factory.addGetterSetter(rs,"cropHeight",0,(0,nf.getNumberValidator)());var ju={};Object.defineProperty(ju,"__esModule",{value:!0});ju.Tag=ju.Label=void 0;const f0=be,Gz=ln,jz=lc,lS=Re,WR=Oe,HR=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],Wz="Change.konva",Hz="none",xv="up",Nv="right",Dv="down",Mv="left",$z=HR.length;class uS extends jz.Group{constructor(e){super(e),this.on("add.konva",function(t){this._addListeners(t.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(e){let t=this,r;const i=function(){t._sync()};for(r=0;r<$z;r++)e.on(HR[r]+Wz,i)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let e=this.getText(),t=this.getTag(),r,i,s,o,u,c,d;if(e&&t){switch(r=e.width(),i=e.height(),s=t.pointerDirection(),o=t.pointerWidth(),d=t.pointerHeight(),u=0,c=0,s){case xv:u=r/2,c=-1*d;break;case Nv:u=r+o,c=i/2;break;case Dv:u=r/2,c=i+d;break;case Mv:u=-1*o,c=i/2;break}t.setAttrs({x:-1*u,y:-1*c,width:r,height:i}),e.setAttrs({x:-1*u,y:-1*c})}}}ju.Label=uS;uS.prototype.className="Label";(0,WR._registerNode)(uS);class _l extends Gz.Shape{_sceneFunc(e){const t=this.width(),r=this.height(),i=this.pointerDirection(),s=this.pointerWidth(),o=this.pointerHeight(),u=this.cornerRadius();let c=0,d=0,p=0,m=0;typeof u=="number"?c=d=p=m=Math.min(u,t/2,r/2):(c=Math.min(u[0]||0,t/2,r/2),d=Math.min(u[1]||0,t/2,r/2),m=Math.min(u[2]||0,t/2,r/2),p=Math.min(u[3]||0,t/2,r/2)),e.beginPath(),e.moveTo(c,0),i===xv&&(e.lineTo((t-s)/2,0),e.lineTo(t/2,-1*o),e.lineTo((t+s)/2,0)),e.lineTo(t-d,0),e.arc(t-d,d,d,Math.PI*3/2,0,!1),i===Nv&&(e.lineTo(t,(r-o)/2),e.lineTo(t+s,r/2),e.lineTo(t,(r+o)/2)),e.lineTo(t,r-m),e.arc(t-m,r-m,m,0,Math.PI/2,!1),i===Dv&&(e.lineTo((t+s)/2,r),e.lineTo(t/2,r+o),e.lineTo((t-s)/2,r)),e.lineTo(p,r),e.arc(p,r-p,p,Math.PI/2,Math.PI,!1),i===Mv&&(e.lineTo(0,(r+o)/2),e.lineTo(-1*s,r/2),e.lineTo(0,(r-o)/2)),e.lineTo(0,c),e.arc(c,c,c,Math.PI,Math.PI*3/2,!1),e.closePath(),e.fillStrokeShape(this)}getSelfRect(){let e=0,t=0,r=this.pointerWidth(),i=this.pointerHeight(),s=this.pointerDirection(),o=this.width(),u=this.height();return s===xv?(t-=i,u+=i):s===Dv?u+=i:s===Mv?(e-=r*1.5,o+=r):s===Nv&&(o+=r*1.5),{x:e,y:t,width:o,height:u}}}ju.Tag=_l;_l.prototype.className="Tag";(0,WR._registerNode)(_l);f0.Factory.addGetterSetter(_l,"pointerDirection",Hz);f0.Factory.addGetterSetter(_l,"pointerWidth",0,(0,lS.getNumberValidator)());f0.Factory.addGetterSetter(_l,"pointerHeight",0,(0,lS.getNumberValidator)());f0.Factory.addGetterSetter(_l,"cornerRadius",0,(0,lS.getNumberOrArrayOfNumbersValidator)(4));var rf={};Object.defineProperty(rf,"__esModule",{value:!0});rf.Rect=void 0;const qz=be,Kz=ln,Qz=Oe,Yz=bt,Xz=Re;let p0=class extends Kz.Shape{_sceneFunc(e){const t=this.cornerRadius(),r=this.width(),i=this.height();e.beginPath(),t?Yz.Util.drawRoundedRectPath(e,r,i,t):e.rect(0,0,r,i),e.closePath(),e.fillStrokeShape(this)}};rf.Rect=p0;p0.prototype.className="Rect";(0,Qz._registerNode)(p0);qz.Factory.addGetterSetter(p0,"cornerRadius",0,(0,Xz.getNumberOrArrayOfNumbersValidator)(4));var g0={};Object.defineProperty(g0,"__esModule",{value:!0});g0.RegularPolygon=void 0;const $R=be,Jz=ln,qR=Re,Zz=Oe;class yl extends Jz.Shape{_sceneFunc(e){const t=this._getPoints();e.beginPath(),e.moveTo(t[0].x,t[0].y);for(let r=1;r<t.length;r++)e.lineTo(t[r].x,t[r].y);e.closePath(),e.fillStrokeShape(this)}_getPoints(){const e=this.attrs.sides,t=this.attrs.radius||0,r=[];for(let i=0;i<e;i++)r.push({x:t*Math.sin(i*2*Math.PI/e),y:-1*t*Math.cos(i*2*Math.PI/e)});return r}getSelfRect(){const e=this._getPoints();let t=e[0].x,r=e[0].y,i=e[0].x,s=e[0].y;return e.forEach(o=>{t=Math.min(t,o.x),r=Math.max(r,o.x),i=Math.min(i,o.y),s=Math.max(s,o.y)}),{x:t,y:i,width:r-t,height:s-i}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}g0.RegularPolygon=yl;yl.prototype.className="RegularPolygon";yl.prototype._centroid=!0;yl.prototype._attrsAffectingSize=["radius"];(0,Zz._registerNode)(yl);$R.Factory.addGetterSetter(yl,"radius",0,(0,qR.getNumberValidator)());$R.Factory.addGetterSetter(yl,"sides",0,(0,qR.getNumberValidator)());var m0={};Object.defineProperty(m0,"__esModule",{value:!0});m0.Ring=void 0;const KR=be,eB=ln,QR=Re,tB=Oe,iC=Math.PI*2;class vl extends eB.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.innerRadius(),0,iC,!1),e.moveTo(this.outerRadius(),0),e.arc(0,0,this.outerRadius(),iC,0,!0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}m0.Ring=vl;vl.prototype.className="Ring";vl.prototype._centroid=!0;vl.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,tB._registerNode)(vl);KR.Factory.addGetterSetter(vl,"innerRadius",0,(0,QR.getNumberValidator)());KR.Factory.addGetterSetter(vl,"outerRadius",0,(0,QR.getNumberValidator)());var _0={};Object.defineProperty(_0,"__esModule",{value:!0});_0.Sprite=void 0;const wl=be,nB=ln,rB=uc,YR=Re,iB=Oe;class is extends nB.Shape{constructor(e){super(e),this._updated=!0,this.anim=new rB.Animation(()=>{const t=this._updated;return this._updated=!1,t}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(e){const t=this.animation(),r=this.frameIndex(),i=r*4,s=this.animations()[t],o=this.frameOffsets(),u=s[i+0],c=s[i+1],d=s[i+2],p=s[i+3],m=this.image();if((this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,d,p),e.closePath(),e.fillStrokeShape(this)),m)if(o){const y=o[t],E=r*2;e.drawImage(m,u,c,d,p,y[E+0],y[E+1],d,p)}else e.drawImage(m,u,c,d,p,0,0,d,p)}_hitFunc(e){const t=this.animation(),r=this.frameIndex(),i=r*4,s=this.animations()[t],o=this.frameOffsets(),u=s[i+2],c=s[i+3];if(e.beginPath(),o){const d=o[t],p=r*2;e.rect(d[p+0],d[p+1],u,c)}else e.rect(0,0,u,c);e.closePath(),e.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const e=this;this.interval=setInterval(function(){e._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const e=this.getLayer();this.anim.setLayers(e),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const e=this.frameIndex(),t=this.animation(),r=this.animations(),i=r[t],s=i.length/4;e<s-1?this.frameIndex(e+1):this.frameIndex(0)}}_0.Sprite=is;is.prototype.className="Sprite";(0,iB._registerNode)(is);wl.Factory.addGetterSetter(is,"animation");wl.Factory.addGetterSetter(is,"animations");wl.Factory.addGetterSetter(is,"frameOffsets");wl.Factory.addGetterSetter(is,"image");wl.Factory.addGetterSetter(is,"frameIndex",0,(0,YR.getNumberValidator)());wl.Factory.addGetterSetter(is,"frameRate",17,(0,YR.getNumberValidator)());wl.Factory.backCompat(is,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var y0={};Object.defineProperty(y0,"__esModule",{value:!0});y0.Star=void 0;const cS=be,sB=ln,hS=Re,oB=Oe;class aa extends sB.Shape{_sceneFunc(e){const t=this.innerRadius(),r=this.outerRadius(),i=this.numPoints();e.beginPath(),e.moveTo(0,0-r);for(let s=1;s<i*2;s++){const o=s%2===0?r:t,u=o*Math.sin(s*Math.PI/i),c=-1*o*Math.cos(s*Math.PI/i);e.lineTo(u,c)}e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}y0.Star=aa;aa.prototype.className="Star";aa.prototype._centroid=!0;aa.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,oB._registerNode)(aa);cS.Factory.addGetterSetter(aa,"numPoints",5,(0,hS.getNumberValidator)());cS.Factory.addGetterSetter(aa,"innerRadius",0,(0,hS.getNumberValidator)());cS.Factory.addGetterSetter(aa,"outerRadius",0,(0,hS.getNumberValidator)());var dc={};Object.defineProperty(dc,"__esModule",{value:!0});dc.Text=void 0;dc.stringToArray=Ma;const Ov=bt,rr=be,aB=ln,By=Oe,la=Re,lB=Oe;function Ma(n){return[...n].reduce((e,t,r,i)=>{if(new RegExp("\\p{Emoji}","u").test(t)){const s=i[r+1];s&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(s)?(e.push(t+s),i[r+1]=""):e.push(t)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(t+(i[r+1]||""))?e.push(t+i[r+1]):r>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(t)?e[e.length-1]+=t:t&&e.push(t);return e},[])}const Ql="auto",uB="center",XR="inherit",lh="justify",cB="Change.konva",hB="2d",sC="-",JR="left",dB="text",fB="Text",pB="top",gB="bottom",oC="middle",ZR="normal",mB="px ",Lp=" ",_B="right",aC="rtl",yB="word",vB="char",lC="none",Gy="",e8=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],wB=e8.length;function SB(n){return n.split(",").map(e=>{e=e.trim();const t=e.indexOf(" ")>=0,r=e.indexOf('"')>=0||e.indexOf("'")>=0;return t&&!r&&(e=`"${e}"`),e}).join(", ")}let bp;function jy(){return bp||(bp=Ov.Util.createCanvasElement().getContext(hB),bp)}function EB(n){n.fillText(this._partialText,this._partialTextX,this._partialTextY)}function TB(n){n.setAttr("miterLimit",2),n.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function CB(n){return n=n||{},!n.fillLinearGradientColorStops&&!n.fillRadialGradientColorStops&&!n.fillPatternImage&&(n.fill=n.fill||"black"),n}let Ut=class extends aB.Shape{constructor(e){super(CB(e)),this._partialTextX=0,this._partialTextY=0;for(let t=0;t<wB;t++)this.on(e8[t]+cB,this._setTextData);this._setTextData()}_sceneFunc(e){const t=this.textArr,r=t.length;if(!this.text())return;let i=this.padding(),s=this.fontSize(),o=this.lineHeight()*s,u=this.verticalAlign(),c=this.direction(),d=0,p=this.align(),m=this.getWidth(),y=this.letterSpacing(),E=this.fill(),S=this.textDecoration(),x=S.indexOf("underline")!==-1,D=S.indexOf("line-through")!==-1,k;c=c===XR?e.direction:c;let R=o/2,w=oC;if(By.Konva._fixTextRendering){const P=this.measureSize("M");w="alphabetic",R=(P.fontBoundingBoxAscent-P.fontBoundingBoxDescent)/2+o/2}for(c===aC&&e.setAttr("direction",c),e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",w),e.setAttr("textAlign",JR),u===oC?d=(this.getHeight()-r*o-i*2)/2:u===gB&&(d=this.getHeight()-r*o-i*2),e.translate(i,d+i),k=0;k<r;k++){let P=0,V=0;const z=t[k],M=z.text,C=z.width,N=z.lastInParagraph;if(e.save(),p===_B?P+=m-C-i*2:p===uB&&(P+=(m-C-i*2)/2),x){e.save(),e.beginPath();const A=By.Konva._fixTextRendering?Math.round(s/4):Math.round(s/2),L=P,U=R+V+A;e.moveTo(L,U);const F=p===lh&&!N?m-i*2:C;e.lineTo(L+Math.round(F),U),e.lineWidth=s/15;const pe=this._getLinearGradient();e.strokeStyle=pe||E,e.stroke(),e.restore()}if(D){e.save(),e.beginPath();const A=By.Konva._fixTextRendering?-Math.round(s/4):0;e.moveTo(P,R+V+A);const L=p===lh&&!N?m-i*2:C;e.lineTo(P+Math.round(L),R+V+A),e.lineWidth=s/15;const U=this._getLinearGradient();e.strokeStyle=U||E,e.stroke(),e.restore()}if(c!==aC&&(y!==0||p===lh)){const A=M.split(" ").length-1,L=Ma(M);for(let U=0;U<L.length;U++){const F=L[U];F===" "&&!N&&p===lh&&(P+=(m-i*2-C)/A),this._partialTextX=P,this._partialTextY=R+V,this._partialText=F,e.fillStrokeShape(this),P+=this.measureSize(F).width+y}}else y!==0&&e.setAttr("letterSpacing",`${y}px`),this._partialTextX=P,this._partialTextY=R+V,this._partialText=M,e.fillStrokeShape(this);e.restore(),r>1&&(R+=o)}}_hitFunc(e){const t=this.getWidth(),r=this.getHeight();e.beginPath(),e.rect(0,0,t,r),e.closePath(),e.fillStrokeShape(this)}setText(e){const t=Ov.Util._isString(e)?e:e==null?"":e+"";return this._setAttr(dB,t),this}getWidth(){return this.attrs.width===Ql||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===Ql||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return Ov.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(e){var t,r,i,s,o,u,c,d,p,m,y;let E=jy(),S=this.fontSize(),x;E.save(),E.font=this._getContextFont(),x=E.measureText(e),E.restore();const D=S/100;return{actualBoundingBoxAscent:(t=x.actualBoundingBoxAscent)!==null&&t!==void 0?t:71.58203125*D,actualBoundingBoxDescent:(r=x.actualBoundingBoxDescent)!==null&&r!==void 0?r:0,actualBoundingBoxLeft:(i=x.actualBoundingBoxLeft)!==null&&i!==void 0?i:-7.421875*D,actualBoundingBoxRight:(s=x.actualBoundingBoxRight)!==null&&s!==void 0?s:75.732421875*D,alphabeticBaseline:(o=x.alphabeticBaseline)!==null&&o!==void 0?o:0,emHeightAscent:(u=x.emHeightAscent)!==null&&u!==void 0?u:100*D,emHeightDescent:(c=x.emHeightDescent)!==null&&c!==void 0?c:-20*D,fontBoundingBoxAscent:(d=x.fontBoundingBoxAscent)!==null&&d!==void 0?d:91*D,fontBoundingBoxDescent:(p=x.fontBoundingBoxDescent)!==null&&p!==void 0?p:21*D,hangingBaseline:(m=x.hangingBaseline)!==null&&m!==void 0?m:72.80000305175781*D,ideographicBaseline:(y=x.ideographicBaseline)!==null&&y!==void 0?y:-21*D,width:x.width,height:S}}_getContextFont(){return this.fontStyle()+Lp+this.fontVariant()+Lp+(this.fontSize()+mB)+SB(this.fontFamily())}_addTextLine(e){this.align()===lh&&(e=e.trim());const r=this._getTextWidth(e);return this.textArr.push({text:e,width:r,lastInParagraph:!1})}_getTextWidth(e){const t=this.letterSpacing(),r=e.length;return jy().measureText(e).width+t*r}_setTextData(){let e=this.text().split(`
`),t=+this.fontSize(),r=0,i=this.lineHeight()*t,s=this.attrs.width,o=this.attrs.height,u=s!==Ql&&s!==void 0,c=o!==Ql&&o!==void 0,d=this.padding(),p=s-d*2,m=o-d*2,y=0,E=this.wrap(),S=E!==lC,x=E!==vB&&S,D=this.ellipsis();this.textArr=[],jy().font=this._getContextFont();const k=D?this._getTextWidth(Gy):0;for(let R=0,w=e.length;R<w;++R){let P=e[R],V=this._getTextWidth(P);if(u&&V>p)for(;P.length>0;){let z=0,M=Ma(P).length,C="",N=0;for(;z<M;){const A=z+M>>>1,L=Ma(P),U=L.slice(0,A+1).join(""),F=this._getTextWidth(U);(D&&c&&y+i>m?F+k:F)<=p?(z=A+1,C=U,N=F):M=A}if(C){if(x){const U=Ma(P),F=Ma(C),pe=U[F.length],Y=pe===Lp||pe===sC;let he;if(Y&&N<=p)he=F.length;else{const ue=F.lastIndexOf(Lp),H=F.lastIndexOf(sC);he=Math.max(ue,H)+1}he>0&&(z=he,C=U.slice(0,z).join(""),N=this._getTextWidth(C))}if(C=C.trimRight(),this._addTextLine(C),r=Math.max(r,N),y+=i,this._shouldHandleEllipsis(y)){this._tryToAddEllipsisToLastLine();break}if(P=Ma(P).slice(z).join("").trimLeft(),P.length>0&&(V=this._getTextWidth(P),V<=p)){this._addTextLine(P),y+=i,r=Math.max(r,V);break}}else break}else this._addTextLine(P),y+=i,r=Math.max(r,V),this._shouldHandleEllipsis(y)&&R<w-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),c&&y+i>m)break}this.textHeight=t,this.textWidth=r}_shouldHandleEllipsis(e){const t=+this.fontSize(),r=this.lineHeight()*t,i=this.attrs.height,s=i!==Ql&&i!==void 0,o=this.padding(),u=i-o*2;return!(this.wrap()!==lC)||s&&e+r>u}_tryToAddEllipsisToLastLine(){const e=this.attrs.width,t=e!==Ql&&e!==void 0,r=this.padding(),i=e-r*2,s=this.ellipsis(),o=this.textArr[this.textArr.length-1];!o||!s||(t&&(this._getTextWidth(o.text+Gy)<i||(o.text=o.text.slice(0,o.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(o.text+Gy))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const e=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,t=this.hasShadow();return e&&t?!0:super._useBufferCanvas()}};dc.Text=Ut;Ut.prototype._fillFunc=EB;Ut.prototype._strokeFunc=TB;Ut.prototype.className=fB;Ut.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];(0,lB._registerNode)(Ut);rr.Factory.overWriteSetter(Ut,"width",(0,la.getNumberOrAutoValidator)());rr.Factory.overWriteSetter(Ut,"height",(0,la.getNumberOrAutoValidator)());rr.Factory.addGetterSetter(Ut,"direction",XR);rr.Factory.addGetterSetter(Ut,"fontFamily","Arial");rr.Factory.addGetterSetter(Ut,"fontSize",12,(0,la.getNumberValidator)());rr.Factory.addGetterSetter(Ut,"fontStyle",ZR);rr.Factory.addGetterSetter(Ut,"fontVariant",ZR);rr.Factory.addGetterSetter(Ut,"padding",0,(0,la.getNumberValidator)());rr.Factory.addGetterSetter(Ut,"align",JR);rr.Factory.addGetterSetter(Ut,"verticalAlign",pB);rr.Factory.addGetterSetter(Ut,"lineHeight",1,(0,la.getNumberValidator)());rr.Factory.addGetterSetter(Ut,"wrap",yB);rr.Factory.addGetterSetter(Ut,"ellipsis",!1,(0,la.getBooleanValidator)());rr.Factory.addGetterSetter(Ut,"letterSpacing",0,(0,la.getNumberValidator)());rr.Factory.addGetterSetter(Ut,"text","",(0,la.getStringValidator)());rr.Factory.addGetterSetter(Ut,"textDecoration","");var v0={};Object.defineProperty(v0,"__esModule",{value:!0});v0.TextPath=void 0;const Wy=bt,xi=be,IB=ln,uh=cc,Hy=dc,t8=Re,PB=Oe,RB="",n8="normal";function r8(n){n.fillText(this.partialText,0,0)}function i8(n){n.strokeText(this.partialText,0,0)}class un extends IB.Shape{constructor(e){super(e),this.dummyCanvas=Wy.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return uh.Path.getPathLength(this.dataArray)}_getPointAtLength(e){if(!this.attrs.data)return null;const t=this.pathLength;return e-1>t?null:uh.Path.getPointAtLengthOfDataArray(e,this.dataArray)}_readDataAttribute(){this.dataArray=uh.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(e){e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",this.textBaseline()),e.setAttr("textAlign","left"),e.save();const t=this.textDecoration(),r=this.fill(),i=this.fontSize(),s=this.glyphInfo;t==="underline"&&e.beginPath();for(let o=0;o<s.length;o++){e.save();const u=s[o].p0;e.translate(u.x,u.y),e.rotate(s[o].rotation),this.partialText=s[o].text,e.fillStrokeShape(this),t==="underline"&&(o===0&&e.moveTo(0,i/2+1),e.lineTo(i,i/2+1)),e.restore()}t==="underline"&&(e.strokeStyle=r,e.lineWidth=i/20,e.stroke()),e.restore()}_hitFunc(e){e.beginPath();const t=this.glyphInfo;if(t.length>=1){const r=t[0].p0;e.moveTo(r.x,r.y)}for(let r=0;r<t.length;r++){const i=t[r].p1;e.lineTo(i.x,i.y)}e.setAttr("lineWidth",this.fontSize()),e.setAttr("strokeStyle",this.colorKey),e.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return Wy.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(e){return Hy.Text.prototype.setText.call(this,e)}_getContextFont(){return Hy.Text.prototype._getContextFont.call(this)}_getTextSize(e){const r=this.dummyCanvas.getContext("2d");r.save(),r.font=this._getContextFont();const i=r.measureText(e);return r.restore(),{width:i.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:e,height:t}=this._getTextSize(this.attrs.text);if(this.textWidth=e,this.textHeight=t,this.glyphInfo=[],!this.attrs.data)return null;const r=this.letterSpacing(),i=this.align(),s=this.kerningFunc(),o=Math.max(this.textWidth+((this.attrs.text||"").length-1)*r,0);let u=0;i==="center"&&(u=Math.max(0,this.pathLength/2-o/2)),i==="right"&&(u=Math.max(0,this.pathLength-o));const c=(0,Hy.stringToArray)(this.text());let d=u;for(let p=0;p<c.length;p++){const m=this._getPointAtLength(d);if(!m)return;let y=this._getTextSize(c[p]).width+r;if(c[p]===" "&&i==="justify"){const R=this.text().split(" ").length-1;y+=(this.pathLength-o)/R}const E=this._getPointAtLength(d+y);if(!E)return;const S=uh.Path.getLineLength(m.x,m.y,E.x,E.y);let x=0;if(s)try{x=s(c[p-1],c[p])*this.fontSize()}catch{x=0}m.x+=x,E.x+=x,this.textWidth+=x;const D=uh.Path.getPointOnLine(x+S/2,m.x,m.y,E.x,E.y),k=Math.atan2(E.y-m.y,E.x-m.x);this.glyphInfo.push({transposeX:D.x,transposeY:D.y,text:c[p],rotation:k,p0:m,p1:E}),d+=y}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const e=[];this.glyphInfo.forEach(function(d){e.push(d.p0.x),e.push(d.p0.y),e.push(d.p1.x),e.push(d.p1.y)});let t=e[0]||0,r=e[0]||0,i=e[1]||0,s=e[1]||0,o,u;for(let d=0;d<e.length/2;d++)o=e[d*2],u=e[d*2+1],t=Math.min(t,o),r=Math.max(r,o),i=Math.min(i,u),s=Math.max(s,u);const c=this.fontSize();return{x:t-c/2,y:i-c/2,width:r-t+c,height:s-i+c}}destroy(){return Wy.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}v0.TextPath=un;un.prototype._fillFunc=r8;un.prototype._strokeFunc=i8;un.prototype._fillFuncHit=r8;un.prototype._strokeFuncHit=i8;un.prototype.className="TextPath";un.prototype._attrsAffectingSize=["text","fontSize","data"];(0,PB._registerNode)(un);xi.Factory.addGetterSetter(un,"data");xi.Factory.addGetterSetter(un,"fontFamily","Arial");xi.Factory.addGetterSetter(un,"fontSize",12,(0,t8.getNumberValidator)());xi.Factory.addGetterSetter(un,"fontStyle",n8);xi.Factory.addGetterSetter(un,"align","left");xi.Factory.addGetterSetter(un,"letterSpacing",0,(0,t8.getNumberValidator)());xi.Factory.addGetterSetter(un,"textBaseline","middle");xi.Factory.addGetterSetter(un,"fontVariant",n8);xi.Factory.addGetterSetter(un,"text",RB);xi.Factory.addGetterSetter(un,"textDecoration","");xi.Factory.addGetterSetter(un,"kerningFunc",void 0);var w0={};Object.defineProperty(w0,"__esModule",{value:!0});w0.Transformer=void 0;const pt=bt,rt=be,uC=kt,AB=ln,kB=rf,cC=lc,mi=Oe,ua=Re,xB=Oe,s8="tr-konva",NB=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(n=>n+`.${s8}`).join(" "),hC="nodesRect",DB=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],MB={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},OB="ontouchstart"in mi.Konva._global;function LB(n,e,t){if(n==="rotater")return t;e+=pt.Util.degToRad(MB[n]||0);const r=(pt.Util.radToDeg(e)%360+360)%360;return pt.Util._inRange(r,315+22.5,360)||pt.Util._inRange(r,0,22.5)?"ns-resize":pt.Util._inRange(r,45-22.5,45+22.5)?"nesw-resize":pt.Util._inRange(r,90-22.5,90+22.5)?"ew-resize":pt.Util._inRange(r,135-22.5,135+22.5)?"nwse-resize":pt.Util._inRange(r,180-22.5,180+22.5)?"ns-resize":pt.Util._inRange(r,225-22.5,225+22.5)?"nesw-resize":pt.Util._inRange(r,270-22.5,270+22.5)?"ew-resize":pt.Util._inRange(r,315-22.5,315+22.5)?"nwse-resize":(pt.Util.error("Transformer has unknown angle for cursor detection: "+r),"pointer")}const lm=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function bB(n){return{x:n.x+n.width/2*Math.cos(n.rotation)+n.height/2*Math.sin(-n.rotation),y:n.y+n.height/2*Math.cos(n.rotation)+n.width/2*Math.sin(n.rotation)}}function o8(n,e,t){const r=t.x+(n.x-t.x)*Math.cos(e)-(n.y-t.y)*Math.sin(e),i=t.y+(n.x-t.x)*Math.sin(e)+(n.y-t.y)*Math.cos(e);return{...n,rotation:n.rotation+e,x:r,y:i}}function FB(n,e){const t=bB(n);return o8(n,e,t)}function VB(n,e,t){let r=e;for(let i=0;i<n.length;i++){const s=mi.Konva.getAngle(n[i]),o=Math.abs(s-e)%(Math.PI*2);Math.min(o,Math.PI*2-o)<t&&(r=s)}return r}let Lv=0;class We extends cC.Group{constructor(e){super(e),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(NB,this.update),this.getNode()&&this.update()}attachTo(e){return this.setNode(e),this}setNode(e){return pt.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([e])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return s8+this._id}setNodes(e=[]){this._nodes&&this._nodes.length&&this.detach();const t=e.filter(i=>i.isAncestorOf(this)?(pt.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=e=t,e.length===1&&this.useSingleNodeRotation()?this.rotation(e[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(i=>{const s=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(i._attrsAffectingSize.length){const o=i._attrsAffectingSize.map(u=>u+"Change."+this._getEventNamespace()).join(" ");i.on(o,s)}i.on(DB.map(o=>o+`.${this._getEventNamespace()}`).join(" "),s),i.on(`absoluteTransformChange.${this._getEventNamespace()}`,s),this._proxyDrag(i)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(e){let t;e.on(`dragstart.${this._getEventNamespace()}`,r=>{t=e.getAbsolutePosition(),!this.isDragging()&&e!==this.findOne(".back")&&this.startDrag(r,!1)}),e.on(`dragmove.${this._getEventNamespace()}`,r=>{if(!t)return;const i=e.getAbsolutePosition(),s=i.x-t.x,o=i.y-t.y;this.nodes().forEach(u=>{if(u===e||u.isDragging())return;const c=u.getAbsolutePosition();u.setAbsolutePosition({x:c.x+s,y:c.y+o}),u.startDrag(r)}),t=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(e=>{e.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(hC),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(hC,this.__getNodeRect)}__getNodeShape(e,t=this.rotation(),r){const i=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),s=e.getAbsoluteScale(r),o=e.getAbsolutePosition(r),u=i.x*s.x-e.offsetX()*s.x,c=i.y*s.y-e.offsetY()*s.y,d=(mi.Konva.getAngle(e.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),p={x:o.x+u*Math.cos(d)+c*Math.sin(-d),y:o.y+c*Math.cos(d)+u*Math.sin(d),width:i.width*s.x,height:i.height*s.y,rotation:d};return o8(p,-mi.Konva.getAngle(t),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const t=[];this.nodes().map(d=>{const p=d.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),m=[{x:p.x,y:p.y},{x:p.x+p.width,y:p.y},{x:p.x+p.width,y:p.y+p.height},{x:p.x,y:p.y+p.height}],y=d.getAbsoluteTransform();m.forEach(function(E){const S=y.point(E);t.push(S)})});const r=new pt.Transform;r.rotate(-mi.Konva.getAngle(this.rotation()));let i=1/0,s=1/0,o=-1/0,u=-1/0;t.forEach(function(d){const p=r.point(d);i===void 0&&(i=o=p.x,s=u=p.y),i=Math.min(i,p.x),s=Math.min(s,p.y),o=Math.max(o,p.x),u=Math.max(u,p.y)}),r.invert();const c=r.point({x:i,y:s});return{x:c.x,y:c.y,width:o-i,height:u-s,rotation:mi.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),lm.forEach(e=>{this._createAnchor(e)}),this._createAnchor("rotater")}_createAnchor(e){const t=new kB.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:e+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:OB?10:"auto"}),r=this;t.on("mousedown touchstart",function(i){r._handleMouseDown(i)}),t.on("dragstart",i=>{t.stopDrag(),i.cancelBubble=!0}),t.on("dragend",i=>{i.cancelBubble=!0}),t.on("mouseenter",()=>{const i=mi.Konva.getAngle(this.rotation()),s=this.rotateAnchorCursor(),o=LB(e,i,s);t.getStage().content&&(t.getStage().content.style.cursor=o),this._cursorChange=!0}),t.on("mouseout",()=>{t.getStage().content&&(t.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(t)}_createBack(){const e=new AB.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(t,r){const i=r.getParent(),s=i.padding();t.beginPath(),t.rect(-s,-s,r.width()+s*2,r.height()+s*2),t.moveTo(r.width()/2,-s),i.rotateEnabled()&&i.rotateLineVisible()&&t.lineTo(r.width()/2,-i.rotateAnchorOffset()*pt.Util._sign(r.height())-s),t.fillStrokeShape(r)},hitFunc:(t,r)=>{if(!this.shouldOverdrawWholeArea())return;const i=this.padding();t.beginPath(),t.rect(-i,-i,r.width()+i*2,r.height()+i*2),t.fillStrokeShape(r)}});this.add(e),this._proxyDrag(e),e.on("dragstart",t=>{t.cancelBubble=!0}),e.on("dragmove",t=>{t.cancelBubble=!0}),e.on("dragend",t=>{t.cancelBubble=!0}),this.on("dragmove",t=>{this.update()})}_handleMouseDown(e){if(this._transforming)return;this._movingAnchorName=e.target.name().split(" ")[0];const t=this._getNodeRect(),r=t.width,i=t.height,s=Math.sqrt(Math.pow(r,2)+Math.pow(i,2));this.sin=Math.abs(i/s),this.cos=Math.abs(r/s),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const o=e.target.getAbsolutePosition(),u=e.target.getStage().getPointerPosition();this._anchorDragOffset={x:u.x-o.x,y:u.y-o.y},Lv++,this._fire("transformstart",{evt:e.evt,target:this.getNode()}),this._nodes.forEach(c=>{c._fire("transformstart",{evt:e.evt,target:c})})}_handleMouseMove(e){let t,r,i;const s=this.findOne("."+this._movingAnchorName),o=s.getStage();o.setPointersPositions(e);const u=o.getPointerPosition();let c={x:u.x-this._anchorDragOffset.x,y:u.y-this._anchorDragOffset.y};const d=s.getAbsolutePosition();this.anchorDragBoundFunc()&&(c=this.anchorDragBoundFunc()(d,c,e)),s.setAbsolutePosition(c);const p=s.getAbsolutePosition();if(d.x===p.x&&d.y===p.y)return;if(this._movingAnchorName==="rotater"){const R=this._getNodeRect();t=s.x()-R.width/2,r=-s.y()+R.height/2;let w=Math.atan2(-r,t)+Math.PI/2;R.height<0&&(w-=Math.PI);const V=mi.Konva.getAngle(this.rotation())+w,z=mi.Konva.getAngle(this.rotationSnapTolerance()),C=VB(this.rotationSnaps(),V,z)-R.rotation,N=FB(R,C);this._fitNodesInto(N,e);return}const m=this.shiftBehavior();let y;m==="inverted"?y=this.keepRatio()&&!e.shiftKey:m==="none"?y=this.keepRatio():y=this.keepRatio()||e.shiftKey;let E=this.centeredScaling()||e.altKey;if(this._movingAnchorName==="top-left"){if(y){const R=E?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};i=Math.sqrt(Math.pow(R.x-s.x(),2)+Math.pow(R.y-s.y(),2));const w=this.findOne(".top-left").x()>R.x?-1:1,P=this.findOne(".top-left").y()>R.y?-1:1;t=i*this.cos*w,r=i*this.sin*P,this.findOne(".top-left").x(R.x-t),this.findOne(".top-left").y(R.y-r)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(s.y());else if(this._movingAnchorName==="top-right"){if(y){const R=E?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};i=Math.sqrt(Math.pow(s.x()-R.x,2)+Math.pow(R.y-s.y(),2));const w=this.findOne(".top-right").x()<R.x?-1:1,P=this.findOne(".top-right").y()>R.y?-1:1;t=i*this.cos*w,r=i*this.sin*P,this.findOne(".top-right").x(R.x+t),this.findOne(".top-right").y(R.y-r)}var S=s.position();this.findOne(".top-left").y(S.y),this.findOne(".bottom-right").x(S.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(s.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(s.x());else if(this._movingAnchorName==="bottom-left"){if(y){const R=E?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};i=Math.sqrt(Math.pow(R.x-s.x(),2)+Math.pow(s.y()-R.y,2));const w=R.x<s.x()?-1:1,P=s.y()<R.y?-1:1;t=i*this.cos*w,r=i*this.sin*P,s.x(R.x-t),s.y(R.y+r)}S=s.position(),this.findOne(".top-left").x(S.x),this.findOne(".bottom-right").y(S.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(s.y());else if(this._movingAnchorName==="bottom-right"){if(y){const R=E?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};i=Math.sqrt(Math.pow(s.x()-R.x,2)+Math.pow(s.y()-R.y,2));const w=this.findOne(".bottom-right").x()<R.x?-1:1,P=this.findOne(".bottom-right").y()<R.y?-1:1;t=i*this.cos*w,r=i*this.sin*P,this.findOne(".bottom-right").x(R.x+t),this.findOne(".bottom-right").y(R.y+r)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(E=this.centeredScaling()||e.altKey,E){const R=this.findOne(".top-left"),w=this.findOne(".bottom-right"),P=R.x(),V=R.y(),z=this.getWidth()-w.x(),M=this.getHeight()-w.y();w.move({x:-P,y:-V}),R.move({x:z,y:M})}const x=this.findOne(".top-left").getAbsolutePosition();t=x.x,r=x.y;const D=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),k=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:t,y:r,width:D,height:k,rotation:mi.Konva.getAngle(this.rotation())},e)}_handleMouseUp(e){this._removeEvents(e)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(e){var t;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const r=this.getNode();Lv--,this._fire("transformend",{evt:e,target:r}),(t=this.getLayer())===null||t===void 0||t.batchDraw(),r&&this._nodes.forEach(i=>{var s;i._fire("transformend",{evt:e,target:i}),(s=i.getLayer())===null||s===void 0||s.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(e,t){const r=this._getNodeRect(),i=1;if(pt.Util._inRange(e.width,-this.padding()*2-i,i)){this.update();return}if(pt.Util._inRange(e.height,-this.padding()*2-i,i)){this.update();return}const s=new pt.Transform;if(s.rotate(mi.Konva.getAngle(this.rotation())),this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("left")>=0){const y=s.point({x:-this.padding()*2,y:0});e.x+=y.x,e.y+=y.y,e.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=y.x,this._anchorDragOffset.y-=y.y}else if(this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("right")>=0){const y=s.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=y.x,this._anchorDragOffset.y-=y.y,e.width+=this.padding()*2}if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("top")>=0){const y=s.point({x:0,y:-this.padding()*2});e.x+=y.x,e.y+=y.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=y.x,this._anchorDragOffset.y-=y.y,e.height+=this.padding()*2}else if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const y=s.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=y.x,this._anchorDragOffset.y-=y.y,e.height+=this.padding()*2}if(this.boundBoxFunc()){const y=this.boundBoxFunc()(r,e);y?e=y:pt.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const o=1e7,u=new pt.Transform;u.translate(r.x,r.y),u.rotate(r.rotation),u.scale(r.width/o,r.height/o);const c=new pt.Transform,d=e.width/o,p=e.height/o;this.flipEnabled()===!1?(c.translate(e.x,e.y),c.rotate(e.rotation),c.translate(e.width<0?e.width:0,e.height<0?e.height:0),c.scale(Math.abs(d),Math.abs(p))):(c.translate(e.x,e.y),c.rotate(e.rotation),c.scale(d,p));const m=c.multiply(u.invert());this._nodes.forEach(y=>{var E;const S=y.getParent().getAbsoluteTransform(),x=y.getTransform().copy();x.translate(y.offsetX(),y.offsetY());const D=new pt.Transform;D.multiply(S.copy().invert()).multiply(m).multiply(S).multiply(x);const k=D.decompose();y.setAttrs(k),(E=y.getLayer())===null||E===void 0||E.batchDraw()}),this.rotation(pt.Util._getRotation(e.rotation)),this._nodes.forEach(y=>{this._fire("transform",{evt:t,target:y}),y._fire("transform",{evt:t,target:y})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(e,t){this.findOne(e).setAttrs(t)}update(){var e;const t=this._getNodeRect();this.rotation(pt.Util._getRotation(t.rotation));const r=t.width,i=t.height,s=this.enabledAnchors(),o=this.resizeEnabled(),u=this.padding(),c=this.anchorSize(),d=this.find("._anchor");d.forEach(m=>{m.setAttrs({width:c,height:c,offsetX:c/2,offsetY:c/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:c/2+u,offsetY:c/2+u,visible:o&&s.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:r/2,y:0,offsetY:c/2+u,visible:o&&s.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:r,y:0,offsetX:c/2-u,offsetY:c/2+u,visible:o&&s.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:i/2,offsetX:c/2+u,visible:o&&s.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:r,y:i/2,offsetX:c/2-u,visible:o&&s.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:i,offsetX:c/2+u,offsetY:c/2-u,visible:o&&s.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:r/2,y:i,offsetY:c/2-u,visible:o&&s.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:r,y:i,offsetX:c/2-u,offsetY:c/2-u,visible:o&&s.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:r/2,y:-this.rotateAnchorOffset()*pt.Util._sign(i)-u,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:r,height:i,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const p=this.anchorStyleFunc();p&&d.forEach(m=>{p(m)}),(e=this.getLayer())===null||e===void 0||e.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const e=this.findOne("."+this._movingAnchorName);e&&e.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),cC.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return uC.Node.prototype.toObject.call(this)}clone(e){return uC.Node.prototype.clone.call(this,e)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}w0.Transformer=We;We.isTransforming=()=>Lv>0;function UB(n){return n instanceof Array||pt.Util.warn("enabledAnchors value should be an array"),n instanceof Array&&n.forEach(function(e){lm.indexOf(e)===-1&&pt.Util.warn("Unknown anchor name: "+e+". Available names are: "+lm.join(", "))}),n||[]}We.prototype.className="Transformer";(0,xB._registerNode)(We);rt.Factory.addGetterSetter(We,"enabledAnchors",lm,UB);rt.Factory.addGetterSetter(We,"flipEnabled",!0,(0,ua.getBooleanValidator)());rt.Factory.addGetterSetter(We,"resizeEnabled",!0);rt.Factory.addGetterSetter(We,"anchorSize",10,(0,ua.getNumberValidator)());rt.Factory.addGetterSetter(We,"rotateEnabled",!0);rt.Factory.addGetterSetter(We,"rotateLineVisible",!0);rt.Factory.addGetterSetter(We,"rotationSnaps",[]);rt.Factory.addGetterSetter(We,"rotateAnchorOffset",50,(0,ua.getNumberValidator)());rt.Factory.addGetterSetter(We,"rotateAnchorCursor","crosshair");rt.Factory.addGetterSetter(We,"rotationSnapTolerance",5,(0,ua.getNumberValidator)());rt.Factory.addGetterSetter(We,"borderEnabled",!0);rt.Factory.addGetterSetter(We,"anchorStroke","rgb(0, 161, 255)");rt.Factory.addGetterSetter(We,"anchorStrokeWidth",1,(0,ua.getNumberValidator)());rt.Factory.addGetterSetter(We,"anchorFill","white");rt.Factory.addGetterSetter(We,"anchorCornerRadius",0,(0,ua.getNumberValidator)());rt.Factory.addGetterSetter(We,"borderStroke","rgb(0, 161, 255)");rt.Factory.addGetterSetter(We,"borderStrokeWidth",1,(0,ua.getNumberValidator)());rt.Factory.addGetterSetter(We,"borderDash");rt.Factory.addGetterSetter(We,"keepRatio",!0);rt.Factory.addGetterSetter(We,"shiftBehavior","default");rt.Factory.addGetterSetter(We,"centeredScaling",!1);rt.Factory.addGetterSetter(We,"ignoreStroke",!1);rt.Factory.addGetterSetter(We,"padding",0,(0,ua.getNumberValidator)());rt.Factory.addGetterSetter(We,"nodes");rt.Factory.addGetterSetter(We,"node");rt.Factory.addGetterSetter(We,"boundBoxFunc");rt.Factory.addGetterSetter(We,"anchorDragBoundFunc");rt.Factory.addGetterSetter(We,"anchorStyleFunc");rt.Factory.addGetterSetter(We,"shouldOverdrawWholeArea",!1);rt.Factory.addGetterSetter(We,"useSingleNodeRotation",!0);rt.Factory.backCompat(We,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var S0={};Object.defineProperty(S0,"__esModule",{value:!0});S0.Wedge=void 0;const E0=be,zB=ln,BB=Oe,a8=Re,GB=Oe;class Zs extends zB.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.radius(),0,BB.Konva.getAngle(this.angle()),this.clockwise()),e.lineTo(0,0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}S0.Wedge=Zs;Zs.prototype.className="Wedge";Zs.prototype._centroid=!0;Zs.prototype._attrsAffectingSize=["radius"];(0,GB._registerNode)(Zs);E0.Factory.addGetterSetter(Zs,"radius",0,(0,a8.getNumberValidator)());E0.Factory.addGetterSetter(Zs,"angle",0,(0,a8.getNumberValidator)());E0.Factory.addGetterSetter(Zs,"clockwise",!1);E0.Factory.backCompat(Zs,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var T0={};Object.defineProperty(T0,"__esModule",{value:!0});T0.Blur=void 0;const dC=be,jB=kt,WB=Re;function fC(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const HB=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],$B=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function qB(n,e){const t=n.data,r=n.width,i=n.height;let s,o,u,c,d,p,m,y,E,S,x,D,k,R,w,P,V,z,M,C;const N=e+e+1,A=r-1,L=i-1,U=e+1,F=U*(U+1)/2,pe=new fC,Y=HB[e],he=$B[e];let ue=null,H=pe,te=null,J=null;for(let ee=1;ee<N;ee++)H=H.next=new fC,ee===U&&(ue=H);H.next=pe,u=o=0;for(let ee=0;ee<i;ee++){D=k=R=w=c=d=p=m=0,y=U*(P=t[o]),E=U*(V=t[o+1]),S=U*(z=t[o+2]),x=U*(M=t[o+3]),c+=F*P,d+=F*V,p+=F*z,m+=F*M,H=pe;for(let ae=0;ae<U;ae++)H.r=P,H.g=V,H.b=z,H.a=M,H=H.next;for(let ae=1;ae<U;ae++)s=o+((A<ae?A:ae)<<2),c+=(H.r=P=t[s])*(C=U-ae),d+=(H.g=V=t[s+1])*C,p+=(H.b=z=t[s+2])*C,m+=(H.a=M=t[s+3])*C,D+=P,k+=V,R+=z,w+=M,H=H.next;te=pe,J=ue;for(let ae=0;ae<r;ae++)t[o+3]=M=m*Y>>he,M!==0?(M=255/M,t[o]=(c*Y>>he)*M,t[o+1]=(d*Y>>he)*M,t[o+2]=(p*Y>>he)*M):t[o]=t[o+1]=t[o+2]=0,c-=y,d-=E,p-=S,m-=x,y-=te.r,E-=te.g,S-=te.b,x-=te.a,s=u+((s=ae+e+1)<A?s:A)<<2,D+=te.r=t[s],k+=te.g=t[s+1],R+=te.b=t[s+2],w+=te.a=t[s+3],c+=D,d+=k,p+=R,m+=w,te=te.next,y+=P=J.r,E+=V=J.g,S+=z=J.b,x+=M=J.a,D-=P,k-=V,R-=z,w-=M,J=J.next,o+=4;u+=r}for(let ee=0;ee<r;ee++){k=R=w=D=d=p=m=c=0,o=ee<<2,y=U*(P=t[o]),E=U*(V=t[o+1]),S=U*(z=t[o+2]),x=U*(M=t[o+3]),c+=F*P,d+=F*V,p+=F*z,m+=F*M,H=pe;for(let Ee=0;Ee<U;Ee++)H.r=P,H.g=V,H.b=z,H.a=M,H=H.next;let ae=r;for(let Ee=1;Ee<=e;Ee++)o=ae+ee<<2,c+=(H.r=P=t[o])*(C=U-Ee),d+=(H.g=V=t[o+1])*C,p+=(H.b=z=t[o+2])*C,m+=(H.a=M=t[o+3])*C,D+=P,k+=V,R+=z,w+=M,H=H.next,Ee<L&&(ae+=r);o=ee,te=pe,J=ue;for(let Ee=0;Ee<i;Ee++)s=o<<2,t[s+3]=M=m*Y>>he,M>0?(M=255/M,t[s]=(c*Y>>he)*M,t[s+1]=(d*Y>>he)*M,t[s+2]=(p*Y>>he)*M):t[s]=t[s+1]=t[s+2]=0,c-=y,d-=E,p-=S,m-=x,y-=te.r,E-=te.g,S-=te.b,x-=te.a,s=ee+((s=Ee+U)<L?s:L)*r<<2,c+=D+=te.r=t[s],d+=k+=te.g=t[s+1],p+=R+=te.b=t[s+2],m+=w+=te.a=t[s+3],te=te.next,y+=P=J.r,E+=V=J.g,S+=z=J.b,x+=M=J.a,D-=P,k-=V,R-=z,w-=M,J=J.next,o+=r}}const KB=function(e){const t=Math.round(this.blurRadius());t>0&&qB(e,t)};T0.Blur=KB;dC.Factory.addGetterSetter(jB.Node,"blurRadius",0,(0,WB.getNumberValidator)(),dC.Factory.afterSetFilter);var C0={};Object.defineProperty(C0,"__esModule",{value:!0});C0.Brighten=void 0;const pC=be,QB=kt,YB=Re,XB=function(n){const e=this.brightness()*255,t=n.data,r=t.length;for(let i=0;i<r;i+=4)t[i]+=e,t[i+1]+=e,t[i+2]+=e};C0.Brighten=XB;pC.Factory.addGetterSetter(QB.Node,"brightness",0,(0,YB.getNumberValidator)(),pC.Factory.afterSetFilter);var I0={};Object.defineProperty(I0,"__esModule",{value:!0});I0.Contrast=void 0;const gC=be,JB=kt,ZB=Re,eG=function(n){const e=Math.pow((this.contrast()+100)/100,2),t=n.data,r=t.length;let i=150,s=150,o=150;for(let u=0;u<r;u+=4)i=t[u],s=t[u+1],o=t[u+2],i/=255,i-=.5,i*=e,i+=.5,i*=255,s/=255,s-=.5,s*=e,s+=.5,s*=255,o/=255,o-=.5,o*=e,o+=.5,o*=255,i=i<0?0:i>255?255:i,s=s<0?0:s>255?255:s,o=o<0?0:o>255?255:o,t[u]=i,t[u+1]=s,t[u+2]=o};I0.Contrast=eG;gC.Factory.addGetterSetter(JB.Node,"contrast",0,(0,ZB.getNumberValidator)(),gC.Factory.afterSetFilter);var P0={};Object.defineProperty(P0,"__esModule",{value:!0});P0.Emboss=void 0;const Yo=be,R0=kt,tG=bt,l8=Re,nG=function(n){const e=this.embossStrength()*10,t=this.embossWhiteLevel()*255,r=this.embossDirection(),i=this.embossBlend(),s=n.data,o=n.width,u=n.height,c=o*4;let d=0,p=0,m=u;switch(r){case"top-left":d=-1,p=-1;break;case"top":d=-1,p=0;break;case"top-right":d=-1,p=1;break;case"right":d=0,p=1;break;case"bottom-right":d=1,p=1;break;case"bottom":d=1,p=0;break;case"bottom-left":d=1,p=-1;break;case"left":d=0,p=-1;break;default:tG.Util.error("Unknown emboss direction: "+r)}do{const y=(m-1)*c;let E=d;m+E<1&&(E=0),m+E>u&&(E=0);const S=(m-1+E)*o*4;let x=o;do{const D=y+(x-1)*4;let k=p;x+k<1&&(k=0),x+k>o&&(k=0);const R=S+(x-1+k)*4,w=s[D]-s[R],P=s[D+1]-s[R+1],V=s[D+2]-s[R+2];let z=w;const M=z>0?z:-z,C=P>0?P:-P,N=V>0?V:-V;if(C>M&&(z=P),N>M&&(z=V),z*=e,i){const A=s[D]+z,L=s[D+1]+z,U=s[D+2]+z;s[D]=A>255?255:A<0?0:A,s[D+1]=L>255?255:L<0?0:L,s[D+2]=U>255?255:U<0?0:U}else{let A=t-z;A<0?A=0:A>255&&(A=255),s[D]=s[D+1]=s[D+2]=A}}while(--x)}while(--m)};P0.Emboss=nG;Yo.Factory.addGetterSetter(R0.Node,"embossStrength",.5,(0,l8.getNumberValidator)(),Yo.Factory.afterSetFilter);Yo.Factory.addGetterSetter(R0.Node,"embossWhiteLevel",.5,(0,l8.getNumberValidator)(),Yo.Factory.afterSetFilter);Yo.Factory.addGetterSetter(R0.Node,"embossDirection","top-left",void 0,Yo.Factory.afterSetFilter);Yo.Factory.addGetterSetter(R0.Node,"embossBlend",!1,void 0,Yo.Factory.afterSetFilter);var A0={};Object.defineProperty(A0,"__esModule",{value:!0});A0.Enhance=void 0;const mC=be,rG=kt,iG=Re;function $y(n,e,t,r,i){const s=t-e,o=i-r;if(s===0)return r+o/2;if(o===0)return r;let u=(n-e)/s;return u=o*u+r,u}const sG=function(n){const e=n.data,t=e.length;let r=e[0],i=r,s,o=e[1],u=o,c,d=e[2],p=d,m;const y=this.enhance();if(y===0)return;for(let w=0;w<t;w+=4)s=e[w+0],s<r?r=s:s>i&&(i=s),c=e[w+1],c<o?o=c:c>u&&(u=c),m=e[w+2],m<d?d=m:m>p&&(p=m);i===r&&(i=255,r=0),u===o&&(u=255,o=0),p===d&&(p=255,d=0);let E,S,x,D,k,R;if(y>0)E=i+y*(255-i),S=r-y*(r-0),x=u+y*(255-u),D=o-y*(o-0),k=p+y*(255-p),R=d-y*(d-0);else{const w=(i+r)*.5;E=i+y*(i-w),S=r+y*(r-w);const P=(u+o)*.5;x=u+y*(u-P),D=o+y*(o-P);const V=(p+d)*.5;k=p+y*(p-V),R=d+y*(d-V)}for(let w=0;w<t;w+=4)e[w+0]=$y(e[w+0],r,i,S,E),e[w+1]=$y(e[w+1],o,u,D,x),e[w+2]=$y(e[w+2],d,p,R,k)};A0.Enhance=sG;mC.Factory.addGetterSetter(rG.Node,"enhance",0,(0,iG.getNumberValidator)(),mC.Factory.afterSetFilter);var k0={};Object.defineProperty(k0,"__esModule",{value:!0});k0.Grayscale=void 0;const oG=function(n){const e=n.data,t=e.length;for(let r=0;r<t;r+=4){const i=.34*e[r]+.5*e[r+1]+.16*e[r+2];e[r]=i,e[r+1]=i,e[r+2]=i}};k0.Grayscale=oG;var x0={};Object.defineProperty(x0,"__esModule",{value:!0});x0.HSL=void 0;const Wu=be,dS=kt,fS=Re;Wu.Factory.addGetterSetter(dS.Node,"hue",0,(0,fS.getNumberValidator)(),Wu.Factory.afterSetFilter);Wu.Factory.addGetterSetter(dS.Node,"saturation",0,(0,fS.getNumberValidator)(),Wu.Factory.afterSetFilter);Wu.Factory.addGetterSetter(dS.Node,"luminance",0,(0,fS.getNumberValidator)(),Wu.Factory.afterSetFilter);const aG=function(n){const e=n.data,t=e.length,r=1,i=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,o=this.luminance()*127,u=r*i*Math.cos(s*Math.PI/180),c=r*i*Math.sin(s*Math.PI/180),d=.299*r+.701*u+.167*c,p=.587*r-.587*u+.33*c,m=.114*r-.114*u-.497*c,y=.299*r-.299*u-.328*c,E=.587*r+.413*u+.035*c,S=.114*r-.114*u+.293*c,x=.299*r-.3*u+1.25*c,D=.587*r-.586*u-1.05*c,k=.114*r+.886*u-.2*c;let R,w,P,V;for(let z=0;z<t;z+=4)R=e[z+0],w=e[z+1],P=e[z+2],V=e[z+3],e[z+0]=d*R+p*w+m*P+o,e[z+1]=y*R+E*w+S*P+o,e[z+2]=x*R+D*w+k*P+o,e[z+3]=V};x0.HSL=aG;var N0={};Object.defineProperty(N0,"__esModule",{value:!0});N0.HSV=void 0;const Hu=be,pS=kt,gS=Re,lG=function(n){const e=n.data,t=e.length,r=Math.pow(2,this.value()),i=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,o=r*i*Math.cos(s*Math.PI/180),u=r*i*Math.sin(s*Math.PI/180),c=.299*r+.701*o+.167*u,d=.587*r-.587*o+.33*u,p=.114*r-.114*o-.497*u,m=.299*r-.299*o-.328*u,y=.587*r+.413*o+.035*u,E=.114*r-.114*o+.293*u,S=.299*r-.3*o+1.25*u,x=.587*r-.586*o-1.05*u,D=.114*r+.886*o-.2*u;for(let k=0;k<t;k+=4){const R=e[k+0],w=e[k+1],P=e[k+2],V=e[k+3];e[k+0]=c*R+d*w+p*P,e[k+1]=m*R+y*w+E*P,e[k+2]=S*R+x*w+D*P,e[k+3]=V}};N0.HSV=lG;Hu.Factory.addGetterSetter(pS.Node,"hue",0,(0,gS.getNumberValidator)(),Hu.Factory.afterSetFilter);Hu.Factory.addGetterSetter(pS.Node,"saturation",0,(0,gS.getNumberValidator)(),Hu.Factory.afterSetFilter);Hu.Factory.addGetterSetter(pS.Node,"value",0,(0,gS.getNumberValidator)(),Hu.Factory.afterSetFilter);var D0={};Object.defineProperty(D0,"__esModule",{value:!0});D0.Invert=void 0;const uG=function(n){const e=n.data,t=e.length;for(let r=0;r<t;r+=4)e[r]=255-e[r],e[r+1]=255-e[r+1],e[r+2]=255-e[r+2]};D0.Invert=uG;var M0={};Object.defineProperty(M0,"__esModule",{value:!0});M0.Kaleidoscope=void 0;const um=be,u8=kt,_C=bt,c8=Re,cG=function(n,e,t){const r=n.data,i=e.data,s=n.width,o=n.height,u=t.polarCenterX||s/2,c=t.polarCenterY||o/2;let d=Math.sqrt(u*u+c*c),p=s-u,m=o-c;const y=Math.sqrt(p*p+m*m);d=y>d?y:d;const E=o,S=s,x=360/S*Math.PI/180;for(let D=0;D<S;D+=1){const k=Math.sin(D*x),R=Math.cos(D*x);for(let w=0;w<E;w+=1){p=Math.floor(u+d*w/E*R),m=Math.floor(c+d*w/E*k);let P=(m*s+p)*4;const V=r[P+0],z=r[P+1],M=r[P+2],C=r[P+3];P=(D+w*s)*4,i[P+0]=V,i[P+1]=z,i[P+2]=M,i[P+3]=C}}},hG=function(n,e,t){const r=n.data,i=e.data,s=n.width,o=n.height,u=t.polarCenterX||s/2,c=t.polarCenterY||o/2;let d=Math.sqrt(u*u+c*c),p=s-u,m=o-c;const y=Math.sqrt(p*p+m*m);d=y>d?y:d;const E=o,S=s,x=0;let D,k;for(p=0;p<s;p+=1)for(m=0;m<o;m+=1){const R=p-u,w=m-c,P=Math.sqrt(R*R+w*w)*E/d;let V=(Math.atan2(w,R)*180/Math.PI+360+x)%360;V=V*S/360,D=Math.floor(V),k=Math.floor(P);let z=(k*s+D)*4;const M=r[z+0],C=r[z+1],N=r[z+2],A=r[z+3];z=(m*s+p)*4,i[z+0]=M,i[z+1]=C,i[z+2]=N,i[z+3]=A}},dG=function(n){const e=n.width,t=n.height;let r,i,s,o,u,c,d,p,m,y,E=Math.round(this.kaleidoscopePower());const S=Math.round(this.kaleidoscopeAngle()),x=Math.floor(e*(S%360)/360);if(E<1)return;const D=_C.Util.createCanvasElement();D.width=e,D.height=t;const k=D.getContext("2d").getImageData(0,0,e,t);_C.Util.releaseCanvas(D),cG(n,k,{polarCenterX:e/2,polarCenterY:t/2});let R=e/Math.pow(2,E);for(;R<=8;)R=R*2,E-=1;R=Math.ceil(R);let w=R,P=0,V=w,z=1;for(x+R>e&&(P=w,V=0,z=-1),i=0;i<t;i+=1)for(r=P;r!==V;r+=z)s=Math.round(r+x)%e,m=(e*i+s)*4,u=k.data[m+0],c=k.data[m+1],d=k.data[m+2],p=k.data[m+3],y=(e*i+r)*4,k.data[y+0]=u,k.data[y+1]=c,k.data[y+2]=d,k.data[y+3]=p;for(i=0;i<t;i+=1)for(w=Math.floor(R),o=0;o<E;o+=1){for(r=0;r<w+1;r+=1)m=(e*i+r)*4,u=k.data[m+0],c=k.data[m+1],d=k.data[m+2],p=k.data[m+3],y=(e*i+w*2-r-1)*4,k.data[y+0]=u,k.data[y+1]=c,k.data[y+2]=d,k.data[y+3]=p;w*=2}hG(k,n,{})};M0.Kaleidoscope=dG;um.Factory.addGetterSetter(u8.Node,"kaleidoscopePower",2,(0,c8.getNumberValidator)(),um.Factory.afterSetFilter);um.Factory.addGetterSetter(u8.Node,"kaleidoscopeAngle",0,(0,c8.getNumberValidator)(),um.Factory.afterSetFilter);var O0={};Object.defineProperty(O0,"__esModule",{value:!0});O0.Mask=void 0;const yC=be,fG=kt,pG=Re;function Fp(n,e,t){let r=(t*n.width+e)*4;const i=[];return i.push(n.data[r++],n.data[r++],n.data[r++],n.data[r++]),i}function ch(n,e){return Math.sqrt(Math.pow(n[0]-e[0],2)+Math.pow(n[1]-e[1],2)+Math.pow(n[2]-e[2],2))}function gG(n){const e=[0,0,0];for(let t=0;t<n.length;t++)e[0]+=n[t][0],e[1]+=n[t][1],e[2]+=n[t][2];return e[0]/=n.length,e[1]/=n.length,e[2]/=n.length,e}function mG(n,e){const t=Fp(n,0,0),r=Fp(n,n.width-1,0),i=Fp(n,0,n.height-1),s=Fp(n,n.width-1,n.height-1),o=e||10;if(ch(t,r)<o&&ch(r,s)<o&&ch(s,i)<o&&ch(i,t)<o){const u=gG([r,t,s,i]),c=[];for(let d=0;d<n.width*n.height;d++){const p=ch(u,[n.data[d*4],n.data[d*4+1],n.data[d*4+2]]);c[d]=p<o?0:255}return c}}function _G(n,e){for(let t=0;t<n.width*n.height;t++)n.data[4*t+3]=e[t]}function yG(n,e,t){const r=[1,1,1,1,0,1,1,1,1],i=Math.round(Math.sqrt(r.length)),s=Math.floor(i/2),o=[];for(let u=0;u<t;u++)for(let c=0;c<e;c++){const d=u*e+c;let p=0;for(let m=0;m<i;m++)for(let y=0;y<i;y++){const E=u+m-s,S=c+y-s;if(E>=0&&E<t&&S>=0&&S<e){const x=E*e+S,D=r[m*i+y];p+=n[x]*D}}o[d]=p===255*8?255:0}return o}function vG(n,e,t){const r=[1,1,1,1,1,1,1,1,1],i=Math.round(Math.sqrt(r.length)),s=Math.floor(i/2),o=[];for(let u=0;u<t;u++)for(let c=0;c<e;c++){const d=u*e+c;let p=0;for(let m=0;m<i;m++)for(let y=0;y<i;y++){const E=u+m-s,S=c+y-s;if(E>=0&&E<t&&S>=0&&S<e){const x=E*e+S,D=r[m*i+y];p+=n[x]*D}}o[d]=p>=255*4?255:0}return o}function wG(n,e,t){const r=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],i=Math.round(Math.sqrt(r.length)),s=Math.floor(i/2),o=[];for(let u=0;u<t;u++)for(let c=0;c<e;c++){const d=u*e+c;let p=0;for(let m=0;m<i;m++)for(let y=0;y<i;y++){const E=u+m-s,S=c+y-s;if(E>=0&&E<t&&S>=0&&S<e){const x=E*e+S,D=r[m*i+y];p+=n[x]*D}}o[d]=p}return o}const SG=function(n){const e=this.threshold();let t=mG(n,e);return t&&(t=yG(t,n.width,n.height),t=vG(t,n.width,n.height),t=wG(t,n.width,n.height),_G(n,t)),n};O0.Mask=SG;yC.Factory.addGetterSetter(fG.Node,"threshold",0,(0,pG.getNumberValidator)(),yC.Factory.afterSetFilter);var L0={};Object.defineProperty(L0,"__esModule",{value:!0});L0.Noise=void 0;const vC=be,EG=kt,TG=Re,CG=function(n){const e=this.noise()*255,t=n.data,r=t.length,i=e/2;for(let s=0;s<r;s+=4)t[s+0]+=i-2*i*Math.random(),t[s+1]+=i-2*i*Math.random(),t[s+2]+=i-2*i*Math.random()};L0.Noise=CG;vC.Factory.addGetterSetter(EG.Node,"noise",.2,(0,TG.getNumberValidator)(),vC.Factory.afterSetFilter);var b0={};Object.defineProperty(b0,"__esModule",{value:!0});b0.Pixelate=void 0;const wC=be,IG=bt,PG=kt,RG=Re,AG=function(n){let e=Math.ceil(this.pixelSize()),t=n.width,r=n.height,i=Math.ceil(t/e),s=Math.ceil(r/e),o=n.data;if(e<=0){IG.Util.error("pixelSize value can not be <= 0");return}for(let u=0;u<i;u+=1)for(let c=0;c<s;c+=1){let d=0,p=0,m=0,y=0;const E=u*e,S=E+e,x=c*e,D=x+e;let k=0;for(let R=E;R<S;R+=1)if(!(R>=t))for(let w=x;w<D;w+=1){if(w>=r)continue;const P=(t*w+R)*4;d+=o[P+0],p+=o[P+1],m+=o[P+2],y+=o[P+3],k+=1}d=d/k,p=p/k,m=m/k,y=y/k;for(let R=E;R<S;R+=1)if(!(R>=t))for(let w=x;w<D;w+=1){if(w>=r)continue;const P=(t*w+R)*4;o[P+0]=d,o[P+1]=p,o[P+2]=m,o[P+3]=y}}};b0.Pixelate=AG;wC.Factory.addGetterSetter(PG.Node,"pixelSize",8,(0,RG.getNumberValidator)(),wC.Factory.afterSetFilter);var F0={};Object.defineProperty(F0,"__esModule",{value:!0});F0.Posterize=void 0;const SC=be,kG=kt,xG=Re,NG=function(n){const e=Math.round(this.levels()*254)+1,t=n.data,r=t.length,i=255/e;for(let s=0;s<r;s+=1)t[s]=Math.floor(t[s]/i)*i};F0.Posterize=NG;SC.Factory.addGetterSetter(kG.Node,"levels",.5,(0,xG.getNumberValidator)(),SC.Factory.afterSetFilter);var V0={};Object.defineProperty(V0,"__esModule",{value:!0});V0.RGB=void 0;const cm=be,mS=kt,DG=Re,MG=function(n){const e=n.data,t=e.length,r=this.red(),i=this.green(),s=this.blue();for(let o=0;o<t;o+=4){const u=(.34*e[o]+.5*e[o+1]+.16*e[o+2])/255;e[o]=u*r,e[o+1]=u*i,e[o+2]=u*s,e[o+3]=e[o+3]}};V0.RGB=MG;cm.Factory.addGetterSetter(mS.Node,"red",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)});cm.Factory.addGetterSetter(mS.Node,"green",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)});cm.Factory.addGetterSetter(mS.Node,"blue",0,DG.RGBComponent,cm.Factory.afterSetFilter);var U0={};Object.defineProperty(U0,"__esModule",{value:!0});U0.RGBA=void 0;const Td=be,z0=kt,OG=Re,LG=function(n){const e=n.data,t=e.length,r=this.red(),i=this.green(),s=this.blue(),o=this.alpha();for(let u=0;u<t;u+=4){const c=1-o;e[u]=r*o+e[u]*c,e[u+1]=i*o+e[u+1]*c,e[u+2]=s*o+e[u+2]*c}};U0.RGBA=LG;Td.Factory.addGetterSetter(z0.Node,"red",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)});Td.Factory.addGetterSetter(z0.Node,"green",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)});Td.Factory.addGetterSetter(z0.Node,"blue",0,OG.RGBComponent,Td.Factory.afterSetFilter);Td.Factory.addGetterSetter(z0.Node,"alpha",1,function(n){return this._filterUpToDate=!1,n>1?1:n<0?0:n});var B0={};Object.defineProperty(B0,"__esModule",{value:!0});B0.Sepia=void 0;const bG=function(n){const e=n.data,t=e.length;for(let r=0;r<t;r+=4){const i=e[r+0],s=e[r+1],o=e[r+2];e[r+0]=Math.min(255,i*.393+s*.769+o*.189),e[r+1]=Math.min(255,i*.349+s*.686+o*.168),e[r+2]=Math.min(255,i*.272+s*.534+o*.131)}};B0.Sepia=bG;var G0={};Object.defineProperty(G0,"__esModule",{value:!0});G0.Solarize=void 0;const FG=function(n){const e=n.data,t=n.width,r=n.height,i=t*4;let s=r;do{const o=(s-1)*i;let u=t;do{const c=o+(u-1)*4;let d=e[c],p=e[c+1],m=e[c+2];d>127&&(d=255-d),p>127&&(p=255-p),m>127&&(m=255-m),e[c]=d,e[c+1]=p,e[c+2]=m}while(--u)}while(--s)};G0.Solarize=FG;var j0={};Object.defineProperty(j0,"__esModule",{value:!0});j0.Threshold=void 0;const EC=be,VG=kt,UG=Re,zG=function(n){const e=this.threshold()*255,t=n.data,r=t.length;for(let i=0;i<r;i+=1)t[i]=t[i]<e?0:255};j0.Threshold=zG;EC.Factory.addGetterSetter(VG.Node,"threshold",.5,(0,UG.getNumberValidator)(),EC.Factory.afterSetFilter);Object.defineProperty(Zm,"__esModule",{value:!0});Zm.Konva=void 0;const TC=om,BG=i0,GG=a0,jG=c0,WG=h0,HG=d0,CC=ju,$G=tf,qG=cc,KG=rf,QG=g0,YG=m0,XG=_0,JG=y0,ZG=dc,ej=v0,tj=w0,nj=S0,rj=T0,ij=C0,sj=I0,oj=P0,aj=A0,lj=k0,uj=x0,cj=N0,hj=D0,dj=M0,fj=O0,pj=L0,gj=b0,mj=F0,_j=V0,yj=U0,vj=B0,wj=G0,Sj=j0;Zm.Konva=TC.Konva.Util._assign(TC.Konva,{Arc:BG.Arc,Arrow:GG.Arrow,Circle:jG.Circle,Ellipse:WG.Ellipse,Image:HG.Image,Label:CC.Label,Tag:CC.Tag,Line:$G.Line,Path:qG.Path,Rect:KG.Rect,RegularPolygon:QG.RegularPolygon,Ring:YG.Ring,Sprite:XG.Sprite,Star:JG.Star,Text:ZG.Text,TextPath:ej.TextPath,Transformer:tj.Transformer,Wedge:nj.Wedge,Filters:{Blur:rj.Blur,Brighten:ij.Brighten,Contrast:sj.Contrast,Emboss:oj.Emboss,Enhance:aj.Enhance,Grayscale:lj.Grayscale,HSL:uj.HSL,HSV:cj.HSV,Invert:hj.Invert,Kaleidoscope:dj.Kaleidoscope,Mask:fj.Mask,Noise:pj.Noise,Pixelate:gj.Pixelate,Posterize:mj.Posterize,RGB:_j.RGB,RGBA:yj.RGBA,Sepia:vj.Sepia,Solarize:wj.Solarize,Threshold:Sj.Threshold}});var Ej=tS.exports;Object.defineProperty(Ej,"__esModule",{value:!0});const Tj=Zm;tS.exports=Tj.Konva;var Cj=tS.exports;const IC=Ad(Cj);var bv={exports:{}};(function(n,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;var t=om;Object.defineProperty(e,"Konva",{enumerable:!0,get:function(){return t.Konva}});const r=om;n.exports=r.Konva})(bv,bv.exports);var Ij=bv.exports;const Cd=Ad(Ij);var h8={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pj=function(e){var t={},r=we,i=Th,s=Object.assign;function o(a){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+a,f=1;f<arguments.length;f++)l+="&args[]="+encodeURIComponent(arguments[f]);return"Minified React error #"+a+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var u=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,c=Symbol.for("react.element"),d=Symbol.for("react.portal"),p=Symbol.for("react.fragment"),m=Symbol.for("react.strict_mode"),y=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),S=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),k=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),P=Symbol.for("react.offscreen"),V=Symbol.iterator;function z(a){return a===null||typeof a!="object"?null:(a=V&&a[V]||a["@@iterator"],typeof a=="function"?a:null)}function M(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case p:return"Fragment";case d:return"Portal";case y:return"Profiler";case m:return"StrictMode";case D:return"Suspense";case k:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case S:return(a.displayName||"Context")+".Consumer";case E:return(a._context.displayName||"Context")+".Provider";case x:var l=a.render;return a=a.displayName,a||(a=l.displayName||l.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case R:return l=a.displayName||null,l!==null?l:M(a.type)||"Memo";case w:l=a._payload,a=a._init;try{return M(a(l))}catch{}}return null}function C(a){var l=a.type;switch(a.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=l.render,a=a.displayName||a.name||"",l.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return M(l);case 8:return l===m?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function N(a){var l=a,f=a;if(a.alternate)for(;l.return;)l=l.return;else{a=l;do l=a,l.flags&4098&&(f=l.return),a=l.return;while(a)}return l.tag===3?f:null}function A(a){if(N(a)!==a)throw Error(o(188))}function L(a){var l=a.alternate;if(!l){if(l=N(a),l===null)throw Error(o(188));return l!==a?null:a}for(var f=a,g=l;;){var _=f.return;if(_===null)break;var T=_.alternate;if(T===null){if(g=_.return,g!==null){f=g;continue}break}if(_.child===T.child){for(T=_.child;T;){if(T===f)return A(_),a;if(T===g)return A(_),l;T=T.sibling}throw Error(o(188))}if(f.return!==g.return)f=_,g=T;else{for(var b=!1,G=_.child;G;){if(G===f){b=!0,f=_,g=T;break}if(G===g){b=!0,g=_,f=T;break}G=G.sibling}if(!b){for(G=T.child;G;){if(G===f){b=!0,f=T,g=_;break}if(G===g){b=!0,g=T,f=_;break}G=G.sibling}if(!b)throw Error(o(189))}}if(f.alternate!==g)throw Error(o(190))}if(f.tag!==3)throw Error(o(188));return f.stateNode.current===f?a:l}function U(a){return a=L(a),a!==null?F(a):null}function F(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var l=F(a);if(l!==null)return l;a=a.sibling}return null}function pe(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){if(a.tag!==4){var l=pe(a);if(l!==null)return l}a=a.sibling}return null}var Y=Array.isArray,he=e.getPublicInstance,ue=e.getRootHostContext,H=e.getChildHostContext,te=e.prepareForCommit,J=e.resetAfterCommit,ee=e.createInstance,ae=e.appendInitialChild,Ee=e.finalizeInitialChildren,ut=e.prepareUpdate,ct=e.shouldSetTextContent,ht=e.createTextInstance,B=e.scheduleTimeout,re=e.cancelTimeout,ve=e.noTimeout,He=e.isPrimaryRenderer,Ae=e.supportsMutation,it=e.supportsPersistence,at=e.supportsHydration,gr=e.getInstanceFromNode,nt=e.preparePortalMount,si=e.getCurrentEventPriority,xr=e.detachDeletedInstance,Ni=e.supportsMicrotasks,of=e.scheduleMicrotask,ss=e.supportsTestSelectors,af=e.findFiberRoot,$0=e.getBoundingRect,fc=e.getTextContent,os=e.isHiddenSubtree,lf=e.matchAccessibilityRole,cn=e.setFocusIfFocusable,Tn=e.setupIntersectionObserver,El=e.appendChild,uf=e.appendChildToContainer,cf=e.commitTextUpdate,q0=e.commitMount,ha=e.commitUpdate,hf=e.insertBefore,df=e.insertInContainerBefore,pc=e.removeChild,K0=e.removeChildFromContainer,ff=e.resetTextContent,gc=e.hideInstance,pf=e.hideTextInstance,gf=e.unhideInstance,da=e.unhideTextInstance,mc=e.clearContainer,_c=e.cloneInstance,Di=e.createContainerChildSet,yc=e.appendChildToContainerChildSet,Tl=e.finalizeContainerChildren,Cl=e.replaceContainerChildren,eo=e.cloneHiddenInstance,vc=e.cloneHiddenTextInstance,Cn=e.canHydrateInstance,mf=e.canHydrateTextInstance,fa=e.canHydrateSuspenseInstance,to=e.isSuspenseInstancePending,wc=e.isSuspenseInstanceFallback,Q0=e.getSuspenseInstanceFallbackErrorDetails,no=e.registerSuspenseInstanceRetry,Il=e.getNextHydratableSibling,Y0=e.getFirstHydratableChild,Pl=e.getFirstHydratableChildWithinContainer,_f=e.getFirstHydratableChildWithinSuspenseInstance,Sc=e.hydrateInstance,Rl=e.hydrateTextInstance,Mi=e.hydrateSuspenseInstance,yf=e.getNextHydratableInstanceAfterSuspenseInstance,vf=e.commitHydratedContainer,Ec=e.commitHydratedSuspenseInstance,Tc=e.clearSuspenseBoundary,wf=e.clearSuspenseBoundaryFromContainer,Sf=e.shouldDeleteUnhydratedTailInstances,X0=e.didNotMatchHydratedContainerTextInstance,Al=e.didNotMatchHydratedTextInstance,kl;function as(a){if(kl===void 0)try{throw Error()}catch(f){var l=f.stack.trim().match(/\n( *(at )?)/);kl=l&&l[1]||""}return`
`+kl+a}var ls=!1;function oi(a,l){if(!a||ls)return"";ls=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(se){var g=se}Reflect.construct(a,[],l)}else{try{l.call()}catch(se){g=se}a.call(l.prototype)}else{try{throw Error()}catch(se){g=se}a()}}catch(se){if(se&&g&&typeof se.stack=="string"){for(var _=se.stack.split(`
`),T=g.stack.split(`
`),b=_.length-1,G=T.length-1;1<=b&&0<=G&&_[b]!==T[G];)G--;for(;1<=b&&0<=G;b--,G--)if(_[b]!==T[G]){if(b!==1||G!==1)do if(b--,G--,0>G||_[b]!==T[G]){var q=`
`+_[b].replace(" at new "," at ");return a.displayName&&q.includes("<anonymous>")&&(q=q.replace("<anonymous>",a.displayName)),q}while(1<=b&&0<=G);break}}}finally{ls=!1,Error.prepareStackTrace=f}return(a=a?a.displayName||a.name:"")?as(a):""}var Cc=Object.prototype.hasOwnProperty,Ic=[],us=-1;function ai(a){return{current:a}}function dt(a){0>us||(a.current=Ic[us],Ic[us]=null,us--)}function st(a,l){us++,Ic[us]=a.current,a.current=l}var Br={},Jt=ai(Br),In=ai(!1),cs=Br;function ro(a,l){var f=a.type.contextTypes;if(!f)return Br;var g=a.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===l)return g.__reactInternalMemoizedMaskedChildContext;var _={},T;for(T in f)_[T]=l[T];return g&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=l,a.__reactInternalMemoizedMaskedChildContext=_),_}function Pn(a){return a=a.childContextTypes,a!=null}function pa(){dt(In),dt(Jt)}function Ef(a,l,f){if(Jt.current!==Br)throw Error(o(168));st(Jt,l),st(In,f)}function Oi(a,l,f){var g=a.stateNode;if(l=l.childContextTypes,typeof g.getChildContext!="function")return f;g=g.getChildContext();for(var _ in g)if(!(_ in l))throw Error(o(108,C(a)||"Unknown",_));return s({},f,g)}function mr(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Br,cs=Jt.current,st(Jt,a),st(In,In.current),!0}function ga(a,l,f){var g=a.stateNode;if(!g)throw Error(o(169));f?(a=Oi(a,l,cs),g.__reactInternalMemoizedMergedChildContext=a,dt(In),dt(Jt),st(Jt,a)):dt(In),st(In,f)}var Vn=Math.clz32?Math.clz32:xl,Tf=Math.log,mt=Math.LN2;function xl(a){return a>>>=0,a===0?32:31-(Tf(a)/mt|0)|0}var Li=64,bi=4194304;function ma(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function _a(a,l){var f=a.pendingLanes;if(f===0)return 0;var g=0,_=a.suspendedLanes,T=a.pingedLanes,b=f&268435455;if(b!==0){var G=b&~_;G!==0?g=ma(G):(T&=b,T!==0&&(g=ma(T)))}else b=f&~_,b!==0?g=ma(b):T!==0&&(g=ma(T));if(g===0)return 0;if(l!==0&&l!==g&&!(l&_)&&(_=g&-g,T=l&-l,_>=T||_===16&&(T&4194240)!==0))return l;if(g&4&&(g|=f&16),l=a.entangledLanes,l!==0)for(a=a.entanglements,l&=g;0<l;)f=31-Vn(l),_=1<<f,g|=a[f],l&=~_;return g}function J0(a,l){switch(a){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Z0(a,l){for(var f=a.suspendedLanes,g=a.pingedLanes,_=a.expirationTimes,T=a.pendingLanes;0<T;){var b=31-Vn(T),G=1<<b,q=_[b];q===-1?(!(G&f)||G&g)&&(_[b]=J0(G,l)):q<=l&&(a.expiredLanes|=G),T&=~G}}function Pc(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function Cf(){var a=Li;return Li<<=1,!(Li&4194240)&&(Li=64),a}function hs(a){for(var l=[],f=0;31>f;f++)l.push(a);return l}function _r(a,l,f){a.pendingLanes|=l,l!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,l=31-Vn(l),a[l]=f}function If(a,l){var f=a.pendingLanes&~l;a.pendingLanes=l,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=l,a.mutableReadLanes&=l,a.entangledLanes&=l,l=a.entanglements;var g=a.eventTimes;for(a=a.expirationTimes;0<f;){var _=31-Vn(f),T=1<<_;l[_]=0,g[_]=-1,a[_]=-1,f&=~T}}function Nl(a,l){var f=a.entangledLanes|=l;for(a=a.entanglements;f;){var g=31-Vn(f),_=1<<g;_&l|a[g]&l&&(a[g]|=l),f&=~_}}var Ge=0;function ds(a){return a&=-a,1<a?4<a?a&268435455?16:536870912:4:1}var Rc=i.unstable_scheduleCallback,Pf=i.unstable_cancelCallback,e_=i.unstable_shouldYield,Fi=i.unstable_requestPaint,Ht=i.unstable_now,Ac=i.unstable_ImmediatePriority,Dl=i.unstable_UserBlockingPriority,io=i.unstable_NormalPriority,Rf=i.unstable_IdlePriority,Vi=null,Un=null;function Af(a){if(Un&&typeof Un.onCommitFiberRoot=="function")try{Un.onCommitFiberRoot(Vi,a,void 0,(a.current.flags&128)===128)}catch{}}function kc(a,l){return a===l&&(a!==0||1/a===1/l)||a!==a&&l!==l}var $e=typeof Object.is=="function"?Object.is:kc,li=null,Ml=!1,Ol=!1;function xc(a){li===null?li=[a]:li.push(a)}function kf(a){Ml=!0,xc(a)}function ir(){if(!Ol&&li!==null){Ol=!0;var a=0,l=Ge;try{var f=li;for(Ge=1;a<f.length;a++){var g=f[a];do g=g(!0);while(g!==null)}li=null,Ml=!1}catch(_){throw li!==null&&(li=li.slice(a+1)),Rc(Ac,ir),_}finally{Ge=l,Ol=!1}}return null}var fs=[],zn=0,ya=null,Ll=0,hn=[],sr=0,ui=null,yr=1,Gr="";function jr(a,l){fs[zn++]=Ll,fs[zn++]=ya,ya=a,Ll=l}function xf(a,l,f){hn[sr++]=yr,hn[sr++]=Gr,hn[sr++]=ui,ui=a;var g=yr;a=Gr;var _=32-Vn(g)-1;g&=~(1<<_),f+=1;var T=32-Vn(l)+_;if(30<T){var b=_-_%5;T=(g&(1<<b)-1).toString(32),g>>=b,_-=b,yr=1<<32-Vn(l)+_|f<<_|g,Gr=T+a}else yr=1<<T|f<<_|g,Gr=a}function bl(a){a.return!==null&&(jr(a,1),xf(a,1,0))}function ps(a){for(;a===ya;)ya=fs[--zn],fs[zn]=null,Ll=fs[--zn],fs[zn]=null;for(;a===ui;)ui=hn[--sr],hn[sr]=null,Gr=hn[--sr],hn[sr]=null,yr=hn[--sr],hn[sr]=null}var Bn=null,or=null,ft=!1,gs=!1,vr=null;function va(a,l){var f=Kr(5,null,null,0);f.elementType="DELETED",f.stateNode=l,f.return=a,l=a.deletions,l===null?(a.deletions=[f],a.flags|=16):l.push(f)}function Nc(a,l){switch(a.tag){case 5:return l=Cn(l,a.type,a.pendingProps),l!==null?(a.stateNode=l,Bn=a,or=Y0(l),!0):!1;case 6:return l=mf(l,a.pendingProps),l!==null?(a.stateNode=l,Bn=a,or=null,!0):!1;case 13:if(l=fa(l),l!==null){var f=ui!==null?{id:yr,overflow:Gr}:null;return a.memoizedState={dehydrated:l,treeContext:f,retryLane:1073741824},f=Kr(18,null,null,0),f.stateNode=l,f.return=a,a.child=f,Bn=a,or=null,!0}return!1;default:return!1}}function Fl(a){return(a.mode&1)!==0&&(a.flags&128)===0}function ci(a){if(ft){var l=or;if(l){var f=l;if(!Nc(a,l)){if(Fl(a))throw Error(o(418));l=Il(f);var g=Bn;l&&Nc(a,l)?va(g,f):(a.flags=a.flags&-4097|2,ft=!1,Bn=a)}}else{if(Fl(a))throw Error(o(418));a.flags=a.flags&-4097|2,ft=!1,Bn=a}}}function Dc(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;Bn=a}function wa(a){if(!at||a!==Bn)return!1;if(!ft)return Dc(a),ft=!0,!1;if(a.tag!==3&&(a.tag!==5||Sf(a.type)&&!ct(a.type,a.memoizedProps))){var l=or;if(l){if(Fl(a))throw Mc(),Error(o(418));for(;l;)va(a,l),l=Il(l)}}if(Dc(a),a.tag===13){if(!at)throw Error(o(316));if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(o(317));or=yf(a)}else or=Bn?Il(a.stateNode):null;return!0}function Mc(){for(var a=or;a;)a=Il(a)}function ms(){at&&(or=Bn=null,gs=ft=!1)}function so(a){vr===null?vr=[a]:vr.push(a)}var ar=u.ReactCurrentBatchConfig;function Sa(a,l){if($e(a,l))return!0;if(typeof a!="object"||a===null||typeof l!="object"||l===null)return!1;var f=Object.keys(a),g=Object.keys(l);if(f.length!==g.length)return!1;for(g=0;g<f.length;g++){var _=f[g];if(!Cc.call(l,_)||!$e(a[_],l[_]))return!1}return!0}function Nf(a){switch(a.tag){case 5:return as(a.type);case 16:return as("Lazy");case 13:return as("Suspense");case 19:return as("SuspenseList");case 0:case 2:case 15:return a=oi(a.type,!1),a;case 11:return a=oi(a.type.render,!1),a;case 1:return a=oi(a.type,!0),a;default:return""}}function Wr(a,l,f){if(a=f.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(f._owner){if(f=f._owner,f){if(f.tag!==1)throw Error(o(309));var g=f.stateNode}if(!g)throw Error(o(147,a));var _=g,T=""+a;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===T?l.ref:(l=function(b){var G=_.refs;b===null?delete G[T]:G[T]=b},l._stringRef=T,l)}if(typeof a!="string")throw Error(o(284));if(!f._owner)throw Error(o(290,a))}return a}function h(a,l){throw a=Object.prototype.toString.call(l),Error(o(31,a==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":a))}function v(a){var l=a._init;return l(a._payload)}function I(a){function l($,j){if(a){var Q=$.deletions;Q===null?($.deletions=[j],$.flags|=16):Q.push(j)}}function f($,j){if(!a)return null;for(;j!==null;)l($,j),j=j.sibling;return null}function g($,j){for($=new Map;j!==null;)j.key!==null?$.set(j.key,j):$.set(j.index,j),j=j.sibling;return $}function _($,j){return $=fo($,j),$.index=0,$.sibling=null,$}function T($,j,Q){return $.index=Q,a?(Q=$.alternate,Q!==null?(Q=Q.index,Q<j?($.flags|=2,j):Q):($.flags|=2,j)):($.flags|=1048576,j)}function b($){return a&&$.alternate===null&&($.flags|=2),$}function G($,j,Q,de){return j===null||j.tag!==6?(j=H_(Q,$.mode,de),j.return=$,j):(j=_(j,Q),j.return=$,j)}function q($,j,Q,de){var Te=Q.type;return Te===p?_e($,j,Q.props.children,de,Q.key):j!==null&&(j.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===w&&v(Te)===j.type)?(de=_(j,Q.props),de.ref=Wr($,j,Q),de.return=$,de):(de=op(Q.type,Q.key,Q.props,null,$.mode,de),de.ref=Wr($,j,Q),de.return=$,de)}function se($,j,Q,de){return j===null||j.tag!==4||j.stateNode.containerInfo!==Q.containerInfo||j.stateNode.implementation!==Q.implementation?(j=$_(Q,$.mode,de),j.return=$,j):(j=_(j,Q.children||[]),j.return=$,j)}function _e($,j,Q,de,Te){return j===null||j.tag!==7?(j=Ra(Q,$.mode,de,Te),j.return=$,j):(j=_(j,Q),j.return=$,j)}function Ne($,j,Q){if(typeof j=="string"&&j!==""||typeof j=="number")return j=H_(""+j,$.mode,Q),j.return=$,j;if(typeof j=="object"&&j!==null){switch(j.$$typeof){case c:return Q=op(j.type,j.key,j.props,null,$.mode,Q),Q.ref=Wr($,null,j),Q.return=$,Q;case d:return j=$_(j,$.mode,Q),j.return=$,j;case w:var de=j._init;return Ne($,de(j._payload),Q)}if(Y(j)||z(j))return j=Ra(j,$.mode,Q,null),j.return=$,j;h($,j)}return null}function ce($,j,Q,de){var Te=j!==null?j.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number")return Te!==null?null:G($,j,""+Q,de);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case c:return Q.key===Te?q($,j,Q,de):null;case d:return Q.key===Te?se($,j,Q,de):null;case w:return Te=Q._init,ce($,j,Te(Q._payload),de)}if(Y(Q)||z(Q))return Te!==null?null:_e($,j,Q,de,null);h($,Q)}return null}function St($,j,Q,de,Te){if(typeof de=="string"&&de!==""||typeof de=="number")return $=$.get(Q)||null,G(j,$,""+de,Te);if(typeof de=="object"&&de!==null){switch(de.$$typeof){case c:return $=$.get(de.key===null?Q:de.key)||null,q(j,$,de,Te);case d:return $=$.get(de.key===null?Q:de.key)||null,se(j,$,de,Te);case w:var Me=de._init;return St($,j,Q,Me(de._payload),Te)}if(Y(de)||z(de))return $=$.get(Q)||null,_e(j,$,de,Te,null);h(j,de)}return null}function _t($,j,Q,de){for(var Te=null,Me=null,De=j,Ze=j=0,gn=null;De!==null&&Ze<Q.length;Ze++){De.index>Ze?(gn=De,De=null):gn=De.sibling;var et=ce($,De,Q[Ze],de);if(et===null){De===null&&(De=gn);break}a&&De&&et.alternate===null&&l($,De),j=T(et,j,Ze),Me===null?Te=et:Me.sibling=et,Me=et,De=gn}if(Ze===Q.length)return f($,De),ft&&jr($,Ze),Te;if(De===null){for(;Ze<Q.length;Ze++)De=Ne($,Q[Ze],de),De!==null&&(j=T(De,j,Ze),Me===null?Te=De:Me.sibling=De,Me=De);return ft&&jr($,Ze),Te}for(De=g($,De);Ze<Q.length;Ze++)gn=St(De,$,Ze,Q[Ze],de),gn!==null&&(a&&gn.alternate!==null&&De.delete(gn.key===null?Ze:gn.key),j=T(gn,j,Ze),Me===null?Te=gn:Me.sibling=gn,Me=gn);return a&&De.forEach(function(po){return l($,po)}),ft&&jr($,Ze),Te}function Tr($,j,Q,de){var Te=z(Q);if(typeof Te!="function")throw Error(o(150));if(Q=Te.call(Q),Q==null)throw Error(o(151));for(var Me=Te=null,De=j,Ze=j=0,gn=null,et=Q.next();De!==null&&!et.done;Ze++,et=Q.next()){De.index>Ze?(gn=De,De=null):gn=De.sibling;var po=ce($,De,et.value,de);if(po===null){De===null&&(De=gn);break}a&&De&&po.alternate===null&&l($,De),j=T(po,j,Ze),Me===null?Te=po:Me.sibling=po,Me=po,De=gn}if(et.done)return f($,De),ft&&jr($,Ze),Te;if(De===null){for(;!et.done;Ze++,et=Q.next())et=Ne($,et.value,de),et!==null&&(j=T(et,j,Ze),Me===null?Te=et:Me.sibling=et,Me=et);return ft&&jr($,Ze),Te}for(De=g($,De);!et.done;Ze++,et=Q.next())et=St(De,$,Ze,et.value,de),et!==null&&(a&&et.alternate!==null&&De.delete(et.key===null?Ze:et.key),j=T(et,j,Ze),Me===null?Te=et:Me.sibling=et,Me=et);return a&&De.forEach(function(nA){return l($,nA)}),ft&&jr($,Ze),Te}function ws($,j,Q,de){if(typeof Q=="object"&&Q!==null&&Q.type===p&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case c:e:{for(var Te=Q.key,Me=j;Me!==null;){if(Me.key===Te){if(Te=Q.type,Te===p){if(Me.tag===7){f($,Me.sibling),j=_(Me,Q.props.children),j.return=$,$=j;break e}}else if(Me.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===w&&v(Te)===Me.type){f($,Me.sibling),j=_(Me,Q.props),j.ref=Wr($,Me,Q),j.return=$,$=j;break e}f($,Me);break}else l($,Me);Me=Me.sibling}Q.type===p?(j=Ra(Q.props.children,$.mode,de,Q.key),j.return=$,$=j):(de=op(Q.type,Q.key,Q.props,null,$.mode,de),de.ref=Wr($,j,Q),de.return=$,$=de)}return b($);case d:e:{for(Me=Q.key;j!==null;){if(j.key===Me)if(j.tag===4&&j.stateNode.containerInfo===Q.containerInfo&&j.stateNode.implementation===Q.implementation){f($,j.sibling),j=_(j,Q.children||[]),j.return=$,$=j;break e}else{f($,j);break}else l($,j);j=j.sibling}j=$_(Q,$.mode,de),j.return=$,$=j}return b($);case w:return Me=Q._init,ws($,j,Me(Q._payload),de)}if(Y(Q))return _t($,j,Q,de);if(z(Q))return Tr($,j,Q,de);h($,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"?(Q=""+Q,j!==null&&j.tag===6?(f($,j.sibling),j=_(j,Q),j.return=$,$=j):(f($,j),j=H_(Q,$.mode,de),j.return=$,$=j),b($)):f($,j)}return ws}var O=I(!0),W=I(!1),K=ai(null),oe=null,qe=null,zt=null;function Ve(){zt=qe=oe=null}function Zt(a,l,f){He?(st(K,l._currentValue),l._currentValue=f):(st(K,l._currentValue2),l._currentValue2=f)}function $t(a){var l=K.current;dt(K),He?a._currentValue=l:a._currentValue2=l}function Ui(a,l,f){for(;a!==null;){var g=a.alternate;if((a.childLanes&l)!==l?(a.childLanes|=l,g!==null&&(g.childLanes|=l)):g!==null&&(g.childLanes&l)!==l&&(g.childLanes|=l),a===f)break;a=a.return}}function dn(a,l){oe=a,zt=qe=null,a=a.dependencies,a!==null&&a.firstContext!==null&&(a.lanes&l&&(wr=!0),a.firstContext=null)}function Rn(a){var l=He?a._currentValue:a._currentValue2;if(zt!==a)if(a={context:a,memoizedValue:l,next:null},qe===null){if(oe===null)throw Error(o(308));qe=a,oe.dependencies={lanes:0,firstContext:a}}else qe=qe.next=a;return l}var hi=null;function t_(a){hi===null?hi=[a]:hi.push(a)}function wS(a,l,f,g){var _=l.interleaved;return _===null?(f.next=f,t_(l)):(f.next=_.next,_.next=f),l.interleaved=f,zi(a,g)}function zi(a,l){a.lanes|=l;var f=a.alternate;for(f!==null&&(f.lanes|=l),f=a,a=a.return;a!==null;)a.childLanes|=l,f=a.alternate,f!==null&&(f.childLanes|=l),f=a,a=a.return;return f.tag===3?f.stateNode:null}var oo=!1;function n_(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function SS(a,l){a=a.updateQueue,l.updateQueue===a&&(l.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function _s(a,l){return{eventTime:a,lane:l,tag:0,payload:null,callback:null,next:null}}function ao(a,l,f){var g=a.updateQueue;if(g===null)return null;if(g=g.shared,Le&2){var _=g.pending;return _===null?l.next=l:(l.next=_.next,_.next=l),g.pending=l,zi(a,f)}return _=g.interleaved,_===null?(l.next=l,t_(g)):(l.next=_.next,_.next=l),g.interleaved=l,zi(a,f)}function Df(a,l,f){if(l=l.updateQueue,l!==null&&(l=l.shared,(f&4194240)!==0)){var g=l.lanes;g&=a.pendingLanes,f|=g,l.lanes=f,Nl(a,f)}}function ES(a,l){var f=a.updateQueue,g=a.alternate;if(g!==null&&(g=g.updateQueue,f===g)){var _=null,T=null;if(f=f.firstBaseUpdate,f!==null){do{var b={eventTime:f.eventTime,lane:f.lane,tag:f.tag,payload:f.payload,callback:f.callback,next:null};T===null?_=T=b:T=T.next=b,f=f.next}while(f!==null);T===null?_=T=l:T=T.next=l}else _=T=l;f={baseState:g.baseState,firstBaseUpdate:_,lastBaseUpdate:T,shared:g.shared,effects:g.effects},a.updateQueue=f;return}a=f.lastBaseUpdate,a===null?f.firstBaseUpdate=l:a.next=l,f.lastBaseUpdate=l}function Mf(a,l,f,g){var _=a.updateQueue;oo=!1;var T=_.firstBaseUpdate,b=_.lastBaseUpdate,G=_.shared.pending;if(G!==null){_.shared.pending=null;var q=G,se=q.next;q.next=null,b===null?T=se:b.next=se,b=q;var _e=a.alternate;_e!==null&&(_e=_e.updateQueue,G=_e.lastBaseUpdate,G!==b&&(G===null?_e.firstBaseUpdate=se:G.next=se,_e.lastBaseUpdate=q))}if(T!==null){var Ne=_.baseState;b=0,_e=se=q=null,G=T;do{var ce=G.lane,St=G.eventTime;if((g&ce)===ce){_e!==null&&(_e=_e.next={eventTime:St,lane:0,tag:G.tag,payload:G.payload,callback:G.callback,next:null});e:{var _t=a,Tr=G;switch(ce=l,St=f,Tr.tag){case 1:if(_t=Tr.payload,typeof _t=="function"){Ne=_t.call(St,Ne,ce);break e}Ne=_t;break e;case 3:_t.flags=_t.flags&-65537|128;case 0:if(_t=Tr.payload,ce=typeof _t=="function"?_t.call(St,Ne,ce):_t,ce==null)break e;Ne=s({},Ne,ce);break e;case 2:oo=!0}}G.callback!==null&&G.lane!==0&&(a.flags|=64,ce=_.effects,ce===null?_.effects=[G]:ce.push(G))}else St={eventTime:St,lane:ce,tag:G.tag,payload:G.payload,callback:G.callback,next:null},_e===null?(se=_e=St,q=Ne):_e=_e.next=St,b|=ce;if(G=G.next,G===null){if(G=_.shared.pending,G===null)break;ce=G,G=ce.next,ce.next=null,_.lastBaseUpdate=ce,_.shared.pending=null}}while(!0);if(_e===null&&(q=Ne),_.baseState=q,_.firstBaseUpdate=se,_.lastBaseUpdate=_e,l=_.shared.interleaved,l!==null){_=l;do b|=_.lane,_=_.next;while(_!==l)}else T===null&&(_.shared.lanes=0);Ta|=b,a.lanes=b,a.memoizedState=Ne}}function TS(a,l,f){if(a=l.effects,l.effects=null,a!==null)for(l=0;l<a.length;l++){var g=a[l],_=g.callback;if(_!==null){if(g.callback=null,g=f,typeof _!="function")throw Error(o(191,_));_.call(g)}}}var Oc={},Hr=ai(Oc),Lc=ai(Oc),Vl=ai(Oc);function Bi(a){if(a===Oc)throw Error(o(174));return a}function r_(a,l){st(Vl,l),st(Lc,a),st(Hr,Oc),a=ue(l),dt(Hr),st(Hr,a)}function Ul(){dt(Hr),dt(Lc),dt(Vl)}function CS(a){var l=Bi(Vl.current),f=Bi(Hr.current);l=H(f,a.type,l),f!==l&&(st(Lc,a),st(Hr,l))}function i_(a){Lc.current===a&&(dt(Hr),dt(Lc))}var xt=ai(0);function Of(a){for(var l=a;l!==null;){if(l.tag===13){var f=l.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||to(f)||wc(f)))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if(l.flags&128)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var s_=[];function o_(){for(var a=0;a<s_.length;a++){var l=s_[a];He?l._workInProgressVersionPrimary=null:l._workInProgressVersionSecondary=null}s_.length=0}var Lf=u.ReactCurrentDispatcher,a_=u.ReactCurrentBatchConfig,Ea=0,Nt=null,en=null,fn=null,bf=!1,bc=!1,Fc=0,R8=0;function Gn(){throw Error(o(321))}function l_(a,l){if(l===null)return!1;for(var f=0;f<l.length&&f<a.length;f++)if(!$e(a[f],l[f]))return!1;return!0}function u_(a,l,f,g,_,T){if(Ea=T,Nt=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,Lf.current=a===null||a.memoizedState===null?N8:D8,a=f(g,_),bc){T=0;do{if(bc=!1,Fc=0,25<=T)throw Error(o(301));T+=1,fn=en=null,l.updateQueue=null,Lf.current=M8,a=f(g,_)}while(bc)}if(Lf.current=Uf,l=en!==null&&en.next!==null,Ea=0,fn=en=Nt=null,bf=!1,l)throw Error(o(300));return a}function c_(){var a=Fc!==0;return Fc=0,a}function Gi(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fn===null?Nt.memoizedState=fn=a:fn=fn.next=a,fn}function $r(){if(en===null){var a=Nt.alternate;a=a!==null?a.memoizedState:null}else a=en.next;var l=fn===null?Nt.memoizedState:fn.next;if(l!==null)fn=l,en=a;else{if(a===null)throw Error(o(310));en=a,a={memoizedState:en.memoizedState,baseState:en.baseState,baseQueue:en.baseQueue,queue:en.queue,next:null},fn===null?Nt.memoizedState=fn=a:fn=fn.next=a}return fn}function Vc(a,l){return typeof l=="function"?l(a):l}function h_(a){var l=$r(),f=l.queue;if(f===null)throw Error(o(311));f.lastRenderedReducer=a;var g=en,_=g.baseQueue,T=f.pending;if(T!==null){if(_!==null){var b=_.next;_.next=T.next,T.next=b}g.baseQueue=_=T,f.pending=null}if(_!==null){T=_.next,g=g.baseState;var G=b=null,q=null,se=T;do{var _e=se.lane;if((Ea&_e)===_e)q!==null&&(q=q.next={lane:0,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null}),g=se.hasEagerState?se.eagerState:a(g,se.action);else{var Ne={lane:_e,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null};q===null?(G=q=Ne,b=g):q=q.next=Ne,Nt.lanes|=_e,Ta|=_e}se=se.next}while(se!==null&&se!==T);q===null?b=g:q.next=G,$e(g,l.memoizedState)||(wr=!0),l.memoizedState=g,l.baseState=b,l.baseQueue=q,f.lastRenderedState=g}if(a=f.interleaved,a!==null){_=a;do T=_.lane,Nt.lanes|=T,Ta|=T,_=_.next;while(_!==a)}else _===null&&(f.lanes=0);return[l.memoizedState,f.dispatch]}function d_(a){var l=$r(),f=l.queue;if(f===null)throw Error(o(311));f.lastRenderedReducer=a;var g=f.dispatch,_=f.pending,T=l.memoizedState;if(_!==null){f.pending=null;var b=_=_.next;do T=a(T,b.action),b=b.next;while(b!==_);$e(T,l.memoizedState)||(wr=!0),l.memoizedState=T,l.baseQueue===null&&(l.baseState=T),f.lastRenderedState=T}return[T,g]}function IS(){}function PS(a,l){var f=Nt,g=$r(),_=l(),T=!$e(g.memoizedState,_);if(T&&(g.memoizedState=_,wr=!0),g=g.queue,f_(kS.bind(null,f,g,a),[a]),g.getSnapshot!==l||T||fn!==null&&fn.memoizedState.tag&1){if(f.flags|=2048,Uc(9,AS.bind(null,f,g,_,l),void 0,null),pn===null)throw Error(o(349));Ea&30||RS(f,l,_)}return _}function RS(a,l,f){a.flags|=16384,a={getSnapshot:l,value:f},l=Nt.updateQueue,l===null?(l={lastEffect:null,stores:null},Nt.updateQueue=l,l.stores=[a]):(f=l.stores,f===null?l.stores=[a]:f.push(a))}function AS(a,l,f,g){l.value=f,l.getSnapshot=g,xS(l)&&NS(a)}function kS(a,l,f){return f(function(){xS(l)&&NS(a)})}function xS(a){var l=a.getSnapshot;a=a.value;try{var f=l();return!$e(a,f)}catch{return!0}}function NS(a){var l=zi(a,1);l!==null&&qr(l,a,1,-1)}function DS(a){var l=Gi();return typeof a=="function"&&(a=a()),l.memoizedState=l.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vc,lastRenderedState:a},l.queue=a,a=a.dispatch=x8.bind(null,Nt,a),[l.memoizedState,a]}function Uc(a,l,f,g){return a={tag:a,create:l,destroy:f,deps:g,next:null},l=Nt.updateQueue,l===null?(l={lastEffect:null,stores:null},Nt.updateQueue=l,l.lastEffect=a.next=a):(f=l.lastEffect,f===null?l.lastEffect=a.next=a:(g=f.next,f.next=a,a.next=g,l.lastEffect=a)),a}function MS(){return $r().memoizedState}function Ff(a,l,f,g){var _=Gi();Nt.flags|=a,_.memoizedState=Uc(1|l,f,void 0,g===void 0?null:g)}function Vf(a,l,f,g){var _=$r();g=g===void 0?null:g;var T=void 0;if(en!==null){var b=en.memoizedState;if(T=b.destroy,g!==null&&l_(g,b.deps)){_.memoizedState=Uc(l,f,T,g);return}}Nt.flags|=a,_.memoizedState=Uc(1|l,f,T,g)}function OS(a,l){return Ff(8390656,8,a,l)}function f_(a,l){return Vf(2048,8,a,l)}function LS(a,l){return Vf(4,2,a,l)}function bS(a,l){return Vf(4,4,a,l)}function FS(a,l){if(typeof l=="function")return a=a(),l(a),function(){l(null)};if(l!=null)return a=a(),l.current=a,function(){l.current=null}}function VS(a,l,f){return f=f!=null?f.concat([a]):null,Vf(4,4,FS.bind(null,l,a),f)}function p_(){}function US(a,l){var f=$r();l=l===void 0?null:l;var g=f.memoizedState;return g!==null&&l!==null&&l_(l,g[1])?g[0]:(f.memoizedState=[a,l],a)}function zS(a,l){var f=$r();l=l===void 0?null:l;var g=f.memoizedState;return g!==null&&l!==null&&l_(l,g[1])?g[0]:(a=a(),f.memoizedState=[a,l],a)}function BS(a,l,f){return Ea&21?($e(f,l)||(f=Cf(),Nt.lanes|=f,Ta|=f,a.baseState=!0),l):(a.baseState&&(a.baseState=!1,wr=!0),a.memoizedState=f)}function A8(a,l){var f=Ge;Ge=f!==0&&4>f?f:4,a(!0);var g=a_.transition;a_.transition={};try{a(!1),l()}finally{Ge=f,a_.transition=g}}function GS(){return $r().memoizedState}function k8(a,l,f){var g=co(a);if(f={lane:g,action:f,hasEagerState:!1,eagerState:null,next:null},jS(a))WS(l,f);else if(f=wS(a,l,f,g),f!==null){var _=Hn();qr(f,a,g,_),HS(f,l,g)}}function x8(a,l,f){var g=co(a),_={lane:g,action:f,hasEagerState:!1,eagerState:null,next:null};if(jS(a))WS(l,_);else{var T=a.alternate;if(a.lanes===0&&(T===null||T.lanes===0)&&(T=l.lastRenderedReducer,T!==null))try{var b=l.lastRenderedState,G=T(b,f);if(_.hasEagerState=!0,_.eagerState=G,$e(G,b)){var q=l.interleaved;q===null?(_.next=_,t_(l)):(_.next=q.next,q.next=_),l.interleaved=_;return}}catch{}finally{}f=wS(a,l,_,g),f!==null&&(_=Hn(),qr(f,a,g,_),HS(f,l,g))}}function jS(a){var l=a.alternate;return a===Nt||l!==null&&l===Nt}function WS(a,l){bc=bf=!0;var f=a.pending;f===null?l.next=l:(l.next=f.next,f.next=l),a.pending=l}function HS(a,l,f){if(f&4194240){var g=l.lanes;g&=a.pendingLanes,f|=g,l.lanes=f,Nl(a,f)}}var Uf={readContext:Rn,useCallback:Gn,useContext:Gn,useEffect:Gn,useImperativeHandle:Gn,useInsertionEffect:Gn,useLayoutEffect:Gn,useMemo:Gn,useReducer:Gn,useRef:Gn,useState:Gn,useDebugValue:Gn,useDeferredValue:Gn,useTransition:Gn,useMutableSource:Gn,useSyncExternalStore:Gn,useId:Gn,unstable_isNewReconciler:!1},N8={readContext:Rn,useCallback:function(a,l){return Gi().memoizedState=[a,l===void 0?null:l],a},useContext:Rn,useEffect:OS,useImperativeHandle:function(a,l,f){return f=f!=null?f.concat([a]):null,Ff(4194308,4,FS.bind(null,l,a),f)},useLayoutEffect:function(a,l){return Ff(4194308,4,a,l)},useInsertionEffect:function(a,l){return Ff(4,2,a,l)},useMemo:function(a,l){var f=Gi();return l=l===void 0?null:l,a=a(),f.memoizedState=[a,l],a},useReducer:function(a,l,f){var g=Gi();return l=f!==void 0?f(l):l,g.memoizedState=g.baseState=l,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:l},g.queue=a,a=a.dispatch=k8.bind(null,Nt,a),[g.memoizedState,a]},useRef:function(a){var l=Gi();return a={current:a},l.memoizedState=a},useState:DS,useDebugValue:p_,useDeferredValue:function(a){return Gi().memoizedState=a},useTransition:function(){var a=DS(!1),l=a[0];return a=A8.bind(null,a[1]),Gi().memoizedState=a,[l,a]},useMutableSource:function(){},useSyncExternalStore:function(a,l,f){var g=Nt,_=Gi();if(ft){if(f===void 0)throw Error(o(407));f=f()}else{if(f=l(),pn===null)throw Error(o(349));Ea&30||RS(g,l,f)}_.memoizedState=f;var T={value:f,getSnapshot:l};return _.queue=T,OS(kS.bind(null,g,T,a),[a]),g.flags|=2048,Uc(9,AS.bind(null,g,T,f,l),void 0,null),f},useId:function(){var a=Gi(),l=pn.identifierPrefix;if(ft){var f=Gr,g=yr;f=(g&~(1<<32-Vn(g)-1)).toString(32)+f,l=":"+l+"R"+f,f=Fc++,0<f&&(l+="H"+f.toString(32)),l+=":"}else f=R8++,l=":"+l+"r"+f.toString(32)+":";return a.memoizedState=l},unstable_isNewReconciler:!1},D8={readContext:Rn,useCallback:US,useContext:Rn,useEffect:f_,useImperativeHandle:VS,useInsertionEffect:LS,useLayoutEffect:bS,useMemo:zS,useReducer:h_,useRef:MS,useState:function(){return h_(Vc)},useDebugValue:p_,useDeferredValue:function(a){var l=$r();return BS(l,en.memoizedState,a)},useTransition:function(){var a=h_(Vc)[0],l=$r().memoizedState;return[a,l]},useMutableSource:IS,useSyncExternalStore:PS,useId:GS,unstable_isNewReconciler:!1},M8={readContext:Rn,useCallback:US,useContext:Rn,useEffect:f_,useImperativeHandle:VS,useInsertionEffect:LS,useLayoutEffect:bS,useMemo:zS,useReducer:d_,useRef:MS,useState:function(){return d_(Vc)},useDebugValue:p_,useDeferredValue:function(a){var l=$r();return en===null?l.memoizedState=a:BS(l,en.memoizedState,a)},useTransition:function(){var a=d_(Vc)[0],l=$r().memoizedState;return[a,l]},useMutableSource:IS,useSyncExternalStore:PS,useId:GS,unstable_isNewReconciler:!1};function di(a,l){if(a&&a.defaultProps){l=s({},l),a=a.defaultProps;for(var f in a)l[f]===void 0&&(l[f]=a[f]);return l}return l}function g_(a,l,f,g){l=a.memoizedState,f=f(g,l),f=f==null?l:s({},l,f),a.memoizedState=f,a.lanes===0&&(a.updateQueue.baseState=f)}var zf={isMounted:function(a){return(a=a._reactInternals)?N(a)===a:!1},enqueueSetState:function(a,l,f){a=a._reactInternals;var g=Hn(),_=co(a),T=_s(g,_);T.payload=l,f!=null&&(T.callback=f),l=ao(a,T,_),l!==null&&(qr(l,a,_,g),Df(l,a,_))},enqueueReplaceState:function(a,l,f){a=a._reactInternals;var g=Hn(),_=co(a),T=_s(g,_);T.tag=1,T.payload=l,f!=null&&(T.callback=f),l=ao(a,T,_),l!==null&&(qr(l,a,_,g),Df(l,a,_))},enqueueForceUpdate:function(a,l){a=a._reactInternals;var f=Hn(),g=co(a),_=_s(f,g);_.tag=2,l!=null&&(_.callback=l),l=ao(a,_,g),l!==null&&(qr(l,a,g,f),Df(l,a,g))}};function $S(a,l,f,g,_,T,b){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(g,T,b):l.prototype&&l.prototype.isPureReactComponent?!Sa(f,g)||!Sa(_,T):!0}function qS(a,l,f){var g=!1,_=Br,T=l.contextType;return typeof T=="object"&&T!==null?T=Rn(T):(_=Pn(l)?cs:Jt.current,g=l.contextTypes,T=(g=g!=null)?ro(a,_):Br),l=new l(f,T),a.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=zf,a.stateNode=l,l._reactInternals=a,g&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=_,a.__reactInternalMemoizedMaskedChildContext=T),l}function KS(a,l,f,g){a=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(f,g),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(f,g),l.state!==a&&zf.enqueueReplaceState(l,l.state,null)}function m_(a,l,f,g){var _=a.stateNode;_.props=f,_.state=a.memoizedState,_.refs={},n_(a);var T=l.contextType;typeof T=="object"&&T!==null?_.context=Rn(T):(T=Pn(l)?cs:Jt.current,_.context=ro(a,T)),_.state=a.memoizedState,T=l.getDerivedStateFromProps,typeof T=="function"&&(g_(a,l,T,f),_.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(l=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),l!==_.state&&zf.enqueueReplaceState(_,_.state,null),Mf(a,f,_,g),_.state=a.memoizedState),typeof _.componentDidMount=="function"&&(a.flags|=4194308)}function zl(a,l){try{var f="",g=l;do f+=Nf(g),g=g.return;while(g);var _=f}catch(T){_=`
Error generating stack: `+T.message+`
`+T.stack}return{value:a,source:l,stack:_,digest:null}}function __(a,l,f){return{value:a,source:null,stack:f??null,digest:l??null}}function y_(a,l){try{console.error(l.value)}catch(f){setTimeout(function(){throw f})}}var O8=typeof WeakMap=="function"?WeakMap:Map;function QS(a,l,f){f=_s(-1,f),f.tag=3,f.payload={element:null};var g=l.value;return f.callback=function(){ep||(ep=!0,V_=g),y_(a,l)},f}function YS(a,l,f){f=_s(-1,f),f.tag=3;var g=a.type.getDerivedStateFromError;if(typeof g=="function"){var _=l.value;f.payload=function(){return g(_)},f.callback=function(){y_(a,l)}}var T=a.stateNode;return T!==null&&typeof T.componentDidCatch=="function"&&(f.callback=function(){y_(a,l),typeof g!="function"&&(lo===null?lo=new Set([this]):lo.add(this));var b=l.stack;this.componentDidCatch(l.value,{componentStack:b!==null?b:""})}),f}function XS(a,l,f){var g=a.pingCache;if(g===null){g=a.pingCache=new O8;var _=new Set;g.set(l,_)}else _=g.get(l),_===void 0&&(_=new Set,g.set(l,_));_.has(f)||(_.add(f),a=K8.bind(null,a,l,f),l.then(a,a))}function JS(a){do{var l;if((l=a.tag===13)&&(l=a.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return a;a=a.return}while(a!==null);return null}function ZS(a,l,f,g,_){return a.mode&1?(a.flags|=65536,a.lanes=_,a):(a===l?a.flags|=65536:(a.flags|=128,f.flags|=131072,f.flags&=-52805,f.tag===1&&(f.alternate===null?f.tag=17:(l=_s(-1,1),l.tag=2,ao(f,l,1))),f.lanes|=1),a)}var L8=u.ReactCurrentOwner,wr=!1;function lr(a,l,f,g){l.child=a===null?W(l,null,f,g):O(l,a.child,f,g)}function eE(a,l,f,g,_){f=f.render;var T=l.ref;return dn(l,_),g=u_(a,l,f,g,T,_),f=c_(),a!==null&&!wr?(l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~_,ys(a,l,_)):(ft&&f&&bl(l),l.flags|=1,lr(a,l,g,_),l.child)}function tE(a,l,f,g,_){if(a===null){var T=f.type;return typeof T=="function"&&!W_(T)&&T.defaultProps===void 0&&f.compare===null&&f.defaultProps===void 0?(l.tag=15,l.type=T,nE(a,l,T,g,_)):(a=op(f.type,null,g,l,l.mode,_),a.ref=l.ref,a.return=l,l.child=a)}if(T=a.child,!(a.lanes&_)){var b=T.memoizedProps;if(f=f.compare,f=f!==null?f:Sa,f(b,g)&&a.ref===l.ref)return ys(a,l,_)}return l.flags|=1,a=fo(T,g),a.ref=l.ref,a.return=l,l.child=a}function nE(a,l,f,g,_){if(a!==null){var T=a.memoizedProps;if(Sa(T,g)&&a.ref===l.ref)if(wr=!1,l.pendingProps=g=T,(a.lanes&_)!==0)a.flags&131072&&(wr=!0);else return l.lanes=a.lanes,ys(a,l,_)}return v_(a,l,f,g,_)}function rE(a,l,f){var g=l.pendingProps,_=g.children,T=a!==null?a.memoizedState:null;if(g.mode==="hidden")if(!(l.mode&1))l.memoizedState={baseLanes:0,cachePool:null,transitions:null},st(Gl,Nr),Nr|=f;else{if(!(f&1073741824))return a=T!==null?T.baseLanes|f:f,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:a,cachePool:null,transitions:null},l.updateQueue=null,st(Gl,Nr),Nr|=a,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=T!==null?T.baseLanes:f,st(Gl,Nr),Nr|=g}else T!==null?(g=T.baseLanes|f,l.memoizedState=null):g=f,st(Gl,Nr),Nr|=g;return lr(a,l,_,f),l.child}function iE(a,l){var f=l.ref;(a===null&&f!==null||a!==null&&a.ref!==f)&&(l.flags|=512,l.flags|=2097152)}function v_(a,l,f,g,_){var T=Pn(f)?cs:Jt.current;return T=ro(l,T),dn(l,_),f=u_(a,l,f,g,T,_),g=c_(),a!==null&&!wr?(l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~_,ys(a,l,_)):(ft&&g&&bl(l),l.flags|=1,lr(a,l,f,_),l.child)}function sE(a,l,f,g,_){if(Pn(f)){var T=!0;mr(l)}else T=!1;if(dn(l,_),l.stateNode===null)Gf(a,l),qS(l,f,g),m_(l,f,g,_),g=!0;else if(a===null){var b=l.stateNode,G=l.memoizedProps;b.props=G;var q=b.context,se=f.contextType;typeof se=="object"&&se!==null?se=Rn(se):(se=Pn(f)?cs:Jt.current,se=ro(l,se));var _e=f.getDerivedStateFromProps,Ne=typeof _e=="function"||typeof b.getSnapshotBeforeUpdate=="function";Ne||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(G!==g||q!==se)&&KS(l,b,g,se),oo=!1;var ce=l.memoizedState;b.state=ce,Mf(l,g,b,_),q=l.memoizedState,G!==g||ce!==q||In.current||oo?(typeof _e=="function"&&(g_(l,f,_e,g),q=l.memoizedState),(G=oo||$S(l,f,G,g,ce,q,se))?(Ne||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(l.flags|=4194308)):(typeof b.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=g,l.memoizedState=q),b.props=g,b.state=q,b.context=se,g=G):(typeof b.componentDidMount=="function"&&(l.flags|=4194308),g=!1)}else{b=l.stateNode,SS(a,l),G=l.memoizedProps,se=l.type===l.elementType?G:di(l.type,G),b.props=se,Ne=l.pendingProps,ce=b.context,q=f.contextType,typeof q=="object"&&q!==null?q=Rn(q):(q=Pn(f)?cs:Jt.current,q=ro(l,q));var St=f.getDerivedStateFromProps;(_e=typeof St=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(G!==Ne||ce!==q)&&KS(l,b,g,q),oo=!1,ce=l.memoizedState,b.state=ce,Mf(l,g,b,_);var _t=l.memoizedState;G!==Ne||ce!==_t||In.current||oo?(typeof St=="function"&&(g_(l,f,St,g),_t=l.memoizedState),(se=oo||$S(l,f,se,g,ce,_t,q)||!1)?(_e||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(g,_t,q),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(g,_t,q)),typeof b.componentDidUpdate=="function"&&(l.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof b.componentDidUpdate!="function"||G===a.memoizedProps&&ce===a.memoizedState||(l.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||G===a.memoizedProps&&ce===a.memoizedState||(l.flags|=1024),l.memoizedProps=g,l.memoizedState=_t),b.props=g,b.state=_t,b.context=q,g=se):(typeof b.componentDidUpdate!="function"||G===a.memoizedProps&&ce===a.memoizedState||(l.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||G===a.memoizedProps&&ce===a.memoizedState||(l.flags|=1024),g=!1)}return w_(a,l,f,g,T,_)}function w_(a,l,f,g,_,T){iE(a,l);var b=(l.flags&128)!==0;if(!g&&!b)return _&&ga(l,f,!1),ys(a,l,T);g=l.stateNode,L8.current=l;var G=b&&typeof f.getDerivedStateFromError!="function"?null:g.render();return l.flags|=1,a!==null&&b?(l.child=O(l,a.child,null,T),l.child=O(l,null,G,T)):lr(a,l,G,T),l.memoizedState=g.state,_&&ga(l,f,!0),l.child}function oE(a){var l=a.stateNode;l.pendingContext?Ef(a,l.pendingContext,l.pendingContext!==l.context):l.context&&Ef(a,l.context,!1),r_(a,l.containerInfo)}function aE(a,l,f,g,_){return ms(),so(_),l.flags|=256,lr(a,l,f,g),l.child}var S_={dehydrated:null,treeContext:null,retryLane:0};function E_(a){return{baseLanes:a,cachePool:null,transitions:null}}function lE(a,l,f){var g=l.pendingProps,_=xt.current,T=!1,b=(l.flags&128)!==0,G;if((G=b)||(G=a!==null&&a.memoizedState===null?!1:(_&2)!==0),G?(T=!0,l.flags&=-129):(a===null||a.memoizedState!==null)&&(_|=1),st(xt,_&1),a===null)return ci(l),a=l.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?(l.mode&1?wc(a)?l.lanes=8:l.lanes=1073741824:l.lanes=1,null):(b=g.children,a=g.fallback,T?(g=l.mode,T=l.child,b={mode:"hidden",children:b},!(g&1)&&T!==null?(T.childLanes=0,T.pendingProps=b):T=ap(b,g,0,null),a=Ra(a,g,f,null),T.return=l,a.return=l,T.sibling=a,l.child=T,l.child.memoizedState=E_(f),l.memoizedState=S_,a):T_(l,b));if(_=a.memoizedState,_!==null&&(G=_.dehydrated,G!==null))return b8(a,l,b,g,G,_,f);if(T){T=g.fallback,b=l.mode,_=a.child,G=_.sibling;var q={mode:"hidden",children:g.children};return!(b&1)&&l.child!==_?(g=l.child,g.childLanes=0,g.pendingProps=q,l.deletions=null):(g=fo(_,q),g.subtreeFlags=_.subtreeFlags&14680064),G!==null?T=fo(G,T):(T=Ra(T,b,f,null),T.flags|=2),T.return=l,g.return=l,g.sibling=T,l.child=g,g=T,T=l.child,b=a.child.memoizedState,b=b===null?E_(f):{baseLanes:b.baseLanes|f,cachePool:null,transitions:b.transitions},T.memoizedState=b,T.childLanes=a.childLanes&~f,l.memoizedState=S_,g}return T=a.child,a=T.sibling,g=fo(T,{mode:"visible",children:g.children}),!(l.mode&1)&&(g.lanes=f),g.return=l,g.sibling=null,a!==null&&(f=l.deletions,f===null?(l.deletions=[a],l.flags|=16):f.push(a)),l.child=g,l.memoizedState=null,g}function T_(a,l){return l=ap({mode:"visible",children:l},a.mode,0,null),l.return=a,a.child=l}function Bf(a,l,f,g){return g!==null&&so(g),O(l,a.child,null,f),a=T_(l,l.pendingProps.children),a.flags|=2,l.memoizedState=null,a}function b8(a,l,f,g,_,T,b){if(f)return l.flags&256?(l.flags&=-257,g=__(Error(o(422))),Bf(a,l,b,g)):l.memoizedState!==null?(l.child=a.child,l.flags|=128,null):(T=g.fallback,_=l.mode,g=ap({mode:"visible",children:g.children},_,0,null),T=Ra(T,_,b,null),T.flags|=2,g.return=l,T.return=l,g.sibling=T,l.child=g,l.mode&1&&O(l,a.child,null,b),l.child.memoizedState=E_(b),l.memoizedState=S_,T);if(!(l.mode&1))return Bf(a,l,b,null);if(wc(_))return g=Q0(_).digest,T=Error(o(419)),g=__(T,g,void 0),Bf(a,l,b,g);if(f=(b&a.childLanes)!==0,wr||f){if(g=pn,g!==null){switch(b&-b){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=_&(g.suspendedLanes|b)?0:_,_!==0&&_!==T.retryLane&&(T.retryLane=_,zi(a,_),qr(g,a,_,-1))}return j_(),g=__(Error(o(421))),Bf(a,l,b,g)}return to(_)?(l.flags|=128,l.child=a.child,l=Q8.bind(null,a),no(_,l),null):(a=T.treeContext,at&&(or=_f(_),Bn=l,ft=!0,vr=null,gs=!1,a!==null&&(hn[sr++]=yr,hn[sr++]=Gr,hn[sr++]=ui,yr=a.id,Gr=a.overflow,ui=l)),l=T_(l,g.children),l.flags|=4096,l)}function uE(a,l,f){a.lanes|=l;var g=a.alternate;g!==null&&(g.lanes|=l),Ui(a.return,l,f)}function C_(a,l,f,g,_){var T=a.memoizedState;T===null?a.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:g,tail:f,tailMode:_}:(T.isBackwards=l,T.rendering=null,T.renderingStartTime=0,T.last=g,T.tail=f,T.tailMode=_)}function cE(a,l,f){var g=l.pendingProps,_=g.revealOrder,T=g.tail;if(lr(a,l,g.children,f),g=xt.current,g&2)g=g&1|2,l.flags|=128;else{if(a!==null&&a.flags&128)e:for(a=l.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&uE(a,f,l);else if(a.tag===19)uE(a,f,l);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===l)break e;for(;a.sibling===null;){if(a.return===null||a.return===l)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}g&=1}if(st(xt,g),!(l.mode&1))l.memoizedState=null;else switch(_){case"forwards":for(f=l.child,_=null;f!==null;)a=f.alternate,a!==null&&Of(a)===null&&(_=f),f=f.sibling;f=_,f===null?(_=l.child,l.child=null):(_=f.sibling,f.sibling=null),C_(l,!1,_,f,T);break;case"backwards":for(f=null,_=l.child,l.child=null;_!==null;){if(a=_.alternate,a!==null&&Of(a)===null){l.child=_;break}a=_.sibling,_.sibling=f,f=_,_=a}C_(l,!0,f,null,T);break;case"together":C_(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function Gf(a,l){!(l.mode&1)&&a!==null&&(a.alternate=null,l.alternate=null,l.flags|=2)}function ys(a,l,f){if(a!==null&&(l.dependencies=a.dependencies),Ta|=l.lanes,!(f&l.childLanes))return null;if(a!==null&&l.child!==a.child)throw Error(o(153));if(l.child!==null){for(a=l.child,f=fo(a,a.pendingProps),l.child=f,f.return=l;a.sibling!==null;)a=a.sibling,f=f.sibling=fo(a,a.pendingProps),f.return=l;f.sibling=null}return l.child}function F8(a,l,f){switch(l.tag){case 3:oE(l),ms();break;case 5:CS(l);break;case 1:Pn(l.type)&&mr(l);break;case 4:r_(l,l.stateNode.containerInfo);break;case 10:Zt(l,l.type._context,l.memoizedProps.value);break;case 13:var g=l.memoizedState;if(g!==null)return g.dehydrated!==null?(st(xt,xt.current&1),l.flags|=128,null):f&l.child.childLanes?lE(a,l,f):(st(xt,xt.current&1),a=ys(a,l,f),a!==null?a.sibling:null);st(xt,xt.current&1);break;case 19:if(g=(f&l.childLanes)!==0,a.flags&128){if(g)return cE(a,l,f);l.flags|=128}var _=l.memoizedState;if(_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),st(xt,xt.current),g)break;return null;case 22:case 23:return l.lanes=0,rE(a,l,f)}return ys(a,l,f)}function ji(a){a.flags|=4}function hE(a,l){if(a!==null&&a.child===l.child)return!0;if(l.flags&16)return!1;for(a=l.child;a!==null;){if(a.flags&12854||a.subtreeFlags&12854)return!1;a=a.sibling}return!0}var zc,Bc,jf,Wf;if(Ae)zc=function(a,l){for(var f=l.child;f!==null;){if(f.tag===5||f.tag===6)ae(a,f.stateNode);else if(f.tag!==4&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===l)break;for(;f.sibling===null;){if(f.return===null||f.return===l)return;f=f.return}f.sibling.return=f.return,f=f.sibling}},Bc=function(){},jf=function(a,l,f,g,_){if(a=a.memoizedProps,a!==g){var T=l.stateNode,b=Bi(Hr.current);f=ut(T,f,a,g,_,b),(l.updateQueue=f)&&ji(l)}},Wf=function(a,l,f,g){f!==g&&ji(l)};else if(it){zc=function(a,l,f,g){for(var _=l.child;_!==null;){if(_.tag===5){var T=_.stateNode;f&&g&&(T=eo(T,_.type,_.memoizedProps,_)),ae(a,T)}else if(_.tag===6)T=_.stateNode,f&&g&&(T=vc(T,_.memoizedProps,_)),ae(a,T);else if(_.tag!==4){if(_.tag===22&&_.memoizedState!==null)T=_.child,T!==null&&(T.return=_),zc(a,_,!0,!0);else if(_.child!==null){_.child.return=_,_=_.child;continue}}if(_===l)break;for(;_.sibling===null;){if(_.return===null||_.return===l)return;_=_.return}_.sibling.return=_.return,_=_.sibling}};var dE=function(a,l,f,g){for(var _=l.child;_!==null;){if(_.tag===5){var T=_.stateNode;f&&g&&(T=eo(T,_.type,_.memoizedProps,_)),yc(a,T)}else if(_.tag===6)T=_.stateNode,f&&g&&(T=vc(T,_.memoizedProps,_)),yc(a,T);else if(_.tag!==4){if(_.tag===22&&_.memoizedState!==null)T=_.child,T!==null&&(T.return=_),dE(a,_,!0,!0);else if(_.child!==null){_.child.return=_,_=_.child;continue}}if(_===l)break;for(;_.sibling===null;){if(_.return===null||_.return===l)return;_=_.return}_.sibling.return=_.return,_=_.sibling}};Bc=function(a,l){var f=l.stateNode;if(!hE(a,l)){a=f.containerInfo;var g=Di(a);dE(g,l,!1,!1),f.pendingChildren=g,ji(l),Tl(a,g)}},jf=function(a,l,f,g,_){var T=a.stateNode,b=a.memoizedProps;if((a=hE(a,l))&&b===g)l.stateNode=T;else{var G=l.stateNode,q=Bi(Hr.current),se=null;b!==g&&(se=ut(G,f,b,g,_,q)),a&&se===null?l.stateNode=T:(T=_c(T,se,f,b,g,l,a,G),Ee(T,f,g,_,q)&&ji(l),l.stateNode=T,a?ji(l):zc(T,l,!1,!1))}},Wf=function(a,l,f,g){f!==g?(a=Bi(Vl.current),f=Bi(Hr.current),l.stateNode=ht(g,a,f,l),ji(l)):l.stateNode=a.stateNode}}else Bc=function(){},jf=function(){},Wf=function(){};function Gc(a,l){if(!ft)switch(a.tailMode){case"hidden":l=a.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?a.tail=null:f.sibling=null;break;case"collapsed":f=a.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?l||a.tail===null?a.tail=null:a.tail.sibling=null:g.sibling=null}}function jn(a){var l=a.alternate!==null&&a.alternate.child===a.child,f=0,g=0;if(l)for(var _=a.child;_!==null;)f|=_.lanes|_.childLanes,g|=_.subtreeFlags&14680064,g|=_.flags&14680064,_.return=a,_=_.sibling;else for(_=a.child;_!==null;)f|=_.lanes|_.childLanes,g|=_.subtreeFlags,g|=_.flags,_.return=a,_=_.sibling;return a.subtreeFlags|=g,a.childLanes=f,l}function V8(a,l,f){var g=l.pendingProps;switch(ps(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return jn(l),null;case 1:return Pn(l.type)&&pa(),jn(l),null;case 3:return f=l.stateNode,Ul(),dt(In),dt(Jt),o_(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(a===null||a.child===null)&&(wa(l)?ji(l):a===null||a.memoizedState.isDehydrated&&!(l.flags&256)||(l.flags|=1024,vr!==null&&(B_(vr),vr=null))),Bc(a,l),jn(l),null;case 5:i_(l),f=Bi(Vl.current);var _=l.type;if(a!==null&&l.stateNode!=null)jf(a,l,_,g,f),a.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!g){if(l.stateNode===null)throw Error(o(166));return jn(l),null}if(a=Bi(Hr.current),wa(l)){if(!at)throw Error(o(175));a=Sc(l.stateNode,l.type,l.memoizedProps,f,a,l,!gs),l.updateQueue=a,a!==null&&ji(l)}else{var T=ee(_,g,f,a,l);zc(T,l,!1,!1),l.stateNode=T,Ee(T,_,g,f,a)&&ji(l)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return jn(l),null;case 6:if(a&&l.stateNode!=null)Wf(a,l,a.memoizedProps,g);else{if(typeof g!="string"&&l.stateNode===null)throw Error(o(166));if(a=Bi(Vl.current),f=Bi(Hr.current),wa(l)){if(!at)throw Error(o(176));if(a=l.stateNode,f=l.memoizedProps,(g=Rl(a,f,l,!gs))&&(_=Bn,_!==null))switch(_.tag){case 3:X0(_.stateNode.containerInfo,a,f,(_.mode&1)!==0);break;case 5:Al(_.type,_.memoizedProps,_.stateNode,a,f,(_.mode&1)!==0)}g&&ji(l)}else l.stateNode=ht(g,a,f,l)}return jn(l),null;case 13:if(dt(xt),g=l.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(ft&&or!==null&&l.mode&1&&!(l.flags&128))Mc(),ms(),l.flags|=98560,_=!1;else if(_=wa(l),g!==null&&g.dehydrated!==null){if(a===null){if(!_)throw Error(o(318));if(!at)throw Error(o(344));if(_=l.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(o(317));Mi(_,l)}else ms(),!(l.flags&128)&&(l.memoizedState=null),l.flags|=4;jn(l),_=!1}else vr!==null&&(B_(vr),vr=null),_=!0;if(!_)return l.flags&65536?l:null}return l.flags&128?(l.lanes=f,l):(f=g!==null,f!==(a!==null&&a.memoizedState!==null)&&f&&(l.child.flags|=8192,l.mode&1&&(a===null||xt.current&1?tn===0&&(tn=3):j_())),l.updateQueue!==null&&(l.flags|=4),jn(l),null);case 4:return Ul(),Bc(a,l),a===null&&nt(l.stateNode.containerInfo),jn(l),null;case 10:return $t(l.type._context),jn(l),null;case 17:return Pn(l.type)&&pa(),jn(l),null;case 19:if(dt(xt),_=l.memoizedState,_===null)return jn(l),null;if(g=(l.flags&128)!==0,T=_.rendering,T===null)if(g)Gc(_,!1);else{if(tn!==0||a!==null&&a.flags&128)for(a=l.child;a!==null;){if(T=Of(a),T!==null){for(l.flags|=128,Gc(_,!1),a=T.updateQueue,a!==null&&(l.updateQueue=a,l.flags|=4),l.subtreeFlags=0,a=f,f=l.child;f!==null;)g=f,_=a,g.flags&=14680066,T=g.alternate,T===null?(g.childLanes=0,g.lanes=_,g.child=null,g.subtreeFlags=0,g.memoizedProps=null,g.memoizedState=null,g.updateQueue=null,g.dependencies=null,g.stateNode=null):(g.childLanes=T.childLanes,g.lanes=T.lanes,g.child=T.child,g.subtreeFlags=0,g.deletions=null,g.memoizedProps=T.memoizedProps,g.memoizedState=T.memoizedState,g.updateQueue=T.updateQueue,g.type=T.type,_=T.dependencies,g.dependencies=_===null?null:{lanes:_.lanes,firstContext:_.firstContext}),f=f.sibling;return st(xt,xt.current&1|2),l.child}a=a.sibling}_.tail!==null&&Ht()>F_&&(l.flags|=128,g=!0,Gc(_,!1),l.lanes=4194304)}else{if(!g)if(a=Of(T),a!==null){if(l.flags|=128,g=!0,a=a.updateQueue,a!==null&&(l.updateQueue=a,l.flags|=4),Gc(_,!0),_.tail===null&&_.tailMode==="hidden"&&!T.alternate&&!ft)return jn(l),null}else 2*Ht()-_.renderingStartTime>F_&&f!==1073741824&&(l.flags|=128,g=!0,Gc(_,!1),l.lanes=4194304);_.isBackwards?(T.sibling=l.child,l.child=T):(a=_.last,a!==null?a.sibling=T:l.child=T,_.last=T)}return _.tail!==null?(l=_.tail,_.rendering=l,_.tail=l.sibling,_.renderingStartTime=Ht(),l.sibling=null,a=xt.current,st(xt,g?a&1|2:a&1),l):(jn(l),null);case 22:case 23:return G_(),f=l.memoizedState!==null,a!==null&&a.memoizedState!==null!==f&&(l.flags|=8192),f&&l.mode&1?Nr&1073741824&&(jn(l),Ae&&l.subtreeFlags&6&&(l.flags|=8192)):jn(l),null;case 24:return null;case 25:return null}throw Error(o(156,l.tag))}function U8(a,l){switch(ps(l),l.tag){case 1:return Pn(l.type)&&pa(),a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 3:return Ul(),dt(In),dt(Jt),o_(),a=l.flags,a&65536&&!(a&128)?(l.flags=a&-65537|128,l):null;case 5:return i_(l),null;case 13:if(dt(xt),a=l.memoizedState,a!==null&&a.dehydrated!==null){if(l.alternate===null)throw Error(o(340));ms()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 19:return dt(xt),null;case 4:return Ul(),null;case 10:return $t(l.type._context),null;case 22:case 23:return G_(),null;case 24:return null;default:return null}}var Hf=!1,Wn=!1,z8=typeof WeakSet=="function"?WeakSet:Set,ge=null;function Bl(a,l){var f=a.ref;if(f!==null)if(typeof f=="function")try{f(null)}catch(g){Rt(a,l,g)}else f.current=null}function I_(a,l,f){try{f()}catch(g){Rt(a,l,g)}}var fE=!1;function B8(a,l){for(te(a.containerInfo),ge=l;ge!==null;)if(a=ge,l=a.child,(a.subtreeFlags&1028)!==0&&l!==null)l.return=a,ge=l;else for(;ge!==null;){a=ge;try{var f=a.alternate;if(a.flags&1024)switch(a.tag){case 0:case 11:case 15:break;case 1:if(f!==null){var g=f.memoizedProps,_=f.memoizedState,T=a.stateNode,b=T.getSnapshotBeforeUpdate(a.elementType===a.type?g:di(a.type,g),_);T.__reactInternalSnapshotBeforeUpdate=b}break;case 3:Ae&&mc(a.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(G){Rt(a,a.return,G)}if(l=a.sibling,l!==null){l.return=a.return,ge=l;break}ge=a.return}return f=fE,fE=!1,f}function jc(a,l,f){var g=l.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var _=g=g.next;do{if((_.tag&a)===a){var T=_.destroy;_.destroy=void 0,T!==void 0&&I_(l,f,T)}_=_.next}while(_!==g)}}function $f(a,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var f=l=l.next;do{if((f.tag&a)===a){var g=f.create;f.destroy=g()}f=f.next}while(f!==l)}}function P_(a){var l=a.ref;if(l!==null){var f=a.stateNode;switch(a.tag){case 5:a=he(f);break;default:a=f}typeof l=="function"?l(a):l.current=a}}function pE(a){var l=a.alternate;l!==null&&(a.alternate=null,pE(l)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(l=a.stateNode,l!==null&&xr(l)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function gE(a){return a.tag===5||a.tag===3||a.tag===4}function mE(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||gE(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function R_(a,l,f){var g=a.tag;if(g===5||g===6)a=a.stateNode,l?df(f,a,l):uf(f,a);else if(g!==4&&(a=a.child,a!==null))for(R_(a,l,f),a=a.sibling;a!==null;)R_(a,l,f),a=a.sibling}function A_(a,l,f){var g=a.tag;if(g===5||g===6)a=a.stateNode,l?hf(f,a,l):El(f,a);else if(g!==4&&(a=a.child,a!==null))for(A_(a,l,f),a=a.sibling;a!==null;)A_(a,l,f),a=a.sibling}var An=null,fi=!1;function Wi(a,l,f){for(f=f.child;f!==null;)k_(a,l,f),f=f.sibling}function k_(a,l,f){if(Un&&typeof Un.onCommitFiberUnmount=="function")try{Un.onCommitFiberUnmount(Vi,f)}catch{}switch(f.tag){case 5:Wn||Bl(f,l);case 6:if(Ae){var g=An,_=fi;An=null,Wi(a,l,f),An=g,fi=_,An!==null&&(fi?K0(An,f.stateNode):pc(An,f.stateNode))}else Wi(a,l,f);break;case 18:Ae&&An!==null&&(fi?wf(An,f.stateNode):Tc(An,f.stateNode));break;case 4:Ae?(g=An,_=fi,An=f.stateNode.containerInfo,fi=!0,Wi(a,l,f),An=g,fi=_):(it&&(g=f.stateNode.containerInfo,_=Di(g),Cl(g,_)),Wi(a,l,f));break;case 0:case 11:case 14:case 15:if(!Wn&&(g=f.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){_=g=g.next;do{var T=_,b=T.destroy;T=T.tag,b!==void 0&&(T&2||T&4)&&I_(f,l,b),_=_.next}while(_!==g)}Wi(a,l,f);break;case 1:if(!Wn&&(Bl(f,l),g=f.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=f.memoizedProps,g.state=f.memoizedState,g.componentWillUnmount()}catch(G){Rt(f,l,G)}Wi(a,l,f);break;case 21:Wi(a,l,f);break;case 22:f.mode&1?(Wn=(g=Wn)||f.memoizedState!==null,Wi(a,l,f),Wn=g):Wi(a,l,f);break;default:Wi(a,l,f)}}function _E(a){var l=a.updateQueue;if(l!==null){a.updateQueue=null;var f=a.stateNode;f===null&&(f=a.stateNode=new z8),l.forEach(function(g){var _=Y8.bind(null,a,g);f.has(g)||(f.add(g),g.then(_,_))})}}function pi(a,l){var f=l.deletions;if(f!==null)for(var g=0;g<f.length;g++){var _=f[g];try{var T=a,b=l;if(Ae){var G=b;e:for(;G!==null;){switch(G.tag){case 5:An=G.stateNode,fi=!1;break e;case 3:An=G.stateNode.containerInfo,fi=!0;break e;case 4:An=G.stateNode.containerInfo,fi=!0;break e}G=G.return}if(An===null)throw Error(o(160));k_(T,b,_),An=null,fi=!1}else k_(T,b,_);var q=_.alternate;q!==null&&(q.return=null),_.return=null}catch(se){Rt(_,l,se)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)yE(l,a),l=l.sibling}function yE(a,l){var f=a.alternate,g=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(pi(l,a),Hi(a),g&4){try{jc(3,a,a.return),$f(3,a)}catch(ce){Rt(a,a.return,ce)}try{jc(5,a,a.return)}catch(ce){Rt(a,a.return,ce)}}break;case 1:pi(l,a),Hi(a),g&512&&f!==null&&Bl(f,f.return);break;case 5:if(pi(l,a),Hi(a),g&512&&f!==null&&Bl(f,f.return),Ae){if(a.flags&32){var _=a.stateNode;try{ff(_)}catch(ce){Rt(a,a.return,ce)}}if(g&4&&(_=a.stateNode,_!=null)){var T=a.memoizedProps;if(f=f!==null?f.memoizedProps:T,g=a.type,l=a.updateQueue,a.updateQueue=null,l!==null)try{ha(_,l,g,f,T,a)}catch(ce){Rt(a,a.return,ce)}}}break;case 6:if(pi(l,a),Hi(a),g&4&&Ae){if(a.stateNode===null)throw Error(o(162));_=a.stateNode,T=a.memoizedProps,f=f!==null?f.memoizedProps:T;try{cf(_,f,T)}catch(ce){Rt(a,a.return,ce)}}break;case 3:if(pi(l,a),Hi(a),g&4){if(Ae&&at&&f!==null&&f.memoizedState.isDehydrated)try{vf(l.containerInfo)}catch(ce){Rt(a,a.return,ce)}if(it){_=l.containerInfo,T=l.pendingChildren;try{Cl(_,T)}catch(ce){Rt(a,a.return,ce)}}}break;case 4:if(pi(l,a),Hi(a),g&4&&it){T=a.stateNode,_=T.containerInfo,T=T.pendingChildren;try{Cl(_,T)}catch(ce){Rt(a,a.return,ce)}}break;case 13:pi(l,a),Hi(a),_=a.child,_.flags&8192&&(T=_.memoizedState!==null,_.stateNode.isHidden=T,!T||_.alternate!==null&&_.alternate.memoizedState!==null||(b_=Ht())),g&4&&_E(a);break;case 22:var b=f!==null&&f.memoizedState!==null;if(a.mode&1?(Wn=(f=Wn)||b,pi(l,a),Wn=f):pi(l,a),Hi(a),g&8192){if(f=a.memoizedState!==null,(a.stateNode.isHidden=f)&&!b&&a.mode&1)for(ge=a,g=a.child;g!==null;){for(l=ge=g;ge!==null;){b=ge;var G=b.child;switch(b.tag){case 0:case 11:case 14:case 15:jc(4,b,b.return);break;case 1:Bl(b,b.return);var q=b.stateNode;if(typeof q.componentWillUnmount=="function"){var se=b,_e=b.return;try{var Ne=se;q.props=Ne.memoizedProps,q.state=Ne.memoizedState,q.componentWillUnmount()}catch(ce){Rt(se,_e,ce)}}break;case 5:Bl(b,b.return);break;case 22:if(b.memoizedState!==null){SE(l);continue}}G!==null?(G.return=b,ge=G):SE(l)}g=g.sibling}if(Ae){e:if(g=null,Ae)for(l=a;;){if(l.tag===5){if(g===null){g=l;try{_=l.stateNode,f?gc(_):gf(l.stateNode,l.memoizedProps)}catch(ce){Rt(a,a.return,ce)}}}else if(l.tag===6){if(g===null)try{T=l.stateNode,f?pf(T):da(T,l.memoizedProps)}catch(ce){Rt(a,a.return,ce)}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===a)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break e;for(;l.sibling===null;){if(l.return===null||l.return===a)break e;g===l&&(g=null),l=l.return}g===l&&(g=null),l.sibling.return=l.return,l=l.sibling}}}break;case 19:pi(l,a),Hi(a),g&4&&_E(a);break;case 21:break;default:pi(l,a),Hi(a)}}function Hi(a){var l=a.flags;if(l&2){try{if(Ae){e:{for(var f=a.return;f!==null;){if(gE(f)){var g=f;break e}f=f.return}throw Error(o(160))}switch(g.tag){case 5:var _=g.stateNode;g.flags&32&&(ff(_),g.flags&=-33);var T=mE(a);A_(a,T,_);break;case 3:case 4:var b=g.stateNode.containerInfo,G=mE(a);R_(a,G,b);break;default:throw Error(o(161))}}}catch(q){Rt(a,a.return,q)}a.flags&=-3}l&4096&&(a.flags&=-4097)}function G8(a,l,f){ge=a,vE(a)}function vE(a,l,f){for(var g=(a.mode&1)!==0;ge!==null;){var _=ge,T=_.child;if(_.tag===22&&g){var b=_.memoizedState!==null||Hf;if(!b){var G=_.alternate,q=G!==null&&G.memoizedState!==null||Wn;G=Hf;var se=Wn;if(Hf=b,(Wn=q)&&!se)for(ge=_;ge!==null;)b=ge,q=b.child,b.tag===22&&b.memoizedState!==null?EE(_):q!==null?(q.return=b,ge=q):EE(_);for(;T!==null;)ge=T,vE(T),T=T.sibling;ge=_,Hf=G,Wn=se}wE(a)}else _.subtreeFlags&8772&&T!==null?(T.return=_,ge=T):wE(a)}}function wE(a){for(;ge!==null;){var l=ge;if(l.flags&8772){var f=l.alternate;try{if(l.flags&8772)switch(l.tag){case 0:case 11:case 15:Wn||$f(5,l);break;case 1:var g=l.stateNode;if(l.flags&4&&!Wn)if(f===null)g.componentDidMount();else{var _=l.elementType===l.type?f.memoizedProps:di(l.type,f.memoizedProps);g.componentDidUpdate(_,f.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var T=l.updateQueue;T!==null&&TS(l,T,g);break;case 3:var b=l.updateQueue;if(b!==null){if(f=null,l.child!==null)switch(l.child.tag){case 5:f=he(l.child.stateNode);break;case 1:f=l.child.stateNode}TS(l,b,f)}break;case 5:var G=l.stateNode;f===null&&l.flags&4&&q0(G,l.type,l.memoizedProps,l);break;case 6:break;case 4:break;case 12:break;case 13:if(at&&l.memoizedState===null){var q=l.alternate;if(q!==null){var se=q.memoizedState;if(se!==null){var _e=se.dehydrated;_e!==null&&Ec(_e)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(o(163))}Wn||l.flags&512&&P_(l)}catch(Ne){Rt(l,l.return,Ne)}}if(l===a){ge=null;break}if(f=l.sibling,f!==null){f.return=l.return,ge=f;break}ge=l.return}}function SE(a){for(;ge!==null;){var l=ge;if(l===a){ge=null;break}var f=l.sibling;if(f!==null){f.return=l.return,ge=f;break}ge=l.return}}function EE(a){for(;ge!==null;){var l=ge;try{switch(l.tag){case 0:case 11:case 15:var f=l.return;try{$f(4,l)}catch(q){Rt(l,f,q)}break;case 1:var g=l.stateNode;if(typeof g.componentDidMount=="function"){var _=l.return;try{g.componentDidMount()}catch(q){Rt(l,_,q)}}var T=l.return;try{P_(l)}catch(q){Rt(l,T,q)}break;case 5:var b=l.return;try{P_(l)}catch(q){Rt(l,b,q)}}}catch(q){Rt(l,l.return,q)}if(l===a){ge=null;break}var G=l.sibling;if(G!==null){G.return=l.return,ge=G;break}ge=l.return}}var qf=0,Kf=1,Qf=2,Yf=3,Xf=4;if(typeof Symbol=="function"&&Symbol.for){var Wc=Symbol.for;qf=Wc("selector.component"),Kf=Wc("selector.has_pseudo_class"),Qf=Wc("selector.role"),Yf=Wc("selector.test_id"),Xf=Wc("selector.text")}function x_(a){var l=gr(a);if(l!=null){if(typeof l.memoizedProps["data-testname"]!="string")throw Error(o(364));return l}if(a=af(a),a===null)throw Error(o(362));return a.stateNode.current}function N_(a,l){switch(l.$$typeof){case qf:if(a.type===l.value)return!0;break;case Kf:e:{l=l.value,a=[a,0];for(var f=0;f<a.length;){var g=a[f++],_=a[f++],T=l[_];if(g.tag!==5||!os(g)){for(;T!=null&&N_(g,T);)_++,T=l[_];if(_===l.length){l=!0;break e}else for(g=g.child;g!==null;)a.push(g,_),g=g.sibling}}l=!1}return l;case Qf:if(a.tag===5&&lf(a.stateNode,l.value))return!0;break;case Xf:if((a.tag===5||a.tag===6)&&(a=fc(a),a!==null&&0<=a.indexOf(l.value)))return!0;break;case Yf:if(a.tag===5&&(a=a.memoizedProps["data-testname"],typeof a=="string"&&a.toLowerCase()===l.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function D_(a){switch(a.$$typeof){case qf:return"<"+(M(a.value)||"Unknown")+">";case Kf:return":has("+(D_(a)||"")+")";case Qf:return'[role="'+a.value+'"]';case Xf:return'"'+a.value+'"';case Yf:return'[data-testname="'+a.value+'"]';default:throw Error(o(365))}}function TE(a,l){var f=[];a=[a,0];for(var g=0;g<a.length;){var _=a[g++],T=a[g++],b=l[T];if(_.tag!==5||!os(_)){for(;b!=null&&N_(_,b);)T++,b=l[T];if(T===l.length)f.push(_);else for(_=_.child;_!==null;)a.push(_,T),_=_.sibling}}return f}function M_(a,l){if(!ss)throw Error(o(363));a=x_(a),a=TE(a,l),l=[],a=Array.from(a);for(var f=0;f<a.length;){var g=a[f++];if(g.tag===5)os(g)||l.push(g.stateNode);else for(g=g.child;g!==null;)a.push(g),g=g.sibling}return l}var j8=Math.ceil,Jf=u.ReactCurrentDispatcher,O_=u.ReactCurrentOwner,Bt=u.ReactCurrentBatchConfig,Le=0,pn=null,qt=null,kn=0,Nr=0,Gl=ai(0),tn=0,Hc=null,Ta=0,Zf=0,L_=0,$c=null,Sr=null,b_=0,F_=1/0,vs=null;function jl(){F_=Ht()+500}var ep=!1,V_=null,lo=null,tp=!1,uo=null,np=0,qc=0,U_=null,rp=-1,ip=0;function Hn(){return Le&6?Ht():rp!==-1?rp:rp=Ht()}function co(a){return a.mode&1?Le&2&&kn!==0?kn&-kn:ar.transition!==null?(ip===0&&(ip=Cf()),ip):(a=Ge,a!==0?a:si()):1}function qr(a,l,f,g){if(50<qc)throw qc=0,U_=null,Error(o(185));_r(a,f,g),(!(Le&2)||a!==pn)&&(a===pn&&(!(Le&2)&&(Zf|=f),tn===4&&ho(a,kn)),Er(a,g),f===1&&Le===0&&!(l.mode&1)&&(jl(),Ml&&ir()))}function Er(a,l){var f=a.callbackNode;Z0(a,l);var g=_a(a,a===pn?kn:0);if(g===0)f!==null&&Pf(f),a.callbackNode=null,a.callbackPriority=0;else if(l=g&-g,a.callbackPriority!==l){if(f!=null&&Pf(f),l===1)a.tag===0?kf(IE.bind(null,a)):xc(IE.bind(null,a)),Ni?of(function(){!(Le&6)&&ir()}):Rc(Ac,ir),f=null;else{switch(ds(g)){case 1:f=Ac;break;case 4:f=Dl;break;case 16:f=io;break;case 536870912:f=Rf;break;default:f=io}f=OE(f,CE.bind(null,a))}a.callbackPriority=l,a.callbackNode=f}}function CE(a,l){if(rp=-1,ip=0,Le&6)throw Error(o(327));var f=a.callbackNode;if(Pa()&&a.callbackNode!==f)return null;var g=_a(a,a===pn?kn:0);if(g===0)return null;if(g&30||g&a.expiredLanes||l)l=sp(a,g);else{l=g;var _=Le;Le|=2;var T=AE();(pn!==a||kn!==l)&&(vs=null,jl(),Ca(a,l));do try{$8();break}catch(G){RE(a,G)}while(!0);Ve(),Jf.current=T,Le=_,qt!==null?l=0:(pn=null,kn=0,l=tn)}if(l!==0){if(l===2&&(_=Pc(a),_!==0&&(g=_,l=z_(a,_))),l===1)throw f=Hc,Ca(a,0),ho(a,g),Er(a,Ht()),f;if(l===6)ho(a,g);else{if(_=a.current.alternate,!(g&30)&&!W8(_)&&(l=sp(a,g),l===2&&(T=Pc(a),T!==0&&(g=T,l=z_(a,T))),l===1))throw f=Hc,Ca(a,0),ho(a,g),Er(a,Ht()),f;switch(a.finishedWork=_,a.finishedLanes=g,l){case 0:case 1:throw Error(o(345));case 2:Ia(a,Sr,vs);break;case 3:if(ho(a,g),(g&130023424)===g&&(l=b_+500-Ht(),10<l)){if(_a(a,0)!==0)break;if(_=a.suspendedLanes,(_&g)!==g){Hn(),a.pingedLanes|=a.suspendedLanes&_;break}a.timeoutHandle=B(Ia.bind(null,a,Sr,vs),l);break}Ia(a,Sr,vs);break;case 4:if(ho(a,g),(g&4194240)===g)break;for(l=a.eventTimes,_=-1;0<g;){var b=31-Vn(g);T=1<<b,b=l[b],b>_&&(_=b),g&=~T}if(g=_,g=Ht()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*j8(g/1960))-g,10<g){a.timeoutHandle=B(Ia.bind(null,a,Sr,vs),g);break}Ia(a,Sr,vs);break;case 5:Ia(a,Sr,vs);break;default:throw Error(o(329))}}}return Er(a,Ht()),a.callbackNode===f?CE.bind(null,a):null}function z_(a,l){var f=$c;return a.current.memoizedState.isDehydrated&&(Ca(a,l).flags|=256),a=sp(a,l),a!==2&&(l=Sr,Sr=f,l!==null&&B_(l)),a}function B_(a){Sr===null?Sr=a:Sr.push.apply(Sr,a)}function W8(a){for(var l=a;;){if(l.flags&16384){var f=l.updateQueue;if(f!==null&&(f=f.stores,f!==null))for(var g=0;g<f.length;g++){var _=f[g],T=_.getSnapshot;_=_.value;try{if(!$e(T(),_))return!1}catch{return!1}}}if(f=l.child,l.subtreeFlags&16384&&f!==null)f.return=l,l=f;else{if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function ho(a,l){for(l&=~L_,l&=~Zf,a.suspendedLanes|=l,a.pingedLanes&=~l,a=a.expirationTimes;0<l;){var f=31-Vn(l),g=1<<f;a[f]=-1,l&=~g}}function IE(a){if(Le&6)throw Error(o(327));Pa();var l=_a(a,0);if(!(l&1))return Er(a,Ht()),null;var f=sp(a,l);if(a.tag!==0&&f===2){var g=Pc(a);g!==0&&(l=g,f=z_(a,g))}if(f===1)throw f=Hc,Ca(a,0),ho(a,l),Er(a,Ht()),f;if(f===6)throw Error(o(345));return a.finishedWork=a.current.alternate,a.finishedLanes=l,Ia(a,Sr,vs),Er(a,Ht()),null}function PE(a){uo!==null&&uo.tag===0&&!(Le&6)&&Pa();var l=Le;Le|=1;var f=Bt.transition,g=Ge;try{if(Bt.transition=null,Ge=1,a)return a()}finally{Ge=g,Bt.transition=f,Le=l,!(Le&6)&&ir()}}function G_(){Nr=Gl.current,dt(Gl)}function Ca(a,l){a.finishedWork=null,a.finishedLanes=0;var f=a.timeoutHandle;if(f!==ve&&(a.timeoutHandle=ve,re(f)),qt!==null)for(f=qt.return;f!==null;){var g=f;switch(ps(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&pa();break;case 3:Ul(),dt(In),dt(Jt),o_();break;case 5:i_(g);break;case 4:Ul();break;case 13:dt(xt);break;case 19:dt(xt);break;case 10:$t(g.type._context);break;case 22:case 23:G_()}f=f.return}if(pn=a,qt=a=fo(a.current,null),kn=Nr=l,tn=0,Hc=null,L_=Zf=Ta=0,Sr=$c=null,hi!==null){for(l=0;l<hi.length;l++)if(f=hi[l],g=f.interleaved,g!==null){f.interleaved=null;var _=g.next,T=f.pending;if(T!==null){var b=T.next;T.next=_,g.next=b}f.pending=g}hi=null}return a}function RE(a,l){do{var f=qt;try{if(Ve(),Lf.current=Uf,bf){for(var g=Nt.memoizedState;g!==null;){var _=g.queue;_!==null&&(_.pending=null),g=g.next}bf=!1}if(Ea=0,fn=en=Nt=null,bc=!1,Fc=0,O_.current=null,f===null||f.return===null){tn=1,Hc=l,qt=null;break}e:{var T=a,b=f.return,G=f,q=l;if(l=kn,G.flags|=32768,q!==null&&typeof q=="object"&&typeof q.then=="function"){var se=q,_e=G,Ne=_e.tag;if(!(_e.mode&1)&&(Ne===0||Ne===11||Ne===15)){var ce=_e.alternate;ce?(_e.updateQueue=ce.updateQueue,_e.memoizedState=ce.memoizedState,_e.lanes=ce.lanes):(_e.updateQueue=null,_e.memoizedState=null)}var St=JS(b);if(St!==null){St.flags&=-257,ZS(St,b,G,T,l),St.mode&1&&XS(T,se,l),l=St,q=se;var _t=l.updateQueue;if(_t===null){var Tr=new Set;Tr.add(q),l.updateQueue=Tr}else _t.add(q);break e}else{if(!(l&1)){XS(T,se,l),j_();break e}q=Error(o(426))}}else if(ft&&G.mode&1){var ws=JS(b);if(ws!==null){!(ws.flags&65536)&&(ws.flags|=256),ZS(ws,b,G,T,l),so(zl(q,G));break e}}T=q=zl(q,G),tn!==4&&(tn=2),$c===null?$c=[T]:$c.push(T),T=b;do{switch(T.tag){case 3:T.flags|=65536,l&=-l,T.lanes|=l;var $=QS(T,q,l);ES(T,$);break e;case 1:G=q;var j=T.type,Q=T.stateNode;if(!(T.flags&128)&&(typeof j.getDerivedStateFromError=="function"||Q!==null&&typeof Q.componentDidCatch=="function"&&(lo===null||!lo.has(Q)))){T.flags|=65536,l&=-l,T.lanes|=l;var de=YS(T,G,l);ES(T,de);break e}}T=T.return}while(T!==null)}xE(f)}catch(Te){l=Te,qt===f&&f!==null&&(qt=f=f.return);continue}break}while(!0)}function AE(){var a=Jf.current;return Jf.current=Uf,a===null?Uf:a}function j_(){(tn===0||tn===3||tn===2)&&(tn=4),pn===null||!(Ta&268435455)&&!(Zf&268435455)||ho(pn,kn)}function sp(a,l){var f=Le;Le|=2;var g=AE();(pn!==a||kn!==l)&&(vs=null,Ca(a,l));do try{H8();break}catch(_){RE(a,_)}while(!0);if(Ve(),Le=f,Jf.current=g,qt!==null)throw Error(o(261));return pn=null,kn=0,tn}function H8(){for(;qt!==null;)kE(qt)}function $8(){for(;qt!==null&&!e_();)kE(qt)}function kE(a){var l=ME(a.alternate,a,Nr);a.memoizedProps=a.pendingProps,l===null?xE(a):qt=l,O_.current=null}function xE(a){var l=a;do{var f=l.alternate;if(a=l.return,l.flags&32768){if(f=U8(f,l),f!==null){f.flags&=32767,qt=f;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{tn=6,qt=null;return}}else if(f=V8(f,l,Nr),f!==null){qt=f;return}if(l=l.sibling,l!==null){qt=l;return}qt=l=a}while(l!==null);tn===0&&(tn=5)}function Ia(a,l,f){var g=Ge,_=Bt.transition;try{Bt.transition=null,Ge=1,q8(a,l,f,g)}finally{Bt.transition=_,Ge=g}return null}function q8(a,l,f,g){do Pa();while(uo!==null);if(Le&6)throw Error(o(327));f=a.finishedWork;var _=a.finishedLanes;if(f===null)return null;if(a.finishedWork=null,a.finishedLanes=0,f===a.current)throw Error(o(177));a.callbackNode=null,a.callbackPriority=0;var T=f.lanes|f.childLanes;if(If(a,T),a===pn&&(qt=pn=null,kn=0),!(f.subtreeFlags&2064)&&!(f.flags&2064)||tp||(tp=!0,OE(io,function(){return Pa(),null})),T=(f.flags&15990)!==0,f.subtreeFlags&15990||T){T=Bt.transition,Bt.transition=null;var b=Ge;Ge=1;var G=Le;Le|=4,O_.current=null,B8(a,f),yE(f,a),J(a.containerInfo),a.current=f,G8(f),Fi(),Le=G,Ge=b,Bt.transition=T}else a.current=f;if(tp&&(tp=!1,uo=a,np=_),T=a.pendingLanes,T===0&&(lo=null),Af(f.stateNode),Er(a,Ht()),l!==null)for(g=a.onRecoverableError,f=0;f<l.length;f++)_=l[f],g(_.value,{componentStack:_.stack,digest:_.digest});if(ep)throw ep=!1,a=V_,V_=null,a;return np&1&&a.tag!==0&&Pa(),T=a.pendingLanes,T&1?a===U_?qc++:(qc=0,U_=a):qc=0,ir(),null}function Pa(){if(uo!==null){var a=ds(np),l=Bt.transition,f=Ge;try{if(Bt.transition=null,Ge=16>a?16:a,uo===null)var g=!1;else{if(a=uo,uo=null,np=0,Le&6)throw Error(o(331));var _=Le;for(Le|=4,ge=a.current;ge!==null;){var T=ge,b=T.child;if(ge.flags&16){var G=T.deletions;if(G!==null){for(var q=0;q<G.length;q++){var se=G[q];for(ge=se;ge!==null;){var _e=ge;switch(_e.tag){case 0:case 11:case 15:jc(8,_e,T)}var Ne=_e.child;if(Ne!==null)Ne.return=_e,ge=Ne;else for(;ge!==null;){_e=ge;var ce=_e.sibling,St=_e.return;if(pE(_e),_e===se){ge=null;break}if(ce!==null){ce.return=St,ge=ce;break}ge=St}}}var _t=T.alternate;if(_t!==null){var Tr=_t.child;if(Tr!==null){_t.child=null;do{var ws=Tr.sibling;Tr.sibling=null,Tr=ws}while(Tr!==null)}}ge=T}}if(T.subtreeFlags&2064&&b!==null)b.return=T,ge=b;else e:for(;ge!==null;){if(T=ge,T.flags&2048)switch(T.tag){case 0:case 11:case 15:jc(9,T,T.return)}var $=T.sibling;if($!==null){$.return=T.return,ge=$;break e}ge=T.return}}var j=a.current;for(ge=j;ge!==null;){b=ge;var Q=b.child;if(b.subtreeFlags&2064&&Q!==null)Q.return=b,ge=Q;else e:for(b=j;ge!==null;){if(G=ge,G.flags&2048)try{switch(G.tag){case 0:case 11:case 15:$f(9,G)}}catch(Te){Rt(G,G.return,Te)}if(G===b){ge=null;break e}var de=G.sibling;if(de!==null){de.return=G.return,ge=de;break e}ge=G.return}}if(Le=_,ir(),Un&&typeof Un.onPostCommitFiberRoot=="function")try{Un.onPostCommitFiberRoot(Vi,a)}catch{}g=!0}return g}finally{Ge=f,Bt.transition=l}}return!1}function NE(a,l,f){l=zl(f,l),l=QS(a,l,1),a=ao(a,l,1),l=Hn(),a!==null&&(_r(a,1,l),Er(a,l))}function Rt(a,l,f){if(a.tag===3)NE(a,a,f);else for(;l!==null;){if(l.tag===3){NE(l,a,f);break}else if(l.tag===1){var g=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(lo===null||!lo.has(g))){a=zl(f,a),a=YS(l,a,1),l=ao(l,a,1),a=Hn(),l!==null&&(_r(l,1,a),Er(l,a));break}}l=l.return}}function K8(a,l,f){var g=a.pingCache;g!==null&&g.delete(l),l=Hn(),a.pingedLanes|=a.suspendedLanes&f,pn===a&&(kn&f)===f&&(tn===4||tn===3&&(kn&130023424)===kn&&500>Ht()-b_?Ca(a,0):L_|=f),Er(a,l)}function DE(a,l){l===0&&(a.mode&1?(l=bi,bi<<=1,!(bi&130023424)&&(bi=4194304)):l=1);var f=Hn();a=zi(a,l),a!==null&&(_r(a,l,f),Er(a,f))}function Q8(a){var l=a.memoizedState,f=0;l!==null&&(f=l.retryLane),DE(a,f)}function Y8(a,l){var f=0;switch(a.tag){case 13:var g=a.stateNode,_=a.memoizedState;_!==null&&(f=_.retryLane);break;case 19:g=a.stateNode;break;default:throw Error(o(314))}g!==null&&g.delete(l),DE(a,f)}var ME;ME=function(a,l,f){if(a!==null)if(a.memoizedProps!==l.pendingProps||In.current)wr=!0;else{if(!(a.lanes&f)&&!(l.flags&128))return wr=!1,F8(a,l,f);wr=!!(a.flags&131072)}else wr=!1,ft&&l.flags&1048576&&xf(l,Ll,l.index);switch(l.lanes=0,l.tag){case 2:var g=l.type;Gf(a,l),a=l.pendingProps;var _=ro(l,Jt.current);dn(l,f),_=u_(null,l,g,a,_,f);var T=c_();return l.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,Pn(g)?(T=!0,mr(l)):T=!1,l.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,n_(l),_.updater=zf,l.stateNode=_,_._reactInternals=l,m_(l,g,a,f),l=w_(null,l,g,!0,T,f)):(l.tag=0,ft&&T&&bl(l),lr(null,l,_,f),l=l.child),l;case 16:g=l.elementType;e:{switch(Gf(a,l),a=l.pendingProps,_=g._init,g=_(g._payload),l.type=g,_=l.tag=J8(g),a=di(g,a),_){case 0:l=v_(null,l,g,a,f);break e;case 1:l=sE(null,l,g,a,f);break e;case 11:l=eE(null,l,g,a,f);break e;case 14:l=tE(null,l,g,di(g.type,a),f);break e}throw Error(o(306,g,""))}return l;case 0:return g=l.type,_=l.pendingProps,_=l.elementType===g?_:di(g,_),v_(a,l,g,_,f);case 1:return g=l.type,_=l.pendingProps,_=l.elementType===g?_:di(g,_),sE(a,l,g,_,f);case 3:e:{if(oE(l),a===null)throw Error(o(387));g=l.pendingProps,T=l.memoizedState,_=T.element,SS(a,l),Mf(l,g,null,f);var b=l.memoizedState;if(g=b.element,at&&T.isDehydrated)if(T={element:g,isDehydrated:!1,cache:b.cache,pendingSuspenseBoundaries:b.pendingSuspenseBoundaries,transitions:b.transitions},l.updateQueue.baseState=T,l.memoizedState=T,l.flags&256){_=zl(Error(o(423)),l),l=aE(a,l,g,f,_);break e}else if(g!==_){_=zl(Error(o(424)),l),l=aE(a,l,g,f,_);break e}else for(at&&(or=Pl(l.stateNode.containerInfo),Bn=l,ft=!0,vr=null,gs=!1),f=W(l,null,g,f),l.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(ms(),g===_){l=ys(a,l,f);break e}lr(a,l,g,f)}l=l.child}return l;case 5:return CS(l),a===null&&ci(l),g=l.type,_=l.pendingProps,T=a!==null?a.memoizedProps:null,b=_.children,ct(g,_)?b=null:T!==null&&ct(g,T)&&(l.flags|=32),iE(a,l),lr(a,l,b,f),l.child;case 6:return a===null&&ci(l),null;case 13:return lE(a,l,f);case 4:return r_(l,l.stateNode.containerInfo),g=l.pendingProps,a===null?l.child=O(l,null,g,f):lr(a,l,g,f),l.child;case 11:return g=l.type,_=l.pendingProps,_=l.elementType===g?_:di(g,_),eE(a,l,g,_,f);case 7:return lr(a,l,l.pendingProps,f),l.child;case 8:return lr(a,l,l.pendingProps.children,f),l.child;case 12:return lr(a,l,l.pendingProps.children,f),l.child;case 10:e:{if(g=l.type._context,_=l.pendingProps,T=l.memoizedProps,b=_.value,Zt(l,g,b),T!==null)if($e(T.value,b)){if(T.children===_.children&&!In.current){l=ys(a,l,f);break e}}else for(T=l.child,T!==null&&(T.return=l);T!==null;){var G=T.dependencies;if(G!==null){b=T.child;for(var q=G.firstContext;q!==null;){if(q.context===g){if(T.tag===1){q=_s(-1,f&-f),q.tag=2;var se=T.updateQueue;if(se!==null){se=se.shared;var _e=se.pending;_e===null?q.next=q:(q.next=_e.next,_e.next=q),se.pending=q}}T.lanes|=f,q=T.alternate,q!==null&&(q.lanes|=f),Ui(T.return,f,l),G.lanes|=f;break}q=q.next}}else if(T.tag===10)b=T.type===l.type?null:T.child;else if(T.tag===18){if(b=T.return,b===null)throw Error(o(341));b.lanes|=f,G=b.alternate,G!==null&&(G.lanes|=f),Ui(b,f,l),b=T.sibling}else b=T.child;if(b!==null)b.return=T;else for(b=T;b!==null;){if(b===l){b=null;break}if(T=b.sibling,T!==null){T.return=b.return,b=T;break}b=b.return}T=b}lr(a,l,_.children,f),l=l.child}return l;case 9:return _=l.type,g=l.pendingProps.children,dn(l,f),_=Rn(_),g=g(_),l.flags|=1,lr(a,l,g,f),l.child;case 14:return g=l.type,_=di(g,l.pendingProps),_=di(g.type,_),tE(a,l,g,_,f);case 15:return nE(a,l,l.type,l.pendingProps,f);case 17:return g=l.type,_=l.pendingProps,_=l.elementType===g?_:di(g,_),Gf(a,l),l.tag=1,Pn(g)?(a=!0,mr(l)):a=!1,dn(l,f),qS(l,g,_),m_(l,g,_,f),w_(null,l,g,!0,a,f);case 19:return cE(a,l,f);case 22:return rE(a,l,f)}throw Error(o(156,l.tag))};function OE(a,l){return Rc(a,l)}function X8(a,l,f,g){this.tag=a,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Kr(a,l,f,g){return new X8(a,l,f,g)}function W_(a){return a=a.prototype,!(!a||!a.isReactComponent)}function J8(a){if(typeof a=="function")return W_(a)?1:0;if(a!=null){if(a=a.$$typeof,a===x)return 11;if(a===R)return 14}return 2}function fo(a,l){var f=a.alternate;return f===null?(f=Kr(a.tag,l,a.key,a.mode),f.elementType=a.elementType,f.type=a.type,f.stateNode=a.stateNode,f.alternate=a,a.alternate=f):(f.pendingProps=l,f.type=a.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=a.flags&14680064,f.childLanes=a.childLanes,f.lanes=a.lanes,f.child=a.child,f.memoizedProps=a.memoizedProps,f.memoizedState=a.memoizedState,f.updateQueue=a.updateQueue,l=a.dependencies,f.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},f.sibling=a.sibling,f.index=a.index,f.ref=a.ref,f}function op(a,l,f,g,_,T){var b=2;if(g=a,typeof a=="function")W_(a)&&(b=1);else if(typeof a=="string")b=5;else e:switch(a){case p:return Ra(f.children,_,T,l);case m:b=8,_|=8;break;case y:return a=Kr(12,f,l,_|2),a.elementType=y,a.lanes=T,a;case D:return a=Kr(13,f,l,_),a.elementType=D,a.lanes=T,a;case k:return a=Kr(19,f,l,_),a.elementType=k,a.lanes=T,a;case P:return ap(f,_,T,l);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case E:b=10;break e;case S:b=9;break e;case x:b=11;break e;case R:b=14;break e;case w:b=16,g=null;break e}throw Error(o(130,a==null?a:typeof a,""))}return l=Kr(b,f,l,_),l.elementType=a,l.type=g,l.lanes=T,l}function Ra(a,l,f,g){return a=Kr(7,a,g,l),a.lanes=f,a}function ap(a,l,f,g){return a=Kr(22,a,g,l),a.elementType=P,a.lanes=f,a.stateNode={isHidden:!1},a}function H_(a,l,f){return a=Kr(6,a,null,l),a.lanes=f,a}function $_(a,l,f){return l=Kr(4,a.children!==null?a.children:[],a.key,l),l.lanes=f,l.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},l}function Z8(a,l,f,g,_){this.tag=l,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=ve,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=hs(0),this.expirationTimes=hs(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=hs(0),this.identifierPrefix=g,this.onRecoverableError=_,at&&(this.mutableSourceEagerHydrationData=null)}function LE(a,l,f,g,_,T,b,G,q){return a=new Z8(a,l,f,G,q),l===1?(l=1,T===!0&&(l|=8)):l=0,T=Kr(3,null,null,l),a.current=T,T.stateNode=a,T.memoizedState={element:g,isDehydrated:f,cache:null,transitions:null,pendingSuspenseBoundaries:null},n_(T),a}function bE(a){if(!a)return Br;a=a._reactInternals;e:{if(N(a)!==a||a.tag!==1)throw Error(o(170));var l=a;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(Pn(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(o(171))}if(a.tag===1){var f=a.type;if(Pn(f))return Oi(a,f,l)}return l}function FE(a){var l=a._reactInternals;if(l===void 0)throw typeof a.render=="function"?Error(o(188)):(a=Object.keys(a).join(","),Error(o(268,a)));return a=U(l),a===null?null:a.stateNode}function VE(a,l){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var f=a.retryLane;a.retryLane=f!==0&&f<l?f:l}}function lp(a,l){VE(a,l),(a=a.alternate)&&VE(a,l)}function eA(a){return a=U(a),a===null?null:a.stateNode}function tA(){return null}return t.attemptContinuousHydration=function(a){if(a.tag===13){var l=zi(a,134217728);if(l!==null){var f=Hn();qr(l,a,134217728,f)}lp(a,134217728)}},t.attemptDiscreteHydration=function(a){if(a.tag===13){var l=zi(a,1);if(l!==null){var f=Hn();qr(l,a,1,f)}lp(a,1)}},t.attemptHydrationAtCurrentPriority=function(a){if(a.tag===13){var l=co(a),f=zi(a,l);if(f!==null){var g=Hn();qr(f,a,l,g)}lp(a,l)}},t.attemptSynchronousHydration=function(a){switch(a.tag){case 3:var l=a.stateNode;if(l.current.memoizedState.isDehydrated){var f=ma(l.pendingLanes);f!==0&&(Nl(l,f|1),Er(l,Ht()),!(Le&6)&&(jl(),ir()))}break;case 13:PE(function(){var g=zi(a,1);if(g!==null){var _=Hn();qr(g,a,1,_)}}),lp(a,1)}},t.batchedUpdates=function(a,l){var f=Le;Le|=1;try{return a(l)}finally{Le=f,Le===0&&(jl(),Ml&&ir())}},t.createComponentSelector=function(a){return{$$typeof:qf,value:a}},t.createContainer=function(a,l,f,g,_,T,b){return LE(a,l,!1,null,f,g,_,T,b)},t.createHasPseudoClassSelector=function(a){return{$$typeof:Kf,value:a}},t.createHydrationContainer=function(a,l,f,g,_,T,b,G,q){return a=LE(f,g,!0,a,_,T,b,G,q),a.context=bE(null),f=a.current,g=Hn(),_=co(f),T=_s(g,_),T.callback=l??null,ao(f,T,_),a.current.lanes=_,_r(a,_,g),Er(a,g),a},t.createPortal=function(a,l,f){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:d,key:g==null?null:""+g,children:a,containerInfo:l,implementation:f}},t.createRoleSelector=function(a){return{$$typeof:Qf,value:a}},t.createTestNameSelector=function(a){return{$$typeof:Yf,value:a}},t.createTextSelector=function(a){return{$$typeof:Xf,value:a}},t.deferredUpdates=function(a){var l=Ge,f=Bt.transition;try{return Bt.transition=null,Ge=16,a()}finally{Ge=l,Bt.transition=f}},t.discreteUpdates=function(a,l,f,g,_){var T=Ge,b=Bt.transition;try{return Bt.transition=null,Ge=1,a(l,f,g,_)}finally{Ge=T,Bt.transition=b,Le===0&&jl()}},t.findAllNodes=M_,t.findBoundingRects=function(a,l){if(!ss)throw Error(o(363));l=M_(a,l),a=[];for(var f=0;f<l.length;f++)a.push($0(l[f]));for(l=a.length-1;0<l;l--){f=a[l];for(var g=f.x,_=g+f.width,T=f.y,b=T+f.height,G=l-1;0<=G;G--)if(l!==G){var q=a[G],se=q.x,_e=se+q.width,Ne=q.y,ce=Ne+q.height;if(g>=se&&T>=Ne&&_<=_e&&b<=ce){a.splice(l,1);break}else if(g!==se||f.width!==q.width||ce<T||Ne>b){if(!(T!==Ne||f.height!==q.height||_e<g||se>_)){se>g&&(q.width+=se-g,q.x=g),_e<_&&(q.width=_-se),a.splice(l,1);break}}else{Ne>T&&(q.height+=Ne-T,q.y=T),ce<b&&(q.height=b-Ne),a.splice(l,1);break}}}return a},t.findHostInstance=FE,t.findHostInstanceWithNoPortals=function(a){return a=L(a),a=a!==null?pe(a):null,a===null?null:a.stateNode},t.findHostInstanceWithWarning=function(a){return FE(a)},t.flushControlled=function(a){var l=Le;Le|=1;var f=Bt.transition,g=Ge;try{Bt.transition=null,Ge=1,a()}finally{Ge=g,Bt.transition=f,Le=l,Le===0&&(jl(),ir())}},t.flushPassiveEffects=Pa,t.flushSync=PE,t.focusWithin=function(a,l){if(!ss)throw Error(o(363));for(a=x_(a),l=TE(a,l),l=Array.from(l),a=0;a<l.length;){var f=l[a++];if(!os(f)){if(f.tag===5&&cn(f.stateNode))return!0;for(f=f.child;f!==null;)l.push(f),f=f.sibling}}return!1},t.getCurrentUpdatePriority=function(){return Ge},t.getFindAllNodesFailureDescription=function(a,l){if(!ss)throw Error(o(363));var f=0,g=[];a=[x_(a),0];for(var _=0;_<a.length;){var T=a[_++],b=a[_++],G=l[b];if((T.tag!==5||!os(T))&&(N_(T,G)&&(g.push(D_(G)),b++,b>f&&(f=b)),b<l.length))for(T=T.child;T!==null;)a.push(T,b),T=T.sibling}if(f<l.length){for(a=[];f<l.length;f++)a.push(D_(l[f]));return`findAllNodes was able to match part of the selector:
  `+(g.join(" > ")+`

No matching component was found for:
  `)+a.join(" > ")}return null},t.getPublicRootInstance=function(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return he(a.child.stateNode);default:return a.child.stateNode}},t.injectIntoDevTools=function(a){if(a={bundleType:a.bundleType,version:a.version,rendererPackageName:a.rendererPackageName,rendererConfig:a.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:u.ReactCurrentDispatcher,findHostInstanceByFiber:eA,findFiberByHostInstance:a.findFiberByHostInstance||tA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")a=!1;else{var l=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(l.isDisabled||!l.supportsFiber)a=!0;else{try{Vi=l.inject(a),Un=l}catch{}a=!!l.checkDCE}}return a},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(a,l,f,g){if(!ss)throw Error(o(363));a=M_(a,l);var _=Tn(a,f,g).disconnect;return{disconnect:function(){_()}}},t.registerMutableSourceForHydration=function(a,l){var f=l._getVersion;f=f(l._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[l,f]:a.mutableSourceEagerHydrationData.push(l,f)},t.runWithPriority=function(a,l){var f=Ge;try{return Ge=a,l()}finally{Ge=f}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(a,l,f,g){var _=l.current,T=Hn(),b=co(_);return f=bE(f),l.context===null?l.context=f:l.pendingContext=f,l=_s(T,b),l.payload={element:a},g=g===void 0?null:g,g!==null&&(l.callback=g),a=ao(_,l,b),a!==null&&(qr(a,_,b,T),Df(a,_,b)),b},t};h8.exports=Pj;var Rj=h8.exports;const Aj=Ad(Rj);var d8={exports:{}},Sl={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Sl.ConcurrentRoot=1;Sl.ContinuousEventPriority=4;Sl.DefaultEventPriority=16;Sl.DiscreteEventPriority=1;Sl.IdleEventPriority=536870912;Sl.LegacyRoot=0;d8.exports=Sl;var f8=d8.exports;const PC={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let RC=!1,AC=!1;const _S=".react-konva-event",kj=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,xj=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,Nj={};function W0(n,e,t=Nj){if(!RC&&"zIndex"in e&&(console.warn(xj),RC=!0),!AC&&e.draggable){var r=e.x!==void 0||e.y!==void 0,i=e.onDragEnd||e.onDragMove;r&&!i&&(console.warn(kj),AC=!0)}for(var s in t)if(!PC[s]){var o=s.slice(0,2)==="on",u=t[s]!==e[s];if(o&&u){var c=s.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),n.off(c,t[s])}var d=!e.hasOwnProperty(s);d&&n.setAttr(s,void 0)}var p=e._useStrictMode,m={},y=!1;const E={};for(var s in e)if(!PC[s]){var o=s.slice(0,2)==="on",S=t[s]!==e[s];if(o&&S){var c=s.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),e[s]&&(E[c]=e[s])}!o&&(e[s]!==t[s]||p&&e[s]!==n.getAttr(s))&&(y=!0,m[s]=e[s])}y&&(n.setAttrs(m),ca(n));for(var c in E)n.on(c+_S,E[c])}function ca(n){if(!Oe.Konva.autoDrawEnabled){var e=n.getLayer()||n.getStage();e&&e.batchDraw()}}const p8={},Dj={};Cd.Node.prototype._applyProps=W0;function Mj(n,e){if(typeof e=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${e}`);return}n.add(e),ca(n)}function Oj(n,e,t){let r=Cd[n];r||(console.error(`Konva has no node with the type ${n}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${n}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),r=Cd.Group);const i={},s={};for(var o in e){var u=o.slice(0,2)==="on";u?s[o]=e[o]:i[o]=e[o]}const c=new r(i);return W0(c,s),c}function Lj(n,e,t){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${n}"`)}function bj(n,e,t){return!1}function Fj(n){return n}function Vj(){return null}function Uj(){return null}function zj(n,e,t,r){return Dj}function Bj(){}function Gj(n){}function jj(n,e){return!1}function Wj(){return p8}function Hj(){return p8}const $j=setTimeout,qj=clearTimeout,Kj=-1;function Qj(n,e){return!1}const Yj=!1,Xj=!0,Jj=!0;function Zj(n,e){e.parent===n?e.moveToTop():n.add(e),ca(n)}function eW(n,e){e.parent===n?e.moveToTop():n.add(e),ca(n)}function g8(n,e,t){e._remove(),n.add(e),e.setZIndex(t.getZIndex()),ca(n)}function tW(n,e,t){g8(n,e,t)}function nW(n,e){e.destroy(),e.off(_S),ca(n)}function rW(n,e){e.destroy(),e.off(_S),ca(n)}function iW(n,e,t){console.error(`Text components are not yet supported in ReactKonva. You text is: "${t}"`)}function sW(n,e,t){}function oW(n,e,t,r,i){W0(n,i,r)}function aW(n){n.hide(),ca(n)}function lW(n){}function uW(n,e){(e.visible==null||e.visible)&&n.show()}function cW(n,e){}function hW(n){}function dW(){}const fW=()=>f8.DefaultEventPriority,pW=Object.freeze(Object.defineProperty({__proto__:null,appendChild:Zj,appendChildToContainer:eW,appendInitialChild:Mj,cancelTimeout:qj,clearContainer:hW,commitMount:sW,commitTextUpdate:iW,commitUpdate:oW,createInstance:Oj,createTextInstance:Lj,detachDeletedInstance:dW,finalizeInitialChildren:bj,getChildHostContext:Hj,getCurrentEventPriority:fW,getPublicInstance:Fj,getRootHostContext:Wj,hideInstance:aW,hideTextInstance:lW,idlePriority:Th.unstable_IdlePriority,insertBefore:g8,insertInContainerBefore:tW,isPrimaryRenderer:Yj,noTimeout:Kj,now:Th.unstable_now,prepareForCommit:Vj,preparePortalMount:Uj,prepareUpdate:zj,removeChild:nW,removeChildFromContainer:rW,resetAfterCommit:Bj,resetTextContent:Gj,run:Th.unstable_runWithPriority,scheduleTimeout:$j,shouldDeprioritizeSubtree:jj,shouldSetTextContent:Qj,supportsMutation:Jj,unhideInstance:uW,unhideTextInstance:cW,warnsIfNotActing:Xj},Symbol.toStringTag,{value:"Module"}));var gW=Object.defineProperty,mW=Object.defineProperties,_W=Object.getOwnPropertyDescriptors,kC=Object.getOwnPropertySymbols,yW=Object.prototype.hasOwnProperty,vW=Object.prototype.propertyIsEnumerable,xC=(n,e,t)=>e in n?gW(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,NC=(n,e)=>{for(var t in e||(e={}))yW.call(e,t)&&xC(n,t,e[t]);if(kC)for(var t of kC(e))vW.call(e,t)&&xC(n,t,e[t]);return n},wW=(n,e)=>mW(n,_W(e)),DC,MC;typeof window<"u"&&((DC=window.document)!=null&&DC.createElement||((MC=window.navigator)==null?void 0:MC.product)==="ReactNative")?we.useLayoutEffect:we.useEffect;function m8(n,e,t){if(!n)return;if(t(n)===!0)return n;let r=n.child;for(;r;){const i=m8(r,e,t);if(i)return i;r=r.sibling}}function _8(n){try{return Object.defineProperties(n,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return n}}const OC=console.error;console.error=function(){const n=[...arguments].join("");if(n!=null&&n.startsWith("Warning:")&&n.includes("useContext")){console.error=OC;return}return OC.apply(this,arguments)};const yS=_8(we.createContext(null));class y8 extends we.Component{render(){return we.createElement(yS.Provider,{value:this._reactInternals},this.props.children)}}function SW(){const n=we.useContext(yS);if(n===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=we.useId();return we.useMemo(()=>{for(const r of[n,n==null?void 0:n.alternate]){if(!r)continue;const i=m8(r,!1,s=>{let o=s.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(i)return i}},[n,e])}function EW(){const n=SW(),[e]=we.useState(()=>new Map);e.clear();let t=n;for(;t;){if(t.type&&typeof t.type=="object"){const i=t.type._context===void 0&&t.type.Provider===t.type?t.type:t.type._context;i&&i!==yS&&!e.has(i)&&e.set(i,we.useContext(_8(i)))}t=t.return}return e}function TW(){const n=EW();return we.useMemo(()=>Array.from(n.keys()).reduce((e,t)=>r=>we.createElement(e,null,we.createElement(t.Provider,wW(NC({},r),{value:n.get(t)}))),e=>we.createElement(y8,NC({},e))),[n])}function CW(n){const e=rn.useRef({});return rn.useLayoutEffect(()=>{e.current=n}),rn.useLayoutEffect(()=>()=>{e.current={}},[]),e.current}const IW=n=>{const e=rn.useRef(null),t=rn.useRef(null),r=rn.useRef(null),i=CW(n),s=TW(),o=u=>{const{forwardedRef:c}=n;c&&(typeof c=="function"?c(u):c.current=u)};return rn.useLayoutEffect(()=>(t.current=new Cd.Stage({width:n.width,height:n.height,container:e.current}),o(t.current),r.current=Eh.createContainer(t.current,f8.LegacyRoot,!1,null),Eh.updateContainer(rn.createElement(s,{},n.children),r.current),()=>{Cd.isBrowser&&(o(null),Eh.updateContainer(null,r.current,null),t.current.destroy())}),[]),rn.useLayoutEffect(()=>{o(t.current),W0(t.current,n,i),Eh.updateContainer(rn.createElement(s,{},n.children),r.current,null)}),rn.createElement("div",{ref:e,id:n.id,accessKey:n.accessKey,className:n.className,role:n.role,style:n.style,tabIndex:n.tabIndex,title:n.title})},Id="Layer",Pd="Rect",LC="Line",bC="Text",Eh=Aj(pW);Eh.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:rn.version,rendererPackageName:"react-konva"});const PW=rn.forwardRef((n,e)=>rn.createElement(y8,{},rn.createElement(IW,{...n,forwardedRef:e}))),RW={},FC=n=>{let e;const t=new Set,r=(p,m)=>{const y=typeof p=="function"?p(e):p;if(!Object.is(y,e)){const E=e;e=m??(typeof y!="object"||y===null)?y:Object.assign({},e,y),t.forEach(S=>S(e,E))}},i=()=>e,c={setState:r,getState:i,getInitialState:()=>d,subscribe:p=>(t.add(p),()=>t.delete(p)),destroy:()=>{(RW?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},d=e=n(r,i,c);return c},AW=n=>n?FC(n):FC;var v8={exports:{}},w8={},S8={exports:{}},E8={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $u=we;function kW(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var xW=typeof Object.is=="function"?Object.is:kW,NW=$u.useState,DW=$u.useEffect,MW=$u.useLayoutEffect,OW=$u.useDebugValue;function LW(n,e){var t=e(),r=NW({inst:{value:t,getSnapshot:e}}),i=r[0].inst,s=r[1];return MW(function(){i.value=t,i.getSnapshot=e,qy(i)&&s({inst:i})},[n,t,e]),DW(function(){return qy(i)&&s({inst:i}),n(function(){qy(i)&&s({inst:i})})},[n]),OW(t),t}function qy(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!xW(n,t)}catch{return!0}}function bW(n,e){return e()}var FW=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?bW:LW;E8.useSyncExternalStore=$u.useSyncExternalStore!==void 0?$u.useSyncExternalStore:FW;S8.exports=E8;var VW=S8.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var H0=we,UW=VW;function zW(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var BW=typeof Object.is=="function"?Object.is:zW,GW=UW.useSyncExternalStore,jW=H0.useRef,WW=H0.useEffect,HW=H0.useMemo,$W=H0.useDebugValue;w8.useSyncExternalStoreWithSelector=function(n,e,t,r,i){var s=jW(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=HW(function(){function c(E){if(!d){if(d=!0,p=E,E=r(E),i!==void 0&&o.hasValue){var S=o.value;if(i(S,E))return m=S}return m=E}if(S=m,BW(p,E))return S;var x=r(E);return i!==void 0&&i(S,x)?(p=E,S):(p=E,m=x)}var d=!1,p,m,y=t===void 0?null:t;return[function(){return c(e())},y===null?void 0:function(){return c(y())}]},[e,t,r,i]);var u=GW(n,s[0],s[1]);return WW(function(){o.hasValue=!0,o.value=u},[u]),$W(u),u};v8.exports=w8;var qW=v8.exports;const KW=Ad(qW),T8={},{useDebugValue:QW}=rn,{useSyncExternalStoreWithSelector:YW}=KW;let VC=!1;const XW=n=>n;function JW(n,e=XW,t){(T8?"production":void 0)!=="production"&&t&&!VC&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),VC=!0);const r=YW(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return QW(r),r}const UC=n=>{(T8?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?AW(n):n,t=(r,i)=>JW(e,r,i);return Object.assign(t,e),t},C8=n=>n?UC(n):UC,zC={x:0,y:0,scale:1},sf=C8((n,e)=>({shapes:[],selectedShapeId:null,viewport:zC,addShape:t=>n(r=>({shapes:[...r.shapes,t]})),updateShape:(t,r)=>n(i=>({shapes:i.shapes.map(s=>s.id===t?{...s,...r}:s)})),deleteShape:t=>n(r=>({shapes:r.shapes.filter(i=>i.id!==t),selectedShapeId:r.selectedShapeId===t?null:r.selectedShapeId})),setShapes:t=>n({shapes:t}),selectShape:t=>n({selectedShapeId:t}),getSelectedShape:()=>{const{shapes:t,selectedShapeId:r}=e();return r&&t.find(i=>i.id===r)||null},setViewport:t=>n(r=>({viewport:{...r.viewport,...t}})),resetViewport:()=>n({viewport:zC})})),ZW=n=>{const e=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD","#98D8C8","#F7DC6F"];let t=0;for(let r=0;r<n.length;r++)t=n.charCodeAt(r)+((t<<5)-t);return e[Math.abs(t)%e.length]},Rd=C8(n=>({user:null,firebaseUser:null,isAuthenticated:!1,isLoading:!0,error:null,setUser:(e,t)=>n({user:e,firebaseUser:t,isAuthenticated:!!e,error:null}),setLoading:e=>n({isLoading:e}),setError:e=>n({error:e,isLoading:!1}),clearUser:()=>n({user:null,firebaseUser:null,isAuthenticated:!1,isLoading:!1})})),eH=n=>{var t;const e=n.displayName||((t=n.email)==null?void 0:t.split("@")[0])||"Anonymous User";return{uid:n.uid,displayName:e.length>20?e.substring(0,20):e,email:n.email||"",cursorColor:ZW(n.uid)}};var xn=[];for(var Ky=0;Ky<256;++Ky)xn.push((Ky+256).toString(16).slice(1));function tH(n,e=0){return(xn[n[e+0]]+xn[n[e+1]]+xn[n[e+2]]+xn[n[e+3]]+"-"+xn[n[e+4]]+xn[n[e+5]]+"-"+xn[n[e+6]]+xn[n[e+7]]+"-"+xn[n[e+8]]+xn[n[e+9]]+"-"+xn[n[e+10]]+xn[n[e+11]]+xn[n[e+12]]+xn[n[e+13]]+xn[n[e+14]]+xn[n[e+15]]).toLowerCase()}var Vp,nH=new Uint8Array(16);function rH(){if(!Vp&&(Vp=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Vp))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Vp(nH)}var iH=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const BC={randomUUID:iH};function sH(n,e,t){if(BC.randomUUID&&!n)return BC.randomUUID();n=n||{};var r=n.random||(n.rng||rH)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,tH(r)}const vS="canvas/global-canvas-v1/shapes",oH=async(n,e,t,r)=>{try{const i=sH(),s=iP(il,vS),o={type:"rectangle",x:n,y:e,width:100,height:100,fill:"#CCCCCC",text:"",textColor:"#000000",fontSize:14,createdBy:t,createdAt:yd(),lastModifiedBy:t,lastModifiedAt:yd(),isLocked:!1,lockedBy:null};return await Pb(Wm(s,i),o),console.log(` Shape created by ${r}:`,i),i}catch(i){throw console.error("Error creating shape:",i),i}},aH=(n,e)=>{try{const t=iP(il,vS),r=Sb(t,Eb("createdAt","asc"));return Ab(r,s=>{const o=[];s.forEach(u=>{u.exists()&&o.push({id:u.id,...u.data()})}),console.log(` Shapes synced: ${o.length} total`),n(o)},s=>{console.error("Error subscribing to shapes:",s),e==null||e(s)})}catch(t){throw console.error("Error setting up shapes subscription:",t),t}},lH=async(n,e,t)=>{try{const r=Wm(il,vS,n);await Rb(r,{...e,lastModifiedBy:t,lastModifiedAt:yd()}),console.log(" Shape updated:",n)}catch(r){throw console.error("Error updating shape:",r),r}},uH=()=>{const{setShapes:n}=sf();we.useEffect(()=>{console.log(" Setting up shape sync...");const e=aH(t=>{n(t),console.log(` Loaded ${t.length} shapes from Firestore:`),t.forEach(r=>{console.log(`   Shape ${r.id}: (${r.x}, ${r.y}) locked: ${r.isLocked}`)})},t=>{console.error(" Shape sync error:",t)});return()=>{console.log(" Cleaning up shape sync..."),e==null||e()}},[n])},I8="canvas/global-canvas-v1/shapes",cH=async(n,e,t)=>{try{const r=Wm(il,I8,n);return await yP(il,async s=>{const o=await s.get(r);if(!o.exists())throw new Error("Shape not found");const u=o.data();return u.isLocked&&u.lockedBy!==e?{success:!1,alreadyLocked:!0,lockedBy:u.lockedBy}:(s.update(r,{isLocked:!0,lockedBy:e,lastModifiedBy:e,lastModifiedAt:yd()}),console.log(` Lock acquired by ${t} for shape:`,n),{success:!0})})}catch(r){return console.error("Error acquiring lock:",r),{success:!1,error:r instanceof Error?r.message:"Unknown error"}}},hH=async(n,e,t,r)=>{try{const i=Wm(il,I8,n);return await yP(il,async o=>{const u=await o.get(i);if(!u.exists())throw new Error("Shape not found");if(u.data().lockedBy!==e)return console.warn("Cannot release lock not owned by user"),{success:!1,error:"Lock not owned by user"};const d={isLocked:!1,lockedBy:null,lastModifiedBy:e,lastModifiedAt:yd()};return o.update(i,d),console.log(` Lock released by ${t} for shape:`,n,r?`with position (${r.x}, ${r.y})`:"without position update"),{success:!0}})}catch(i){return console.error("Error releasing lock:",i),{success:!1,error:i instanceof Error?i.message:"Unknown error"}}},dH=({width:n,height:e,listening:t})=>{const i=[];for(let o=0;o<=n/50;o++){const u=o*50;i.push(X.jsx(LC,{points:[u,0,u,e],stroke:"#f0f0f0",strokeWidth:.5,listening:!1},`v-${o}`))}const s=[];for(let o=0;o<=e/50;o++){const u=o*50;s.push(X.jsx(LC,{points:[0,u,n,u],stroke:"#f0f0f0",strokeWidth:.5,listening:!1},`h-${o}`))}return X.jsxs(Id,{listening:t,children:[X.jsx(Pd,{x:0,y:0,width:n,height:e,fill:"white",listening:!1}),i,s,X.jsx(Pd,{x:0,y:0,width:n,height:e,stroke:"#cccccc",strokeWidth:2,fill:"transparent",listening:!1})]})},P8=rn.memo(({shape:n,onDragStart:e,onDragMove:t,onDragEnd:r,isDragging:i,draggingShapeId:s})=>{const{selectShape:o,selectedShapeId:u}=sf(),{user:c}=Rd(),d=u===n.id,p=n.isLocked,m=p&&n.lockedBy!==(c==null?void 0:c.uid),y=i&&s===n.id,[E,S]=we.useState(null),[x,D]=we.useState(0),k=5,R=150,w=we.useCallback(C=>{C.cancelBubble=!0,C.evt.stopPropagation(),!m&&!i&&(o(n.id),console.log(` Selected shape: ${n.id}`))},[n.id,o,m,i]),P=we.useCallback(C=>{if(!c||m||i)return;C.cancelBubble=!0,C.evt.stopPropagation();const N=C.target.getStage();if(!N)return;const A=N.getPointerPosition();A&&(S(A),D(Date.now()),setTimeout(()=>{const L=N.getPointerPosition();if(!L||!E)return;Math.sqrt(Math.pow(L.x-A.x,2)+Math.pow(L.y-A.y,2))<k&&E&&(console.log(` Starting drag after hold: ${n.id}`),e(n.id,n.x,n.y),S(null))},R))},[c,m,i,e,n.id,n.x,n.y,E,k,R]),V=we.useCallback(C=>{if(y){const N=C.target.getStage();if(!N)return;const A=N.getPointerPosition();if(!A)return;const L=(A.x-N.x())/N.scaleX(),U=(A.y-N.y())/N.scaleY();t(L,U)}else if(E){const N=C.target.getStage();if(!N)return;const A=N.getPointerPosition();if(!A)return;Math.sqrt(Math.pow(A.x-E.x,2)+Math.pow(A.y-E.y,2))>k&&(console.log(` Starting drag due to movement: ${n.id}`),e(n.id,n.x,n.y),S(null))}},[y,t,E,e,n.id,n.x,n.y,k]),z=we.useCallback(C=>{y?r():E&&(Date.now()-x<R&&w(C),S(null))},[y,r,E,x,R,w]);rn.useEffect(()=>{i&&s!==n.id&&S(null)},[i,s,n.id]);const M=()=>m?"not-allowed":y?"grabbing":d&&!p?"grab":"default";return X.jsxs(X.Fragment,{children:[X.jsx(Pd,{id:`shape-${n.id}`,x:n.x,y:n.y,width:n.width,height:n.height,fill:n.fill,stroke:d?"#0066ff":m?"#ff6b6b":"transparent",strokeWidth:d||m?2:0,opacity:m?.7:1,onClick:w,onTap:w,onMouseDown:P,onMouseMove:V,onMouseUp:z,onTouchStart:P,onTouchMove:V,onTouchEnd:z,onMouseEnter:C=>{C.target.getStage().container().style.cursor=M()},onMouseLeave:C=>{y||(C.target.getStage().container().style.cursor="default")}}),n.text&&X.jsx(bC,{x:n.x,y:n.y+n.height/2-n.fontSize/2,width:n.width,height:n.fontSize,text:n.text,fontSize:n.fontSize,fontFamily:"sans-serif",fill:n.textColor,align:"center",verticalAlign:"middle",listening:!1}),m&&X.jsx(bC,{x:n.x,y:n.y-20,text:` Editing: ${n.lockedBy===(c==null?void 0:c.uid)?"You":"Another user"}`,fontSize:12,fontFamily:"sans-serif",fill:"#ff6b6b",listening:!1})]})});P8.displayName="ShapeComponent";const fH=({listening:n,onDragStart:e,onDragMove:t,onDragEnd:r,isDragging:i,draggingShapeId:s})=>{const{shapes:o}=sf();return X.jsx(Id,{listening:n,children:o.map(u=>X.jsx(P8,{shape:u,onDragStart:e,onDragMove:t,onDragEnd:r,isDragging:i,draggingShapeId:s},u.id))})},pH=({listening:n})=>X.jsx(Id,{listening:n}),gH=({listening:n})=>{const{getSelectedShape:e}=sf(),t=e();return t?X.jsxs(Id,{listening:n,children:[X.jsx(Pd,{x:t.x-2,y:t.y-2,width:t.width+4,height:t.height+4,stroke:"#0066ff",strokeWidth:2,fill:"transparent",dash:[5,5],listening:!1}),[-2,t.width+2].map(r=>[-2,t.height+2].map(i=>X.jsx(Pd,{x:t.x+r-3,y:t.y+i-3,width:6,height:6,fill:"#0066ff",stroke:"white",strokeWidth:1,listening:!1},`handle-${r}-${i}`)))]}):X.jsx(Id,{listening:n})},hh=5e3,dh=5e3,mH=.1,_H=3,Qy=20,GC=1.05,yH=.2,vH=({width:n,height:e})=>{const t=we.useRef(null),[r,i]=we.useState(!1),[s,o]=we.useState(!1),[u,c]=we.useState({x:0,y:0}),[d,p]=we.useState({isDragging:!1,shapeId:null,startPos:{x:0,y:0},hasLock:!1,originalScale:{x:1,y:1},originalZIndex:0}),[m,y]=we.useState(!1),E=we.useRef(null),{viewport:S,setViewport:x,selectShape:D,shapes:k,updateShape:R}=sf(),{user:w}=Rd();uH();const P=we.useCallback(Y=>Math.round(Y/Qy)*Qy,[]),V=we.useCallback(Y=>{const he=t.current;he&&(he.container().style.cursor=Y)},[]),z=we.useCallback(async(Y,he,ue)=>{if(!w||d.isDragging)return!1;console.log(` Starting drag for shape: ${Y}`);try{const H=await cH(Y,w.uid,w.displayName);if(!H.success)return console.warn("Failed to acquire lock:",H.error),!1;const te=t.current;if(!te)return!1;const J=te.findOne(`#shape-${Y}`);if(!J)return!1;const ee={x:J.scaleX(),y:J.scaleY()},ae=J.zIndex();return J.moveToTop(),J.scale({x:ee.x*GC,y:ee.y*GC}),J.cache(),p({isDragging:!0,shapeId:Y,startPos:{x:he,y:ue},hasLock:!0,originalScale:ee,originalZIndex:ae}),V("grabbing"),D(Y),te.batchDraw(),console.log(` Drag started for shape: ${Y}`),!0}catch(H){return console.error("Error starting drag:",H),!1}},[w,d.isDragging,V,D]),M=we.useCallback((Y,he)=>{if(!d.isDragging||!d.shapeId)return;const ue=t.current;if(!ue)return;const H=ue.findOne(`#shape-${d.shapeId}`);if(!H)return;const te=k.find(ae=>ae.id===d.shapeId);if(!te)return;const J=Math.max(0,Math.min(hh-te.width,Y)),ee=Math.max(0,Math.min(dh-te.height,he));H.x(J),H.y(ee),ue.batchDraw()},[d.isDragging,d.shapeId,k]),C=we.useCallback(async(Y,he)=>{if(!d.isDragging||!d.shapeId||!w)return;console.log(` Ending drag for shape: ${d.shapeId}`);const ue=t.current;if(!ue)return;const H=ue.findOne(`#shape-${d.shapeId}`),te=k.find(J=>J.id===d.shapeId);if(!(!H||!te))try{const J=Y!==void 0?Y:H.x(),ee=he!==void 0?he:H.y(),ae=P(J),Ee=P(ee),ut=Math.max(0,Math.min(hh-te.width,ae)),ct=Math.max(0,Math.min(dh-te.height,Ee));new IC.Tween({node:H,duration:yH,x:ut,y:ct,scaleX:d.originalScale.x,scaleY:d.originalScale.y,easing:IC.Easings.EaseOut,onFinish:()=>{H.clearCache(),H.zIndex(d.originalZIndex),ue.batchDraw()}}).play(),await lH(d.shapeId,{x:ut,y:ct},w.uid),R(d.shapeId,{x:ut,y:ct}),d.hasLock&&await hH(d.shapeId,w.uid,w.displayName),console.log(` Drag completed: ${d.shapeId} -> (${ut}, ${ct})`),console.log(" Synced final position to multiplayer"),D(null),y(!0),setTimeout(()=>{y(!1),console.log(` Re-enabled interactions after drag: ${d.shapeId}`)},500)}catch(J){console.error("Error ending drag:",J),H&&(H.x(d.startPos.x),H.y(d.startPos.y),H.scale(d.originalScale),H.clearCache(),ue.batchDraw())}finally{p({isDragging:!1,shapeId:null,startPos:{x:0,y:0},hasLock:!1,originalScale:{x:1,y:1},originalZIndex:0}),V("default"),E.current&&(clearTimeout(E.current),E.current=null)}},[d,w,k,P,R,D,V]);we.useEffect(()=>{const Y=()=>{d.isDragging&&C()},he=()=>{d.isDragging&&C()};return document.addEventListener("mouseup",Y),document.addEventListener("mouseleave",he),document.addEventListener("touchend",Y),window.addEventListener("blur",Y),()=>{document.removeEventListener("mouseup",Y),document.removeEventListener("mouseleave",he),document.removeEventListener("touchend",Y),window.removeEventListener("blur",Y)}},[d.isDragging,C]);const N=we.useCallback(Y=>{Y.evt.preventDefault();const he=t.current;if(!he)return;const ue=he.scaleX(),H=he.getPointerPosition();if(!H)return;const te=1.05,J=Y.evt.deltaY>0?ue/te:ue*te,ee=Math.max(mH,Math.min(_H,J)),ae={x:(H.x-he.x())/ue,y:(H.y-he.y())/ue},Ee={x:H.x-ae.x*ee,y:H.y-ae.y*ee},ut=A(Ee.x,Ee.y,ee);x({x:ut.x,y:ut.y,scale:ee}),he.position(ut),he.scale({x:ee,y:ee})},[x]),A=we.useCallback((Y,he,ue)=>{const H=n,te=e,J=H-hh*ue,ee=te-dh*ue;return{x:Math.max(J,Math.min(0,Y)),y:Math.max(ee,Math.min(0,he))}},[n,e]),L=we.useCallback(Y=>{var ue;if(Y.evt.button===1||Y.evt.button===0&&Y.evt.ctrlKey){Y.evt.preventDefault(),i(!0);const H=(ue=Y.target.getStage())==null?void 0:ue.getPointerPosition();H&&c(H)}},[]),U=we.useCallback(Y=>{if(!r)return;Y.evt.preventDefault();const he=Y.target.getStage();if(!he)return;const ue=he.getPointerPosition();if(!ue)return;const H=ue.x-u.x,te=ue.y-u.y,J={x:S.x+H,y:S.y+te},ee=A(J.x,J.y,S.scale);x({x:ee.x,y:ee.y,scale:S.scale}),c(ue)},[r,u,S,A,x]),F=we.useCallback(Y=>{(Y.evt.button===1||Y.evt.button===0&&r)&&i(!1)},[r]),pe=we.useCallback(async Y=>{if(!(Y.target!==t.current||Y.evt.button!==0||Y.evt.ctrlKey)){if(r){console.log("Was panning, ignoring click");return}if(m){console.log("Just finished drag, ignoring stage click");return}if(w)try{o(!0);const he=t.current;if(!he)return;const ue=he.getPointerPosition();if(!ue)return;const H=(ue.x-S.x)/S.scale,te=(ue.y-S.y)/S.scale,J=Math.max(0,Math.min(hh-100,H)),ee=Math.max(0,Math.min(dh-100,te));await oH(J,ee,w.uid,w.displayName),D(null),console.log(` Shape created at (${J}, ${ee}) by ${w.displayName}`)}catch(he){console.error("Error creating shape:",he)}finally{o(!1)}}},[r,m,w,S,D]);return we.useEffect(()=>{const Y=t.current;Y&&(Y.position({x:S.x,y:S.y}),Y.scale({x:S.scale,y:S.scale}))},[S]),X.jsxs("div",{className:"relative overflow-hidden bg-white border border-gray-300 rounded-lg shadow-sm",children:[X.jsxs(PW,{ref:t,width:n,height:e,x:S.x,y:S.y,scaleX:S.scale,scaleY:S.scale,onWheel:N,onMouseDown:L,onMouseMove:U,onMouseUp:F,onClick:pe,onTap:pe,children:[X.jsx(dH,{width:hh,height:dh,listening:!1}),X.jsx(fH,{listening:!0,onDragStart:z,onDragMove:M,onDragEnd:C,isDragging:d.isDragging,draggingShapeId:d.shapeId}),X.jsx(gH,{listening:!1}),X.jsx(pH,{listening:!1})]}),X.jsxs("div",{className:"absolute top-2 right-2 space-y-1",children:[X.jsxs("div",{className:"text-xs text-gray-500 bg-white px-2 py-1 rounded shadow",children:["Scale: ",(S.scale*100).toFixed(0),"%"]}),d.isDragging&&X.jsxs("div",{className:"text-xs text-purple-600 bg-purple-50 px-2 py-1 rounded shadow",children:["Dragging: ",d.shapeId]})]}),X.jsxs("div",{className:"absolute bottom-2 left-2 space-y-1",children:[r&&X.jsx("div",{className:"text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded shadow",children:"Panning canvas..."}),s&&X.jsx("div",{className:"text-xs text-green-600 bg-green-50 px-2 py-1 rounded shadow",children:"Creating rectangle..."}),d.isDragging&&X.jsxs("div",{className:"text-xs text-purple-600 bg-purple-50 px-2 py-1 rounded shadow",children:[" Dragging (Snap to grid: ",Qy,"px)"]})]})]})},wH=()=>{const{user:n,isAuthenticated:e}=Rd(),t=async()=>{try{await uD(Sd)}catch(r){console.error("Error signing out:",r)}};return e?X.jsxs("header",{className:"bg-white border-b border-gray-200 px-4 py-3 flex justify-between items-center",children:[X.jsxs("div",{className:"flex items-center space-x-4",children:[X.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:"CollabCanvas"}),X.jsx("div",{className:"text-sm text-gray-500",children:"Real-Time Collaborative Design Tool"})]}),X.jsxs("div",{className:"flex items-center space-x-4",children:[X.jsxs("div",{className:"flex items-center space-x-2",children:[X.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:n==null?void 0:n.cursorColor}}),X.jsx("span",{className:"text-sm font-medium text-gray-700",children:n==null?void 0:n.displayName})]}),X.jsx("button",{onClick:t,className:"text-sm text-gray-500 hover:text-gray-700 px-3 py-1 rounded border border-gray-300 hover:border-gray-400",children:"Sign Out"})]})]}):null},SH=()=>{const{setUser:n,setLoading:e,setError:t,clearUser:r}=Rd();return we.useEffect(()=>{const i=lD(Sd,s=>{try{if(s){const o=eH(s);n(o,s),console.log(" User authenticated:",o.displayName)}else r(),console.log(" User signed out")}catch(o){console.error("Auth state change error:",o),t("Authentication error occurred")}finally{e(!1)}},s=>{console.error("Auth state observer error:",s),t("Failed to initialize authentication"),e(!1)});return()=>i()},[n,e,t,r]),Rd()},EH=({children:n,fallback:e})=>{const{isAuthenticated:t,isLoading:r,error:i}=SH();return r?X.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:X.jsx("div",{className:"bg-white rounded-lg shadow-md p-8",children:X.jsxs("div",{className:"text-center",children:[X.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),X.jsx("p",{className:"text-gray-600",children:"Checking authentication..."})]})})}):i?X.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:X.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 max-w-md",children:[X.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Authentication Error"}),X.jsx("p",{className:"text-gray-700 mb-4",children:"Firebase authentication error:"}),X.jsx("p",{className:"text-sm text-red-600 bg-red-50 p-3 rounded mb-4",children:i}),X.jsx("button",{onClick:()=>window.location.reload(),className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700",children:"Reload Page"})]})}):t?X.jsx(X.Fragment,{children:n}):X.jsx(X.Fragment,{children:e})};function TH(){const n=X.jsxs("div",{className:"container mx-auto px-4 py-8",children:[X.jsx("h1",{className:"text-4xl font-bold text-center text-gray-800 mb-8",children:"CollabCanvas MVP"}),X.jsxs("div",{className:"text-center mb-8",children:[X.jsx("p",{className:"text-lg text-gray-600 mb-2",children:"Real-Time Collaborative Design Tool"}),X.jsx("p",{className:"text-sm text-gray-500",children:"Please sign in to continue"})]}),X.jsx(EU,{})]});return X.jsx("div",{className:"min-h-screen bg-gray-50",children:X.jsx(EH,{fallback:n,children:X.jsxs("div",{className:"h-screen flex flex-col",children:[X.jsx(wH,{}),X.jsx("main",{className:"flex-1 p-4",children:X.jsxs("div",{className:"h-full flex",children:[X.jsx("div",{className:"flex-1 mr-4",children:X.jsx(vH,{width:800,height:600})}),X.jsxs("div",{className:"w-64 bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[X.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Canvas Tools"}),X.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[X.jsx("div",{children:" Left-click empty space to create rectangles"}),X.jsx("div",{children:" Left-drag rectangles to move them"}),X.jsx("div",{children:" Left-click shapes to select them"}),X.jsx("div",{children:" Middle-click drag to pan (Ctrl+drag on Mac)"}),X.jsx("div",{children:" Mouse wheel to zoom"}),X.jsx("div",{children:" Canvas size: 50005000px"})]}),X.jsxs("div",{className:"mt-6",children:[X.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Phase 5 Progress:"}),X.jsxs("div",{className:"space-y-1 text-sm text-gray-500",children:[X.jsx("div",{children:" Pan & Zoom"}),X.jsx("div",{children:" Shape Creation"}),X.jsx("div",{children:" Real-time Sync"}),X.jsx("div",{children:" Drag & Drop"}),X.jsx("div",{children:" Transaction Locking"}),X.jsx("div",{children:" Middle-click Pan"})]})]}),!1]})]})})]})})})}Yy.createRoot(document.getElementById("root")).render(X.jsx(rn.StrictMode,{children:X.jsx(TH,{})}));
